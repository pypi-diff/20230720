# Comparing `tmp/cegalprizm_hub-1.1.dev56941-py3-none-any.whl.zip` & `tmp/cegalprizm_hub-1.2.dev66355-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,34 +1,44 @@
-Zip file size: 48679 bytes, number of entries: 32
--rw-r--r--  2.0 unx      715 b- defN 23-Feb-13 10:30 cegalprizm/hub/__init__.py
--rw-r--r--  2.0 unx    16035 b- defN 23-Feb-13 10:30 cegalprizm/hub/agent.py
--rw-r--r--  2.0 unx    23141 b- defN 23-Feb-13 10:30 cegalprizm/hub/agent_pb2.py
--rw-r--r--  2.0 unx      159 b- defN 23-Feb-13 10:30 cegalprizm/hub/agent_pb2_grpc.py
--rw-r--r--  2.0 unx     3605 b- defN 23-Feb-13 10:30 cegalprizm/hub/base_ctx.py
--rw-r--r--  2.0 unx     1351 b- defN 23-Feb-13 10:30 cegalprizm/hub/capability.py
--rw-r--r--  2.0 unx    11217 b- defN 23-Feb-13 10:30 cegalprizm/hub/client.py
--rw-r--r--  2.0 unx     1733 b- defN 23-Feb-13 10:30 cegalprizm/hub/client_config.py
--rw-r--r--  2.0 unx     2707 b- defN 23-Feb-13 10:30 cegalprizm/hub/connection_parameters.py
--rw-r--r--  2.0 unx     9493 b- defN 23-Feb-13 10:30 cegalprizm/hub/connector.py
--rw-r--r--  2.0 unx     2933 b- defN 23-Feb-13 10:30 cegalprizm/hub/connector_filter.py
--rw-r--r--  2.0 unx    12103 b- defN 23-Feb-13 10:30 cegalprizm/hub/connector_request_service_pb2.py
--rw-r--r--  2.0 unx     6636 b- defN 23-Feb-13 10:30 cegalprizm/hub/connector_request_service_pb2_grpc.py
--rw-r--r--  2.0 unx    45253 b- defN 23-Feb-13 10:30 cegalprizm/hub/connector_task_service_pb2.py
--rw-r--r--  2.0 unx     2872 b- defN 23-Feb-13 10:30 cegalprizm/hub/connector_task_service_pb2_grpc.py
--rw-r--r--  2.0 unx     2626 b- defN 23-Feb-13 10:30 cegalprizm/hub/generic_client_interceptor.py
--rw-r--r--  2.0 unx    16867 b- defN 23-Feb-13 10:30 cegalprizm/hub/hub.py
--rw-r--r--  2.0 unx     4126 b- defN 23-Feb-13 10:30 cegalprizm/hub/hub_channel.py
--rw-r--r--  2.0 unx     1102 b- defN 23-Feb-13 10:30 cegalprizm/hub/keystone_auth_interceptor.py
--rw-r--r--  2.0 unx      575 b- defN 23-Feb-13 10:30 cegalprizm/hub/payload_auth.py
--rw-r--r--  2.0 unx    11062 b- defN 23-Feb-13 10:30 cegalprizm/hub/petrel.py
--rw-r--r--  2.0 unx    21065 b- defN 23-Feb-13 10:30 cegalprizm/hub/petrel_pb2.py
--rw-r--r--  2.0 unx      159 b- defN 23-Feb-13 10:30 cegalprizm/hub/petrel_pb2_grpc.py
--rw-r--r--  2.0 unx     4193 b- defN 23-Feb-13 10:30 cegalprizm/hub/server_config.py
--rw-r--r--  2.0 unx    48233 b- defN 23-Feb-13 10:30 cegalprizm/hub/server_service_pb2.py
--rw-r--r--  2.0 unx     9537 b- defN 23-Feb-13 10:30 cegalprizm/hub/server_service_pb2_grpc.py
--rw-r--r--  2.0 unx     1379 b- defN 23-Feb-13 10:30 cegalprizm/hub/task_registry.py
--rw-r--r--  2.0 unx     1212 b- defN 23-Feb-13 10:31 cegalprizm_hub-1.1.dev56941.dist-info/LICENSE
--rw-r--r--  2.0 unx     3511 b- defN 23-Feb-13 10:31 cegalprizm_hub-1.1.dev56941.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Feb-13 10:31 cegalprizm_hub-1.1.dev56941.dist-info/WHEEL
--rw-r--r--  2.0 unx       11 b- defN 23-Feb-13 10:31 cegalprizm_hub-1.1.dev56941.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2900 b- defN 23-Feb-13 10:31 cegalprizm_hub-1.1.dev56941.dist-info/RECORD
-32 files, 268603 bytes uncompressed, 43967 bytes compressed:  83.6%
+Zip file size: 56507 bytes, number of entries: 42
+-rw-r--r--  2.0 unx      820 b- defN 23-Jul-20 07:54 cegalprizm/hub/__init__.py
+-rw-r--r--  2.0 unx    16224 b- defN 23-Jul-20 07:54 cegalprizm/hub/agent.py
+-rw-r--r--  2.0 unx    23617 b- defN 23-Jul-20 07:54 cegalprizm/hub/agent_pb2.py
+-rw-r--r--  2.0 unx      159 b- defN 23-Jul-20 07:54 cegalprizm/hub/agent_pb2_grpc.py
+-rw-r--r--  2.0 unx     3605 b- defN 23-Jul-20 07:54 cegalprizm/hub/base_ctx.py
+-rw-r--r--  2.0 unx     2083 b- defN 23-Jul-20 07:54 cegalprizm/hub/capability.py
+-rw-r--r--  2.0 unx    11505 b- defN 23-Jul-20 07:54 cegalprizm/hub/client.py
+-rw-r--r--  2.0 unx     2369 b- defN 23-Jul-20 07:54 cegalprizm/hub/client_config.py
+-rw-r--r--  2.0 unx     2707 b- defN 23-Jul-20 07:54 cegalprizm/hub/connection_parameters.py
+-rw-r--r--  2.0 unx    12945 b- defN 23-Jul-20 07:54 cegalprizm/hub/connector.py
+-rw-r--r--  2.0 unx     3170 b- defN 23-Jul-20 07:54 cegalprizm/hub/connector_filter.py
+-rw-r--r--  2.0 unx    12103 b- defN 23-Jul-20 07:54 cegalprizm/hub/connector_request_service_pb2.py
+-rw-r--r--  2.0 unx     6636 b- defN 23-Jul-20 07:54 cegalprizm/hub/connector_request_service_pb2_grpc.py
+-rw-r--r--  2.0 unx    47744 b- defN 23-Jul-20 07:54 cegalprizm/hub/connector_task_service_pb2.py
+-rw-r--r--  2.0 unx     2872 b- defN 23-Jul-20 07:54 cegalprizm/hub/connector_task_service_pb2_grpc.py
+-rw-r--r--  2.0 unx     2626 b- defN 23-Jul-20 07:54 cegalprizm/hub/generic_client_interceptor.py
+-rw-r--r--  2.0 unx    16867 b- defN 23-Jul-20 07:54 cegalprizm/hub/hub.py
+-rw-r--r--  2.0 unx     4933 b- defN 23-Jul-20 07:54 cegalprizm/hub/hub_channel.py
+-rw-r--r--  2.0 unx      281 b- defN 23-Jul-20 07:54 cegalprizm/hub/in_memory_token_provider.py
+-rw-r--r--  2.0 unx     1102 b- defN 23-Jul-20 07:54 cegalprizm/hub/keystone_auth_interceptor.py
+-rw-r--r--  2.0 unx      575 b- defN 23-Jul-20 07:54 cegalprizm/hub/payload_auth.py
+-rw-r--r--  2.0 unx    11062 b- defN 23-Jul-20 07:54 cegalprizm/hub/petrel.py
+-rw-r--r--  2.0 unx    21065 b- defN 23-Jul-20 07:54 cegalprizm/hub/petrel_pb2.py
+-rw-r--r--  2.0 unx      159 b- defN 23-Jul-20 07:54 cegalprizm/hub/petrel_pb2_grpc.py
+-rw-r--r--  2.0 unx     4193 b- defN 23-Jul-20 07:54 cegalprizm/hub/server_config.py
+-rw-r--r--  2.0 unx    48233 b- defN 23-Jul-20 07:54 cegalprizm/hub/server_service_pb2.py
+-rw-r--r--  2.0 unx     9537 b- defN 23-Jul-20 07:54 cegalprizm/hub/server_service_pb2_grpc.py
+-rw-r--r--  2.0 unx     3716 b- defN 23-Jul-20 07:54 cegalprizm/hub/task_registry.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jul-20 07:54 example_client/__init__.py
+-rw-r--r--  2.0 unx     3387 b- defN 23-Jul-20 07:54 example_client/greeter_pb2.py
+-rw-r--r--  2.0 unx      159 b- defN 23-Jul-20 07:54 example_client/greeter_pb2_grpc.py
+-rw-r--r--  2.0 unx     4520 b- defN 23-Jul-20 07:54 example_client/main.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jul-20 07:54 example_connector/__init__.py
+-rw-r--r--  2.0 unx     3387 b- defN 23-Jul-20 07:54 example_connector/greeter_pb2.py
+-rw-r--r--  2.0 unx      159 b- defN 23-Jul-20 07:54 example_connector/greeter_pb2_grpc.py
+-rw-r--r--  2.0 unx     4997 b- defN 23-Jul-20 07:54 example_connector/main.py
+-rw-r--r--  2.0 unx      287 b- defN 23-Jul-20 07:54 example_upload/main.py
+-rw-r--r--  2.0 unx     1212 b- defN 23-Jul-20 07:54 cegalprizm_hub-1.2.dev66355.dist-info/LICENSE
+-rw-r--r--  2.0 unx     3515 b- defN 23-Jul-20 07:54 cegalprizm_hub-1.2.dev66355.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-20 07:54 cegalprizm_hub-1.2.dev66355.dist-info/WHEEL
+-rw-r--r--  2.0 unx       59 b- defN 23-Jul-20 07:54 cegalprizm_hub-1.2.dev66355.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     3759 b- defN 23-Jul-20 07:54 cegalprizm_hub-1.2.dev66355.dist-info/RECORD
+42 files, 298441 bytes uncompressed, 50439 bytes compressed:  83.1%
```

## zipnote {}

```diff
@@ -48,14 +48,17 @@
 
 Filename: cegalprizm/hub/hub.py
 Comment: 
 
 Filename: cegalprizm/hub/hub_channel.py
 Comment: 
 
+Filename: cegalprizm/hub/in_memory_token_provider.py
+Comment: 
+
 Filename: cegalprizm/hub/keystone_auth_interceptor.py
 Comment: 
 
 Filename: cegalprizm/hub/payload_auth.py
 Comment: 
 
 Filename: cegalprizm/hub/petrel.py
@@ -75,23 +78,50 @@
 
 Filename: cegalprizm/hub/server_service_pb2_grpc.py
 Comment: 
 
 Filename: cegalprizm/hub/task_registry.py
 Comment: 
 
-Filename: cegalprizm_hub-1.1.dev56941.dist-info/LICENSE
+Filename: example_client/__init__.py
+Comment: 
+
+Filename: example_client/greeter_pb2.py
+Comment: 
+
+Filename: example_client/greeter_pb2_grpc.py
+Comment: 
+
+Filename: example_client/main.py
+Comment: 
+
+Filename: example_connector/__init__.py
+Comment: 
+
+Filename: example_connector/greeter_pb2.py
+Comment: 
+
+Filename: example_connector/greeter_pb2_grpc.py
+Comment: 
+
+Filename: example_connector/main.py
+Comment: 
+
+Filename: example_upload/main.py
+Comment: 
+
+Filename: cegalprizm_hub-1.2.dev66355.dist-info/LICENSE
 Comment: 
 
-Filename: cegalprizm_hub-1.1.dev56941.dist-info/METADATA
+Filename: cegalprizm_hub-1.2.dev66355.dist-info/METADATA
 Comment: 
 
-Filename: cegalprizm_hub-1.1.dev56941.dist-info/WHEEL
+Filename: cegalprizm_hub-1.2.dev66355.dist-info/WHEEL
 Comment: 
 
-Filename: cegalprizm_hub-1.1.dev56941.dist-info/top_level.txt
+Filename: cegalprizm_hub-1.2.dev66355.dist-info/top_level.txt
 Comment: 
 
-Filename: cegalprizm_hub-1.1.dev56941.dist-info/RECORD
+Filename: cegalprizm_hub-1.2.dev66355.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## cegalprizm/hub/__init__.py

```diff
@@ -1,24 +1,26 @@
 # Copyright 2023 Cegal AS
 # All rights reserved.
 # Unauthorized copying of this file, via any medium is strictly prohibited.
 
-__version__ = '1.1.0'
-__git_hash__ = '95aade0a'
+__version__ = '1.2.0'
+__git_hash__ = '5b12b393'
 
 import logging
 
 logger = logging.getLogger(__name__)
 
 from .server_config import ServerConfig
 from .client_config import ClientConfig
 from .hub import Hub
 from .client import HubClient
 from .hub_channel import HubChannel
-from .connector import HubConnector
+from .connector import HubConnector, TaskContext
 from .task_registry import HubTaskRegistry
 from .capability import HubCapability
 from .base_ctx import BaseContext
 from .petrel import PetrelContext
 from .agent import AgentContext
 from .connection_parameters import ConnectionParameters
 from .connector_filter import ConnectorFilter
+from .agent import AgentContext
+from .in_memory_token_provider import InMemoryTokenProvider
```

## cegalprizm/hub/agent.py

```diff
@@ -186,15 +186,15 @@
             result.Unpack(response)
             logger.debug(response)
             return response
         else:
             logger.warning(f"failed to launch application profile {profile_name}: {result} on connector_id {connector_id}")
             raise Exception(f"failed to launch application profile {profile_name}: {result} on connector_id {connector_id}")
 
-    def upload_file(self, src_path: str, rel_dest_path: str=None, abs_dest_path: str=None, overwrite: bool=False ):
+    def upload_file(self, src_path: str, rel_dest_path: str=None, abs_dest_path: str=None, overwrite: bool=False, open_file_on_complete: bool=False ):
         """upload a file to a Cegal Hub Agent if the Cegal Hub Agent permits file upload. A file can be uploaded by only specifying the src file and the file will be uploaded
         to the default directory. The second alternative is to specify a relative destination path in additionto the src file path which will be the relative path from the
         default Agent upload directory. The last alternative is to specify an absolute path for upload on the Agent (again the Agent must support this).
 
         Args:
             src_path (str): the src path of the file on the client
             rel_dest_path (str): the relative path to the default file upload shared path on the Agent (if permitted by the Agent)
@@ -224,19 +224,19 @@
 
         #check if the file exists
         path_exists = os.path.exists(src_path)
 
         if path_exists is False:
             raise Exception(f"file '{src_path}' does not exist ")
         else:
-           
-            msg = UploadFileRequest()
-            msg.overwrite = overwrite
+            # msg = UploadFileRequest()
+            # msg.overwrite = overwrite
+            # msg.open_on_complete = open_file_on_complete
             
-            ok, result, connector_id = self._hub_client.do_client_streaming("cegal.hub.agent","cegal.hub.agent.upload_file", _upload_message_from_file(src_path,dest_path,overwrite, relative), connector_filter=self.connector_filter, major_version=1,minor_version=0)
+            ok, result, connector_id = self._hub_client.do_client_streaming("cegal.hub.agent","cegal.hub.agent.upload_file", _upload_message_from_file(src_path,dest_path,overwrite, relative, open_file_on_complete), connector_filter=self.connector_filter, major_version=1,minor_version=0)
             if (ok):
                 response = UploadFileResult()
                 result.Unpack(response)
                 logger.debug(response)
                 return response
             else:
                 logger.warning(f"failed to upload file {src_path}: to agent {result} on connector_id {connector_id}")
@@ -279,18 +279,19 @@
                 logger.debug(f"download file finished on connector_id {cid}")
         except Exception as error:
             path_exists = os.path.exists(dest_path)
             os.remove(path=dest_path)
             raise Exception(error)
         return
 
-def _upload_message_from_file(filename, dest_path, overwrite, relative):
+def _upload_message_from_file(filename, dest_path, overwrite, relative, open_file_on_complete):
     with open(filename, "rb") as f:
         while True:
             msg = UploadFileRequest()
+            msg.open_on_complete = open_file_on_complete
             if relative:
                 msg.relative_path = dest_path
             else:
                 msg.absolute_path = dest_path    
             msg.overwrite = overwrite
             bytes = f.read(1024)
             msg.file_bytes = bytes
```

## cegalprizm/hub/agent_pb2.py

```diff
@@ -16,15 +16,15 @@
 
 DESCRIPTOR = _descriptor.FileDescriptor(
   name='cegalprizm/hub/agent.proto',
   package='hub',
   syntax='proto3',
   serialized_options=b'Z\007./agent',
   create_key=_descriptor._internal_create_key,
-  serialized_pb=b'\n\x1a\x63\x65galprizm/hub/agent.proto\x12\x03hub\"\x9d\x01\n\x10ListFilesRequest\x12\x11\n\troot_path\x18\x01 \x01(\t\x12\x11\n\trecursive\x18\x02 \x01(\x08\x12\x0e\n\x06suffix\x18\x03 \x01(\t\x12\x1f\n\x17skip_folder_starts_with\x18\x04 \x03(\t\x12\x1c\n\x14skip_folder_contains\x18\x05 \x03(\t\x12\x14\n\x0ctimeout_secs\x18\x06 \x01(\x05\"~\n\x0fListFilesResult\x12\r\n\x05paths\x18\x01 \x03(\t\x12\x19\n\x11num_dirs_searched\x18\x02 \x01(\x03\x12\x18\n\x10num_dirs_skipped\x18\x03 \x01(\x03\x12\x12\n\nnum_errors\x18\x04 \x01(\x03\x12\x13\n\x0bnum_results\x18\x05 \x01(\x03\"\xc9\x01\n\x18LaunchApplicationRequest\x12\x14\n\x0cprofile_name\x18\x01 \x01(\t\x12\x18\n\x10\x65nv_var_override\x18\x02 \x01(\t\x12\x0c\n\x04\x61rgs\x18\x03 \x03(\t\x12\x1d\n\x15override_default_args\x18\x04 \x01(\x08\x12\x18\n\x10is_hub_connector\x18\x05 \x01(\x08\x12\x18\n\x10wait_for_connect\x18\x06 \x01(\x08\x12\x1c\n\x14\x63onnect_timeout_secs\x18\x07 \x01(\x05\"C\n\x17LaunchApplicationResult\x12\x12\n\nprocess_id\x18\x01 \x01(\x05\x12\x14\n\x0c\x63onnector_id\x18\x02 \x01(\t\"E\n\x13\x44ownloadFileRequest\x12 \n\thash_type\x18\x01 \x01(\x0e\x32\r.hub.HashType\x12\x0c\n\x04path\x18\x02 \x01(\t\"6\n\x12\x44ownloadFileResult\x12\x12\n\nfile_bytes\x18\x01 \x01(\x0c\x12\x0c\n\x04hash\x18\x02 \x01(\t\"\x98\x01\n\x11UploadFileRequest\x12 \n\thash_type\x18\x01 \x01(\x0e\x32\r.hub.HashType\x12\x0c\n\x04hash\x18\x02 \x01(\t\x12\x15\n\rrelative_path\x18\x03 \x01(\t\x12\x15\n\rabsolute_path\x18\x04 \x01(\t\x12\x11\n\toverwrite\x18\x05 \x01(\x08\x12\x12\n\nfile_bytes\x18\x06 \x01(\x0c\"\x12\n\x10UploadFileResult*+\n\x08HashType\x12\n\n\x06NOHASH\x10\x00\x12\x07\n\x03MD5\x10\x01\x12\n\n\x06SHA256\x10\x02\x42\tZ\x07./agentb\x06proto3'
+  serialized_pb=b'\n\x1a\x63\x65galprizm/hub/agent.proto\x12\x03hub\"\x9d\x01\n\x10ListFilesRequest\x12\x11\n\troot_path\x18\x01 \x01(\t\x12\x11\n\trecursive\x18\x02 \x01(\x08\x12\x0e\n\x06suffix\x18\x03 \x01(\t\x12\x1f\n\x17skip_folder_starts_with\x18\x04 \x03(\t\x12\x1c\n\x14skip_folder_contains\x18\x05 \x03(\t\x12\x14\n\x0ctimeout_secs\x18\x06 \x01(\x05\"~\n\x0fListFilesResult\x12\r\n\x05paths\x18\x01 \x03(\t\x12\x19\n\x11num_dirs_searched\x18\x02 \x01(\x03\x12\x18\n\x10num_dirs_skipped\x18\x03 \x01(\x03\x12\x12\n\nnum_errors\x18\x04 \x01(\x03\x12\x13\n\x0bnum_results\x18\x05 \x01(\x03\"\xc9\x01\n\x18LaunchApplicationRequest\x12\x14\n\x0cprofile_name\x18\x01 \x01(\t\x12\x18\n\x10\x65nv_var_override\x18\x02 \x01(\t\x12\x0c\n\x04\x61rgs\x18\x03 \x03(\t\x12\x1d\n\x15override_default_args\x18\x04 \x01(\x08\x12\x18\n\x10is_hub_connector\x18\x05 \x01(\x08\x12\x18\n\x10wait_for_connect\x18\x06 \x01(\x08\x12\x1c\n\x14\x63onnect_timeout_secs\x18\x07 \x01(\x05\"C\n\x17LaunchApplicationResult\x12\x12\n\nprocess_id\x18\x01 \x01(\x05\x12\x14\n\x0c\x63onnector_id\x18\x02 \x01(\t\"E\n\x13\x44ownloadFileRequest\x12 \n\thash_type\x18\x01 \x01(\x0e\x32\r.hub.HashType\x12\x0c\n\x04path\x18\x02 \x01(\t\"6\n\x12\x44ownloadFileResult\x12\x12\n\nfile_bytes\x18\x01 \x01(\x0c\x12\x0c\n\x04hash\x18\x02 \x01(\t\"\xb2\x01\n\x11UploadFileRequest\x12 \n\thash_type\x18\x01 \x01(\x0e\x32\r.hub.HashType\x12\x0c\n\x04hash\x18\x02 \x01(\t\x12\x15\n\rrelative_path\x18\x03 \x01(\t\x12\x15\n\rabsolute_path\x18\x04 \x01(\t\x12\x11\n\toverwrite\x18\x05 \x01(\x08\x12\x12\n\nfile_bytes\x18\x06 \x01(\x0c\x12\x18\n\x10open_on_complete\x18\x07 \x01(\x08\"\x12\n\x10UploadFileResult*+\n\x08HashType\x12\n\n\x06NOHASH\x10\x00\x12\x07\n\x03MD5\x10\x01\x12\n\n\x06SHA256\x10\x02\x42\tZ\x07./agentb\x06proto3'
 )
 
 _HASHTYPE = _descriptor.EnumDescriptor(
   name='HashType',
   full_name='hub.HashType',
   filename=None,
   file=DESCRIPTOR,
@@ -44,16 +44,16 @@
       name='SHA256', index=2, number=2,
       serialized_options=None,
       type=None,
       create_key=_descriptor._internal_create_key),
   ],
   containing_type=None,
   serialized_options=None,
-  serialized_start=898,
-  serialized_end=941,
+  serialized_start=924,
+  serialized_end=967,
 )
 _sym_db.RegisterEnumDescriptor(_HASHTYPE)
 
 HashType = enum_type_wrapper.EnumTypeWrapper(_HASHTYPE)
 NOHASH = 0
 MD5 = 1
 SHA256 = 2
@@ -424,28 +424,35 @@
     _descriptor.FieldDescriptor(
       name='file_bytes', full_name='hub.UploadFileRequest.file_bytes', index=5,
       number=6, type=12, cpp_type=9, label=1,
       has_default_value=False, default_value=b"",
       message_type=None, enum_type=None, containing_type=None,
       is_extension=False, extension_scope=None,
       serialized_options=None, file=DESCRIPTOR,  create_key=_descriptor._internal_create_key),
+    _descriptor.FieldDescriptor(
+      name='open_on_complete', full_name='hub.UploadFileRequest.open_on_complete', index=6,
+      number=7, type=8, cpp_type=7, label=1,
+      has_default_value=False, default_value=False,
+      message_type=None, enum_type=None, containing_type=None,
+      is_extension=False, extension_scope=None,
+      serialized_options=None, file=DESCRIPTOR,  create_key=_descriptor._internal_create_key),
   ],
   extensions=[
   ],
   nested_types=[],
   enum_types=[
   ],
   serialized_options=None,
   is_extendable=False,
   syntax='proto3',
   extension_ranges=[],
   oneofs=[
   ],
   serialized_start=724,
-  serialized_end=876,
+  serialized_end=902,
 )
 
 
 _UPLOADFILERESULT = _descriptor.Descriptor(
   name='UploadFileResult',
   full_name='hub.UploadFileResult',
   filename=None,
@@ -461,16 +468,16 @@
   ],
   serialized_options=None,
   is_extendable=False,
   syntax='proto3',
   extension_ranges=[],
   oneofs=[
   ],
-  serialized_start=878,
-  serialized_end=896,
+  serialized_start=904,
+  serialized_end=922,
 )
 
 _DOWNLOADFILEREQUEST.fields_by_name['hash_type'].enum_type = _HASHTYPE
 _UPLOADFILEREQUEST.fields_by_name['hash_type'].enum_type = _HASHTYPE
 DESCRIPTOR.message_types_by_name['ListFilesRequest'] = _LISTFILESREQUEST
 DESCRIPTOR.message_types_by_name['ListFilesResult'] = _LISTFILESRESULT
 DESCRIPTOR.message_types_by_name['LaunchApplicationRequest'] = _LAUNCHAPPLICATIONREQUEST
```

## cegalprizm/hub/capability.py

```diff
@@ -1,28 +1,55 @@
 # Copyright 2023 Cegal AS
 # All rights reserved.
 # Unauthorized copying of this file, via any medium is strictly prohibited.
+#
+# This file contains the HubCapability class which is used to represent a Hub task that can be executed by
+# a HubConnector. The HubCapability class is a wrapper class Is a wrapper class that holds a task as a lambda, 
+# as well as, information about the task. Information includes:
+# * version numbers
+# * description 
+# * auth requirements
 
 from types import FunctionType
+from enum import Enum
 
 from .payload_auth import PayloadAuth
 
 
+class TaskType(Enum):
+    UNARY = 1,
+    CLIENT_STREAMING = 2,
+    SERVER_STREAMING = 3
+
+
 class HubCapability:
 
-    def __init__(self, wellknown_payload_identifier: str, task: FunctionType, friendly_name: str, description: str, payload_auth: PayloadAuth, major_version: int = 0, minor_version: int = 0):
+    def __init__(self,
+                 task_type: TaskType,
+                 wellknown_payload_identifier: str,
+                 task: FunctionType,
+                 friendly_name: str,
+                 description: str,
+                 payload_auth: PayloadAuth,
+                 major_version: int = 0,
+                 minor_version: int = 0):
+        self._task_type = task_type
         self._wellknown_payload_identifier = wellknown_payload_identifier
         self._friendly_name = friendly_name
         self._description = description
         self._payload_auth = payload_auth
         self._major_version = major_version
         self._minor_version = minor_version
         self._task = task
 
     @property
+    def task_type(self) -> TaskType:
+        return self._task_type
+
+    @property
     def wellknown_payload_identifier(self) -> str:
         return self._wellknown_payload_identifier
 
     @property
     def friendly_name(self) -> str:
         return self._friendly_name
```

## cegalprizm/hub/client.py

```diff
@@ -1,10 +1,14 @@
 # Copyright 2023 Cegal AS
 # All rights reserved.
 # Unauthorized copying of this file, via any medium is strictly prohibited.
+#
+# This file contains the HubClient class which is a convenience utility class for making GRPC unary, client
+# and server streaming requests to Cegal Hub Connectors via a running Cegal Hub Server. It extends the HubChannel
+# class which provides logic for setting up a GRPC channel.
 
 from typing import Iterable
 
 from . import logger
 from .connection_parameters import ConnectionParameters
 from .connector_filter import ConnectorFilter
 from .connector_request_service_pb2 import ConnectorRequest
@@ -27,15 +31,15 @@
             token_provider (token_provider, optional): Most often an OidcClient object. Defaults to None.
         """        
         super().__init__(connection_parameters, token_provider)
         self._connector_request_stub = ConnectorRequestServiceStub(self._channel)
         self._server_request_stub = ServerServiceStub(self._channel)
         self._connection_parameters = connection_parameters
 
-    def do_unary_request(self, wellknown_connector_identifier, wellknown_payload_identifier, payload, connector_filter: ConnectorFilter = None, major_version:int=0, minor_version:int=0):
+    def do_unary_request(self, wellknown_connector_identifier, wellknown_payload_identifier, payload, connector_filter: ConnectorFilter = None, major_version: int = 0, minor_version: int = 0):
         """Make a unary GRPC client request against a wellknown Cegal Hub Connector type and wellknown payload identifier via a running Cegal Hub Server.
 
         Args:
             wellknown_connector_identifier (str): The wellknown identifier of a Cegal Hub Connector type such as cegal.hub.agent or cegal.hub.petrel 
             wellknown_payload_identifier (str): The wellknown payload identifier (functionality supported by the Cegal Hub Connector) such as cegal.hub.agent.list_files
             payload (Any): A protobuf Any object
             major_version (int): The major version number for the payload
@@ -46,16 +50,16 @@
             tuple: A tuple containing a success / failure bool, the result Any payload and the connector instance identifier str that handled the request
         """        
         if connector_filter is None:
             connector_filter = ConnectorFilter()
         request = ConnectorRequest(
             wellknown_connector_identifier=wellknown_connector_identifier,
             wellknown_payload_identifier=wellknown_payload_identifier,
-            payload_major_version = major_version,
-            payload_minor_version = minor_version,
+            payload_major_version=major_version,
+            payload_minor_version=minor_version,
             target_connector_id=connector_filter.target_connector_id,
             payload=payload,
         )
 
         if connector_filter.labels_dict:
             for k in connector_filter.labels_dict.keys():
                 request.labels[k] = connector_filter.labels_dict[k]
@@ -64,15 +68,15 @@
         if (result.ok):
             logger.debug(f"unary result: ok, connector id: {result.connector_id}")
             return (True, result.payload, result.connector_id)
         else:
             logger.debug(f"unary result: error: {result.error_message}, connector id: {result.connector_id}")
             return (False, result.error_message, result.connector_id)
 
-    def do_server_streaming(self, wellknown_connector_identifier: str, wellknown_payload_identifier: str, payload, connector_filter: ConnectorFilter = None, major_version:int=0, minor_version:int=0):
+    def do_server_streaming(self, wellknown_connector_identifier: str, wellknown_payload_identifier: str, payload, connector_filter: ConnectorFilter = None, major_version: int = 0, minor_version: int = 0):
         """Make a server streaming GRPC client request against a wellknown Cegal Hub Connector type and wellknown payload identifier via a running Cegal Hub Server.
 
         Args:
             wellknown_connector_identifier (str): The wellknown identifier of a Cegal Hub Connector type such as cegal.hub.agent or cegal.hub.petrel 
             wellknown_payload_identifier (str): The wellknown payload identifier (functionality supported by the Cegal Hub Connector) such as cegal.hub.agent.list_files
             payload (Any): A protobuf Any object
             connector_filter (ConnectorFilter, optional): A ConnectorFilter to help target a specific Connector instance(s). Defaults to None.
@@ -102,15 +106,15 @@
             if (result.ok):
                 logger.debug(f"server streaming result: ok, connector id {result.connector_id}")
                 yield (True, result.payload, result.connector_id)
             else:
                 logger.debug(f"server streaming result: error: {result.error_message}, connector id: {result.connector_id}")
                 yield (False, result.error_message, result.connector_id)
 
-    def do_client_streaming(self, wellknown_connector_identifier: str, wellknown_payload_identifier: str, iterable_payloads: Iterable, connector_filter: ConnectorFilter = None, major_version:int=0, minor_version:int=0):
+    def do_client_streaming(self, wellknown_connector_identifier: str, wellknown_payload_identifier: str, iterable_payloads: Iterable, connector_filter: ConnectorFilter = None, major_version: int = 0, minor_version: int = 0):
         """Make a client streaming GRPC client request against a wellknown Cegal Hub Connector type and wellknown payload identifier via a running Cegal Hub Server.
 
         Args:
             wellknown_connector_identifier (str): The wellknown identifier of a Cegal Hub Connector type such as cegal.hub.agent or cegal.hub.petrel 
             wellknown_payload_identifier (str): The wellknown payload identifier (functionality supported by the Cegal Hub Connector) such as cegal.hub.agent.list_files
             iterable_payloads (Iterable): The client payloads to stream to the Cegal Hub Connector
             major_version (int): The major version number for the payload
@@ -158,18 +162,18 @@
         Returns:
             ConnectorRequestServiceStub: The service stub for clients to communicate with Cegal Hub Connectors
         """        
         return self._connector_request_stub
 
     @property
     def server_request_stub(self):
-        """The service stuf stub for clients to communicate with a Cegal Hub Server
+        """The service stub for clients to communicate with a Cegal Hub Server
 
         Returns:
-            ServerServiceStub: The service stuf stub for clients to communicate with a Cegal Hub Server
+            ServerServiceStub: The service stub for clients to communicate with a Cegal Hub Server
         """        
         return self._server_request_stub
 
     @property
     def connection_parameters(self):
         """The ConnectionParameters object associated with the running Cegal Hub Server.
```

## cegalprizm/hub/client_config.py

```diff
@@ -1,21 +1,22 @@
 # Copyright 2023 Cegal AS
 # All rights reserved.
 # Unauthorized copying of this file, via any medium is strictly prohibited.
 
 import os
-
+from . import logger
 
 class ClientConfig():
     """Global configuration for the Python client communicating with a running Cegal Hub Server. This is used primarily with ConnectionParameters objects.
     When a ConnectionParameters object is created but no values are provided, the ConnectionParameters object will rely on the ClientConfig and ServerConfig 
     global configurations for defaults.
     """
 
     __use_auth: bool = None
+    __user_access_token: str = None
 
     @staticmethod
     def set_use_auth(use_auth: bool):
         """Update the ClientConfig to use auth or not.
 
         Args:
             use_auth (bool): True to indicate authentication should be used, False otherwise.
@@ -25,25 +26,43 @@
     @staticmethod
     def get_use_auth():
         """Get the configuration for whether or not to use authentication. This will look for an environment variable called CEGAL_HUB_USE_AUTH
         which it will expect to be set to True or False.
 
         Returns:
             [bool]: Whether or not to use authentication.
-        """        
+        """  
         if ClientConfig.__use_auth is None:
             val = ClientConfig.__get_envvar("CEGAL_HUB_USE_AUTH")
             if val[0]:
                 return val[1].lower() == "true"
             else:
                 return False
         else:
             return ClientConfig.__use_auth
 
     @staticmethod
+    def set_user_access_token(token: str):
+        """Set the predefined user access token.
+
+        Args:
+            token (str): The access token to use. Set to None to clear the user access token and restore the default behaviour
+        """
+        ClientConfig.__user_access_token = token
+
+    @staticmethod
+    def get_user_access_token() -> str:
+        """Get a predefined user access token if defined.
+
+        Returns:
+            [str]: The access token, if None no user access token is defined
+        """
+        return ClientConfig.__user_access_token
+
+    @staticmethod
     def __get_envvar(key: str):
         env = os.environ
         try:
             return (True, env[key])
         except:
             return (False, "")
```

## cegalprizm/hub/connector.py

```diff
@@ -1,28 +1,49 @@
 # Copyright 2023 Cegal AS
 # All rights reserved.
 # Unauthorized copying of this file, via any medium is strictly prohibited.
+#
+# This file holds the HubConnector class which is used to connect to a Cegal Hub Server and provide a set of tasks that can be executed 
+# through the Hub Server. The HubConnector class manages a connection to Hub and handles requests and deliveres responses to the Hub instance. 
+# Connection parameters and information is specified in the constructor of the HubConnector class, whilst tasks are made available through 
+# the HubTaskRegistry that is passed to it as an argument to the start method.
+#
+# The connection to Hub, and handling of responses and requests are handled on an seperate thread that runs _do_connector_tasks in an indefinite 
+# loop.
+#
+# Requests from hub are yielded from an iterator set up by calling connector_task_stub.DoConnectorTasks, whilst responses from the connector 
+# are delivered by emplacing them in the _response_q Queue.
 
+
+import inspect
 from typing import Dict, Iterable
 
 import os
 import threading
 import socket
 import sys
 import time
 import queue
+import traceback
 
 from . import logger
+from .capability import TaskType
 from .connection_parameters import ConnectionParameters
-from .connector_task_service_pb2 import CONNECTOR_UNARY, CONNECTOR_CLIENT_STREAMING, CONNECTOR_STREAMING
-from .connector_task_service_pb2 import Connect, ConnectorResponse, ConnectorTaskResult
+from .connector_task_service_pb2 import CONNECTOR_UNARY, CONNECTOR_STREAMING, CONNECTOR_CLIENT_STREAMING
+from .connector_task_service_pb2 import Connect, ConnectorResponse, ConnectorTaskResult, ConnectorTask
 from .connector_task_service_pb2_grpc import ConnectorTaskServiceStub
 from .hub_channel import HubChannel
 from .task_registry import HubTaskRegistry
 
+class TaskContext():
+    def __init__(self, major_version = None, minor_version = None, cancellation_token = None, metadata = None):
+        self.major_version = major_version
+        self.minor_version = minor_version
+        self.cancellation_token = cancellation_token
+        self.metadata = metadata
 
 class HubConnector():
     """A generic HubConnector which can be extended by concrete implementations. This API is considered experimental.
 
     Args:
         HubChannel ([HubChannel]): A HubChannel object which defines the connection to a Cegal Hub Server
 
@@ -69,15 +90,18 @@
         connectorInfo.join_token = self._join_token
         connectorInfo.reconnect_id = self._reconnect_id
         
         for task in task_registry.get_supported_tasks():
             connectorInfo.supported_payloads[task.wellknown_payload_identifier].wellknown_payload_identifier = task.wellknown_payload_identifier
             connectorInfo.supported_payloads[task.wellknown_payload_identifier].friendly_name = task.friendly_name
             connectorInfo.supported_payloads[task.wellknown_payload_identifier].description = task.description
-            connectorInfo.supported_payloads[task.wellknown_payload_identifier].supported_rpc_types.append(CONNECTOR_UNARY)
+            if task.task_type == TaskType.UNARY:
+                connectorInfo.supported_payloads[task.wellknown_payload_identifier].supported_rpc_types.append(CONNECTOR_UNARY)
+            elif task.task_type == TaskType.SERVER_STREAMING:
+                connectorInfo.supported_payloads[task.wellknown_payload_identifier].supported_rpc_types.append(CONNECTOR_STREAMING)
             connectorInfo.supported_payloads[task.wellknown_payload_identifier].major_version = task.major_version
             connectorInfo.supported_payloads[task.wellknown_payload_identifier].minor_version = task.minor_version
             if task.payload_auth is not None:
                 for audience in task.payload_auth.required_audiences:
                     connectorInfo.supported_payloads[task.wellknown_payload_identifier].auth.required_audience.append(audience)
                 for claim in task.payload_auth.required_app_claims:
                     connectorInfo.supported_payloads[task.wellknown_payload_identifier].auth.required_blueback_app_claims.append(claim)
@@ -91,15 +115,15 @@
         info = self._create_initial_message(task_registry)
         initial_response = ConnectorResponse(connect=info)
         yield initial_response
 
         try:
             while True:
                 try:
-                    task_result = self._response_q.get(block=True,timeout=2)
+                    task_result = self._response_q.get(block=True, timeout=2)
                     response = ConnectorResponse(task_result=task_result)
                     yield response
                     self._response_q.task_done()
                 except queue.Empty:
                     if self._done is True:
                         return  
         except Exception as error:
@@ -117,65 +141,98 @@
         task_result.request_id = request_id
         task_result.rpc_type = rpc_type
         task_result.logical_request_completed = True
         task_result.ok = True
         task_result.payload.Pack(payload)
         return task_result
 
-    def _create_failure_result(self, rpc_type, request_id, error_message):
+    def _create_failure_result(self, rpc_type, request_id, error_message, is_complete: bool = True):
         task_result = ConnectorTaskResult()
         task_result.request_id = request_id
         task_result.rpc_type = rpc_type
-        task_result.logical_request_completed = True
+        task_result.logical_request_completed = is_complete
         task_result.ok = False
         task_result.error_message = error_message
         return task_result
 
-    def _do_connector_tasks(self, task_registry):
+    def _create_streaming_result(self, rpc_type, request_id, payload, is_complete):
+        task_result = ConnectorTaskResult()
+        task_result.request_id = request_id
+        task_result.rpc_type = rpc_type
+        task_result.logical_request_completed = is_complete
+        task_result.ok = True
+        if payload:
+            task_result.payload.Pack(payload)
+        return task_result
+
+    def _do_connector_tasks(self, task_registry: HubTaskRegistry):
         while True:
             try:
                 logger.info(f"Attempting to connect to Cegal Hub")
                 hubChannel = HubChannel(self._connection_parameters, self._token_provider)
                 connector_task_stub = ConnectorTaskServiceStub(hubChannel._channel)
                 self._done = False
                 response_iterator = connector_task_stub.DoConnectorTasks(self._connector_tasks_iterator(task_registry))
                 for connectorTask in response_iterator:
-                    if connectorTask. acknowledge_connector_joined:
+                    if connectorTask.acknowledge_connector_joined:
                         self._reconnect_id = connectorTask.connector_id
                         logger.info(f"Successfully connected")
-                    else:
-                        logger.debug(f"Task {connectorTask.payload_identifier} {connectorTask.request_id}")
-
-                        if connectorTask.rpc_type == CONNECTOR_UNARY:
-                            task = task_registry.get_unary_task(connectorTask.payload_identifier)
-                            if task:
+                        continue
+                    
+                    logger.debug(f"Task {connectorTask.payload_identifier} {connectorTask.request_id}")
+
+                    if connectorTask.rpc_type == CONNECTOR_UNARY:
+                        task = task_registry.get_unary_task(connectorTask.payload_identifier)
+                        if task:
+                            sig = inspect.signature(task)
+                            if 'ctx' in sig.parameters:
+                                ctx = TaskContext(connectorTask.payload_major_version, connectorTask.payload_minor_version, None, connectorTask.metadata)
+                                result = task(ctx, connectorTask.payload)
+                            else:
                                 result = task(connectorTask.payload)
-                                if result[0]:
-                                    task_result = self._create_success_result(connectorTask.rpc_type, connectorTask.request_id, result[1])
-                                else:
-                                    task_result = self._create_failure_result(connectorTask.rpc_type, connectorTask.request_id, result[1])
+                            logger.debug(f"Unary result: {result}")
+                            if result[0]:
+                                task_result = self._create_success_result(connectorTask.rpc_type, connectorTask.request_id, result[1])
                             else:
-                                logger.warning(f"payload_identifier {connectorTask.payload_identifier} not recognised")
-                                task_result = self._create_failure_result(connectorTask.rpc_type, connectorTask.request_id, f"payload_identifier {connectorTask.payload_identifier} not recognised")
+                                task_result = self._create_failure_result(connectorTask.rpc_type, connectorTask.request_id, result[2])
+                        else:
+                            logger.warning(f"payload_identifier {connectorTask.payload_identifier} not recognised")
+                            task_result = self._create_failure_result(connectorTask.rpc_type, connectorTask.request_id, f"payload_identifier {connectorTask.payload_identifier} not recognised")
+                        self._response_q.put(task_result)
 
-                        elif connectorTask.rpc_type == CONNECTOR_CLIENT_STREAMING:
-                            logger.warning(f"Client streaming task {connectorTask.request_id}")
-                            task_result = self._create_failure_result(connectorTask.rpc_type, connectorTask.request_id, "Client streaming not supported")
-                        elif connectorTask.rpc_type == CONNECTOR_STREAMING:
-                            logger.warning(f"Server streaming task {connectorTask.request_id}")
-                            task_result = self._create_failure_result(connectorTask.rpc_type, connectorTask.request_id, "Server streaming not supported")
+                    elif connectorTask.rpc_type == CONNECTOR_STREAMING:
+                        task = task_registry.get_server_streaming_task(connectorTask.payload_identifier)
+                        if task:
+                            sig = inspect.signature(task)
+                            if 'ctx' in sig.parameters:
+                                ctx = TaskContext(connectorTask.payload_major_version, connectorTask.payload_minor_version, None, connectorTask.metadata)
+                                result_it = task(ctx, connectorTask.payload)
+                            else:
+                                result_it = task(connectorTask.payload)
+                            for result in result_it:
+                                logger.debug(f"Streaming result: {result}")
+                                if result[0]:
+                                    task_result = self._create_streaming_result(connectorTask.rpc_type, connectorTask.request_id, result[2], result[1])
+                                else:
+                                    task_result = self._create_failure_result(connectorTask.rpc_type, connectorTask.request_id, result[3], result[1])
+                                self._response_q.put(task_result)
+                            logger.debug(f"Stream complete")
                         else:
-                            logger.error(f"Unknown RpcType {connectorTask}")
-                            task_result = self._create_failure_result(connectorTask.rpc_type, connectorTask.request_id, "Unknown rpc type")
+                            logger.warning(f"payload_identifier {connectorTask.payload_identifier} not recognised")
+                            task_result = self._create_failure_result(connectorTask.rpc_type, connectorTask.request_id, "Server streaming not supported")
+                            self._response_q.put(task_result)
 
+                    else:
+                        logger.error(f"Unknown RpcType {connectorTask}")
+                        task_result = self._create_failure_result(connectorTask.rpc_type, connectorTask.request_id, "Unknown rpc type")
                         self._response_q.put(task_result)
-                        logger.debug(f"Task response queued")
 
             except Exception as error:
-                logger.error(f"_do_connector_tasks: {error}")
+                logger.error(f"_do_connector_tasks: {error}: {error.args}")
+                logger.error(f"_do_connector_tasks: {traceback.format_exc()}")
                 self._done = True
 
             logger.debug(f"Clearing response q")
             with self._response_q.mutex:
                 self._response_q.queue.clear()
                 self._response_q.all_tasks_done.notify_all()
                 self._response_q.unfinished_tasks = 0
```

## cegalprizm/hub/connector_filter.py

```diff
@@ -1,10 +1,13 @@
 # Copyright 2023 Cegal AS
 # All rights reserved.
 # Unauthorized copying of this file, via any medium is strictly prohibited.
+#
+# This file contains the ConnectorFilter class which is used to target a particular instances of a Connector that is joined 
+# to Cegal Hub Server. It filters possible connectors based on either a target_connector_id or a labels_dict.
 
 
 class ConnectorFilter():
     """A filter to target a particular instance of a Connector that is joined to Cegal Hub Server.
     If a target_connector_id is provided this ensures that a connector with given id will be addressed.
     Alternatively a dictionary of labels may be provided. This dictionary of strings are key - value pairs 
     for labels that a Connector has. Any specified labels must be satisfied by the Connector for that Connector to be targeted.
```

## cegalprizm/hub/connector_task_service_pb2.py

```diff
@@ -17,15 +17,15 @@
 
 DESCRIPTOR = _descriptor.FileDescriptor(
   name='cegalprizm/hub/connector_task_service.proto',
   package='hub',
   syntax='proto3',
   serialized_options=b'Z\t./grpcgen',
   create_key=_descriptor._internal_create_key,
-  serialized_pb=b'\n+cegalprizm/hub/connector_task_service.proto\x12\x03hub\x1a\x19google/protobuf/any.proto\"\xa9\x01\n\x11\x43onnectorResponse\x12\x1f\n\x07\x63onnect\x18\x01 \x01(\x0b\x32\x0c.hub.ConnectH\x00\x12/\n\x0btask_result\x18\x02 \x01(\x0b\x32\x18.hub.ConnectorTaskResultH\x00\x12\x1d\n\x06update\x18\x03 \x01(\x0b\x32\x0b.hub.UpdateH\x00\x12\x1b\n\x05\x65mpty\x18\x04 \x01(\x0b\x32\n.hub.EmptyH\x00\x42\x06\n\x04type\"`\n\x06Update\x12\'\n\x06labels\x18\x01 \x03(\x0b\x32\x17.hub.Update.LabelsEntry\x1a-\n\x0bLabelsEntry\x12\x0b\n\x03key\x18\x01 \x01(\t\x12\r\n\x05value\x18\x02 \x01(\t:\x02\x38\x01\"\x07\n\x05\x45mpty\"\x9d\x04\n\x07\x43onnect\x12\x1c\n\x14wellknown_identifier\x18\x01 \x01(\t\x12\x15\n\rfriendly_name\x18\x02 \x01(\t\x12\x13\n\x0b\x64\x65scription\x18\x03 \x01(\t\x12\x11\n\thost_name\x18\x04 \x01(\t\x12\x18\n\x10operating_system\x18\x05 \x01(\t\x12\x0f\n\x07version\x18\x06 \x01(\t\x12\x15\n\rbuild_version\x18\x07 \x01(\t\x12 \n\x18supports_public_requests\x18\x08 \x01(\x08\x12?\n\x12supported_payloads\x18\t \x03(\x0b\x32#.hub.Connect.SupportedPayloadsEntry\x12(\n\x06labels\x18\n \x03(\x0b\x32\x18.hub.Connect.LabelsEntry\x12\x14\n\x0creconnect_id\x18\x0b \x01(\t\x12\x12\n\njoin_token\x18\x0c \x01(\t\x12\x1c\n\x14launched_by_agent_id\x18\r \x01(\t\x12\x1e\n\x16launched_by_request_id\x18\x0e \x01(\t\x1aO\n\x16SupportedPayloadsEntry\x12\x0b\n\x03key\x18\x01 \x01(\t\x12$\n\x05value\x18\x02 \x01(\x0b\x32\x15.hub.SupportedPayload:\x02\x38\x01\x1a-\n\x0bLabelsEntry\x12\x0b\n\x03key\x18\x01 \x01(\t\x12\r\n\x05value\x18\x02 \x01(\t:\x02\x38\x01\"\xe4\x02\n\rConnectorTask\x12\x12\n\nrequest_id\x18\x01 \x01(\t\x12\x14\n\x0c\x63onnector_id\x18\x02 \x01(\t\x12\x1e\n\x08rpc_type\x18\x03 \x01(\x0e\x32\x0c.hub.RpcType\x12%\n\x07payload\x18\x04 \x01(\x0b\x32\x14.google.protobuf.Any\x12\x1a\n\x12payload_identifier\x18\x05 \x01(\t\x12\x32\n*logical_client_streaming_request_completed\x18\x06 \x01(\x08\x12$\n\x1c\x61\x63knowledge_connector_joined\x18\x07 \x01(\x08\x12\x1d\n\x15payload_major_version\x18\x08 \x01(\x05\x12\x1d\n\x15payload_minor_version\x18\t \x01(\x05\x12.\n&logical_client_streaming_request_begin\x18\n \x01(\x08\"\x9b\x02\n\x13\x43onnectorTaskResult\x12\x12\n\nrequest_id\x18\x01 \x01(\t\x12\n\n\x02ok\x18\x02 \x01(\x08\x12\x15\n\rerror_message\x18\x03 \x01(\t\x12\x1e\n\x08rpc_type\x18\x04 \x01(\x0e\x32\x0c.hub.RpcType\x12!\n\x19logical_request_completed\x18\x05 \x01(\x08\x12%\n\x07payload\x18\x06 \x01(\x0b\x32\x14.google.protobuf.Any\x12\x34\n\x06labels\x18\x07 \x03(\x0b\x32$.hub.ConnectorTaskResult.LabelsEntry\x1a-\n\x0bLabelsEntry\x12\x0b\n\x03key\x18\x01 \x01(\t\x12\r\n\x05value\x18\x02 \x01(\t:\x02\x38\x01\"\x8c\x02\n\x10SupportedPayload\x12$\n\x1cwellknown_payload_identifier\x18\x01 \x01(\t\x12\x15\n\rfriendly_name\x18\x02 \x01(\t\x12\x13\n\x0b\x64\x65scription\x18\x03 \x01(\t\x12)\n\x13supported_rpc_types\x18\x04 \x03(\x0e\x32\x0c.hub.RpcType\x12\x17\n\x04\x61uth\x18\x05 \x01(\x0b\x32\t.hub.Auth\x12\x15\n\rmajor_version\x18\x06 \x01(\x05\x12\x15\n\rminor_version\x18\x07 \x01(\x05\x12\x34\n\x10version_strategy\x18\x08 \x01(\x0e\x32\x1a.hub.PayloadVersionStategy\"G\n\x04\x41uth\x12\x19\n\x11required_audience\x18\x01 \x03(\t\x12$\n\x1crequired_blueback_app_claims\x18\x02 \x03(\t\"Y\n\x0f\x43onnectorJoined\x12\x12\n\nrequest_id\x18\x01 \x01(\t\x12\x1c\n\x14wellknown_identifier\x18\x02 \x01(\t\x12\x14\n\x0c\x63onnector_id\x18\x03 \x01(\t*W\n\x07RpcType\x12\x13\n\x0f\x43ONNECTOR_UNARY\x10\x00\x12\x17\n\x13\x43ONNECTOR_STREAMING\x10\x01\x12\x1e\n\x1a\x43ONNECTOR_CLIENT_STREAMING\x10\x02*M\n\x15PayloadVersionStategy\x12\x08\n\x04NONE\x10\x00\x12\x11\n\rENFORCE_MAJOR\x10\x01\x12\x17\n\x13\x45NFORCE_MAJOR_MINOR\x10\x02\x32\\\n\x14\x43onnectorTaskService\x12\x44\n\x10\x44oConnectorTasks\x12\x16.hub.ConnectorResponse\x1a\x12.hub.ConnectorTask\"\x00(\x01\x30\x01\x42\x0bZ\t./grpcgenb\x06proto3'
+  serialized_pb=b'\n+cegalprizm/hub/connector_task_service.proto\x12\x03hub\x1a\x19google/protobuf/any.proto\"\xa9\x01\n\x11\x43onnectorResponse\x12\x1f\n\x07\x63onnect\x18\x01 \x01(\x0b\x32\x0c.hub.ConnectH\x00\x12/\n\x0btask_result\x18\x02 \x01(\x0b\x32\x18.hub.ConnectorTaskResultH\x00\x12\x1d\n\x06update\x18\x03 \x01(\x0b\x32\x0b.hub.UpdateH\x00\x12\x1b\n\x05\x65mpty\x18\x04 \x01(\x0b\x32\n.hub.EmptyH\x00\x42\x06\n\x04type\"`\n\x06Update\x12\'\n\x06labels\x18\x01 \x03(\x0b\x32\x17.hub.Update.LabelsEntry\x1a-\n\x0bLabelsEntry\x12\x0b\n\x03key\x18\x01 \x01(\t\x12\r\n\x05value\x18\x02 \x01(\t:\x02\x38\x01\"\x07\n\x05\x45mpty\"\x9d\x04\n\x07\x43onnect\x12\x1c\n\x14wellknown_identifier\x18\x01 \x01(\t\x12\x15\n\rfriendly_name\x18\x02 \x01(\t\x12\x13\n\x0b\x64\x65scription\x18\x03 \x01(\t\x12\x11\n\thost_name\x18\x04 \x01(\t\x12\x18\n\x10operating_system\x18\x05 \x01(\t\x12\x0f\n\x07version\x18\x06 \x01(\t\x12\x15\n\rbuild_version\x18\x07 \x01(\t\x12 \n\x18supports_public_requests\x18\x08 \x01(\x08\x12?\n\x12supported_payloads\x18\t \x03(\x0b\x32#.hub.Connect.SupportedPayloadsEntry\x12(\n\x06labels\x18\n \x03(\x0b\x32\x18.hub.Connect.LabelsEntry\x12\x14\n\x0creconnect_id\x18\x0b \x01(\t\x12\x12\n\njoin_token\x18\x0c \x01(\t\x12\x1c\n\x14launched_by_agent_id\x18\r \x01(\t\x12\x1e\n\x16launched_by_request_id\x18\x0e \x01(\t\x1aO\n\x16SupportedPayloadsEntry\x12\x0b\n\x03key\x18\x01 \x01(\t\x12$\n\x05value\x18\x02 \x01(\x0b\x32\x15.hub.SupportedPayload:\x02\x38\x01\x1a-\n\x0bLabelsEntry\x12\x0b\n\x03key\x18\x01 \x01(\t\x12\r\n\x05value\x18\x02 \x01(\t:\x02\x38\x01\"\xc9\x03\n\rConnectorTask\x12\x12\n\nrequest_id\x18\x01 \x01(\t\x12\x14\n\x0c\x63onnector_id\x18\x02 \x01(\t\x12\x1e\n\x08rpc_type\x18\x03 \x01(\x0e\x32\x0c.hub.RpcType\x12%\n\x07payload\x18\x04 \x01(\x0b\x32\x14.google.protobuf.Any\x12\x1a\n\x12payload_identifier\x18\x05 \x01(\t\x12\x32\n*logical_client_streaming_request_completed\x18\x06 \x01(\x08\x12$\n\x1c\x61\x63knowledge_connector_joined\x18\x07 \x01(\x08\x12\x1d\n\x15payload_major_version\x18\x08 \x01(\x05\x12\x1d\n\x15payload_minor_version\x18\t \x01(\x05\x12.\n&logical_client_streaming_request_begin\x18\n \x01(\x08\x12\x32\n\x08metadata\x18\x0b \x03(\x0b\x32 .hub.ConnectorTask.MetadataEntry\x1a/\n\rMetadataEntry\x12\x0b\n\x03key\x18\x01 \x01(\t\x12\r\n\x05value\x18\x02 \x01(\t:\x02\x38\x01\"\x9b\x02\n\x13\x43onnectorTaskResult\x12\x12\n\nrequest_id\x18\x01 \x01(\t\x12\n\n\x02ok\x18\x02 \x01(\x08\x12\x15\n\rerror_message\x18\x03 \x01(\t\x12\x1e\n\x08rpc_type\x18\x04 \x01(\x0e\x32\x0c.hub.RpcType\x12!\n\x19logical_request_completed\x18\x05 \x01(\x08\x12%\n\x07payload\x18\x06 \x01(\x0b\x32\x14.google.protobuf.Any\x12\x34\n\x06labels\x18\x07 \x03(\x0b\x32$.hub.ConnectorTaskResult.LabelsEntry\x1a-\n\x0bLabelsEntry\x12\x0b\n\x03key\x18\x01 \x01(\t\x12\r\n\x05value\x18\x02 \x01(\t:\x02\x38\x01\"\x8c\x02\n\x10SupportedPayload\x12$\n\x1cwellknown_payload_identifier\x18\x01 \x01(\t\x12\x15\n\rfriendly_name\x18\x02 \x01(\t\x12\x13\n\x0b\x64\x65scription\x18\x03 \x01(\t\x12)\n\x13supported_rpc_types\x18\x04 \x03(\x0e\x32\x0c.hub.RpcType\x12\x17\n\x04\x61uth\x18\x05 \x01(\x0b\x32\t.hub.Auth\x12\x15\n\rmajor_version\x18\x06 \x01(\x05\x12\x15\n\rminor_version\x18\x07 \x01(\x05\x12\x34\n\x10version_strategy\x18\x08 \x01(\x0e\x32\x1a.hub.PayloadVersionStategy\"G\n\x04\x41uth\x12\x19\n\x11required_audience\x18\x01 \x03(\t\x12$\n\x1crequired_blueback_app_claims\x18\x02 \x03(\t\"Y\n\x0f\x43onnectorJoined\x12\x12\n\nrequest_id\x18\x01 \x01(\t\x12\x1c\n\x14wellknown_identifier\x18\x02 \x01(\t\x12\x14\n\x0c\x63onnector_id\x18\x03 \x01(\t*W\n\x07RpcType\x12\x13\n\x0f\x43ONNECTOR_UNARY\x10\x00\x12\x17\n\x13\x43ONNECTOR_STREAMING\x10\x01\x12\x1e\n\x1a\x43ONNECTOR_CLIENT_STREAMING\x10\x02*M\n\x15PayloadVersionStategy\x12\x08\n\x04NONE\x10\x00\x12\x11\n\rENFORCE_MAJOR\x10\x01\x12\x17\n\x13\x45NFORCE_MAJOR_MINOR\x10\x02\x32\\\n\x14\x43onnectorTaskService\x12\x44\n\x10\x44oConnectorTasks\x12\x16.hub.ConnectorResponse\x1a\x12.hub.ConnectorTask\"\x00(\x01\x30\x01\x42\x0bZ\t./grpcgenb\x06proto3'
   ,
   dependencies=[google_dot_protobuf_dot_any__pb2.DESCRIPTOR,])
 
 _RPCTYPE = _descriptor.EnumDescriptor(
   name='RpcType',
   full_name='hub.RpcType',
   filename=None,
@@ -46,16 +46,16 @@
       name='CONNECTOR_CLIENT_STREAMING', index=2, number=2,
       serialized_options=None,
       type=None,
       create_key=_descriptor._internal_create_key),
   ],
   containing_type=None,
   serialized_options=None,
-  serialized_start=1982,
-  serialized_end=2069,
+  serialized_start=2083,
+  serialized_end=2170,
 )
 _sym_db.RegisterEnumDescriptor(_RPCTYPE)
 
 RpcType = enum_type_wrapper.EnumTypeWrapper(_RPCTYPE)
 _PAYLOADVERSIONSTATEGY = _descriptor.EnumDescriptor(
   name='PayloadVersionStategy',
   full_name='hub.PayloadVersionStategy',
@@ -77,16 +77,16 @@
       name='ENFORCE_MAJOR_MINOR', index=2, number=2,
       serialized_options=None,
       type=None,
       create_key=_descriptor._internal_create_key),
   ],
   containing_type=None,
   serialized_options=None,
-  serialized_start=2071,
-  serialized_end=2148,
+  serialized_start=2172,
+  serialized_end=2249,
 )
 _sym_db.RegisterEnumDescriptor(_PAYLOADVERSIONSTATEGY)
 
 PayloadVersionStategy = enum_type_wrapper.EnumTypeWrapper(_PAYLOADVERSIONSTATEGY)
 CONNECTOR_UNARY = 0
 CONNECTOR_STREAMING = 1
 CONNECTOR_CLIENT_STREAMING = 2
@@ -444,14 +444,52 @@
   oneofs=[
   ],
   serialized_start=359,
   serialized_end=900,
 )
 
 
+_CONNECTORTASK_METADATAENTRY = _descriptor.Descriptor(
+  name='MetadataEntry',
+  full_name='hub.ConnectorTask.MetadataEntry',
+  filename=None,
+  file=DESCRIPTOR,
+  containing_type=None,
+  create_key=_descriptor._internal_create_key,
+  fields=[
+    _descriptor.FieldDescriptor(
+      name='key', full_name='hub.ConnectorTask.MetadataEntry.key', index=0,
+      number=1, type=9, cpp_type=9, label=1,
+      has_default_value=False, default_value=b"".decode('utf-8'),
+      message_type=None, enum_type=None, containing_type=None,
+      is_extension=False, extension_scope=None,
+      serialized_options=None, file=DESCRIPTOR,  create_key=_descriptor._internal_create_key),
+    _descriptor.FieldDescriptor(
+      name='value', full_name='hub.ConnectorTask.MetadataEntry.value', index=1,
+      number=2, type=9, cpp_type=9, label=1,
+      has_default_value=False, default_value=b"".decode('utf-8'),
+      message_type=None, enum_type=None, containing_type=None,
+      is_extension=False, extension_scope=None,
+      serialized_options=None, file=DESCRIPTOR,  create_key=_descriptor._internal_create_key),
+  ],
+  extensions=[
+  ],
+  nested_types=[],
+  enum_types=[
+  ],
+  serialized_options=b'8\001',
+  is_extendable=False,
+  syntax='proto3',
+  extension_ranges=[],
+  oneofs=[
+  ],
+  serialized_start=1313,
+  serialized_end=1360,
+)
+
 _CONNECTORTASK = _descriptor.Descriptor(
   name='ConnectorTask',
   full_name='hub.ConnectorTask',
   filename=None,
   file=DESCRIPTOR,
   containing_type=None,
   create_key=_descriptor._internal_create_key,
@@ -522,28 +560,35 @@
     _descriptor.FieldDescriptor(
       name='logical_client_streaming_request_begin', full_name='hub.ConnectorTask.logical_client_streaming_request_begin', index=9,
       number=10, type=8, cpp_type=7, label=1,
       has_default_value=False, default_value=False,
       message_type=None, enum_type=None, containing_type=None,
       is_extension=False, extension_scope=None,
       serialized_options=None, file=DESCRIPTOR,  create_key=_descriptor._internal_create_key),
+    _descriptor.FieldDescriptor(
+      name='metadata', full_name='hub.ConnectorTask.metadata', index=10,
+      number=11, type=11, cpp_type=10, label=3,
+      has_default_value=False, default_value=[],
+      message_type=None, enum_type=None, containing_type=None,
+      is_extension=False, extension_scope=None,
+      serialized_options=None, file=DESCRIPTOR,  create_key=_descriptor._internal_create_key),
   ],
   extensions=[
   ],
-  nested_types=[],
+  nested_types=[_CONNECTORTASK_METADATAENTRY, ],
   enum_types=[
   ],
   serialized_options=None,
   is_extendable=False,
   syntax='proto3',
   extension_ranges=[],
   oneofs=[
   ],
   serialized_start=903,
-  serialized_end=1259,
+  serialized_end=1360,
 )
 
 
 _CONNECTORTASKRESULT_LABELSENTRY = _descriptor.Descriptor(
   name='LabelsEntry',
   full_name='hub.ConnectorTaskResult.LabelsEntry',
   filename=None,
@@ -646,16 +691,16 @@
   ],
   serialized_options=None,
   is_extendable=False,
   syntax='proto3',
   extension_ranges=[],
   oneofs=[
   ],
-  serialized_start=1262,
-  serialized_end=1545,
+  serialized_start=1363,
+  serialized_end=1646,
 )
 
 
 _SUPPORTEDPAYLOAD = _descriptor.Descriptor(
   name='SupportedPayload',
   full_name='hub.SupportedPayload',
   filename=None,
@@ -727,16 +772,16 @@
   ],
   serialized_options=None,
   is_extendable=False,
   syntax='proto3',
   extension_ranges=[],
   oneofs=[
   ],
-  serialized_start=1548,
-  serialized_end=1816,
+  serialized_start=1649,
+  serialized_end=1917,
 )
 
 
 _AUTH = _descriptor.Descriptor(
   name='Auth',
   full_name='hub.Auth',
   filename=None,
@@ -766,16 +811,16 @@
   ],
   serialized_options=None,
   is_extendable=False,
   syntax='proto3',
   extension_ranges=[],
   oneofs=[
   ],
-  serialized_start=1818,
-  serialized_end=1889,
+  serialized_start=1919,
+  serialized_end=1990,
 )
 
 
 _CONNECTORJOINED = _descriptor.Descriptor(
   name='ConnectorJoined',
   full_name='hub.ConnectorJoined',
   filename=None,
@@ -812,16 +857,16 @@
   ],
   serialized_options=None,
   is_extendable=False,
   syntax='proto3',
   extension_ranges=[],
   oneofs=[
   ],
-  serialized_start=1891,
-  serialized_end=1980,
+  serialized_start=1992,
+  serialized_end=2081,
 )
 
 _CONNECTORRESPONSE.fields_by_name['connect'].message_type = _CONNECT
 _CONNECTORRESPONSE.fields_by_name['task_result'].message_type = _CONNECTORTASKRESULT
 _CONNECTORRESPONSE.fields_by_name['update'].message_type = _UPDATE
 _CONNECTORRESPONSE.fields_by_name['empty'].message_type = _EMPTY
 _CONNECTORRESPONSE.oneofs_by_name['type'].fields.append(
@@ -839,16 +884,18 @@
 _UPDATE_LABELSENTRY.containing_type = _UPDATE
 _UPDATE.fields_by_name['labels'].message_type = _UPDATE_LABELSENTRY
 _CONNECT_SUPPORTEDPAYLOADSENTRY.fields_by_name['value'].message_type = _SUPPORTEDPAYLOAD
 _CONNECT_SUPPORTEDPAYLOADSENTRY.containing_type = _CONNECT
 _CONNECT_LABELSENTRY.containing_type = _CONNECT
 _CONNECT.fields_by_name['supported_payloads'].message_type = _CONNECT_SUPPORTEDPAYLOADSENTRY
 _CONNECT.fields_by_name['labels'].message_type = _CONNECT_LABELSENTRY
+_CONNECTORTASK_METADATAENTRY.containing_type = _CONNECTORTASK
 _CONNECTORTASK.fields_by_name['rpc_type'].enum_type = _RPCTYPE
 _CONNECTORTASK.fields_by_name['payload'].message_type = google_dot_protobuf_dot_any__pb2._ANY
+_CONNECTORTASK.fields_by_name['metadata'].message_type = _CONNECTORTASK_METADATAENTRY
 _CONNECTORTASKRESULT_LABELSENTRY.containing_type = _CONNECTORTASKRESULT
 _CONNECTORTASKRESULT.fields_by_name['rpc_type'].enum_type = _RPCTYPE
 _CONNECTORTASKRESULT.fields_by_name['payload'].message_type = google_dot_protobuf_dot_any__pb2._ANY
 _CONNECTORTASKRESULT.fields_by_name['labels'].message_type = _CONNECTORTASKRESULT_LABELSENTRY
 _SUPPORTEDPAYLOAD.fields_by_name['supported_rpc_types'].enum_type = _RPCTYPE
 _SUPPORTEDPAYLOAD.fields_by_name['auth'].message_type = _AUTH
 _SUPPORTEDPAYLOAD.fields_by_name['version_strategy'].enum_type = _PAYLOADVERSIONSTATEGY
@@ -914,19 +961,27 @@
   # @@protoc_insertion_point(class_scope:hub.Connect)
   })
 _sym_db.RegisterMessage(Connect)
 _sym_db.RegisterMessage(Connect.SupportedPayloadsEntry)
 _sym_db.RegisterMessage(Connect.LabelsEntry)
 
 ConnectorTask = _reflection.GeneratedProtocolMessageType('ConnectorTask', (_message.Message,), {
+
+  'MetadataEntry' : _reflection.GeneratedProtocolMessageType('MetadataEntry', (_message.Message,), {
+    'DESCRIPTOR' : _CONNECTORTASK_METADATAENTRY,
+    '__module__' : 'cegalprizm.hub.connector_task_service_pb2'
+    # @@protoc_insertion_point(class_scope:hub.ConnectorTask.MetadataEntry)
+    })
+  ,
   'DESCRIPTOR' : _CONNECTORTASK,
   '__module__' : 'cegalprizm.hub.connector_task_service_pb2'
   # @@protoc_insertion_point(class_scope:hub.ConnectorTask)
   })
 _sym_db.RegisterMessage(ConnectorTask)
+_sym_db.RegisterMessage(ConnectorTask.MetadataEntry)
 
 ConnectorTaskResult = _reflection.GeneratedProtocolMessageType('ConnectorTaskResult', (_message.Message,), {
 
   'LabelsEntry' : _reflection.GeneratedProtocolMessageType('LabelsEntry', (_message.Message,), {
     'DESCRIPTOR' : _CONNECTORTASKRESULT_LABELSENTRY,
     '__module__' : 'cegalprizm.hub.connector_task_service_pb2'
     # @@protoc_insertion_point(class_scope:hub.ConnectorTaskResult.LabelsEntry)
@@ -961,25 +1016,26 @@
 _sym_db.RegisterMessage(ConnectorJoined)
 
 
 DESCRIPTOR._options = None
 _UPDATE_LABELSENTRY._options = None
 _CONNECT_SUPPORTEDPAYLOADSENTRY._options = None
 _CONNECT_LABELSENTRY._options = None
+_CONNECTORTASK_METADATAENTRY._options = None
 _CONNECTORTASKRESULT_LABELSENTRY._options = None
 
 _CONNECTORTASKSERVICE = _descriptor.ServiceDescriptor(
   name='ConnectorTaskService',
   full_name='hub.ConnectorTaskService',
   file=DESCRIPTOR,
   index=0,
   serialized_options=None,
   create_key=_descriptor._internal_create_key,
-  serialized_start=2150,
-  serialized_end=2242,
+  serialized_start=2251,
+  serialized_end=2343,
   methods=[
   _descriptor.MethodDescriptor(
     name='DoConnectorTasks',
     full_name='hub.ConnectorTaskService.DoConnectorTasks',
     index=0,
     containing_service=None,
     input_type=_CONNECTORRESPONSE,
```

## cegalprizm/hub/hub_channel.py

```diff
@@ -1,55 +1,66 @@
 # Copyright 2023 Cegal AS
 # All rights reserved.
 # Unauthorized copying of this file, via any medium is strictly prohibited.
+#
+# This file contains the HubChannel class which is a wrapper class used to create a GRPC channel for use with a Cegal
+# Hub Server. Its initializor allows configuration of connection parameters and access token provider.
 
 import grpc
 
 from cegal.keystone_auth import OidcClient, OidcOptions
 from cegal.keystone_auth.responses import CegalProductTemplate
 
 from . import logger
 from .keystone_auth_interceptor import auth_header_interceptor
+from .client_config import ClientConfig
 from .connection_parameters import ConnectionParameters
 from .server_config import ServerConfig
+from .in_memory_token_provider import InMemoryTokenProvider
+
 
 class HubChannel:
     """A Cegal Hub configured GRPC channel for use with a Cegal Hub Server.
     """
 
     def __init__(self, connection_parameters: ConnectionParameters = None, token_provider=None):
         """Create a HubChannel which wraps a GRPC channel
 
         Args:
-            connection_parameters (ConnectionParameters, optional): The connection paramaters for communicating with a Cegal Hub Server. Defaults to None.
+            connection_parameters (ConnectionParameters, optional): The connection parameters for communicating with a Cegal Hub Server. Defaults to None.
             token_provider (token_provider, optional): Most often an OidcClient object. Defaults to None.
         """
         if connection_parameters is None:
             connection_parameters = ConnectionParameters()
         self._channel = None
         host = connection_parameters.host
         port = connection_parameters.port
         url = host + ":" + str(port)
         logger.debug(f"HubChannel using url {url}")
         self._token_provider = token_provider
         if connection_parameters.use_auth:
+            logger.debug(f"HubChannel use auth")
             if token_provider is None:
-                logger.debug(f"HubChannel requires auth and no explicit token provider specified, so will use the prizm clientid")
-                oidc_options = OidcOptions(client_id="prizm",
-                                           provider_uri=ServerConfig.get_keystone_url(),
-                                           audiences=["hub_connector_api"],
-                                           extra_scopes=["offline_access", "hub_connector_api"])
-                self._token_provider = OidcClient(oidc_options,
-                page_handler=CegalProductTemplate(
-                product="Cegal Prizm",
-                extra="<h3>You have successfully logged into Cegal Prizm</h3>"))
+                user_access_token = ClientConfig.get_user_access_token()
+                if user_access_token:
+                    logger.error(f"HubChannel requires auth and will use the provided access token")
+                    self._token_provider = InMemoryTokenProvider(user_access_token)
+                else:
+                    logger.error(f"HubChannel requires auth and no explicit token provider specified, so will use the prizm clientid")
+                    oidc_options = OidcOptions(client_id="prizm",
+                                               provider_uri=ServerConfig.get_keystone_url(),
+                                               audiences=["hub_connector_api"],
+                                               extra_scopes=["offline_access", "hub_connector_api"])
+                    self._token_provider = OidcClient(oidc_options,
+                                                      page_handler=CegalProductTemplate(product="Cegal Prizm",
+                                                                                        extra="<h3>You have successfully logged into Cegal Prizm</h3>"))
 
         chan = None
         channel_options = [
-            ("grpc.max_receive_message_length", 524288000), 
+            ("grpc.max_receive_message_length", 524288000),
             ("grpc.max_send_message_length", 524288000)
         ]
 
         if connection_parameters.use_tls:
             logger.debug("HubChannel creating a secure tls grpc channel")
             chan = grpc.secure_channel(url, grpc.ssl_channel_credentials(), options=channel_options)
         else:
```

## cegalprizm/hub/task_registry.py

```diff
@@ -1,15 +1,24 @@
 # Copyright 2023 Cegal AS
 # All rights reserved.
 # Unauthorized copying of this file, via any medium is strictly prohibited.
+#
+# This file contains the HubTaskRegistry class which is used to register tasks that Hub clients can execute by
+# by sending requests to the Hub Connector holding this task registry. The HubTaskRegistry holds registered hub tasks 
+# that are identified by their wellknown_payload_identifier. The tasks are represented as HubCapabilities. The HubTaskRegistry 
+# methods enable caller to:
+# * Register tasks
+# * Retrieve tasks
+
 
 from types import FunctionType
 from typing import Dict, Iterator, Tuple
 
-from .capability import HubCapability
+from . import logger
+from .capability import HubCapability, TaskType
 from .payload_auth import PayloadAuth
 
 
 class HubTaskRegistry:
 
     def __init__(self):
         self._supported_tasks: Dict[str, HubCapability] = {}
@@ -18,17 +27,51 @@
                             wellknown_payload_identifier: str,
                             task: FunctionType,
                             friendly_name: str,
                             description: str,
                             payload_auth: PayloadAuth,
                             major_version: int = 0,
                             minor_version: int = 0) -> Tuple[bool, str]:
-        self._supported_tasks[wellknown_payload_identifier] = HubCapability(wellknown_payload_identifier, task, friendly_name, description, payload_auth, major_version, minor_version)
+        capability = HubCapability(TaskType.UNARY, wellknown_payload_identifier, task, friendly_name, description, payload_auth, major_version, minor_version)
+        self._supported_tasks[wellknown_payload_identifier] = capability
+
+    def register_server_streaming_task(self,
+                                       wellknown_payload_identifier: str,
+                                       task: FunctionType,
+                                       friendly_name: str,
+                                       description: str,
+                                       payload_auth: PayloadAuth,
+                                       major_version: int = 0,
+                                       minor_version: int = 0) -> Tuple[bool, str]:
+        capability = HubCapability(TaskType.SERVER_STREAMING, wellknown_payload_identifier, task, friendly_name, description, payload_auth, major_version, minor_version)
+        self._supported_tasks[wellknown_payload_identifier] = capability
 
     def get_supported_tasks(self) -> Iterator[HubCapability]:
         for task in self._supported_tasks.values():
             yield task
 
     def get_unary_task(self, wellknown_payload_identifier) -> FunctionType:
-        if wellknown_payload_identifier not in self._supported_tasks.keys():
+        capability = self._supported_tasks.get(wellknown_payload_identifier)
+        if capability is None:
+            return None
+        if capability.task_type != TaskType.UNARY:
+            logger.warning(f"payload_identifier {wellknown_payload_identifier} is not a UNARY task")
+            return None
+        return capability.task
+
+    # def get_client_streaming_task(self, wellknown_payload_identifier) -> FunctionType:
+    #     capability = self._supported_tasks.get(wellknown_payload_identifier)
+    #     if capability is None:
+    #         return None
+    #     if capability.task_type != TaskType.CLIENT_STREAMING:
+    #         logger.warning(f"payload_identifier {wellknown_payload_identifier} is not a CLIENT_STREAMING task")
+    #         return None
+    #     return capability.task
+
+    def get_server_streaming_task(self, wellknown_payload_identifier) -> FunctionType:
+        capability = self._supported_tasks.get(wellknown_payload_identifier)
+        if capability is None:
+            return None
+        if capability.task_type != TaskType.SERVER_STREAMING:
+            logger.warning(f"payload_identifier {wellknown_payload_identifier} is not a SERVER_STREAMING task")
             return None
-        return self._supported_tasks[wellknown_payload_identifier].task
+        return capability.task
```

## Comparing `cegalprizm_hub-1.1.dev56941.dist-info/LICENSE` & `cegalprizm_hub-1.2.dev66355.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `cegalprizm_hub-1.1.dev56941.dist-info/METADATA` & `cegalprizm_hub-1.2.dev66355.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,24 +1,24 @@
 Metadata-Version: 2.1
 Name: cegalprizm-hub
-Version: 1.1.dev56941
+Version: 1.2.dev66355
 Summary: A Python package to interact with a Cegal Hub Server and Cegal Hub Connectors
 Home-page: https://docs.prizm.cegal-geo.com/
 Author: Cegal Prizm Team
 Author-email: prizm@cegal.com
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: Other/Proprietary License
 Classifier: Operating System :: OS Independent
 Requires-Python: >=3.6
 Description-Content-Type: text/markdown
 License-File: LICENSE
 Requires-Dist: packaging (>=21.0)
 Requires-Dist: grpcio (>=1.33.2)
 Requires-Dist: protobuf (<4,>=3)
-Requires-Dist: cegal-keystoneauth (<2,>=1)
+Requires-Dist: cegal-keystoneauth (<2,>=1.0.5)
 
 # Introduction
 
 A Python client library to use with a Cegal Hub Server and Cegal Hub Connector applications. Cegal Hub allows for exchange of data and messages across process boundaries on the local machine or across a network or internet. Out of the box the library allows for working with local or remote Cegal Hub Agents or Cegal Hub Connectors such as the Cegal Hub Petrel Connector and for queries against a running Cegal Hub Server which may also be local or remote. The library is designed to be consumed by other Python libraries with knowledge about specific Cegal Hub Connectors and functionality. Cegal Hub is secured using Cegal Keystone.
 
 # Usage
```

## Comparing `cegalprizm_hub-1.1.dev56941.dist-info/RECORD` & `cegalprizm_hub-1.2.dev66355.dist-info/RECORD`

 * *Files 19% similar despite different names*

```diff
@@ -1,32 +1,42 @@
-cegalprizm/hub/__init__.py,sha256=ljuACBDFrjPOCS0hJZmi8HlQ9uR3_BJxkLeYyLB4_fQ,715
-cegalprizm/hub/agent.py,sha256=Ai9_8Zsc2_TGmuIIsqCfTFr2pzsTfJMLnFr3cmjI7Zo,16035
-cegalprizm/hub/agent_pb2.py,sha256=NEu2p7rNnRdLfLX-HRcvBTOvPTaNs8s3mj_tAy2PvTc,23141
+cegalprizm/hub/__init__.py,sha256=1Qa0hYTfmZE8GZsadzOAnZTZe4VjiZAWaku8kSzFZWI,820
+cegalprizm/hub/agent.py,sha256=98lJ2h7kmjGh7fNZqi6T6eeHzKjXAfnV7Z_rWpkHmNA,16224
+cegalprizm/hub/agent_pb2.py,sha256=S3eDKRrRygx9m1_Ljk-0DzjlS3_1ngw6T_8b-YRLb_U,23617
 cegalprizm/hub/agent_pb2_grpc.py,sha256=1oboBPFxaTEXt9Aw7EAj8gXHDCNMhZD2VXqocC9l_gk,159
 cegalprizm/hub/base_ctx.py,sha256=xH15EEV1mKlGZOhEiUcdggqgu-4VK8aN77COd2XvKhg,3605
-cegalprizm/hub/capability.py,sha256=sgbHkmxPnu_qDQ3cz8UsnSFWxR_q00cPjxy7IBw4rc4,1351
-cegalprizm/hub/client.py,sha256=LZgfqvMeqYscj2NFsDgvxdnPWRkaJFqZepjFTYRX92s,11217
-cegalprizm/hub/client_config.py,sha256=ZVf3et5XKHDgE-KtcQ1fS4hqHS-4MiIXH269_OHv9nM,1733
+cegalprizm/hub/capability.py,sha256=OdhX3JQfLTBKrfivx2SU87RqudajDk-cBLFmXpjSS-4,2083
+cegalprizm/hub/client.py,sha256=NZ-JXbruTpeM8Y37URJqUijxE0Mj_lBUsenV0Vs5IN0,11505
+cegalprizm/hub/client_config.py,sha256=V0iNpP3b8UB8Z_mmIqQ-ys5_uTmCjwD4aE2t83DDKQ0,2369
 cegalprizm/hub/connection_parameters.py,sha256=7zMVSzD68KSdpkqG1U0wsAhSn65keNstQV0ZT7JyW1g,2707
-cegalprizm/hub/connector.py,sha256=_1caUgUeTp7Z7b6Ana_J0vdKX_ocbayKj5ettOm-sHc,9493
-cegalprizm/hub/connector_filter.py,sha256=K76Aqn6e-iHNVqzoqyTgAkUC12xVqUXeERnHCryKh1I,2933
+cegalprizm/hub/connector.py,sha256=i14Zw0uBlV5cOTQAV4BQKYqC1JCNV2Da9mL4_W-gQ34,12945
+cegalprizm/hub/connector_filter.py,sha256=3tu3FJOe3LXC3TaKqMjPK0uslWqj3yxvBFTj-X07zJs,3170
 cegalprizm/hub/connector_request_service_pb2.py,sha256=C6bgUz55C8DNsdEUGdeqbwfqOVPt3jCRF0DRmDtERu8,12103
 cegalprizm/hub/connector_request_service_pb2_grpc.py,sha256=6OWbi6zUPAa6USN0Oh4KBbYgUFAucQKLi9LkRp4fcdc,6636
-cegalprizm/hub/connector_task_service_pb2.py,sha256=IR7FtM3EqPa6GrMJKz0-l0yh2g6oDfOVCTTHscX7_lM,45253
+cegalprizm/hub/connector_task_service_pb2.py,sha256=5PJ-4XwRG9HCu4Ughfn0dTOmTWGMWqF3Q1IfBgFH6F4,47744
 cegalprizm/hub/connector_task_service_pb2_grpc.py,sha256=-AxCdatfIXFjJUoF5D2ZYL6Sk7DISdF7Q-ZoU6XpMu0,2872
 cegalprizm/hub/generic_client_interceptor.py,sha256=3IAg4UDpNJ_RQmfK2kklJHdr0YXyEq4eEXC3GkSaSIg,2626
 cegalprizm/hub/hub.py,sha256=wXKqX8oBozlFApqLJqxUNUSaUSFWd2SHzM6ik25itDc,16867
-cegalprizm/hub/hub_channel.py,sha256=ZNpz4QkNwX98VzDC_fXZeeAy_0INBIPI7kgigmtmBdk,4126
+cegalprizm/hub/hub_channel.py,sha256=Z8kuGbslQCYoxLsKpZVUPbnX3_Fd11NlQA20kUnly00,4933
+cegalprizm/hub/in_memory_token_provider.py,sha256=fAM9a1VJYhPyfo2MaEp4L7PWrchgbmCK0giOQydap6w,281
 cegalprizm/hub/keystone_auth_interceptor.py,sha256=nIUnxz29bZqq8WyqV4tQGFBkHOzv790XjV1HVbSdqX4,1102
 cegalprizm/hub/payload_auth.py,sha256=fILtxO99eHlw2Ybv-WhR_7sU5cn0NURJcYHhXgipWaE,575
 cegalprizm/hub/petrel.py,sha256=qasYd_0evep5O8V4ygc3tqcgKljIUt3Dph1JdGvOeNQ,11062
 cegalprizm/hub/petrel_pb2.py,sha256=01HX1dPiImitMqkKTkrpaSJvR4ZXdty3LbmCFNVFHZk,21065
 cegalprizm/hub/petrel_pb2_grpc.py,sha256=1oboBPFxaTEXt9Aw7EAj8gXHDCNMhZD2VXqocC9l_gk,159
 cegalprizm/hub/server_config.py,sha256=-sjTJUqu2_iFZ-jLu-Ogcwlv5EBFuWnQLSYzCnWM8BA,4193
 cegalprizm/hub/server_service_pb2.py,sha256=b_frHT9Ihvcw6IoBMqvwdNbEi_Bak9LlBsv1gd29VlA,48233
 cegalprizm/hub/server_service_pb2_grpc.py,sha256=fYHzeh6AMhS9dZO8UOxB1ZJDy0iKASOR9g3DH-GMRiI,9537
-cegalprizm/hub/task_registry.py,sha256=JF027MY-yNbIYPsJN6zr__lYRsBENiFiqIu2o_UhgaY,1379
-cegalprizm_hub-1.1.dev56941.dist-info/LICENSE,sha256=KCWG3sTt9dE29sA2jyzh9HRUtIfTcZypAizXK0ItdUQ,1212
-cegalprizm_hub-1.1.dev56941.dist-info/METADATA,sha256=VENmYgJTTdirJe7PmdI4mM0BK5WLKgNwXPfm_jIYd5M,3511
-cegalprizm_hub-1.1.dev56941.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
-cegalprizm_hub-1.1.dev56941.dist-info/top_level.txt,sha256=8cz7Zw9VgR3AKLXLBTouw7vL4x1lN4DyCG3N8Oq_W-o,11
-cegalprizm_hub-1.1.dev56941.dist-info/RECORD,,
+cegalprizm/hub/task_registry.py,sha256=ZZFiYRJAc94WLR312TKbqcVzXyEyiOLnQO1R049GgPE,3716
+example_client/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
+example_client/greeter_pb2.py,sha256=Jl2FM2dvZ0QFvhaLGDhr9mOr4rCUSvNvUv0yZfaR48c,3387
+example_client/greeter_pb2_grpc.py,sha256=1oboBPFxaTEXt9Aw7EAj8gXHDCNMhZD2VXqocC9l_gk,159
+example_client/main.py,sha256=T7w9P8hGHtMHgd2at6pCslMVTQEtIUIB_BMm0jI3SCY,4520
+example_connector/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
+example_connector/greeter_pb2.py,sha256=Jl2FM2dvZ0QFvhaLGDhr9mOr4rCUSvNvUv0yZfaR48c,3387
+example_connector/greeter_pb2_grpc.py,sha256=1oboBPFxaTEXt9Aw7EAj8gXHDCNMhZD2VXqocC9l_gk,159
+example_connector/main.py,sha256=JgwQccbprjn8V5OLN5uVpD4KeaHyYWZ1I1IBGIb4L8Y,4997
+example_upload/main.py,sha256=H6t6--BrSOGjY7p6ST42q_HtXAt4idLR9H3_x_wkrl8,287
+cegalprizm_hub-1.2.dev66355.dist-info/LICENSE,sha256=KCWG3sTt9dE29sA2jyzh9HRUtIfTcZypAizXK0ItdUQ,1212
+cegalprizm_hub-1.2.dev66355.dist-info/METADATA,sha256=avv4LJH68nqlQNOJTCYlBuwgulQKHc4jVCVVll4Leb4,3515
+cegalprizm_hub-1.2.dev66355.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+cegalprizm_hub-1.2.dev66355.dist-info/top_level.txt,sha256=1o-smtRskyzhVVSxc1adkMDE2qawdLMf3tVbh45c8r0,59
+cegalprizm_hub-1.2.dev66355.dist-info/RECORD,,
```

