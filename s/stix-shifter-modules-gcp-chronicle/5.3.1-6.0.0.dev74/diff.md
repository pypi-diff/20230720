# Comparing `tmp/stix_shifter_modules_gcp_chronicle-5.3.1-py2.py3-none-any.whl.zip` & `tmp/stix_shifter_modules_gcp_chronicle-6.0.0.dev74-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,32 +1,32 @@
-Zip file size: 67887 bytes, number of entries: 30
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/__init__.py
--rw-rw-r--  2.0 unx      426 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/entry_point.py
--rw-rw-r--  2.0 unx   170591 b- defN 23-Jun-15 14:07 stix_shifter_modules/gcp_chronicle/configuration/config.json
--rw-rw-r--  2.0 unx       78 b- defN 23-Jun-15 14:07 stix_shifter_modules/gcp_chronicle/configuration/dialects.json
--rw-rw-r--  2.0 unx     2653 b- defN 23-Jun-15 14:07 stix_shifter_modules/gcp_chronicle/configuration/lang_en.json
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_translation/__init__.py
--rw-rw-r--  2.0 unx    22646 b- defN 23-Jun-15 14:07 stix_shifter_modules/gcp_chronicle/stix_translation/json_to_stix_translator.py
--rw-rw-r--  2.0 unx    27474 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_translation/query_constructor.py
--rw-rw-r--  2.0 unx      804 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_translation/query_translator.py
--rw-rw-r--  2.0 unx     2273 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_translation/transformers.py
--rw-rw-r--  2.0 unx    11972 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_translation/json/config_map.json
--rw-rw-r--  2.0 unx    19126 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_translation/json/from_stix_map.json
--rw-rw-r--  2.0 unx      619 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_translation/json/operators.json
--rw-rw-r--  2.0 unx    47881 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_translation/json/to_stix_map.json
--rw-rw-r--  2.0 unx    18763 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_translation/json/stix_2_1/from_stix_map.json
--rw-rw-r--  2.0 unx    46809 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_translation/json/stix_2_1/to_stix_map.json
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_transmission/__init__.py
--rw-rw-r--  2.0 unx     7565 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_transmission/api_client.py
--rw-rw-r--  2.0 unx     3006 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_transmission/delete_connector.py
--rw-rw-r--  2.0 unx     1442 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_transmission/error_mapper.py
--rw-rw-r--  2.0 unx     2725 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_transmission/ping_connector.py
--rw-rw-r--  2.0 unx     2711 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_transmission/query_connector.py
--rw-rw-r--  2.0 unx    19228 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_transmission/results_connector.py
--rw-rw-r--  2.0 unx     5479 b- defN 23-Jun-15 14:04 stix_shifter_modules/gcp_chronicle/stix_transmission/status_connector.py
--rw-rw-r--  2.0 unx    12786 b- defN 23-Jun-15 14:07 stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/LICENSE.md
--rw-rw-r--  2.0 unx     8113 b- defN 23-Jun-15 14:07 stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/METADATA
--rw-rw-r--  2.0 unx     1418 b- defN 23-Jun-15 14:07 stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/NOTICE
--rw-rw-r--  2.0 unx      110 b- defN 23-Jun-15 14:07 stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/WHEEL
--rw-rw-r--  2.0 unx       21 b- defN 23-Jun-15 14:07 stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     3646 b- defN 23-Jun-15 14:07 stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/RECORD
-30 files, 440365 bytes uncompressed, 61593 bytes compressed:  86.0%
+Zip file size: 69010 bytes, number of entries: 30
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/__init__.py
+-rw-rw-r--  2.0 unx      426 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/entry_point.py
+-rw-rw-r--  2.0 unx   170774 b- defN 23-Jul-20 18:39 stix_shifter_modules/gcp_chronicle/configuration/config.json
+-rw-rw-r--  2.0 unx       78 b- defN 23-Jul-20 18:39 stix_shifter_modules/gcp_chronicle/configuration/dialects.json
+-rw-rw-r--  2.0 unx     2653 b- defN 23-Jul-20 18:39 stix_shifter_modules/gcp_chronicle/configuration/lang_en.json
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_translation/__init__.py
+-rw-rw-r--  2.0 unx    27024 b- defN 23-Jul-20 18:39 stix_shifter_modules/gcp_chronicle/stix_translation/json_to_stix_translator.py
+-rw-rw-r--  2.0 unx    27474 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_translation/query_constructor.py
+-rw-rw-r--  2.0 unx      804 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_translation/query_translator.py
+-rw-rw-r--  2.0 unx     2273 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_translation/transformers.py
+-rw-rw-r--  2.0 unx    11972 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_translation/json/config_map.json
+-rw-rw-r--  2.0 unx    19126 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_translation/json/from_stix_map.json
+-rw-rw-r--  2.0 unx      619 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_translation/json/operators.json
+-rw-rw-r--  2.0 unx    47951 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_translation/json/to_stix_map.json
+-rw-rw-r--  2.0 unx    18763 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_translation/json/stix_2_1/from_stix_map.json
+-rw-rw-r--  2.0 unx    46892 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_translation/json/stix_2_1/to_stix_map.json
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_transmission/__init__.py
+-rw-rw-r--  2.0 unx     7565 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_transmission/api_client.py
+-rw-rw-r--  2.0 unx     3006 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_transmission/delete_connector.py
+-rw-rw-r--  2.0 unx     1442 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_transmission/error_mapper.py
+-rw-rw-r--  2.0 unx     2725 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_transmission/ping_connector.py
+-rw-rw-r--  2.0 unx     2711 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_transmission/query_connector.py
+-rw-rw-r--  2.0 unx    19228 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_transmission/results_connector.py
+-rw-rw-r--  2.0 unx     5479 b- defN 23-Jul-20 18:36 stix_shifter_modules/gcp_chronicle/stix_transmission/status_connector.py
+-rw-rw-r--  2.0 unx    12786 b- defN 23-Jul-20 18:39 stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/LICENSE.md
+-rw-rw-r--  2.0 unx     8119 b- defN 23-Jul-20 18:39 stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/METADATA
+-rw-rw-r--  2.0 unx     1418 b- defN 23-Jul-20 18:39 stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/NOTICE
+-rw-rw-r--  2.0 unx      110 b- defN 23-Jul-20 18:39 stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       21 b- defN 23-Jul-20 18:39 stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     3682 b- defN 23-Jul-20 18:39 stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/RECORD
+30 files, 445121 bytes uncompressed, 62644 bytes compressed:  85.9%
```

## zipnote {}

```diff
@@ -66,26 +66,26 @@
 
 Filename: stix_shifter_modules/gcp_chronicle/stix_transmission/results_connector.py
 Comment: 
 
 Filename: stix_shifter_modules/gcp_chronicle/stix_transmission/status_connector.py
 Comment: 
 
-Filename: stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/LICENSE.md
+Filename: stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/LICENSE.md
 Comment: 
 
-Filename: stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/METADATA
+Filename: stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/METADATA
 Comment: 
 
-Filename: stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/NOTICE
+Filename: stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/NOTICE
 Comment: 
 
-Filename: stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/WHEEL
+Filename: stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/WHEEL
 Comment: 
 
-Filename: stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/top_level.txt
+Filename: stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/top_level.txt
 Comment: 
 
-Filename: stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/RECORD
+Filename: stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## stix_shifter_modules/gcp_chronicle/configuration/config.json

### Pretty-printed

 * *Similarity: 0.9999996663795577%*

 * *Differences: {"'connection'": "{'options': {'mapping': {'default': {'to_stix_map': {'event': {'securityResult': "*

 * *                 "{'about': {'url': {replace: OrderedDict([('key', 'url.value'), ('object', "*

 * *                 "'security_url'), ('transformer', 'ValidateUrl')])}, 'groupAboutUrlReferences': "*

 * *                 "OrderedDict([('key', "*

 * *                 "'x-ibm-finding.extensions.x-gcp-chronicle-security-result.url_refs'), ('object', "*

 * *                 "'security_result'), ('references', ['security_url']), ('gr […]*

```diff
@@ -1348,14 +1348,22 @@
                         "ComparisonExpressionOperators.Or": "or",
                         "ObservationOperators.And": "or",
                         "ObservationOperators.Or": "or"
                     },
                     "to_stix_map": {
                         "event": {
                             "about": {
+                                "GroupAboutFileReferences": {
+                                    "group_ref": true,
+                                    "key": "email-message.extensions.x-gcp-chronicle-email-message.file_refs",
+                                    "object": "em",
+                                    "references": [
+                                        "about_file"
+                                    ]
+                                },
                                 "file": {
                                     "fileType": {
                                         "key": "file.extensions.x-gcp-chronicle-file.file_type",
                                         "object": "about_file"
                                     },
                                     "fullPath": [
                                         {
@@ -1368,19 +1376,14 @@
                                             "object": "about_directory",
                                             "transformer": "ToDirectoryPath"
                                         },
                                         {
                                             "key": "file.parent_directory_ref",
                                             "object": "about_file",
                                             "references": "about_directory"
-                                        },
-                                        {
-                                            "key": "email-message.extensions.x-gcp-chronicle-email-message.file_ref",
-                                            "object": "em",
-                                            "references": "about_file"
                                         }
                                     ],
                                     "lastModificationTime": {
                                         "key": "file.modified",
                                         "object": "about_file"
                                     },
                                     "md5": {
@@ -2268,26 +2271,27 @@
                             "securityResult": {
                                 "about": {
                                     "email": {
                                         "key": "email-addr.value",
                                         "object": "security_email",
                                         "transformer": "FilterValidEmail"
                                     },
-                                    "url": [
-                                        {
-                                            "key": "url.value",
-                                            "object": "security_url",
-                                            "transformer": "ValidateUrl"
-                                        },
-                                        {
-                                            "key": "x-ibm-finding.extensions.x-gcp-chronicle-security-result.url_ref",
-                                            "object": "security_result",
-                                            "references": "security_url"
-                                        }
-                                    ]
+                                    "groupAboutUrlReferences": {
+                                        "group_ref": true,
+                                        "key": "x-ibm-finding.extensions.x-gcp-chronicle-security-result.url_refs",
+                                        "object": "security_result",
+                                        "references": [
+                                            "security_url"
+                                        ]
+                                    },
+                                    "url": {
+                                        "key": "url.value",
+                                        "object": "security_url",
+                                        "transformer": "ValidateUrl"
+                                    }
                                 },
                                 "action": {
                                     "key": "x-ibm-finding.extensions.x-gcp-chronicle-security-result.actions_taken",
                                     "object": "security_result"
                                 },
                                 "alertState": {
                                     "key": "x-ibm-finding.extensions.x-gcp-chronicle-security-result.alert_state",
```

## stix_shifter_modules/gcp_chronicle/stix_translation/json_to_stix_translator.py

```diff
@@ -118,22 +118,22 @@
                 if not match(str(stix_value)):
                     return False
             return True
         except Exception as e:
             self.logger.debug("Failed to validate STIX property '{}' with value '{}'. Exception: {}".format(observable_key, stix_value, e))
             return False
 
-    def _compose_value_object(self, value, key_list, observable_key=None, object_tag_ref_map=None, transformer=None, references=None, unwrap=False):
+    def _compose_value_object(self, value, key_list, observable_key=None, object_tag_ref_map=None, transformer=None, references=None, unwrap=False, is_group_ref=False):
         """
         Converts the value of the data to STIX valid value
         """
         try:
             return_value = {}
             for key in key_list:
-                return_value[key] = self._compose_value_object(value, key_list[1:], observable_key=observable_key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
+                return_value[key] = self._compose_value_object(value, key_list[1:], observable_key=observable_key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap, is_group_ref=is_group_ref)
                 break
             else:
                 if transformer:
                     try: 
                         value = transformer.transform(value)
                         if value is None:
                             return None
@@ -141,21 +141,39 @@
                         return None
                 
                 if references:
                     if isinstance(references, list):
                         return_value = []
                         for ref in references:
                             if not isinstance(value, list):
-                                value = [value]
-                            for i, _ in enumerate(value):
-                                parent_key_ind = self._get_tag_ind(ref, object_tag_ref_map, create_on_absence=False, unwrap=i)
+                                # Fetch the index of reference object name which has a single value.
+                                parent_key_ind = self._get_tag_ind(ref, object_tag_ref_map, create_on_absence=False)
                                 if parent_key_ind:
                                     return_value.append(parent_key_ind)
+                            else:
+                                for i, _ in enumerate(value):
+                                    parent_key_ind = self._get_tag_ind(ref, object_tag_ref_map, create_on_absence=False, unwrap=str(i))
+                                    if parent_key_ind:
+                                        return_value.append(parent_key_ind)
+                                    # Iterate through the object_tag_ref_map to fetch the index, for grouping
+                                    # reference objects of nested type through group_ref.
+                                    elif is_group_ref:
+                                        list_parent_ind = ref + '_' + str(i)
+                                        for key, val in object_tag_ref_map['tags'].items():
+                                            if key.startswith(list_parent_ind):
+                                                return_value.append(
+                                                    self._get_tag_ind(key, object_tag_ref_map, create_on_absence=False))
+
                     else:
-                        return_value = self._get_tag_ind(references, object_tag_ref_map, create_on_absence=False)
+                        # Fetch first object (index 0) for single reference when the value is of type list .
+                        if isinstance(value, list):
+                            return_value = self._get_tag_ind(references, object_tag_ref_map, create_on_absence=False,
+                                                             unwrap='0')
+                        else:
+                            return_value = self._get_tag_ind(references, object_tag_ref_map, create_on_absence=False)
                         # if the property has unwrap true and is not a list, convert to list
                         if unwrap is True and not isinstance(return_value, list):
                             return_value = [return_value]
 
                     if not return_value:
                         return None
                 else:
@@ -247,28 +265,38 @@
                 if isinstance(to_stix_config_prop, dict) and to_stix_config_prop.get('key') is not None and not isinstance(to_stix_config_prop.get('key'), dict):
                     # data variable is the final value, process in bulk
                     self._handle_value(data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind)
 
                 elif isinstance(data, list):
                     for i, d in enumerate(data):
                         if isinstance(d, list) or isinstance(d, dict):
-                            self._handle_properties(to_stix_config_prop, d, objects, object_tag_ref_map, data, ds_sub_key, i)
+                            # Added parent key indexes to inner objects in order to handle nested lists of
+                            # dictionaries and lists. For Example, if a list of IP address is present inside
+                            # a list of network objects, then without adding this code, only the IP address information
+                            # in the first network object will be created and the rest are not created.
+                            if object_key_ind:
+                                i = str(object_key_ind) + '_' + str(i)
+                            # Inorder to include 0th index, the integer field 'i' is converted to string.
+                            self._handle_properties(to_stix_config_prop, d, objects, object_tag_ref_map, data, ds_sub_key, str(i))
                         else:
                             # data variable is the final value, process in bulk
                             self._handle_value(data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind)
                             break
                     # group the references of list of dictionary field
                     if isinstance(to_stix_config_prop, dict):
                         group_refs = [key for key, value in to_stix_config_prop.items() if
                                       isinstance(value, dict) and value.get('group_ref') and value.get(
                                           'references')]
                         for group_ref in group_refs:
+                            # Added a new boolean (True) parameter (is_group_ref) to indicate grouping of references
+                            # through group_ref key in mapping
                             self._handle_value(data, to_stix_config_prop, ds_sub_key,
                                                to_stix_config_prop[group_ref],
-                                               objects, object_tag_ref_map, object_key_ind)
+                                               objects, object_tag_ref_map, object_key_ind, True)
+
                 elif isinstance(data, dict):
                     for k in data:
                         cust_prop = None
                         if k in to_stix_config_prop:
                             cust_prop = to_stix_config_prop[k]
                         elif self.options.get('unmapped_fallback') and k not in object_tag_ref_map['ds_key_cybox']:
                             cust_prop = {"key": "x-" + self.data_source.replace("_", "-") + "." + k, "object": "cust_object"}
@@ -277,15 +305,15 @@
                             self._handle_properties(cust_prop, data[k], objects, object_tag_ref_map, data, k, object_key_ind)
                 else:
                     self._handle_value(data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind)
         except Exception as e:
             raise Exception("Error in json_to_stix_translator._handle_properties: %s" % e)
 
 
-    def _handle_value(self, data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind=None):
+    def _handle_value(self, data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind=None, is_group_ref=False):
         """
         Receives the raw value of a data property, converts to a STIX valid value and adds to the cached observable `objects` dictionary
         """
         try: 
             if isinstance(to_stix_config_prop, dict):
                 props = [to_stix_config_prop]
             else:
@@ -294,14 +322,29 @@
             for prop in props:
                 key = prop.get('key', None)
                 if key is None:
                     continue
 
                 transformer = self.transformers[prop['transformer']] if 'transformer' in prop else None
                 references = references = prop['references'] if 'references' in prop else None
+
+                # This check avoid using duplicate reference in the multiple objects of the same type.
+                # For example: If there are multiple source ipv4-addr and network-traffic objects then
+                # without this reference check the first source ipv4-addr object will be referenced to all network-traffic objects.
+                if references:
+                    if isinstance(references, str):
+                        if object_key_ind:
+                            references = references + '_' + str(object_key_ind)
+                        elif not isinstance(data, list):
+                            references = references + '_' + '0'
+                    elif isinstance(references, list):
+                        if object_key_ind:
+                            references = [ref + '_' + str(object_key_ind) for ref in references]
+                        elif not isinstance(data, list):
+                            references = [ref + '_' + '0' for ref in references]
                 # unwrap array of stix values to separate stix objects
                 unwrap = True if 'unwrap' in prop and isinstance(data, list) else False
                 if "." in key:
                     cybox = True
                 else:
                     cybox = False
                 
@@ -334,33 +377,44 @@
                     if False is cybox and not substitute_key:
                         value = self._compose_value_object(data, config_keys[2:], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
                         self._add_property(type_name, property_key, type_name, value, object_tag_ref_map['out_cybox'], cybox=False)
                         continue
 
                     if object_key_ind:
                         parent_key = parent_key + '_' + str(object_key_ind)
+                    # Adding _0 as a tag index for the following
+                    # 1. For object name of non-list type data or unwrapped data
+                    # 2. For the object name containing references to list type of data.
+                    # For Example, when a single IP address value and references to the list of domain values, needs
+                    # to be added to a single custom object, the 0th index is added to the custom object to have ip
+                    # address and references to list of domains under the same custom object.
+                    elif (isinstance(data, list) and not unwrap and not references) \
+                            or (isinstance(data, list) and references) or (not isinstance(data, list)):
+                        parent_key = parent_key + '_' + '0'
 
                     # use the hard-coded value in the mapping
                     if 'value' in prop:
                         value = prop['value']
                     else:
                         if substitute_key and parent_data:
                             data = parent_data.get(substitute_key)
 
                             if False is cybox:
                                 object_tag_ref_map['ds_key_cybox'][substitute_key] = True
                         
-                        value = self._compose_value_object(data, config_keys[2:], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
+                        value = self._compose_value_object(data, config_keys[2:], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap, is_group_ref=is_group_ref)
 
-                    if value is None or value == '':
+                    # Remove the values which has empty list brackets.
+                    if value is None or value in ('', []):
                         continue
 
                     if not references and unwrap and isinstance(value, list):
                         for i, val_el in enumerate(value):
-                            parent_key_ind = self._get_tag_ind(parent_key, object_tag_ref_map, create_on_absence=True, unwrap=i, property_key=property_key)
+                            # Inorder to include 0th index, the integer field 'i' is converted to string.
+                            parent_key_ind = self._get_tag_ind(parent_key, object_tag_ref_map, create_on_absence=True, unwrap=str(i), property_key=property_key)
                             self._add_property(type_name, property_key, parent_key_ind, val_el, objects, group=group)
                     else:
                         parent_key_ind = self._get_tag_ind(parent_key, object_tag_ref_map, create_on_absence=True, property_key=property_key)
                         self._add_property(type_name, property_key, parent_key_ind, value, objects, group=group)
         except Exception as e:
             raise Exception("Error in json_to_stix_translator._handle_value: %s : %s" % (e, e.__traceback__.tb_lineno))
```

## stix_shifter_modules/gcp_chronicle/stix_translation/json/to_stix_map.json

### Pretty-printed

 * *Similarity: 0.9836018880208333%*

 * *Differences: {"'event'": "{'securityResult': {'about': {'url': {replace: OrderedDict([('key', 'url.value'), "*

 * *            "('object', 'security_url'), ('transformer', 'ValidateUrl')])}, "*

 * *            "'groupAboutUrlReferences': OrderedDict([('key', "*

 * *            "'x-ibm-finding.extensions.x-gcp-chronicle-security-result.url_refs'), ('object', "*

 * *            "'security_result'), ('references', ['security_url']), ('group_ref', True)])}}, "*

 * *            "'about': {'file': {'fullPath': {delete: [3]}}, 'GroupAboutFileReference […]*

```diff
@@ -1,10 +1,18 @@
 {
     "event": {
         "about": {
+            "GroupAboutFileReferences": {
+                "group_ref": true,
+                "key": "email-message.extensions.x-gcp-chronicle-email-message.file_refs",
+                "object": "em",
+                "references": [
+                    "about_file"
+                ]
+            },
             "file": {
                 "fileType": {
                     "key": "file.extensions.x-gcp-chronicle-file.file_type",
                     "object": "about_file"
                 },
                 "fullPath": [
                     {
@@ -17,19 +25,14 @@
                         "object": "about_directory",
                         "transformer": "ToDirectoryPath"
                     },
                     {
                         "key": "file.parent_directory_ref",
                         "object": "about_file",
                         "references": "about_directory"
-                    },
-                    {
-                        "key": "email-message.extensions.x-gcp-chronicle-email-message.file_ref",
-                        "object": "em",
-                        "references": "about_file"
                     }
                 ],
                 "lastModificationTime": {
                     "key": "file.modified",
                     "object": "about_file"
                 },
                 "md5": {
@@ -917,26 +920,27 @@
         "securityResult": {
             "about": {
                 "email": {
                     "key": "email-addr.value",
                     "object": "security_email",
                     "transformer": "FilterValidEmail"
                 },
-                "url": [
-                    {
-                        "key": "url.value",
-                        "object": "security_url",
-                        "transformer": "ValidateUrl"
-                    },
-                    {
-                        "key": "x-ibm-finding.extensions.x-gcp-chronicle-security-result.url_ref",
-                        "object": "security_result",
-                        "references": "security_url"
-                    }
-                ]
+                "groupAboutUrlReferences": {
+                    "group_ref": true,
+                    "key": "x-ibm-finding.extensions.x-gcp-chronicle-security-result.url_refs",
+                    "object": "security_result",
+                    "references": [
+                        "security_url"
+                    ]
+                },
+                "url": {
+                    "key": "url.value",
+                    "object": "security_url",
+                    "transformer": "ValidateUrl"
+                }
             },
             "action": {
                 "key": "x-ibm-finding.extensions.x-gcp-chronicle-security-result.actions_taken",
                 "object": "security_result"
             },
             "alertState": {
                 "key": "x-ibm-finding.extensions.x-gcp-chronicle-security-result.alert_state",
```

## stix_shifter_modules/gcp_chronicle/stix_translation/json/stix_2_1/to_stix_map.json

### Pretty-printed

 * *Similarity: 0.9836018880208333%*

 * *Differences: {"'event'": "{'securityResult': {'about': {'url': {replace: OrderedDict([('key', 'url.value'), "*

 * *            "('object', 'security_url'), ('transformer', 'ValidateUrl')])}, "*

 * *            "'GroupAboutUrlReferences': OrderedDict([('key', "*

 * *            "'x-ibm-finding.extensions.x-gcp-chronicle-security-result.url_refs'), ('object', "*

 * *            "'security_result'), ('references', ['security_url']), ('group_ref', True)])}}, "*

 * *            "'about': {'file': {'fullPath': {delete: [3]}}, 'GroupAboutFileReference […]*

```diff
@@ -1,10 +1,18 @@
 {
     "event": {
         "about": {
+            "GroupAboutFileReferences": {
+                "group_ref": true,
+                "key": "email-message.extensions.x-gcp-chronicle-email-message.file_refs",
+                "object": "em",
+                "references": [
+                    "about_file"
+                ]
+            },
             "file": {
                 "fileType": {
                     "key": "file.extensions.x-gcp-chronicle-file-ext.file_type",
                     "object": "about_file"
                 },
                 "fullPath": [
                     {
@@ -17,19 +25,14 @@
                         "object": "about_directory",
                         "transformer": "ToDirectoryPath"
                     },
                     {
                         "key": "file.parent_directory_ref",
                         "object": "about_file",
                         "references": "about_directory"
-                    },
-                    {
-                        "key": "email-message.extensions.x-gcp-chronicle-email-message-ext.file_ref",
-                        "object": "em",
-                        "references": "about_file"
                     }
                 ],
                 "lastModificationTime": {
                     "key": "file.modified",
                     "object": "about_file"
                 },
                 "md5": {
@@ -895,31 +898,32 @@
                     "key": "user-account.extensions.windows-account-ext.sid",
                     "object": "principal_user"
                 }
             }
         },
         "securityResult": {
             "about": {
+                "GroupAboutUrlReferences": {
+                    "group_ref": true,
+                    "key": "x-ibm-finding.extensions.x-gcp-chronicle-security-result.url_refs",
+                    "object": "security_result",
+                    "references": [
+                        "security_url"
+                    ]
+                },
                 "email": {
                     "key": "email-addr.value",
                     "object": "security_email",
                     "transformer": "FilterValidEmail"
                 },
-                "url": [
-                    {
-                        "key": "url.value",
-                        "object": "security_url",
-                        "transformer": "ValidateUrl"
-                    },
-                    {
-                        "key": "x-ibm-finding.extensions.x-gcp-chronicle-security-result-ext.url_ref",
-                        "object": "security_result",
-                        "references": "security_url"
-                    }
-                ]
+                "url": {
+                    "key": "url.value",
+                    "object": "security_url",
+                    "transformer": "ValidateUrl"
+                }
             },
             "action": {
                 "key": "x-ibm-finding.extensions.x-gcp-chronicle-security-result-ext.actions_taken",
                 "object": "security_result"
             },
             "alertState": {
                 "key": "x-ibm-finding.extensions.x-gcp-chronicle-security-result-ext.alert_state",
```

## Comparing `stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/LICENSE.md` & `stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/LICENSE.md`

 * *Files identical despite different names*

## Comparing `stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/METADATA` & `stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,24 +1,24 @@
 Metadata-Version: 2.1
 Name: stix-shifter-modules-gcp-chronicle
-Version: 5.3.1
+Version: 6.0.0.dev74
 Summary: Tools and interface to translate STIX formatted results and queries to different data source formats and to set up appropriate connection strings for invoking and triggering actions in openwhisk
 Home-page: https://github.com/opencybersecurityalliance/stix-shifter
 Author: ibm
 Author-email: 
 Project-URL: Source, https://github.com/opencybersecurityalliance/stix-shifter
 Keywords: datasource stix translate transform transmit
 Classifier: License :: OSI Approved :: Apache Software License
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Description-Content-Type: text/markdown
 License-File: LICENSE.md
 License-File: NOTICE
-Requires-Dist: urllib3 (==1.26.15)
 Requires-Dist: aiogoogle (==5.1.0)
+Requires-Dist: urllib3 (==1.26.15)
 
 [![example workflow](https://github.com/opencybersecurityalliance/stix-shifter/actions/workflows/main.yml/badge.svg)](https://github.com/opencybersecurityalliance/stix-shifter/actions)
 [![codecov](https://codecov.io/gh/opencybersecurityalliance/stix-shifter/branch/develop/graph/badge.svg?token=gQvl14peRj)](https://codecov.io/gh/opencybersecurityalliance/stix-shifter)
 
 # Introduction to STIX-Shifter
 
 STIX-shifter is an open source python library allowing software to connect to products that house data repositories by using STIX Patterning, and return results as STIX Observations.
```

## Comparing `stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/NOTICE` & `stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/NOTICE`

 * *Files identical despite different names*

## Comparing `stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/RECORD` & `stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/RECORD`

 * *Files 10% similar despite different names*

```diff
@@ -1,30 +1,30 @@
 stix_shifter_modules/gcp_chronicle/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_modules/gcp_chronicle/entry_point.py,sha256=man4fgpMstv7z23y8UuuWBtEKauTP8ri-4SaSwqNTbM,426
-stix_shifter_modules/gcp_chronicle/configuration/config.json,sha256=Z6GWmRwMTZj6PS70SzmE7lMVP_14iEStWrTHMx2Hn7s,170591
+stix_shifter_modules/gcp_chronicle/configuration/config.json,sha256=t2gDnD8yvR_gSDJQg8TaruUX9aRQnNEs-jnYunkIIfo,170774
 stix_shifter_modules/gcp_chronicle/configuration/dialects.json,sha256=tewYuoIE-WBBxsLTlOstMkMSUs6sFlEyW1dveC61xwk,78
 stix_shifter_modules/gcp_chronicle/configuration/lang_en.json,sha256=kAW9XcWil5kZ05I3hfK0p3cIVLuIpnz38Wk043gDnD4,2653
 stix_shifter_modules/gcp_chronicle/stix_translation/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-stix_shifter_modules/gcp_chronicle/stix_translation/json_to_stix_translator.py,sha256=vffR1MRpwX6NMwXy0MldaTecIIzvVSZIlcqXOM8Nx7I,22646
+stix_shifter_modules/gcp_chronicle/stix_translation/json_to_stix_translator.py,sha256=mlzibasm2UfSGhYqHoH2hMFHlx7XCy35VSlzzFTWpjc,27024
 stix_shifter_modules/gcp_chronicle/stix_translation/query_constructor.py,sha256=J6M40LWeuv6HKYJePFAxq2xKyn9-mzHxHnXjJpd28SQ,27474
 stix_shifter_modules/gcp_chronicle/stix_translation/query_translator.py,sha256=FTJjp-SLH3uwLuibIL6Q0LnHh8sa1aY98LFj_5gM0ak,804
 stix_shifter_modules/gcp_chronicle/stix_translation/transformers.py,sha256=tOb84GKysgojs3ACXtjK_xEXL6QDrifHl9fO8U4hrZE,2273
 stix_shifter_modules/gcp_chronicle/stix_translation/json/config_map.json,sha256=eNhTLz9rSzD0scZeBQOhSygfZ0X7hEbNQcy-ZvSmSfg,11972
 stix_shifter_modules/gcp_chronicle/stix_translation/json/from_stix_map.json,sha256=yUooSQinnp3-fPC7RP7utT2qI_qbqVMPahYkFEzW_zI,19126
 stix_shifter_modules/gcp_chronicle/stix_translation/json/operators.json,sha256=TLL9IMy-_CDN8vJxWQqf4CN47xHznbr7g3oEZ1Fnb_s,619
-stix_shifter_modules/gcp_chronicle/stix_translation/json/to_stix_map.json,sha256=IouyRSeeDUHlrY6GTlYhvmY1M_U0cg9XAelJmM8K1G4,47881
+stix_shifter_modules/gcp_chronicle/stix_translation/json/to_stix_map.json,sha256=1hCW8y99xCU_ihYevcEAqchlPjrsQgWkY6_BFB4qDyA,47951
 stix_shifter_modules/gcp_chronicle/stix_translation/json/stix_2_1/from_stix_map.json,sha256=7nGR8xoQhi-3OMRAvU40MCqap0DcCHEpNzWuAFTyrnM,18763
-stix_shifter_modules/gcp_chronicle/stix_translation/json/stix_2_1/to_stix_map.json,sha256=CNjB7-7hb8MEpXTlaN9emz7bkw6M8PF6JfiKzZA3bXk,46809
+stix_shifter_modules/gcp_chronicle/stix_translation/json/stix_2_1/to_stix_map.json,sha256=L_j6ZK6UAVwK9p9XUzrPGE1luQxtHv7yLQ1arF6kcRY,46892
 stix_shifter_modules/gcp_chronicle/stix_transmission/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_modules/gcp_chronicle/stix_transmission/api_client.py,sha256=JuI5hn0OBh9NHjjvG16sn-Rg5FEqbDKkOoSNQpXSOvQ,7565
 stix_shifter_modules/gcp_chronicle/stix_transmission/delete_connector.py,sha256=AqH9fGjI74-egfEEbij0C61VFAvngVvQUhcYzOYoZbo,3006
 stix_shifter_modules/gcp_chronicle/stix_transmission/error_mapper.py,sha256=OACpbsHO7yUL9dIkmlmj8Pr0RoGkY9jG4ooIzbrrMx0,1442
 stix_shifter_modules/gcp_chronicle/stix_transmission/ping_connector.py,sha256=EB0HcsNxJF6jfbEfvIMRMtZFczxJ_Hu9igUH4TT0PUU,2725
 stix_shifter_modules/gcp_chronicle/stix_transmission/query_connector.py,sha256=BEJC9dcelxy-CFvTDmFuGsK-2ZwUw5md5rfWlN5R5Hs,2711
 stix_shifter_modules/gcp_chronicle/stix_transmission/results_connector.py,sha256=mtJZ9csThPxandSaEel6Pxex7JN620OHKcv8Q77KH5Q,19228
 stix_shifter_modules/gcp_chronicle/stix_transmission/status_connector.py,sha256=3vMJiDFtaDuss7ySEerD8X96O3BTlY1gXWqf3_ePDAk,5479
-stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/LICENSE.md,sha256=ssGEKMVW69oFTBblVhD1YPolqCOyOCJi4wRDRI7xCnU,12786
-stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/METADATA,sha256=Ky7-zBS3e0GDV8ixWZDfJmovRu9yLcF0B7_Xf0TRFmc,8113
-stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/NOTICE,sha256=wx-gWE9vSnLJ7YQkrGlMp9VNXOXG57TTxDDRd9CEdYg,1418
-stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/WHEEL,sha256=bb2Ot9scclHKMOLDEHY6B2sicWOgugjFKaJsT7vwMQo,110
-stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/top_level.txt,sha256=NX-VgUOr8fI-lMXHt3gtjfsEn1UPaGAVszt6Z_CTp2s,21
-stix_shifter_modules_gcp_chronicle-5.3.1.dist-info/RECORD,,
+stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/LICENSE.md,sha256=ssGEKMVW69oFTBblVhD1YPolqCOyOCJi4wRDRI7xCnU,12786
+stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/METADATA,sha256=SQdNfe9sAzBpWkz18ATdS9PPyaS8LYV4lmBhBJHTov8,8119
+stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/NOTICE,sha256=wx-gWE9vSnLJ7YQkrGlMp9VNXOXG57TTxDDRd9CEdYg,1418
+stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/WHEEL,sha256=bb2Ot9scclHKMOLDEHY6B2sicWOgugjFKaJsT7vwMQo,110
+stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/top_level.txt,sha256=NX-VgUOr8fI-lMXHt3gtjfsEn1UPaGAVszt6Z_CTp2s,21
+stix_shifter_modules_gcp_chronicle-6.0.0.dev74.dist-info/RECORD,,
```

