# Comparing `tmp/stix_shifter_modules_azure_log_analytics-5.3.1-py2.py3-none-any.whl.zip` & `tmp/stix_shifter_modules_azure_log_analytics-6.0.0.dev74-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,30 +1,32 @@
-Zip file size: 38879 bytes, number of entries: 28
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/__init__.py
--rw-rw-r--  2.0 unx      702 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/entry_point.py
--rw-rw-r--  2.0 unx    34280 b- defN 23-Jun-15 14:07 stix_shifter_modules/azure_log_analytics/configuration/config.json
--rw-rw-r--  2.0 unx      251 b- defN 23-Jun-15 14:07 stix_shifter_modules/azure_log_analytics/configuration/dialects.json
--rw-rw-r--  2.0 unx     3366 b- defN 23-Jun-15 14:07 stix_shifter_modules/azure_log_analytics/configuration/lang_en.json
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/stix_translation/__init__.py
--rw-rw-r--  2.0 unx    22646 b- defN 23-Jun-15 14:07 stix_shifter_modules/azure_log_analytics/stix_translation/json_to_stix_translator.py
--rw-rw-r--  2.0 unx    17603 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/stix_translation/query_constructor.py
--rw-rw-r--  2.0 unx     1037 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/stix_translation/query_translator.py
--rw-rw-r--  2.0 unx     1949 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityAlert_from_stix_map.json
--rw-rw-r--  2.0 unx     3671 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityEvent_from_stix_map.json
--rw-rw-r--  2.0 unx     1733 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityIncident_from_stix_map.json
--rw-rw-r--  2.0 unx      326 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/stix_translation/json/operators.json
--rw-rw-r--  2.0 unx     8827 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/stix_translation/json/to_stix_map.json
--rw-rw-r--  2.0 unx     1951 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/SecurityAlert_from_stix_map.json
--rw-rw-r--  2.0 unx     3672 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/SecurityEvent_from_stix_map.json
--rw-rw-r--  2.0 unx     1735 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/SecurityIncident_from_stix_map.json
--rw-rw-r--  2.0 unx     8964 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/to_stix_map.json
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/stix_transmission/__init__.py
--rw-rw-r--  2.0 unx     2957 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/stix_transmission/api_client.py
--rw-rw-r--  2.0 unx     4029 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/stix_transmission/connector.py
--rw-rw-r--  2.0 unx     3159 b- defN 23-Jun-15 14:04 stix_shifter_modules/azure_log_analytics/stix_transmission/error_mapper.py
--rw-rw-r--  2.0 unx    12786 b- defN 23-Jun-15 14:07 stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/LICENSE.md
--rw-rw-r--  2.0 unx     8161 b- defN 23-Jun-15 14:07 stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/METADATA
--rw-rw-r--  2.0 unx     1418 b- defN 23-Jun-15 14:07 stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/NOTICE
--rw-rw-r--  2.0 unx      110 b- defN 23-Jun-15 14:07 stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/WHEEL
--rw-rw-r--  2.0 unx       21 b- defN 23-Jun-15 14:07 stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     3671 b- defN 23-Jun-15 14:07 stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/RECORD
-28 files, 149025 bytes uncompressed, 32449 bytes compressed:  78.2%
+Zip file size: 57269 bytes, number of entries: 30
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/__init__.py
+-rw-rw-r--  2.0 unx      432 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/entry_point.py
+-rw-rw-r--  2.0 unx   106615 b- defN 23-Jul-20 18:39 stix_shifter_modules/azure_log_analytics/configuration/config.json
+-rw-rw-r--  2.0 unx      251 b- defN 23-Jul-20 18:39 stix_shifter_modules/azure_log_analytics/configuration/dialects.json
+-rw-rw-r--  2.0 unx     3348 b- defN 23-Jul-20 18:39 stix_shifter_modules/azure_log_analytics/configuration/lang_en.json
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_translation/__init__.py
+-rw-rw-r--  2.0 unx    27024 b- defN 23-Jul-20 18:39 stix_shifter_modules/azure_log_analytics/stix_translation/json_to_stix_translator.py
+-rw-rw-r--  2.0 unx    22079 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_translation/query_constructor.py
+-rw-rw-r--  2.0 unx     1037 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_translation/query_translator.py
+-rw-rw-r--  2.0 unx     2918 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_translation/transformers.py
+-rw-rw-r--  2.0 unx     6519 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityAlert_from_stix_map.json
+-rw-rw-r--  2.0 unx     3823 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityEvent_from_stix_map.json
+-rw-rw-r--  2.0 unx     2539 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityIncident_from_stix_map.json
+-rw-rw-r--  2.0 unx      987 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_translation/json/config_map.json
+-rw-rw-r--  2.0 unx      589 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_translation/json/operators.json
+-rw-rw-r--  2.0 unx    28863 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_translation/json/to_stix_map.json
+-rw-rw-r--  2.0 unx     6521 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/SecurityAlert_from_stix_map.json
+-rw-rw-r--  2.0 unx     3825 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/SecurityEvent_from_stix_map.json
+-rw-rw-r--  2.0 unx     2541 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/SecurityIncident_from_stix_map.json
+-rw-rw-r--  2.0 unx    28869 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/to_stix_map.json
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_transmission/__init__.py
+-rw-rw-r--  2.0 unx     2926 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_transmission/api_client.py
+-rw-rw-r--  2.0 unx    14831 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_transmission/connector.py
+-rw-rw-r--  2.0 unx     1333 b- defN 23-Jul-20 18:36 stix_shifter_modules/azure_log_analytics/stix_transmission/error_mapper.py
+-rw-rw-r--  2.0 unx    12786 b- defN 23-Jul-20 18:39 stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/LICENSE.md
+-rw-rw-r--  2.0 unx     8200 b- defN 23-Jul-20 18:39 stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/METADATA
+-rw-rw-r--  2.0 unx     1418 b- defN 23-Jul-20 18:39 stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/NOTICE
+-rw-rw-r--  2.0 unx      110 b- defN 23-Jul-20 18:39 stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       21 b- defN 23-Jul-20 18:39 stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     3975 b- defN 23-Jul-20 18:39 stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/RECORD
+30 files, 294380 bytes uncompressed, 50313 bytes compressed:  82.9%
```

## zipnote {}

```diff
@@ -21,23 +21,29 @@
 
 Filename: stix_shifter_modules/azure_log_analytics/stix_translation/query_constructor.py
 Comment: 
 
 Filename: stix_shifter_modules/azure_log_analytics/stix_translation/query_translator.py
 Comment: 
 
+Filename: stix_shifter_modules/azure_log_analytics/stix_translation/transformers.py
+Comment: 
+
 Filename: stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityAlert_from_stix_map.json
 Comment: 
 
 Filename: stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityEvent_from_stix_map.json
 Comment: 
 
 Filename: stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityIncident_from_stix_map.json
 Comment: 
 
+Filename: stix_shifter_modules/azure_log_analytics/stix_translation/json/config_map.json
+Comment: 
+
 Filename: stix_shifter_modules/azure_log_analytics/stix_translation/json/operators.json
 Comment: 
 
 Filename: stix_shifter_modules/azure_log_analytics/stix_translation/json/to_stix_map.json
 Comment: 
 
 Filename: stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/SecurityAlert_from_stix_map.json
@@ -60,26 +66,26 @@
 
 Filename: stix_shifter_modules/azure_log_analytics/stix_transmission/connector.py
 Comment: 
 
 Filename: stix_shifter_modules/azure_log_analytics/stix_transmission/error_mapper.py
 Comment: 
 
-Filename: stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/LICENSE.md
+Filename: stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/LICENSE.md
 Comment: 
 
-Filename: stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/METADATA
+Filename: stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/METADATA
 Comment: 
 
-Filename: stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/NOTICE
+Filename: stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/NOTICE
 Comment: 
 
-Filename: stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/WHEEL
+Filename: stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/WHEEL
 Comment: 
 
-Filename: stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/top_level.txt
+Filename: stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/top_level.txt
 Comment: 
 
-Filename: stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/RECORD
+Filename: stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## stix_shifter_modules/azure_log_analytics/entry_point.py

```diff
@@ -1,13 +1,8 @@
-import os
-import importlib
-from .stix_translation.query_translator import QueryTranslator
 from stix_shifter_utils.utils.base_entry_point import BaseEntryPoint
-from stix_shifter_utils.modules.base.stix_transmission.base_connector import BaseConnector
-from stix_shifter_utils.stix_translation.src.json_to_stix.json_to_stix import JSONToStix
 
 
 class EntryPoint(BaseEntryPoint):
 
     def __init__(self, connection={}, configuration={}, options={}):
         super().__init__(connection, configuration, options)
         self.set_async(False)
```

## stix_shifter_modules/azure_log_analytics/configuration/config.json

### Pretty-printed

 * *Similarity: 0.9954935159532005%*

 * *Differences: {"'connection'": "{'help': {'default': 'data-sources.html'}, 'options': {'mapping': {'default': "*

 * *                 "{'SecurityAlert_from_stix_map': {'x-ibm-finding': {'fields': {'start': {delete: "*

 * *                 "[1]}, 'end': {delete: [1]}, 'time_observed': {delete: [1]}, 'x_alert_link': "*

 * *                 "['AlertLink'], 'severity': ['AlertSeverity'], 'x_alert_type': ['AlertType'], "*

 * *                 "'x_compromised_entity': ['CompromisedEntity'], 'x_confidence_level': "*

 * *                 "['ConfidenceLe [â€¦]*

```diff
@@ -11,15 +11,15 @@
                 "type": "password"
             },
             "type": "fields"
         }
     },
     "connection": {
         "help": {
-            "default": "data-sources-sentinel.html",
+            "default": "data-sources.html",
             "type": "link"
         },
         "host": {
             "default": "api.loganalytics.io",
             "regex": "^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9_:/\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9_:/\\-]*[A-Za-z0-9])$",
             "type": "text"
         },
@@ -39,718 +39,2192 @@
                 "hidden": true,
                 "optional": true,
                 "type": "string"
             },
             "mapping": {
                 "default": {
                     "SecurityAlert_from_stix_map": {
-                        "x-azure-security-alert": {
+                        "directory": {
                             "fields": {
-                                "alert_severity": [
-                                    "AlertSeverity"
+                                "path": [
+                                    "Entities.Directory"
+                                ]
+                            }
+                        },
+                        "domain-name": {
+                            "fields": {
+                                "value": [
+                                    "Entities.DomainName"
+                                ]
+                            }
+                        },
+                        "file": {
+                            "fields": {
+                                "hashes.'SHA-1'": [
+                                    "Entities.Value"
                                 ],
-                                "compromised_entity": [
-                                    "CompromisedEntity"
+                                "hashes.'SHA-256'": [
+                                    "Entities.Value"
                                 ],
-                                "confidence_level": [
-                                    "ConfidenceLevel"
+                                "hashes.MD5": [
+                                    "Entities.Value"
                                 ],
-                                "description": [
-                                    "Description"
+                                "name": [
+                                    "Entities.Name"
                                 ],
-                                "display_name": [
-                                    "DisplayName"
+                                "parent_directory_ref.path": [
+                                    "Entities.Directory"
+                                ]
+                            }
+                        },
+                        "ipv4-addr": {
+                            "fields": {
+                                "value": [
+                                    "Entities.Address"
+                                ],
+                                "x_location_ref.carrier": [
+                                    "Entities.Location.Carrier"
+                                ],
+                                "x_location_ref.city": [
+                                    "Entities.Location.City"
+                                ],
+                                "x_location_ref.country": [
+                                    "Entities.Location.CountryName"
+                                ],
+                                "x_location_ref.latitude": [
+                                    "Entities.Location.Latitude"
+                                ],
+                                "x_location_ref.longitude": [
+                                    "Entities.Location.Longitude"
+                                ],
+                                "x_location_ref.organization": [
+                                    "Entities.Location.Organization"
+                                ]
+                            }
+                        },
+                        "ipv6-addr": {
+                            "fields": {
+                                "value": [
+                                    "Entities.Address"
+                                ],
+                                "x_location_ref.carrier": [
+                                    "Entities.Location.Carrier"
+                                ],
+                                "x_location_ref.city": [
+                                    "Entities.Location.City"
                                 ],
-                                "entities": [
-                                    "Entities"
+                                "x_location_ref.country": [
+                                    "Entities.Location.CountryName"
                                 ],
-                                "extented_properties": [
-                                    "ExtentedProperties"
+                                "x_location_ref.latitude": [
+                                    "Entities.Location.Latitude"
                                 ],
-                                "product_name": [
+                                "x_location_ref.longitude": [
+                                    "Entities.Location.Longitude"
+                                ],
+                                "x_location_ref.organization": [
+                                    "Entities.Location.Organization"
+                                ]
+                            }
+                        },
+                        "network-traffic": {
+                            "fields": {
+                                "dst_port": [
+                                    "Entities.DestinationPort"
+                                ],
+                                "protocols[*]": [
+                                    "Entities.Protocol"
+                                ],
+                                "src_ref.value": [
+                                    "Entities.Address"
+                                ]
+                            }
+                        },
+                        "process": {
+                            "fields": {
+                                "binary_ref.hashes.'SHA-256'": [
+                                    "Entities.Value"
+                                ],
+                                "binary_ref.hashes.'SHA1'": [
+                                    "Entities.Value"
+                                ],
+                                "binary_ref.hashes.MD5": [
+                                    "Entities.Value"
+                                ],
+                                "command_line": [
+                                    "Entities.CommandLine"
+                                ],
+                                "created": [
+                                    "Entities.CreationTimeUtc"
+                                ],
+                                "creator_user_ref.user_id": [
+                                    "Entities.Name"
+                                ],
+                                "parent_ref.binary_ref.hashes.'SHA-256'": [
+                                    "Entities.Value"
+                                ],
+                                "parent_ref.binary_ref.hashes.'SHA1'": [
+                                    "Entities.Value"
+                                ],
+                                "parent_ref.binary_ref.hashes.MD5": [
+                                    "Entities.Value"
+                                ],
+                                "parent_ref.command_line": [
+                                    "Entities.CommandLine"
+                                ],
+                                "parent_ref.pid": [
+                                    "Entities.ProcessId"
+                                ],
+                                "pid": [
+                                    "Entities.ProcessId"
+                                ],
+                                "x_elevation_token": [
+                                    "Entities.ElevationToken"
+                                ]
+                            }
+                        },
+                        "software": {
+                            "fields": {
+                                "name": [
+                                    "Entities.OSFamily",
                                     "ProductName"
                                 ],
-                                "resourceId": [
-                                    "_ResourceId"
+                                "vendor": [
+                                    "VendorName"
                                 ],
-                                "status": [
-                                    "Status"
+                                "version": [
+                                    "Entities.OSVersion"
                                 ],
-                                "subscription_id": [
-                                    "WorkspaceSubscriptionId"
+                                "x_product_component_name": [
+                                    "ProductComponentName"
                                 ],
-                                "system_alertid": [
-                                    "SystemAlertId"
+                                "x_provider_name": [
+                                    "ProviderName"
+                                ]
+                            }
+                        },
+                        "url": {
+                            "fields": {
+                                "value": [
+                                    "Entities.Url"
+                                ]
+                            }
+                        },
+                        "user-account": {
+                            "fields": {
+                                "display_name": [
+                                    "Entities.DisplayName"
+                                ],
+                                "user_id": [
+                                    "Entities.Name"
+                                ],
+                                "x_aad_user_id": [
+                                    "Entities.AadUserId"
+                                ],
+                                "x_account_sid": [
+                                    "Entities.Sid"
+                                ],
+                                "x_dns_domain": [
+                                    "Entities.DnsDomain"
+                                ],
+                                "x_is_domain_account": [
+                                    "Entities.IsDomainJoined"
+                                ],
+                                "x_nt_domain": [
+                                    "Entities.NTDomain"
+                                ],
+                                "x_passport_userid": [
+                                    "Entities.PUID"
+                                ],
+                                "x_upn_suffix": [
+                                    "Entities.UPNSuffix"
+                                ]
+                            }
+                        },
+                        "x-azure-blob": {
+                            "fields": {
+                                "blob_container": [
+                                    "Entities.Name"
+                                ],
+                                "etag": [
+                                    "Entities.Etag"
+                                ],
+                                "name": [
+                                    "Entities.Name"
+                                ]
+                            }
+                        },
+                        "x-azure-container": {
+                            "fields": {
+                                "container_id": [
+                                    "Entities.ContainerId"
+                                ],
+                                "image_id": [
+                                    "Entities.ImageId"
+                                ],
+                                "image_type": [
+                                    "Entities.Type"
+                                ]
+                            }
+                        },
+                        "x-azure-malware": {
+                            "fields": {
+                                "category": [
+                                    "Entities.Category"
                                 ],
+                                "name": [
+                                    "Entities.Name"
+                                ]
+                            }
+                        },
+                        "x-cloud-provider": {
+                            "fields": {
                                 "tenant_id": [
                                     "TenantId"
+                                ]
+                            }
+                        },
+                        "x-cloud-resource": {
+                            "fields": {
+                                "resource_id": [
+                                    "ResourceId"
                                 ],
-                                "vendor_name": [
-                                    "VendorName"
+                                "resource_type": [
+                                    "ExtendedProperties.resourceType"
+                                ]
+                            }
+                        },
+                        "x-geo-location": {
+                            "fields": {
+                                "carrier": [
+                                    "Entities.Location.Carrier"
+                                ],
+                                "city": [
+                                    "Entities.Location.City"
+                                ],
+                                "country": [
+                                    "Entities.Location.CountryName"
                                 ],
-                                "workspace_resource_group": [
-                                    "WorkspaceResourceGroup"
+                                "latitude": [
+                                    "Entities.Location.Latitude"
+                                ],
+                                "longitude": [
+                                    "Entities.Location.Longitude"
+                                ],
+                                "organization": [
+                                    "Entities.Location.Organization"
+                                ]
+                            }
+                        },
+                        "x-host-logon-session": {
+                            "fields": {
+                                "end_time": [
+                                    "Entities.EndTimeUtc"
+                                ],
+                                "session_id": [
+                                    "Entities.SessionId"
+                                ],
+                                "start_time": [
+                                    "Entities.StartTimeUtc"
                                 ]
                             }
                         },
                         "x-ibm-finding": {
                             "fields": {
+                                "alert_id": [
+                                    "VendorOriginalId"
+                                ],
+                                "confidence": [
+                                    "ConfidenceScore"
+                                ],
+                                "description": [
+                                    "Description"
+                                ],
+                                "dst_application_ref.name": [
+                                    "ProductName"
+                                ],
+                                "dst_application_ref.vendor": [
+                                    "VendorName"
+                                ],
+                                "dst_os_ref.name": [
+                                    "Entities.OSFamily"
+                                ],
+                                "dst_os_ref.version": [
+                                    "Entities.OSVersion"
+                                ],
+                                "dst_os_user_ref.user_id": [
+                                    "Entities.Name"
+                                ],
                                 "end": [
-                                    "EndTime",
-                                    "ProcessingEndTime"
+                                    "EndTime"
+                                ],
+                                "finding_type": [
+                                    "Type"
+                                ],
+                                "ioc_refs[*].value": [
+                                    "Entities.Name",
+                                    "Entities.Address",
+                                    "Entities.Url",
+                                    "Entities.DomainName"
                                 ],
                                 "name": [
                                     "AlertName"
                                 ],
+                                "severity": [
+                                    "AlertSeverity"
+                                ],
                                 "start": [
-                                    "StartTime",
-                                    "TimeGenerated"
+                                    "StartTime"
                                 ],
                                 "time_observed": [
-                                    "TimeGenerated",
-                                    "EventTime"
+                                    "TimeGenerated"
+                                ],
+                                "ttp_tagging_refs[*].confidence": [
+                                    "ConfidenceScore"
+                                ],
+                                "ttp_tagging_refs[*].extensions.'mitre-attack-ext'.tactic_name": [
+                                    "Tactics"
+                                ],
+                                "ttp_tagging_refs[*].extensions.'mitre-attack-ext'.technique_name": [
+                                    "Techniques"
+                                ],
+                                "ttp_tagging_refs[*].name": [
+                                    "AlertName"
+                                ],
+                                "x_alert_link": [
+                                    "AlertLink"
+                                ],
+                                "x_alert_type": [
+                                    "AlertType"
+                                ],
+                                "x_compromised_entity": [
+                                    "CompromisedEntity"
+                                ],
+                                "x_confidence_level": [
+                                    "ConfidenceLevel"
+                                ],
+                                "x_processing_endtime": [
+                                    "ProcessingEndTime"
+                                ],
+                                "x_remediationsteps": [
+                                    "RemediationSteps"
+                                ],
+                                "x_status": [
+                                    "Status"
+                                ],
+                                "x_system_alert_id": [
+                                    "SystemAlertId"
                                 ]
                             }
                         },
-                        "x-oca-event": {
+                        "x-ibm-ttp-tagging": {
                             "fields": {
-                                "created": [
-                                    "TimeGenerated"
+                                "confidence": [
+                                    "ConfidenceScore"
                                 ],
-                                "domain_ref": [
-                                    "DomainName"
+                                "extensions.'mitre-attack-ext'.tactic_name": [
+                                    "Tactics"
                                 ],
-                                "provider": [
-                                    "ProviderName"
+                                "extensions.'mitre-attack-ext'.technique_name": [
+                                    "Techniques"
+                                ],
+                                "name": [
+                                    "AlertName"
+                                ]
+                            }
+                        },
+                        "x-k8s-cluster": {
+                            "fields": {
+                                "name": [
+                                    "Entities.Name"
+                                ]
+                            }
+                        },
+                        "x-oca-asset": {
+                            "fields": {
+                                "hostname": [
+                                    "Entities.HostName"
+                                ],
+                                "os_ref.name": [
+                                    "Entities.OSFamily"
+                                ],
+                                "os_ref.version": [
+                                    "Entities.OSVersion"
+                                ],
+                                "x_is_domain_host": [
+                                    "Entities.IsDomainJoined"
+                                ],
+                                "x_netbios_name": [
+                                    "Entities.NetBiosName"
+                                ],
+                                "x_nt_domain": [
+                                    "Entities.NTDomain"
+                                ],
+                                "x_oms_agent_id": [
+                                    "Entities.OMSAgentID"
+                                ],
+                                "x_resource_id": [
+                                    "ResourceId"
                                 ]
                             }
                         }
                     },
                     "SecurityEvent_from_stix_map": {
                         "directory": {
                             "fields": {
                                 "path": [
                                     "HomeDirectory",
-                                    "HomePath"
-                                ]
-                            }
-                        },
-                        "domain-name": {
-                            "fields": {
-                                "value": [
-                                    "TargetDomainName"
+                                    "HomePath",
+                                    "ProcessName",
+                                    "ParentProcessName",
+                                    "NewProcessName"
                                 ]
                             }
                         },
                         "file": {
                             "fields": {
                                 "hashes.'SHA-1'": [
                                     "FileHash"
                                 ],
                                 "hashes.'SHA-256'": [
                                     "FileHash"
                                 ],
                                 "hashes.MD5": [
                                     "FileHash"
                                 ],
+                                "name": [
+                                    "FilePath"
+                                ],
+                                "parent_directory_ref": [
+                                    "ProcessName",
+                                    "ParentProcessName"
+                                ],
                                 "path": [
                                     "FilePath"
+                                ],
+                                "x_fqbn": [
+                                    "Fqbn"
                                 ]
                             }
                         },
                         "ipv4-addr": {
                             "fields": {
                                 "value": [
-                                    "IpAddress"
+                                    "IpAddress",
+                                    "ClientIPAddress"
+                                ]
+                            }
+                        },
+                        "ipv6-addr": {
+                            "fields": {
+                                "value": [
+                                    "IpAddress",
+                                    "ClientIPAddress"
                                 ]
                             }
                         },
                         "process": {
                             "fields": {
                                 "command_line": [
                                     "CommandLine"
                                 ],
-                                "name": [
-                                    "ProcessName",
-                                    "LogonProcessName"
-                                ],
                                 "parent_ref.name": [
                                     "ParentProcessName"
                                 ],
                                 "pid": [
-                                    "ProcessId"
+                                    "ProcessId",
+                                    "NewProcessId"
+                                ],
+                                "x_mandatory_label": [
+                                    "MandatoryLabel"
+                                ],
+                                "x_token_elevation_type": [
+                                    "TokenElevationType"
                                 ]
                             }
                         },
                         "url": {
                             "fields": {
                                 "value": [
                                     "QuarantineHelpURL"
                                 ]
                             }
                         },
                         "user-account": {
                             "fields": {
                                 "account_login": [
-                                    "TargetUserName"
+                                    "TargetAccount",
+                                    "SubjectAccount"
+                                ],
+                                "display_name": [
+                                    "TargetUserName",
+                                    "SubjectUserName"
+                                ],
+                                "user_id": [
+                                    "TargetUserName",
+                                    "SubjectUserName"
+                                ],
+                                "x_domain_name": [
+                                    "TargetDomainName",
+                                    "SubjectDomainName"
+                                ],
+                                "x_login_id": [
+                                    "TargetLogonId",
+                                    "SubjectLogonId"
+                                ],
+                                "x_user_sid": [
+                                    "TargetUserSid",
+                                    "SubjectUserSid"
                                 ]
                             }
                         },
-                        "x-azure-security-event": {
+                        "x-cloud-resource": {
                             "fields": {
-                                "activity": [
-                                    "Activity"
-                                ],
-                                "alert_type": [
-                                    "AlertName"
-                                ],
-                                "computer": [
-                                    "Computer"
-                                ],
-                                "device_name": [
-                                    "DeviceId"
-                                ],
-                                "event_data": [
-                                    "EventData"
-                                ],
-                                "member_name": [
-                                    "MemberName"
-                                ],
-                                "requester": [
-                                    "Requester"
-                                ],
-                                "service_name": [
-                                    "ServiceName"
-                                ],
-                                "source": [
-                                    "SourceSystem"
-                                ],
-                                "task": [
-                                    "Task"
-                                ],
-                                "text": [
-                                    "Description",
-                                    "DeviceDescription"
-                                ],
-                                "title": [
-                                    "Title"
-                                ],
-                                "user_parameter": [
-                                    "UserParameter"
+                                "resource_id": [
+                                    "_ResourceId"
                                 ]
                             }
                         },
                         "x-ibm-finding": {
                             "fields": {
-                                "dst_ip_ref": [
-                                    "ClientIPAddress"
+                                "alert_id": [
+                                    "EventOriginId"
                                 ],
-                                "end": [
-                                    "PreviousTime"
+                                "dst_application_user_ref": [
+                                    "SubjectUserName"
+                                ],
+                                "dst_device": [
+                                    "WorkstationName",
+                                    "TargetServerName"
+                                ],
+                                "finding_type": [
+                                    "Type"
+                                ],
+                                "ioc_refs": [
+                                    "FilePath",
+                                    "IpAddress",
+                                    "ClientIPAddress"
                                 ],
                                 "name": [
-                                    "EventSourceName"
+                                    "Activity"
+                                ],
+                                "src_application_user_ref": [
+                                    "TargetUserName"
                                 ],
                                 "src_ip_ref": [
                                     "IpAddress"
                                 ],
                                 "start": [
-                                    "TimeGenerated"
+                                    "PreviousTime"
                                 ],
                                 "time_observed": [
                                     "TimeGenerated"
                                 ]
                             }
                         },
+                        "x-logon-info": {
+                            "fields": {
+                                "authentication_package_name": [
+                                    "AuthenticationPackageName"
+                                ],
+                                "guid": [
+                                    "LogonGuid"
+                                ],
+                                "logon_process": [
+                                    "LogonProcessName"
+                                ],
+                                "logon_type": [
+                                    "LogonType"
+                                ],
+                                "logon_type_name": [
+                                    "LogonTypeName"
+                                ]
+                            }
+                        },
+                        "x-oca-asset": {
+                            "fields": {
+                                "device_id": [
+                                    "DeviceId",
+                                    "SourceComputerId"
+                                ],
+                                "hostname": [
+                                    "Computer"
+                                ]
+                            }
+                        },
                         "x-oca-event": {
                             "fields": {
+                                "action": [
+                                    "Activity"
+                                ],
                                 "code": [
                                     "EventID"
                                 ],
                                 "created": [
-                                    "TimeGenerated"
+                                    "TimeCollected"
+                                ],
+                                "dataset": [
+                                    "EventData"
                                 ],
                                 "file_ref.hash": [
                                     "FileHash"
                                 ],
                                 "file_ref.path": [
                                     "FilePath"
                                 ],
-                                "file_ref.service": [
-                                    "ServiceFileName"
+                                "host_ref": [
+                                    "Computer"
                                 ],
-                                "ip_refs.clientIp": [
+                                "ip_refs.ip": [
+                                    "IpAddress",
                                     "ClientIPAddress"
                                 ],
-                                "ip_refs.ip": [
-                                    "IpAddress"
+                                "modified": [
+                                    "TimeCollected"
+                                ],
+                                "module": [
+                                    "Channel"
                                 ],
                                 "parent_process_ref": [
                                     "ParentProcessName"
                                 ],
                                 "process_ref": [
+                                    "NewProcessName",
+                                    "Process",
                                     "ProcessName"
                                 ],
                                 "provider": [
-                                    "Account"
+                                    "EventSourceName"
                                 ],
                                 "url_ref": [
                                     "QuarantineHelpURL"
+                                ],
+                                "user_ref": [
+                                    "TargetUserName"
+                                ],
+                                "x_description": [
+                                    "DeviceDescription"
+                                ],
+                                "x_member_name": [
+                                    "MemberName"
+                                ],
+                                "x_modified_account_sid": [
+                                    "TargetSid"
+                                ],
+                                "x_requester": [
+                                    "Requester"
+                                ],
+                                "x_service_file_ref": [
+                                    "ServiceFileName"
+                                ],
+                                "x_service_name": [
+                                    "ServiceName"
+                                ],
+                                "x_task": [
+                                    "Task"
+                                ],
+                                "x_user_parameter": [
+                                    "UserParameters"
                                 ]
                             }
                         }
                     },
                     "SecurityIncident_from_stix_map": {
+                        "email-addr": {
+                            "fields": {
+                                "display_name": [
+                                    "Owner.assignedTo"
+                                ],
+                                "value": [
+                                    "Owner.email",
+                                    "Owner.userPrincipalName"
+                                ]
+                            }
+                        },
                         "url": {
                             "fields": {
                                 "value": [
                                     "IncidentUrl"
                                 ]
                             }
                         },
-                        "x-azure-security-incident": {
+                        "x-cloud-provider": {
                             "fields": {
-                                "additional_data": [
-                                    "AdditionalData"
+                                "tenant_id": [
+                                    "TenantId"
+                                ]
+                            }
+                        },
+                        "x-ibm-finding": {
+                            "fields": {
+                                "description": [
+                                    "Description"
                                 ],
-                                "alertids": [
-                                    "AlertIds"
+                                "end": [
+                                    "LastModifiedTime"
                                 ],
-                                "classification": [
-                                    "Classification"
+                                "finding_type": [
+                                    "Type"
                                 ],
-                                "comments": [
-                                    "Comments"
+                                "name": [
+                                    "Title"
                                 ],
-                                "description": [
-                                    "Description"
+                                "rule_names[*]": [
+                                    "RelatedAnalyticRuleIds"
                                 ],
-                                "incident_name": [
-                                    "IncidentName"
+                                "severity": [
+                                    "Severity"
                                 ],
-                                "labels": [
-                                    "Labels"
+                                "start": [
+                                    "CreatedTime"
+                                ],
+                                "time_observed": [
+                                    "TimeGenerated"
+                                ],
+                                "ttp_tagging_refs[*].extensions.'mitre-attack-ext'.tactic_name": [
+                                    "AdditionalData.tactics"
+                                ],
+                                "ttp_tagging_refs[*].extensions.'mitre-attack-ext'.technique_name": [
+                                    "AdditionalData.techniques"
+                                ],
+                                "ttp_tagging_refs[*].name": [
+                                    "Title"
+                                ],
+                                "x_alert_count": [
+                                    "AdditionalData.alertsCount"
+                                ],
+                                "x_alert_ids[*]": [
+                                    "AlertIds"
+                                ],
+                                "x_alert_product_names": [
+                                    "AdditionalData.alertProductNames"
+                                ],
+                                "x_incident_name": [
+                                    "IncidentName"
                                 ],
-                                "modified_by": [
+                                "x_modified_by": [
                                     "ModifiedBy"
                                 ],
-                                "owner": [
-                                    "Owner"
+                                "x_owner_ref": [
+                                    "Owner.email",
+                                    "Owner.userPrincipalName",
+                                    "Owner.assignedTo"
+                                ],
+                                "x_owner_ref.display_name": [
+                                    "Owner.assignedTo"
+                                ],
+                                "x_owner_ref.value": [
+                                    "Owner.email",
+                                    "Owner.userPrincipalName"
                                 ],
-                                "severity": [
-                                    "Severity"
+                                "x_provider_incident_id": [
+                                    "ProviderIncidentId"
+                                ],
+                                "x_provider_name": [
+                                    "ProviderName"
+                                ],
+                                "x_status": [
+                                    "Status"
                                 ]
                             }
                         },
-                        "x-ibm-finding": {
+                        "x-ibm-ttp-tagging": {
                             "fields": {
-                                "end": [
-                                    "ClosedTime",
-                                    "LastActivityTime",
-                                    "LastModifiedTime"
+                                "extensions.'mitre-attack-ext'.tactic_name": [
+                                    "AdditionalData.tactics"
                                 ],
-                                "name": [
-                                    "IncidentName"
+                                "extensions.'mitre-attack-ext'.technique_name": [
+                                    "AdditionalData.techniques"
                                 ],
-                                "start": [
-                                    "FirstActivityTime",
-                                    "FirstModifiedTime",
-                                    "TimeGenerated"
-                                ],
-                                "time_observed": [
-                                    "TimeGenerated"
+                                "name": [
+                                    "Title"
                                 ]
                             }
                         },
-                        "x-oca-event": {
+                        "x-incident-info": {
                             "fields": {
-                                "created": [
-                                    "CreatedTime"
+                                "classification": [
+                                    "Classification"
                                 ],
-                                "domain_ref": [
-                                    "DomainName"
+                                "classification_comment": [
+                                    "ClassificationComment"
                                 ],
-                                "provider": [
-                                    "ProviderName"
+                                "classification_reason": [
+                                    "ClassificationReason"
                                 ],
-                                "url_ref": [
+                                "closed_time": [
+                                    "ClosedTime"
+                                ],
+                                "comments": [
+                                    "Comments"
+                                ],
+                                "first_activity": [
+                                    "FirstActivityTime"
+                                ],
+                                "first_modified": [
+                                    "FirstModifiedTime"
+                                ],
+                                "incident_url_ref.value": [
                                     "IncidentUrl"
+                                ],
+                                "labels": [
+                                    "Labels"
+                                ],
+                                "last_active": [
+                                    "LastActivityTime"
+                                ],
+                                "tasks": [
+                                    "Tasks"
                                 ]
                             }
                         }
                     },
+                    "config_map": {
+                        "enum_supported_fields": [
+                            "AlertSeverity",
+                            "Severity",
+                            "Type"
+                        ],
+                        "enum_supported_values": {
+                            "Severity": {
+                                "100": "High",
+                                "25": "Informational",
+                                "50": "Low",
+                                "75": "Medium"
+                            },
+                            "Type": {
+                                "alert": "SecurityAlert",
+                                "event": "SecurityEvent",
+                                "violation": "SecurityIncident"
+                            }
+                        },
+                        "file_hash_fields": [
+                            "hashes.'SHA-256'",
+                            "hashes.'SHA-1'",
+                            "hashes.MD5"
+                        ],
+                        "hexadecimal_fields": [
+                            "Entities.SessionId"
+                        ],
+                        "int_supported_fields": [
+                            "EventID",
+                            "Task",
+                            "AdditionalData.alertsCount",
+                            "LogonType",
+                            "ConfidenceScore",
+                            "Entities.DestinationPort",
+                            "Entities.SessionId"
+                        ],
+                        "score_fields": [
+                            "ConfidenceScore"
+                        ],
+                        "timestamp_supported_fields": [
+                            "FirstActivityTime",
+                            "FirstModifiedTime",
+                            "TimeGenerated",
+                            "ClosedTime",
+                            "LastActivityTime",
+                            "LastModifiedTime",
+                            "CreatedTime",
+                            "StartTime",
+                            "EndTime",
+                            "ProcessingEndTime",
+                            "TimeCollected"
+                        ]
+                    },
                     "operators": {
                         "ComparisonComparators.Equal": "==",
-                        "ComparisonComparators.In": "in",
-                        "ComparisonComparators.Like": "startswith, endswith",
-                        "ComparisonComparators.Matches": "contains",
+                        "ComparisonComparators.GreaterThan": ">",
+                        "ComparisonComparators.GreaterThanOrEqual": ">=",
+                        "ComparisonComparators.In": "in~",
+                        "ComparisonComparators.LessThan": "<",
+                        "ComparisonComparators.LessThanOrEqual": "<=",
+                        "ComparisonComparators.Like": "contains",
+                        "ComparisonComparators.Matches": "matches regex",
                         "ComparisonComparators.NotEqual": "!=",
                         "ComparisonExpressionOperators.And": "and",
-                        "ComparisonExpressionOperators.Or": "or"
+                        "ComparisonExpressionOperators.Or": "or",
+                        "ObservationOperators.And": "or",
+                        "ObservationOperators.Or": "or"
                     },
                     "to_stix_map": {
-                        "Account": {
-                            "key": "x-oca-event.provider",
-                            "object": "event"
-                        },
-                        "Activity": {
-                            "key": "x-azure-security-event.activity",
-                            "object": "msevent"
-                        },
+                        "Activity": [
+                            {
+                                "key": "x-oca-event.action",
+                                "object": "event"
+                            },
+                            {
+                                "key": "x-ibm-finding.name",
+                                "object": "finding"
+                            }
+                        ],
                         "AdditionalData": {
-                            "key": "x-azure-security-incident.additional_data",
-                            "object": "incident"
+                            "alertProductNames": {
+                                "key": "x-ibm-finding.x_alert_product_names",
+                                "object": "finding"
+                            },
+                            "alertsCount": {
+                                "key": "x-ibm-finding.x_alert_count",
+                                "object": "finding"
+                            },
+                            "tactics": {
+                                "key": "x-ibm-ttp-tagging.extensions.mitre-attack-ext.tactic_name",
+                                "object": "ttp_finding"
+                            },
+                            "techniques": {
+                                "key": "x-ibm-ttp-tagging.extensions.mitre-attack-ext.technique_name",
+                                "object": "ttp_finding"
+                            }
                         },
                         "AlertIds": {
-                            "key": "x-azure-security-incident.alertids",
-                            "object": "incident"
+                            "key": "x-ibm-finding.x_alert_ids",
+                            "object": "finding"
+                        },
+                        "AlertLink": {
+                            "key": "x-ibm-finding.x_alert_link",
+                            "object": "finding"
                         },
                         "AlertName": [
                             {
                                 "key": "x-ibm-finding.name",
                                 "object": "finding"
                             },
                             {
-                                "key": "x-azure-security-event.alert_type",
-                                "object": "msevent"
+                                "key": "x-ibm-ttp-tagging.name",
+                                "object": "ttp_finding"
+                            },
+                            {
+                                "key": "x-ibm-finding.ttp_tagging_refs",
+                                "object": "finding",
+                                "references": [
+                                    "ttp_finding"
+                                ]
                             }
                         ],
                         "AlertSeverity": {
-                            "key": "x-azure-security-alert.alert_severity",
-                            "object": "alert"
+                            "key": "x-ibm-finding.severity",
+                            "object": "finding",
+                            "transformer": "ConvertSeverityToScore"
+                        },
+                        "AlertType": {
+                            "key": "x-ibm-finding.x_alert_type",
+                            "object": "finding"
+                        },
+                        "AuthenticationPackageName": {
+                            "key": "x-logon-info.authentication_package_name",
+                            "object": "logon_info"
+                        },
+                        "Channel": {
+                            "key": "x-oca-event.module",
+                            "object": "event"
+                        },
+                        "Classification": {
+                            "key": "x-incident-info.classification",
+                            "object": "incident"
+                        },
+                        "ClassificationComment": {
+                            "key": "x-incident-info.classification_comment",
+                            "object": "incident"
+                        },
+                        "ClassificationReason": {
+                            "key": "x-incident-info.classification_reason",
+                            "object": "incident"
                         },
                         "ClientIPAddress": [
                             {
+                                "key": "ipv4-addr.value",
+                                "object": "client"
+                            },
+                            {
+                                "key": "ipv6-addr.value",
+                                "object": "client"
+                            },
+                            {
                                 "key": "x-ibm-finding.dst_ip_ref",
-                                "object": "finding"
+                                "object": "finding",
+                                "references": "client"
                             },
                             {
-                                "key": "x-oca-event.ip_refs.clientIp",
-                                "object": "event"
+                                "group": true,
+                                "key": "x-ibm-finding.ioc_refs",
+                                "object": "finding",
+                                "references": [
+                                    "client"
+                                ]
+                            },
+                            {
+                                "group": true,
+                                "key": "x-oca-event.ip_refs",
+                                "object": "event",
+                                "references": [
+                                    "client"
+                                ]
                             }
                         ],
                         "ClosedTime": {
-                            "key": "x-ibm-finding.end",
-                            "object": "finding"
+                            "key": "x-incident-info.closed_time",
+                            "object": "incident"
                         },
                         "CommandLine": {
                             "key": "process.command_line",
                             "object": "process"
                         },
                         "Comments": {
-                            "key": "x-azure-security-incident.comments",
+                            "key": "x-incident-info.comments",
                             "object": "incident"
                         },
                         "CompromisedEntity": {
-                            "key": "x-azure-security-alert.compromised_entity",
-                            "object": "alert"
-                        },
-                        "Computer": {
-                            "key": "x-azure-security-event.computer",
-                            "object": "msevent"
+                            "key": "x-ibm-finding.x_compromised_entity",
+                            "object": "finding"
                         },
+                        "Computer": [
+                            {
+                                "key": "x-oca-asset.hostname",
+                                "object": "asset"
+                            },
+                            {
+                                "key": "x-oca-event.host_ref",
+                                "object": "event",
+                                "references": "asset"
+                            }
+                        ],
                         "ConfidenceLevel": {
-                            "key": "x-azure-security-alert.confidence_level",
-                            "object": "alert"
-                        },
-                        "CreatedTime": {
-                            "key": "x-oca-event.created",
-                            "object": "event"
+                            "key": "x-ibm-finding.x_confidence_level",
+                            "object": "finding"
                         },
-                        "Description": [
+                        "ConfidenceScore": [
                             {
-                                "key": "x-azure-security-alert.description",
-                                "object": "alert"
+                                "key": "x-ibm-finding.confidence",
+                                "object": "finding",
+                                "transformer": "RealToNumber"
                             },
                             {
-                                "key": "x-azure-security-event.description",
-                                "object": "msevent"
+                                "key": "x-ibm-ttp-tagging.confidence",
+                                "object": "ttp_finding",
+                                "transformer": "ConvertToReal"
                             }
                         ],
-                        "Description__incident": {
-                            "key": "x-azure-security-incident.description",
-                            "object": "incident"
+                        "CreatedTime": {
+                            "key": "x-ibm-finding.start",
+                            "object": "finding"
+                        },
+                        "Description": {
+                            "key": "x-ibm-finding.description",
+                            "object": "finding"
                         },
                         "DeviceDescription": {
-                            "key": "x-azure-security-event.text",
-                            "object": "msevent"
+                            "key": "x-oca-asset.x_description",
+                            "object": "asset"
                         },
                         "DeviceId": {
                             "key": "x-oca-asset.device_id",
                             "object": "asset"
                         },
-                        "DisplayName": {
-                            "key": "x-azure-security-alert.display_name",
-                            "object": "alert"
-                        },
                         "EndTime": {
                             "key": "x-ibm-finding.end",
                             "object": "finding"
                         },
                         "Entities": {
-                            "key": "x-azure-security-alert.entities",
-                            "object": "alert"
+                            "K8s-cluster": {
+                                "Name": {
+                                    "key": "x-k8s-cluster.name",
+                                    "object": "k8s_cluster"
+                                }
+                            },
+                            "account": {
+                                "AadUserId": {
+                                    "key": "user-account.x_aad_user_id",
+                                    "object": "account"
+                                },
+                                "AccountType": {
+                                    "key": "user-account.account_type",
+                                    "object": "account"
+                                },
+                                "DisplayName": {
+                                    "key": "user-account.display_name",
+                                    "object": "account"
+                                },
+                                "DnsDomain": {
+                                    "key": "user-account.x_dns_domain",
+                                    "object": "account"
+                                },
+                                "IsDomainJoined": {
+                                    "key": "user-account.is_service_account",
+                                    "object": "account"
+                                },
+                                "NTDomain": {
+                                    "key": "user-account.x_nt_domain",
+                                    "object": "account"
+                                },
+                                "Name": [
+                                    {
+                                        "key": "user-account.user_id",
+                                        "object": "account"
+                                    },
+                                    {
+                                        "key": "process.creator_user_ref",
+                                        "object": "process1",
+                                        "references": "account"
+                                    },
+                                    {
+                                        "key": "process.creator_user_ref",
+                                        "object": "parent_process",
+                                        "references": "account"
+                                    },
+                                    {
+                                        "key": "x-host-logon-session.account_ref",
+                                        "object": "logon_session",
+                                        "references": "account"
+                                    },
+                                    {
+                                        "key": "x-ibm-finding.dst_os_user_ref",
+                                        "object": "finding",
+                                        "references": "account"
+                                    }
+                                ],
+                                "PUID": {
+                                    "key": "user-account.x_passport_userid",
+                                    "object": "account"
+                                },
+                                "Sid": {
+                                    "key": "user-account.x_account_sid",
+                                    "object": "account"
+                                },
+                                "UPNSuffix": {
+                                    "key": "user-account.x_upn_suffix",
+                                    "object": "account"
+                                }
+                            },
+                            "blob": {
+                                "BlobContainer": {
+                                    "Name": {
+                                        "key": "x-azure-blob.blob_container",
+                                        "object": "blob_storage"
+                                    }
+                                },
+                                "Etag": {
+                                    "key": "x-azure-blob.etag",
+                                    "object": "blob_storage"
+                                },
+                                "Name": {
+                                    "key": "x-azure-blob.name",
+                                    "object": "blob_storage"
+                                },
+                                "Url": [
+                                    {
+                                        "key": "url.value",
+                                        "object": "blobUrl"
+                                    },
+                                    {
+                                        "key": "x-azure-blob.url_ref",
+                                        "object": "blob_storage",
+                                        "references": "blobUrl"
+                                    },
+                                    {
+                                        "group": true,
+                                        "key": "x-ibm-finding.ioc_refs",
+                                        "object": "finding",
+                                        "references": [
+                                            "blobUrl"
+                                        ]
+                                    }
+                                ]
+                            },
+                            "blob-container": {
+                                "Name": {
+                                    "key": "x-azure-blob.blob_container",
+                                    "object": "blob_storage"
+                                }
+                            },
+                            "container": {
+                                "ContainerId": {
+                                    "key": "x-azure-container.container_id",
+                                    "object": "container"
+                                },
+                                "Image": {
+                                    "ImageId": {
+                                        "key": "x-azure-container.image_id",
+                                        "object": "container"
+                                    },
+                                    "Type": {
+                                        "key": "x-azure-container.image_type",
+                                        "object": "container"
+                                    }
+                                }
+                            },
+                            "dns": {
+                                "DomainName": {
+                                    "key": "domain-name.value",
+                                    "object": "domain_name"
+                                },
+                                "IpAdresses": {
+                                    "Address": [
+                                        {
+                                            "key": "ipv4-addr.value",
+                                            "object": "ipaddress1"
+                                        },
+                                        {
+                                            "key": "ipv6-addr.value",
+                                            "object": "ipaddress1"
+                                        }
+                                    ],
+                                    "groupIpReference": {
+                                        "group_ref": true,
+                                        "key": "domain-name.resolves_to_refs",
+                                        "object": "domain_name",
+                                        "references": [
+                                            "ipaddress1"
+                                        ]
+                                    },
+                                    "groupIpfindingReference": {
+                                        "group_ref": true,
+                                        "key": "x-ibm-finding.ioc_refs",
+                                        "object": "finding",
+                                        "references": [
+                                            "ipaddress1"
+                                        ]
+                                    }
+                                }
+                            },
+                            "file": {
+                                "Directory": [
+                                    {
+                                        "key": "directory.path",
+                                        "object": "dir_obj"
+                                    },
+                                    {
+                                        "key": "file.parent_directory_ref",
+                                        "object": "file_obj",
+                                        "references": "dir_obj"
+                                    }
+                                ],
+                                "FileHashes": {
+                                    "MD5": {
+                                        "key": "file.hashes.MD5",
+                                        "object": "file_obj"
+                                    },
+                                    "SHA1": {
+                                        "key": "file.hashes.SHA-1",
+                                        "object": "file_obj"
+                                    },
+                                    "SHA256": {
+                                        "key": "file.hashes.SHA-256",
+                                        "object": "file_obj"
+                                    }
+                                },
+                                "Name": [
+                                    {
+                                        "key": "file.name",
+                                        "object": "file_obj"
+                                    },
+                                    {
+                                        "key": "process.binary_ref",
+                                        "object": "process1",
+                                        "references": "file_obj"
+                                    },
+                                    {
+                                        "group": true,
+                                        "key": "x-ibm-finding.ioc_refs",
+                                        "object": "finding",
+                                        "references": [
+                                            "file_obj"
+                                        ]
+                                    }
+                                ]
+                            },
+                            "host": {
+                                "DnsDomain": {
+                                    "key": "x-oca-asset.x_dns_domain",
+                                    "object": "host"
+                                },
+                                "HostName": [
+                                    {
+                                        "key": "x-oca-asset.hostname",
+                                        "object": "host"
+                                    },
+                                    {
+                                        "key": "x-host-logon-session.host_ref",
+                                        "object": "logon_session",
+                                        "references": "host"
+                                    }
+                                ],
+                                "IsDomainJoined": {
+                                    "key": "x-oca-asset.x_is_domain_host",
+                                    "object": "host"
+                                },
+                                "NTDomain": {
+                                    "key": "x-oca-asset.x_nt_domain",
+                                    "object": "host"
+                                },
+                                "NetBiosName": {
+                                    "key": "x-oca-asset.x_netbios_name",
+                                    "object": "host"
+                                },
+                                "OMSAgentID": {
+                                    "key": "x-oca-asset.x_oms_agent_id",
+                                    "object": "host"
+                                },
+                                "OSFamily": [
+                                    {
+                                        "key": "software.name",
+                                        "object": "host_software"
+                                    },
+                                    {
+                                        "key": "x-oca-asset.os_ref",
+                                        "object": "host",
+                                        "references": "host_software"
+                                    },
+                                    {
+                                        "key": "x-ibm-finding.dst_os_ref",
+                                        "object": "finding",
+                                        "references": "host_software"
+                                    }
+                                ],
+                                "OSVersion": {
+                                    "key": "software.version",
+                                    "object": "host_software"
+                                }
+                            },
+                            "host-logon-session": {
+                                "EndTimeUtc": {
+                                    "key": "x-host-logon-session.end_time",
+                                    "object": "logon_session"
+                                },
+                                "SessionId": {
+                                    "key": "x-host-logon-session.session_id",
+                                    "object": "logon_session",
+                                    "transformer": "HexToInteger"
+                                },
+                                "StartTimeUtc": {
+                                    "key": "x-host-logon-session.start_time",
+                                    "object": "logon_session"
+                                }
+                            },
+                            "malware": {
+                                "Category": {
+                                    "key": "x-azure-malware.category",
+                                    "object": "malware"
+                                },
+                                "Files": {
+                                    "file": {
+                                        "Directory": [
+                                            {
+                                                "key": "directory.path",
+                                                "object": "dir_obj"
+                                            },
+                                            {
+                                                "key": "file.parent_directory_ref",
+                                                "object": "malware_file",
+                                                "references": "dir_obj"
+                                            }
+                                        ],
+                                        "FileHashes": {
+                                            "MD5": {
+                                                "key": "file.hashes.MD5",
+                                                "object": "malware_file"
+                                            },
+                                            "SHA1": {
+                                                "key": "file.hashes.SHA-1",
+                                                "object": "malware_file"
+                                            },
+                                            "SHA256": {
+                                                "key": "file.hashes.SHA-256",
+                                                "object": "malware_file"
+                                            }
+                                        },
+                                        "Name": {
+                                            "key": "file.name",
+                                            "object": "malware_file"
+                                        }
+                                    },
+                                    "groupMalwareReference": {
+                                        "group_ref": true,
+                                        "key": "x-azure-malware.file_refs",
+                                        "object": "malware",
+                                        "references": [
+                                            "malware_file"
+                                        ]
+                                    },
+                                    "groupfindingReference": {
+                                        "group": true,
+                                        "key": "x-ibm-finding.ioc_refs",
+                                        "object": "finding",
+                                        "references": [
+                                            "malware_file"
+                                        ]
+                                    }
+                                },
+                                "Name": {
+                                    "key": "x-azure-malware.name",
+                                    "object": "malware"
+                                }
+                            },
+                            "network-connection": {
+                                "DestinationPort": {
+                                    "key": "network-traffic.dst_port",
+                                    "object": "nt",
+                                    "transformer": "ToInteger"
+                                },
+                                "Protocol": {
+                                    "key": "network-traffic.protocols",
+                                    "object": "nt",
+                                    "transformer": "ToLowercaseArray"
+                                },
+                                "SourceAddress": {
+                                    "Address": [
+                                        {
+                                            "key": "ipv4-addr.value",
+                                            "object": "ipaddress"
+                                        },
+                                        {
+                                            "key": "ipv6-addr.value",
+                                            "object": "ipaddress"
+                                        },
+                                        {
+                                            "key": "network-traffic.src_ref",
+                                            "object": "nt",
+                                            "references": "ipaddress",
+                                            "unwrap": true
+                                        }
+                                    ],
+                                    "Location": {
+                                        "Carrier": {
+                                            "key": "x-geo-location.carrier",
+                                            "object": "location"
+                                        },
+                                        "City": {
+                                            "key": "x-geo-location.city",
+                                            "object": "location"
+                                        },
+                                        "CountryName": [
+                                            {
+                                                "key": "x-geo-location.country",
+                                                "object": "location"
+                                            },
+                                            {
+                                                "key": "ipv4-addr.x_location_ref",
+                                                "object": "ipaddress",
+                                                "references": "location"
+                                            },
+                                            {
+                                                "key": "ipv6-addr.x_location_ref",
+                                                "object": "ipaddress",
+                                                "references": "location"
+                                            }
+                                        ],
+                                        "Latitude": {
+                                            "key": "x-geo-location.latitude",
+                                            "object": "location"
+                                        },
+                                        "Longitude": {
+                                            "key": "x-geo-location.longitude",
+                                            "object": "location"
+                                        },
+                                        "Organization": {
+                                            "key": "x-geo-location.organization",
+                                            "object": "location"
+                                        }
+                                    }
+                                },
+                                "groupIPReference": {
+                                    "group_ref": true,
+                                    "key": "x-ibm-finding.ioc_refs",
+                                    "object": "finding",
+                                    "references": [
+                                        "ipaddress"
+                                    ]
+                                }
+                            },
+                            "process": {
+                                "CommandLine": {
+                                    "key": "process.command_line",
+                                    "object": "process1"
+                                },
+                                "CreationTimeUtc": {
+                                    "key": "process.created",
+                                    "object": "process1"
+                                },
+                                "ElevationToken": {
+                                    "key": "process.x_elevation_token",
+                                    "object": "process1"
+                                },
+                                "ImageFile": {
+                                    "Directory": [
+                                        {
+                                            "key": "directory.path",
+                                            "object": "dir_obj"
+                                        },
+                                        {
+                                            "key": "file.parent_directory_ref",
+                                            "object": "image_file_obj",
+                                            "references": "dir_obj"
+                                        }
+                                    ],
+                                    "FileHashes": {
+                                        "MD5": {
+                                            "key": "file.hashes.MD5",
+                                            "object": "image_file_obj"
+                                        },
+                                        "SHA1": {
+                                            "key": "file.hashes.SHA-1",
+                                            "object": "image_file_obj"
+                                        },
+                                        "SHA256": {
+                                            "key": "file.hashes.SHA-256",
+                                            "object": "image_file_obj"
+                                        }
+                                    },
+                                    "Name": [
+                                        {
+                                            "key": "file.name",
+                                            "object": "image_file_obj"
+                                        },
+                                        {
+                                            "key": "process.binary_ref",
+                                            "object": "process1",
+                                            "references": "image_file_obj"
+                                        },
+                                        {
+                                            "group": true,
+                                            "key": "x-ibm-finding.ioc_refs",
+                                            "object": "finding",
+                                            "references": [
+                                                "image_file_obj"
+                                            ]
+                                        }
+                                    ]
+                                },
+                                "ParentProcess": {
+                                    "CommandLine": {
+                                        "key": "process.command_line",
+                                        "object": "parent_process"
+                                    },
+                                    "CreationTimeUtc": {
+                                        "key": "process.created",
+                                        "object": "parent_process"
+                                    },
+                                    "ElevationToken": {
+                                        "key": "process.x_elevation_token",
+                                        "object": "parent_process"
+                                    },
+                                    "ImageFile": {
+                                        "Directory": [
+                                            {
+                                                "key": "directory.path",
+                                                "object": "dir_obj1"
+                                            },
+                                            {
+                                                "key": "file.parent_directory_ref",
+                                                "object": "image_file_obj1",
+                                                "references": "dir_obj1"
+                                            }
+                                        ],
+                                        "FileHashes": {
+                                            "MD5": {
+                                                "key": "file.hashes.MD5",
+                                                "object": "image_file_obj1"
+                                            },
+                                            "SHA1": {
+                                                "key": "file.hashes.SHA-1",
+                                                "object": "image_file_obj1"
+                                            },
+                                            "SHA256": {
+                                                "key": "file.hashes.SHA-256",
+                                                "object": "image_file_obj1"
+                                            }
+                                        },
+                                        "Name": [
+                                            {
+                                                "key": "file.name",
+                                                "object": "image_file_obj1"
+                                            },
+                                            {
+                                                "key": "process.binary_ref",
+                                                "object": "parent_process",
+                                                "references": "image_file_obj1"
+                                            },
+                                            {
+                                                "group": true,
+                                                "key": "x-ibm-finding.ioc_refs",
+                                                "object": "finding",
+                                                "references": [
+                                                    "image_file_obj1"
+                                                ]
+                                            }
+                                        ]
+                                    },
+                                    "ProcessId": [
+                                        {
+                                            "key": "process.pid",
+                                            "object": "parent_process",
+                                            "transformer": "HexToInteger"
+                                        },
+                                        {
+                                            "key": "process.parent_ref",
+                                            "object": "process1",
+                                            "references": "parent_process"
+                                        }
+                                    ]
+                                },
+                                "ProcessId": {
+                                    "key": "process.pid",
+                                    "object": "process1",
+                                    "transformer": "HexToInteger"
+                                }
+                            },
+                            "url": {
+                                "Url": [
+                                    {
+                                        "key": "url.value",
+                                        "object": "url"
+                                    },
+                                    {
+                                        "group": true,
+                                        "key": "x-ibm-finding.ioc_refs",
+                                        "object": "finding",
+                                        "references": [
+                                            "url"
+                                        ]
+                                    }
+                                ]
+                            }
                         },
                         "EventData": {
-                            "key": "x-azure-security-event.event_data",
-                            "object": "msevent"
+                            "key": "x-oca-event.dataset",
+                            "object": "event"
                         },
                         "EventID": {
                             "key": "x-oca-event.code",
                             "object": "event"
                         },
-                        "EventSourceName": {
-                            "key": "x-ibm-finding.name",
+                        "EventOriginId": {
+                            "key": "x-ibm-finding.alert_id",
                             "object": "finding"
                         },
-                        "EventTime": {
-                            "key": "x-ibm-finding.time_observed",
-                            "object": "finding"
-                        },
-                        "ExtentedProperties": {
-                            "key": "x-azure-security-alert.extented_properties",
-                            "object": "alert"
+                        "EventSourceName": {
+                            "key": "x-oca-event.provider",
+                            "object": "event"
                         },
-                        "FileHash": [
-                            {
-                                "key": "file.hashes",
-                                "object": "event"
-                            },
-                            {
-                                "key": "x-oca-event.file_ref.path",
-                                "object": "event"
+                        "ExtendedProperties": {
+                            "resourceType": {
+                                "key": "x-cloud-resource.resource_type",
+                                "object": "cloud_resource"
                             }
-                        ],
+                        },
                         "FilePath": [
                             {
                                 "key": "file.path",
                                 "object": "file"
                             },
                             {
-                                "key": "x-oca-event.file_ref.path",
-                                "object": "file"
+                                "key": "x-oca-event.file_ref",
+                                "object": "event",
+                                "references": "file"
+                            },
+                            {
+                                "key": "process.binary_ref",
+                                "object": "process",
+                                "references": "file"
+                            },
+                            {
+                                "key": "file.name",
+                                "object": "file",
+                                "transformer": "ToFileName"
+                            },
+                            {
+                                "group": true,
+                                "key": "x-ibm-finding.ioc_refs",
+                                "object": "finding",
+                                "references": [
+                                    "file"
+                                ]
                             }
                         ],
                         "FirstActivityTime": {
-                            "key": "x-ibm-finding.start",
-                            "object": "finding"
+                            "key": "x-incident-info.first_activity",
+                            "object": "incident"
                         },
                         "FirstModifiedTime": {
-                            "key": "x-ibm-finding.start",
-                            "object": "finding"
+                            "key": "x-incident-info.first_modified",
+                            "object": "incident"
+                        },
+                        "Fqbn": {
+                            "key": "file.x_fqbn",
+                            "object": "file"
                         },
                         "HomeDirectory": {
                             "key": "directory.path",
                             "object": "directory"
                         },
                         "HomePath": {
                             "key": "directory.path",
                             "object": "directory"
                         },
-                        "IncidentName": [
+                        "IncidentName": {
+                            "key": "x-ibm-finding.x_incident_name",
+                            "object": "finding"
+                        },
+                        "IncidentUrl": [
                             {
-                                "key": "x-ibm-finding.name",
-                                "object": "finding"
+                                "key": "url.value",
+                                "object": "url"
                             },
                             {
-                                "key": "x-azure-security-incident.incident_name",
-                                "object": "incident"
+                                "key": "x-incident-info.incident_url_ref",
+                                "object": "incident",
+                                "references": "url"
                             }
                         ],
-                        "IncidentUrl": [
+                        "IpAddress": [
                             {
-                                "key": "x-oca-event.url_ref",
-                                "object": "event"
+                                "key": "ipv4-addr.value",
+                                "object": "ipv4-addr"
                             },
                             {
-                                "key": "url.name",
-                                "object": "url"
-                            }
-                        ],
-                        "IpAddress": [
+                                "key": "ipv6-addr.value",
+                                "object": "ipv4-addr"
+                            },
                             {
                                 "key": "x-ibm-finding.src_ip_ref",
-                                "object": "finding"
+                                "object": "finding",
+                                "references": "ipv4-addr"
                             },
                             {
-                                "key": "ipv4-addr.value",
-                                "object": "ipv4-addr"
+                                "group": true,
+                                "key": "x-ibm-finding.ioc_refs",
+                                "object": "finding",
+                                "references": [
+                                    "ipv4-addr"
+                                ]
                             },
                             {
+                                "group": true,
                                 "key": "x-oca-event.ip_refs",
-                                "object": "event"
+                                "object": "event",
+                                "references": [
+                                    "ipv4-addr"
+                                ]
                             }
                         ],
                         "Labels": {
-                            "key": "x-azure-security-incident.labels",
+                            "key": "x-incident-info.labels",
                             "object": "incident"
                         },
                         "LastActivityTime": {
-                            "key": "x-ibm-finding.end",
-                            "object": "finding"
+                            "key": "x-incident-info.last_active",
+                            "object": "incident"
                         },
                         "LastModifiedTime": {
                             "key": "x-ibm-finding.end",
                             "object": "finding"
                         },
+                        "LogonGuid": {
+                            "key": "x-logon-info.guid",
+                            "object": "logon_info"
+                        },
                         "LogonProcessName": {
-                            "key": "process.name",
+                            "key": "x-logon-info.logon_process",
+                            "object": "logon_info"
+                        },
+                        "LogonType": {
+                            "key": "x-logon-info.logon_type",
+                            "object": "logon_info"
+                        },
+                        "LogonTypeName": {
+                            "key": "x-logon-info.logon_type_name",
+                            "object": "logon_info"
+                        },
+                        "MD5": {
+                            "key": "file.hashes.MD5",
+                            "object": "file"
+                        },
+                        "MandatoryLabel": {
+                            "key": "process.x_mandatory_label",
                             "object": "process"
                         },
                         "MemberName": {
-                            "key": "x-azure-security-event.member_name",
-                            "object": "msevent"
+                            "key": "x-oca-event.x_member_name",
+                            "object": "event"
                         },
                         "ModifiedBy": {
-                            "key": "x-azure-security-incident.modified_by",
-                            "object": "incident"
+                            "key": "x-ibm-finding.x_modified_by",
+                            "object": "finding"
                         },
+                        "NewProcessId": [
+                            {
+                                "key": "process.pid",
+                                "object": "process",
+                                "transformer": "HexToInteger"
+                            },
+                            {
+                                "key": "x-oca-event.process_ref",
+                                "object": "event",
+                                "references": "process"
+                            }
+                        ],
+                        "NewProcessName": [
+                            {
+                                "key": "directory.path",
+                                "object": "file_dir",
+                                "transformer": "ToDirectoryPath"
+                            },
+                            {
+                                "key": "file.name",
+                                "object": "file",
+                                "transformer": "ToFileName"
+                            },
+                            {
+                                "key": "file.parent_directory_ref",
+                                "object": "file",
+                                "references": "file_dir"
+                            },
+                            {
+                                "key": "process.binary_ref",
+                                "object": "process",
+                                "references": "file"
+                            }
+                        ],
                         "Owner": {
-                            "key": "x-azure-security-incident.owner",
-                            "object": "incident"
+                            "assignedTo": {
+                                "key": "email-addr.display_name",
+                                "object": "owner"
+                            },
+                            "email": {
+                                "key": "email-addr.value",
+                                "object": "owner"
+                            },
+                            "userPrincipalName": [
+                                {
+                                    "key": "email-addr.value",
+                                    "object": "owner"
+                                },
+                                {
+                                    "key": "x-ibm-finding.x_owner_ref",
+                                    "object": "finding",
+                                    "references": "owner"
+                                }
+                            ]
                         },
                         "ParentProcessName": [
                             {
+                                "key": "directory.path",
+                                "object": "file_dir1",
+                                "transformer": "ToDirectoryPath"
+                            },
+                            {
+                                "key": "file.name",
+                                "object": "file1",
+                                "transformer": "ToFileName"
+                            },
+                            {
+                                "key": "file.parent_directory_ref",
+                                "object": "file1",
+                                "references": "file_dir1"
+                            },
+                            {
+                                "key": "process.binary_ref",
+                                "object": "parent1",
+                                "references": "file1"
+                            },
+                            {
                                 "key": "process.parent_ref",
-                                "object": "process"
+                                "object": "process",
+                                "references": "parent1"
                             },
                             {
                                 "key": "x-oca-event.parent_process_ref",
-                                "object": "event"
+                                "object": "event",
+                                "references": "parent1"
                             }
                         ],
                         "PreviousTime": {
                             "key": "x-ibm-finding.start",
                             "object": "finding"
                         },
                         "ProcessId": {
                             "key": "process.pid",
-                            "object": "process"
+                            "object": "parent1",
+                            "transformer": "HexToInteger"
                         },
                         "ProcessName": [
                             {
-                                "key": "process.name",
-                                "object": "process"
+                                "key": "directory.path",
+                                "object": "file_dir1",
+                                "transformer": "ToDirectoryPath"
                             },
                             {
-                                "key": "x-oca-event.process_ref",
-                                "object": "event"
+                                "key": "file.name",
+                                "object": "file1",
+                                "transformer": "ToFileName"
+                            },
+                            {
+                                "key": "file.parent_directory_ref",
+                                "object": "file1",
+                                "references": "file_dir1"
+                            },
+                            {
+                                "key": "process.binary_ref",
+                                "object": "parent1",
+                                "references": "file1"
                             }
                         ],
                         "ProcessingEndTime": {
-                            "key": "x-ibm-finding.end",
+                            "key": "x-ibm-finding.x_processing_endtime",
                             "object": "finding"
                         },
-                        "ProductName": {
-                            "key": "x-azure-security-alert.product_name",
-                            "object": "alert"
+                        "ProductComponentName": {
+                            "key": "software.x_product_component_name",
+                            "object": "product_info"
+                        },
+                        "ProductName": [
+                            {
+                                "key": "software.name",
+                                "object": "product_info"
+                            },
+                            {
+                                "key": "x-ibm-finding.dst_application_ref",
+                                "object": "finding",
+                                "references": "product_info"
+                            }
+                        ],
+                        "ProviderIncidentId": {
+                            "key": "x-ibm-finding.x_provider_incident_id",
+                            "object": "finding"
                         },
                         "ProviderName": {
-                            "key": "x-oca-event.provider",
-                            "object": "event"
+                            "key": "software.x_provider_name",
+                            "object": "product_info"
+                        },
+                        "ProviderNameIncident": {
+                            "key": "x-ibm-finding.x_provider_name",
+                            "object": "finding"
                         },
                         "QuarantineHelpURL": [
                             {
-                                "key": "x-oca-event.url_ref",
-                                "object": "event"
+                                "key": "url.value",
+                                "object": "help_url"
                             },
                             {
-                                "key": "url.name",
-                                "object": "url"
+                                "key": "x-oca-event.url_ref",
+                                "object": "event",
+                                "references": "help_url"
                             }
                         ],
+                        "RelatedAnalyticRuleIds": {
+                            "key": "x-ibm-finding.rule_names",
+                            "object": "finding"
+                        },
+                        "RemediationSteps": {
+                            "key": "x-ibm-finding.x_remediationsteps",
+                            "object": "finding"
+                        },
                         "Requester": {
-                            "key": "x-azure-security-event.requester",
-                            "object": "msevent"
+                            "key": "x-oca-event.x_requester",
+                            "object": "event"
+                        },
+                        "ResourceId": {
+                            "key": "x-cloud-resource.resource_id",
+                            "object": "cloud_resource"
+                        },
+                        "SHA1": {
+                            "key": "file.hashes.SHA-1",
+                            "object": "file"
+                        },
+                        "SHA256": {
+                            "key": "file.hashes.SHA-256",
+                            "object": "file"
                         },
                         "ServiceFileName": {
-                            "key": "x-oca-event.file_ref.service",
+                            "key": "x-oca-event.x_service_file",
                             "object": "event"
                         },
                         "ServiceName": {
-                            "key": "x-azure-security-event.service_name",
-                            "object": "msevent"
+                            "key": "x-oca-event.x_service_name",
+                            "object": "event"
                         },
                         "Severity": {
-                            "key": "x-azure-security-incident.severity",
-                            "object": "incident"
+                            "key": "x-ibm-finding.severity",
+                            "object": "finding",
+                            "transformer": "ConvertSeverityToScore"
                         },
-                        "SourceSystem": {
-                            "key": "x-azure-security-event.source",
-                            "object": "msevent"
+                        "SourceComputerId": {
+                            "key": "x-oca-asset.device_id",
+                            "object": "asset"
                         },
                         "StartTime": {
                             "key": "x-ibm-finding.start",
                             "object": "finding"
                         },
                         "Status": {
-                            "key": "x-azure-security-alert.status",
-                            "object": "alert"
+                            "key": "x-ibm-finding.x_status",
+                            "object": "finding"
+                        },
+                        "SubjectAccount": {
+                            "key": "user-account.account_login",
+                            "object": "subject"
+                        },
+                        "SubjectDomainName": {
+                            "key": "user-account.x_domain_name",
+                            "object": "subject"
+                        },
+                        "SubjectLogonId": {
+                            "key": "user-account.x_login_id",
+                            "object": "subject",
+                            "transformer": "HexToInteger"
+                        },
+                        "SubjectUserName": [
+                            {
+                                "key": "user-account.user_id",
+                                "object": "subject"
+                            },
+                            {
+                                "key": "user-account.display_name",
+                                "object": "subject"
+                            },
+                            {
+                                "key": "x-ibm-finding.dst_application_user_ref",
+                                "object": "finding",
+                                "references": "subject"
+                            }
+                        ],
+                        "SubjectUserSid": {
+                            "key": "user-account.x_user_sid",
+                            "object": "subject"
                         },
                         "SystemAlertId": {
-                            "key": "x-azure-security-alert.cloudAppStates.system_alertid",
-                            "object": "alert"
+                            "key": "x-ibm-finding.x_system_alert_id",
+                            "object": "finding"
                         },
-                        "TargetDomainName": {
-                            "key": "domain-name.value",
-                            "object": "domain-name"
+                        "Tactics": {
+                            "key": "x-ibm-ttp-tagging.extensions.mitre-attack-ext.tactic_name",
+                            "object": "ttp_finding"
                         },
-                        "TargetUserName": {
+                        "TargetAccount": {
                             "key": "user-account.account_login",
-                            "object": "user-account"
+                            "object": "target-account"
+                        },
+                        "TargetDomainName": {
+                            "key": "user-account.x_domain_name",
+                            "object": "target-account"
+                        },
+                        "TargetLogonId": {
+                            "key": "user-account.x_login_id",
+                            "object": "target-account",
+                            "transformer": "HexToInteger"
+                        },
+                        "TargetServerName": {
+                            "key": "x-ibm-finding.dst_device",
+                            "object": "finding"
+                        },
+                        "TargetSid": {
+                            "key": "x-oca-event.x_modified_account_sid",
+                            "object": "event"
+                        },
+                        "TargetUserName": [
+                            {
+                                "key": "user-account.user_id",
+                                "object": "target-account"
+                            },
+                            {
+                                "key": "user-account.display_name",
+                                "object": "target-account"
+                            },
+                            {
+                                "key": "x-ibm-finding.src_application_user_ref",
+                                "object": "finding",
+                                "references": "target-account"
+                            },
+                            {
+                                "key": "x-oca-event.user_ref",
+                                "object": "event",
+                                "references": "target-account"
+                            }
+                        ],
+                        "TargetUserSid": {
+                            "key": "user-account.x_user_sid",
+                            "object": "target-account"
                         },
                         "Task": {
-                            "key": "x-azure-security-event.task",
-                            "object": "msevent"
+                            "key": "x-oca-event.x_task",
+                            "object": "event"
+                        },
+                        "Tasks": {
+                            "key": "x-incident-info.tasks",
+                            "object": "incident"
+                        },
+                        "Techniques": {
+                            "key": "x-ibm-ttp-tagging.extensions.mitre-attack-ext.technique_name",
+                            "object": "ttp_finding"
                         },
                         "TenantId": {
-                            "key": "x-azure-security-alert.tenant_id",
-                            "object": "alert"
+                            "key": "x-cloud-provider.tenant_id",
+                            "object": "cloud_info"
+                        },
+                        "TimeCollected": [
+                            {
+                                "key": "x-oca-event.created",
+                                "object": "event",
+                                "transformer": "TimestampConversion"
+                            },
+                            {
+                                "key": "x-oca-event.modified",
+                                "object": "event",
+                                "transformer": "TimestampConversion"
+                            }
+                        ],
+                        "TimeGenerated": {
+                            "key": "x-ibm-finding.time_observed",
+                            "object": "finding"
                         },
-                        "TimeGenerated": [
+                        "Title": [
                             {
-                                "key": "x-ibm-finding.start",
+                                "key": "x-ibm-finding.name",
                                 "object": "finding"
                             },
                             {
-                                "key": "x-oca-event.created",
-                                "object": "event"
+                                "key": "x-ibm-ttp-tagging.name",
+                                "object": "ttp_finding"
                             },
                             {
-                                "key": "x-ibm-finding.time_observed",
-                                "object": "finding"
+                                "group": true,
+                                "key": "x-ibm-finding.ttp_tagging_refs",
+                                "object": "finding",
+                                "references": [
+                                    "ttp_finding"
+                                ]
                             }
                         ],
-                        "Title": {
-                            "key": "x-azure-security-event.title",
-                            "object": "msevent"
-                        },
-                        "UserParameter": {
-                            "key": "x-azure-security-event.user_parameter",
-                            "object": "msevent"
+                        "TokenElevationType": {
+                            "key": "process.x_token_elevation_type",
+                            "object": "process"
+                        },
+                        "Type": {
+                            "key": "x-ibm-finding.finding_type",
+                            "object": "finding",
+                            "transformer": "ConvertToFindingType"
+                        },
+                        "UserParameters": {
+                            "key": "x-oca-event.x_user_parameter",
+                            "object": "event"
                         },
                         "VendorName": {
-                            "key": "x-azure-security-alert.vendor_name",
-                            "object": "alert"
+                            "key": "software.vendor",
+                            "object": "product_info"
                         },
-                        "WorkspaceResourceGroup": {
-                            "key": "x-azure-security-alert.workspace_resource_group",
-                            "object": "alert"
-                        },
-                        "WorkspaceSubscriptionId": {
-                            "key": "x-azure-security-alert.subscription_id",
-                            "object": "alert"
+                        "VendorOriginalId": {
+                            "key": "x-ibm-finding.alert_id",
+                            "object": "finding"
                         },
-                        "_ResourceId": {
-                            "key": "x-azure-security-alert.resourceId",
-                            "object": "alert"
+                        "WorkstationName": {
+                            "key": "x-ibm-finding.dst_device",
+                            "object": "finding"
                         },
-                        "eventId": {
-                            "key": "x-azure-security-event.event_id",
-                            "object": "msevent"
+                        "_ResourceId": {
+                            "key": "x-cloud-resource.resource_id",
+                            "object": "cloud_resource"
                         }
                     }
                 },
                 "optional": true,
                 "previous": "connection.mapping",
                 "type": "json"
             },
```

## stix_shifter_modules/azure_log_analytics/configuration/lang_en.json

### Pretty-printed

 * *Similarity: 0.9910714285714286%*

 * *Differences: {"'connection'": "{'selfSignedCert': {'label': 'Microsoft Azure certificate', 'description': 'Use "*

 * *                 "SSL certificate for Microsoft Azure.'}}"}*

```diff
@@ -59,16 +59,16 @@
             }
         },
         "port": {
             "description": "Set the port number that is associated with the Host name or IP",
             "label": "Host port"
         },
         "selfSignedCert": {
-            "description": "Use SSL certificate for Microsoft Azure Sentinel.",
-            "label": "Microsoft Azure Sentinel certificate"
+            "description": "Use SSL certificate for Microsoft Azure.",
+            "label": "Microsoft Azure certificate"
         },
         "type": {
             "description": "Data source type"
         },
         "workpaceId": {
             "description": "ID of the Azure Log Analytics workspace",
             "label": "Log Analytics workspace ID"
```

## stix_shifter_modules/azure_log_analytics/stix_translation/json_to_stix_translator.py

```diff
@@ -118,22 +118,22 @@
                 if not match(str(stix_value)):
                     return False
             return True
         except Exception as e:
             self.logger.debug("Failed to validate STIX property '{}' with value '{}'. Exception: {}".format(observable_key, stix_value, e))
             return False
 
-    def _compose_value_object(self, value, key_list, observable_key=None, object_tag_ref_map=None, transformer=None, references=None, unwrap=False):
+    def _compose_value_object(self, value, key_list, observable_key=None, object_tag_ref_map=None, transformer=None, references=None, unwrap=False, is_group_ref=False):
         """
         Converts the value of the data to STIX valid value
         """
         try:
             return_value = {}
             for key in key_list:
-                return_value[key] = self._compose_value_object(value, key_list[1:], observable_key=observable_key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
+                return_value[key] = self._compose_value_object(value, key_list[1:], observable_key=observable_key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap, is_group_ref=is_group_ref)
                 break
             else:
                 if transformer:
                     try: 
                         value = transformer.transform(value)
                         if value is None:
                             return None
@@ -141,21 +141,39 @@
                         return None
                 
                 if references:
                     if isinstance(references, list):
                         return_value = []
                         for ref in references:
                             if not isinstance(value, list):
-                                value = [value]
-                            for i, _ in enumerate(value):
-                                parent_key_ind = self._get_tag_ind(ref, object_tag_ref_map, create_on_absence=False, unwrap=i)
+                                # Fetch the index of reference object name which has a single value.
+                                parent_key_ind = self._get_tag_ind(ref, object_tag_ref_map, create_on_absence=False)
                                 if parent_key_ind:
                                     return_value.append(parent_key_ind)
+                            else:
+                                for i, _ in enumerate(value):
+                                    parent_key_ind = self._get_tag_ind(ref, object_tag_ref_map, create_on_absence=False, unwrap=str(i))
+                                    if parent_key_ind:
+                                        return_value.append(parent_key_ind)
+                                    # Iterate through the object_tag_ref_map to fetch the index, for grouping
+                                    # reference objects of nested type through group_ref.
+                                    elif is_group_ref:
+                                        list_parent_ind = ref + '_' + str(i)
+                                        for key, val in object_tag_ref_map['tags'].items():
+                                            if key.startswith(list_parent_ind):
+                                                return_value.append(
+                                                    self._get_tag_ind(key, object_tag_ref_map, create_on_absence=False))
+
                     else:
-                        return_value = self._get_tag_ind(references, object_tag_ref_map, create_on_absence=False)
+                        # Fetch first object (index 0) for single reference when the value is of type list .
+                        if isinstance(value, list):
+                            return_value = self._get_tag_ind(references, object_tag_ref_map, create_on_absence=False,
+                                                             unwrap='0')
+                        else:
+                            return_value = self._get_tag_ind(references, object_tag_ref_map, create_on_absence=False)
                         # if the property has unwrap true and is not a list, convert to list
                         if unwrap is True and not isinstance(return_value, list):
                             return_value = [return_value]
 
                     if not return_value:
                         return None
                 else:
@@ -247,28 +265,38 @@
                 if isinstance(to_stix_config_prop, dict) and to_stix_config_prop.get('key') is not None and not isinstance(to_stix_config_prop.get('key'), dict):
                     # data variable is the final value, process in bulk
                     self._handle_value(data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind)
 
                 elif isinstance(data, list):
                     for i, d in enumerate(data):
                         if isinstance(d, list) or isinstance(d, dict):
-                            self._handle_properties(to_stix_config_prop, d, objects, object_tag_ref_map, data, ds_sub_key, i)
+                            # Added parent key indexes to inner objects in order to handle nested lists of
+                            # dictionaries and lists. For Example, if a list of IP address is present inside
+                            # a list of network objects, then without adding this code, only the IP address information
+                            # in the first network object will be created and the rest are not created.
+                            if object_key_ind:
+                                i = str(object_key_ind) + '_' + str(i)
+                            # Inorder to include 0th index, the integer field 'i' is converted to string.
+                            self._handle_properties(to_stix_config_prop, d, objects, object_tag_ref_map, data, ds_sub_key, str(i))
                         else:
                             # data variable is the final value, process in bulk
                             self._handle_value(data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind)
                             break
                     # group the references of list of dictionary field
                     if isinstance(to_stix_config_prop, dict):
                         group_refs = [key for key, value in to_stix_config_prop.items() if
                                       isinstance(value, dict) and value.get('group_ref') and value.get(
                                           'references')]
                         for group_ref in group_refs:
+                            # Added a new boolean (True) parameter (is_group_ref) to indicate grouping of references
+                            # through group_ref key in mapping
                             self._handle_value(data, to_stix_config_prop, ds_sub_key,
                                                to_stix_config_prop[group_ref],
-                                               objects, object_tag_ref_map, object_key_ind)
+                                               objects, object_tag_ref_map, object_key_ind, True)
+
                 elif isinstance(data, dict):
                     for k in data:
                         cust_prop = None
                         if k in to_stix_config_prop:
                             cust_prop = to_stix_config_prop[k]
                         elif self.options.get('unmapped_fallback') and k not in object_tag_ref_map['ds_key_cybox']:
                             cust_prop = {"key": "x-" + self.data_source.replace("_", "-") + "." + k, "object": "cust_object"}
@@ -277,15 +305,15 @@
                             self._handle_properties(cust_prop, data[k], objects, object_tag_ref_map, data, k, object_key_ind)
                 else:
                     self._handle_value(data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind)
         except Exception as e:
             raise Exception("Error in json_to_stix_translator._handle_properties: %s" % e)
 
 
-    def _handle_value(self, data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind=None):
+    def _handle_value(self, data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind=None, is_group_ref=False):
         """
         Receives the raw value of a data property, converts to a STIX valid value and adds to the cached observable `objects` dictionary
         """
         try: 
             if isinstance(to_stix_config_prop, dict):
                 props = [to_stix_config_prop]
             else:
@@ -294,14 +322,29 @@
             for prop in props:
                 key = prop.get('key', None)
                 if key is None:
                     continue
 
                 transformer = self.transformers[prop['transformer']] if 'transformer' in prop else None
                 references = references = prop['references'] if 'references' in prop else None
+
+                # This check avoid using duplicate reference in the multiple objects of the same type.
+                # For example: If there are multiple source ipv4-addr and network-traffic objects then
+                # without this reference check the first source ipv4-addr object will be referenced to all network-traffic objects.
+                if references:
+                    if isinstance(references, str):
+                        if object_key_ind:
+                            references = references + '_' + str(object_key_ind)
+                        elif not isinstance(data, list):
+                            references = references + '_' + '0'
+                    elif isinstance(references, list):
+                        if object_key_ind:
+                            references = [ref + '_' + str(object_key_ind) for ref in references]
+                        elif not isinstance(data, list):
+                            references = [ref + '_' + '0' for ref in references]
                 # unwrap array of stix values to separate stix objects
                 unwrap = True if 'unwrap' in prop and isinstance(data, list) else False
                 if "." in key:
                     cybox = True
                 else:
                     cybox = False
                 
@@ -334,33 +377,44 @@
                     if False is cybox and not substitute_key:
                         value = self._compose_value_object(data, config_keys[2:], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
                         self._add_property(type_name, property_key, type_name, value, object_tag_ref_map['out_cybox'], cybox=False)
                         continue
 
                     if object_key_ind:
                         parent_key = parent_key + '_' + str(object_key_ind)
+                    # Adding _0 as a tag index for the following
+                    # 1. For object name of non-list type data or unwrapped data
+                    # 2. For the object name containing references to list type of data.
+                    # For Example, when a single IP address value and references to the list of domain values, needs
+                    # to be added to a single custom object, the 0th index is added to the custom object to have ip
+                    # address and references to list of domains under the same custom object.
+                    elif (isinstance(data, list) and not unwrap and not references) \
+                            or (isinstance(data, list) and references) or (not isinstance(data, list)):
+                        parent_key = parent_key + '_' + '0'
 
                     # use the hard-coded value in the mapping
                     if 'value' in prop:
                         value = prop['value']
                     else:
                         if substitute_key and parent_data:
                             data = parent_data.get(substitute_key)
 
                             if False is cybox:
                                 object_tag_ref_map['ds_key_cybox'][substitute_key] = True
                         
-                        value = self._compose_value_object(data, config_keys[2:], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
+                        value = self._compose_value_object(data, config_keys[2:], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap, is_group_ref=is_group_ref)
 
-                    if value is None or value == '':
+                    # Remove the values which has empty list brackets.
+                    if value is None or value in ('', []):
                         continue
 
                     if not references and unwrap and isinstance(value, list):
                         for i, val_el in enumerate(value):
-                            parent_key_ind = self._get_tag_ind(parent_key, object_tag_ref_map, create_on_absence=True, unwrap=i, property_key=property_key)
+                            # Inorder to include 0th index, the integer field 'i' is converted to string.
+                            parent_key_ind = self._get_tag_ind(parent_key, object_tag_ref_map, create_on_absence=True, unwrap=str(i), property_key=property_key)
                             self._add_property(type_name, property_key, parent_key_ind, val_el, objects, group=group)
                     else:
                         parent_key_ind = self._get_tag_ind(parent_key, object_tag_ref_map, create_on_absence=True, property_key=property_key)
                         self._add_property(type_name, property_key, parent_key_ind, value, objects, group=group)
         except Exception as e:
             raise Exception("Error in json_to_stix_translator._handle_value: %s : %s" % (e, e.__traceback__.tb_lineno))
```

## stix_shifter_modules/azure_log_analytics/stix_translation/query_constructor.py

```diff
@@ -1,32 +1,32 @@
 from stix_shifter_utils.stix_translation.src.patterns.pattern_objects import ObservationExpression, \
-    ComparisonExpression, ComparisonExpressionOperators, ComparisonComparators, Pattern, CombinedComparisonExpression, \
+    ComparisonExpression, ComparisonComparators, Pattern, CombinedComparisonExpression, \
     CombinedObservationExpression
-from stix_shifter_utils.stix_translation.src.patterns.errors import SearchFeatureNotSupportedError
 from datetime import datetime, timedelta
 import re
+from os import path
+import logging
+import json
+from stix_shifter_modules.azure_log_analytics.stix_translation.transformers import HexToInteger
+
 
 START_STOP_PATTERN = r"(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d+)?Z)"
+CONFIG_MAP_PATH = "json/config_map.json"
+logger = logging.getLogger(__name__)
 
 
-class QueryStringPatternTranslator:
-    COUNTER = 0
+class FileNotFoundException(Exception):
+    pass
 
-    # comparator lookup for implementing negation operator
-    negated_comparator_lookup = {
-        ComparisonComparators.GreaterThan: "le",
-        ComparisonComparators.GreaterThanOrEqual: "lt",
-        ComparisonComparators.LessThan: "ge",
-        ComparisonComparators.LessThanOrEqual: "gt",
-        ComparisonComparators.Equal: "ne",
-        ComparisonComparators.NotEqual: "eq",
-        ComparisonComparators.In: "ne"
-    }
+
+class QueryStringPatternTranslator:
 
     def __init__(self, pattern: Pattern, data_model_mapper, time_range):
+        logger.info("Azure Log Analytics")
+        self.config_map = self.load_json(CONFIG_MAP_PATH)
         self.dmm = data_model_mapper
         self.comparator_lookup = self.dmm.map_comparator()
         self._time_range = time_range
         self.pattern = pattern
 
         # List of queries for each observation
         self.final_query_list = []
@@ -39,186 +39,289 @@
         Formatting list of values in the event of IN operation
         :param value: str
         :return: list
         """
         value_list = value.values
         format_list = []
         for item in value_list:
-            format_list.append('\'{}\''.format(item))
+            format_list.append(f'\'{QueryStringPatternTranslator._escape_value(item)}\'')
         return format_list
 
     @staticmethod
     def _format_match(value) -> str:
         """
          Formatting value in the event of MATCHES operation
          encapsulating the value inside regex keyword
          :param value: str
          :return: str
          """
-        return '\'{}\''.format(value)
+        if not re.search(r'[()}\]\[{*^$+?|]', value):
+            value = value.replace('\\', '\\\\')
+        return f"'{value}'"
 
     @staticmethod
     def _format_equality(value) -> str:
         """
           Formatting value in the event of equality operation
           :param value: str
           :return: str
           """
-        return '\'{}\''.format(value)
+        return f'\'{value}\''
 
     @staticmethod
     def _format_like(value) -> str:
         """
         Formatting value in the event of LIKE operation
         :param value: str
         :return: str
         """
-        return '\'{}\''.format(value)
+        return f'\'{value}\''
 
     @staticmethod
     def _escape_value(value) -> str:
         """
         Formats and replaces backslashes and single quoted parenthesis
         :param value: str
         :return: str
         """
         if isinstance(value, str):
-            return '{}'.format(value.replace('\\', '\\\\').replace('\"', '\\"').replace('(', '\\(').replace(')', '\\)'))
-        else:
+            return '{}'.format(value.replace('\\', '\\\\').replace('\"', '\\"'))
+        return value
+
+    @staticmethod
+    def load_json(rel_path_of_file):
+        """ Consumes a json file and returns a dictionary
+        :param rel_path_of_file: str
+        :return: dict """
+        _json_path = path.dirname(path.abspath(__file__)) + "/" + rel_path_of_file
+        try:
+            if path.exists(_json_path):
+                with open(_json_path, encoding='utf-8') as f_obj:
+                    config = json.load(f_obj)
+                    config = json.dumps(config).replace('Entities.', 'parsed_entities.')
+                    return json.loads(config)
+            raise FileNotFoundException
+        except FileNotFoundException as e:
+            raise FileNotFoundError(f'{rel_path_of_file} not found') from e
+
+    @staticmethod
+    def _negate_comparison(comparison_string, mapped_fields_array, comparator):
+        """ Add negate operator in comparison string
+        :param comparison_string: str
+        :param mapped_fields_array: list
+        :param comparator: str
+        :return: str """
+        not_null_expression = ""
+
+        if comparator != ComparisonComparators.NotEqual:
+            comparison_string = f"not ({comparison_string})"
+
+        for index, field in enumerate(mapped_fields_array):
+            if 'Entities' in field or 'ExtendedProperties' in field:
+                field = field.replace('Entities', 'parsed_entities').replace('ExtendedProperties', 'parsed_properties')
+                if index == 0:
+                    logical_operator = ""
+                else:
+                    logical_operator = " and "
+                not_null_expression += logical_operator + f"notnull({field})"
+
+        if not_null_expression:
+            comparison_string = f"{not_null_expression} and {comparison_string}"
+
+        return comparison_string
+
+    @staticmethod
+    def _format_file_hash(stix_field, comparison_string):
+        """ Formatting the file hash
+        :param stix_field, comparison_string: str
+        :return comparison_string: str """
+        file_hash = stix_field.replace("hashes.", "").replace("'", "").replace("-", "")
+        file_statement = f"parsed_entities.Algorithm == '{file_hash}' and "
+        comparison_string = f"({file_statement}{comparison_string})"
+        return comparison_string
+
+    def _convert_enum_values(self, value, mapped_field, comparator):
+        """ Convert enum values
+          :param value: str
+          :param mapped_field: str
+          :param comparator: str
+          :return: str """
+        if comparator not in [ComparisonComparators.Equal, ComparisonComparators.NotEqual, ComparisonComparators.In]:
+            raise NotImplementedError(f'{comparator.name} operator is not supported for Enum type input. Possible '
+                                      f'supported operator are [ =, !=, IN, NOT IN ]')
+
+        if "Severity" in mapped_field:
+            mapped_field = "Severity"
+
+        conversion_json = self.config_map['enum_supported_values'].get(mapped_field, {})
+
+        if isinstance(value, list):
+            converted_list = []
+            for row in value:
+                row = row.replace("\'", "")
+                if row in conversion_json:
+                    conversion_value = conversion_json[row]
+                    converted_list.append(f"\'{conversion_value}\'")
+                else:
+                    raise NotImplementedError(f'Unsupported ENUM values provided. Possible supported'
+                                              f' enum values are {list(conversion_json.keys())}')
+            return converted_list
+
+        elif value.replace("\'", "") in conversion_json:
+            conversion_value = conversion_json[value.replace("\'", "")]
+            value = f'\'{conversion_value}\''
             return value
 
+        raise NotImplementedError(f'Unsupported ENUM values provided. Possible supported'
+                                  f' enum values are {list(conversion_json.keys())}')
+
     @staticmethod
-    def _format_value_without_quotes(value):
-        """
-        Formats and replaces values with escape character into value without quotes
-        :param value: str
-        :return: str
-        """
-        values = []
+    def _convert_score_values(value, comparator):
+        """ Convert 0-100 into 0-1
+          :param value: str or list
+          :param comparator: str
+          :return: str or list"""
         if isinstance(value, list):
-            for each in value:
-                values.append('{}'.format(each.replace('\'', '')))
-            value = values
+            for index, row in enumerate(value):
+                if row.replace("\'", "").isdigit():
+                    conversion_value = float(row.replace("\'", "")) / 10
+                    value[index] = f'\'{conversion_value}\''
         else:
-            value = value.replace('\'', '')
+            if str(value).replace("\'", "").isdigit():
+                conversion_value = float(str(value).replace("\'", "")) / 10
+                if comparator in [ComparisonComparators.Like, ComparisonComparators.Matches]:
+                    value = f'\'{conversion_value}\''
+                else:
+                    value = conversion_value
         return value
 
     @staticmethod
-    def _format_value_to_lower_case(value):
-        """
-        Formats and replaces values with escape character into value without quotes
-        :param value: str
-        :return: str
-        """
-        values = []
+    def _check_int_values(value):
+        """ check the input value contains valid integer
+        :param value
+        :return formatted value """
         if isinstance(value, list):
-            for each in value:
-                values.append('{}'.format(each).lower())
-            value = values
+            for index, row in enumerate(value):
+                if row.replace("\'", "").isdigit():
+                    conversion_value = int(str(row).replace("\'", ""))
+                    value[index] = f'\'{conversion_value}\''
+                else:
+                    raise NotImplementedError(f'string type input - {row} is not supported for'
+                                              f' integer type fields')
         else:
-            value = value.lower()
+            if str(value).replace("\'", "").isdigit():
+                conversion_value = int(str(value).replace("\'", ""))
+                value = conversion_value
+            else:
+                raise NotImplementedError(f'string type input - {value} is not supported for '
+                                          f'integer type fields')
         return value
 
-    @staticmethod
-    def _parse_mapped_fields(self, expression, value, comparator, stix_field, mapped_fields_array, counter):
+    def _parse_mapped_fields(self, expression, value, comparator, mapped_fields_array):
         """
-        Mapping the stix object property with their corresponding property in sentinel odata query
+        Mapping the stix object property with their corresponding property in azure log analytics data query
         from_stix_map.json will be used for mapping
         :param expression: expression object, ANTLR parsed expression object
         :param value: str
         :param comparator: str
         :param mapped_fields_array: list, Mapping available in from_stix_map.json
         :return: str, whose part of the odata query for each value
         """
         comparison_string = ""
         values = value
         mapped_fields_count = len(mapped_fields_array)
 
-        def format_comparision_string(comparison_string, mapped_field, lambda_func):
-            # check for mapped_field that has '.' character -> example [fileStates.name,processes.name]
-            if '.' in mapped_field:
-                collection_attribute_array = mapped_field.split('.')
-                collection_name = collection_attribute_array[0]
-                attribute_nested_level = '/'.join(collection_attribute_array[1:])
-
-                attribute_expression = '({fn}/'.format(fn=lambda_func) + attribute_nested_level + ')'
-                # ip address in data source is like "sourceAddress": "IP: 92.63.194.101 [2]\r"
-                # to get ip address from data source using contains keyword ODATA query
-                if comparator == 'contains':
-                    comparison_string += " and {collection_name}/any({fn}:{comparator}({attribute_expression}, " \
-                                            "{value})))".format(collection_name=collection_name, fn=lambda_func,
-                                                                attribute_expression=attribute_expression,
-                                                                comparator=comparator, value=value)
-                else:
-                    comparison_string += " and {collection_name}/any({fn}:{attribute_expression} {comparator} " \
-                                            "{value}))".format(collection_name=collection_name, fn=lambda_func,
-                                                            attribute_expression=attribute_expression,
-                                                            comparator=comparator,
-                                                            value=value)
-            else:
-                # check for mapped field that does not have '.' character -> example [azureTenantId,title]
-                if comparator == 'contains':
-                    comparison_string += "{comparator}{mapped_field}, {value}".format(
-                        mapped_field=mapped_field, comparator=comparator, value=value)
-                else:
-                    comparison_string += "{mapped_field} {comparator} {value}".format(
-                        mapped_field=mapped_field, comparator=comparator, value=value)
-            return comparison_string
-
         # loop for custom logic to form IN operator related query
         for mapped_field in mapped_fields_array:
-            lambda_func = 'query' + str(counter)
 
-            # for In operator, loop the format comparision string for each values in the list.
+            # security alert Entities field mapped to parsed_entities field
+            if 'Entities.' in mapped_field:
+                mapped_field = mapped_field.replace('Entities', 'parsed_entities')
+
+            # security alert ExtendedProperties field mapped to parsed_entities field
+            if 'ExtendedProperties.' in mapped_field:
+                mapped_field = mapped_field.replace('ExtendedProperties', 'parsed_properties')
+
+            # hexadecimal values conversion
+            if mapped_field in self.config_map['hexadecimal_fields']:
+                if expression.comparator in [ComparisonComparators.Like, ComparisonComparators.Matches,
+                                             ComparisonComparators.In]:
+                    raise NotImplementedError(f'IN/LIKE/MATCHES operator is unsupported for hexadecimal fields in'
+                                              f' AZURE LOG ANALYTICS')
+                conversion_value = HexToInteger.transform(str(value).replace("\'", ""))
+                value = f'\'{conversion_value}\''
+
+            # enum values conversion
+            if mapped_field in self.config_map['enum_supported_fields']:
+                value = self._convert_enum_values(value, mapped_field, expression.comparator)
+
+            # check integer supported values
+            if mapped_field in self.config_map['int_supported_fields'] and \
+                    expression.comparator not in [ComparisonComparators.Like, ComparisonComparators.Matches]:
+                value = self._check_int_values(value)
+
+            # score values conversion
+            if mapped_field in self.config_map['score_fields']:
+                value = self._convert_score_values(value, expression.comparator)
+
+            # for In operator, loop the format comparison string for each values in the list.
             if expression.comparator == ComparisonComparators.In:
                 if isinstance(values, list):
-                    comparison_string += "{mapped_field} in ({value})".format(
-                        mapped_field=mapped_field, value=', '.join(value))
+                    comparison_string += f"{mapped_field} {comparator} ({', '.join(value)})"
             # to form queries other than IN operator
             else:
-                comparison_string = format_comparision_string(comparison_string, mapped_field, lambda_func)
+                if expression.comparator in [ComparisonComparators.Like, ComparisonComparators.Matches]:
+                    if mapped_field in self.config_map['int_supported_fields'] + \
+                            self.config_map['timestamp_supported_fields']:
+                        mapped_field = f"tostring({mapped_field})"
+
+                comparison_string += f"{mapped_field} {comparator} {value}"
 
             if mapped_fields_count > 1:
-                if expression.negated:
+                if expression.negated or expression.comparator == ComparisonComparators.NotEqual:
                     comparison_string += " and "
                 else:
                     comparison_string += " or "
                 mapped_fields_count -= 1
         return comparison_string
 
     def _lookup_comparison_operator(self, expression_operator):
         if str(expression_operator) not in self.comparator_lookup:
             raise NotImplementedError(
-                "Comparison operator {} unsupported for Azure Sentinel adapter".format(expression_operator.name))
+                f"Comparison operator {expression_operator.name} unsupported for AZURE LOG ANALYTICS")
         return self.comparator_lookup[str(expression_operator)]
 
     @staticmethod
     def _parse_time_range(qualifier, time_range):
         """
         :param qualifier: str, input time range i.e START t'2019-04-10T08:43:10.003Z' STOP t'2019-04-20T10:43:10.003Z'
         :param time_range: int, value available from main.py in options variable
         :return: str, format_string bound with time range provided
         """
         try:
             compile_timestamp_regex = re.compile(START_STOP_PATTERN)
             mapped_field = "TimeGenerated"
             if qualifier and compile_timestamp_regex.search(qualifier):
                 time_range_iterator = compile_timestamp_regex.finditer(qualifier)
-                time_range_list = [each.group() for each in time_range_iterator]
+                time_range_list = []
+                for each in time_range_iterator:
+                    date_time = each.group()
+                    if re.search(r"\d{4}(-\d{2}){2}T\d{2}(:\d{2}){2}Z", str(date_time)):  # without milli seconds
+                        date_time = datetime.strptime(each.group(), '%Y-%m-%dT%H:%M:%SZ'). \
+                                        strftime('%Y-%m-%dT%H:%M:%S.%f')[:-3] + 'Z'
+                    time_range_list.append(date_time)
             else:
                 stop_time = datetime.utcnow()
                 start_time = stop_time - timedelta(hours=24)
                 converted_starttime = start_time.strftime('%Y-%m-%dT%H:%M:%S.%f')[:-3] + 'Z'
                 converted_stoptime = stop_time.strftime('%Y-%m-%dT%H:%M:%S.%f')[:-3] + 'Z'
                 time_range_list = [converted_starttime, converted_stoptime]
 
-            value = ('{mapped_field} between (datetime({start_time}) .. datetime({stop_time}))'
-                        ).format(mapped_field=mapped_field, start_time=time_range_list[0],
-                                stop_time=time_range_list[1])
-            format_string = '{value}'.format(value=value)
+            value = f'{mapped_field} between (datetime({time_range_list[0]}) .. datetime({time_range_list[1]}))'
+            format_string = f'{value}'
             return format_string
         except (KeyError, IndexError, TypeError) as e:
             raise e
 
     def _parse_expression(self, expression, qualifier=None) -> str:
         """
            Complete formation of native query from ANTLR expression object
@@ -233,97 +336,92 @@
             mapped_fields_array = self.dmm.map_field(stix_object, stix_field)
             # Resolve the comparison symbol to use in the query string (usually just ':')
             comparator = self._lookup_comparison_operator(expression.comparator)
 
             # Some values are formatted differently based on how they're being compared
             if expression.comparator == ComparisonComparators.Matches:  # needs forward slashes
                 value = self._format_match(expression.value)
+                value = self._escape_value(value)
             # should be (x, y, z, ...)
             elif expression.comparator == ComparisonComparators.In:
                 value = self._format_set(expression.value)
-            elif expression.comparator == ComparisonComparators.Equal \
-                    or expression.comparator == ComparisonComparators.NotEqual \
-                    or expression.comparator == ComparisonComparators.GreaterThan \
-                    or expression.comparator == ComparisonComparators.LessThan \
-                    or expression.comparator == ComparisonComparators.GreaterThanOrEqual \
-                    or expression.comparator == ComparisonComparators.LessThanOrEqual:
+            elif expression.comparator in [ComparisonComparators.Equal, ComparisonComparators.NotEqual]:
                 # Should be in single-quotes
                 value = self._format_equality(expression.value)
+                value = self._escape_value(value)
+            elif expression.comparator in [ComparisonComparators.GreaterThan, ComparisonComparators.GreaterThanOrEqual,
+                                           ComparisonComparators.LessThan,
+                                           ComparisonComparators.LessThanOrEqual]:
+                for mapped_field in mapped_fields_array:
+                    if mapped_field.replace('Entities', 'parsed_entities') not in \
+                            self.config_map['int_supported_fields']:
+                        raise NotImplementedError(f"Comparison operator {comparator} unsupported for AZURE LOG "
+                                                  f"ANALYTICS attribute {mapped_field}")
+                value = expression.value
+
             # '%' -> '*' wildcard, '_' -> '?' single wildcard
             elif expression.comparator == ComparisonComparators.Like:
                 value = self._format_like(expression.value)
+                value = self._escape_value(value)
             else:
                 value = self._escape_value(expression.value)
 
-            if expression.negated:
-                if expression.comparator in [ComparisonComparators.Like, ComparisonComparators.Matches]:
-                    raise SearchFeatureNotSupportedError("'NOT' Operator is not supported for LIKE and MATCHES")
-                elif stix_object in ['ipv4-addr', 'ipv6-addr'] or stix_field in ['src_ref.value', 'dst_ref.value']:
-                    raise SearchFeatureNotSupportedError("'NOT' Operator is not supported for IPV4 or IPV6 address")
-                comparator = self.negated_comparator_lookup.get(expression.comparator)
-
-            # to remove single quotes in specific field value
-            if stix_field in ['pid', 'parent_ref.pid', 'account_last_login']:
-                if expression.comparator in [ComparisonComparators.Like, ComparisonComparators.Matches]:
-                    raise SearchFeatureNotSupportedError('"{operator}" operator is not supported for '
-                                                         '"{stix_field}" attribute'
-                                                         .format(operator=expression.comparator.name.upper(),
-                                                                 stix_field=stix_field))
-                value = self._format_value_without_quotes(value)
-
-            # COUNTER is used to form sequential lambda function names for OData4 queries per comparison observation
-            ''' eg. processes/any(query1:contains(tolower(query1/path), 'c:\\windows\\system32')) and 
-            processes/any(query2:contains(tolower(query2/name), 'exe')) '''
-            self.COUNTER += 1
-
-            comparison_string = self._parse_mapped_fields(self, expression, value, comparator, stix_field,
-                                                          mapped_fields_array, self.COUNTER)
+            comparison_string = self._parse_mapped_fields(expression, value, comparator, mapped_fields_array)
 
             if len(mapped_fields_array) > 1:
                 # More than one data source field maps to the STIX attribute, so group comparisons together.
                 grouped_comparison_string = "(" + comparison_string + ")"
                 comparison_string = grouped_comparison_string
 
-            return "{}".format(comparison_string)
+            if expression.negated or expression.comparator == ComparisonComparators.NotEqual:
+                comparison_string = self._negate_comparison(comparison_string, mapped_fields_array,
+                                                            expression.comparator)
+
+            # security alert file hash conversion
+            if 'parsed_entities' in comparison_string:
+                if stix_field in self.config_map["file_hash_fields"]:
+                    comparison_string = self._format_file_hash(stix_field, comparison_string)
+
+            return f"{comparison_string}"
 
         elif isinstance(expression, CombinedComparisonExpression):
             operator = self._lookup_comparison_operator(expression.operator)
             expression_01 = self._parse_expression(expression.expr1)
             expression_02 = self._parse_expression(expression.expr2)
             if not expression_01 or not expression_02:
                 return ''
             if isinstance(expression.expr1, CombinedComparisonExpression):
-                expression_01 = "({})".format(expression_01)
+                expression_01 = f"({expression_01})"
             if isinstance(expression.expr2, CombinedComparisonExpression):
-                expression_02 = "({})".format(expression_02)
-            query_string = "{} {} {}".format(expression_01, operator, expression_02)
-            return "{}".format(query_string)
+                expression_02 = f"({expression_02})"
+            query_string = f"{expression_01} {operator} {expression_02}"
+            return f"{query_string}"
         elif isinstance(expression, ObservationExpression):
             parse_string = self._parse_expression(expression.comparison_expression)
             time_string = self._parse_time_range(qualifier, self._time_range)
-            sentinel_query = "({}) and ({})".format(parse_string, time_string)
+            sentinel_query = f"({parse_string}) and ({time_string})"
             self.final_query_list.append(sentinel_query)
         elif hasattr(expression, 'qualifier') and hasattr(expression, 'observation_expression'):
             if isinstance(expression.observation_expression, CombinedObservationExpression):
                 self._parse_expression(expression.observation_expression.expr1, expression.qualifier)
                 self._parse_expression(expression.observation_expression.expr2, expression.qualifier)
             else:
                 parse_string = self._parse_expression(expression.observation_expression.comparison_expression,
                                                       expression.qualifier)
                 time_string = self._parse_time_range(expression.qualifier, self._time_range)
-                sentinel_query = "({}) and ({})".format(parse_string, time_string)
+                sentinel_query = f"({parse_string}) and ({time_string})"
                 self.final_query_list.append(sentinel_query)
         elif isinstance(expression, CombinedObservationExpression):
             self._parse_expression(expression.expr1, qualifier)
             self._parse_expression(expression.expr2, qualifier)
         elif isinstance(expression, Pattern):
-            return "{expr}".format(expr=self._parse_expression(expression.expression))
+            return f"{self._parse_expression(expression.expression)}"
         else:
-            raise RuntimeError("Unknown Recursion Case for expression={}, type(expression)={}".format(
-                expression, type(expression)))
+            raise RuntimeError(f"Unknown Recursion Case for expression={expression}, "
+                               f"type(expression)={type(expression)}")
 
     def parse_expression(self, pattern: Pattern):
         """
           parse_expression --> Native query
           :param pattern: expression object, ANTLR parsed expression object
           :return:str, Odata filter query(native query)
           """
@@ -338,9 +436,22 @@
     :param options: dict, contains 2 keys result_limit defaults to 10000, time_range defaults to 5
     :return: str, translated query
     """
     dialect_name = data_model_mapping.dialect
     # Query result limit and time range can be passed into the QueryStringPatternTranslator if supported by the DS
     time_range = options['time_range']
     query = QueryStringPatternTranslator(pattern, data_model_mapping, time_range)
-    translated_query = dialect_name + ' |' + " where " + ','.join(query.final_query_list)
+    query = ' or '.join(query.final_query_list)
+
+    # parsing and expanding the Entities, ExtendedProperties fields for security alert query
+    expand_query_fields = ""
+    if 'parsed_entities' in query:
+        expand_query_fields = "| mv-expand parsed_entities = parse_json(Entities) "
+    if 'parsed_properties' in query:
+        expand_query_fields += "| mv-expand parsed_properties = parse_json(ExtendedProperties) "
+
+    if expand_query_fields:
+        translated_query = f"{dialect_name} {expand_query_fields}" \
+                           f"| where {query} | summarize arg_max(TimeGenerated, *) by TimeGenerated, SystemAlertId"
+    else:
+        translated_query = dialect_name + ' |' + " where " + query
     return translated_query
```

## stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityAlert_from_stix_map.json

### Pretty-printed

 * *Similarity: 0.0339170692431562%*

 * *Differences: {"'directory'": "OrderedDict([('fields', OrderedDict([('path', ['Entities.Directory'])]))])",*

 * * "'domain-name'": "OrderedDict([('fields', OrderedDict([('value', ['Entities.DomainName'])]))])",*

 * * "'file'": "OrderedDict([('fields', OrderedDict([('name', ['Entities.Name']), "*

 * *           '("hashes.\'SHA-256\'", [\'Entities.Value\']), ("hashes.\'SHA-1\'", '*

 * *           "['Entities.Value']), ('hashes.MD5', ['Entities.Value']), ('parent_directory_ref.path', "*

 * *           "['Entities.Directory'])]))])",*

 * * "'ipv4-addr'": [â€¦]*

```diff
@@ -1,83 +1,426 @@
 {
-    "x-azure-security-alert": {
+    "directory": {
         "fields": {
-            "alert_severity": [
-                "AlertSeverity"
+            "path": [
+                "Entities.Directory"
+            ]
+        }
+    },
+    "domain-name": {
+        "fields": {
+            "value": [
+                "Entities.DomainName"
+            ]
+        }
+    },
+    "file": {
+        "fields": {
+            "hashes.'SHA-1'": [
+                "Entities.Value"
             ],
-            "compromised_entity": [
-                "CompromisedEntity"
+            "hashes.'SHA-256'": [
+                "Entities.Value"
             ],
-            "confidence_level": [
-                "ConfidenceLevel"
+            "hashes.MD5": [
+                "Entities.Value"
             ],
-            "description": [
-                "Description"
+            "name": [
+                "Entities.Name"
             ],
-            "display_name": [
-                "DisplayName"
+            "parent_directory_ref.path": [
+                "Entities.Directory"
+            ]
+        }
+    },
+    "ipv4-addr": {
+        "fields": {
+            "value": [
+                "Entities.Address"
+            ],
+            "x_location_ref.carrier": [
+                "Entities.Location.Carrier"
+            ],
+            "x_location_ref.city": [
+                "Entities.Location.City"
+            ],
+            "x_location_ref.country": [
+                "Entities.Location.CountryName"
+            ],
+            "x_location_ref.latitude": [
+                "Entities.Location.Latitude"
+            ],
+            "x_location_ref.longitude": [
+                "Entities.Location.Longitude"
+            ],
+            "x_location_ref.organization": [
+                "Entities.Location.Organization"
+            ]
+        }
+    },
+    "ipv6-addr": {
+        "fields": {
+            "value": [
+                "Entities.Address"
+            ],
+            "x_location_ref.carrier": [
+                "Entities.Location.Carrier"
+            ],
+            "x_location_ref.city": [
+                "Entities.Location.City"
+            ],
+            "x_location_ref.country": [
+                "Entities.Location.CountryName"
+            ],
+            "x_location_ref.latitude": [
+                "Entities.Location.Latitude"
+            ],
+            "x_location_ref.longitude": [
+                "Entities.Location.Longitude"
+            ],
+            "x_location_ref.organization": [
+                "Entities.Location.Organization"
+            ]
+        }
+    },
+    "network-traffic": {
+        "fields": {
+            "dst_port": [
+                "Entities.DestinationPort"
+            ],
+            "protocols[*]": [
+                "Entities.Protocol"
+            ],
+            "src_ref.value": [
+                "Entities.Address"
+            ]
+        }
+    },
+    "process": {
+        "fields": {
+            "binary_ref.hashes.'SHA-256'": [
+                "Entities.Value"
+            ],
+            "binary_ref.hashes.'SHA1'": [
+                "Entities.Value"
             ],
-            "entities": [
-                "Entities"
+            "binary_ref.hashes.MD5": [
+                "Entities.Value"
             ],
-            "extented_properties": [
-                "ExtentedProperties"
+            "command_line": [
+                "Entities.CommandLine"
             ],
-            "product_name": [
+            "created": [
+                "Entities.CreationTimeUtc"
+            ],
+            "creator_user_ref.user_id": [
+                "Entities.Name"
+            ],
+            "parent_ref.binary_ref.hashes.'SHA-256'": [
+                "Entities.Value"
+            ],
+            "parent_ref.binary_ref.hashes.'SHA1'": [
+                "Entities.Value"
+            ],
+            "parent_ref.binary_ref.hashes.MD5": [
+                "Entities.Value"
+            ],
+            "parent_ref.command_line": [
+                "Entities.CommandLine"
+            ],
+            "parent_ref.pid": [
+                "Entities.ProcessId"
+            ],
+            "pid": [
+                "Entities.ProcessId"
+            ],
+            "x_elevation_token": [
+                "Entities.ElevationToken"
+            ]
+        }
+    },
+    "software": {
+        "fields": {
+            "name": [
+                "Entities.OSFamily",
                 "ProductName"
             ],
-            "resourceId": [
-                "_ResourceId"
+            "vendor": [
+                "VendorName"
             ],
-            "status": [
-                "Status"
+            "version": [
+                "Entities.OSVersion"
             ],
-            "subscription_id": [
-                "WorkspaceSubscriptionId"
+            "x_product_component_name": [
+                "ProductComponentName"
             ],
-            "system_alertid": [
-                "SystemAlertId"
+            "x_provider_name": [
+                "ProviderName"
+            ]
+        }
+    },
+    "url": {
+        "fields": {
+            "value": [
+                "Entities.Url"
+            ]
+        }
+    },
+    "user-account": {
+        "fields": {
+            "display_name": [
+                "Entities.DisplayName"
+            ],
+            "user_id": [
+                "Entities.Name"
+            ],
+            "x_aad_user_id": [
+                "Entities.AadUserId"
+            ],
+            "x_account_sid": [
+                "Entities.Sid"
+            ],
+            "x_dns_domain": [
+                "Entities.DnsDomain"
+            ],
+            "x_is_domain_account": [
+                "Entities.IsDomainJoined"
+            ],
+            "x_nt_domain": [
+                "Entities.NTDomain"
+            ],
+            "x_passport_userid": [
+                "Entities.PUID"
             ],
+            "x_upn_suffix": [
+                "Entities.UPNSuffix"
+            ]
+        }
+    },
+    "x-azure-blob": {
+        "fields": {
+            "blob_container": [
+                "Entities.Name"
+            ],
+            "etag": [
+                "Entities.Etag"
+            ],
+            "name": [
+                "Entities.Name"
+            ]
+        }
+    },
+    "x-azure-container": {
+        "fields": {
+            "container_id": [
+                "Entities.ContainerId"
+            ],
+            "image_id": [
+                "Entities.ImageId"
+            ],
+            "image_type": [
+                "Entities.Type"
+            ]
+        }
+    },
+    "x-azure-malware": {
+        "fields": {
+            "category": [
+                "Entities.Category"
+            ],
+            "name": [
+                "Entities.Name"
+            ]
+        }
+    },
+    "x-cloud-provider": {
+        "fields": {
             "tenant_id": [
                 "TenantId"
+            ]
+        }
+    },
+    "x-cloud-resource": {
+        "fields": {
+            "resource_id": [
+                "ResourceId"
             ],
-            "vendor_name": [
-                "VendorName"
+            "resource_type": [
+                "ExtendedProperties.resourceType"
+            ]
+        }
+    },
+    "x-geo-location": {
+        "fields": {
+            "carrier": [
+                "Entities.Location.Carrier"
+            ],
+            "city": [
+                "Entities.Location.City"
+            ],
+            "country": [
+                "Entities.Location.CountryName"
             ],
-            "workspace_resource_group": [
-                "WorkspaceResourceGroup"
+            "latitude": [
+                "Entities.Location.Latitude"
+            ],
+            "longitude": [
+                "Entities.Location.Longitude"
+            ],
+            "organization": [
+                "Entities.Location.Organization"
+            ]
+        }
+    },
+    "x-host-logon-session": {
+        "fields": {
+            "end_time": [
+                "Entities.EndTimeUtc"
+            ],
+            "session_id": [
+                "Entities.SessionId"
+            ],
+            "start_time": [
+                "Entities.StartTimeUtc"
             ]
         }
     },
     "x-ibm-finding": {
         "fields": {
+            "alert_id": [
+                "VendorOriginalId"
+            ],
+            "confidence": [
+                "ConfidenceScore"
+            ],
+            "description": [
+                "Description"
+            ],
+            "dst_application_ref.name": [
+                "ProductName"
+            ],
+            "dst_application_ref.vendor": [
+                "VendorName"
+            ],
+            "dst_os_ref.name": [
+                "Entities.OSFamily"
+            ],
+            "dst_os_ref.version": [
+                "Entities.OSVersion"
+            ],
+            "dst_os_user_ref.user_id": [
+                "Entities.Name"
+            ],
             "end": [
-                "EndTime",
-                "ProcessingEndTime"
+                "EndTime"
+            ],
+            "finding_type": [
+                "Type"
+            ],
+            "ioc_refs[*].value": [
+                "Entities.Name",
+                "Entities.Address",
+                "Entities.Url",
+                "Entities.DomainName"
             ],
             "name": [
                 "AlertName"
             ],
+            "severity": [
+                "AlertSeverity"
+            ],
             "start": [
-                "StartTime",
-                "TimeGenerated"
+                "StartTime"
             ],
             "time_observed": [
-                "TimeGenerated",
-                "EventTime"
+                "TimeGenerated"
+            ],
+            "ttp_tagging_refs[*].confidence": [
+                "ConfidenceScore"
+            ],
+            "ttp_tagging_refs[*].extensions.'mitre-attack-ext'.tactic_name": [
+                "Tactics"
+            ],
+            "ttp_tagging_refs[*].extensions.'mitre-attack-ext'.technique_name": [
+                "Techniques"
+            ],
+            "ttp_tagging_refs[*].name": [
+                "AlertName"
+            ],
+            "x_alert_link": [
+                "AlertLink"
+            ],
+            "x_alert_type": [
+                "AlertType"
+            ],
+            "x_compromised_entity": [
+                "CompromisedEntity"
+            ],
+            "x_confidence_level": [
+                "ConfidenceLevel"
+            ],
+            "x_processing_endtime": [
+                "ProcessingEndTime"
+            ],
+            "x_remediationsteps": [
+                "RemediationSteps"
+            ],
+            "x_status": [
+                "Status"
+            ],
+            "x_system_alert_id": [
+                "SystemAlertId"
             ]
         }
     },
-    "x-oca-event": {
+    "x-ibm-ttp-tagging": {
         "fields": {
-            "created": [
-                "TimeGenerated"
+            "confidence": [
+                "ConfidenceScore"
             ],
-            "domain_ref": [
-                "DomainName"
+            "extensions.'mitre-attack-ext'.tactic_name": [
+                "Tactics"
             ],
-            "provider": [
-                "ProviderName"
+            "extensions.'mitre-attack-ext'.technique_name": [
+                "Techniques"
+            ],
+            "name": [
+                "AlertName"
+            ]
+        }
+    },
+    "x-k8s-cluster": {
+        "fields": {
+            "name": [
+                "Entities.Name"
+            ]
+        }
+    },
+    "x-oca-asset": {
+        "fields": {
+            "hostname": [
+                "Entities.HostName"
+            ],
+            "os_ref.name": [
+                "Entities.OSFamily"
+            ],
+            "os_ref.version": [
+                "Entities.OSVersion"
+            ],
+            "x_is_domain_host": [
+                "Entities.IsDomainJoined"
+            ],
+            "x_netbios_name": [
+                "Entities.NetBiosName"
+            ],
+            "x_nt_domain": [
+                "Entities.NTDomain"
+            ],
+            "x_oms_agent_id": [
+                "Entities.OMSAgentID"
+            ],
+            "x_resource_id": [
+                "ResourceId"
             ]
         }
     }
 }
```

## stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityEvent_from_stix_map.json

### Pretty-printed

 * *Similarity: 0.5019600340136054%*

 * *Differences: {"'directory'": "{'fields': {'path': {insert: [(2, 'ProcessName'), (3, 'ParentProcessName'), (4, "*

 * *                "'NewProcessName')]}}}",*

 * * "'file'": "{'fields': {'name': ['FilePath'], 'parent_directory_ref': ['ProcessName', "*

 * *           "'ParentProcessName'], 'x_fqbn': ['Fqbn']}}",*

 * * "'ipv4-addr'": "{'fields': {'value': {insert: [(1, 'ClientIPAddress')]}}}",*

 * * "'ipv6-addr'": "OrderedDict([('fields', OrderedDict([('value', ['IpAddress', "*

 * *                "'ClientIPAddress'])]))])",*

 * * "'process'": "{'fields':  [â€¦]*

```diff
@@ -1,174 +1,260 @@
 {
     "directory": {
         "fields": {
             "path": [
                 "HomeDirectory",
-                "HomePath"
-            ]
-        }
-    },
-    "domain-name": {
-        "fields": {
-            "value": [
-                "TargetDomainName"
+                "HomePath",
+                "ProcessName",
+                "ParentProcessName",
+                "NewProcessName"
             ]
         }
     },
     "file": {
         "fields": {
             "hashes.'SHA-1'": [
                 "FileHash"
             ],
             "hashes.'SHA-256'": [
                 "FileHash"
             ],
             "hashes.MD5": [
                 "FileHash"
             ],
+            "name": [
+                "FilePath"
+            ],
+            "parent_directory_ref": [
+                "ProcessName",
+                "ParentProcessName"
+            ],
             "path": [
                 "FilePath"
+            ],
+            "x_fqbn": [
+                "Fqbn"
             ]
         }
     },
     "ipv4-addr": {
         "fields": {
             "value": [
-                "IpAddress"
+                "IpAddress",
+                "ClientIPAddress"
+            ]
+        }
+    },
+    "ipv6-addr": {
+        "fields": {
+            "value": [
+                "IpAddress",
+                "ClientIPAddress"
             ]
         }
     },
     "process": {
         "fields": {
             "command_line": [
                 "CommandLine"
             ],
-            "name": [
-                "ProcessName",
-                "LogonProcessName"
-            ],
             "parent_ref.name": [
                 "ParentProcessName"
             ],
             "pid": [
-                "ProcessId"
+                "ProcessId",
+                "NewProcessId"
+            ],
+            "x_mandatory_label": [
+                "MandatoryLabel"
+            ],
+            "x_token_elevation_type": [
+                "TokenElevationType"
             ]
         }
     },
     "url": {
         "fields": {
             "value": [
                 "QuarantineHelpURL"
             ]
         }
     },
     "user-account": {
         "fields": {
             "account_login": [
-                "TargetUserName"
+                "TargetAccount",
+                "SubjectAccount"
+            ],
+            "display_name": [
+                "TargetUserName",
+                "SubjectUserName"
+            ],
+            "user_id": [
+                "TargetUserName",
+                "SubjectUserName"
+            ],
+            "x_domain_name": [
+                "TargetDomainName",
+                "SubjectDomainName"
+            ],
+            "x_login_id": [
+                "TargetLogonId",
+                "SubjectLogonId"
+            ],
+            "x_user_sid": [
+                "TargetUserSid",
+                "SubjectUserSid"
             ]
         }
     },
-    "x-azure-security-event": {
+    "x-cloud-resource": {
         "fields": {
-            "activity": [
-                "Activity"
-            ],
-            "alert_type": [
-                "AlertName"
-            ],
-            "computer": [
-                "Computer"
-            ],
-            "device_name": [
-                "DeviceId"
-            ],
-            "event_data": [
-                "EventData"
-            ],
-            "member_name": [
-                "MemberName"
-            ],
-            "requester": [
-                "Requester"
-            ],
-            "service_name": [
-                "ServiceName"
-            ],
-            "source": [
-                "SourceSystem"
-            ],
-            "task": [
-                "Task"
-            ],
-            "text": [
-                "Description",
-                "DeviceDescription"
-            ],
-            "title": [
-                "Title"
-            ],
-            "user_parameter": [
-                "UserParameter"
+            "resource_id": [
+                "_ResourceId"
             ]
         }
     },
     "x-ibm-finding": {
         "fields": {
-            "dst_ip_ref": [
-                "ClientIPAddress"
+            "alert_id": [
+                "EventOriginId"
             ],
-            "end": [
-                "PreviousTime"
+            "dst_application_user_ref": [
+                "SubjectUserName"
+            ],
+            "dst_device": [
+                "WorkstationName",
+                "TargetServerName"
+            ],
+            "finding_type": [
+                "Type"
+            ],
+            "ioc_refs": [
+                "FilePath",
+                "IpAddress",
+                "ClientIPAddress"
             ],
             "name": [
-                "EventSourceName"
+                "Activity"
+            ],
+            "src_application_user_ref": [
+                "TargetUserName"
             ],
             "src_ip_ref": [
                 "IpAddress"
             ],
             "start": [
-                "TimeGenerated"
+                "PreviousTime"
             ],
             "time_observed": [
                 "TimeGenerated"
             ]
         }
     },
+    "x-logon-info": {
+        "fields": {
+            "authentication_package_name": [
+                "AuthenticationPackageName"
+            ],
+            "guid": [
+                "LogonGuid"
+            ],
+            "logon_process": [
+                "LogonProcessName"
+            ],
+            "logon_type": [
+                "LogonType"
+            ],
+            "logon_type_name": [
+                "LogonTypeName"
+            ]
+        }
+    },
+    "x-oca-asset": {
+        "fields": {
+            "device_id": [
+                "DeviceId",
+                "SourceComputerId"
+            ],
+            "hostname": [
+                "Computer"
+            ]
+        }
+    },
     "x-oca-event": {
         "fields": {
+            "action": [
+                "Activity"
+            ],
             "code": [
                 "EventID"
             ],
             "created": [
-                "TimeGenerated"
+                "TimeCollected"
+            ],
+            "dataset": [
+                "EventData"
             ],
             "file_ref.hash": [
                 "FileHash"
             ],
             "file_ref.path": [
                 "FilePath"
             ],
-            "file_ref.service": [
-                "ServiceFileName"
+            "host_ref": [
+                "Computer"
             ],
-            "ip_refs.clientIp": [
+            "ip_refs.ip": [
+                "IpAddress",
                 "ClientIPAddress"
             ],
-            "ip_refs.ip": [
-                "IpAddress"
+            "modified": [
+                "TimeCollected"
+            ],
+            "module": [
+                "Channel"
             ],
             "parent_process_ref": [
                 "ParentProcessName"
             ],
             "process_ref": [
+                "NewProcessName",
+                "Process",
                 "ProcessName"
             ],
             "provider": [
-                "Account"
+                "EventSourceName"
             ],
             "url_ref": [
                 "QuarantineHelpURL"
+            ],
+            "user_ref": [
+                "TargetUserName"
+            ],
+            "x_description": [
+                "DeviceDescription"
+            ],
+            "x_member_name": [
+                "MemberName"
+            ],
+            "x_modified_account_sid": [
+                "TargetSid"
+            ],
+            "x_requester": [
+                "Requester"
+            ],
+            "x_service_file_ref": [
+                "ServiceFileName"
+            ],
+            "x_service_name": [
+                "ServiceName"
+            ],
+            "x_task": [
+                "Task"
+            ],
+            "x_user_parameter": [
+                "UserParameters"
             ]
         }
     }
 }
```

## stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityIncident_from_stix_map.json

### Pretty-printed

 * *Similarity: 0.22253787878787878%*

 * *Differences: {"'email-addr'": "OrderedDict([('fields', OrderedDict([('value', ['Owner.email', "*

 * *                 "'Owner.userPrincipalName']), ('display_name', ['Owner.assignedTo'])]))])",*

 * * "'x-cloud-provider'": "OrderedDict([('fields', OrderedDict([('tenant_id', ['TenantId'])]))])",*

 * * "'x-ibm-finding'": "{'fields': {'start': ['CreatedTime'], 'end': {delete: [1, 0]}, 'name': "*

 * *                    "['Title'], 'description': ['Description'], 'severity': ['Severity'], "*

 * *                    "'finding_type': ['Type'], 'rule_n [â€¦]*

```diff
@@ -1,79 +1,150 @@
 {
+    "email-addr": {
+        "fields": {
+            "display_name": [
+                "Owner.assignedTo"
+            ],
+            "value": [
+                "Owner.email",
+                "Owner.userPrincipalName"
+            ]
+        }
+    },
     "url": {
         "fields": {
             "value": [
                 "IncidentUrl"
             ]
         }
     },
-    "x-azure-security-incident": {
+    "x-cloud-provider": {
         "fields": {
-            "additional_data": [
-                "AdditionalData"
+            "tenant_id": [
+                "TenantId"
+            ]
+        }
+    },
+    "x-ibm-finding": {
+        "fields": {
+            "description": [
+                "Description"
             ],
-            "alertids": [
-                "AlertIds"
+            "end": [
+                "LastModifiedTime"
             ],
-            "classification": [
-                "Classification"
+            "finding_type": [
+                "Type"
             ],
-            "comments": [
-                "Comments"
+            "name": [
+                "Title"
             ],
-            "description": [
-                "Description"
+            "rule_names[*]": [
+                "RelatedAnalyticRuleIds"
             ],
-            "incident_name": [
-                "IncidentName"
+            "severity": [
+                "Severity"
             ],
-            "labels": [
-                "Labels"
+            "start": [
+                "CreatedTime"
+            ],
+            "time_observed": [
+                "TimeGenerated"
+            ],
+            "ttp_tagging_refs[*].extensions.'mitre-attack-ext'.tactic_name": [
+                "AdditionalData.tactics"
+            ],
+            "ttp_tagging_refs[*].extensions.'mitre-attack-ext'.technique_name": [
+                "AdditionalData.techniques"
+            ],
+            "ttp_tagging_refs[*].name": [
+                "Title"
+            ],
+            "x_alert_count": [
+                "AdditionalData.alertsCount"
             ],
-            "modified_by": [
+            "x_alert_ids[*]": [
+                "AlertIds"
+            ],
+            "x_alert_product_names": [
+                "AdditionalData.alertProductNames"
+            ],
+            "x_incident_name": [
+                "IncidentName"
+            ],
+            "x_modified_by": [
                 "ModifiedBy"
             ],
-            "owner": [
-                "Owner"
+            "x_owner_ref": [
+                "Owner.email",
+                "Owner.userPrincipalName",
+                "Owner.assignedTo"
+            ],
+            "x_owner_ref.display_name": [
+                "Owner.assignedTo"
+            ],
+            "x_owner_ref.value": [
+                "Owner.email",
+                "Owner.userPrincipalName"
             ],
-            "severity": [
-                "Severity"
+            "x_provider_incident_id": [
+                "ProviderIncidentId"
+            ],
+            "x_provider_name": [
+                "ProviderName"
+            ],
+            "x_status": [
+                "Status"
             ]
         }
     },
-    "x-ibm-finding": {
+    "x-ibm-ttp-tagging": {
         "fields": {
-            "end": [
-                "ClosedTime",
-                "LastActivityTime",
-                "LastModifiedTime"
+            "extensions.'mitre-attack-ext'.tactic_name": [
+                "AdditionalData.tactics"
             ],
-            "name": [
-                "IncidentName"
-            ],
-            "start": [
-                "FirstActivityTime",
-                "FirstModifiedTime",
-                "TimeGenerated"
+            "extensions.'mitre-attack-ext'.technique_name": [
+                "AdditionalData.techniques"
             ],
-            "time_observed": [
-                "TimeGenerated"
+            "name": [
+                "Title"
             ]
         }
     },
-    "x-oca-event": {
+    "x-incident-info": {
         "fields": {
-            "created": [
-                "CreatedTime"
+            "classification": [
+                "Classification"
             ],
-            "domain_ref": [
-                "DomainName"
+            "classification_comment": [
+                "ClassificationComment"
             ],
-            "provider": [
-                "ProviderName"
+            "classification_reason": [
+                "ClassificationReason"
+            ],
+            "closed_time": [
+                "ClosedTime"
+            ],
+            "comments": [
+                "Comments"
+            ],
+            "first_activity": [
+                "FirstActivityTime"
             ],
-            "url_ref": [
+            "first_modified": [
+                "FirstModifiedTime"
+            ],
+            "incident_url_ref.value": [
                 "IncidentUrl"
+            ],
+            "labels": [
+                "Labels"
+            ],
+            "last_active": [
+                "LastActivityTime"
+            ],
+            "tasks": [
+                "Tasks"
             ]
         }
     }
 }
```

## stix_shifter_modules/azure_log_analytics/stix_translation/json/operators.json

### Pretty-printed

 * *Similarity: 0.4230769230769231%*

 * *Differences: {"'ComparisonComparators.GreaterThan'": "'>'",*

 * * "'ComparisonComparators.GreaterThanOrEqual'": "'>='",*

 * * "'ComparisonComparators.In'": "'in~'",*

 * * "'ComparisonComparators.LessThan'": "'<'",*

 * * "'ComparisonComparators.LessThanOrEqual'": "'<='",*

 * * "'ComparisonComparators.Like'": "'contains'",*

 * * "'ComparisonComparators.Matches'": "'matches regex'",*

 * * "'ObservationOperators.And'": "'or'",*

 * * "'ObservationOperators.Or'": "'or'"}*

```diff
@@ -1,9 +1,15 @@
 {
     "ComparisonComparators.Equal": "==",
-    "ComparisonComparators.In": "in",
-    "ComparisonComparators.Like": "startswith, endswith",
-    "ComparisonComparators.Matches": "contains",
+    "ComparisonComparators.GreaterThan": ">",
+    "ComparisonComparators.GreaterThanOrEqual": ">=",
+    "ComparisonComparators.In": "in~",
+    "ComparisonComparators.LessThan": "<",
+    "ComparisonComparators.LessThanOrEqual": "<=",
+    "ComparisonComparators.Like": "contains",
+    "ComparisonComparators.Matches": "matches regex",
     "ComparisonComparators.NotEqual": "!=",
     "ComparisonExpressionOperators.And": "and",
-    "ComparisonExpressionOperators.Or": "or"
+    "ComparisonExpressionOperators.Or": "or",
+    "ObservationOperators.And": "or",
+    "ObservationOperators.Or": "or"
 }
```

## stix_shifter_modules/azure_log_analytics/stix_translation/json/to_stix_map.json

### Pretty-printed

 * *Similarity: 0.3739104406130268%*

 * *Differences: {"'Activity'": "[OrderedDict([('key', 'x-oca-event.action'), ('object', 'event')]), "*

 * *               "OrderedDict([('key', 'x-ibm-finding.name'), ('object', 'finding')])]",*

 * * "'AdditionalData'": "{replace: OrderedDict([('alertsCount', OrderedDict([('key', "*

 * *                     "'x-ibm-finding.x_alert_count'), ('object', 'finding')])), "*

 * *                     "('alertProductNames', OrderedDict([('key', "*

 * *                     "'x-ibm-finding.x_alert_product_names'), ('object', 'finding')])), "*

 * *                 [â€¦]*

```diff
@@ -1,362 +1,1277 @@
 {
-    "Account": {
-        "key": "x-oca-event.provider",
-        "object": "event"
-    },
-    "Activity": {
-        "key": "x-azure-security-event.activity",
-        "object": "msevent"
-    },
+    "Activity": [
+        {
+            "key": "x-oca-event.action",
+            "object": "event"
+        },
+        {
+            "key": "x-ibm-finding.name",
+            "object": "finding"
+        }
+    ],
     "AdditionalData": {
-        "key": "x-azure-security-incident.additional_data",
-        "object": "incident"
+        "alertProductNames": {
+            "key": "x-ibm-finding.x_alert_product_names",
+            "object": "finding"
+        },
+        "alertsCount": {
+            "key": "x-ibm-finding.x_alert_count",
+            "object": "finding"
+        },
+        "tactics": {
+            "key": "x-ibm-ttp-tagging.extensions.mitre-attack-ext.tactic_name",
+            "object": "ttp_finding"
+        },
+        "techniques": {
+            "key": "x-ibm-ttp-tagging.extensions.mitre-attack-ext.technique_name",
+            "object": "ttp_finding"
+        }
     },
     "AlertIds": {
-        "key": "x-azure-security-incident.alertids",
-        "object": "incident"
+        "key": "x-ibm-finding.x_alert_ids",
+        "object": "finding"
+    },
+    "AlertLink": {
+        "key": "x-ibm-finding.x_alert_link",
+        "object": "finding"
     },
     "AlertName": [
         {
             "key": "x-ibm-finding.name",
             "object": "finding"
         },
         {
-            "key": "x-azure-security-event.alert_type",
-            "object": "msevent"
+            "key": "x-ibm-ttp-tagging.name",
+            "object": "ttp_finding"
+        },
+        {
+            "key": "x-ibm-finding.ttp_tagging_refs",
+            "object": "finding",
+            "references": [
+                "ttp_finding"
+            ]
         }
     ],
     "AlertSeverity": {
-        "key": "x-azure-security-alert.alert_severity",
-        "object": "alert"
+        "key": "x-ibm-finding.severity",
+        "object": "finding",
+        "transformer": "ConvertSeverityToScore"
+    },
+    "AlertType": {
+        "key": "x-ibm-finding.x_alert_type",
+        "object": "finding"
+    },
+    "AuthenticationPackageName": {
+        "key": "x-logon-info.authentication_package_name",
+        "object": "logon_info"
+    },
+    "Channel": {
+        "key": "x-oca-event.module",
+        "object": "event"
+    },
+    "Classification": {
+        "key": "x-incident-info.classification",
+        "object": "incident"
+    },
+    "ClassificationComment": {
+        "key": "x-incident-info.classification_comment",
+        "object": "incident"
+    },
+    "ClassificationReason": {
+        "key": "x-incident-info.classification_reason",
+        "object": "incident"
     },
     "ClientIPAddress": [
         {
+            "key": "ipv4-addr.value",
+            "object": "client"
+        },
+        {
+            "key": "ipv6-addr.value",
+            "object": "client"
+        },
+        {
             "key": "x-ibm-finding.dst_ip_ref",
-            "object": "finding"
+            "object": "finding",
+            "references": "client"
         },
         {
-            "key": "x-oca-event.ip_refs.clientIp",
-            "object": "event"
+            "group": true,
+            "key": "x-ibm-finding.ioc_refs",
+            "object": "finding",
+            "references": [
+                "client"
+            ]
+        },
+        {
+            "group": true,
+            "key": "x-oca-event.ip_refs",
+            "object": "event",
+            "references": [
+                "client"
+            ]
         }
     ],
     "ClosedTime": {
-        "key": "x-ibm-finding.end",
-        "object": "finding"
+        "key": "x-incident-info.closed_time",
+        "object": "incident"
     },
     "CommandLine": {
         "key": "process.command_line",
         "object": "process"
     },
     "Comments": {
-        "key": "x-azure-security-incident.comments",
+        "key": "x-incident-info.comments",
         "object": "incident"
     },
     "CompromisedEntity": {
-        "key": "x-azure-security-alert.compromised_entity",
-        "object": "alert"
-    },
-    "Computer": {
-        "key": "x-azure-security-event.computer",
-        "object": "msevent"
+        "key": "x-ibm-finding.x_compromised_entity",
+        "object": "finding"
     },
+    "Computer": [
+        {
+            "key": "x-oca-asset.hostname",
+            "object": "asset"
+        },
+        {
+            "key": "x-oca-event.host_ref",
+            "object": "event",
+            "references": "asset"
+        }
+    ],
     "ConfidenceLevel": {
-        "key": "x-azure-security-alert.confidence_level",
-        "object": "alert"
-    },
-    "CreatedTime": {
-        "key": "x-oca-event.created",
-        "object": "event"
+        "key": "x-ibm-finding.x_confidence_level",
+        "object": "finding"
     },
-    "Description": [
+    "ConfidenceScore": [
         {
-            "key": "x-azure-security-alert.description",
-            "object": "alert"
+            "key": "x-ibm-finding.confidence",
+            "object": "finding",
+            "transformer": "RealToNumber"
         },
         {
-            "key": "x-azure-security-event.description",
-            "object": "msevent"
+            "key": "x-ibm-ttp-tagging.confidence",
+            "object": "ttp_finding",
+            "transformer": "ConvertToReal"
         }
     ],
-    "Description__incident": {
-        "key": "x-azure-security-incident.description",
-        "object": "incident"
+    "CreatedTime": {
+        "key": "x-ibm-finding.start",
+        "object": "finding"
+    },
+    "Description": {
+        "key": "x-ibm-finding.description",
+        "object": "finding"
     },
     "DeviceDescription": {
-        "key": "x-azure-security-event.text",
-        "object": "msevent"
+        "key": "x-oca-asset.x_description",
+        "object": "asset"
     },
     "DeviceId": {
         "key": "x-oca-asset.device_id",
         "object": "asset"
     },
-    "DisplayName": {
-        "key": "x-azure-security-alert.display_name",
-        "object": "alert"
-    },
     "EndTime": {
         "key": "x-ibm-finding.end",
         "object": "finding"
     },
     "Entities": {
-        "key": "x-azure-security-alert.entities",
-        "object": "alert"
+        "K8s-cluster": {
+            "Name": {
+                "key": "x-k8s-cluster.name",
+                "object": "k8s_cluster"
+            }
+        },
+        "account": {
+            "AadUserId": {
+                "key": "user-account.x_aad_user_id",
+                "object": "account"
+            },
+            "AccountType": {
+                "key": "user-account.account_type",
+                "object": "account"
+            },
+            "DisplayName": {
+                "key": "user-account.display_name",
+                "object": "account"
+            },
+            "DnsDomain": {
+                "key": "user-account.x_dns_domain",
+                "object": "account"
+            },
+            "IsDomainJoined": {
+                "key": "user-account.is_service_account",
+                "object": "account"
+            },
+            "NTDomain": {
+                "key": "user-account.x_nt_domain",
+                "object": "account"
+            },
+            "Name": [
+                {
+                    "key": "user-account.user_id",
+                    "object": "account"
+                },
+                {
+                    "key": "process.creator_user_ref",
+                    "object": "process1",
+                    "references": "account"
+                },
+                {
+                    "key": "process.creator_user_ref",
+                    "object": "parent_process",
+                    "references": "account"
+                },
+                {
+                    "key": "x-host-logon-session.account_ref",
+                    "object": "logon_session",
+                    "references": "account"
+                },
+                {
+                    "key": "x-ibm-finding.dst_os_user_ref",
+                    "object": "finding",
+                    "references": "account"
+                }
+            ],
+            "PUID": {
+                "key": "user-account.x_passport_userid",
+                "object": "account"
+            },
+            "Sid": {
+                "key": "user-account.x_account_sid",
+                "object": "account"
+            },
+            "UPNSuffix": {
+                "key": "user-account.x_upn_suffix",
+                "object": "account"
+            }
+        },
+        "blob": {
+            "BlobContainer": {
+                "Name": {
+                    "key": "x-azure-blob.blob_container",
+                    "object": "blob_storage"
+                }
+            },
+            "Etag": {
+                "key": "x-azure-blob.etag",
+                "object": "blob_storage"
+            },
+            "Name": {
+                "key": "x-azure-blob.name",
+                "object": "blob_storage"
+            },
+            "Url": [
+                {
+                    "key": "url.value",
+                    "object": "blobUrl"
+                },
+                {
+                    "key": "x-azure-blob.url_ref",
+                    "object": "blob_storage",
+                    "references": "blobUrl"
+                },
+                {
+                    "group": true,
+                    "key": "x-ibm-finding.ioc_refs",
+                    "object": "finding",
+                    "references": [
+                        "blobUrl"
+                    ]
+                }
+            ]
+        },
+        "blob-container": {
+            "Name": {
+                "key": "x-azure-blob.blob_container",
+                "object": "blob_storage"
+            }
+        },
+        "container": {
+            "ContainerId": {
+                "key": "x-azure-container.container_id",
+                "object": "container"
+            },
+            "Image": {
+                "ImageId": {
+                    "key": "x-azure-container.image_id",
+                    "object": "container"
+                },
+                "Type": {
+                    "key": "x-azure-container.image_type",
+                    "object": "container"
+                }
+            }
+        },
+        "dns": {
+            "DomainName": {
+                "key": "domain-name.value",
+                "object": "domain_name"
+            },
+            "IpAdresses": {
+                "Address": [
+                    {
+                        "key": "ipv4-addr.value",
+                        "object": "ipaddress1"
+                    },
+                    {
+                        "key": "ipv6-addr.value",
+                        "object": "ipaddress1"
+                    }
+                ],
+                "groupIpReference": {
+                    "group_ref": true,
+                    "key": "domain-name.resolves_to_refs",
+                    "object": "domain_name",
+                    "references": [
+                        "ipaddress1"
+                    ]
+                },
+                "groupIpfindingReference": {
+                    "group_ref": true,
+                    "key": "x-ibm-finding.ioc_refs",
+                    "object": "finding",
+                    "references": [
+                        "ipaddress1"
+                    ]
+                }
+            }
+        },
+        "file": {
+            "Directory": [
+                {
+                    "key": "directory.path",
+                    "object": "dir_obj"
+                },
+                {
+                    "key": "file.parent_directory_ref",
+                    "object": "file_obj",
+                    "references": "dir_obj"
+                }
+            ],
+            "FileHashes": {
+                "MD5": {
+                    "key": "file.hashes.MD5",
+                    "object": "file_obj"
+                },
+                "SHA1": {
+                    "key": "file.hashes.SHA-1",
+                    "object": "file_obj"
+                },
+                "SHA256": {
+                    "key": "file.hashes.SHA-256",
+                    "object": "file_obj"
+                }
+            },
+            "Name": [
+                {
+                    "key": "file.name",
+                    "object": "file_obj"
+                },
+                {
+                    "key": "process.binary_ref",
+                    "object": "process1",
+                    "references": "file_obj"
+                },
+                {
+                    "group": true,
+                    "key": "x-ibm-finding.ioc_refs",
+                    "object": "finding",
+                    "references": [
+                        "file_obj"
+                    ]
+                }
+            ]
+        },
+        "host": {
+            "DnsDomain": {
+                "key": "x-oca-asset.x_dns_domain",
+                "object": "host"
+            },
+            "HostName": [
+                {
+                    "key": "x-oca-asset.hostname",
+                    "object": "host"
+                },
+                {
+                    "key": "x-host-logon-session.host_ref",
+                    "object": "logon_session",
+                    "references": "host"
+                }
+            ],
+            "IsDomainJoined": {
+                "key": "x-oca-asset.x_is_domain_host",
+                "object": "host"
+            },
+            "NTDomain": {
+                "key": "x-oca-asset.x_nt_domain",
+                "object": "host"
+            },
+            "NetBiosName": {
+                "key": "x-oca-asset.x_netbios_name",
+                "object": "host"
+            },
+            "OMSAgentID": {
+                "key": "x-oca-asset.x_oms_agent_id",
+                "object": "host"
+            },
+            "OSFamily": [
+                {
+                    "key": "software.name",
+                    "object": "host_software"
+                },
+                {
+                    "key": "x-oca-asset.os_ref",
+                    "object": "host",
+                    "references": "host_software"
+                },
+                {
+                    "key": "x-ibm-finding.dst_os_ref",
+                    "object": "finding",
+                    "references": "host_software"
+                }
+            ],
+            "OSVersion": {
+                "key": "software.version",
+                "object": "host_software"
+            }
+        },
+        "host-logon-session": {
+            "EndTimeUtc": {
+                "key": "x-host-logon-session.end_time",
+                "object": "logon_session"
+            },
+            "SessionId": {
+                "key": "x-host-logon-session.session_id",
+                "object": "logon_session",
+                "transformer": "HexToInteger"
+            },
+            "StartTimeUtc": {
+                "key": "x-host-logon-session.start_time",
+                "object": "logon_session"
+            }
+        },
+        "malware": {
+            "Category": {
+                "key": "x-azure-malware.category",
+                "object": "malware"
+            },
+            "Files": {
+                "file": {
+                    "Directory": [
+                        {
+                            "key": "directory.path",
+                            "object": "dir_obj"
+                        },
+                        {
+                            "key": "file.parent_directory_ref",
+                            "object": "malware_file",
+                            "references": "dir_obj"
+                        }
+                    ],
+                    "FileHashes": {
+                        "MD5": {
+                            "key": "file.hashes.MD5",
+                            "object": "malware_file"
+                        },
+                        "SHA1": {
+                            "key": "file.hashes.SHA-1",
+                            "object": "malware_file"
+                        },
+                        "SHA256": {
+                            "key": "file.hashes.SHA-256",
+                            "object": "malware_file"
+                        }
+                    },
+                    "Name": {
+                        "key": "file.name",
+                        "object": "malware_file"
+                    }
+                },
+                "groupMalwareReference": {
+                    "group_ref": true,
+                    "key": "x-azure-malware.file_refs",
+                    "object": "malware",
+                    "references": [
+                        "malware_file"
+                    ]
+                },
+                "groupfindingReference": {
+                    "group": true,
+                    "key": "x-ibm-finding.ioc_refs",
+                    "object": "finding",
+                    "references": [
+                        "malware_file"
+                    ]
+                }
+            },
+            "Name": {
+                "key": "x-azure-malware.name",
+                "object": "malware"
+            }
+        },
+        "network-connection": {
+            "DestinationPort": {
+                "key": "network-traffic.dst_port",
+                "object": "nt",
+                "transformer": "ToInteger"
+            },
+            "Protocol": {
+                "key": "network-traffic.protocols",
+                "object": "nt",
+                "transformer": "ToLowercaseArray"
+            },
+            "SourceAddress": {
+                "Address": [
+                    {
+                        "key": "ipv4-addr.value",
+                        "object": "ipaddress"
+                    },
+                    {
+                        "key": "ipv6-addr.value",
+                        "object": "ipaddress"
+                    },
+                    {
+                        "key": "network-traffic.src_ref",
+                        "object": "nt",
+                        "references": "ipaddress",
+                        "unwrap": true
+                    }
+                ],
+                "Location": {
+                    "Carrier": {
+                        "key": "x-geo-location.carrier",
+                        "object": "location"
+                    },
+                    "City": {
+                        "key": "x-geo-location.city",
+                        "object": "location"
+                    },
+                    "CountryName": [
+                        {
+                            "key": "x-geo-location.country",
+                            "object": "location"
+                        },
+                        {
+                            "key": "ipv4-addr.x_location_ref",
+                            "object": "ipaddress",
+                            "references": "location"
+                        },
+                        {
+                            "key": "ipv6-addr.x_location_ref",
+                            "object": "ipaddress",
+                            "references": "location"
+                        }
+                    ],
+                    "Latitude": {
+                        "key": "x-geo-location.latitude",
+                        "object": "location"
+                    },
+                    "Longitude": {
+                        "key": "x-geo-location.longitude",
+                        "object": "location"
+                    },
+                    "Organization": {
+                        "key": "x-geo-location.organization",
+                        "object": "location"
+                    }
+                }
+            },
+            "groupIPReference": {
+                "group_ref": true,
+                "key": "x-ibm-finding.ioc_refs",
+                "object": "finding",
+                "references": [
+                    "ipaddress"
+                ]
+            }
+        },
+        "process": {
+            "CommandLine": {
+                "key": "process.command_line",
+                "object": "process1"
+            },
+            "CreationTimeUtc": {
+                "key": "process.created",
+                "object": "process1"
+            },
+            "ElevationToken": {
+                "key": "process.x_elevation_token",
+                "object": "process1"
+            },
+            "ImageFile": {
+                "Directory": [
+                    {
+                        "key": "directory.path",
+                        "object": "dir_obj"
+                    },
+                    {
+                        "key": "file.parent_directory_ref",
+                        "object": "image_file_obj",
+                        "references": "dir_obj"
+                    }
+                ],
+                "FileHashes": {
+                    "MD5": {
+                        "key": "file.hashes.MD5",
+                        "object": "image_file_obj"
+                    },
+                    "SHA1": {
+                        "key": "file.hashes.SHA-1",
+                        "object": "image_file_obj"
+                    },
+                    "SHA256": {
+                        "key": "file.hashes.SHA-256",
+                        "object": "image_file_obj"
+                    }
+                },
+                "Name": [
+                    {
+                        "key": "file.name",
+                        "object": "image_file_obj"
+                    },
+                    {
+                        "key": "process.binary_ref",
+                        "object": "process1",
+                        "references": "image_file_obj"
+                    },
+                    {
+                        "group": true,
+                        "key": "x-ibm-finding.ioc_refs",
+                        "object": "finding",
+                        "references": [
+                            "image_file_obj"
+                        ]
+                    }
+                ]
+            },
+            "ParentProcess": {
+                "CommandLine": {
+                    "key": "process.command_line",
+                    "object": "parent_process"
+                },
+                "CreationTimeUtc": {
+                    "key": "process.created",
+                    "object": "parent_process"
+                },
+                "ElevationToken": {
+                    "key": "process.x_elevation_token",
+                    "object": "parent_process"
+                },
+                "ImageFile": {
+                    "Directory": [
+                        {
+                            "key": "directory.path",
+                            "object": "dir_obj1"
+                        },
+                        {
+                            "key": "file.parent_directory_ref",
+                            "object": "image_file_obj1",
+                            "references": "dir_obj1"
+                        }
+                    ],
+                    "FileHashes": {
+                        "MD5": {
+                            "key": "file.hashes.MD5",
+                            "object": "image_file_obj1"
+                        },
+                        "SHA1": {
+                            "key": "file.hashes.SHA-1",
+                            "object": "image_file_obj1"
+                        },
+                        "SHA256": {
+                            "key": "file.hashes.SHA-256",
+                            "object": "image_file_obj1"
+                        }
+                    },
+                    "Name": [
+                        {
+                            "key": "file.name",
+                            "object": "image_file_obj1"
+                        },
+                        {
+                            "key": "process.binary_ref",
+                            "object": "parent_process",
+                            "references": "image_file_obj1"
+                        },
+                        {
+                            "group": true,
+                            "key": "x-ibm-finding.ioc_refs",
+                            "object": "finding",
+                            "references": [
+                                "image_file_obj1"
+                            ]
+                        }
+                    ]
+                },
+                "ProcessId": [
+                    {
+                        "key": "process.pid",
+                        "object": "parent_process",
+                        "transformer": "HexToInteger"
+                    },
+                    {
+                        "key": "process.parent_ref",
+                        "object": "process1",
+                        "references": "parent_process"
+                    }
+                ]
+            },
+            "ProcessId": {
+                "key": "process.pid",
+                "object": "process1",
+                "transformer": "HexToInteger"
+            }
+        },
+        "url": {
+            "Url": [
+                {
+                    "key": "url.value",
+                    "object": "url"
+                },
+                {
+                    "group": true,
+                    "key": "x-ibm-finding.ioc_refs",
+                    "object": "finding",
+                    "references": [
+                        "url"
+                    ]
+                }
+            ]
+        }
     },
     "EventData": {
-        "key": "x-azure-security-event.event_data",
-        "object": "msevent"
+        "key": "x-oca-event.dataset",
+        "object": "event"
     },
     "EventID": {
         "key": "x-oca-event.code",
         "object": "event"
     },
-    "EventSourceName": {
-        "key": "x-ibm-finding.name",
-        "object": "finding"
-    },
-    "EventTime": {
-        "key": "x-ibm-finding.time_observed",
+    "EventOriginId": {
+        "key": "x-ibm-finding.alert_id",
         "object": "finding"
     },
-    "ExtentedProperties": {
-        "key": "x-azure-security-alert.extented_properties",
-        "object": "alert"
+    "EventSourceName": {
+        "key": "x-oca-event.provider",
+        "object": "event"
     },
-    "FileHash": [
-        {
-            "key": "file.hashes",
-            "object": "event"
-        },
-        {
-            "key": "x-oca-event.file_ref.path",
-            "object": "event"
+    "ExtendedProperties": {
+        "resourceType": {
+            "key": "x-cloud-resource.resource_type",
+            "object": "cloud_resource"
         }
-    ],
+    },
     "FilePath": [
         {
             "key": "file.path",
             "object": "file"
         },
         {
-            "key": "x-oca-event.file_ref.path",
-            "object": "file"
+            "key": "x-oca-event.file_ref",
+            "object": "event",
+            "references": "file"
+        },
+        {
+            "key": "process.binary_ref",
+            "object": "process",
+            "references": "file"
+        },
+        {
+            "key": "file.name",
+            "object": "file",
+            "transformer": "ToFileName"
+        },
+        {
+            "group": true,
+            "key": "x-ibm-finding.ioc_refs",
+            "object": "finding",
+            "references": [
+                "file"
+            ]
         }
     ],
     "FirstActivityTime": {
-        "key": "x-ibm-finding.start",
-        "object": "finding"
+        "key": "x-incident-info.first_activity",
+        "object": "incident"
     },
     "FirstModifiedTime": {
-        "key": "x-ibm-finding.start",
-        "object": "finding"
+        "key": "x-incident-info.first_modified",
+        "object": "incident"
+    },
+    "Fqbn": {
+        "key": "file.x_fqbn",
+        "object": "file"
     },
     "HomeDirectory": {
         "key": "directory.path",
         "object": "directory"
     },
     "HomePath": {
         "key": "directory.path",
         "object": "directory"
     },
-    "IncidentName": [
+    "IncidentName": {
+        "key": "x-ibm-finding.x_incident_name",
+        "object": "finding"
+    },
+    "IncidentUrl": [
         {
-            "key": "x-ibm-finding.name",
-            "object": "finding"
+            "key": "url.value",
+            "object": "url"
         },
         {
-            "key": "x-azure-security-incident.incident_name",
-            "object": "incident"
+            "key": "x-incident-info.incident_url_ref",
+            "object": "incident",
+            "references": "url"
         }
     ],
-    "IncidentUrl": [
+    "IpAddress": [
         {
-            "key": "x-oca-event.url_ref",
-            "object": "event"
+            "key": "ipv4-addr.value",
+            "object": "ipv4-addr"
         },
         {
-            "key": "url.name",
-            "object": "url"
-        }
-    ],
-    "IpAddress": [
+            "key": "ipv6-addr.value",
+            "object": "ipv4-addr"
+        },
         {
             "key": "x-ibm-finding.src_ip_ref",
-            "object": "finding"
+            "object": "finding",
+            "references": "ipv4-addr"
         },
         {
-            "key": "ipv4-addr.value",
-            "object": "ipv4-addr"
+            "group": true,
+            "key": "x-ibm-finding.ioc_refs",
+            "object": "finding",
+            "references": [
+                "ipv4-addr"
+            ]
         },
         {
+            "group": true,
             "key": "x-oca-event.ip_refs",
-            "object": "event"
+            "object": "event",
+            "references": [
+                "ipv4-addr"
+            ]
         }
     ],
     "Labels": {
-        "key": "x-azure-security-incident.labels",
+        "key": "x-incident-info.labels",
         "object": "incident"
     },
     "LastActivityTime": {
-        "key": "x-ibm-finding.end",
-        "object": "finding"
+        "key": "x-incident-info.last_active",
+        "object": "incident"
     },
     "LastModifiedTime": {
         "key": "x-ibm-finding.end",
         "object": "finding"
     },
+    "LogonGuid": {
+        "key": "x-logon-info.guid",
+        "object": "logon_info"
+    },
     "LogonProcessName": {
-        "key": "process.name",
+        "key": "x-logon-info.logon_process",
+        "object": "logon_info"
+    },
+    "LogonType": {
+        "key": "x-logon-info.logon_type",
+        "object": "logon_info"
+    },
+    "LogonTypeName": {
+        "key": "x-logon-info.logon_type_name",
+        "object": "logon_info"
+    },
+    "MD5": {
+        "key": "file.hashes.MD5",
+        "object": "file"
+    },
+    "MandatoryLabel": {
+        "key": "process.x_mandatory_label",
         "object": "process"
     },
     "MemberName": {
-        "key": "x-azure-security-event.member_name",
-        "object": "msevent"
+        "key": "x-oca-event.x_member_name",
+        "object": "event"
     },
     "ModifiedBy": {
-        "key": "x-azure-security-incident.modified_by",
-        "object": "incident"
+        "key": "x-ibm-finding.x_modified_by",
+        "object": "finding"
     },
+    "NewProcessId": [
+        {
+            "key": "process.pid",
+            "object": "process",
+            "transformer": "HexToInteger"
+        },
+        {
+            "key": "x-oca-event.process_ref",
+            "object": "event",
+            "references": "process"
+        }
+    ],
+    "NewProcessName": [
+        {
+            "key": "directory.path",
+            "object": "file_dir",
+            "transformer": "ToDirectoryPath"
+        },
+        {
+            "key": "file.name",
+            "object": "file",
+            "transformer": "ToFileName"
+        },
+        {
+            "key": "file.parent_directory_ref",
+            "object": "file",
+            "references": "file_dir"
+        },
+        {
+            "key": "process.binary_ref",
+            "object": "process",
+            "references": "file"
+        }
+    ],
     "Owner": {
-        "key": "x-azure-security-incident.owner",
-        "object": "incident"
+        "assignedTo": {
+            "key": "email-addr.display_name",
+            "object": "owner"
+        },
+        "email": {
+            "key": "email-addr.value",
+            "object": "owner"
+        },
+        "userPrincipalName": [
+            {
+                "key": "email-addr.value",
+                "object": "owner"
+            },
+            {
+                "key": "x-ibm-finding.x_owner_ref",
+                "object": "finding",
+                "references": "owner"
+            }
+        ]
     },
     "ParentProcessName": [
         {
+            "key": "directory.path",
+            "object": "file_dir1",
+            "transformer": "ToDirectoryPath"
+        },
+        {
+            "key": "file.name",
+            "object": "file1",
+            "transformer": "ToFileName"
+        },
+        {
+            "key": "file.parent_directory_ref",
+            "object": "file1",
+            "references": "file_dir1"
+        },
+        {
+            "key": "process.binary_ref",
+            "object": "parent1",
+            "references": "file1"
+        },
+        {
             "key": "process.parent_ref",
-            "object": "process"
+            "object": "process",
+            "references": "parent1"
         },
         {
             "key": "x-oca-event.parent_process_ref",
-            "object": "event"
+            "object": "event",
+            "references": "parent1"
         }
     ],
     "PreviousTime": {
         "key": "x-ibm-finding.start",
         "object": "finding"
     },
     "ProcessId": {
         "key": "process.pid",
-        "object": "process"
+        "object": "parent1",
+        "transformer": "HexToInteger"
     },
     "ProcessName": [
         {
-            "key": "process.name",
-            "object": "process"
+            "key": "directory.path",
+            "object": "file_dir1",
+            "transformer": "ToDirectoryPath"
         },
         {
-            "key": "x-oca-event.process_ref",
-            "object": "event"
+            "key": "file.name",
+            "object": "file1",
+            "transformer": "ToFileName"
+        },
+        {
+            "key": "file.parent_directory_ref",
+            "object": "file1",
+            "references": "file_dir1"
+        },
+        {
+            "key": "process.binary_ref",
+            "object": "parent1",
+            "references": "file1"
         }
     ],
     "ProcessingEndTime": {
-        "key": "x-ibm-finding.end",
+        "key": "x-ibm-finding.x_processing_endtime",
         "object": "finding"
     },
-    "ProductName": {
-        "key": "x-azure-security-alert.product_name",
-        "object": "alert"
+    "ProductComponentName": {
+        "key": "software.x_product_component_name",
+        "object": "product_info"
+    },
+    "ProductName": [
+        {
+            "key": "software.name",
+            "object": "product_info"
+        },
+        {
+            "key": "x-ibm-finding.dst_application_ref",
+            "object": "finding",
+            "references": "product_info"
+        }
+    ],
+    "ProviderIncidentId": {
+        "key": "x-ibm-finding.x_provider_incident_id",
+        "object": "finding"
     },
     "ProviderName": {
-        "key": "x-oca-event.provider",
-        "object": "event"
+        "key": "software.x_provider_name",
+        "object": "product_info"
+    },
+    "ProviderNameIncident": {
+        "key": "x-ibm-finding.x_provider_name",
+        "object": "finding"
     },
     "QuarantineHelpURL": [
         {
-            "key": "x-oca-event.url_ref",
-            "object": "event"
+            "key": "url.value",
+            "object": "help_url"
         },
         {
-            "key": "url.name",
-            "object": "url"
+            "key": "x-oca-event.url_ref",
+            "object": "event",
+            "references": "help_url"
         }
     ],
+    "RelatedAnalyticRuleIds": {
+        "key": "x-ibm-finding.rule_names",
+        "object": "finding"
+    },
+    "RemediationSteps": {
+        "key": "x-ibm-finding.x_remediationsteps",
+        "object": "finding"
+    },
     "Requester": {
-        "key": "x-azure-security-event.requester",
-        "object": "msevent"
+        "key": "x-oca-event.x_requester",
+        "object": "event"
+    },
+    "ResourceId": {
+        "key": "x-cloud-resource.resource_id",
+        "object": "cloud_resource"
+    },
+    "SHA1": {
+        "key": "file.hashes.SHA-1",
+        "object": "file"
+    },
+    "SHA256": {
+        "key": "file.hashes.SHA-256",
+        "object": "file"
     },
     "ServiceFileName": {
-        "key": "x-oca-event.file_ref.service",
+        "key": "x-oca-event.x_service_file",
         "object": "event"
     },
     "ServiceName": {
-        "key": "x-azure-security-event.service_name",
-        "object": "msevent"
+        "key": "x-oca-event.x_service_name",
+        "object": "event"
     },
     "Severity": {
-        "key": "x-azure-security-incident.severity",
-        "object": "incident"
+        "key": "x-ibm-finding.severity",
+        "object": "finding",
+        "transformer": "ConvertSeverityToScore"
     },
-    "SourceSystem": {
-        "key": "x-azure-security-event.source",
-        "object": "msevent"
+    "SourceComputerId": {
+        "key": "x-oca-asset.device_id",
+        "object": "asset"
     },
     "StartTime": {
         "key": "x-ibm-finding.start",
         "object": "finding"
     },
     "Status": {
-        "key": "x-azure-security-alert.status",
-        "object": "alert"
+        "key": "x-ibm-finding.x_status",
+        "object": "finding"
+    },
+    "SubjectAccount": {
+        "key": "user-account.account_login",
+        "object": "subject"
+    },
+    "SubjectDomainName": {
+        "key": "user-account.x_domain_name",
+        "object": "subject"
+    },
+    "SubjectLogonId": {
+        "key": "user-account.x_login_id",
+        "object": "subject",
+        "transformer": "HexToInteger"
+    },
+    "SubjectUserName": [
+        {
+            "key": "user-account.user_id",
+            "object": "subject"
+        },
+        {
+            "key": "user-account.display_name",
+            "object": "subject"
+        },
+        {
+            "key": "x-ibm-finding.dst_application_user_ref",
+            "object": "finding",
+            "references": "subject"
+        }
+    ],
+    "SubjectUserSid": {
+        "key": "user-account.x_user_sid",
+        "object": "subject"
     },
     "SystemAlertId": {
-        "key": "x-azure-security-alert.cloudAppStates.system_alertid",
-        "object": "alert"
+        "key": "x-ibm-finding.x_system_alert_id",
+        "object": "finding"
     },
-    "TargetDomainName": {
-        "key": "domain-name.value",
-        "object": "domain-name"
+    "Tactics": {
+        "key": "x-ibm-ttp-tagging.extensions.mitre-attack-ext.tactic_name",
+        "object": "ttp_finding"
     },
-    "TargetUserName": {
+    "TargetAccount": {
         "key": "user-account.account_login",
-        "object": "user-account"
+        "object": "target-account"
+    },
+    "TargetDomainName": {
+        "key": "user-account.x_domain_name",
+        "object": "target-account"
+    },
+    "TargetLogonId": {
+        "key": "user-account.x_login_id",
+        "object": "target-account",
+        "transformer": "HexToInteger"
+    },
+    "TargetServerName": {
+        "key": "x-ibm-finding.dst_device",
+        "object": "finding"
+    },
+    "TargetSid": {
+        "key": "x-oca-event.x_modified_account_sid",
+        "object": "event"
+    },
+    "TargetUserName": [
+        {
+            "key": "user-account.user_id",
+            "object": "target-account"
+        },
+        {
+            "key": "user-account.display_name",
+            "object": "target-account"
+        },
+        {
+            "key": "x-ibm-finding.src_application_user_ref",
+            "object": "finding",
+            "references": "target-account"
+        },
+        {
+            "key": "x-oca-event.user_ref",
+            "object": "event",
+            "references": "target-account"
+        }
+    ],
+    "TargetUserSid": {
+        "key": "user-account.x_user_sid",
+        "object": "target-account"
     },
     "Task": {
-        "key": "x-azure-security-event.task",
-        "object": "msevent"
+        "key": "x-oca-event.x_task",
+        "object": "event"
+    },
+    "Tasks": {
+        "key": "x-incident-info.tasks",
+        "object": "incident"
+    },
+    "Techniques": {
+        "key": "x-ibm-ttp-tagging.extensions.mitre-attack-ext.technique_name",
+        "object": "ttp_finding"
     },
     "TenantId": {
-        "key": "x-azure-security-alert.tenant_id",
-        "object": "alert"
+        "key": "x-cloud-provider.tenant_id",
+        "object": "cloud_info"
+    },
+    "TimeCollected": [
+        {
+            "key": "x-oca-event.created",
+            "object": "event",
+            "transformer": "TimestampConversion"
+        },
+        {
+            "key": "x-oca-event.modified",
+            "object": "event",
+            "transformer": "TimestampConversion"
+        }
+    ],
+    "TimeGenerated": {
+        "key": "x-ibm-finding.time_observed",
+        "object": "finding"
     },
-    "TimeGenerated": [
+    "Title": [
         {
-            "key": "x-ibm-finding.start",
+            "key": "x-ibm-finding.name",
             "object": "finding"
         },
         {
-            "key": "x-oca-event.created",
-            "object": "event"
+            "key": "x-ibm-ttp-tagging.name",
+            "object": "ttp_finding"
         },
         {
-            "key": "x-ibm-finding.time_observed",
-            "object": "finding"
+            "group": true,
+            "key": "x-ibm-finding.ttp_tagging_refs",
+            "object": "finding",
+            "references": [
+                "ttp_finding"
+            ]
         }
     ],
-    "Title": {
-        "key": "x-azure-security-event.title",
-        "object": "msevent"
-    },
-    "UserParameter": {
-        "key": "x-azure-security-event.user_parameter",
-        "object": "msevent"
+    "TokenElevationType": {
+        "key": "process.x_token_elevation_type",
+        "object": "process"
+    },
+    "Type": {
+        "key": "x-ibm-finding.finding_type",
+        "object": "finding",
+        "transformer": "ConvertToFindingType"
+    },
+    "UserParameters": {
+        "key": "x-oca-event.x_user_parameter",
+        "object": "event"
     },
     "VendorName": {
-        "key": "x-azure-security-alert.vendor_name",
-        "object": "alert"
+        "key": "software.vendor",
+        "object": "product_info"
     },
-    "WorkspaceResourceGroup": {
-        "key": "x-azure-security-alert.workspace_resource_group",
-        "object": "alert"
-    },
-    "WorkspaceSubscriptionId": {
-        "key": "x-azure-security-alert.subscription_id",
-        "object": "alert"
+    "VendorOriginalId": {
+        "key": "x-ibm-finding.alert_id",
+        "object": "finding"
     },
-    "_ResourceId": {
-        "key": "x-azure-security-alert.resourceId",
-        "object": "alert"
+    "WorkstationName": {
+        "key": "x-ibm-finding.dst_device",
+        "object": "finding"
     },
-    "eventId": {
-        "key": "x-azure-security-event.event_id",
-        "object": "msevent"
+    "_ResourceId": {
+        "key": "x-cloud-resource.resource_id",
+        "object": "cloud_resource"
     }
 }
```

## stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/SecurityAlert_from_stix_map.json

### Pretty-printed

 * *Similarity: 0.0339170692431562%*

 * *Differences: {"'directory'": "OrderedDict([('fields', OrderedDict([('path', ['Entities.Directory'])]))])",*

 * * "'domain-name'": "OrderedDict([('fields', OrderedDict([('value', ['Entities.DomainName'])]))])",*

 * * "'file'": "OrderedDict([('fields', OrderedDict([('name', ['Entities.Name']), "*

 * *           '("hashes.\'SHA-256\'", [\'Entities.Value\']), ("hashes.\'SHA-1\'", '*

 * *           "['Entities.Value']), ('hashes.MD5', ['Entities.Value']), ('parent_directory_ref.path', "*

 * *           "['Entities.Directory'])]))])",*

 * * "'ipv4-addr'": [â€¦]*

```diff
@@ -1,83 +1,426 @@
 {
-    "x-ibm-finding": {
+    "directory": {
         "fields": {
-            "end": [
-                "EndTime",
-                "ProcessingEndTime"
+            "path": [
+                "Entities.Directory"
+            ]
+        }
+    },
+    "domain-name": {
+        "fields": {
+            "value": [
+                "Entities.DomainName"
+            ]
+        }
+    },
+    "file": {
+        "fields": {
+            "hashes.'SHA-1'": [
+                "Entities.Value"
+            ],
+            "hashes.'SHA-256'": [
+                "Entities.Value"
+            ],
+            "hashes.MD5": [
+                "Entities.Value"
             ],
             "name": [
-                "AlertName"
+                "Entities.Name"
             ],
-            "start": [
-                "StartTime",
-                "TimeGenerated"
+            "parent_directory_ref.path": [
+                "Entities.Directory"
+            ]
+        }
+    },
+    "ipv4-addr": {
+        "fields": {
+            "value": [
+                "Entities.Address"
             ],
-            "time_observed": [
-                "TimeGenerated",
-                "EventTime"
+            "x_location_ref.carrier": [
+                "Entities.Location.Carrier"
+            ],
+            "x_location_ref.city": [
+                "Entities.Location.City"
+            ],
+            "x_location_ref.country": [
+                "Entities.Location.CountryName"
+            ],
+            "x_location_ref.latitude": [
+                "Entities.Location.Latitude"
+            ],
+            "x_location_ref.longitude": [
+                "Entities.Location.Longitude"
+            ],
+            "x_location_ref.organization": [
+                "Entities.Location.Organization"
             ]
         }
     },
-    "x-msazure-sentinel-alert": {
+    "ipv6-addr": {
         "fields": {
-            "alert_severity": [
-                "AlertSeverity"
+            "value": [
+                "Entities.Address"
             ],
-            "compromised_entity": [
-                "CompromisedEntity"
+            "x_location_ref.carrier": [
+                "Entities.Location.Carrier"
             ],
-            "confidence_level": [
-                "ConfidenceLevel"
+            "x_location_ref.city": [
+                "Entities.Location.City"
             ],
-            "description": [
-                "Description"
+            "x_location_ref.country": [
+                "Entities.Location.CountryName"
             ],
-            "display_name": [
-                "DisplayName"
+            "x_location_ref.latitude": [
+                "Entities.Location.Latitude"
+            ],
+            "x_location_ref.longitude": [
+                "Entities.Location.Longitude"
+            ],
+            "x_location_ref.organization": [
+                "Entities.Location.Organization"
+            ]
+        }
+    },
+    "network-traffic": {
+        "fields": {
+            "dst_port": [
+                "Entities.DestinationPort"
+            ],
+            "protocols[*]": [
+                "Entities.Protocol"
+            ],
+            "src_ref.value": [
+                "Entities.Address"
+            ]
+        }
+    },
+    "process": {
+        "fields": {
+            "binary_ref.hashes.'SHA-256'": [
+                "Entities.Value"
+            ],
+            "binary_ref.hashes.'SHA1'": [
+                "Entities.Value"
             ],
-            "entities": [
-                "Entities"
+            "binary_ref.hashes.MD5": [
+                "Entities.Value"
+            ],
+            "command_line": [
+                "Entities.CommandLine"
+            ],
+            "created": [
+                "Entities.CreationTimeUtc"
             ],
-            "extented_properties": [
-                "ExtentedProperties"
+            "creator_user_ref.user_id": [
+                "Entities.Name"
             ],
-            "product_name": [
+            "parent_ref.binary_ref.hashes.'SHA-256'": [
+                "Entities.Value"
+            ],
+            "parent_ref.binary_ref.hashes.'SHA1'": [
+                "Entities.Value"
+            ],
+            "parent_ref.binary_ref.hashes.MD5": [
+                "Entities.Value"
+            ],
+            "parent_ref.command_line": [
+                "Entities.CommandLine"
+            ],
+            "parent_ref.pid": [
+                "Entities.ProcessId"
+            ],
+            "pid": [
+                "Entities.ProcessId"
+            ],
+            "x_elevation_token": [
+                "Entities.ElevationToken"
+            ]
+        }
+    },
+    "software": {
+        "fields": {
+            "name": [
+                "Entities.OSFamily",
                 "ProductName"
             ],
-            "resourceId": [
-                "_ResourceId"
+            "vendor": [
+                "VendorName"
             ],
-            "status": [
-                "Status"
+            "version": [
+                "Entities.OSVersion"
             ],
-            "subscription_id": [
-                "WorkspaceSubscriptionId"
+            "x_product_component_name": [
+                "ProductComponentName"
             ],
-            "system_alertid": [
-                "SystemAlertId"
+            "x_provider_name": [
+                "ProviderName"
+            ]
+        }
+    },
+    "url": {
+        "fields": {
+            "value": [
+                "Entities.Url"
+            ]
+        }
+    },
+    "user-account": {
+        "fields": {
+            "display_name": [
+                "Entities.DisplayName"
             ],
+            "user_id": [
+                "Entities.Name"
+            ],
+            "x_aad_user_id": [
+                "Entities.AadUserId"
+            ],
+            "x_account_sid": [
+                "Entities.Sid"
+            ],
+            "x_dns_domain": [
+                "Entities.DnsDomain"
+            ],
+            "x_is_domain_account": [
+                "Entities.IsDomainJoined"
+            ],
+            "x_nt_domain": [
+                "Entities.NTDomain"
+            ],
+            "x_passport_userid": [
+                "Entities.PUID"
+            ],
+            "x_upn_suffix": [
+                "Entities.UPNSuffix"
+            ]
+        }
+    },
+    "x-azure-blob": {
+        "fields": {
+            "blob_container": [
+                "Entities.Name"
+            ],
+            "etag": [
+                "Entities.Etag"
+            ],
+            "name": [
+                "Entities.Name"
+            ]
+        }
+    },
+    "x-azure-container": {
+        "fields": {
+            "container_id": [
+                "Entities.ContainerId"
+            ],
+            "image_id": [
+                "Entities.ImageId"
+            ],
+            "image_type": [
+                "Entities.Type"
+            ]
+        }
+    },
+    "x-azure-malware": {
+        "fields": {
+            "category": [
+                "Entities.Category"
+            ],
+            "name": [
+                "Entities.Name"
+            ]
+        }
+    },
+    "x-cloud-provider": {
+        "fields": {
             "tenant_id": [
                 "TenantId"
+            ]
+        }
+    },
+    "x-cloud-resource": {
+        "fields": {
+            "resource_id": [
+                "ResourceId"
             ],
-            "vendor_name": [
-                "VendorName"
+            "resource_type": [
+                "ExtendedProperties.resourceType"
+            ]
+        }
+    },
+    "x-geo-location": {
+        "fields": {
+            "carrier": [
+                "Entities.Location.Carrier"
+            ],
+            "city": [
+                "Entities.Location.City"
+            ],
+            "country": [
+                "Entities.Location.CountryName"
             ],
-            "workspace_resource_group": [
-                "WorkspaceResourceGroup"
+            "latitude": [
+                "Entities.Location.Latitude"
+            ],
+            "longitude": [
+                "Entities.Location.Longitude"
+            ],
+            "organization": [
+                "Entities.Location.Organization"
             ]
         }
     },
-    "x-oca-event": {
+    "x-host-logon-session": {
         "fields": {
-            "created": [
+            "end_time": [
+                "Entities.EndTimeUtc"
+            ],
+            "session_id": [
+                "Entities.SessionId"
+            ],
+            "start_time": [
+                "Entities.StartTimeUtc"
+            ]
+        }
+    },
+    "x-ibm-finding": {
+        "fields": {
+            "alert_id": [
+                "VendorOriginalId"
+            ],
+            "confidence": [
+                "ConfidenceScore"
+            ],
+            "description": [
+                "Description"
+            ],
+            "dst_application_ref.name": [
+                "ProductName"
+            ],
+            "dst_application_ref.vendor": [
+                "VendorName"
+            ],
+            "dst_os_ref.name": [
+                "Entities.OSFamily"
+            ],
+            "dst_os_ref.version": [
+                "Entities.OSVersion"
+            ],
+            "dst_os_user_ref.user_id": [
+                "Entities.Name"
+            ],
+            "end": [
+                "EndTime"
+            ],
+            "finding_type": [
+                "Type"
+            ],
+            "ioc_refs[*].value": [
+                "Entities.Name",
+                "Entities.Address",
+                "Entities.Url",
+                "Entities.DomainName"
+            ],
+            "name": [
+                "AlertName"
+            ],
+            "start": [
+                "StartTime"
+            ],
+            "time_observed": [
                 "TimeGenerated"
             ],
-            "domain_ref": [
-                "DomainName"
+            "ttp_tagging_refs[*].confidence": [
+                "ConfidenceScore"
             ],
-            "provider": [
-                "ProviderName"
+            "ttp_tagging_refs[*].extensions.'mitre-attack-ext'.tactic_name": [
+                "Tactics"
+            ],
+            "ttp_tagging_refs[*].extensions.'mitre-attack-ext'.technique_name": [
+                "Techniques"
+            ],
+            "ttp_tagging_refs[*].name": [
+                "AlertName"
+            ],
+            "x_alert_link": [
+                "AlertLink"
+            ],
+            "x_alert_type": [
+                "AlertType"
+            ],
+            "x_compromised_entity": [
+                "CompromisedEntity"
+            ],
+            "x_confidence_level": [
+                "ConfidenceLevel"
+            ],
+            "x_processing_endtime": [
+                "ProcessingEndTime"
+            ],
+            "x_remediationsteps": [
+                "RemediationSteps"
+            ],
+            "x_severity": [
+                "AlertSeverity"
+            ],
+            "x_status": [
+                "Status"
+            ],
+            "x_system_alert_id": [
+                "SystemAlertId"
+            ]
+        }
+    },
+    "x-ibm-ttp-tagging": {
+        "fields": {
+            "confidence": [
+                "ConfidenceScore"
+            ],
+            "extensions.'mitre-attack-ext'.tactic_name": [
+                "Tactics"
+            ],
+            "extensions.'mitre-attack-ext'.technique_name": [
+                "Techniques"
+            ],
+            "name": [
+                "AlertName"
+            ]
+        }
+    },
+    "x-k8s-cluster": {
+        "fields": {
+            "name": [
+                "Entities.Name"
+            ]
+        }
+    },
+    "x-oca-asset": {
+        "fields": {
+            "hostname": [
+                "Entities.HostName"
+            ],
+            "os_ref.name": [
+                "Entities.OSFamily"
+            ],
+            "os_ref.version": [
+                "Entities.OSVersion"
+            ],
+            "x_is_domain_host": [
+                "Entities.IsDomainJoined"
+            ],
+            "x_netbios_name": [
+                "Entities.NetBiosName"
+            ],
+            "x_nt_domain": [
+                "Entities.NTDomain"
+            ],
+            "x_oms_agent_id": [
+                "Entities.OMSAgentID"
+            ],
+            "x_resource_id": [
+                "ResourceId"
             ]
         }
     }
 }
```

## stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/SecurityEvent_from_stix_map.json

### Pretty-printed

 * *Similarity: 0.49364468864468863%*

 * *Differences: {"'directory'": "{'fields': {'path': {insert: [(2, 'ProcessName'), (3, 'ParentProcessName'), (4, "*

 * *                "'NewProcessName')]}}}",*

 * * "'file'": '{\'fields\': {\'name\': [\'FilePath\'], "hashes.\'SHA-256\'": [\'FileHash\'], '*

 * *           '\'hashes.MD5\': [\'FileHash\'], "hashes.\'SHA-1\'": [\'FileHash\'], '*

 * *           "'parent_directory_ref': ['ProcessName', 'ParentProcessName'], 'x_fqbn': ['Fqbn'], "*

 * *           "delete: ['hashes']}}",*

 * * "'ipv4-addr'": "{'fields': {'value': {insert: [(1, 'ClientIPAddres [â€¦]*

```diff
@@ -1,171 +1,260 @@
 {
     "directory": {
         "fields": {
             "path": [
                 "HomeDirectory",
-                "HomePath"
-            ]
-        }
-    },
-    "domain-name": {
-        "fields": {
-            "value": [
-                "TargetDomainName"
+                "HomePath",
+                "ProcessName",
+                "ParentProcessName",
+                "NewProcessName"
             ]
         }
     },
     "file": {
         "fields": {
-            "hashes": [
+            "hashes.'SHA-1'": [
                 "FileHash"
             ],
+            "hashes.'SHA-256'": [
+                "FileHash"
+            ],
+            "hashes.MD5": [
+                "FileHash"
+            ],
+            "name": [
+                "FilePath"
+            ],
+            "parent_directory_ref": [
+                "ProcessName",
+                "ParentProcessName"
+            ],
             "path": [
                 "FilePath"
+            ],
+            "x_fqbn": [
+                "Fqbn"
             ]
         }
     },
     "ipv4-addr": {
         "fields": {
             "value": [
-                "IpAddress"
+                "IpAddress",
+                "ClientIPAddress"
+            ]
+        }
+    },
+    "ipv6-addr": {
+        "fields": {
+            "value": [
+                "IpAddress",
+                "ClientIPAddress"
             ]
         }
     },
     "process": {
         "fields": {
             "command_line": [
                 "CommandLine"
             ],
-            "name": [
-                "ProcessName",
-                "LogonProcessName"
-            ],
             "parent_ref.name": [
                 "ParentProcessName"
             ],
             "pid": [
-                "ProcessId"
+                "ProcessId",
+                "NewProcessId"
+            ],
+            "x_mandatory_label": [
+                "MandatoryLabel"
+            ],
+            "x_token_elevation_type": [
+                "TokenElevationType"
             ]
         }
     },
     "url": {
         "fields": {
             "value": [
                 "QuarantineHelpURL"
             ]
         }
     },
     "user-account": {
         "fields": {
             "account_login": [
-                "TargetUserName"
+                "TargetAccount",
+                "SubjectAccount"
+            ],
+            "display_name": [
+                "TargetUserName",
+                "SubjectUserName"
+            ],
+            "user_id": [
+                "TargetUserName",
+                "SubjectUserName"
+            ],
+            "x_domain_name": [
+                "TargetDomainName",
+                "SubjectDomainName"
+            ],
+            "x_login_id": [
+                "TargetLogonId",
+                "SubjectLogonId"
+            ],
+            "x_user_sid": [
+                "TargetUserSid",
+                "SubjectUserSid"
+            ]
+        }
+    },
+    "x-cloud-resource": {
+        "fields": {
+            "resource_id": [
+                "_ResourceId"
             ]
         }
     },
     "x-ibm-finding": {
         "fields": {
-            "code": [
-                "EventID"
+            "alert_id": [
+                "EventOriginId"
             ],
-            "dst_ip_ref": [
-                "ClientIPAddress"
+            "dst_application_user_ref": [
+                "SubjectUserName"
             ],
-            "end": [
-                "PreviousTime"
+            "dst_device": [
+                "WorkstationName",
+                "TargetServerName"
+            ],
+            "finding_type": [
+                "Type"
+            ],
+            "ioc_refs": [
+                "FilePath",
+                "IpAddress",
+                "ClientIPAddress"
             ],
             "name": [
-                "EventSourceName"
+                "Activity"
+            ],
+            "src_application_user_ref": [
+                "TargetUserName"
             ],
             "src_ip_ref": [
                 "IpAddress"
             ],
             "start": [
-                "TimeGenerated"
+                "PreviousTime"
             ],
             "time_observed": [
                 "TimeGenerated"
             ]
         }
     },
-    "x-msazure-sentinel-event": {
+    "x-logon-info": {
         "fields": {
-            "activity": [
-                "Activity"
+            "authentication_package_name": [
+                "AuthenticationPackageName"
             ],
-            "alert_type": [
-                "AlertName"
+            "guid": [
+                "LogonGuid"
             ],
-            "computer": [
-                "Computer"
-            ],
-            "device_name": [
-                "DeviceId"
-            ],
-            "event_data": [
-                "EventData"
-            ],
-            "member_name": [
-                "MemberName"
-            ],
-            "requester": [
-                "Requester"
-            ],
-            "service_name": [
-                "ServiceName"
-            ],
-            "source": [
-                "SourceSystem"
-            ],
-            "task": [
-                "Task"
+            "logon_process": [
+                "LogonProcessName"
             ],
-            "text": [
-                "Description",
-                "DeviceDescription"
+            "logon_type": [
+                "LogonType"
             ],
-            "title": [
-                "Title"
+            "logon_type_name": [
+                "LogonTypeName"
+            ]
+        }
+    },
+    "x-oca-asset": {
+        "fields": {
+            "device_id": [
+                "DeviceId",
+                "SourceComputerId"
             ],
-            "user_parameter": [
-                "UserParameter"
+            "hostname": [
+                "Computer"
             ]
         }
     },
     "x-oca-event": {
         "fields": {
             "code": [
                 "EventID"
             ],
             "created": [
-                "TimeGenerated"
+                "TimeCollected"
+            ],
+            "dataset": [
+                "EventData"
             ],
             "file_ref.hash": [
                 "FileHash"
             ],
             "file_ref.path": [
                 "FilePath"
             ],
-            "file_ref.service": [
-                "ServiceFileName"
+            "host_ref": [
+                "Computer"
             ],
-            "ip_refs.clientIp": [
+            "ip_refs.ip": [
+                "IpAddress",
                 "ClientIPAddress"
             ],
-            "ip_refs.ip": [
-                "IpAddress"
+            "modified": [
+                "TimeCollected"
+            ],
+            "module": [
+                "Channel"
             ],
             "parent_process_ref": [
                 "ParentProcessName"
             ],
             "process_ref": [
+                "NewProcessName",
+                "Process",
                 "ProcessName"
             ],
             "provider": [
-                "Account"
+                "EventSourceName"
             ],
             "url_ref": [
                 "QuarantineHelpURL"
+            ],
+            "user_ref": [
+                "TargetUserName"
+            ],
+            "x_action": [
+                "Activity"
+            ],
+            "x_description": [
+                "DeviceDescription"
+            ],
+            "x_member_name": [
+                "MemberName"
+            ],
+            "x_modified_account_sid": [
+                "TargetSid"
+            ],
+            "x_requester": [
+                "Requester"
+            ],
+            "x_service_file_ref": [
+                "ServiceFileName"
+            ],
+            "x_service_name": [
+                "ServiceName"
+            ],
+            "x_task": [
+                "Task"
+            ],
+            "x_user_parameter": [
+                "UserParameters"
             ]
         }
     }
 }
```

## stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/SecurityIncident_from_stix_map.json

### Pretty-printed

 * *Similarity: 0.22253787878787878%*

 * *Differences: {"'email-addr'": "OrderedDict([('fields', OrderedDict([('value', ['Owner.email', "*

 * *                 "'Owner.userPrincipalName']), ('display_name', ['Owner.assignedTo'])]))])",*

 * * "'x-cloud-provider'": "OrderedDict([('fields', OrderedDict([('tenant_id', ['TenantId'])]))])",*

 * * "'x-ibm-finding'": "{'fields': {'start': ['CreatedTime'], 'end': {delete: [1, 0]}, 'name': "*

 * *                    "['Title'], 'description': ['Description'], 'x_severity': ['Severity'], "*

 * *                    "'finding_type': ['Type'], 'rule [â€¦]*

```diff
@@ -1,79 +1,150 @@
 {
+    "email-addr": {
+        "fields": {
+            "display_name": [
+                "Owner.assignedTo"
+            ],
+            "value": [
+                "Owner.email",
+                "Owner.userPrincipalName"
+            ]
+        }
+    },
     "url": {
         "fields": {
             "value": [
                 "IncidentUrl"
             ]
         }
     },
+    "x-cloud-provider": {
+        "fields": {
+            "tenant_id": [
+                "TenantId"
+            ]
+        }
+    },
     "x-ibm-finding": {
         "fields": {
+            "description": [
+                "Description"
+            ],
             "end": [
-                "ClosedTime",
-                "LastActivityTime",
                 "LastModifiedTime"
             ],
+            "finding_type": [
+                "Type"
+            ],
             "name": [
-                "IncidentName"
+                "Title"
+            ],
+            "rule_names[*]": [
+                "RelatedAnalyticRuleIds"
             ],
             "start": [
-                "FirstActivityTime",
-                "FirstModifiedTime",
-                "TimeGenerated"
+                "CreatedTime"
             ],
             "time_observed": [
                 "TimeGenerated"
-            ]
-        }
-    },
-    "x-msazure-sentinel-incident": {
-        "fields": {
-            "additional_data": [
-                "AdditionalData"
             ],
-            "alertids": [
-                "AlertIds"
+            "ttp_tagging_refs[*].extensions.'mitre-attack-ext'.tactic_name": [
+                "AdditionalData.tactics"
             ],
-            "classification": [
-                "Classification"
+            "ttp_tagging_refs[*].extensions.'mitre-attack-ext'.technique_name": [
+                "AdditionalData.techniques"
             ],
-            "comments": [
-                "Comments"
+            "ttp_tagging_refs[*].name": [
+                "Title"
             ],
-            "description": [
-                "Description"
+            "x_alert_count": [
+                "AdditionalData.alertsCount"
             ],
-            "incident_name": [
-                "IncidentName"
+            "x_alert_ids[*]": [
+                "AlertIds"
             ],
-            "labels": [
-                "Labels"
+            "x_alert_product_names": [
+                "AdditionalData.alertProductNames"
+            ],
+            "x_incident_name": [
+                "IncidentName"
             ],
-            "modified_by": [
+            "x_modified_by": [
                 "ModifiedBy"
             ],
-            "owner": [
-                "Owner"
+            "x_owner_ref": [
+                "Owner.email",
+                "Owner.userPrincipalName",
+                "Owner.assignedTo"
+            ],
+            "x_owner_ref.display_name": [
+                "Owner.assignedTo"
+            ],
+            "x_owner_ref.value": [
+                "Owner.email",
+                "Owner.userPrincipalName"
             ],
-            "severity": [
+            "x_provider_incident_id": [
+                "ProviderIncidentId"
+            ],
+            "x_provider_name": [
+                "ProviderName"
+            ],
+            "x_severity": [
                 "Severity"
+            ],
+            "x_status": [
+                "Status"
             ]
         }
     },
-    "x-oca-event": {
+    "x-ibm-ttp-tagging": {
         "fields": {
-            "created": [
-                "CreatedTime"
+            "extensions.'mitre-attack-ext'.tactic_name": [
+                "AdditionalData.tactics"
             ],
-            "domain_ref": [
-                "DomainName"
+            "extensions.'mitre-attack-ext'.technique_name": [
+                "AdditionalData.techniques"
             ],
-            "provider": [
-                "ProviderName"
+            "name": [
+                "Title"
+            ]
+        }
+    },
+    "x-incident-info": {
+        "fields": {
+            "classification": [
+                "Classification"
+            ],
+            "classification_comment": [
+                "ClassificationComment"
+            ],
+            "classification_reason": [
+                "ClassificationReason"
+            ],
+            "closed_time": [
+                "ClosedTime"
+            ],
+            "comments": [
+                "Comments"
             ],
-            "url_ref": [
+            "first_activity": [
+                "FirstActivityTime"
+            ],
+            "first_modified": [
+                "FirstModifiedTime"
+            ],
+            "incident_url_ref.value": [
                 "IncidentUrl"
+            ],
+            "labels": [
+                "Labels"
+            ],
+            "last_active": [
+                "LastActivityTime"
+            ],
+            "tasks": [
+                "Tasks"
             ]
         }
     }
 }
```

## stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/to_stix_map.json

### Pretty-printed

 * *Similarity: 0.3674449233716475%*

 * *Differences: {"'Activity'": "[OrderedDict([('key', 'x-oca-event.x_action'), ('object', 'event')]), "*

 * *               "OrderedDict([('key', 'x-ibm-finding.name'), ('object', 'finding')])]",*

 * * "'AdditionalData'": "{replace: OrderedDict([('alertsCount', OrderedDict([('key', "*

 * *                     "'x-ibm-finding.x_alert_count'), ('object', 'finding')])), "*

 * *                     "('alertProductNames', OrderedDict([('key', "*

 * *                     "'x-ibm-finding.x_alert_product_names'), ('object', 'finding')])), "*

 * *               [â€¦]*

```diff
@@ -1,368 +1,1277 @@
 {
-    "Account": {
-        "key": "x-oca-event.provider",
-        "object": "event"
-    },
-    "Activity": {
-        "key": "x-azure-security-event.activity",
-        "object": "msevent"
-    },
+    "Activity": [
+        {
+            "key": "x-oca-event.x_action",
+            "object": "event"
+        },
+        {
+            "key": "x-ibm-finding.name",
+            "object": "finding"
+        }
+    ],
     "AdditionalData": {
-        "key": "x-azure-security-incident.additional_data",
-        "object": "incident"
+        "alertProductNames": {
+            "key": "x-ibm-finding.x_alert_product_names",
+            "object": "finding"
+        },
+        "alertsCount": {
+            "key": "x-ibm-finding.x_alert_count",
+            "object": "finding"
+        },
+        "tactics": {
+            "key": "x-ibm-ttp-tagging.extensions.mitre-attack-ext.tactic_name",
+            "object": "ttp_finding"
+        },
+        "techniques": {
+            "key": "x-ibm-ttp-tagging.extensions.mitre-attack-ext.technique_name",
+            "object": "ttp_finding"
+        }
     },
     "AlertIds": {
-        "key": "x-azure-security-incident.alertids",
-        "object": "incident"
+        "key": "x-ibm-finding.x_alert_ids",
+        "object": "finding"
+    },
+    "AlertLink": {
+        "key": "x-ibm-finding.x_alert_link",
+        "object": "finding"
     },
     "AlertName": [
         {
             "key": "x-ibm-finding.name",
             "object": "finding"
         },
         {
-            "key": "x-azure-security-event.alert_type",
-            "object": "msevent"
+            "key": "x-ibm-ttp-tagging.name",
+            "object": "ttp_finding"
+        },
+        {
+            "key": "x-ibm-finding.ttp_tagging_refs",
+            "object": "finding",
+            "references": [
+                "ttp_finding"
+            ]
         }
     ],
     "AlertSeverity": {
-        "key": "x-azure-security-alert.alert_severity",
-        "object": "alert"
+        "key": "x-ibm-finding.x_severity",
+        "object": "finding",
+        "transformer": "ConvertSeverityToScore"
+    },
+    "AlertType": {
+        "key": "x-ibm-finding.x_alert_type",
+        "object": "finding"
+    },
+    "AuthenticationPackageName": {
+        "key": "x-logon-info.authentication_package_name",
+        "object": "logon_info"
+    },
+    "Channel": {
+        "key": "x-oca-event.module",
+        "object": "event"
+    },
+    "Classification": {
+        "key": "x-incident-info.classification",
+        "object": "incident"
+    },
+    "ClassificationComment": {
+        "key": "x-incident-info.classification_comment",
+        "object": "incident"
+    },
+    "ClassificationReason": {
+        "key": "x-incident-info.classification_reason",
+        "object": "incident"
     },
     "ClientIPAddress": [
         {
+            "key": "ipv4-addr.value",
+            "object": "client"
+        },
+        {
+            "key": "ipv6-addr.value",
+            "object": "client"
+        },
+        {
             "key": "x-ibm-finding.dst_ip_ref",
-            "object": "finding"
+            "object": "finding",
+            "references": "client"
         },
         {
-            "key": "x-oca-event.ip_refs.clientIp",
-            "object": "event"
+            "group": true,
+            "key": "x-ibm-finding.ioc_refs",
+            "object": "finding",
+            "references": [
+                "client"
+            ]
+        },
+        {
+            "group": true,
+            "key": "x-oca-event.ip_refs",
+            "object": "event",
+            "references": [
+                "client"
+            ]
         }
     ],
     "ClosedTime": {
-        "key": "x-ibm-finding.end",
-        "object": "finding"
+        "key": "x-incident-info.closed_time",
+        "object": "incident"
     },
     "CommandLine": {
         "key": "process.command_line",
         "object": "process"
     },
     "Comments": {
-        "key": "x-azure-security-incident.comments",
+        "key": "x-incident-info.comments",
         "object": "incident"
     },
     "CompromisedEntity": {
-        "key": "x-azure-security-alert.compromised_entity",
-        "object": "alert"
-    },
-    "Computer": {
-        "key": "x-azure-security-event.computer",
-        "object": "msevent"
+        "key": "x-ibm-finding.x_compromised_entity",
+        "object": "finding"
     },
+    "Computer": [
+        {
+            "key": "x-oca-asset.hostname",
+            "object": "asset"
+        },
+        {
+            "key": "x-oca-event.host_ref",
+            "object": "event",
+            "references": "asset"
+        }
+    ],
     "ConfidenceLevel": {
-        "key": "x-azure-security-alert.confidence_level",
-        "object": "alert"
-    },
-    "CreatedTime": {
-        "key": "x-oca-event.created",
-        "object": "event"
+        "key": "x-ibm-finding.x_confidence_level",
+        "object": "finding"
     },
-    "Description": [
+    "ConfidenceScore": [
         {
-            "key": "x-azure-security-alert.description",
-            "object": "alert"
+            "key": "x-ibm-finding.confidence",
+            "object": "finding",
+            "transformer": "RealToNumber"
         },
         {
-            "key": "x-azure-security-event.description",
-            "object": "msevent"
+            "key": "x-ibm-ttp-tagging.confidence",
+            "object": "ttp_finding",
+            "transformer": "ConvertToReal"
         }
     ],
-    "Description__incident": {
-        "key": "x-azure-security-incident.description",
-        "object": "incident"
+    "CreatedTime": {
+        "key": "x-ibm-finding.start",
+        "object": "finding"
+    },
+    "Description": {
+        "key": "x-ibm-finding.description",
+        "object": "finding"
     },
     "DeviceDescription": {
-        "key": "x-azure-security-event.text",
-        "object": "msevent"
+        "key": "x-oca-asset.x_description",
+        "object": "asset"
     },
     "DeviceId": {
-        "key": "x-azure-security-event.device_name",
-        "object": "msevent"
-    },
-    "DisplayName": {
-        "key": "x-azure-security-alert.display_name",
-        "object": "alert"
+        "key": "x-oca-asset.device_id",
+        "object": "asset"
     },
     "EndTime": {
         "key": "x-ibm-finding.end",
         "object": "finding"
     },
     "Entities": {
-        "key": "x-azure-security-alert.entities",
-        "object": "alert"
+        "K8s-cluster": {
+            "Name": {
+                "key": "x-k8s-cluster.name",
+                "object": "k8s_cluster"
+            }
+        },
+        "account": {
+            "AadUserId": {
+                "key": "user-account.x_aad_user_id",
+                "object": "account"
+            },
+            "AccountType": {
+                "key": "user-account.account_type",
+                "object": "account"
+            },
+            "DisplayName": {
+                "key": "user-account.display_name",
+                "object": "account"
+            },
+            "DnsDomain": {
+                "key": "user-account.x_dns_domain",
+                "object": "account"
+            },
+            "IsDomainJoined": {
+                "key": "user-account.is_service_account",
+                "object": "account"
+            },
+            "NTDomain": {
+                "key": "user-account.x_nt_domain",
+                "object": "account"
+            },
+            "Name": [
+                {
+                    "key": "user-account.user_id",
+                    "object": "account"
+                },
+                {
+                    "key": "process.creator_user_ref",
+                    "object": "process1",
+                    "references": "account"
+                },
+                {
+                    "key": "process.creator_user_ref",
+                    "object": "parent_process",
+                    "references": "account"
+                },
+                {
+                    "key": "x-host-logon-session.account_ref",
+                    "object": "logon_session",
+                    "references": "account"
+                },
+                {
+                    "key": "x-ibm-finding.dst_os_user_ref",
+                    "object": "finding",
+                    "references": "account"
+                }
+            ],
+            "PUID": {
+                "key": "user-account.x_passport_userid",
+                "object": "account"
+            },
+            "Sid": {
+                "key": "user-account.x_account_sid",
+                "object": "account"
+            },
+            "UPNSuffix": {
+                "key": "user-account.x_upn_suffix",
+                "object": "account"
+            }
+        },
+        "blob": {
+            "BlobContainer": {
+                "Name": {
+                    "key": "x-azure-blob.blob_container",
+                    "object": "blob_storage"
+                }
+            },
+            "Etag": {
+                "key": "x-azure-blob.etag",
+                "object": "blob_storage"
+            },
+            "Name": {
+                "key": "x-azure-blob.name",
+                "object": "blob_storage"
+            },
+            "Url": [
+                {
+                    "key": "url.value",
+                    "object": "blobUrl"
+                },
+                {
+                    "key": "x-azure-blob.url_ref",
+                    "object": "blob_storage",
+                    "references": "blobUrl"
+                },
+                {
+                    "group": true,
+                    "key": "x-ibm-finding.ioc_refs",
+                    "object": "finding",
+                    "references": [
+                        "blobUrl"
+                    ]
+                }
+            ]
+        },
+        "blob-container": {
+            "Name": {
+                "key": "x-azure-blob.blob_container",
+                "object": "blob_storage"
+            }
+        },
+        "container": {
+            "ContainerId": {
+                "key": "x-azure-container.container_id",
+                "object": "container"
+            },
+            "Image": {
+                "ImageId": {
+                    "key": "x-azure-container.image_id",
+                    "object": "container"
+                },
+                "Type": {
+                    "key": "x-azure-container.image_type",
+                    "object": "container"
+                }
+            }
+        },
+        "dns": {
+            "DomainName": {
+                "key": "domain-name.value",
+                "object": "domain_name"
+            },
+            "IpAdresses": {
+                "Address": [
+                    {
+                        "key": "ipv4-addr.value",
+                        "object": "ipaddress1"
+                    },
+                    {
+                        "key": "ipv6-addr.value",
+                        "object": "ipaddress1"
+                    }
+                ],
+                "groupIpReference": {
+                    "group_ref": true,
+                    "key": "domain-name.resolves_to_refs",
+                    "object": "domain_name",
+                    "references": [
+                        "ipaddress1"
+                    ]
+                },
+                "groupIpfindingReference": {
+                    "group_ref": true,
+                    "key": "x-ibm-finding.ioc_refs",
+                    "object": "finding",
+                    "references": [
+                        "ipaddress1"
+                    ]
+                }
+            }
+        },
+        "file": {
+            "Directory": [
+                {
+                    "key": "directory.path",
+                    "object": "dir_obj"
+                },
+                {
+                    "key": "file.parent_directory_ref",
+                    "object": "file_obj",
+                    "references": "dir_obj"
+                }
+            ],
+            "FileHashes": {
+                "MD5": {
+                    "key": "file.hashes.MD5",
+                    "object": "file_obj"
+                },
+                "SHA1": {
+                    "key": "file.hashes.SHA-1",
+                    "object": "file_obj"
+                },
+                "SHA256": {
+                    "key": "file.hashes.SHA-256",
+                    "object": "file_obj"
+                }
+            },
+            "Name": [
+                {
+                    "key": "file.name",
+                    "object": "file_obj"
+                },
+                {
+                    "key": "process.binary_ref",
+                    "object": "process1",
+                    "references": "file_obj"
+                },
+                {
+                    "group": true,
+                    "key": "x-ibm-finding.ioc_refs",
+                    "object": "finding",
+                    "references": [
+                        "file_obj"
+                    ]
+                }
+            ]
+        },
+        "host": {
+            "DnsDomain": {
+                "key": "x-oca-asset.x_dns_domain",
+                "object": "host"
+            },
+            "HostName": [
+                {
+                    "key": "x-oca-asset.hostname",
+                    "object": "host"
+                },
+                {
+                    "key": "x-host-logon-session.host_ref",
+                    "object": "logon_session",
+                    "references": "host"
+                }
+            ],
+            "IsDomainJoined": {
+                "key": "x-oca-asset.x_is_domain_host",
+                "object": "host"
+            },
+            "NTDomain": {
+                "key": "x-oca-asset.x_nt_domain",
+                "object": "host"
+            },
+            "NetBiosName": {
+                "key": "x-oca-asset.x_netbios_name",
+                "object": "host"
+            },
+            "OMSAgentID": {
+                "key": "x-oca-asset.x_oms_agent_id",
+                "object": "host"
+            },
+            "OSFamily": [
+                {
+                    "key": "software.name",
+                    "object": "host_software"
+                },
+                {
+                    "key": "x-oca-asset.os_ref",
+                    "object": "host",
+                    "references": "host_software"
+                },
+                {
+                    "key": "x-ibm-finding.dst_os_ref",
+                    "object": "finding",
+                    "references": "host_software"
+                }
+            ],
+            "OSVersion": {
+                "key": "software.version",
+                "object": "host_software"
+            }
+        },
+        "host-logon-session": {
+            "EndTimeUtc": {
+                "key": "x-host-logon-session.end_time",
+                "object": "logon_session"
+            },
+            "SessionId": {
+                "key": "x-host-logon-session.session_id",
+                "object": "logon_session",
+                "transformer": "HexToInteger"
+            },
+            "StartTimeUtc": {
+                "key": "x-host-logon-session.start_time",
+                "object": "logon_session"
+            }
+        },
+        "malware": {
+            "Category": {
+                "key": "x-azure-malware.category",
+                "object": "malware"
+            },
+            "Files": {
+                "file": {
+                    "Directory": [
+                        {
+                            "key": "directory.path",
+                            "object": "dir_obj"
+                        },
+                        {
+                            "key": "file.parent_directory_ref",
+                            "object": "malware_file",
+                            "references": "dir_obj"
+                        }
+                    ],
+                    "FileHashes": {
+                        "MD5": {
+                            "key": "file.hashes.MD5",
+                            "object": "malware_file"
+                        },
+                        "SHA1": {
+                            "key": "file.hashes.SHA-1",
+                            "object": "malware_file"
+                        },
+                        "SHA256": {
+                            "key": "file.hashes.SHA-256",
+                            "object": "malware_file"
+                        }
+                    },
+                    "Name": {
+                        "key": "file.name",
+                        "object": "malware_file"
+                    }
+                },
+                "groupMalwareReference": {
+                    "group_ref": true,
+                    "key": "x-azure-malware.file_refs",
+                    "object": "malware",
+                    "references": [
+                        "malware_file"
+                    ]
+                },
+                "groupfindingReference": {
+                    "group": true,
+                    "key": "x-ibm-finding.ioc_refs",
+                    "object": "finding",
+                    "references": [
+                        "malware_file"
+                    ]
+                }
+            },
+            "Name": {
+                "key": "x-azure-malware.name",
+                "object": "malware"
+            }
+        },
+        "network-connection": {
+            "DestinationPort": {
+                "key": "network-traffic.dst_port",
+                "object": "nt",
+                "transformer": "ToInteger"
+            },
+            "Protocol": {
+                "key": "network-traffic.protocols",
+                "object": "nt",
+                "transformer": "ToLowercaseArray"
+            },
+            "SourceAddress": {
+                "Address": [
+                    {
+                        "key": "ipv4-addr.value",
+                        "object": "ipaddress"
+                    },
+                    {
+                        "key": "ipv6-addr.value",
+                        "object": "ipaddress"
+                    },
+                    {
+                        "key": "network-traffic.src_ref",
+                        "object": "nt",
+                        "references": "ipaddress",
+                        "unwrap": true
+                    }
+                ],
+                "Location": {
+                    "Carrier": {
+                        "key": "x-geo-location.carrier",
+                        "object": "location"
+                    },
+                    "City": {
+                        "key": "x-geo-location.city",
+                        "object": "location"
+                    },
+                    "CountryName": [
+                        {
+                            "key": "x-geo-location.country",
+                            "object": "location"
+                        },
+                        {
+                            "key": "ipv4-addr.x_location_ref",
+                            "object": "ipaddress",
+                            "references": "location"
+                        },
+                        {
+                            "key": "ipv6-addr.x_location_ref",
+                            "object": "ipaddress",
+                            "references": "location"
+                        }
+                    ],
+                    "Latitude": {
+                        "key": "x-geo-location.latitude",
+                        "object": "location"
+                    },
+                    "Longitude": {
+                        "key": "x-geo-location.longitude",
+                        "object": "location"
+                    },
+                    "Organization": {
+                        "key": "x-geo-location.organization",
+                        "object": "location"
+                    }
+                }
+            },
+            "groupIPReference": {
+                "group_ref": true,
+                "key": "x-ibm-finding.ioc_refs",
+                "object": "finding",
+                "references": [
+                    "ipaddress"
+                ]
+            }
+        },
+        "process": {
+            "CommandLine": {
+                "key": "process.command_line",
+                "object": "process1"
+            },
+            "CreationTimeUtc": {
+                "key": "process.created",
+                "object": "process1"
+            },
+            "ElevationToken": {
+                "key": "process.x_elevation_token",
+                "object": "process1"
+            },
+            "ImageFile": {
+                "Directory": [
+                    {
+                        "key": "directory.path",
+                        "object": "dir_obj"
+                    },
+                    {
+                        "key": "file.parent_directory_ref",
+                        "object": "image_file_obj",
+                        "references": "dir_obj"
+                    }
+                ],
+                "FileHashes": {
+                    "MD5": {
+                        "key": "file.hashes.MD5",
+                        "object": "image_file_obj"
+                    },
+                    "SHA1": {
+                        "key": "file.hashes.SHA-1",
+                        "object": "image_file_obj"
+                    },
+                    "SHA256": {
+                        "key": "file.hashes.SHA-256",
+                        "object": "image_file_obj"
+                    }
+                },
+                "Name": [
+                    {
+                        "key": "file.name",
+                        "object": "image_file_obj"
+                    },
+                    {
+                        "key": "process.binary_ref",
+                        "object": "process1",
+                        "references": "image_file_obj"
+                    },
+                    {
+                        "group": true,
+                        "key": "x-ibm-finding.ioc_refs",
+                        "object": "finding",
+                        "references": [
+                            "image_file_obj"
+                        ]
+                    }
+                ]
+            },
+            "ParentProcess": {
+                "CommandLine": {
+                    "key": "process.command_line",
+                    "object": "parent_process"
+                },
+                "CreationTimeUtc": {
+                    "key": "process.created",
+                    "object": "parent_process"
+                },
+                "ElevationToken": {
+                    "key": "process.x_elevation_token",
+                    "object": "parent_process"
+                },
+                "ImageFile": {
+                    "Directory": [
+                        {
+                            "key": "directory.path",
+                            "object": "dir_obj1"
+                        },
+                        {
+                            "key": "file.parent_directory_ref",
+                            "object": "image_file_obj1",
+                            "references": "dir_obj1"
+                        }
+                    ],
+                    "FileHashes": {
+                        "MD5": {
+                            "key": "file.hashes.MD5",
+                            "object": "image_file_obj1"
+                        },
+                        "SHA1": {
+                            "key": "file.hashes.SHA-1",
+                            "object": "image_file_obj1"
+                        },
+                        "SHA256": {
+                            "key": "file.hashes.SHA-256",
+                            "object": "image_file_obj1"
+                        }
+                    },
+                    "Name": [
+                        {
+                            "key": "file.name",
+                            "object": "image_file_obj1"
+                        },
+                        {
+                            "key": "process.binary_ref",
+                            "object": "parent_process",
+                            "references": "image_file_obj1"
+                        },
+                        {
+                            "group": true,
+                            "key": "x-ibm-finding.ioc_refs",
+                            "object": "finding",
+                            "references": [
+                                "image_file_obj1"
+                            ]
+                        }
+                    ]
+                },
+                "ProcessId": [
+                    {
+                        "key": "process.pid",
+                        "object": "parent_process",
+                        "transformer": "HexToInteger"
+                    },
+                    {
+                        "key": "process.parent_ref",
+                        "object": "process1",
+                        "references": "parent_process"
+                    }
+                ]
+            },
+            "ProcessId": {
+                "key": "process.pid",
+                "object": "process1",
+                "transformer": "HexToInteger"
+            }
+        },
+        "url": {
+            "Url": [
+                {
+                    "key": "url.value",
+                    "object": "url"
+                },
+                {
+                    "group": true,
+                    "key": "x-ibm-finding.ioc_refs",
+                    "object": "finding",
+                    "references": [
+                        "url"
+                    ]
+                }
+            ]
+        }
     },
     "EventData": {
-        "key": "x-azure-security-event.event_data",
-        "object": "msevent"
+        "key": "x-oca-event.dataset",
+        "object": "event"
     },
-    "EventID": [
-        {
-            "key": "x-ibm-finding.code",
-            "object": "finding"
-        },
-        {
-            "key": "x-oca-event.code",
-            "object": "event"
-        }
-    ],
-    "EventSourceName": {
-        "key": "x-ibm-finding.name",
-        "object": "finding"
+    "EventID": {
+        "key": "x-oca-event.code",
+        "object": "event"
     },
-    "EventTime": {
-        "key": "x-ibm-finding.time_observed",
+    "EventOriginId": {
+        "key": "x-ibm-finding.alert_id",
         "object": "finding"
     },
-    "ExtentedProperties": {
-        "key": "x-azure-security-alert.extented_properties",
-        "object": "alert"
+    "EventSourceName": {
+        "key": "x-oca-event.provider",
+        "object": "event"
     },
-    "FileHash": [
-        {
-            "key": "file.hashes",
-            "object": "event"
-        },
-        {
-            "key": "x-oca-event.file_ref.path",
-            "object": "event"
+    "ExtendedProperties": {
+        "resourceType": {
+            "key": "x-cloud-resource.resource_type",
+            "object": "cloud_resource"
         }
-    ],
+    },
     "FilePath": [
         {
             "key": "file.path",
             "object": "file"
         },
         {
-            "key": "x-oca-event.file_ref.path",
-            "object": "file"
+            "key": "x-oca-event.file_ref",
+            "object": "event",
+            "references": "file"
+        },
+        {
+            "key": "process.binary_ref",
+            "object": "process",
+            "references": "file"
+        },
+        {
+            "key": "file.name",
+            "object": "file",
+            "transformer": "ToFileName"
+        },
+        {
+            "group": true,
+            "key": "x-ibm-finding.ioc_refs",
+            "object": "finding",
+            "references": [
+                "file"
+            ]
         }
     ],
     "FirstActivityTime": {
-        "key": "x-ibm-finding.start",
-        "object": "finding"
+        "key": "x-incident-info.first_activity",
+        "object": "incident"
     },
     "FirstModifiedTime": {
-        "key": "x-ibm-finding.start",
-        "object": "finding"
+        "key": "x-incident-info.first_modified",
+        "object": "incident"
+    },
+    "Fqbn": {
+        "key": "file.x_fqbn",
+        "object": "file"
     },
     "HomeDirectory": {
         "key": "directory.path",
         "object": "directory"
     },
     "HomePath": {
         "key": "directory.path",
         "object": "directory"
     },
-    "IncidentName": [
+    "IncidentName": {
+        "key": "x-ibm-finding.x_incident_name",
+        "object": "finding"
+    },
+    "IncidentUrl": [
         {
-            "key": "x-ibm-finding.name",
-            "object": "finding"
+            "key": "url.value",
+            "object": "url"
         },
         {
-            "key": "x-azure-security-incident.incident_name",
-            "object": "incident"
+            "key": "x-incident-info.incident_url_ref",
+            "object": "incident",
+            "references": "url"
         }
     ],
-    "IncidentUrl": [
+    "IpAddress": [
         {
-            "key": "x-oca-event.url_ref",
-            "object": "event"
+            "key": "ipv4-addr.value",
+            "object": "ipv4-addr"
         },
         {
-            "key": "url.name",
-            "object": "url"
-        }
-    ],
-    "IpAddress": [
+            "key": "ipv6-addr.value",
+            "object": "ipv4-addr"
+        },
         {
             "key": "x-ibm-finding.src_ip_ref",
-            "object": "finding"
+            "object": "finding",
+            "references": "ipv4-addr"
         },
         {
-            "key": "ipv4-addr.value",
-            "object": "ipv4-addr"
+            "group": true,
+            "key": "x-ibm-finding.ioc_refs",
+            "object": "finding",
+            "references": [
+                "ipv4-addr"
+            ]
         },
         {
+            "group": true,
             "key": "x-oca-event.ip_refs",
-            "object": "event"
+            "object": "event",
+            "references": [
+                "ipv4-addr"
+            ]
         }
     ],
     "Labels": {
-        "key": "x-azure-security-incident.labels",
+        "key": "x-incident-info.labels",
         "object": "incident"
     },
     "LastActivityTime": {
-        "key": "x-ibm-finding.end",
-        "object": "finding"
+        "key": "x-incident-info.last_active",
+        "object": "incident"
     },
     "LastModifiedTime": {
         "key": "x-ibm-finding.end",
         "object": "finding"
     },
+    "LogonGuid": {
+        "key": "x-logon-info.guid",
+        "object": "logon_info"
+    },
     "LogonProcessName": {
-        "key": "process.name",
+        "key": "x-logon-info.logon_process",
+        "object": "logon_info"
+    },
+    "LogonType": {
+        "key": "x-logon-info.logon_type",
+        "object": "logon_info"
+    },
+    "LogonTypeName": {
+        "key": "x-logon-info.logon_type_name",
+        "object": "logon_info"
+    },
+    "MD5": {
+        "key": "file.hashes.MD5",
+        "object": "file"
+    },
+    "MandatoryLabel": {
+        "key": "process.x_mandatory_label",
         "object": "process"
     },
     "MemberName": {
-        "key": "x-azure-security-event.member_name",
-        "object": "msevent"
+        "key": "x-oca-event.x_member_name",
+        "object": "event"
     },
     "ModifiedBy": {
-        "key": "x-azure-security-incident.modified_by",
-        "object": "incident"
+        "key": "x-ibm-finding.x_modified_by",
+        "object": "finding"
     },
+    "NewProcessId": [
+        {
+            "key": "process.pid",
+            "object": "process",
+            "transformer": "HexToInteger"
+        },
+        {
+            "key": "x-oca-event.process_ref",
+            "object": "event",
+            "references": "process"
+        }
+    ],
+    "NewProcessName": [
+        {
+            "key": "directory.path",
+            "object": "file_dir",
+            "transformer": "ToDirectoryPath"
+        },
+        {
+            "key": "file.name",
+            "object": "file",
+            "transformer": "ToFileName"
+        },
+        {
+            "key": "file.parent_directory_ref",
+            "object": "file",
+            "references": "file_dir"
+        },
+        {
+            "key": "process.binary_ref",
+            "object": "process",
+            "references": "file"
+        }
+    ],
     "Owner": {
-        "key": "x-azure-security-incident.owner",
-        "object": "incident"
+        "assignedTo": {
+            "key": "email-addr.display_name",
+            "object": "owner"
+        },
+        "email": {
+            "key": "email-addr.value",
+            "object": "owner"
+        },
+        "userPrincipalName": [
+            {
+                "key": "email-addr.value",
+                "object": "owner"
+            },
+            {
+                "key": "x-ibm-finding.x_owner_ref",
+                "object": "finding",
+                "references": "owner"
+            }
+        ]
     },
     "ParentProcessName": [
         {
+            "key": "directory.path",
+            "object": "file_dir1",
+            "transformer": "ToDirectoryPath"
+        },
+        {
+            "key": "file.name",
+            "object": "file1",
+            "transformer": "ToFileName"
+        },
+        {
+            "key": "file.parent_directory_ref",
+            "object": "file1",
+            "references": "file_dir1"
+        },
+        {
+            "key": "process.binary_ref",
+            "object": "parent1",
+            "references": "file1"
+        },
+        {
             "key": "process.parent_ref",
-            "object": "process"
+            "object": "process",
+            "references": "parent1"
         },
         {
             "key": "x-oca-event.parent_process_ref",
-            "object": "event"
+            "object": "event",
+            "references": "parent1"
         }
     ],
     "PreviousTime": {
         "key": "x-ibm-finding.start",
         "object": "finding"
     },
     "ProcessId": {
         "key": "process.pid",
-        "object": "process"
+        "object": "parent1",
+        "transformer": "HexToInteger"
     },
     "ProcessName": [
         {
-            "key": "process.name",
-            "object": "process"
+            "key": "directory.path",
+            "object": "file_dir1",
+            "transformer": "ToDirectoryPath"
         },
         {
-            "key": "x-oca-event.process_ref",
-            "object": "event"
+            "key": "file.name",
+            "object": "file1",
+            "transformer": "ToFileName"
+        },
+        {
+            "key": "file.parent_directory_ref",
+            "object": "file1",
+            "references": "file_dir1"
+        },
+        {
+            "key": "process.binary_ref",
+            "object": "parent1",
+            "references": "file1"
         }
     ],
     "ProcessingEndTime": {
-        "key": "x-ibm-finding.end",
+        "key": "x-ibm-finding.x_processing_endtime",
         "object": "finding"
     },
-    "ProductName": {
-        "key": "x-azure-security-alert.product_name",
-        "object": "alert"
+    "ProductComponentName": {
+        "key": "software.x_product_component_name",
+        "object": "product_info"
+    },
+    "ProductName": [
+        {
+            "key": "software.name",
+            "object": "product_info"
+        },
+        {
+            "key": "x-ibm-finding.dst_application_ref",
+            "object": "finding",
+            "references": "product_info"
+        }
+    ],
+    "ProviderIncidentId": {
+        "key": "x-ibm-finding.x_provider_incident_id",
+        "object": "finding"
     },
     "ProviderName": {
-        "key": "x-oca-event.provider",
-        "object": "event"
+        "key": "software.x_provider_name",
+        "object": "product_info"
+    },
+    "ProviderNameIncident": {
+        "key": "x-ibm-finding.x_provider_name",
+        "object": "finding"
     },
     "QuarantineHelpURL": [
         {
-            "key": "x-oca-event.url_ref",
-            "object": "event"
+            "key": "url.value",
+            "object": "help_url"
         },
         {
-            "key": "url.name",
-            "object": "url"
+            "key": "x-oca-event.url_ref",
+            "object": "event",
+            "references": "help_url"
         }
     ],
+    "RelatedAnalyticRuleIds": {
+        "key": "x-ibm-finding.rule_names",
+        "object": "finding"
+    },
+    "RemediationSteps": {
+        "key": "x-ibm-finding.x_remediationsteps",
+        "object": "finding"
+    },
     "Requester": {
-        "key": "x-azure-security-event.requester",
-        "object": "msevent"
+        "key": "x-oca-event.x_requester",
+        "object": "event"
+    },
+    "ResourceId": {
+        "key": "x-cloud-resource.resource_id",
+        "object": "cloud_resource"
+    },
+    "SHA1": {
+        "key": "file.hashes.SHA-1",
+        "object": "file"
+    },
+    "SHA256": {
+        "key": "file.hashes.SHA-256",
+        "object": "file"
     },
     "ServiceFileName": {
-        "key": "x-oca-event.file_ref.service",
+        "key": "x-oca-event.x_service_file",
         "object": "event"
     },
     "ServiceName": {
-        "key": "x-azure-security-event.service_name",
-        "object": "msevent"
+        "key": "x-oca-event.x_service_name",
+        "object": "event"
     },
     "Severity": {
-        "key": "x-azure-security-incident.severity",
-        "object": "incident"
-    },
-    "SourceSystem": {
-        "key": "x-azure-security-event.source",
-        "object": "msevent"
+        "key": "x-ibm-finding.x_severity",
+        "object": "finding",
+        "transformer": "ConvertSeverityToScore"
+    },
+    "SourceComputerId": {
+        "key": "x-oca-asset.device_id",
+        "object": "asset"
     },
     "StartTime": {
         "key": "x-ibm-finding.start",
         "object": "finding"
     },
     "Status": {
-        "key": "x-azure-security-alert.status",
-        "object": "alert"
+        "key": "x-ibm-finding.x_status",
+        "object": "finding"
+    },
+    "SubjectAccount": {
+        "key": "user-account.account_login",
+        "object": "subject"
+    },
+    "SubjectDomainName": {
+        "key": "user-account.x_domain_name",
+        "object": "subject"
+    },
+    "SubjectLogonId": {
+        "key": "user-account.x_login_id",
+        "object": "subject",
+        "transformer": "HexToInteger"
+    },
+    "SubjectUserName": [
+        {
+            "key": "user-account.user_id",
+            "object": "subject"
+        },
+        {
+            "key": "user-account.display_name",
+            "object": "subject"
+        },
+        {
+            "key": "x-ibm-finding.dst_application_user_ref",
+            "object": "finding",
+            "references": "subject"
+        }
+    ],
+    "SubjectUserSid": {
+        "key": "user-account.x_user_sid",
+        "object": "subject"
     },
     "SystemAlertId": {
-        "key": "x-azure-security-alert.cloudAppStates.system_alertid",
-        "object": "alert"
+        "key": "x-ibm-finding.x_system_alert_id",
+        "object": "finding"
     },
-    "TargetDomainName": {
-        "key": "domain-name.value",
-        "object": "domain-name"
+    "Tactics": {
+        "key": "x-ibm-ttp-tagging.extensions.mitre-attack-ext.tactic_name",
+        "object": "ttp_finding"
     },
-    "TargetUserName": {
+    "TargetAccount": {
         "key": "user-account.account_login",
-        "object": "user-account"
+        "object": "target-account"
+    },
+    "TargetDomainName": {
+        "key": "user-account.x_domain_name",
+        "object": "target-account"
+    },
+    "TargetLogonId": {
+        "key": "user-account.x_login_id",
+        "object": "target-account",
+        "transformer": "HexToInteger"
+    },
+    "TargetServerName": {
+        "key": "x-ibm-finding.dst_device",
+        "object": "finding"
+    },
+    "TargetSid": {
+        "key": "x-oca-event.x_modified_account_sid",
+        "object": "event"
+    },
+    "TargetUserName": [
+        {
+            "key": "user-account.user_id",
+            "object": "target-account"
+        },
+        {
+            "key": "user-account.display_name",
+            "object": "target-account"
+        },
+        {
+            "key": "x-ibm-finding.src_application_user_ref",
+            "object": "finding",
+            "references": "target-account"
+        },
+        {
+            "key": "x-oca-event.user_ref",
+            "object": "event",
+            "references": "target-account"
+        }
+    ],
+    "TargetUserSid": {
+        "key": "user-account.x_user_sid",
+        "object": "target-account"
     },
     "Task": {
-        "key": "x-azure-security-event.task",
-        "object": "msevent"
+        "key": "x-oca-event.x_task",
+        "object": "event"
+    },
+    "Tasks": {
+        "key": "x-incident-info.tasks",
+        "object": "incident"
+    },
+    "Techniques": {
+        "key": "x-ibm-ttp-tagging.extensions.mitre-attack-ext.technique_name",
+        "object": "ttp_finding"
     },
     "TenantId": {
-        "key": "x-azure-security-alert.tenant_id",
-        "object": "alert"
+        "key": "x-cloud-provider.tenant_id",
+        "object": "cloud_info"
+    },
+    "TimeCollected": [
+        {
+            "key": "x-oca-event.created",
+            "object": "event",
+            "transformer": "TimestampConversion"
+        },
+        {
+            "key": "x-oca-event.modified",
+            "object": "event",
+            "transformer": "TimestampConversion"
+        }
+    ],
+    "TimeGenerated": {
+        "key": "x-ibm-finding.time_observed",
+        "object": "finding"
     },
-    "TimeGenerated": [
+    "Title": [
         {
-            "key": "x-ibm-finding.start",
+            "key": "x-ibm-finding.name",
             "object": "finding"
         },
         {
-            "key": "x-oca-event.created",
-            "object": "event"
+            "key": "x-ibm-ttp-tagging.name",
+            "object": "ttp_finding"
         },
         {
-            "key": "x-ibm-finding.time_observed",
-            "object": "finding"
+            "group": true,
+            "key": "x-ibm-finding.ttp_tagging_refs",
+            "object": "finding",
+            "references": [
+                "ttp_finding"
+            ]
         }
     ],
-    "Title": {
-        "key": "x-azure-security-event.title",
-        "object": "msevent"
-    },
-    "UserParameter": {
-        "key": "x-azure-security-event.user_parameter",
-        "object": "msevent"
+    "TokenElevationType": {
+        "key": "process.x_token_elevation_type",
+        "object": "process"
+    },
+    "Type": {
+        "key": "x-ibm-finding.finding_type",
+        "object": "finding",
+        "transformer": "ConvertToFindingType"
+    },
+    "UserParameters": {
+        "key": "x-oca-event.x_user_parameter",
+        "object": "event"
     },
     "VendorName": {
-        "key": "x-azure-security-alert.vendor_name",
-        "object": "alert"
+        "key": "software.vendor",
+        "object": "product_info"
     },
-    "WorkspaceResourceGroup": {
-        "key": "x-azure-security-alert.workspace_resource_group",
-        "object": "alert"
-    },
-    "WorkspaceSubscriptionId": {
-        "key": "x-azure-security-alert.subscription_id",
-        "object": "alert"
+    "VendorOriginalId": {
+        "key": "x-ibm-finding.alert_id",
+        "object": "finding"
     },
-    "_ResourceId": {
-        "key": "x-azure-security-alert.resourceId",
-        "object": "alert"
+    "WorkstationName": {
+        "key": "x-ibm-finding.dst_device",
+        "object": "finding"
     },
-    "eventId": {
-        "key": "x-azure-security-event.event_id",
-        "object": "msevent"
+    "_ResourceId": {
+        "key": "x-cloud-resource.resource_id",
+        "object": "cloud_resource"
     }
 }
```

## stix_shifter_modules/azure_log_analytics/stix_transmission/api_client.py

```diff
@@ -1,24 +1,23 @@
 from stix_shifter_utils.stix_transmission.utils.RestApiClientAsync import RestApiClientAsync
 from azure.monitor.query.aio import LogsQueryClient
 from azure.identity.aio import ClientSecretCredential
-from azure.core.exceptions import HttpResponseError
 import logging
 
 
 class APIClient:
     """API Client to handle all calls."""
 
     def __init__(self, connection, configuration):
         """Initialization.
         :param connection: dict, connection dict
         :param configuration: dict,config dict"""
         self.connection = connection
         self.configuration = configuration
-        logger = logging.getLogger("azure.core.pipeline.policies.http_logging_policy")
+        logger = logging.getLogger("azure")
         logger.setLevel(logging.WARNING)
 
     async def init_async_client(self):
         self.workspace_id = self.connection.get('workspaceId')
         self.host = self.connection.get('host')
         self.timeout = self.connection['options'].get('timeout')
         self.endpoint = 'v1/workspaces/{workspace_id}/query'.format(workspace_id=self.workspace_id)
@@ -33,34 +32,37 @@
                                     self.connection.get('port', None),
                                     headers,
                                     cert_verify=self.connection.get('selfSignedCert', True)
                                     )
 
     async def ping_box(self):
         """Ping the endpoint."""
-        await self.init_async_client()
-        resp = await self.client.call_api(self.endpoint, 'GET', timeout=self.timeout)
-        await self.credential.close()
-        return resp
+        try:
+            await self.init_async_client()
+            resp = await self.client.call_api(self.endpoint, 'GET', timeout=self.timeout)
+            return resp
+        except Exception as e:
+            raise e
+        finally:
+            if hasattr(self, 'credential'):
+                await self.credential.close()
 
     async def run_search(self, query_expression, start, stop):
-        """get the response from azure_sentinel endpoints
+        """get the response from log analytics endpoints
         :param query_expression: str, search_id
         :return: response, json object"""
-        await self.init_async_client()
         try:
+            await self.init_async_client()
             client = LogsQueryClient(self.credential)
             async with client:
                 response = await client.query_workspace(
                     workspace_id=self.workspace_id,
                     query=query_expression,
                     timespan=(start, stop)
                 )
             return {'success': True, "response": response}
-        except HttpResponseError as er:
-            return {'success': False, "error": er.error}
         except Exception as e:
-            return {'success': False, "error": e}
-        finally: 
-            await self.credential.close()
+            raise e
+        finally:
+            if hasattr(self, 'credential'):
+                await self.credential.close()
 
-
```

## stix_shifter_modules/azure_log_analytics/stix_transmission/connector.py

```diff
@@ -1,88 +1,322 @@
 import json
 from stix_shifter_utils.modules.base.stix_transmission.base_sync_connector import BaseSyncConnector
 from .api_client import APIClient
 from stix_shifter_utils.utils.error_response import ErrorResponder
 import pandas as pd
 from stix_shifter_utils.utils import logger
 from azure.monitor.query import LogsQueryStatus
-from azure.core.exceptions import ODataV4Format
+from azure.core.exceptions import ODataV4Format, HttpResponseError, ClientAuthenticationError
 from datetime import datetime, timedelta
 import re
+import jsonref
+import copy
+from stix_shifter_modules.azure_log_analytics.stix_translation.query_constructor import QueryStringPatternTranslator, \
+    CONFIG_MAP_PATH
 
 
 class Connector(BaseSyncConnector):
 
     def __init__(self, connection, configuration):
         """Initialization.
         :param connection: dict, connection dict
         :param configuration: dict,config dict"""
         self.logger = logger.set_logger(__name__)
         self.connector = __name__.split('.')[1]
         self.api_client = APIClient(connection, configuration)
 
     async def ping_connection(self):
         """Ping the endpoint."""
-        return_obj = dict()
-        response = await self.api_client.ping_box()
-        response_code = response.code
+        return_obj = {}
+        response_dict = {}
         try:
+            response = await self.api_client.ping_box()
+            response_code = response.code
             response_dict = json.loads(response.read())
-        except:
-            response_dict = json.loads(response.bytes)
-        
-        if 200 <= response_code < 300: 
-            return_obj['success'] = True
-        elif response_code == 404:
-            error_dict = {"error": response_dict['error']['message'], "code": response_dict['error']['code']}
-            ErrorResponder.fill_error(return_obj, error_dict, ['error', 'message'], connector=self.connector)
-        else:
-            ErrorResponder.fill_error(return_obj, response_dict, ['error', 'message'], connector=self.connector)
 
+            if 200 <= response_code < 300:
+                return_obj['success'] = True
+            elif response_code == 404:
+                if 'PathNotFoundError' in str(response_dict) or 'WorkspaceNotFoundError' in str(response_dict):
+                    response_dict['code'] = 404
+                    response_dict['message'] = "Invalid Parameter: workspaceId"
+                ErrorResponder.fill_error(return_obj, response_dict, ['message'], connector=self.connector)
+            else:
+                ErrorResponder.fill_error(return_obj, response_dict, ['message'], connector=self.connector)
+
+        except ClientAuthenticationError as ex:
+            if 'invalid_resource' in str(ex):
+                response_dict['code'] = 500
+                response_dict['message'] = "Invalid Host/Port"
+            else:
+                response_dict['code'] = 401
+                response_dict['message'] = "Invalid Authentication"
+            ErrorResponder.fill_error(return_obj, response_dict, ['message'], connector=self.connector)
+
+        except ValueError as ex:
+            if "Invalid tenant" in str(ex):
+                response_dict['message'] = "Invalid Parameter: tenant"
+            else:
+                response_dict['message'] = "Invalid Parameter"
+            response_dict['code'] = 404
+            ErrorResponder.fill_error(return_obj, response_dict, ['message'], connector=self.connector)
+
+        except TimeoutError as ex:
+            response_dict['code'] = 408
+            response_dict['message'] = 'TimeoutError ' + str(ex)
+            ErrorResponder.fill_error(return_obj, response_dict, ['message'], connector=self.connector)
+
+        except Exception as ex:
+            response_dict['message'] = ex
+            self.logger.error('error when getting search results: %s', ex)
+            ErrorResponder.fill_error(return_obj, response_dict, ['message'], connector=self.connector)
         return return_obj
 
     async def delete_query_connection(self, search_id):
         """"delete_query_connection response
         :param search_id: str, search_id"""
         return {"success": True, "search_id": search_id}
 
     async def create_results_connection(self, query, offset, length):
         """"built the response object
         :param query: str, search_id
         :param offset: int,offset value
         :param length: int,length value"""
-        length = int(length)
-        offset = int(offset)
-        return_obj = dict()
-        query = """{query} | serialize rn = row_number() | where rn >= {offset} | limit {len}""".format(query=query,
-                                                                                                        offset=offset,
-                                                                                                        len=length)
-        matches = re.findall(r'(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+?Z)', query)
-        if matches:
-            stop_time = datetime.strptime(matches[1].replace('Z', ""), "%Y-%m-%dT%H:%M:%S.%f")
-            start_time = datetime.strptime(matches[0].replace('Z', ""), "%Y-%m-%dT%H:%M:%S.%f")
-        else:
-            stop_time = datetime.utcnow()
-            start_time = stop_time - timedelta(hours=24)
-
-        response = await self.api_client.run_search(query, start_time, stop_time)
-
-        if response["success"]:
-            if response["response"].status == LogsQueryStatus.PARTIAL:
-                error = response["response"].partial_error
-                data = response["response"].partial_data
-                self.logger.warn(error.message)
-            elif response["response"].status == LogsQueryStatus.SUCCESS:
-                data = response["response"].tables
-
-            for table in data:
-                df = pd.DataFrame(data=table.rows, columns=table.columns)
-                return_obj = {"success": True, "data": df.astype(str).to_dict(orient='records')}
-                return_obj['data'] = return_obj['data']
-
-        else:
-            if isinstance(response["error"], ODataV4Format):
-                response_dict = {"error": response["error"], "code": response["error"].code}
+        return_obj = {}
+        response_dict = {}
+
+        try:
+            length = int(length)
+            offset = int(offset)
+            return_obj = dict()
+            query = """{query} | serialize rn = row_number() | where rn >= {offset} | limit {len}""".format(query=query,
+                                                                                            offset=offset, len=length)
+            matches = re.findall(r'(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d+?Z)', query)
+            if matches:
+                stop_time = datetime.strptime(matches[len(matches) - 1].replace('Z', ""), "%Y-%m-%dT%H:%M:%S.%f")
+                start_time = datetime.strptime(matches[len(matches) - 2].replace('Z', ""), "%Y-%m-%dT%H:%M:%S.%f")
             else:
-                response_dict = {"error": response["error"]}
-            ErrorResponder.fill_error(return_obj, response_dict, ['error', 'message'], connector=self.connector)
+                stop_time = datetime.utcnow()
+                start_time = stop_time - timedelta(hours=24)
+
+            response = await self.api_client.run_search(query, start_time, stop_time)
+
+            if response["success"]:
+                if response["response"].status == LogsQueryStatus.PARTIAL:
+                    error = response["response"].partial_error
+                    data = response["response"].partial_data
+                    self.logger.warn(error.message)
+                elif response["response"].status == LogsQueryStatus.SUCCESS:
+                    data = response["response"].tables
+
+                for table in data:
+                    df = pd.DataFrame(data=table.rows, columns=table.columns)
+                    return_obj = {"success": True, "data": df.astype(str).to_dict(orient='records')}
+                    return_obj['data'] = self.format_response(return_obj['data'])
+
+        except ClientAuthenticationError as ex:
+            if 'invalid_resource' in str(ex):
+                response_dict['code'] = 500
+                response_dict['message'] = "Invalid Host/Port"
+            else:
+                response_dict['code'] = 401
+                response_dict['message'] = "Invalid Authentication"
+            ErrorResponder.fill_error(return_obj, response_dict, ['message'], connector=self.connector)
+
+        except HttpResponseError as ex:
+            if isinstance(ex.error, ODataV4Format):
+                if 'PathNotFoundError' in str(ex.error) or 'WorkspaceNotFoundError' in str(ex.error):
+                    response_dict['code'] = 404
+                    response_dict['message'] = "Invalid Parameter: workspaceId"
+                else:
+                    response_dict['code'] = 400
+                    response_dict['message'] = "Invalid Query"
+            else:
+                response_dict['code'] = 500
+                response_dict['message'] = "Invalid Host/Port"
+            ErrorResponder.fill_error(return_obj, response_dict, ['message'], connector=self.connector)
+
+        except ValueError as ex:
+            if "Invalid tenant" in str(ex):
+                response_dict['message'] = "Invalid Parameter: tenant"
+            else:
+                response_dict['message'] = "Invalid Parameter"
+            response_dict['code'] = 404
+            ErrorResponder.fill_error(return_obj, response_dict, ['message'], connector=self.connector)
+
+        except TimeoutError as ex:
+            response_dict['code'] = 408
+            response_dict['message'] = 'TimeoutError ' + str(ex)
+            ErrorResponder.fill_error(return_obj, response_dict, ['message'], connector=self.connector)
+
+        except Exception as ex:
+            response_dict['message'] = ex
+            self.logger.error('error when getting search results: %s', ex)
+            ErrorResponder.fill_error(return_obj, response_dict, ['message'], connector=self.connector)
         return return_obj
+
+    def format_response(self, data):
+        """ Format the API responses
+        :param data: list
+        :return: list """
+
+        for row in data:
+            copied_row = copy.deepcopy(row)
+            try:
+                # formatting security alert response
+                if row.get("Type") == "SecurityAlert":
+                    row = self.format_security_alert(row)
+                # formatting security incident response
+                elif row.get("Type") == 'SecurityIncident':
+                    row = self.format_security_incident(row)
+                # formatting security event response
+                elif row.get("Type") == "SecurityEvent":
+                    if row.get('FileHash'):
+                        row = self.find_filehash_map(row)
+            except:
+                row = copied_row
+        return data
+
+    def format_security_alert(self, security_alert):
+        """ Format the security alert response
+        :param security_alert: dict
+        :return: dict """
+
+        if security_alert.get("ExtendedProperties"):
+            security_alert["ExtendedProperties"] = json.loads(security_alert["ExtendedProperties"])
+
+        if security_alert.get("RemediationSteps"):
+            if '{' not in security_alert["RemediationSteps"] and '}' not in security_alert["RemediationSteps"]:
+                security_alert["RemediationSteps"] = ' '.join(json.loads(security_alert["RemediationSteps"]))
+
+        if security_alert.get("Entities"):
+            entity_list = json.loads(security_alert["Entities"].replace('$ref":"', '$ref":"#'))
+            entity_dict = {}
+            for _dict in entity_list:
+                if _dict.get("$id"):
+                    _dict = self.add_account_type(_dict)
+                    entity_dict[_dict["$id"]] = _dict
+            entity_dict = self.remove_unwanted_ref(entity_dict)
+            security_alert['entity'] = json.loads(json.dumps(jsonref.loads(json.dumps(entity_dict)), indent=1))
+            if security_alert.get('entity'):
+                result = self.format_security_type(security_alert['entity'])
+                if result:
+                    security_alert['Entities'] = self.remove_duplicates(result)
+        return security_alert
+
+    def format_security_incident(self, security_incident):
+        """ Format the security incident response
+        :param security_incident: dict
+        :return: dict """
+        if security_incident.get("AdditionalData"):
+            security_incident["AdditionalData"] = json.loads(security_incident["AdditionalData"])
+            if security_incident["AdditionalData"].get('tactics'):
+                security_incident["AdditionalData"]['tactics'] = \
+                    ', '.join(security_incident["AdditionalData"]['tactics'])
+            if security_incident["AdditionalData"].get('techniques'):
+                security_incident["AdditionalData"]['techniques'] = \
+                    ', '.join(security_incident["AdditionalData"]['techniques'])
+            else:
+                security_incident["AdditionalData"]['techniques'] = None
+        if security_incident.get("Owner"):
+            security_incident["Owner"] = json.loads(security_incident["Owner"])
+
+        if security_incident.get("AlertIds"):
+            security_incident["AlertIds"] = json.loads(security_incident["AlertIds"])
+
+        if security_incident.get("ProviderName"):
+            security_incident["ProviderNameIncident"] = security_incident["ProviderName"]
+            security_incident["ProviderName"] = None
+
+        return security_incident
+
+    @staticmethod
+    def format_security_type(entity):
+        """ Convert the type as dict key
+        :param entity: list
+        :return: dict """
+        result = {}
+        for obj in entity:
+            if entity[obj].get("Type"):
+                if entity[obj].get("Type") == 'file':
+                    filehash = {}
+                    for row in entity[obj].get("FileHashes", []):
+                        if row.get("Algorithm") and row.get("Value"):
+                            filehash[row["Algorithm"]] = row["Value"]
+                    if filehash:
+                        entity[obj]["FileHashes"] = filehash
+
+                if entity[obj].get("Type") == 'process' and entity[obj].get('ImageFile'):
+                    filehash = {}
+                    for row in entity[obj]['ImageFile'].get("FileHashes", []):
+                        if row.get("Algorithm") and row.get("Value"):
+                            filehash[row["Algorithm"]] = row["Value"]
+                    if filehash:
+                        entity[obj]['ImageFile']["FileHashes"] = filehash
+
+                if entity[obj].get("Type") == 'process' and entity[obj].get("ParentProcess") and \
+                        entity[obj]["ParentProcess"].get('ImageFile'):
+                    filehash = {}
+                    for row in entity[obj]["ParentProcess"]['ImageFile'].get("FileHashes", []):
+                        if row.get("Algorithm") and row.get("Value"):
+                            filehash[row["Algorithm"]] = row["Value"]
+                    if filehash:
+                        entity[obj]["ParentProcess"]['ImageFile']["FileHashes"] = filehash
+
+                if entity[obj]["Type"] in result:
+                    if isinstance(result[entity[obj]["Type"]], list):
+                        result[entity[obj]["Type"]].append(entity[obj])
+                    else:
+                        result[entity[obj]["Type"]] = [result[entity[obj]["Type"]], entity[obj]]
+                else:
+                    result[entity[obj]["Type"]] = entity[obj]
+        return result
+
+    @staticmethod
+    def find_filehash_map(obj):
+        """ Find file hash mappings based on length
+        :param obj: obj
+        :return: obj """
+        if re.compile("^[a-f0-9]{32}$").match(obj["FileHash"]):
+            obj['MD5'] = obj["FileHash"]
+        elif re.compile(r'\b[0-9a-f]{40}\b').match(obj["FileHash"]):
+            obj['SHA1'] = obj["FileHash"]
+        elif re.compile("[A-Fa-f0-9]{64}").match(obj["FileHash"]):
+            obj['SHA256'] = obj["FileHash"]
+        return obj
+
+    @staticmethod
+    def remove_duplicates(data):
+        """ Remove the duplicated records
+        :param data: dict
+        :return: dict """
+        copied_data = copy.deepcopy(data)
+        for key, value in data.items():
+            if isinstance(value, list):
+                for index, val in enumerate(value):
+                    if str(value).count("{'$id': '" + val.get('$id')) > 1:
+                        copied_data[key].remove(val)
+        return copied_data
+
+    @staticmethod
+    def add_account_type(_dict):
+        """ Add the account type as dict key
+        :param _dict: dict
+        :return: dict """
+        if _dict.get('IsDomainJoined') is True:
+            _dict["AccountType"] = "windows-domain"
+        elif _dict.get('IsDomainJoined') is False:
+            _dict["AccountType"] = "windows-local"
+        return _dict
+
+    @staticmethod
+    def remove_unwanted_ref(entity):
+        """ Remove the unwanted references
+        :param entity: dict
+        :return: dict """
+        keys = entity.keys()
+        for key, value in entity.items():
+            ref_list = re.findall(r"ref': '#([^>]*?)'", str(value))
+            for ref in ref_list:
+                if ref not in keys:
+                    entity[key] = json.loads(json.dumps(entity[key]).replace(f'$ref": "#{ref}', f'ref": "#{ref}'))
+        return entity
```

## stix_shifter_modules/azure_log_analytics/stix_transmission/error_mapper.py

```diff
@@ -1,68 +1,38 @@
-""""Azure Sentinal connector specified error handling"""
 from stix_shifter_utils.utils.error_mapper_base import ErrorMapperBase
 from stix_shifter_utils.utils.error_response import ErrorCode
 from stix_shifter_utils.utils import logger
 
-ERROR_MAPPING = {
-    "json_parse_exception": ErrorCode.TRANSMISSION_QUERY_PARSING_ERROR,
-    "HTTPSConnectionError": ErrorCode.TRANSMISSION_CONNECT,
-    "invalid_instance": ErrorCode.TRANSMISSION_INVALID_PARAMETER,
-    "invalid_request": ErrorCode.TRANSMISSION_AUTH_CREDENTIALS,
-    "invalid_client": ErrorCode.TRANSMISSION_AUTH_CREDENTIALS,
-    "unauthorized_client": ErrorCode.TRANSMISSION_AUTH_CREDENTIALS,
-    # Azure specific exception
-    "BadRequest": ErrorCode.TRANSMISSION_INVALID_PARAMETER,
-    "SyntaxError": ErrorCode.TRANSMISSION_QUERY_PARSING_ERROR,
-    "InvalidAuthenticationToken": ErrorCode.TRANSMISSION_AUTH_CREDENTIALS,
-    "accessDenied": ErrorCode.TRANSMISSION_AUTH_CREDENTIALS,
-    "activityLimitReached": ErrorCode.TRANSMISSION_SEARCH_DOES_NOT_EXISTS,
-    "generalException": ErrorCode.TRANSMISSION_QUERY_PARSING_ERROR,
-    "invalidRange": ErrorCode.TRANSMISSION_RESPONSE_EMPTY_RESULT,
-    "invalidRequest": ErrorCode.TRANSMISSION_INVALID_PARAMETER,
-    "itemNotFound": ErrorCode.TRANSMISSION_RESPONSE_EMPTY_RESULT,
-    "malwareDetected": ErrorCode.TRANSMISSION_INVALID_PARAMETER,
-    "nameAlreadyExists": ErrorCode.TRANSMISSION_QUERY_LOGICAL_ERROR,
-    "notAllowed": ErrorCode.TRANSMISSION_CONNECT,
-    "notSupported": ErrorCode.TRANSMISSION_CONNECT,
-    "resourceModified": ErrorCode.TRANSMISSION_INVALID_PARAMETER,
-    "resyncRequired": ErrorCode.TRANSMISSION_INVALID_PARAMETER,
-    "serviceNotAvailable": ErrorCode.TRANSMISSION_CONNECT,
-    "quotaLimitReached": ErrorCode.TRANSMISSION_SEARCH_DOES_NOT_EXISTS,
-    "unauthenticated": ErrorCode.TRANSMISSION_AUTH_CREDENTIALS,
-    "ResourceNotFound": ErrorCode.TRANSMISSION_INVALID_PARAMETER,
-    # Azure SDK error
-    "BadArgumentError": ErrorCode.TRANSMISSION_QUERY_PARSING_ERROR,
-    "WorkspaceNotFoundError": ErrorCode.TRANSMISSION_INVALID_PARAMETER,
-    "PathNotFoundError": ErrorCode.TRANSMISSION_INVALID_PARAMETER
+error_mapping = {
+    400: ErrorCode.TRANSMISSION_QUERY_PARSING_ERROR,
+    401: ErrorCode.TRANSMISSION_AUTH_CREDENTIALS,
+    404: ErrorCode.TRANSMISSION_INVALID_PARAMETER,
+    408: ErrorCode.TRANSMISSION_CONNECT,
+    500: ErrorCode.TRANSMISSION_REMOTE_SYSTEM_IS_UNAVAILABLE
 }
 
 
 class ErrorMapper:
     """"ErrorMapper class"""
     logger = logger.set_logger(__name__)
     DEFAULT_ERROR = ErrorCode.TRANSMISSION_MODULE_DEFAULT_ERROR
 
     @staticmethod
     def set_error_code(json_data, return_obj, connector=None):
-        """ms_atp transmit specified error
-         :param json_data: dict, error response of api_call
-         :param return_obj: dict, returns error and error code"""
-        error_type = ''
-
-        if isinstance(json_data, tuple):
-            error_type = 'HTTPSConnectionError'
-        else:
-            try:
-                error_type = json_data['code']
-            except Exception:
-                error_type = json_data['error']
+        """azure log analytics transmit specified error
+        :param json_data: dict, error response of api_call
+        :param return_obj: dict, returns error and error code"""
+        code = None
+        try:
+            code = int(json_data['code'])
+        except Exception:
+            pass
 
         error_code = ErrorMapper.DEFAULT_ERROR
 
-        if error_type in ERROR_MAPPING:
-            error_code = ERROR_MAPPING[error_type]
+        if code in error_mapping:
+            error_code = error_mapping.get(code)
 
         if error_code == ErrorMapper.DEFAULT_ERROR:
-            ErrorMapper.logger.debug("failed to map: " + str(json_data))
+            ErrorMapper.logger.error("failed to map: %s", str(json_data))
 
         ErrorMapperBase.set_error_code(return_obj, error_code, connector=connector)
```

## Comparing `stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/LICENSE.md` & `stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/LICENSE.md`

 * *Files identical despite different names*

## Comparing `stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/METADATA` & `stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,25 +1,26 @@
 Metadata-Version: 2.1
 Name: stix-shifter-modules-azure-log-analytics
-Version: 5.3.1
+Version: 6.0.0.dev74
 Summary: Tools and interface to translate STIX formatted results and queries to different data source formats and to set up appropriate connection strings for invoking and triggering actions in openwhisk
 Home-page: https://github.com/opencybersecurityalliance/stix-shifter
 Author: ibm
 Author-email: 
 Project-URL: Source, https://github.com/opencybersecurityalliance/stix-shifter
 Keywords: datasource stix translate transform transmit
 Classifier: License :: OSI Approved :: Apache Software License
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Description-Content-Type: text/markdown
 License-File: LICENSE.md
 License-File: NOTICE
-Requires-Dist: azure-monitor-query (==1.0.2)
 Requires-Dist: urllib3 (==1.26.15)
 Requires-Dist: pandas (==1.5.2)
+Requires-Dist: jsonref (==1.1.0)
+Requires-Dist: azure-monitor-query (==1.0.2)
 
 [![example workflow](https://github.com/opencybersecurityalliance/stix-shifter/actions/workflows/main.yml/badge.svg)](https://github.com/opencybersecurityalliance/stix-shifter/actions)
 [![codecov](https://codecov.io/gh/opencybersecurityalliance/stix-shifter/branch/develop/graph/badge.svg?token=gQvl14peRj)](https://codecov.io/gh/opencybersecurityalliance/stix-shifter)
 
 # Introduction to STIX-Shifter
 
 STIX-shifter is an open source python library allowing software to connect to products that house data repositories by using STIX Patterning, and return results as STIX Observations.
```

## Comparing `stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/NOTICE` & `stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/NOTICE`

 * *Files identical despite different names*

## Comparing `stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/RECORD` & `stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/RECORD`

 * *Files 22% similar despite different names*

```diff
@@ -1,28 +1,30 @@
 stix_shifter_modules/azure_log_analytics/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-stix_shifter_modules/azure_log_analytics/entry_point.py,sha256=Ny-_DGaRsXQ558-B__y80fKgjmksoPfS-s0Ik_9kHS4,702
-stix_shifter_modules/azure_log_analytics/configuration/config.json,sha256=98CuwktwBPfOa9qOz-TSkxLMqbYoBz1ks2tiAu09f6g,34280
+stix_shifter_modules/azure_log_analytics/entry_point.py,sha256=U41od7uxi0PvrTf-kamNszSI7LxF3rg2HZ90x3n1Rio,432
+stix_shifter_modules/azure_log_analytics/configuration/config.json,sha256=E5eJPK12W2ftRmQM_Wzctde3A2sCx72mGwcfCo9Ck0Y,106615
 stix_shifter_modules/azure_log_analytics/configuration/dialects.json,sha256=fDZS6NwaG9CYxur-4nmI65LnxVpJoX5LCGfk3eCa8tU,251
-stix_shifter_modules/azure_log_analytics/configuration/lang_en.json,sha256=QXOOXFasThHLyvz7zfoW78UDOFfER7w2EyjuznZLmJc,3366
+stix_shifter_modules/azure_log_analytics/configuration/lang_en.json,sha256=Pnw6k_5FKJXNw8kyiiQUQ541vDkmr5G3QfQ9K2ido-U,3348
 stix_shifter_modules/azure_log_analytics/stix_translation/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-stix_shifter_modules/azure_log_analytics/stix_translation/json_to_stix_translator.py,sha256=vffR1MRpwX6NMwXy0MldaTecIIzvVSZIlcqXOM8Nx7I,22646
-stix_shifter_modules/azure_log_analytics/stix_translation/query_constructor.py,sha256=XY4WZoHRkiVhgjue67PT7kYIIbfYHg5ya_f5dRawgOU,17603
+stix_shifter_modules/azure_log_analytics/stix_translation/json_to_stix_translator.py,sha256=mlzibasm2UfSGhYqHoH2hMFHlx7XCy35VSlzzFTWpjc,27024
+stix_shifter_modules/azure_log_analytics/stix_translation/query_constructor.py,sha256=UsW8g1GoarFBNPJqYYtP1aNDxBtPJ5heceLzm8ju6Yk,22079
 stix_shifter_modules/azure_log_analytics/stix_translation/query_translator.py,sha256=3YEkKNfWzvpt16rkPzfAtKQjzo039Gyo-Ff9s95vnsA,1037
-stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityAlert_from_stix_map.json,sha256=MtUPNhpa-Ce2QJixO_2n_xIwPtW2j3oCmFwW0lILKf8,1949
-stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityEvent_from_stix_map.json,sha256=cxEU_fD01n1NlL5_PSTnddJNqAvO1wbqDL4AYzRRkE8,3671
-stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityIncident_from_stix_map.json,sha256=1bwg5BjGpixRbHb9DUWPzMWpZ1WoFDLbdCkZuIXtZpw,1733
-stix_shifter_modules/azure_log_analytics/stix_translation/json/operators.json,sha256=YQyH97rxEPMiUHjvfRknnM5y_8cFHe-5WhiT-3DmcfM,326
-stix_shifter_modules/azure_log_analytics/stix_translation/json/to_stix_map.json,sha256=x6RR_U3Y7M1WqbdAsiKw7nzKUhKbKuXDc-0X5CXfj6A,8827
-stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/SecurityAlert_from_stix_map.json,sha256=bogbZDZ0nmjwMSoxUpeQgkosT54eZ5sZ1atpY66sGBw,1951
-stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/SecurityEvent_from_stix_map.json,sha256=B2Fnsy1KvxCl0fKD_xp9HxjwnXMHJf0gtGRlOAFt5JI,3672
-stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/SecurityIncident_from_stix_map.json,sha256=65s2Si3qkGoXXq_IYyHE5LNUlALy7ijo0ul0UqE1ELY,1735
-stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/to_stix_map.json,sha256=GZFxnbNroTfFSWBHLQUvr2XEK2FBug3KzDO9KAr0pr4,8964
+stix_shifter_modules/azure_log_analytics/stix_translation/transformers.py,sha256=ks4ldlKbN2kAISotWPNoledOY5tx4XAtXGs-dpyA3sI,2918
+stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityAlert_from_stix_map.json,sha256=joobwKH8j1Jsy6ydHF-5jOSZNsKLQWwmhqwm3RMZKkc,6519
+stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityEvent_from_stix_map.json,sha256=fFVNEXRy3xgvMqyhXjFn3B9ltcZ6XXbU9Oh0xfvM83M,3823
+stix_shifter_modules/azure_log_analytics/stix_translation/json/SecurityIncident_from_stix_map.json,sha256=P6Ku3FI9nmd0vnslxfx9lbh_8BlJBaOiyyMMXY2vi3k,2539
+stix_shifter_modules/azure_log_analytics/stix_translation/json/config_map.json,sha256=CiFRCRV3m2IIjMEvZfvs_MpmkBw-tEEMcOrQDd2EAhY,987
+stix_shifter_modules/azure_log_analytics/stix_translation/json/operators.json,sha256=KktjDm_qmC1tiAZI3xMz52nv-wXRhYWeBB4RgIRYfA8,589
+stix_shifter_modules/azure_log_analytics/stix_translation/json/to_stix_map.json,sha256=3IhapIcUehBWgC_0q2H9Vf-G1SNW87vDVt2lWgtGJvE,28863
+stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/SecurityAlert_from_stix_map.json,sha256=EL1_ONx0-pxt6-ifa6ZWTA6KmfKwWj6xMSY7ixeTz_4,6521
+stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/SecurityEvent_from_stix_map.json,sha256=7OUXtSiWEcSaegBZxAalx5iooIAcgmqSvkB0kKHj1oU,3825
+stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/SecurityIncident_from_stix_map.json,sha256=Xji18N1poT--avk-JmG3opPk8pgdd1W6MuqlCVklPD0,2541
+stix_shifter_modules/azure_log_analytics/stix_translation/json/stix_2_1/to_stix_map.json,sha256=kdblBNCFE2y6eK-DdbDaknkGcXND6jwxTydvNFL40-c,28869
 stix_shifter_modules/azure_log_analytics/stix_transmission/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-stix_shifter_modules/azure_log_analytics/stix_transmission/api_client.py,sha256=cSmboAqbOfP4WKJD3JpcDCKz7m2lCbsdRcp3CHFEG3Q,2957
-stix_shifter_modules/azure_log_analytics/stix_transmission/connector.py,sha256=L3bhfYkYIAnlSpfG7uehgldjioAUwFM0a80jxAID9Js,4029
-stix_shifter_modules/azure_log_analytics/stix_transmission/error_mapper.py,sha256=coWuJ2NSFzTForyAoL2ZrjAdasAYNB2NvUOTriKfF1U,3159
-stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/LICENSE.md,sha256=ssGEKMVW69oFTBblVhD1YPolqCOyOCJi4wRDRI7xCnU,12786
-stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/METADATA,sha256=N5s4gs7_kKwbXMVV26Ih2zziew-88M-Qa1vSPeglY2o,8161
-stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/NOTICE,sha256=wx-gWE9vSnLJ7YQkrGlMp9VNXOXG57TTxDDRd9CEdYg,1418
-stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/WHEEL,sha256=bb2Ot9scclHKMOLDEHY6B2sicWOgugjFKaJsT7vwMQo,110
-stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/top_level.txt,sha256=NX-VgUOr8fI-lMXHt3gtjfsEn1UPaGAVszt6Z_CTp2s,21
-stix_shifter_modules_azure_log_analytics-5.3.1.dist-info/RECORD,,
+stix_shifter_modules/azure_log_analytics/stix_transmission/api_client.py,sha256=UUqatJT4p1wPrE7LjW-DF9uTzRUqETKBqmF4JFGQdPw,2926
+stix_shifter_modules/azure_log_analytics/stix_transmission/connector.py,sha256=fcO76Fp4PYdqL3-V-uJLdAPNAfTdXlcB17kHoYvBfHQ,14831
+stix_shifter_modules/azure_log_analytics/stix_transmission/error_mapper.py,sha256=S7vWp7lq-XmNesIpIw7q8sBMdVdhtW4atTSR0spTVoU,1333
+stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/LICENSE.md,sha256=ssGEKMVW69oFTBblVhD1YPolqCOyOCJi4wRDRI7xCnU,12786
+stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/METADATA,sha256=k7OkE-a4IPLRZuZqhB0hyTL2SvlseEv2NQdPjjrsfWM,8200
+stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/NOTICE,sha256=wx-gWE9vSnLJ7YQkrGlMp9VNXOXG57TTxDDRd9CEdYg,1418
+stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/WHEEL,sha256=bb2Ot9scclHKMOLDEHY6B2sicWOgugjFKaJsT7vwMQo,110
+stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/top_level.txt,sha256=NX-VgUOr8fI-lMXHt3gtjfsEn1UPaGAVszt6Z_CTp2s,21
+stix_shifter_modules_azure_log_analytics-6.0.0.dev74.dist-info/RECORD,,
```

