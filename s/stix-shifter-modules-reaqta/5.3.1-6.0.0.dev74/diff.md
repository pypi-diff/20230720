# Comparing `tmp/stix_shifter_modules_reaqta-5.3.1-py2.py3-none-any.whl.zip` & `tmp/stix_shifter_modules_reaqta-6.0.0.dev74-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,30 +1,29 @@
-Zip file size: 58447 bytes, number of entries: 28
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/__init__.py
--rw-rw-r--  2.0 unx      409 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/entry_point.py
--rw-rw-r--  2.0 unx   159017 b- defN 23-Jun-15 14:07 stix_shifter_modules/reaqta/configuration/config.json
--rw-rw-r--  2.0 unx       78 b- defN 23-Jun-15 14:07 stix_shifter_modules/reaqta/configuration/dialects.json
--rw-rw-r--  2.0 unx     2918 b- defN 23-Jun-15 14:07 stix_shifter_modules/reaqta/configuration/lang_en.json
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/stix_translation/__init__.py
--rw-rw-r--  2.0 unx    22646 b- defN 23-Jun-15 14:07 stix_shifter_modules/reaqta/stix_translation/json_to_stix_translator.py
--rw-rw-r--  2.0 unx    10518 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/stix_translation/query_constructor.py
--rw-rw-r--  2.0 unx     1031 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/stix_translation/query_translator.py
--rw-rw-r--  2.0 unx     2920 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/stix_translation/results_translator.py
--rw-rw-r--  2.0 unx      401 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/stix_translation/transformers.py
--rw-rw-r--  2.0 unx     2860 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/stix_translation/json/event_names_map.json
--rw-rw-r--  2.0 unx    11504 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/stix_translation/json/from_stix_map.json
--rw-rw-r--  2.0 unx       51 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/stix_translation/json/network_protocol_map.json
--rw-rw-r--  2.0 unx      477 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/stix_translation/json/operators.json
--rw-rw-r--  2.0 unx    57521 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/stix_translation/json/to_stix_map.json
--rw-rw-r--  2.0 unx    11627 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/stix_translation/json/stix_2_1/from_stix_map.json
--rw-rw-r--  2.0 unx    58611 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/stix_translation/json/stix_2_1/to_stix_map.json
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/stix_transmission/__init__.py
--rw-rw-r--  2.0 unx     3834 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/stix_transmission/api_client.py
--rw-rw-r--  2.0 unx     5029 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/stix_transmission/connector.py
--rw-rw-r--  2.0 unx    15025 b- defN 23-Jun-15 14:04 stix_shifter_modules/reaqta/test/stix_translation/json/event_result.json
--rw-rw-r--  2.0 unx    12786 b- defN 23-Jun-15 14:07 stix_shifter_modules_reaqta-5.3.1.dist-info/LICENSE.md
--rw-rw-r--  2.0 unx     8036 b- defN 23-Jun-15 14:07 stix_shifter_modules_reaqta-5.3.1.dist-info/METADATA
--rw-rw-r--  2.0 unx     1418 b- defN 23-Jun-15 14:07 stix_shifter_modules_reaqta-5.3.1.dist-info/NOTICE
--rw-rw-r--  2.0 unx      110 b- defN 23-Jun-15 14:07 stix_shifter_modules_reaqta-5.3.1.dist-info/WHEEL
--rw-rw-r--  2.0 unx       21 b- defN 23-Jun-15 14:07 stix_shifter_modules_reaqta-5.3.1.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     3211 b- defN 23-Jun-15 14:07 stix_shifter_modules_reaqta-5.3.1.dist-info/RECORD
-28 files, 392059 bytes uncompressed, 52941 bytes compressed:  86.5%
+Zip file size: 59164 bytes, number of entries: 27
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/__init__.py
+-rw-rw-r--  2.0 unx      409 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/entry_point.py
+-rw-rw-r--  2.0 unx   159021 b- defN 23-Jul-20 18:39 stix_shifter_modules/reaqta/configuration/config.json
+-rw-rw-r--  2.0 unx       78 b- defN 23-Jul-20 18:39 stix_shifter_modules/reaqta/configuration/dialects.json
+-rw-rw-r--  2.0 unx     2902 b- defN 23-Jul-20 18:39 stix_shifter_modules/reaqta/configuration/lang_en.json
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/stix_translation/__init__.py
+-rw-rw-r--  2.0 unx    27024 b- defN 23-Jul-20 18:39 stix_shifter_modules/reaqta/stix_translation/json_to_stix_translator.py
+-rw-rw-r--  2.0 unx    10518 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/stix_translation/query_constructor.py
+-rw-rw-r--  2.0 unx     1031 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/stix_translation/query_translator.py
+-rw-rw-r--  2.0 unx      401 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/stix_translation/transformers.py
+-rw-rw-r--  2.0 unx     2860 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/stix_translation/json/event_names_map.json
+-rw-rw-r--  2.0 unx    11504 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/stix_translation/json/from_stix_map.json
+-rw-rw-r--  2.0 unx       51 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/stix_translation/json/network_protocol_map.json
+-rw-rw-r--  2.0 unx      477 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/stix_translation/json/operators.json
+-rw-rw-r--  2.0 unx    57521 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/stix_translation/json/to_stix_map.json
+-rw-rw-r--  2.0 unx    11627 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/stix_translation/json/stix_2_1/from_stix_map.json
+-rw-rw-r--  2.0 unx    58611 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/stix_translation/json/stix_2_1/to_stix_map.json
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/stix_transmission/__init__.py
+-rw-rw-r--  2.0 unx     3834 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/stix_transmission/api_client.py
+-rw-rw-r--  2.0 unx     8114 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/stix_transmission/connector.py
+-rw-rw-r--  2.0 unx    15078 b- defN 23-Jul-20 18:36 stix_shifter_modules/reaqta/test/stix_translation/json/event_result.json
+-rw-rw-r--  2.0 unx    12786 b- defN 23-Jul-20 18:39 stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/LICENSE.md
+-rw-rw-r--  2.0 unx     8042 b- defN 23-Jul-20 18:39 stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/METADATA
+-rw-rw-r--  2.0 unx     1418 b- defN 23-Jul-20 18:39 stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/NOTICE
+-rw-rw-r--  2.0 unx      110 b- defN 23-Jul-20 18:39 stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       21 b- defN 23-Jul-20 18:39 stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     3124 b- defN 23-Jul-20 18:39 stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/RECORD
+27 files, 396562 bytes uncompressed, 53794 bytes compressed:  86.4%
```

## zipnote {}

```diff
@@ -21,17 +21,14 @@
 
 Filename: stix_shifter_modules/reaqta/stix_translation/query_constructor.py
 Comment: 
 
 Filename: stix_shifter_modules/reaqta/stix_translation/query_translator.py
 Comment: 
 
-Filename: stix_shifter_modules/reaqta/stix_translation/results_translator.py
-Comment: 
-
 Filename: stix_shifter_modules/reaqta/stix_translation/transformers.py
 Comment: 
 
 Filename: stix_shifter_modules/reaqta/stix_translation/json/event_names_map.json
 Comment: 
 
 Filename: stix_shifter_modules/reaqta/stix_translation/json/from_stix_map.json
@@ -60,26 +57,26 @@
 
 Filename: stix_shifter_modules/reaqta/stix_transmission/connector.py
 Comment: 
 
 Filename: stix_shifter_modules/reaqta/test/stix_translation/json/event_result.json
 Comment: 
 
-Filename: stix_shifter_modules_reaqta-5.3.1.dist-info/LICENSE.md
+Filename: stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/LICENSE.md
 Comment: 
 
-Filename: stix_shifter_modules_reaqta-5.3.1.dist-info/METADATA
+Filename: stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/METADATA
 Comment: 
 
-Filename: stix_shifter_modules_reaqta-5.3.1.dist-info/NOTICE
+Filename: stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/NOTICE
 Comment: 
 
-Filename: stix_shifter_modules_reaqta-5.3.1.dist-info/WHEEL
+Filename: stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/WHEEL
 Comment: 
 
-Filename: stix_shifter_modules_reaqta-5.3.1.dist-info/top_level.txt
+Filename: stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/top_level.txt
 Comment: 
 
-Filename: stix_shifter_modules_reaqta-5.3.1.dist-info/RECORD
+Filename: stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## stix_shifter_modules/reaqta/configuration/config.json

### Pretty-printed

 * *Similarity: 0.9965277777777778%*

 * *Differences: {"'connection'": "{'type': {'displayName': 'IBM Security QRadar EDR'}}"}*

```diff
@@ -2934,13 +2934,13 @@
             "type": "number"
         },
         "selfSignedCert": {
             "optional": true,
             "type": "password"
         },
         "type": {
-            "displayName": "IBM Security ReaQta",
+            "displayName": "IBM Security QRadar EDR",
             "group": "reaqta",
             "type": "connectorType"
         }
     }
 }
```

## stix_shifter_modules/reaqta/configuration/lang_en.json

### Pretty-printed

 * *Similarity: 0.9713541666666666%*

 * *Differences: {"'configuration'": "{'auth': {'app_id': {'label': 'App ID', 'description': 'App ID with access to "*

 * *                    "the Hunt API'}, 'secret_key': {'description': 'App Secret Key with access to "*

 * *                    "the Hunt API'}}}",*

 * * "'connection'": "{'selfSignedCert': {'label': 'Self-signed certificate'}}"}*

```diff
@@ -1,16 +1,16 @@
 {
     "configuration": {
         "auth": {
             "app_id": {
-                "description": "Reaqta App ID with access to the Hunt API",
-                "label": "Reaqta app ID"
+                "description": "App ID with access to the Hunt API",
+                "label": "App ID"
             },
             "secret_key": {
-                "description": "Reaqta App Secret Key with access to the Hunt API",
+                "description": "App Secret Key with access to the Hunt API",
                 "label": "Secret key"
             }
         }
     },
     "connection": {
         "help": {
             "description": "More details on the data source setting can be found in the specified link",
@@ -56,15 +56,15 @@
             }
         },
         "port": {
             "description": "Set the port number that is associated with the hostname or IP address",
             "label": "Host port"
         },
         "selfSignedCert": {
-            "label": "ReaQta certificate",
+            "label": "Self-signed certificate",
             "placeholder": "Paste your certificate"
         },
         "type": {
             "description": "Data source type"
         }
     }
 }
```

## stix_shifter_modules/reaqta/stix_translation/json_to_stix_translator.py

```diff
@@ -118,22 +118,22 @@
                 if not match(str(stix_value)):
                     return False
             return True
         except Exception as e:
             self.logger.debug("Failed to validate STIX property '{}' with value '{}'. Exception: {}".format(observable_key, stix_value, e))
             return False
 
-    def _compose_value_object(self, value, key_list, observable_key=None, object_tag_ref_map=None, transformer=None, references=None, unwrap=False):
+    def _compose_value_object(self, value, key_list, observable_key=None, object_tag_ref_map=None, transformer=None, references=None, unwrap=False, is_group_ref=False):
         """
         Converts the value of the data to STIX valid value
         """
         try:
             return_value = {}
             for key in key_list:
-                return_value[key] = self._compose_value_object(value, key_list[1:], observable_key=observable_key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
+                return_value[key] = self._compose_value_object(value, key_list[1:], observable_key=observable_key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap, is_group_ref=is_group_ref)
                 break
             else:
                 if transformer:
                     try: 
                         value = transformer.transform(value)
                         if value is None:
                             return None
@@ -141,21 +141,39 @@
                         return None
                 
                 if references:
                     if isinstance(references, list):
                         return_value = []
                         for ref in references:
                             if not isinstance(value, list):
-                                value = [value]
-                            for i, _ in enumerate(value):
-                                parent_key_ind = self._get_tag_ind(ref, object_tag_ref_map, create_on_absence=False, unwrap=i)
+                                # Fetch the index of reference object name which has a single value.
+                                parent_key_ind = self._get_tag_ind(ref, object_tag_ref_map, create_on_absence=False)
                                 if parent_key_ind:
                                     return_value.append(parent_key_ind)
+                            else:
+                                for i, _ in enumerate(value):
+                                    parent_key_ind = self._get_tag_ind(ref, object_tag_ref_map, create_on_absence=False, unwrap=str(i))
+                                    if parent_key_ind:
+                                        return_value.append(parent_key_ind)
+                                    # Iterate through the object_tag_ref_map to fetch the index, for grouping
+                                    # reference objects of nested type through group_ref.
+                                    elif is_group_ref:
+                                        list_parent_ind = ref + '_' + str(i)
+                                        for key, val in object_tag_ref_map['tags'].items():
+                                            if key.startswith(list_parent_ind):
+                                                return_value.append(
+                                                    self._get_tag_ind(key, object_tag_ref_map, create_on_absence=False))
+
                     else:
-                        return_value = self._get_tag_ind(references, object_tag_ref_map, create_on_absence=False)
+                        # Fetch first object (index 0) for single reference when the value is of type list .
+                        if isinstance(value, list):
+                            return_value = self._get_tag_ind(references, object_tag_ref_map, create_on_absence=False,
+                                                             unwrap='0')
+                        else:
+                            return_value = self._get_tag_ind(references, object_tag_ref_map, create_on_absence=False)
                         # if the property has unwrap true and is not a list, convert to list
                         if unwrap is True and not isinstance(return_value, list):
                             return_value = [return_value]
 
                     if not return_value:
                         return None
                 else:
@@ -247,28 +265,38 @@
                 if isinstance(to_stix_config_prop, dict) and to_stix_config_prop.get('key') is not None and not isinstance(to_stix_config_prop.get('key'), dict):
                     # data variable is the final value, process in bulk
                     self._handle_value(data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind)
 
                 elif isinstance(data, list):
                     for i, d in enumerate(data):
                         if isinstance(d, list) or isinstance(d, dict):
-                            self._handle_properties(to_stix_config_prop, d, objects, object_tag_ref_map, data, ds_sub_key, i)
+                            # Added parent key indexes to inner objects in order to handle nested lists of
+                            # dictionaries and lists. For Example, if a list of IP address is present inside
+                            # a list of network objects, then without adding this code, only the IP address information
+                            # in the first network object will be created and the rest are not created.
+                            if object_key_ind:
+                                i = str(object_key_ind) + '_' + str(i)
+                            # Inorder to include 0th index, the integer field 'i' is converted to string.
+                            self._handle_properties(to_stix_config_prop, d, objects, object_tag_ref_map, data, ds_sub_key, str(i))
                         else:
                             # data variable is the final value, process in bulk
                             self._handle_value(data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind)
                             break
                     # group the references of list of dictionary field
                     if isinstance(to_stix_config_prop, dict):
                         group_refs = [key for key, value in to_stix_config_prop.items() if
                                       isinstance(value, dict) and value.get('group_ref') and value.get(
                                           'references')]
                         for group_ref in group_refs:
+                            # Added a new boolean (True) parameter (is_group_ref) to indicate grouping of references
+                            # through group_ref key in mapping
                             self._handle_value(data, to_stix_config_prop, ds_sub_key,
                                                to_stix_config_prop[group_ref],
-                                               objects, object_tag_ref_map, object_key_ind)
+                                               objects, object_tag_ref_map, object_key_ind, True)
+
                 elif isinstance(data, dict):
                     for k in data:
                         cust_prop = None
                         if k in to_stix_config_prop:
                             cust_prop = to_stix_config_prop[k]
                         elif self.options.get('unmapped_fallback') and k not in object_tag_ref_map['ds_key_cybox']:
                             cust_prop = {"key": "x-" + self.data_source.replace("_", "-") + "." + k, "object": "cust_object"}
@@ -277,15 +305,15 @@
                             self._handle_properties(cust_prop, data[k], objects, object_tag_ref_map, data, k, object_key_ind)
                 else:
                     self._handle_value(data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind)
         except Exception as e:
             raise Exception("Error in json_to_stix_translator._handle_properties: %s" % e)
 
 
-    def _handle_value(self, data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind=None):
+    def _handle_value(self, data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind=None, is_group_ref=False):
         """
         Receives the raw value of a data property, converts to a STIX valid value and adds to the cached observable `objects` dictionary
         """
         try: 
             if isinstance(to_stix_config_prop, dict):
                 props = [to_stix_config_prop]
             else:
@@ -294,14 +322,29 @@
             for prop in props:
                 key = prop.get('key', None)
                 if key is None:
                     continue
 
                 transformer = self.transformers[prop['transformer']] if 'transformer' in prop else None
                 references = references = prop['references'] if 'references' in prop else None
+
+                # This check avoid using duplicate reference in the multiple objects of the same type.
+                # For example: If there are multiple source ipv4-addr and network-traffic objects then
+                # without this reference check the first source ipv4-addr object will be referenced to all network-traffic objects.
+                if references:
+                    if isinstance(references, str):
+                        if object_key_ind:
+                            references = references + '_' + str(object_key_ind)
+                        elif not isinstance(data, list):
+                            references = references + '_' + '0'
+                    elif isinstance(references, list):
+                        if object_key_ind:
+                            references = [ref + '_' + str(object_key_ind) for ref in references]
+                        elif not isinstance(data, list):
+                            references = [ref + '_' + '0' for ref in references]
                 # unwrap array of stix values to separate stix objects
                 unwrap = True if 'unwrap' in prop and isinstance(data, list) else False
                 if "." in key:
                     cybox = True
                 else:
                     cybox = False
                 
@@ -334,33 +377,44 @@
                     if False is cybox and not substitute_key:
                         value = self._compose_value_object(data, config_keys[2:], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
                         self._add_property(type_name, property_key, type_name, value, object_tag_ref_map['out_cybox'], cybox=False)
                         continue
 
                     if object_key_ind:
                         parent_key = parent_key + '_' + str(object_key_ind)
+                    # Adding _0 as a tag index for the following
+                    # 1. For object name of non-list type data or unwrapped data
+                    # 2. For the object name containing references to list type of data.
+                    # For Example, when a single IP address value and references to the list of domain values, needs
+                    # to be added to a single custom object, the 0th index is added to the custom object to have ip
+                    # address and references to list of domains under the same custom object.
+                    elif (isinstance(data, list) and not unwrap and not references) \
+                            or (isinstance(data, list) and references) or (not isinstance(data, list)):
+                        parent_key = parent_key + '_' + '0'
 
                     # use the hard-coded value in the mapping
                     if 'value' in prop:
                         value = prop['value']
                     else:
                         if substitute_key and parent_data:
                             data = parent_data.get(substitute_key)
 
                             if False is cybox:
                                 object_tag_ref_map['ds_key_cybox'][substitute_key] = True
                         
-                        value = self._compose_value_object(data, config_keys[2:], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
+                        value = self._compose_value_object(data, config_keys[2:], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap, is_group_ref=is_group_ref)
 
-                    if value is None or value == '':
+                    # Remove the values which has empty list brackets.
+                    if value is None or value in ('', []):
                         continue
 
                     if not references and unwrap and isinstance(value, list):
                         for i, val_el in enumerate(value):
-                            parent_key_ind = self._get_tag_ind(parent_key, object_tag_ref_map, create_on_absence=True, unwrap=i, property_key=property_key)
+                            # Inorder to include 0th index, the integer field 'i' is converted to string.
+                            parent_key_ind = self._get_tag_ind(parent_key, object_tag_ref_map, create_on_absence=True, unwrap=str(i), property_key=property_key)
                             self._add_property(type_name, property_key, parent_key_ind, val_el, objects, group=group)
                     else:
                         parent_key_ind = self._get_tag_ind(parent_key, object_tag_ref_map, create_on_absence=True, property_key=property_key)
                         self._add_property(type_name, property_key, parent_key_ind, value, objects, group=group)
         except Exception as e:
             raise Exception("Error in json_to_stix_translator._handle_value: %s : %s" % (e, e.__traceback__.tb_lineno))
```

## stix_shifter_modules/reaqta/stix_transmission/connector.py

```diff
@@ -1,8 +1,11 @@
+import os
 import json
+
+from stix_shifter_utils.utils.file_helper import read_json
 from stix_shifter_utils.modules.base.stix_transmission.base_json_sync_connector import BaseJsonSyncConnector
 from .api_client import APIClient
 from stix_shifter_utils.utils.error_response import ErrorResponder
 from stix_shifter_utils.utils import logger
 
 
 class Connector(BaseJsonSyncConnector):
@@ -79,20 +82,86 @@
                             response_dict = json.loads(response.read())
                             if response_code == 200:
                                 return_obj['data'].extend(response_dict['result'])
                         else:
                             break
                     except Exception as ex:
                         raise ex
-                return_obj['data'] = return_obj['data'][offset:total_records]
+                data = return_obj['data'][offset:total_records]
+                Connector.modify_result(data)
+                return_obj['data'] = data
             elif response_code == 422:
                 error_string = 'query_syntax_error: ' + response_dict['message']
                 ErrorResponder.fill_error(return_obj, error_string, ['message'], connector=self.connector)
             else:
                 error_string = 'query_syntax_error: ' + response_dict['message']
                 ErrorResponder.fill_error(return_obj, error_string, ['message'], connector=self.connector)
             
         except Exception as err:
             self.logger.error('error when getting search results: {}'.format(str(err)))
             ErrorResponder.fill_error(return_obj, err, ['message'], connector=self.connector)
         
-        return return_obj
+        return return_obj
+    
+    @classmethod
+    def modify_result(cls, data):
+        transmit_basepath = os.path.abspath(__file__)
+        translate_basepath = transmit_basepath.split(os.sep)
+        event_names_path = os.sep.join([*translate_basepath, "stix_translation", "json", "event_names_map.json"])
+        network_protocol_path = os.sep.join([*translate_basepath, "stix_translation", "json", "network_protocol_map.json"])
+        
+        # network_protocol_path = os.path.abspath(os.path.join(translate_basepath, "json", "network_protocol_map.json"))
+        event_names = read_json(event_names_path, options={})
+        network_protocol = read_json(network_protocol_path, options={})
+        print(data)
+        for result in data:
+            if result.get('payload'):
+                payload = result['payload']
+                if payload.get('eventType'):
+                    event_name = event_names[str(payload.get('eventType'))]
+                    payload['eventName'] = event_name
+                
+                result['payload'] = cls.update_net_traffic_flow(payload, network_protocol)
+    @classmethod
+    def update_net_traffic_flow(cls, payload, network_protocol):
+        result_data = payload.get('data')
+
+        if 'protocol' in result_data:
+            protocol = network_protocol[str(result_data.get('protocol'))]
+            result_data['protocol'] = protocol
+
+        if 'outbound' in result_data:
+            if not result_data['outbound']:
+                temp_local_ip = result_data['localAddr']
+                temp_remote_ip = result_data['remoteAddr']
+                temp_local_port = result_data['localPort']
+                temp_remote_port = result_data['remotePort']
+                result_data['localAddr'] = temp_remote_ip
+                result_data['remoteAddr'] = temp_local_ip
+                result_data['localPort'] = temp_remote_port
+                result_data['remotePort'] = temp_local_port
+        
+        if 'addressFamily' in result_data:
+            address_family = result_data.get('addressFamily')
+            
+            if address_family == 0:
+                result_data['addressFamily'] = 'IPv4'
+                
+                local_addr = result_data['localAddr']
+                result_data['localAddrV4'] = local_addr
+                del result_data['localAddr']
+                
+                remote_addr = result_data['remoteAddr']
+                result_data['remoteAddrV4'] = remote_addr
+                del result_data['remoteAddr']
+            elif address_family == 1:
+                result_data['addressFamily'] = 'IPv6'
+
+                local_addr = result_data['localAddr']
+                result_data['localAddrV6'] = local_addr
+                del result_data['localAddr']
+                
+                remote_addr = result_data['remoteAddr']
+                result_data['remoteAddrV6'] = remote_addr
+                del result_data['remoteAddr']
+
+        return payload
```

## stix_shifter_modules/reaqta/test/stix_translation/json/event_result.json

### Pretty-printed

 * *Similarity: 0.9872222222222222%*

 * *Differences: {"'payload'": "{'data': {'addressFamily': 'IPv4', 'protocol': 'tcp', 'localPort': 443, "*

 * *              "'remotePort': 49818, 'remoteAddrV4': '127.0.0.10', 'localAddrV4': '127.0.0.50', "*

 * *              "delete: ['localAddr', 'remoteAddr']}, 'eventName': 'Service Stopped'}"}*

```diff
@@ -2,15 +2,15 @@
     "endpointId": "841111111118681116",
     "eventId": "846769082492518401",
     "happenedAt": "2022-03-23T14:53:49.483Z",
     "payload": {
         "data": {
             "accessTime": 1643105806911,
             "actionName": "C:\\Program Files (x86)\\Microsoft\\EdgeUpdate\\MicrosoftEdgeUpdate.exe",
-            "addressFamily": 0,
+            "addressFamily": "IPv4",
             "allocationType": 12288,
             "allocatorProc": {
                 "logonId": "0x100009",
                 "noGui": false,
                 "pid": 2736,
                 "ppid": 7252,
                 "privilegeLevel": "MEDIUM",
@@ -167,16 +167,16 @@
                 }
             ],
             "fsName": "vcruntime140.dll",
             "hijackingType": 2,
             "hostPid": 656,
             "isLocal": true,
             "lastWriteTime": 1641371136474,
-            "localAddr": "127.0.0.10",
-            "localPort": 49818,
+            "localAddrV4": "127.0.0.50",
+            "localPort": 443,
             "matched": [
                 {
                     "matcherId": "0000011111114",
                     "policyId": "0000011111112",
                     "versionId": "0000011111113"
                 }
             ],
@@ -187,23 +187,23 @@
             "newFile": "c:\\users\\Example User\\appdata\\roaming\\microsoft\\word\\zrothschild_cv3093900000000000086502\\zrothschild_cv((unsaved-30000000000000608)).asd",
             "operation": "start iwbemservices::execquery - root\\cimv2 : select id from win32_serverfeature",
             "originalSize": 5186,
             "outbound": true,
             "path": "C:\\Windows\\System32\\svchost.exe -k wsappx -p",
             "peType": 2,
             "pid": 2736,
-            "protocol": 0,
+            "protocol": "tcp",
             "queryName": "settings-win.data.microsoft.com",
             "queryOptions": 1073766400,
             "queryResults": "type:  5 atm-settingsfe-prod-geo.trafficmanager.net;type:  5 settings-prod-www-2.test.cloudapp.example.com;10.0.0.208;",
             "queryType": 1,
             "regionSize": 221184,
             "relevance": 10,
-            "remoteAddr": "127.0.0.50",
-            "remotePort": 443,
+            "remoteAddrV4": "127.0.0.10",
+            "remotePort": 49818,
             "requestHeaders": "CONNECT self.events.data.microsoft.com:443 HTTP/1.0\r\nHost: self.events.data.microsoft.com:443\r\nContent-Length: 0\r\nProxy-Connection: Keep-Alive\r\nPragma: no-cache\r\n\r\n",
             "responseHeaders": "\r\n\r\n",
             "returnCode": 0,
             "rootObject": "\\registry\\machine\\system\\services\\ExampleSvc",
             "scanResult": 1,
             "scriptBlockEntropy": 4.0000000001111,
             "scriptBlockId": "10000000-99fe-491b-b123-1000000000",
@@ -281,14 +281,15 @@
             "technique": "T1043",
             "terminationTime": 1648047229530,
             "type": 1,
             "url": "http://self.events.data.microsoft.com:443/",
             "user": "NT AUTHORITY\\SYSTEM",
             "version": 1
         },
+        "eventName": "Service Stopped",
         "eventType": 88,
         "incidents": [],
         "localId": "844930920409466881",
         "process": {
             "endpointId": "841111111118681116",
             "id": "841111111118681116:692:1648046461800",
             "logonId": "0x141111",
```

## Comparing `stix_shifter_modules_reaqta-5.3.1.dist-info/LICENSE.md` & `stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/LICENSE.md`

 * *Files identical despite different names*

## Comparing `stix_shifter_modules_reaqta-5.3.1.dist-info/METADATA` & `stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: stix-shifter-modules-reaqta
-Version: 5.3.1
+Version: 6.0.0.dev74
 Summary: Tools and interface to translate STIX formatted results and queries to different data source formats and to set up appropriate connection strings for invoking and triggering actions in openwhisk
 Home-page: https://github.com/opencybersecurityalliance/stix-shifter
 Author: ibm
 Author-email: 
 Project-URL: Source, https://github.com/opencybersecurityalliance/stix-shifter
 Keywords: datasource stix translate transform transmit
 Classifier: License :: OSI Approved :: Apache Software License
```

## Comparing `stix_shifter_modules_reaqta-5.3.1.dist-info/NOTICE` & `stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/NOTICE`

 * *Files identical despite different names*

## Comparing `stix_shifter_modules_reaqta-5.3.1.dist-info/RECORD` & `stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/RECORD`

 * *Files 16% similar despite different names*

```diff
@@ -1,28 +1,27 @@
 stix_shifter_modules/reaqta/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_modules/reaqta/entry_point.py,sha256=OnOJ0byX4XHKZZjpsFKADlB7jmAwzCpR5QgFAKBRxLk,409
-stix_shifter_modules/reaqta/configuration/config.json,sha256=WVo86g-PrkAmRecRX3MkD32e3twOjh_l4QK0X7EGVpo,159017
+stix_shifter_modules/reaqta/configuration/config.json,sha256=gLHtkhdWRDrQKMt3iSpL-zIVbT-7gF8pdrwlzOs21TQ,159021
 stix_shifter_modules/reaqta/configuration/dialects.json,sha256=tewYuoIE-WBBxsLTlOstMkMSUs6sFlEyW1dveC61xwk,78
-stix_shifter_modules/reaqta/configuration/lang_en.json,sha256=7Kr5FolUE1EZqtW41NZrlXv9O2J9vArE4bHTIsrd7W8,2918
+stix_shifter_modules/reaqta/configuration/lang_en.json,sha256=fVxtRpQaIplIlsj4VhWyWOMTbH4SMNtpeYU4WzuAN84,2902
 stix_shifter_modules/reaqta/stix_translation/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-stix_shifter_modules/reaqta/stix_translation/json_to_stix_translator.py,sha256=vffR1MRpwX6NMwXy0MldaTecIIzvVSZIlcqXOM8Nx7I,22646
+stix_shifter_modules/reaqta/stix_translation/json_to_stix_translator.py,sha256=mlzibasm2UfSGhYqHoH2hMFHlx7XCy35VSlzzFTWpjc,27024
 stix_shifter_modules/reaqta/stix_translation/query_constructor.py,sha256=7HOFiwBzvtbke27sGInNQrfeMomsDRMcA5U0ircTST0,10518
 stix_shifter_modules/reaqta/stix_translation/query_translator.py,sha256=XeZMIh_fVtVsKFUI7_bsLPQZvA1lWLbMv1cAZ4CvA1U,1031
-stix_shifter_modules/reaqta/stix_translation/results_translator.py,sha256=tf2ZDglIJAvQxE0zjtd-nPB02zbCKV3w2wB4d5YwscE,2920
 stix_shifter_modules/reaqta/stix_translation/transformers.py,sha256=kH_4U9QhXZlyo894f1iY6UzYgpTf48ntLHHELlZlTNs,401
 stix_shifter_modules/reaqta/stix_translation/json/event_names_map.json,sha256=yQgoFujzyPqoUiHN3irEYB03qyYu0jibSmUWU-zvYwU,2860
 stix_shifter_modules/reaqta/stix_translation/json/from_stix_map.json,sha256=7YhW0C4001xXRWcWKOGNSFmrMkmUSR_7q7Cu_FAFLeE,11504
 stix_shifter_modules/reaqta/stix_translation/json/network_protocol_map.json,sha256=4a7Yor8hEuVBaws6SfSuU1bWvJg9BAfkqVszr6w39-w,51
 stix_shifter_modules/reaqta/stix_translation/json/operators.json,sha256=fXsrq1LAjUWGHRgi8P3cOUi9kM-NLtsv2SCL_c971ag,477
 stix_shifter_modules/reaqta/stix_translation/json/to_stix_map.json,sha256=oSOLpZ4iVMWJfZw51Ss0FdUpwPyudvlIeq53fB8xjh0,57521
 stix_shifter_modules/reaqta/stix_translation/json/stix_2_1/from_stix_map.json,sha256=F0wPQJ6ilWXHjEgFQksm82nuxcJdvWm2_apJPj16AY4,11627
 stix_shifter_modules/reaqta/stix_translation/json/stix_2_1/to_stix_map.json,sha256=mwfnRgAUl0fIQ5BNswEriOHI9EM9r91AFn-PeIdmBA0,58611
 stix_shifter_modules/reaqta/stix_transmission/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_modules/reaqta/stix_transmission/api_client.py,sha256=OtjlHRYwuSDUiilseITeICPeTb7NSkdQM0vc2eaxH2A,3834
-stix_shifter_modules/reaqta/stix_transmission/connector.py,sha256=gm7Fr2nlTJ_CypfWDf3YgKt0mue892XowX2OfaSELH8,5029
-stix_shifter_modules/reaqta/test/stix_translation/json/event_result.json,sha256=KTBPT3APT3VRqCGOdqJ6rdE9OqoroUrpjS9nK5gXjwo,15025
-stix_shifter_modules_reaqta-5.3.1.dist-info/LICENSE.md,sha256=ssGEKMVW69oFTBblVhD1YPolqCOyOCJi4wRDRI7xCnU,12786
-stix_shifter_modules_reaqta-5.3.1.dist-info/METADATA,sha256=FGsqhteIuB_sFLR3Lh0xbPDbbiFaZRvUoMcot0P8YGg,8036
-stix_shifter_modules_reaqta-5.3.1.dist-info/NOTICE,sha256=wx-gWE9vSnLJ7YQkrGlMp9VNXOXG57TTxDDRd9CEdYg,1418
-stix_shifter_modules_reaqta-5.3.1.dist-info/WHEEL,sha256=bb2Ot9scclHKMOLDEHY6B2sicWOgugjFKaJsT7vwMQo,110
-stix_shifter_modules_reaqta-5.3.1.dist-info/top_level.txt,sha256=NX-VgUOr8fI-lMXHt3gtjfsEn1UPaGAVszt6Z_CTp2s,21
-stix_shifter_modules_reaqta-5.3.1.dist-info/RECORD,,
+stix_shifter_modules/reaqta/stix_transmission/connector.py,sha256=Ng4QwcjNVPBhkEVE06gSRZxKk13wr3VSNMbI2V391VM,8114
+stix_shifter_modules/reaqta/test/stix_translation/json/event_result.json,sha256=5avhQGDiZrFUgNP-nGvhXcIQl1VVhAqHrkCbltxpvkU,15078
+stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/LICENSE.md,sha256=ssGEKMVW69oFTBblVhD1YPolqCOyOCJi4wRDRI7xCnU,12786
+stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/METADATA,sha256=7Rkv9sc6EsKttFloLWZ4RCuNYch0b9EIP7e9pqmqsIc,8042
+stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/NOTICE,sha256=wx-gWE9vSnLJ7YQkrGlMp9VNXOXG57TTxDDRd9CEdYg,1418
+stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/WHEEL,sha256=bb2Ot9scclHKMOLDEHY6B2sicWOgugjFKaJsT7vwMQo,110
+stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/top_level.txt,sha256=NX-VgUOr8fI-lMXHt3gtjfsEn1UPaGAVszt6Z_CTp2s,21
+stix_shifter_modules_reaqta-6.0.0.dev74.dist-info/RECORD,,
```

