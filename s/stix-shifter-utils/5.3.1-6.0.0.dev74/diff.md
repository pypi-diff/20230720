# Comparing `tmp/stix_shifter_utils-5.3.1-py2.py3-none-any.whl.zip` & `tmp/stix_shifter_utils-6.0.0.dev74-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,80 +1,80 @@
-Zip file size: 97228 bytes, number of entries: 78
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/__init__.py
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/__init__.py
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/base/__init__.py
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/base/stix_translation/__init__.py
--rw-rw-r--  2.0 unx     6984 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/base/stix_translation/base_query_translator.py
--rw-rw-r--  2.0 unx     2085 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/base/stix_translation/base_results_translator.py
--rw-rw-r--  2.0 unx      285 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/base/stix_translation/empty_query_translator.py
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/base/stix_transmission/__init__.py
--rw-rw-r--  2.0 unx     3904 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/base/stix_transmission/base_connector.py
--rw-rw-r--  2.0 unx      549 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/base/stix_transmission/base_delete_connector.py
--rw-rw-r--  2.0 unx     1068 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/base/stix_transmission/base_json_connector.py
--rw-rw-r--  2.0 unx     1100 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/base/stix_transmission/base_json_results_connector.py
--rw-rw-r--  2.0 unx      428 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/base/stix_transmission/base_json_sync_connector.py
--rw-rw-r--  2.0 unx      568 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/base/stix_transmission/base_ping_connector.py
--rw-rw-r--  2.0 unx      602 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/base/stix_transmission/base_query_connector.py
--rw-rw-r--  2.0 unx     1110 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/base/stix_transmission/base_results_connector.py
--rw-rw-r--  2.0 unx      887 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/base/stix_transmission/base_status_connector.py
--rw-rw-r--  2.0 unx      687 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/base/stix_transmission/base_sync_connector.py
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/car/__init__.py
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/car/stix_translation/__init__.py
--rw-rw-r--  2.0 unx      716 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/car/stix_translation/query_translator.py
--rw-rw-r--  2.0 unx     1144 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/car/stix_translation/results_translator.py
--rw-rw-r--  2.0 unx     2323 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/car/stix_translation/json/car_from_stix_map.json
--rw-rw-r--  2.0 unx     4959 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/car/stix_translation/json/to_stix_map.json
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/cim/__init__.py
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/cim/stix_translation/__init__.py
--rw-rw-r--  2.0 unx     1433 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/cim/stix_translation/query_translator.py
--rw-rw-r--  2.0 unx     3892 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/cim/stix_translation/json/cim_from_stix_map.json
--rw-rw-r--  2.0 unx      255 b- defN 23-Jun-15 14:04 stix_shifter_utils/modules/cim/stix_translation/json/cim_select_fields.json
--rw-rw-r--  2.0 unx    24375 b- defN 23-Jun-15 14:04 stix_shifter_utils/normalization/BaseNormalization.py
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/normalization/__init__.py
--rw-rw-r--  2.0 unx     2247 b- defN 23-Jun-15 14:04 stix_shifter_utils/normalization/normalization_helper.py
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/__init__.py
--rw-rw-r--  2.0 unx    22646 b- defN 23-Jun-15 14:07 stix_shifter_utils/stix_translation/json_to_stix_translator.py
--rw-rw-r--  2.0 unx     3054 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/stix_translation_error_mapper.py
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/__init__.py
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/json_to_stix/__init__.py
--rw-rw-r--  2.0 unx      850 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/json_to_stix/id_contributing_properties.py
--rw-rw-r--  2.0 unx     1302 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/json_to_stix/json_to_stix.py
--rw-rw-r--  2.0 unx    22646 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/json_to_stix/json_to_stix_translator.py
--rw-rw-r--  2.0 unx     2461 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/json_to_stix/observable.py
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/patterns/__init__.py
--rw-rw-r--  2.0 unx      433 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/patterns/errors.py
--rw-rw-r--  2.0 unx    12310 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/patterns/parser.py
--rw-rw-r--  2.0 unx     7940 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/patterns/pattern_objects.py
--rw-rw-r--  2.0 unx    21131 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/patterns/grammar/STIXPatternLexer.py
--rw-rw-r--  2.0 unx    12757 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/patterns/grammar/STIXPatternListener.py
--rw-rw-r--  2.0 unx    98182 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/patterns/grammar/STIXPatternParser.py
--rw-rw-r--  2.0 unx     7566 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/patterns/grammar/STIXPatternVisitor.py
--rw-rw-r--  2.0 unx      200 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/patterns/grammar/__init__.py
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/utils/__init__.py
--rw-rw-r--  2.0 unx      474 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/utils/exceptions.py
--rw-rw-r--  2.0 unx     5602 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/utils/stix_pattern_parser.py
--rw-rw-r--  2.0 unx      922 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/utils/transformer_utils.py
--rw-rw-r--  2.0 unx    11414 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/utils/transformers.py
--rw-rw-r--  2.0 unx     4003 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_translation/src/utils/unmapped_attribute_stripper.py
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_transmission/__init__.py
--rw-rw-r--  2.0 unx     6336 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_transmission/utils/RestApiClient.py
--rw-rw-r--  2.0 unx     7432 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_transmission/utils/RestApiClientAsync.py
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_transmission/utils/__init__.py
--rw-rw-r--  2.0 unx      545 b- defN 23-Jun-15 14:04 stix_shifter_utils/stix_transmission/utils/timeout_http_adapter.py
--rw-rw-r--  2.0 unx        0 b- defN 23-Jun-15 14:04 stix_shifter_utils/utils/__init__.py
--rw-rw-r--  2.0 unx      722 b- defN 23-Jun-15 14:04 stix_shifter_utils/utils/async_utils.py
--rw-rw-r--  2.0 unx    15426 b- defN 23-Jun-15 14:04 stix_shifter_utils/utils/base_entry_point.py
--rw-rw-r--  2.0 unx      644 b- defN 23-Jun-15 14:04 stix_shifter_utils/utils/error_mapper_base.py
--rw-rw-r--  2.0 unx     7740 b- defN 23-Jun-15 14:04 stix_shifter_utils/utils/error_response.py
--rw-rw-r--  2.0 unx     2339 b- defN 23-Jun-15 14:04 stix_shifter_utils/utils/file_helper.py
--rw-rw-r--  2.0 unx     2667 b- defN 23-Jun-15 14:04 stix_shifter_utils/utils/helpers.py
--rw-rw-r--  2.0 unx     1596 b- defN 23-Jun-15 14:04 stix_shifter_utils/utils/logger.py
--rw-rw-r--  2.0 unx     2107 b- defN 23-Jun-15 14:04 stix_shifter_utils/utils/module_discovery.py
--rw-rw-r--  2.0 unx     9065 b- defN 23-Jun-15 14:04 stix_shifter_utils/utils/param_validator.py
--rw-rw-r--  2.0 unx     3417 b- defN 23-Jun-15 14:04 stix_shifter_utils/utils/proxy_host.py
--rw-rw-r--  2.0 unx    12786 b- defN 23-Jun-15 14:07 stix_shifter_utils-5.3.1.dist-info/LICENSE.md
--rw-rw-r--  2.0 unx     8027 b- defN 23-Jun-15 14:07 stix_shifter_utils-5.3.1.dist-info/METADATA
--rw-rw-r--  2.0 unx     1418 b- defN 23-Jun-15 14:07 stix_shifter_utils-5.3.1.dist-info/NOTICE
--rw-rw-r--  2.0 unx      110 b- defN 23-Jun-15 14:07 stix_shifter_utils-5.3.1.dist-info/WHEEL
--rw-rw-r--  2.0 unx       19 b- defN 23-Jun-15 14:07 stix_shifter_utils-5.3.1.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     8953 b- defN 23-Jun-15 14:07 stix_shifter_utils-5.3.1.dist-info/RECORD
-78 files, 388843 bytes uncompressed, 82028 bytes compressed:  78.9%
+Zip file size: 99710 bytes, number of entries: 78
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/__init__.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/__init__.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/base/__init__.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/base/stix_translation/__init__.py
+-rw-rw-r--  2.0 unx     6984 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/base/stix_translation/base_query_translator.py
+-rw-rw-r--  2.0 unx     2868 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/base/stix_translation/base_results_translator.py
+-rw-rw-r--  2.0 unx      285 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/base/stix_translation/empty_query_translator.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/base/stix_transmission/__init__.py
+-rw-rw-r--  2.0 unx     3904 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/base/stix_transmission/base_connector.py
+-rw-rw-r--  2.0 unx      549 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/base/stix_transmission/base_delete_connector.py
+-rw-rw-r--  2.0 unx     1068 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/base/stix_transmission/base_json_connector.py
+-rw-rw-r--  2.0 unx     1100 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/base/stix_transmission/base_json_results_connector.py
+-rw-rw-r--  2.0 unx      428 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/base/stix_transmission/base_json_sync_connector.py
+-rw-rw-r--  2.0 unx      568 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/base/stix_transmission/base_ping_connector.py
+-rw-rw-r--  2.0 unx      602 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/base/stix_transmission/base_query_connector.py
+-rw-rw-r--  2.0 unx     1110 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/base/stix_transmission/base_results_connector.py
+-rw-rw-r--  2.0 unx      887 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/base/stix_transmission/base_status_connector.py
+-rw-rw-r--  2.0 unx      687 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/base/stix_transmission/base_sync_connector.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/car/__init__.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/car/stix_translation/__init__.py
+-rw-rw-r--  2.0 unx      716 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/car/stix_translation/query_translator.py
+-rw-rw-r--  2.0 unx     1144 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/car/stix_translation/results_translator.py
+-rw-rw-r--  2.0 unx     2323 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/car/stix_translation/json/car_from_stix_map.json
+-rw-rw-r--  2.0 unx     4959 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/car/stix_translation/json/to_stix_map.json
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/cim/__init__.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/cim/stix_translation/__init__.py
+-rw-rw-r--  2.0 unx     1433 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/cim/stix_translation/query_translator.py
+-rw-rw-r--  2.0 unx     3892 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/cim/stix_translation/json/cim_from_stix_map.json
+-rw-rw-r--  2.0 unx      255 b- defN 23-Jul-20 18:36 stix_shifter_utils/modules/cim/stix_translation/json/cim_select_fields.json
+-rw-rw-r--  2.0 unx    24375 b- defN 23-Jul-20 18:36 stix_shifter_utils/normalization/BaseNormalization.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/normalization/__init__.py
+-rw-rw-r--  2.0 unx     2247 b- defN 23-Jul-20 18:36 stix_shifter_utils/normalization/normalization_helper.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/__init__.py
+-rw-rw-r--  2.0 unx    27024 b- defN 23-Jul-20 18:39 stix_shifter_utils/stix_translation/json_to_stix_translator.py
+-rw-rw-r--  2.0 unx     3054 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/stix_translation_error_mapper.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/__init__.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/json_to_stix/__init__.py
+-rw-rw-r--  2.0 unx      850 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/json_to_stix/id_contributing_properties.py
+-rw-rw-r--  2.0 unx     1302 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/json_to_stix/json_to_stix.py
+-rw-rw-r--  2.0 unx    27024 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/json_to_stix/json_to_stix_translator.py
+-rw-rw-r--  2.0 unx     2461 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/json_to_stix/observable.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/patterns/__init__.py
+-rw-rw-r--  2.0 unx      433 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/patterns/errors.py
+-rw-rw-r--  2.0 unx    12310 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/patterns/parser.py
+-rw-rw-r--  2.0 unx     7940 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/patterns/pattern_objects.py
+-rw-rw-r--  2.0 unx    21128 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/patterns/grammar/STIXPatternLexer.py
+-rw-rw-r--  2.0 unx    12757 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/patterns/grammar/STIXPatternListener.py
+-rw-rw-r--  2.0 unx    98182 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/patterns/grammar/STIXPatternParser.py
+-rw-rw-r--  2.0 unx     7566 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/patterns/grammar/STIXPatternVisitor.py
+-rw-rw-r--  2.0 unx      200 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/patterns/grammar/__init__.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/utils/__init__.py
+-rw-rw-r--  2.0 unx      474 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/utils/exceptions.py
+-rw-rw-r--  2.0 unx     5602 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/utils/stix_pattern_parser.py
+-rw-rw-r--  2.0 unx      922 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/utils/transformer_utils.py
+-rw-rw-r--  2.0 unx    11414 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/utils/transformers.py
+-rw-rw-r--  2.0 unx     4003 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_translation/src/utils/unmapped_attribute_stripper.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_transmission/__init__.py
+-rw-rw-r--  2.0 unx     6336 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_transmission/utils/RestApiClient.py
+-rw-rw-r--  2.0 unx     7432 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_transmission/utils/RestApiClientAsync.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_transmission/utils/__init__.py
+-rw-rw-r--  2.0 unx      545 b- defN 23-Jul-20 18:36 stix_shifter_utils/stix_transmission/utils/timeout_http_adapter.py
+-rw-rw-r--  2.0 unx        0 b- defN 23-Jul-20 18:36 stix_shifter_utils/utils/__init__.py
+-rw-rw-r--  2.0 unx      722 b- defN 23-Jul-20 18:36 stix_shifter_utils/utils/async_utils.py
+-rw-rw-r--  2.0 unx    16199 b- defN 23-Jul-20 18:36 stix_shifter_utils/utils/base_entry_point.py
+-rw-rw-r--  2.0 unx      644 b- defN 23-Jul-20 18:36 stix_shifter_utils/utils/error_mapper_base.py
+-rw-rw-r--  2.0 unx     7740 b- defN 23-Jul-20 18:36 stix_shifter_utils/utils/error_response.py
+-rw-rw-r--  2.0 unx     2339 b- defN 23-Jul-20 18:36 stix_shifter_utils/utils/file_helper.py
+-rw-rw-r--  2.0 unx     2667 b- defN 23-Jul-20 18:36 stix_shifter_utils/utils/helpers.py
+-rw-rw-r--  2.0 unx     1596 b- defN 23-Jul-20 18:36 stix_shifter_utils/utils/logger.py
+-rw-rw-r--  2.0 unx     2270 b- defN 23-Jul-20 18:36 stix_shifter_utils/utils/module_discovery.py
+-rw-rw-r--  2.0 unx     9065 b- defN 23-Jul-20 18:36 stix_shifter_utils/utils/param_validator.py
+-rw-rw-r--  2.0 unx     3417 b- defN 23-Jul-20 18:36 stix_shifter_utils/utils/proxy_host.py
+-rw-rw-r--  2.0 unx    12786 b- defN 23-Jul-20 18:39 stix_shifter_utils-6.0.0.dev74.dist-info/LICENSE.md
+-rw-rw-r--  2.0 unx     8033 b- defN 23-Jul-20 18:39 stix_shifter_utils-6.0.0.dev74.dist-info/METADATA
+-rw-rw-r--  2.0 unx     1418 b- defN 23-Jul-20 18:39 stix_shifter_utils-6.0.0.dev74.dist-info/NOTICE
+-rw-rw-r--  2.0 unx      110 b- defN 23-Jul-20 18:39 stix_shifter_utils-6.0.0.dev74.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       19 b- defN 23-Jul-20 18:39 stix_shifter_utils-6.0.0.dev74.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     8989 b- defN 23-Jul-20 18:39 stix_shifter_utils-6.0.0.dev74.dist-info/RECORD
+78 files, 399357 bytes uncompressed, 84438 bytes compressed:  78.9%
```

## zipnote {}

```diff
@@ -210,26 +210,26 @@
 
 Filename: stix_shifter_utils/utils/param_validator.py
 Comment: 
 
 Filename: stix_shifter_utils/utils/proxy_host.py
 Comment: 
 
-Filename: stix_shifter_utils-5.3.1.dist-info/LICENSE.md
+Filename: stix_shifter_utils-6.0.0.dev74.dist-info/LICENSE.md
 Comment: 
 
-Filename: stix_shifter_utils-5.3.1.dist-info/METADATA
+Filename: stix_shifter_utils-6.0.0.dev74.dist-info/METADATA
 Comment: 
 
-Filename: stix_shifter_utils-5.3.1.dist-info/NOTICE
+Filename: stix_shifter_utils-6.0.0.dev74.dist-info/NOTICE
 Comment: 
 
-Filename: stix_shifter_utils-5.3.1.dist-info/WHEEL
+Filename: stix_shifter_utils-6.0.0.dev74.dist-info/WHEEL
 Comment: 
 
-Filename: stix_shifter_utils-5.3.1.dist-info/top_level.txt
+Filename: stix_shifter_utils-6.0.0.dev74.dist-info/top_level.txt
 Comment: 
 
-Filename: stix_shifter_utils-5.3.1.dist-info/RECORD
+Filename: stix_shifter_utils-6.0.0.dev74.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## stix_shifter_utils/modules/base/stix_translation/base_results_translator.py

```diff
@@ -8,28 +8,44 @@
 class BaseResultTranslator(object, metaclass=ABCMeta):
 
     def __init__(self, options, dialect, base_file_path=None, callback=None):
         self.dialect = dialect
         self.options = options
         self.callback = callback
         self.module_name = base_file_path.split(os.sep)[-2]
-        self.map_data = {}
         self.logger = logger.set_logger(__name__)
-        stix_2_0_mapping_directory_path = os.path.join(base_file_path, 'json')
-        stix_2_1_mapping_directory_path = os.path.join(base_file_path, 'json/stix_2_1')
-        if options.get("stix_2.1") and os.path.isdir(stix_2_1_mapping_directory_path):
-            filepath = os.path.abspath(os.path.join(stix_2_1_mapping_directory_path, "to_stix_map.json"))
-        else:
-            filepath = os.path.abspath(os.path.join(stix_2_0_mapping_directory_path, "to_stix_map.json"))
-        self.map_data = self.read_json(filepath, options)
+        self.map_data = self.fetch_mapping(base_file_path, dialect, options)
         self.transformers = get_module_transformers(self.module_name)
 
     def read_json(self, filepath, options):
         return helper_read_json(filepath, options)
 
+    def fetch_mapping(self, basepath, dialect, options):
+        """
+        Fetches datasource-to-STIX mapping JSON from the module's <DIALECT>_to_stix_map.json file
+        :param basepath: path of data source translation module
+        :type basepath: str
+        """
+        stix_2_0_mapping_directory_path = os.path.join(basepath, 'json')
+        stix_2_1_mapping_directory_path = os.path.join(basepath, 'json/stix_2_1')
+        mapping_file = f'{dialect}_to_stix_map.json'
+        to_stix_path = os.path.join(basepath, 'json', mapping_file)
+        if not os.path.isfile(to_stix_path):
+            # use default mapping file since 'default_stix_map.json' isn't a real dialect
+            mapping_file = 'to_stix_map.json'
+        if options.get("stix_2.1") and os.path.isdir(stix_2_1_mapping_directory_path):
+            to_stix_path = os.path.join(stix_2_1_mapping_directory_path, mapping_file)
+        else:
+            to_stix_path = os.path.join(stix_2_0_mapping_directory_path, mapping_file)
+
+        if os.path.isdir(stix_2_0_mapping_directory_path) and not os.path.isfile(to_stix_path):
+            raise Exception('BaseResultTranslator Error: ' + to_stix_path + ' is not found for dialect ' + dialect)
+
+        return self.read_json(to_stix_path, options)
+
     @abstractmethod
     def translate_results(self, data_source, data):
         """
         Translates data into STIX results based on a mapping file
         :param data_source: STIX identity object representing a data source
         :type data_source: str
         :param data: data to translate into STIX format
```

## stix_shifter_utils/stix_translation/json_to_stix_translator.py

```diff
@@ -118,22 +118,22 @@
                 if not match(str(stix_value)):
                     return False
             return True
         except Exception as e:
             self.logger.debug("Failed to validate STIX property '{}' with value '{}'. Exception: {}".format(observable_key, stix_value, e))
             return False
 
-    def _compose_value_object(self, value, key_list, observable_key=None, object_tag_ref_map=None, transformer=None, references=None, unwrap=False):
+    def _compose_value_object(self, value, key_list, observable_key=None, object_tag_ref_map=None, transformer=None, references=None, unwrap=False, is_group_ref=False):
         """
         Converts the value of the data to STIX valid value
         """
         try:
             return_value = {}
             for key in key_list:
-                return_value[key] = self._compose_value_object(value, key_list[1:], observable_key=observable_key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
+                return_value[key] = self._compose_value_object(value, key_list[1:], observable_key=observable_key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap, is_group_ref=is_group_ref)
                 break
             else:
                 if transformer:
                     try: 
                         value = transformer.transform(value)
                         if value is None:
                             return None
@@ -141,21 +141,39 @@
                         return None
                 
                 if references:
                     if isinstance(references, list):
                         return_value = []
                         for ref in references:
                             if not isinstance(value, list):
-                                value = [value]
-                            for i, _ in enumerate(value):
-                                parent_key_ind = self._get_tag_ind(ref, object_tag_ref_map, create_on_absence=False, unwrap=i)
+                                # Fetch the index of reference object name which has a single value.
+                                parent_key_ind = self._get_tag_ind(ref, object_tag_ref_map, create_on_absence=False)
                                 if parent_key_ind:
                                     return_value.append(parent_key_ind)
+                            else:
+                                for i, _ in enumerate(value):
+                                    parent_key_ind = self._get_tag_ind(ref, object_tag_ref_map, create_on_absence=False, unwrap=str(i))
+                                    if parent_key_ind:
+                                        return_value.append(parent_key_ind)
+                                    # Iterate through the object_tag_ref_map to fetch the index, for grouping
+                                    # reference objects of nested type through group_ref.
+                                    elif is_group_ref:
+                                        list_parent_ind = ref + '_' + str(i)
+                                        for key, val in object_tag_ref_map['tags'].items():
+                                            if key.startswith(list_parent_ind):
+                                                return_value.append(
+                                                    self._get_tag_ind(key, object_tag_ref_map, create_on_absence=False))
+
                     else:
-                        return_value = self._get_tag_ind(references, object_tag_ref_map, create_on_absence=False)
+                        # Fetch first object (index 0) for single reference when the value is of type list .
+                        if isinstance(value, list):
+                            return_value = self._get_tag_ind(references, object_tag_ref_map, create_on_absence=False,
+                                                             unwrap='0')
+                        else:
+                            return_value = self._get_tag_ind(references, object_tag_ref_map, create_on_absence=False)
                         # if the property has unwrap true and is not a list, convert to list
                         if unwrap is True and not isinstance(return_value, list):
                             return_value = [return_value]
 
                     if not return_value:
                         return None
                 else:
@@ -247,28 +265,38 @@
                 if isinstance(to_stix_config_prop, dict) and to_stix_config_prop.get('key') is not None and not isinstance(to_stix_config_prop.get('key'), dict):
                     # data variable is the final value, process in bulk
                     self._handle_value(data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind)
 
                 elif isinstance(data, list):
                     for i, d in enumerate(data):
                         if isinstance(d, list) or isinstance(d, dict):
-                            self._handle_properties(to_stix_config_prop, d, objects, object_tag_ref_map, data, ds_sub_key, i)
+                            # Added parent key indexes to inner objects in order to handle nested lists of
+                            # dictionaries and lists. For Example, if a list of IP address is present inside
+                            # a list of network objects, then without adding this code, only the IP address information
+                            # in the first network object will be created and the rest are not created.
+                            if object_key_ind:
+                                i = str(object_key_ind) + '_' + str(i)
+                            # Inorder to include 0th index, the integer field 'i' is converted to string.
+                            self._handle_properties(to_stix_config_prop, d, objects, object_tag_ref_map, data, ds_sub_key, str(i))
                         else:
                             # data variable is the final value, process in bulk
                             self._handle_value(data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind)
                             break
                     # group the references of list of dictionary field
                     if isinstance(to_stix_config_prop, dict):
                         group_refs = [key for key, value in to_stix_config_prop.items() if
                                       isinstance(value, dict) and value.get('group_ref') and value.get(
                                           'references')]
                         for group_ref in group_refs:
+                            # Added a new boolean (True) parameter (is_group_ref) to indicate grouping of references
+                            # through group_ref key in mapping
                             self._handle_value(data, to_stix_config_prop, ds_sub_key,
                                                to_stix_config_prop[group_ref],
-                                               objects, object_tag_ref_map, object_key_ind)
+                                               objects, object_tag_ref_map, object_key_ind, True)
+
                 elif isinstance(data, dict):
                     for k in data:
                         cust_prop = None
                         if k in to_stix_config_prop:
                             cust_prop = to_stix_config_prop[k]
                         elif self.options.get('unmapped_fallback') and k not in object_tag_ref_map['ds_key_cybox']:
                             cust_prop = {"key": "x-" + self.data_source.replace("_", "-") + "." + k, "object": "cust_object"}
@@ -277,15 +305,15 @@
                             self._handle_properties(cust_prop, data[k], objects, object_tag_ref_map, data, k, object_key_ind)
                 else:
                     self._handle_value(data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind)
         except Exception as e:
             raise Exception("Error in json_to_stix_translator._handle_properties: %s" % e)
 
 
-    def _handle_value(self, data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind=None):
+    def _handle_value(self, data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind=None, is_group_ref=False):
         """
         Receives the raw value of a data property, converts to a STIX valid value and adds to the cached observable `objects` dictionary
         """
         try: 
             if isinstance(to_stix_config_prop, dict):
                 props = [to_stix_config_prop]
             else:
@@ -294,14 +322,29 @@
             for prop in props:
                 key = prop.get('key', None)
                 if key is None:
                     continue
 
                 transformer = self.transformers[prop['transformer']] if 'transformer' in prop else None
                 references = references = prop['references'] if 'references' in prop else None
+
+                # This check avoid using duplicate reference in the multiple objects of the same type.
+                # For example: If there are multiple source ipv4-addr and network-traffic objects then
+                # without this reference check the first source ipv4-addr object will be referenced to all network-traffic objects.
+                if references:
+                    if isinstance(references, str):
+                        if object_key_ind:
+                            references = references + '_' + str(object_key_ind)
+                        elif not isinstance(data, list):
+                            references = references + '_' + '0'
+                    elif isinstance(references, list):
+                        if object_key_ind:
+                            references = [ref + '_' + str(object_key_ind) for ref in references]
+                        elif not isinstance(data, list):
+                            references = [ref + '_' + '0' for ref in references]
                 # unwrap array of stix values to separate stix objects
                 unwrap = True if 'unwrap' in prop and isinstance(data, list) else False
                 if "." in key:
                     cybox = True
                 else:
                     cybox = False
                 
@@ -334,33 +377,44 @@
                     if False is cybox and not substitute_key:
                         value = self._compose_value_object(data, config_keys[2:], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
                         self._add_property(type_name, property_key, type_name, value, object_tag_ref_map['out_cybox'], cybox=False)
                         continue
 
                     if object_key_ind:
                         parent_key = parent_key + '_' + str(object_key_ind)
+                    # Adding _0 as a tag index for the following
+                    # 1. For object name of non-list type data or unwrapped data
+                    # 2. For the object name containing references to list type of data.
+                    # For Example, when a single IP address value and references to the list of domain values, needs
+                    # to be added to a single custom object, the 0th index is added to the custom object to have ip
+                    # address and references to list of domains under the same custom object.
+                    elif (isinstance(data, list) and not unwrap and not references) \
+                            or (isinstance(data, list) and references) or (not isinstance(data, list)):
+                        parent_key = parent_key + '_' + '0'
 
                     # use the hard-coded value in the mapping
                     if 'value' in prop:
                         value = prop['value']
                     else:
                         if substitute_key and parent_data:
                             data = parent_data.get(substitute_key)
 
                             if False is cybox:
                                 object_tag_ref_map['ds_key_cybox'][substitute_key] = True
                         
-                        value = self._compose_value_object(data, config_keys[2:], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
+                        value = self._compose_value_object(data, config_keys[2:], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap, is_group_ref=is_group_ref)
 
-                    if value is None or value == '':
+                    # Remove the values which has empty list brackets.
+                    if value is None or value in ('', []):
                         continue
 
                     if not references and unwrap and isinstance(value, list):
                         for i, val_el in enumerate(value):
-                            parent_key_ind = self._get_tag_ind(parent_key, object_tag_ref_map, create_on_absence=True, unwrap=i, property_key=property_key)
+                            # Inorder to include 0th index, the integer field 'i' is converted to string.
+                            parent_key_ind = self._get_tag_ind(parent_key, object_tag_ref_map, create_on_absence=True, unwrap=str(i), property_key=property_key)
                             self._add_property(type_name, property_key, parent_key_ind, val_el, objects, group=group)
                     else:
                         parent_key_ind = self._get_tag_ind(parent_key, object_tag_ref_map, create_on_absence=True, property_key=property_key)
                         self._add_property(type_name, property_key, parent_key_ind, value, objects, group=group)
         except Exception as e:
             raise Exception("Error in json_to_stix_translator._handle_value: %s : %s" % (e, e.__traceback__.tb_lineno))
```

## stix_shifter_utils/stix_translation/src/json_to_stix/json_to_stix_translator.py

```diff
@@ -118,22 +118,22 @@
                 if not match(str(stix_value)):
                     return False
             return True
         except Exception as e:
             self.logger.debug("Failed to validate STIX property '{}' with value '{}'. Exception: {}".format(observable_key, stix_value, e))
             return False
 
-    def _compose_value_object(self, value, key_list, observable_key=None, object_tag_ref_map=None, transformer=None, references=None, unwrap=False):
+    def _compose_value_object(self, value, key_list, observable_key=None, object_tag_ref_map=None, transformer=None, references=None, unwrap=False, is_group_ref=False):
         """
         Converts the value of the data to STIX valid value
         """
         try:
             return_value = {}
             for key in key_list:
-                return_value[key] = self._compose_value_object(value, key_list[1:], observable_key=observable_key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
+                return_value[key] = self._compose_value_object(value, key_list[1:], observable_key=observable_key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap, is_group_ref=is_group_ref)
                 break
             else:
                 if transformer:
                     try: 
                         value = transformer.transform(value)
                         if value is None:
                             return None
@@ -141,21 +141,39 @@
                         return None
                 
                 if references:
                     if isinstance(references, list):
                         return_value = []
                         for ref in references:
                             if not isinstance(value, list):
-                                value = [value]
-                            for i, _ in enumerate(value):
-                                parent_key_ind = self._get_tag_ind(ref, object_tag_ref_map, create_on_absence=False, unwrap=i)
+                                # Fetch the index of reference object name which has a single value.
+                                parent_key_ind = self._get_tag_ind(ref, object_tag_ref_map, create_on_absence=False)
                                 if parent_key_ind:
                                     return_value.append(parent_key_ind)
+                            else:
+                                for i, _ in enumerate(value):
+                                    parent_key_ind = self._get_tag_ind(ref, object_tag_ref_map, create_on_absence=False, unwrap=str(i))
+                                    if parent_key_ind:
+                                        return_value.append(parent_key_ind)
+                                    # Iterate through the object_tag_ref_map to fetch the index, for grouping
+                                    # reference objects of nested type through group_ref.
+                                    elif is_group_ref:
+                                        list_parent_ind = ref + '_' + str(i)
+                                        for key, val in object_tag_ref_map['tags'].items():
+                                            if key.startswith(list_parent_ind):
+                                                return_value.append(
+                                                    self._get_tag_ind(key, object_tag_ref_map, create_on_absence=False))
+
                     else:
-                        return_value = self._get_tag_ind(references, object_tag_ref_map, create_on_absence=False)
+                        # Fetch first object (index 0) for single reference when the value is of type list .
+                        if isinstance(value, list):
+                            return_value = self._get_tag_ind(references, object_tag_ref_map, create_on_absence=False,
+                                                             unwrap='0')
+                        else:
+                            return_value = self._get_tag_ind(references, object_tag_ref_map, create_on_absence=False)
                         # if the property has unwrap true and is not a list, convert to list
                         if unwrap is True and not isinstance(return_value, list):
                             return_value = [return_value]
 
                     if not return_value:
                         return None
                 else:
@@ -247,28 +265,38 @@
                 if isinstance(to_stix_config_prop, dict) and to_stix_config_prop.get('key') is not None and not isinstance(to_stix_config_prop.get('key'), dict):
                     # data variable is the final value, process in bulk
                     self._handle_value(data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind)
 
                 elif isinstance(data, list):
                     for i, d in enumerate(data):
                         if isinstance(d, list) or isinstance(d, dict):
-                            self._handle_properties(to_stix_config_prop, d, objects, object_tag_ref_map, data, ds_sub_key, i)
+                            # Added parent key indexes to inner objects in order to handle nested lists of
+                            # dictionaries and lists. For Example, if a list of IP address is present inside
+                            # a list of network objects, then without adding this code, only the IP address information
+                            # in the first network object will be created and the rest are not created.
+                            if object_key_ind:
+                                i = str(object_key_ind) + '_' + str(i)
+                            # Inorder to include 0th index, the integer field 'i' is converted to string.
+                            self._handle_properties(to_stix_config_prop, d, objects, object_tag_ref_map, data, ds_sub_key, str(i))
                         else:
                             # data variable is the final value, process in bulk
                             self._handle_value(data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind)
                             break
                     # group the references of list of dictionary field
                     if isinstance(to_stix_config_prop, dict):
                         group_refs = [key for key, value in to_stix_config_prop.items() if
                                       isinstance(value, dict) and value.get('group_ref') and value.get(
                                           'references')]
                         for group_ref in group_refs:
+                            # Added a new boolean (True) parameter (is_group_ref) to indicate grouping of references
+                            # through group_ref key in mapping
                             self._handle_value(data, to_stix_config_prop, ds_sub_key,
                                                to_stix_config_prop[group_ref],
-                                               objects, object_tag_ref_map, object_key_ind)
+                                               objects, object_tag_ref_map, object_key_ind, True)
+
                 elif isinstance(data, dict):
                     for k in data:
                         cust_prop = None
                         if k in to_stix_config_prop:
                             cust_prop = to_stix_config_prop[k]
                         elif self.options.get('unmapped_fallback') and k not in object_tag_ref_map['ds_key_cybox']:
                             cust_prop = {"key": "x-" + self.data_source.replace("_", "-") + "." + k, "object": "cust_object"}
@@ -277,15 +305,15 @@
                             self._handle_properties(cust_prop, data[k], objects, object_tag_ref_map, data, k, object_key_ind)
                 else:
                     self._handle_value(data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind)
         except Exception as e:
             raise Exception("Error in json_to_stix_translator._handle_properties: %s" % e)
 
 
-    def _handle_value(self, data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind=None):
+    def _handle_value(self, data, parent_data, ds_sub_key, to_stix_config_prop, objects, object_tag_ref_map, object_key_ind=None, is_group_ref=False):
         """
         Receives the raw value of a data property, converts to a STIX valid value and adds to the cached observable `objects` dictionary
         """
         try: 
             if isinstance(to_stix_config_prop, dict):
                 props = [to_stix_config_prop]
             else:
@@ -294,14 +322,29 @@
             for prop in props:
                 key = prop.get('key', None)
                 if key is None:
                     continue
 
                 transformer = self.transformers[prop['transformer']] if 'transformer' in prop else None
                 references = references = prop['references'] if 'references' in prop else None
+
+                # This check avoid using duplicate reference in the multiple objects of the same type.
+                # For example: If there are multiple source ipv4-addr and network-traffic objects then
+                # without this reference check the first source ipv4-addr object will be referenced to all network-traffic objects.
+                if references:
+                    if isinstance(references, str):
+                        if object_key_ind:
+                            references = references + '_' + str(object_key_ind)
+                        elif not isinstance(data, list):
+                            references = references + '_' + '0'
+                    elif isinstance(references, list):
+                        if object_key_ind:
+                            references = [ref + '_' + str(object_key_ind) for ref in references]
+                        elif not isinstance(data, list):
+                            references = [ref + '_' + '0' for ref in references]
                 # unwrap array of stix values to separate stix objects
                 unwrap = True if 'unwrap' in prop and isinstance(data, list) else False
                 if "." in key:
                     cybox = True
                 else:
                     cybox = False
                 
@@ -334,33 +377,44 @@
                     if False is cybox and not substitute_key:
                         value = self._compose_value_object(data, config_keys[2:], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
                         self._add_property(type_name, property_key, type_name, value, object_tag_ref_map['out_cybox'], cybox=False)
                         continue
 
                     if object_key_ind:
                         parent_key = parent_key + '_' + str(object_key_ind)
+                    # Adding _0 as a tag index for the following
+                    # 1. For object name of non-list type data or unwrapped data
+                    # 2. For the object name containing references to list type of data.
+                    # For Example, when a single IP address value and references to the list of domain values, needs
+                    # to be added to a single custom object, the 0th index is added to the custom object to have ip
+                    # address and references to list of domains under the same custom object.
+                    elif (isinstance(data, list) and not unwrap and not references) \
+                            or (isinstance(data, list) and references) or (not isinstance(data, list)):
+                        parent_key = parent_key + '_' + '0'
 
                     # use the hard-coded value in the mapping
                     if 'value' in prop:
                         value = prop['value']
                     else:
                         if substitute_key and parent_data:
                             data = parent_data.get(substitute_key)
 
                             if False is cybox:
                                 object_tag_ref_map['ds_key_cybox'][substitute_key] = True
                         
-                        value = self._compose_value_object(data, config_keys[2:], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap)
+                        value = self._compose_value_object(data, config_keys[2:], observable_key=key, object_tag_ref_map=object_tag_ref_map, transformer=transformer, references=references, unwrap=unwrap, is_group_ref=is_group_ref)
 
-                    if value is None or value == '':
+                    # Remove the values which has empty list brackets.
+                    if value is None or value in ('', []):
                         continue
 
                     if not references and unwrap and isinstance(value, list):
                         for i, val_el in enumerate(value):
-                            parent_key_ind = self._get_tag_ind(parent_key, object_tag_ref_map, create_on_absence=True, unwrap=i, property_key=property_key)
+                            # Inorder to include 0th index, the integer field 'i' is converted to string.
+                            parent_key_ind = self._get_tag_ind(parent_key, object_tag_ref_map, create_on_absence=True, unwrap=str(i), property_key=property_key)
                             self._add_property(type_name, property_key, parent_key_ind, val_el, objects, group=group)
                     else:
                         parent_key_ind = self._get_tag_ind(parent_key, object_tag_ref_map, create_on_absence=True, property_key=property_key)
                         self._add_property(type_name, property_key, parent_key_ind, value, objects, group=group)
         except Exception as e:
             raise Exception("Error in json_to_stix_translator._handle_value: %s : %s" % (e, e.__traceback__.tb_lineno))
```

## stix_shifter_utils/stix_translation/src/patterns/grammar/STIXPatternLexer.py

```diff
@@ -1,11 +1,11 @@
 # Generated from stix_shifter_utils/stix_translation/src/patterns/grammar/STIXPattern.g4 by ANTLR 4.8
 from antlr4 import *
 from io import StringIO
-from typing.io import TextIO
+from typing import TextIO
 import sys
 
 
 
 def serializedATN():
     with StringIO() as buf:
         buf.write("\3\u608b\ua72a\u8133\ub9ed\u417c\u3be7\u7786\u5964\2\67")
```

## stix_shifter_utils/utils/base_entry_point.py

```diff
@@ -1,14 +1,16 @@
+import copy
 import importlib
 import traceback
 import os
 import functools
 import json
 import glob
 from inspect import isawaitable
+from typing import Union
 
 from stix_shifter_utils.utils.module_discovery import dialect_list
 from stix_shifter_utils.modules.base.stix_translation.base_query_translator import BaseQueryTranslator
 from stix_shifter_utils.modules.base.stix_translation.base_results_translator import BaseResultTranslator
 from stix_shifter_utils.modules.base.stix_transmission.base_connector import BaseConnector
 from stix_shifter_utils.modules.base.stix_transmission.base_delete_connector import BaseDeleteConnector
 from stix_shifter_utils.modules.base.stix_transmission.base_query_connector import BaseQueryConnector
@@ -37,25 +39,14 @@
         self.__options = options
 
         self.__results_connector = None
         self.__status_connector = None
         self.__delete_connector = None
         self.__query_connector = None
 
-        module_name = self.__connector_module
-        module = importlib.import_module(
-                    "stix_shifter_modules." + module_name + ".stix_translation")
-        json_path = os.path.dirname(module.__file__)
-        json_path = os.path.abspath(json_path)
-        json_path = os.path.join(json_path, 'json')
-        if os.path.isdir(json_path):
-            to_stix = os.path.join(json_path, 'to_stix_map.json')
-            if not os.path.isfile(to_stix):
-                raise Exception(to_stix + ' is not found')
-
         if connection:
             validation_obj = {'connection': connection, 'configuration': configuration}
             validation_obj = json.loads(json.dumps(validation_obj))
             modernize_objects(self.__connector_module, validation_obj)
             validation_obj = param_validator(self.__connector_module, validation_obj)
             connection.clear()
             configuration.clear()
@@ -102,18 +93,22 @@
         self.__dialects_all.append(dialect)
         if default_include:
             self.__dialects_active_default.append(dialect)
         return self
 
     def setup_translation_simple(self, dialect_default, query_translator=None, results_translator=None):
         module_name = self.__connector_module
-        dialects = dialect_list(module_name)
+        dialects = dialect_list(module_name, self.__options) # get list of dialects from configuration
         for dialect in dialects:
+            if self.__options:
+                is_default = True
+            else:
+                is_default = (dialect == dialect_default)
             self.add_dialect(dialect, query_translator=query_translator, results_translator=results_translator,
-                             default=(dialect == dialect_default))
+                             default=is_default)
 
     def create_default_query_translator(self, dialect):
         module_name = self.__connector_module
         module = importlib.import_module(
                     "stix_shifter_modules." + module_name + ".stix_translation.query_translator")
         basepath = os.path.dirname(module.__file__)
         mapping_filepath = os.path.abspath(basepath)
@@ -158,20 +153,38 @@
     def get_query_translator(self, dialect=None):
         try:
             if dialect:
                 return self.__dialect_to_query_translator[dialect]
             return self.__dialect_to_query_translator[self.__dialect_default[self.__options.get(OPTION_LANGUAGE, "stix")]]
         except KeyError as ex:
             raise UnsupportedDialectException(dialect)
+        
+    @translation
+    def __combine_default_results_translator_to_stix_maps(self, dialects:list=None):
+        """
+        Returns default or dialect specific ResultTranslator. 
+        If there are multiple dialects in the module and 'dialects' list argument is specified, the return combines
+        the corresponding ResultTranslators' map_data into a copy of the default ResultTranslator and returns it.
+        """
+        default_results_translator:BaseResultTranslator = self.__dialect_to_results_translator[self.__dialect_default[self.__options.get(OPTION_LANGUAGE, "stix")]]
+        results_translator = copy.deepcopy(default_results_translator)
+
+        for dialect, translator in self.__dialect_to_results_translator.items():
+            if dialects and dialect not in dialects:
+                continue
+            results_translator.map_data = {**results_translator.map_data, **translator.map_data}
+
+        return results_translator
+
 
     @translation
-    def get_results_translator(self, dialect=None):
-        if dialect:
+    def get_results_translator(self, dialect:Union[str,list]=None):
+        if dialect and isinstance(dialect, str):
             return self.__dialect_to_results_translator[dialect]
-        return self.__dialect_to_results_translator[self.__dialect_default[self.__options.get(OPTION_LANGUAGE, "stix")]]
+        return self.__combine_default_results_translator_to_stix_maps(dialect)
 
     @translation
     async def parse_query(self, data):
         translator = self.get_query_translator()
         result = translator.parse_query(data)
         if isawaitable(result):
             result = await result
@@ -183,15 +196,19 @@
         result = translator.transform_query(data)
         if isawaitable(result):
             result = await result
         return result
 
     @translation
     async def translate_results(self, data_source, data):
-        translator = self.get_results_translator()
+        dialects = None
+        if 'dialects' in self.__options:
+            dialects = self.__options['dialects']
+
+        translator = self.get_results_translator(dialects)
         try:
             result = translator.translate_results(data_source, data)
             if isawaitable(result):
                 result = await result
             return result
         except Exception as ex:
             result = {}
```

## stix_shifter_utils/utils/module_discovery.py

```diff
@@ -35,23 +35,26 @@
     mlist = [name for name in os.listdir(modules_path) if (os.path.isdir(os.path.join(modules_path, name))
                                                            and not os.path.isfile(os.path.join(modules_path, name, 'SKIP.ME'))
                                                            and not name.startswith('__'))]
     mlist.sort()
     return mlist
 
 
-def dialect_list(module):
-    modules = import_module('stix_shifter_modules')
-    if '__file__' in dir(modules) and modules.__file__ is not None:
-        modules_path = Path(modules.__file__).parent
-    else:
-        modules_path = choose_module_path(module, modules.__path__._path)
-    dialects_path = os.path.join(modules_path, f'{module}/stix_translation/json')
-    ENDING = '_from_stix_map.json'
+def dialect_list(module, options):
     dialects = []
-    if os.path.isdir(dialects_path):
-        files = [name for name in os.listdir(dialects_path) if (os.path.isfile(os.path.join(dialects_path, name)) and
-                 (name.endswith(ENDING)))]
-        dialects = list(map(lambda f: f[:-len(ENDING)], files))
-    if not dialects:
-        dialects = ['default']
+    if 'dialects' in options and options['dialects']:
+        dialects = options['dialects']
+    else:
+        modules = import_module('stix_shifter_modules')
+        if '__file__' in dir(modules) and modules.__file__ is not None:
+            modules_path = Path(modules.__file__).parent
+        else:
+            modules_path = choose_module_path(module, modules.__path__._path)
+        dialects_path = os.path.join(modules_path, f'{module}/stix_translation/json')
+        ENDING = '_from_stix_map.json'
+        if os.path.isdir(dialects_path):
+            files = [name for name in os.listdir(dialects_path) if (os.path.isfile(os.path.join(dialects_path, name)) and
+                    (name.endswith(ENDING)))]
+            dialects = list(map(lambda f: f[:-len(ENDING)], files))
+        if not dialects:
+            dialects = ['default']
     return dialects
```

## Comparing `stix_shifter_utils-5.3.1.dist-info/LICENSE.md` & `stix_shifter_utils-6.0.0.dev74.dist-info/LICENSE.md`

 * *Files identical despite different names*

## Comparing `stix_shifter_utils-5.3.1.dist-info/METADATA` & `stix_shifter_utils-6.0.0.dev74.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: stix-shifter-utils
-Version: 5.3.1
+Version: 6.0.0.dev74
 Summary: Tools and interface to translate STIX formatted results and queries to different data source formats and to set up appropriate connection strings for invoking and triggering actions in openwhisk
 Home-page: https://github.com/opencybersecurityalliance/stix-shifter
 Author: ibm
 Author-email: 
 Project-URL: Source, https://github.com/opencybersecurityalliance/stix-shifter
 Keywords: datasource stix translate transform transmit
 Classifier: License :: OSI Approved :: Apache Software License
```

## Comparing `stix_shifter_utils-5.3.1.dist-info/NOTICE` & `stix_shifter_utils-6.0.0.dev74.dist-info/NOTICE`

 * *Files identical despite different names*

## Comparing `stix_shifter_utils-5.3.1.dist-info/RECORD` & `stix_shifter_utils-6.0.0.dev74.dist-info/RECORD`

 * *Files 12% similar despite different names*

```diff
@@ -1,13 +1,13 @@
 stix_shifter_utils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_utils/modules/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_utils/modules/base/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_utils/modules/base/stix_translation/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_utils/modules/base/stix_translation/base_query_translator.py,sha256=dpsnqbY4hFUckmdVGzLN7mr50t576h9uRuH-9bBQhl0,6984
-stix_shifter_utils/modules/base/stix_translation/base_results_translator.py,sha256=jiXjBFU7yYaOVfF12SZEd38XK6xkAuBCfBcaO1ngKy8,2085
+stix_shifter_utils/modules/base/stix_translation/base_results_translator.py,sha256=pgumtyw6dD29r45Tny_Ugg9X5TgGUvnHfFmSIt6UjQY,2868
 stix_shifter_utils/modules/base/stix_translation/empty_query_translator.py,sha256=9T-r2HPBMWUyOI0P8wKB9m6q74LEcRvEXYcj5Zl6SiQ,285
 stix_shifter_utils/modules/base/stix_transmission/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_utils/modules/base/stix_transmission/base_connector.py,sha256=XZGMtvDiT_nGVX3tO_qLWraWFboMgnB4vlZSRlXRu6g,3904
 stix_shifter_utils/modules/base/stix_transmission/base_delete_connector.py,sha256=lcVVf1l3IbA9SzZYfoeT4kNVi3BVrg-VPXuYg3XeGew,549
 stix_shifter_utils/modules/base/stix_transmission/base_json_connector.py,sha256=maa-XEYKnXQgYEzG6208NTYEZpvMoQWyJPN7vHTRriA,1068
 stix_shifter_utils/modules/base/stix_transmission/base_json_results_connector.py,sha256=A5rTz83wUsHAqIOj9IkCOYLYpZZg55EkeKX66WPTwAM,1100
 stix_shifter_utils/modules/base/stix_transmission/base_json_sync_connector.py,sha256=9qryfuNVv7da-pgaa10Ffn9Mdcav9vl9ejF7rMhlBh4,428
@@ -27,27 +27,27 @@
 stix_shifter_utils/modules/cim/stix_translation/query_translator.py,sha256=pctFLu2Uq8dtYJx57Vo9T28ejGxvrfa44qs4o8bIh_U,1433
 stix_shifter_utils/modules/cim/stix_translation/json/cim_from_stix_map.json,sha256=8anTOAVbSp1OnKTp7vRbYTTDiP0XO8iy3RM1El3blx4,3892
 stix_shifter_utils/modules/cim/stix_translation/json/cim_select_fields.json,sha256=DX4S2uuikYq9j_tAqdgJVV3-lCvk4-2dSmZeL9Xn25g,255
 stix_shifter_utils/normalization/BaseNormalization.py,sha256=W2w-Fle9rQB_A-pKg3RfXbPwV1lJsTE-YVABURoR8vs,24375
 stix_shifter_utils/normalization/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_utils/normalization/normalization_helper.py,sha256=NKe8038IkHv6zOX-7Qu-UvKEkeQ1Jm_IMOXlM1TuObg,2247
 stix_shifter_utils/stix_translation/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-stix_shifter_utils/stix_translation/json_to_stix_translator.py,sha256=vffR1MRpwX6NMwXy0MldaTecIIzvVSZIlcqXOM8Nx7I,22646
+stix_shifter_utils/stix_translation/json_to_stix_translator.py,sha256=mlzibasm2UfSGhYqHoH2hMFHlx7XCy35VSlzzFTWpjc,27024
 stix_shifter_utils/stix_translation/stix_translation_error_mapper.py,sha256=-G_zyfI56XE_v-4iKEvgsoXqq2jjtyr6TaqyT0LkWCM,3054
 stix_shifter_utils/stix_translation/src/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_utils/stix_translation/src/json_to_stix/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_utils/stix_translation/src/json_to_stix/id_contributing_properties.py,sha256=ZidLrbqKVYqJ4sqSMA-mPE2MhsBYa_8ou-hd2432TTY,850
 stix_shifter_utils/stix_translation/src/json_to_stix/json_to_stix.py,sha256=praAwf0NDubJabRy1UXR237avdIrB3R2NKXj1M_NYbo,1302
-stix_shifter_utils/stix_translation/src/json_to_stix/json_to_stix_translator.py,sha256=vffR1MRpwX6NMwXy0MldaTecIIzvVSZIlcqXOM8Nx7I,22646
+stix_shifter_utils/stix_translation/src/json_to_stix/json_to_stix_translator.py,sha256=mlzibasm2UfSGhYqHoH2hMFHlx7XCy35VSlzzFTWpjc,27024
 stix_shifter_utils/stix_translation/src/json_to_stix/observable.py,sha256=OwtjUfcwWHAi3jO477SzMYop0lIXNuTE0WDg_WhgDw0,2461
 stix_shifter_utils/stix_translation/src/patterns/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_utils/stix_translation/src/patterns/errors.py,sha256=GnZ-sjIwHUQsriaKO1l88zmvwlr4SHod3Lo40EtRDic,433
 stix_shifter_utils/stix_translation/src/patterns/parser.py,sha256=jOIn9912_7ncoKeoCN2tIm98JdL5qY516HPlHdZfGfs,12310
 stix_shifter_utils/stix_translation/src/patterns/pattern_objects.py,sha256=gyHWvsXPJ1RiwZF0UWOfokRRbXKOBX2IOpFolH-78Oc,7940
-stix_shifter_utils/stix_translation/src/patterns/grammar/STIXPatternLexer.py,sha256=L4YXZJl-kYURENEs0EV0-Pqz32RwJ_iLjgxCB1hK4Pw,21131
+stix_shifter_utils/stix_translation/src/patterns/grammar/STIXPatternLexer.py,sha256=UQrt9eg1gPVwiRrblCtutD89LhsYI0BNuzcHwtF-KLc,21128
 stix_shifter_utils/stix_translation/src/patterns/grammar/STIXPatternListener.py,sha256=6i0gMSdhO0Q0T13_C1PWN0GEtn6h4HNOyo1PPGJ1Nl4,12757
 stix_shifter_utils/stix_translation/src/patterns/grammar/STIXPatternParser.py,sha256=8Sfx0P8sVU-9fC1ZqoDkhpanLplqUATBv_Da3dnYuCs,98182
 stix_shifter_utils/stix_translation/src/patterns/grammar/STIXPatternVisitor.py,sha256=fQkeDe6jSGtESM39LMr_JvtPw_4_LFktZsQ_M_GETLw,7566
 stix_shifter_utils/stix_translation/src/patterns/grammar/__init__.py,sha256=kTCYzUzCo_I6_FsAxs0R3yUKDoJfogVNMz_E_chzd8Q,200
 stix_shifter_utils/stix_translation/src/utils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_utils/stix_translation/src/utils/exceptions.py,sha256=0jsI1CyFF76EIWOegnFMOC9v2_dapgf_1wBNoYr2GFI,474
 stix_shifter_utils/stix_translation/src/utils/stix_pattern_parser.py,sha256=QU4TXnTjC_tcgq2ntJNrol0ZlBqPF3eXherZrCJoB0Y,5602
@@ -57,22 +57,22 @@
 stix_shifter_utils/stix_transmission/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_utils/stix_transmission/utils/RestApiClient.py,sha256=IpPseAqowAS-B3x-lh1AOxg9YzfD3bjb93CwnBNiVjE,6336
 stix_shifter_utils/stix_transmission/utils/RestApiClientAsync.py,sha256=GcvXhATwo7aLHJpc_GF84GgQ5J2eAvg6bYBLHioGaDM,7432
 stix_shifter_utils/stix_transmission/utils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_utils/stix_transmission/utils/timeout_http_adapter.py,sha256=6RkKYxxlJi1yGFMijHNzoIhA2lcPy34QY8ByExw3uUQ,545
 stix_shifter_utils/utils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_utils/utils/async_utils.py,sha256=qDFxuev2s3YbEYfE8hCr3SejG6mQQe8Bp1q-F1zEgY4,722
-stix_shifter_utils/utils/base_entry_point.py,sha256=i7sdkOhg1VSxrjyo37az8naktlDfpKOY7_KPaw9E7A8,15426
+stix_shifter_utils/utils/base_entry_point.py,sha256=0FQCTVrn4rdfkJMzvChKbfZd0qg2SniL84pGBP6_kv4,16199
 stix_shifter_utils/utils/error_mapper_base.py,sha256=k8yEOx1RrDHaOXWNEsdUHBPet02c0KZZEtrce66zM1g,644
 stix_shifter_utils/utils/error_response.py,sha256=mF6HkmPFM05noyrkocAVNXEVUQhrB4a8cxdLdMvqKfI,7740
 stix_shifter_utils/utils/file_helper.py,sha256=6k1thIdTiO6NUh4qrR6LPt5K3vrpVZ3252rDEwL7nBY,2339
 stix_shifter_utils/utils/helpers.py,sha256=LuXdv90dB7kkI0Mc1rgosoHFeZKRPCqgOPBNS8MxKuI,2667
 stix_shifter_utils/utils/logger.py,sha256=NlgRUHe2h8R2XGukIjTrzlsj8pKrmqa_e_NBuYeBnpY,1596
-stix_shifter_utils/utils/module_discovery.py,sha256=lYkV5QIsmbH58xvmfzschANpSSljdO1YTVzDtSNnyG4,2107
+stix_shifter_utils/utils/module_discovery.py,sha256=SEEujNxiUYFNlYflNSLv5OkVuPCPdti_8wOuVaPFGi4,2270
 stix_shifter_utils/utils/param_validator.py,sha256=rN5_SR2hNnWNJT0RvSL_F69tgDY4TKZwXq1Uyze0EVw,9065
 stix_shifter_utils/utils/proxy_host.py,sha256=rVdhtY5tqETFrfktUSIvB9W03mWUWAH62ngEKN8p7z4,3417
-stix_shifter_utils-5.3.1.dist-info/LICENSE.md,sha256=ssGEKMVW69oFTBblVhD1YPolqCOyOCJi4wRDRI7xCnU,12786
-stix_shifter_utils-5.3.1.dist-info/METADATA,sha256=FXIgLoO-QzyXXeKa2KOlx3CjQMf8Hsw2w_CM1HSGM18,8027
-stix_shifter_utils-5.3.1.dist-info/NOTICE,sha256=wx-gWE9vSnLJ7YQkrGlMp9VNXOXG57TTxDDRd9CEdYg,1418
-stix_shifter_utils-5.3.1.dist-info/WHEEL,sha256=bb2Ot9scclHKMOLDEHY6B2sicWOgugjFKaJsT7vwMQo,110
-stix_shifter_utils-5.3.1.dist-info/top_level.txt,sha256=m3rdq-iGDZCUQeyCgdi60rowAiic88WjzTjU9H6li0w,19
-stix_shifter_utils-5.3.1.dist-info/RECORD,,
+stix_shifter_utils-6.0.0.dev74.dist-info/LICENSE.md,sha256=ssGEKMVW69oFTBblVhD1YPolqCOyOCJi4wRDRI7xCnU,12786
+stix_shifter_utils-6.0.0.dev74.dist-info/METADATA,sha256=jFf0fSWUkAcVds9M0qlZQ9hYUVG67D5h6y8jmQHk70Y,8033
+stix_shifter_utils-6.0.0.dev74.dist-info/NOTICE,sha256=wx-gWE9vSnLJ7YQkrGlMp9VNXOXG57TTxDDRd9CEdYg,1418
+stix_shifter_utils-6.0.0.dev74.dist-info/WHEEL,sha256=bb2Ot9scclHKMOLDEHY6B2sicWOgugjFKaJsT7vwMQo,110
+stix_shifter_utils-6.0.0.dev74.dist-info/top_level.txt,sha256=m3rdq-iGDZCUQeyCgdi60rowAiic88WjzTjU9H6li0w,19
+stix_shifter_utils-6.0.0.dev74.dist-info/RECORD,,
```

