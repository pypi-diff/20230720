# Comparing `tmp/looqbox-4.2.0-py3-none-any.whl.zip` & `tmp/looqbox-4.2.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,8 +1,8 @@
-Zip file size: 7191264 bytes, number of entries: 207
+Zip file size: 7192001 bytes, number of entries: 207
 -rw-r--r--  2.0 unx      276 b- defN 23-May-02 18:25 looqbox/__init__.py
 -rw-r--r--  2.0 unx     2977 b- defN 23-Jul-11 11:34 looqbox/global_calling.py
 -rw-r--r--  2.0 unx     1471 b- defN 23-May-02 18:25 looqbox/json_encoder.py
 -rw-r--r--  2.0 unx        0 b- defN 22-Nov-21 21:06 looqbox/teste.py
 -rw-r--r--  2.0 unx        0 b- defN 23-Feb-01 12:29 looqbox/class_loader/__init__.py
 -rw-r--r--  2.0 unx      388 b- defN 23-Feb-01 12:29 looqbox/class_loader/class_loader.py
 -rw-r--r--  2.0 unx      316 b- defN 23-May-02 18:25 looqbox/class_loader/lazy_import.py
@@ -37,23 +37,23 @@
 -rw-r--r--  2.0 unx     2394 b- defN 23-May-10 19:53 looqbox/flows/base_flow.py
 -rw-r--r--  2.0 unx     1224 b- defN 23-May-02 18:25 looqbox/flows/flow_factory.py
 -rw-r--r--  2.0 unx      517 b- defN 23-May-02 18:25 looqbox/flows/reload_database_connection_flow.py
 -rw-r--r--  2.0 unx     1075 b- defN 23-May-10 19:53 looqbox/flows/script_flow.py
 -rw-r--r--  2.0 unx     1049 b- defN 23-May-10 19:53 looqbox/flows/script_response_form_flow.py
 -rw-r--r--  2.0 unx      713 b- defN 23-Jun-13 18:36 looqbox/flows/test_connection_flow.py
 -rw-r--r--  2.0 unx        0 b- defN 22-Sep-26 20:35 looqbox/integration/__init__.py
--rw-r--r--  2.0 unx    21827 b- defN 23-Jun-13 18:36 looqbox/integration/integration_links.py
+-rw-r--r--  2.0 unx    23715 b- defN 23-Jul-20 21:08 looqbox/integration/integration_links.py
 -rw-r--r--  2.0 unx     3240 b- defN 23-May-10 19:53 looqbox/integration/looqbox_global.py
 -rw-r--r--  2.0 unx      145 b- defN 22-Sep-26 20:35 looqbox/integration/user.py
 -rw-r--r--  2.0 unx        0 b- defN 23-Jul-11 11:34 looqbox/integration/configs/__init__.py
 -rw-r--r--  2.0 unx       70 b- defN 23-May-02 18:25 looqbox/integration/configs/tag_extraction_options.json
 -rw-r--r--  2.0 unx        0 b- defN 22-Sep-26 20:35 looqbox/integration/test/__init__.py
 -rw-r--r--  2.0 unx     3919 b- defN 23-May-23 01:23 looqbox/integration/test/test_get_entity.py
 -rw-r--r--  2.0 unx     1445 b- defN 23-May-23 01:23 looqbox/integration/test/test_get_keywords.py
--rw-r--r--  2.0 unx     2196 b- defN 23-May-08 21:14 looqbox/integration/test/test_get_partition.py
+-rw-r--r--  2.0 unx     3216 b- defN 23-Jul-20 21:08 looqbox/integration/test/test_get_partition.py
 -rw-r--r--  2.0 unx      790 b- defN 23-May-02 18:25 looqbox/integration/test/test_get_sso_attributes.py
 -rw-r--r--  2.0 unx     4817 b- defN 23-May-23 01:23 looqbox/integration/test/test_look_tag.py
 -rw-r--r--  2.0 unx        0 b- defN 22-Sep-26 20:35 looqbox/objects/__init__.py
 -rw-r--r--  2.0 unx     1262 b- defN 23-May-02 18:25 looqbox/objects/api.py
 -rw-r--r--  2.0 unx     2672 b- defN 22-Sep-26 20:35 looqbox/objects/looq_audio.py
 -rw-r--r--  2.0 unx     1536 b- defN 22-Nov-17 21:17 looqbox/objects/looq_embed.py
 -rw-r--r--  2.0 unx     1639 b- defN 22-Nov-17 21:17 looqbox/objects/looq_file_upload.py
@@ -196,14 +196,14 @@
 -rw-r--r--  2.0 unx      263 b- defN 22-Sep-26 20:35 looqbox/view/log_functions.py
 -rw-r--r--  2.0 unx      534 b- defN 23-Jan-10 18:37 looqbox/view/response_board.py
 -rw-r--r--  2.0 unx     2992 b- defN 22-Nov-17 21:17 looqbox/view/response_frame.py
 -rw-r--r--  2.0 unx      667 b- defN 22-Nov-17 21:17 looqbox/view/view_functions.py
 -rw-r--r--  2.0 unx        0 b- defN 22-Sep-26 20:35 looqbox/view/tests/__init__.py
 -rw-r--r--  2.0 unx     2857 b- defN 22-Nov-21 21:06 looqbox/view/tests/test_response_board.py
 -rw-r--r--  2.0 unx     2603 b- defN 22-Nov-21 21:06 looqbox/view/tests/test_response_frame.py
--rwxr-xr-x  2.0 unx       42 b- defN 23-Jul-11 11:40 looqbox-4.2.0.data/scripts/looq
--rw-r--r--  2.0 unx     1073 b- defN 23-Jul-11 11:40 looqbox-4.2.0.dist-info/LICENSE
--rw-r--r--  2.0 unx     1352 b- defN 23-Jul-11 11:40 looqbox-4.2.0.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jul-11 11:40 looqbox-4.2.0.dist-info/WHEEL
--rw-r--r--  2.0 unx        8 b- defN 23-Jul-11 11:40 looqbox-4.2.0.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx    19529 b- defN 23-Jul-11 11:40 looqbox-4.2.0.dist-info/RECORD
-207 files, 9111218 bytes uncompressed, 7159600 bytes compressed:  21.4%
+-rwxr-xr-x  2.0 unx       42 b- defN 23-Jul-20 21:09 looqbox-4.2.1.data/scripts/looq
+-rw-r--r--  2.0 unx     1073 b- defN 23-Jul-20 21:09 looqbox-4.2.1.dist-info/LICENSE
+-rw-r--r--  2.0 unx     1352 b- defN 23-Jul-20 21:09 looqbox-4.2.1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-20 21:09 looqbox-4.2.1.dist-info/WHEEL
+-rw-r--r--  2.0 unx        8 b- defN 23-Jul-20 21:09 looqbox-4.2.1.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx    19529 b- defN 23-Jul-20 21:09 looqbox-4.2.1.dist-info/RECORD
+207 files, 9114126 bytes uncompressed, 7160337 bytes compressed:  21.4%
```

## zipnote {}

```diff
@@ -597,26 +597,26 @@
 
 Filename: looqbox/view/tests/test_response_board.py
 Comment: 
 
 Filename: looqbox/view/tests/test_response_frame.py
 Comment: 
 
-Filename: looqbox-4.2.0.data/scripts/looq
+Filename: looqbox-4.2.1.data/scripts/looq
 Comment: 
 
-Filename: looqbox-4.2.0.dist-info/LICENSE
+Filename: looqbox-4.2.1.dist-info/LICENSE
 Comment: 
 
-Filename: looqbox-4.2.0.dist-info/METADATA
+Filename: looqbox-4.2.1.dist-info/METADATA
 Comment: 
 
-Filename: looqbox-4.2.0.dist-info/WHEEL
+Filename: looqbox-4.2.1.dist-info/WHEEL
 Comment: 
 
-Filename: looqbox-4.2.0.dist-info/top_level.txt
+Filename: looqbox-4.2.1.dist-info/top_level.txt
 Comment: 
 
-Filename: looqbox-4.2.0.dist-info/RECORD
+Filename: looqbox-4.2.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## looqbox/integration/integration_links.py

```diff
@@ -55,23 +55,51 @@
 
     if show_json is True:
         if isinstance(response_json, list) or isinstance(response_json, dict):
             print(json.dumps(response_json, indent=4))
         else:
             print(response_json)
 
+    dev_link_header = build_request_header()
+
     try:
-        link_request = requests.post(url, data=response_json)
+        link_request = requests.post(url, headers=dev_link_header, data=response_json)
     except requests.ConnectionError:
         logging.error("Page not found -> {0}".format(url))
         sys.exit(1)
 
     return link_request
 
 
+def build_request_header() -> dict:
+    header = {'x-rstudio-user': 'rstudio', 'Content-Type': 'application/json',
+              "x-rstudio-pass": _get_rstudio_password()}
+
+    return  header
+
+
+def _get_rstudio_password() -> str:
+
+    from os import environ
+
+    try:
+        rstudio_pass = environ["RSTUDIO_PASS"]
+    except:
+        rstudio_pass = _get_rstudio_pass_locally()
+
+    return rstudio_pass
+
+def _get_rstudio_pass_locally() -> str:
+
+    configuration_file = load_json_from_relative_path(GlobalCalling.looq.config_file)
+    try:
+        return configuration_file["RSTUDIO_PASS"]
+    except KeyError as error:
+        raise Exception(f"Missing RSTUDIO_PASS in local configuration file")
+
 def _safe_get_first(_list):
     """Helper method to get the first element of a list -> defaults to None"""
     return next(iter(_list or []), None)
 
 
 def _flatten_response(_list):
     """Helper method to flatten a given list or dict"""
@@ -83,42 +111,59 @@
 def _get_tag(_tag, _subtag):
     """Get content inside requested entity - defaults to empty list"""
     if isinstance(_tag.get(_subtag), dict):
         return _tag.get(_subtag, {}).get("content")
     return _tag.get(_subtag)
 
 
-def _extract_value(element, extract_variable="value"):
+def _extract_with_flattening(element, extract_variable="value"):
+    """Extracts value and return the status of the extraction"""
+    if isinstance(element, dict):
+        element = element.get(extract_variable)
+        # If the element is a list containing a single list inside of it, we flatten it
+        if not isinstance(element, list):
+            return element
+        if len(element) == 1 and isinstance(_safe_get_first(element), list):
+            return _safe_get_first(element)
+        return element
+    return element
+
+
+def _extract(element, extract_variable="value"):
     """Extracts value and return the status of the extraction"""
     if isinstance(element, dict):
         return element.get(extract_variable)
     return element
 
 
 def _is_list_of_dicts(response_list):
     return isinstance(response_list, list) and isinstance(_safe_get_first(response_list), dict)
 
 
-def _extract_values(extract_options, response, tag):
-    # Get extracted variable name
-    extract_variable = extract_options.get(tag, "value")
-    # Prepare partial function
-    _extract = partial(_extract_value, extract_variable=extract_variable)
-    # Extract value from each element
-    response_list = []
-    for element in response:
-        extracted = _extract(element)
-        if isinstance(extracted, list):
-            response_list.extend(extracted)
-        elif len(response) == 1:
-            return extracted
-        else:
-            response_list.append(extracted)
-
-    return response_list
+def _extract_values(response, to_extract="value"):
+    # First we need to ensure that the response is a list
+    if not isinstance(response, list):
+        return response
+    # Secondly, we ensure that every element is a dict
+    if any(not isinstance(element, dict) for element in response):
+        return response
+    # Next we need to verify if it contains one or more elements before extracting it
+    list_len = len(response)
+    # Let's partially load the extract value functions with the parameter to extract
+    flatten_extract = partial(_extract_with_flattening, extract_variable=to_extract)
+    extract = partial(_extract, extract_variable=to_extract)
+    # If the list has only one element, we should extract it and return it flattened
+    if list_len == 1:
+        response_list = list(map(extract, response))
+        # If the child is a list, we flatten it
+        if isinstance(_safe_get_first(response_list), list):
+            return list(itertools.chain(*response_list))
+        return _safe_get_first(response_list)
+    # Else we return extract it and flatten each element as required
+    return list(map(flatten_extract, response))
 
 
 @multimethod
 def _new_look_tag(tag: str, par_json: dict, subtag: list, default: Any, only_value: bool):
     if default is None:
         default = [None] * len(subtag)
 
@@ -150,15 +195,16 @@
 
     # If response is None and default is None, return None
     if response is None:
         return default
 
     # If requested only value, extract it for each element.
     if only_value and _is_list_of_dicts(response):
-        response_list = _extract_values(extract_options, response, tag)
+        to_extract = extract_options.get(tag, "value")
+        response_list = _extract_values(response, to_extract)
         response = response_list
 
     return response
 
 
 def _old_look_tag(tag, par_json, default):
     if isinstance(tag, list):
```

## looqbox/integration/test/test_get_partition.py

```diff
@@ -1,12 +1,12 @@
 import json
 import os
 import unittest
 
-from looqbox.integration.integration_links import get_partition
+from looqbox.integration.integration_links import get_partition, _extract_values
 from looqbox.utils.utils import open_file
 
 
 class TestGetPartition(unittest.TestCase):
 
     def test_get_partition_new_json_one_partition(self):
         """
@@ -57,7 +57,34 @@
     def test_list_none_diff_simplified_json(self):
         file = open_file(os.path.dirname(__file__), "parser_reference", "simple_test_par.json")
         par = json.load(file)
         file.close()
 
         state = get_partition("$country", par, only_value=True)
         self.assertEqual([], state)
+
+    def test_only_value_extraction(self):
+        samples = [
+            [{"value": [["2023-07-01", "2023-07-31"]]}],  # esse mes
+            [
+                {"value": [["2023-06-01", "2023-06-30"]]},
+                {"value": [["2023-07-01", "2023-07-31"]]}
+            ],  # esse mes e mes passado
+            [{"value": [1]}],  # loja 1
+            [{"value": [1, 2]}],  # loja 1 e 2
+            [{"value": [1]}, {"value": [2]}],  # loja 1 e loja 2
+            [{"value": [1]}, {"value": [2, 3]}],  # loja 1 e loja 2 e 3
+            [1],  # default value set by user
+            1  # default value set by user
+        ]
+        result = [_extract_values(sample) for sample in samples]
+        expected = [
+            [["2023-07-01", "2023-07-31"]],
+            [["2023-06-01", "2023-06-30"], ["2023-07-01", "2023-07-31"]],
+            [1],
+            [1, 2],
+            [[1], [2]],
+            [[1], [2, 3]],
+            [1],
+            1
+        ]
+        self.assertEqual(expected, result)
```

## Comparing `looqbox-4.2.0.dist-info/LICENSE` & `looqbox-4.2.1.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `looqbox-4.2.0.dist-info/METADATA` & `looqbox-4.2.1.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: looqbox
-Version: 4.2.0
+Version: 4.2.1
 Summary: A looqbox package to write python scripts in the platform
 Home-page: https://github.com/looqbox/python-package
 Author: looqbox
 Author-email: admin@looqbox.com
 License: UNKNOWN
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3
```

## Comparing `looqbox-4.2.0.dist-info/RECORD` & `looqbox-4.2.1.dist-info/RECORD`

 * *Files 2% similar despite different names*

```diff
@@ -36,23 +36,23 @@
 looqbox/flows/base_flow.py,sha256=EDueXksN4XgJ8DvmDfPtCBDXWoTFTG_gogR9Dg_QfKY,2394
 looqbox/flows/flow_factory.py,sha256=gSbNl9YGnGJJTerhpS4FxyZTs99d7b5GKl_yfH370cA,1224
 looqbox/flows/reload_database_connection_flow.py,sha256=1DugkLWu015lNYafzZzgnUjaHJOBnOGNudJjSYgUkLY,517
 looqbox/flows/script_flow.py,sha256=nEr2CYrAdrJ7J3dO3vxchSs_A1SlUciGc_fPcY3eKjU,1075
 looqbox/flows/script_response_form_flow.py,sha256=O-4oGj2eK_91_EMf2VHCDiSAed7IvEhgPO64gDmvREQ,1049
 looqbox/flows/test_connection_flow.py,sha256=98ykV9WEuDhCPM3T6-kkoQEhf5pj8wD_6un8564qzlE,713
 looqbox/integration/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-looqbox/integration/integration_links.py,sha256=21kG86vvLrl1JIyJ1ZaMTxFun2BPOG9OMlJWr9JsflA,21827
+looqbox/integration/integration_links.py,sha256=Won89NDUqsL2cbuHNucYxY6dEthsUGyGwizvVOPtBqM,23715
 looqbox/integration/looqbox_global.py,sha256=gKKVyx0GcMT84XsftWgK9c11Ki9QP1fRPRrRozcVxDM,3240
 looqbox/integration/user.py,sha256=BpkNLsj8HgSKs19aQYcZqT9gqOy9WyS0z5r9znossBM,145
 looqbox/integration/configs/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 looqbox/integration/configs/tag_extraction_options.json,sha256=ebFGSJG4SjB1OlrcAW08Bhp1V3yW5RyG8FIUMWKxvuw,70
 looqbox/integration/test/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 looqbox/integration/test/test_get_entity.py,sha256=Wza1ZFTbE90XtPo5T3wHRMSuSXA7kAbzcbhZizKKBCw,3919
 looqbox/integration/test/test_get_keywords.py,sha256=3FSSHSDGW-BsmGWTaASn6_2Nl0mWr0UMxWMwAFqEdtU,1445
-looqbox/integration/test/test_get_partition.py,sha256=omqbLeALLUHsZIDWVamtrESU9M70ScCEaXfw_9OJLAw,2196
+looqbox/integration/test/test_get_partition.py,sha256=XsQ7R1yeEGxENmBr23hC2WVbv7ltp-0KIC-PMLFe8H0,3216
 looqbox/integration/test/test_get_sso_attributes.py,sha256=jqXwDIPc7AW4G_uLpjHhwK-0MzVWoQdvt9-jyT1yOto,790
 looqbox/integration/test/test_look_tag.py,sha256=_voTTp13GP0IjojpTWUNj8gO-qFWuFc0YN4s-rXqGx0,4817
 looqbox/objects/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 looqbox/objects/api.py,sha256=0uLB9kJamTuaSTgf-EFxrDYRMC5OnZRLous5TBEN1P8,1262
 looqbox/objects/looq_audio.py,sha256=qBzBV6X1h0KIom0XjdgkjAiHPz6i6UWA6NtRV_FOQl4,2672
 looqbox/objects/looq_embed.py,sha256=hhcS1OxxFf-jTEjJIRB50gJRFwdGk_n9_VkadpLuhks,1536
 looqbox/objects/looq_file_upload.py,sha256=e3tKpZ66LZRA0w8rwnlqkCO4ZyB_el4WrF_uCSAPp6A,1639
@@ -195,13 +195,13 @@
 looqbox/view/log_functions.py,sha256=uPRCKFkx5TY4aAnTjOz9xzpary1Iu6gutSHnyAGPJ2g,263
 looqbox/view/response_board.py,sha256=7oRQQlQ3ksacgOHcbrUo08ZbDls0kVIK-6SvRU17hgA,534
 looqbox/view/response_frame.py,sha256=lq8JI5bYGSbB6oR60ZFXIpH4bUKWiNip5FnAl_-uChc,2992
 looqbox/view/view_functions.py,sha256=WEtH8ekptSRLpITnLIzUXDvvOitT0Ue46cc8achjVa8,667
 looqbox/view/tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 looqbox/view/tests/test_response_board.py,sha256=KrPqZbOh3FLuEMHILMKU8EHV6b6gq92C6zYwz9u-GC4,2857
 looqbox/view/tests/test_response_frame.py,sha256=mOfIlVpgF7IUpZNIOlsM8jc92Ol06tM95DK9CBh6SFg,2603
-looqbox-4.2.0.data/scripts/looq,sha256=3csn1Umd6KQ4yp4DRA-qPo_bqZRupizppQNN--bm26I,42
-looqbox-4.2.0.dist-info/LICENSE,sha256=2bm9uFabQZ3Ykb_SaSU_uUbAj2-htc6WJQmS_65qD00,1073
-looqbox-4.2.0.dist-info/METADATA,sha256=F1H8YIMa-Y_kd3eExrrbZUb8wPD-JYVz7yfvXJSfGBY,1352
-looqbox-4.2.0.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-looqbox-4.2.0.dist-info/top_level.txt,sha256=885s3GhRX70T44C3f0-8199eVe2B0Q1mpd48ZfwLUdA,8
-looqbox-4.2.0.dist-info/RECORD,,
+looqbox-4.2.1.data/scripts/looq,sha256=3csn1Umd6KQ4yp4DRA-qPo_bqZRupizppQNN--bm26I,42
+looqbox-4.2.1.dist-info/LICENSE,sha256=2bm9uFabQZ3Ykb_SaSU_uUbAj2-htc6WJQmS_65qD00,1073
+looqbox-4.2.1.dist-info/METADATA,sha256=Wo9glMEqx6O5tEr2wdxVypUlejLx_rYmbGKOGxOeqxA,1352
+looqbox-4.2.1.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
+looqbox-4.2.1.dist-info/top_level.txt,sha256=885s3GhRX70T44C3f0-8199eVe2B0Q1mpd48ZfwLUdA,8
+looqbox-4.2.1.dist-info/RECORD,,
```

