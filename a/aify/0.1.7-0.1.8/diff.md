# Comparing `tmp/aify-0.1.7-py3-none-any.whl.zip` & `tmp/aify-0.1.8-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,33 +1,33 @@
-Zip file size: 1372342 bytes, number of entries: 31
--rw-r--r--  2.0 unx      103 b- defN 23-Jul-20 08:33 aify/__init__.py
+Zip file size: 1372425 bytes, number of entries: 31
+-rw-r--r--  2.0 unx      103 b- defN 23-Jul-20 10:56 aify/__init__.py
 -rw-r--r--  2.0 unx     3129 b- defN 23-Jul-20 06:58 aify/__main__.py
 -rw-r--r--  2.0 unx     2411 b- defN 23-Jul-20 02:12 aify/_auth.py
 -rw-r--r--  2.0 unx     7251 b- defN 23-Jul-20 07:10 aify/_entry.py
 -rw-r--r--  2.0 unx      415 b- defN 23-Jul-19 02:13 aify/_env.py
 -rw-r--r--  2.0 unx       37 b- defN 23-Jul-19 02:15 aify/_error.py
 -rw-r--r--  2.0 unx       51 b- defN 23-Jul-19 02:15 aify/_logging.py
 -rw-r--r--  2.0 unx     5062 b- defN 23-Jul-20 02:55 aify/_program.py
--rw-r--r--  2.0 unx      681 b- defN 23-Jul-20 07:54 aify/_web_template.py
--rw-r--r--  2.0 unx     1569 b- defN 23-Jul-20 06:31 aify/embeddings.py
--rw-r--r--  2.0 unx      322 b- defN 23-Jul-19 02:21 aify/embeddings_openai.py
+-rw-r--r--  2.0 unx      711 b- defN 23-Jul-20 08:51 aify/_web_template.py
+-rw-r--r--  2.0 unx     1652 b- defN 23-Jul-20 10:14 aify/embeddings.py
+-rw-r--r--  2.0 unx      409 b- defN 23-Jul-20 10:55 aify/embeddings_openai.py
 -rw-r--r--  2.0 unx     2102 b- defN 23-Jul-19 12:21 aify/memory.py
 -rw-r--r--  2.0 unx        0 b- defN 23-Jul-19 12:39 aify/memories/__init__.py
 -rw-r--r--  2.0 unx     1867 b- defN 23-Jul-20 08:13 aify/memories/google_cloud_datastore.py
--rwxr-xr-x  2.0 unx       36 b- defN 23-Jul-18 04:20 aify-0.1.7.data/scripts/aify
--rwxr-xr-x  2.0 unx      112 b- defN 23-Jul-19 06:50 aify-0.1.7.data/scripts/requirements.txt
--rwxr-xr-x  2.0 unx     1351 b- defN 23-Jul-18 07:03 aify-0.1.7.data/scripts/setup.py
+-rwxr-xr-x  2.0 unx       36 b- defN 23-Jul-18 04:20 aify-0.1.8.data/scripts/aify
+-rwxr-xr-x  2.0 unx      112 b- defN 23-Jul-19 06:50 aify-0.1.8.data/scripts/requirements.txt
+-rwxr-xr-x  2.0 unx     1351 b- defN 23-Jul-18 07:03 aify-0.1.8.data/scripts/setup.py
 -rw-r--r--  2.0 unx        0 b- defN 23-Jul-18 03:44 webui/__init__.py
--rw-r--r--  2.0 unx   241104 b- defN 23-Jul-20 08:34 webui/static/aify/aify.css
--rw-r--r--  2.0 unx   656493 b- defN 23-Jul-20 08:34 webui/static/aify/aify.css.map
--rw-r--r--  2.0 unx   866765 b- defN 23-Jul-20 08:34 webui/static/aify/aify.js
--rw-r--r--  2.0 unx     1852 b- defN 23-Jul-20 08:34 webui/static/aify/aify.js.LICENSE.txt
--rw-r--r--  2.0 unx  3611185 b- defN 23-Jul-20 08:34 webui/static/aify/aify.js.map
+-rw-r--r--  2.0 unx   241104 b- defN 23-Jul-20 10:57 webui/static/aify/aify.css
+-rw-r--r--  2.0 unx   656493 b- defN 23-Jul-20 10:57 webui/static/aify/aify.css.map
+-rw-r--r--  2.0 unx   866765 b- defN 23-Jul-20 10:57 webui/static/aify/aify.js
+-rw-r--r--  2.0 unx     1852 b- defN 23-Jul-20 10:57 webui/static/aify/aify.js.LICENSE.txt
+-rw-r--r--  2.0 unx  3611185 b- defN 23-Jul-20 10:57 webui/static/aify/aify.js.map
 -rw-r--r--  2.0 unx      559 b- defN 23-Jul-19 06:52 webui/templates/auth.html
 -rw-r--r--  2.0 unx      543 b- defN 23-Jul-19 06:23 webui/templates/basic.html
 -rw-r--r--  2.0 unx      665 b- defN 23-Jul-19 06:09 webui/templates/index.html
--rw-r--r--  2.0 unx     1071 b- defN 23-Jul-20 08:34 aify-0.1.7.dist-info/LICENSE
--rw-r--r--  2.0 unx     6177 b- defN 23-Jul-20 08:34 aify-0.1.7.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jul-20 08:34 aify-0.1.7.dist-info/WHEEL
--rw-r--r--  2.0 unx       11 b- defN 23-Jul-20 08:34 aify-0.1.7.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2442 b- defN 23-Jul-20 08:34 aify-0.1.7.dist-info/RECORD
-31 files, 5415458 bytes uncompressed, 1368476 bytes compressed:  74.7%
+-rw-r--r--  2.0 unx     1071 b- defN 23-Jul-20 10:57 aify-0.1.8.dist-info/LICENSE
+-rw-r--r--  2.0 unx     6177 b- defN 23-Jul-20 10:57 aify-0.1.8.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-20 10:57 aify-0.1.8.dist-info/WHEEL
+-rw-r--r--  2.0 unx       11 b- defN 23-Jul-20 10:57 aify-0.1.8.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2442 b- defN 23-Jul-20 10:57 aify-0.1.8.dist-info/RECORD
+31 files, 5415658 bytes uncompressed, 1368559 bytes compressed:  74.7%
```

## zipnote {}

```diff
@@ -36,21 +36,21 @@
 
 Filename: aify/memories/__init__.py
 Comment: 
 
 Filename: aify/memories/google_cloud_datastore.py
 Comment: 
 
-Filename: aify-0.1.7.data/scripts/aify
+Filename: aify-0.1.8.data/scripts/aify
 Comment: 
 
-Filename: aify-0.1.7.data/scripts/requirements.txt
+Filename: aify-0.1.8.data/scripts/requirements.txt
 Comment: 
 
-Filename: aify-0.1.7.data/scripts/setup.py
+Filename: aify-0.1.8.data/scripts/setup.py
 Comment: 
 
 Filename: webui/__init__.py
 Comment: 
 
 Filename: webui/static/aify/aify.css
 Comment: 
@@ -72,23 +72,23 @@
 
 Filename: webui/templates/basic.html
 Comment: 
 
 Filename: webui/templates/index.html
 Comment: 
 
-Filename: aify-0.1.7.dist-info/LICENSE
+Filename: aify-0.1.8.dist-info/LICENSE
 Comment: 
 
-Filename: aify-0.1.7.dist-info/METADATA
+Filename: aify-0.1.8.dist-info/METADATA
 Comment: 
 
-Filename: aify-0.1.7.dist-info/WHEEL
+Filename: aify-0.1.8.dist-info/WHEEL
 Comment: 
 
-Filename: aify-0.1.7.dist-info/top_level.txt
+Filename: aify-0.1.8.dist-info/top_level.txt
 Comment: 
 
-Filename: aify-0.1.7.dist-info/RECORD
+Filename: aify-0.1.8.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## aify/__init__.py

```diff
@@ -1,4 +1,4 @@
-__version__ = '0.1.7'
+__version__ = '0.1.8'
 
 from ._entry import entry, api
 from ._web_template import apps_render as render
```

## aify/_web_template.py

```diff
@@ -2,17 +2,17 @@
 from starlette.templating import Jinja2Templates
 from ._env import webui_dir, apps_dir
 
 templates = Jinja2Templates(directory=os.path.join(webui_dir(), 'templates'))
 
 apps_templates = Jinja2Templates(directory=os.path.join(apps_dir(), 'templates'))
 
-def render(template_name, context = {}, apps_tempates=False):
+def render(template_name, context = {}, is_apps_tempates=False):
     """Render a template."""
     async def _request(request):
         context['request'] = request
-        tpls = apps_tempates if apps_tempates else templates
+        tpls = apps_templates if is_apps_tempates else templates
         return tpls.TemplateResponse(template_name, context=context)
     return _request
 
 def apps_render(template_name, context = {}):
-    return render(template_name=template_name, context=context)
+    return render(template_name=template_name, context=context, is_apps_tempates=True)
```

## aify/embeddings.py

```diff
@@ -17,22 +17,22 @@
 def cosine_similarity(a, b):
     """This is the Cosine Similarity algorithm."""
     return np.dot(a, b) / (np.linalg.norm(a) * np.linalg.norm(b))
 
 
 def search(collection_name: str, text: str, n=3):
     """Searches the specified collection."""
-    df = _load_collections(collection_name)
+    df = _load_collections(collection_name).copy(deep=False)
     embeds = embed(text)
-    df['similarities'] = df['embedding'].apply(
+    df['score'] = df['embedding'].apply(
         lambda x: cosine_similarity(x, embeds))
-    res = df.sort_values('similarities', ascending=False).head(
+    res = df.sort_values('score', ascending=False).head(
         n).drop(['embedding'], axis=1)
-    return res.values.tolist()
-
+    #return res.values.todict()
+    return res.to_json(orient="records", force_ascii=False, double_precision=4)
 
 def build_csv(from_file: str, to_file: str):
     """Builds word embeddings for a CSV file"""
     try:
         df = pd.read_csv(from_file)
         df['embedding'] = df.apply(lambda x: embed(x.to_string()), axis=1)
         df.to_csv(to_file, index=False)
```

## aify/embeddings_openai.py

```diff
@@ -1,13 +1,15 @@
 import os
 import openai
 
 
 def embed(text: str, model='text-embedding-ada-002'):
     """Generate embeddings."""
-    openai.api_key = os.environ["OPENAI_API_KEY"]
-    openai.api_base = os.environ["OPENAI_API_BASE"]
+    if "OPENAI_API_KEY" in os.environ:
+        openai.api_key = os.environ["OPENAI_API_KEY"]
+    if "OPENAI_API_BASE" in os.environ:
+        openai.api_base = os.environ["OPENAI_API_BASE"]
 
     return openai.Embedding.create(
         input=[text],
         model=model
     )['data'][0]['embedding']
```

## Comparing `aify-0.1.7.data/scripts/setup.py` & `aify-0.1.8.data/scripts/setup.py`

 * *Files identical despite different names*

## Comparing `aify-0.1.7.dist-info/LICENSE` & `aify-0.1.8.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `aify-0.1.7.dist-info/METADATA` & `aify-0.1.8.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: aify
-Version: 0.1.7
+Version: 0.1.8
 Summary: aify is an AI-native application framework and runtime
 Home-page: https://github.com/shellc/aify
 Author-email: shenggong.wang@gmail.com
 Keywords: AI-Native,LLM,aify,chatbot
 Description-Content-Type: text/markdown
 License-File: LICENSE
 Requires-Dist: guidance
```

## Comparing `aify-0.1.7.dist-info/RECORD` & `aify-0.1.8.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,31 +1,31 @@
-aify/__init__.py,sha256=H4vCo1fqGI9OZM5MjA9txeYiLOUstbdl9zivGCUtKos,103
+aify/__init__.py,sha256=VTYMdXjDakyKNzuwUWy0boHNBcH6FedcJ98sjTARNWs,103
 aify/__main__.py,sha256=sp9Te15kUdkjA_z3jD5UFBz8n_LOvvVaRgVBWIJ9ZYE,3129
 aify/_auth.py,sha256=56N-Fa3CnSI0k1chYKp3JcIbUqSQveLkE8pSUwSS8IA,2411
 aify/_entry.py,sha256=-yTvmyDr4iWqR1enL58DVqArjPerXlKIoyoe1-sPVSY,7251
 aify/_env.py,sha256=MsNbVndyOBQODho36aUkVr8FyBhvzdQGSl_w_NcJG3c,415
 aify/_error.py,sha256=VCA0ZV7ivQ0pGHxdFHLc5-KBxQtccnbML_b_nV01-9I,37
 aify/_logging.py,sha256=CtB4dWhVt76j0ype0ii7YmoBN9FcDZ4m0-DCqCSnVws,51
 aify/_program.py,sha256=TVyceIgIsaGSQwWVLrk31HwmYZD2_hQLN0WrNZpFK4k,5062
-aify/_web_template.py,sha256=g4PmKzEUop56ihfw2BD833VTGg5DCLNLTxseiSKXjAM,681
-aify/embeddings.py,sha256=AtLV1J9PDljDcXn_vdo57DOeXFcgVVD78sa9XNy4Hs0,1569
-aify/embeddings_openai.py,sha256=aGDGoYfv-F7DkI9pOJfCQOyTMdurxVCwJm6_AduSU0I,322
+aify/_web_template.py,sha256=p9q691_YzUywh0UZwzaDQv9HA6Q8fvZIbnGNoaqBVzc,711
+aify/embeddings.py,sha256=OEK5EoebCs8BwfHwhSuv6YIRVwlIYh4pb5yVtGD89H4,1652
+aify/embeddings_openai.py,sha256=r3EfKxa-FIhEhMZdlbm5nYAqnAezAZPNk_4Y0pU5gPo,409
 aify/memory.py,sha256=dlfgafyph1C5DLRD_otZNqXMDb8gJo1bA70eQpTy4NE,2102
 aify/memories/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 aify/memories/google_cloud_datastore.py,sha256=--DmVtp7GkhemF51lkci_ERXAYdFbH4WVJs6KiQk3do,1867
-aify-0.1.7.data/scripts/aify,sha256=ocvEBE3luWtvoqhheCj039mK_5OnuJ5UgPDUX2boMck,36
-aify-0.1.7.data/scripts/requirements.txt,sha256=trxB65baEVvkOHViMA3TxYeyZPywANzlCq2Fgq2PL3o,112
-aify-0.1.7.data/scripts/setup.py,sha256=lmsPrm7hdZNu25-NpZjzJSGe2QSg0NgMfrlaZQRGrNs,1351
+aify-0.1.8.data/scripts/aify,sha256=ocvEBE3luWtvoqhheCj039mK_5OnuJ5UgPDUX2boMck,36
+aify-0.1.8.data/scripts/requirements.txt,sha256=trxB65baEVvkOHViMA3TxYeyZPywANzlCq2Fgq2PL3o,112
+aify-0.1.8.data/scripts/setup.py,sha256=lmsPrm7hdZNu25-NpZjzJSGe2QSg0NgMfrlaZQRGrNs,1351
 webui/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 webui/static/aify/aify.css,sha256=RA0SEF4RG6GT4ethKNKxTg8OzIQD5bj7dyIA4yVyDMA,241104
 webui/static/aify/aify.css.map,sha256=o7IC2Lpkr4o9TxNhuXmDNKhs2MTCDu_CHpMI8baedhI,656493
 webui/static/aify/aify.js,sha256=qYfuK5H7PviiTIyD3gyptwep4jxNNodPMyhIwXxlAW4,866765
 webui/static/aify/aify.js.LICENSE.txt,sha256=zNsFYopKdSoihu-yaqZFz6FfKE43eGeoLnRHd2IL41c,1852
 webui/static/aify/aify.js.map,sha256=Rbgrxtdvxf0DDoH7KI8mXU_UzUap0OFVTEbyn8JV8Zw,3611185
 webui/templates/auth.html,sha256=cndbRF4xry5Ng5MSWxjqGi8SQADlW_DrWDMh4BizUrc,559
 webui/templates/basic.html,sha256=G4Gzn1lvfG8pC4PSRTW38KgbgXQ3lbtqSaYc9MHctO8,543
 webui/templates/index.html,sha256=ARa99ojduQ5RoSZqoupv1wpvw1n-ZnzYqfikl6wW9Sc,665
-aify-0.1.7.dist-info/LICENSE,sha256=r-u8iAmSxCFjnZKeQcZnZF8KMi2Cs4cgGQMBxA2Hbwg,1071
-aify-0.1.7.dist-info/METADATA,sha256=SKuE3SNCDd0I3m1QRKsiMiU5uRidmaANP7XfI41aIiE,6177
-aify-0.1.7.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-aify-0.1.7.dist-info/top_level.txt,sha256=P7ZAYFs-muF2wH0-BCCEU-jNq9bSQiaMUj9yqOX2hcQ,11
-aify-0.1.7.dist-info/RECORD,,
+aify-0.1.8.dist-info/LICENSE,sha256=r-u8iAmSxCFjnZKeQcZnZF8KMi2Cs4cgGQMBxA2Hbwg,1071
+aify-0.1.8.dist-info/METADATA,sha256=-buAZxCr68p8NDAlZm8YKQZ7EnlTxQHaX17HbWHH-2c,6177
+aify-0.1.8.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+aify-0.1.8.dist-info/top_level.txt,sha256=P7ZAYFs-muF2wH0-BCCEU-jNq9bSQiaMUj9yqOX2hcQ,11
+aify-0.1.8.dist-info/RECORD,,
```

