# Comparing `tmp/aify-0.1.6-py3-none-any.whl.zip` & `tmp/aify-0.1.7-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,33 +1,33 @@
-Zip file size: 1371945 bytes, number of entries: 31
--rw-r--r--  2.0 unx       49 b- defN 23-Jul-20 03:03 aify/__init__.py
--rw-r--r--  2.0 unx     3129 b- defN 23-Jul-19 02:14 aify/__main__.py
+Zip file size: 1372342 bytes, number of entries: 31
+-rw-r--r--  2.0 unx      103 b- defN 23-Jul-20 08:33 aify/__init__.py
+-rw-r--r--  2.0 unx     3129 b- defN 23-Jul-20 06:58 aify/__main__.py
 -rw-r--r--  2.0 unx     2411 b- defN 23-Jul-20 02:12 aify/_auth.py
--rw-r--r--  2.0 unx     7063 b- defN 23-Jul-20 02:54 aify/_entry.py
+-rw-r--r--  2.0 unx     7251 b- defN 23-Jul-20 07:10 aify/_entry.py
 -rw-r--r--  2.0 unx      415 b- defN 23-Jul-19 02:13 aify/_env.py
 -rw-r--r--  2.0 unx       37 b- defN 23-Jul-19 02:15 aify/_error.py
 -rw-r--r--  2.0 unx       51 b- defN 23-Jul-19 02:15 aify/_logging.py
 -rw-r--r--  2.0 unx     5062 b- defN 23-Jul-20 02:55 aify/_program.py
--rw-r--r--  2.0 unx      439 b- defN 23-Jul-19 02:19 aify/_web_template.py
--rw-r--r--  2.0 unx     1422 b- defN 23-Jul-19 02:25 aify/embeddings.py
+-rw-r--r--  2.0 unx      681 b- defN 23-Jul-20 07:54 aify/_web_template.py
+-rw-r--r--  2.0 unx     1569 b- defN 23-Jul-20 06:31 aify/embeddings.py
 -rw-r--r--  2.0 unx      322 b- defN 23-Jul-19 02:21 aify/embeddings_openai.py
 -rw-r--r--  2.0 unx     2102 b- defN 23-Jul-19 12:21 aify/memory.py
 -rw-r--r--  2.0 unx        0 b- defN 23-Jul-19 12:39 aify/memories/__init__.py
--rw-r--r--  2.0 unx     1765 b- defN 23-Jul-19 14:58 aify/memories/google_cloud_datastore.py
--rwxr-xr-x  2.0 unx       36 b- defN 23-Jul-18 04:20 aify-0.1.6.data/scripts/aify
--rwxr-xr-x  2.0 unx      112 b- defN 23-Jul-19 06:50 aify-0.1.6.data/scripts/requirements.txt
--rwxr-xr-x  2.0 unx     1351 b- defN 23-Jul-18 07:03 aify-0.1.6.data/scripts/setup.py
+-rw-r--r--  2.0 unx     1867 b- defN 23-Jul-20 08:13 aify/memories/google_cloud_datastore.py
+-rwxr-xr-x  2.0 unx       36 b- defN 23-Jul-18 04:20 aify-0.1.7.data/scripts/aify
+-rwxr-xr-x  2.0 unx      112 b- defN 23-Jul-19 06:50 aify-0.1.7.data/scripts/requirements.txt
+-rwxr-xr-x  2.0 unx     1351 b- defN 23-Jul-18 07:03 aify-0.1.7.data/scripts/setup.py
 -rw-r--r--  2.0 unx        0 b- defN 23-Jul-18 03:44 webui/__init__.py
--rw-r--r--  2.0 unx   241104 b- defN 23-Jul-20 03:03 webui/static/aify/aify.css
--rw-r--r--  2.0 unx   656493 b- defN 23-Jul-20 03:03 webui/static/aify/aify.css.map
--rw-r--r--  2.0 unx   866765 b- defN 23-Jul-20 03:03 webui/static/aify/aify.js
--rw-r--r--  2.0 unx     1852 b- defN 23-Jul-20 03:03 webui/static/aify/aify.js.LICENSE.txt
--rw-r--r--  2.0 unx  3611185 b- defN 23-Jul-20 03:03 webui/static/aify/aify.js.map
+-rw-r--r--  2.0 unx   241104 b- defN 23-Jul-20 08:34 webui/static/aify/aify.css
+-rw-r--r--  2.0 unx   656493 b- defN 23-Jul-20 08:34 webui/static/aify/aify.css.map
+-rw-r--r--  2.0 unx   866765 b- defN 23-Jul-20 08:34 webui/static/aify/aify.js
+-rw-r--r--  2.0 unx     1852 b- defN 23-Jul-20 08:34 webui/static/aify/aify.js.LICENSE.txt
+-rw-r--r--  2.0 unx  3611185 b- defN 23-Jul-20 08:34 webui/static/aify/aify.js.map
 -rw-r--r--  2.0 unx      559 b- defN 23-Jul-19 06:52 webui/templates/auth.html
 -rw-r--r--  2.0 unx      543 b- defN 23-Jul-19 06:23 webui/templates/basic.html
 -rw-r--r--  2.0 unx      665 b- defN 23-Jul-19 06:09 webui/templates/index.html
--rw-r--r--  2.0 unx     1071 b- defN 23-Jul-20 03:04 aify-0.1.6.dist-info/LICENSE
--rw-r--r--  2.0 unx     5821 b- defN 23-Jul-20 03:04 aify-0.1.6.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jul-20 03:04 aify-0.1.6.dist-info/WHEEL
--rw-r--r--  2.0 unx       11 b- defN 23-Jul-20 03:04 aify-0.1.6.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2441 b- defN 23-Jul-20 03:04 aify-0.1.6.dist-info/RECORD
-31 files, 5414368 bytes uncompressed, 1368079 bytes compressed:  74.7%
+-rw-r--r--  2.0 unx     1071 b- defN 23-Jul-20 08:34 aify-0.1.7.dist-info/LICENSE
+-rw-r--r--  2.0 unx     6177 b- defN 23-Jul-20 08:34 aify-0.1.7.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-20 08:34 aify-0.1.7.dist-info/WHEEL
+-rw-r--r--  2.0 unx       11 b- defN 23-Jul-20 08:34 aify-0.1.7.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2442 b- defN 23-Jul-20 08:34 aify-0.1.7.dist-info/RECORD
+31 files, 5415458 bytes uncompressed, 1368476 bytes compressed:  74.7%
```

## zipnote {}

```diff
@@ -36,21 +36,21 @@
 
 Filename: aify/memories/__init__.py
 Comment: 
 
 Filename: aify/memories/google_cloud_datastore.py
 Comment: 
 
-Filename: aify-0.1.6.data/scripts/aify
+Filename: aify-0.1.7.data/scripts/aify
 Comment: 
 
-Filename: aify-0.1.6.data/scripts/requirements.txt
+Filename: aify-0.1.7.data/scripts/requirements.txt
 Comment: 
 
-Filename: aify-0.1.6.data/scripts/setup.py
+Filename: aify-0.1.7.data/scripts/setup.py
 Comment: 
 
 Filename: webui/__init__.py
 Comment: 
 
 Filename: webui/static/aify/aify.css
 Comment: 
@@ -72,23 +72,23 @@
 
 Filename: webui/templates/basic.html
 Comment: 
 
 Filename: webui/templates/index.html
 Comment: 
 
-Filename: aify-0.1.6.dist-info/LICENSE
+Filename: aify-0.1.7.dist-info/LICENSE
 Comment: 
 
-Filename: aify-0.1.6.dist-info/METADATA
+Filename: aify-0.1.7.dist-info/METADATA
 Comment: 
 
-Filename: aify-0.1.6.dist-info/WHEEL
+Filename: aify-0.1.7.dist-info/WHEEL
 Comment: 
 
-Filename: aify-0.1.6.dist-info/top_level.txt
+Filename: aify-0.1.7.dist-info/top_level.txt
 Comment: 
 
-Filename: aify-0.1.6.dist-info/RECORD
+Filename: aify-0.1.7.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## aify/__init__.py

```diff
@@ -1,3 +1,4 @@
-__version__ = '0.1.6'
+__version__ = '0.1.7'
 
-from ._entry import entry
+from ._entry import entry, api
+from ._web_template import apps_render as render
```

## aify/_entry.py

```diff
@@ -1,9 +1,10 @@
 import os
 import json
+import importlib
 import contextlib
 from starlette.applications import Starlette
 from starlette.routing import Mount, Route
 from starlette.staticfiles import StaticFiles
 from starlette.responses import JSONResponse, StreamingResponse, RedirectResponse
 from starlette.middleware import Middleware
 from starlette.middleware.authentication import AuthenticationMiddleware
@@ -215,16 +216,22 @@
     ))
 
 # Middlewares
 middleware = [
     Middleware(AuthenticationMiddleware, backend=_auth.BasicAuthBackend())
 ]
 
+def import_entry():
+    entry_py = os.path.join(_env.apps_dir(), 'entry.py')
+    if os.path.exists(entry_py):
+        importlib.import_module('entry')
+
 @contextlib.asynccontextmanager
 async def lifespan(app):
+    import_entry()
     yield
 
 entry = Starlette(debug=True, routes=routes, middleware=middleware, lifespan=lifespan)
 
 env_file = os.path.join(_env.apps_dir(), '.env')
 if os.path.exists(env_file):
         from dotenv import load_dotenv
```

## aify/_web_template.py

```diff
@@ -1,13 +1,18 @@
 import os
-from starlette.requests import Request
 from starlette.templating import Jinja2Templates
-from ._env import webui_dir
+from ._env import webui_dir, apps_dir
 
 templates = Jinja2Templates(directory=os.path.join(webui_dir(), 'templates'))
 
-def render(template_name, context = {}):
+apps_templates = Jinja2Templates(directory=os.path.join(apps_dir(), 'templates'))
+
+def render(template_name, context = {}, apps_tempates=False):
     """Render a template."""
     async def _request(request):
         context['request'] = request
-        return templates.TemplateResponse(template_name, context=context)
-    return _request
+        tpls = apps_tempates if apps_tempates else templates
+        return tpls.TemplateResponse(template_name, context=context)
+    return _request
+
+def apps_render(template_name, context = {}):
+    return render(template_name=template_name, context=context)
```

## aify/embeddings.py

```diff
@@ -1,22 +1,21 @@
 import os
-import json
 import pandas as pd
 import numpy as np
 
 from . import embeddings_openai
 from . import _env
 
 
-def embed(text: str):
+def embed(text: str, max_length=None):
     """Genereate embeddings.
 
     Only OpenAI is currently supported.
     """
-    return embeddings_openai.embed(text=text)
+    return embeddings_openai.embed(text=text if not max_length else text[:max_length])
 
 
 def cosine_similarity(a, b):
     """This is the Cosine Similarity algorithm."""
     return np.dot(a, b) / (np.linalg.norm(a) * np.linalg.norm(b))
 
 
@@ -43,12 +42,15 @@
 
 _embeds = {}
 
 
 def _load_collections(name: str):
     global _embeds
     if name not in _embeds:
-        df = pd.read_csv(os.path.join(
-            _env.apps_dir(), 'embeddings', f'{name}.csv'))
+        csv_file = os.path.join(_env.apps_dir(), 'embeddings', f'{name}.csv')
+        if os.path.exists(f"{csv_file}.gz"):
+            csv_file = f"{csv_file}.gz"
+
+        df = pd.read_csv(csv_file)
         df['embedding'] = df['embedding'].apply(eval).apply(np.array)
         _embeds[name] = df
     return _embeds[name]
```

## aify/memories/google_cloud_datastore.py

```diff
@@ -18,16 +18,18 @@
 
     m = {
         'role': role,
         'content': content,
         'created': time.time()
     }
 
-    entity = datastore.Entity(key=datastore_client.key(
-        'memories', program_name, session_id, uuid()))
+    entity = datastore.Entity(
+        key=datastore_client.key('memories', f'{program_name}_{session_id}', 'session_memories', uuid()),
+        exclude_from_indexes=("content",)
+        )
     entity.update(m)
     datastore_client.put(entity)
 
     session_key = datastore_client.key(
         'sessions', program_name, 'session_id', session_id)
     session_entity = datastore.Entity(key=session_key)
     session_entity.update(m)
@@ -37,16 +39,16 @@
     })
 
     datastore_client.put(session_entity)
 
 
 def read(program_name: str, session_id: str, n=10, max_len=4096) -> List[Dict]:
     query = datastore_client.query(
-        kind=session_id, ancestor=datastore_client.key('memories', program_name))
-    # query.order = ["-created"]
+        kind='session_memories', ancestor=datastore_client.key('memories', f'{program_name}_{session_id}'))
+    query.order = ["-created"]
 
     memories = [x for x in query.fetch(limit=n)]
 
     return memories
 
 
 def sessions(program_name: str) -> List[Dict]:
```

## Comparing `aify-0.1.6.data/scripts/setup.py` & `aify-0.1.7.data/scripts/setup.py`

 * *Files identical despite different names*

## Comparing `aify-0.1.6.dist-info/LICENSE` & `aify-0.1.7.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `aify-0.1.6.dist-info/METADATA` & `aify-0.1.7.dist-info/METADATA`

 * *Files 4% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: aify
-Version: 0.1.6
+Version: 0.1.7
 Summary: aify is an AI-native application framework and runtime
 Home-page: https://github.com/shellc/aify
 Author-email: shenggong.wang@gmail.com
 Keywords: AI-Native,LLM,aify,chatbot
 Description-Content-Type: text/markdown
 License-File: LICENSE
 Requires-Dist: guidance
@@ -31,19 +31,23 @@
 🤖 Ready-to-use AI chatbot UI.
 
 **Dependencies**
 
 * [microsoft/guidance](https://github.com/microsoft/guidance) as the core prompt engine
 * [Uvicorn](https://www.uvicorn.org/), [Starlette](https://www.starlette.io/), [FastAPI](https://fastapi.tiangolo.com/) as the server
 
-**Roadmap**
+**Features**
 
-* API documentation
-* Authorization
-* Deploy to cloud providers
+* Models: The LLMs/transformers models supported by guidance.
+* Memory storage: Local file / Google Cloud Datastore / User-defined
+* Embeddings: OpenAI / User-defined
+* Vector storage and search: Local CSV files, Pandas DataFrame and Numpy in memory / User-defined
+* Deployment: Local / [Google Cloud App engine](https://docs.aify.run/deploy_to_clouds/google_appengine/)
+* UI: Chatbot webui
+* API: RESTful API / Python
 
 ## Getting started
 
 Welcome to Aify, the AI-native application framework and runtime that allows you to ship your AI applications in seconds! With Aify, you can easily build and deploy AI-powered applications using a simple YAML file. In this guide, we will walk you through the steps to get started with Aify and create your first AI application.
 
 
 ### Installation
```

## Comparing `aify-0.1.6.dist-info/RECORD` & `aify-0.1.7.dist-info/RECORD`

 * *Files 12% similar despite different names*

```diff
@@ -1,31 +1,31 @@
-aify/__init__.py,sha256=61Hrqj6tw8ck1ocVMbLkoH3Dlh8ALCZosMmWZZFFPhI,49
+aify/__init__.py,sha256=H4vCo1fqGI9OZM5MjA9txeYiLOUstbdl9zivGCUtKos,103
 aify/__main__.py,sha256=sp9Te15kUdkjA_z3jD5UFBz8n_LOvvVaRgVBWIJ9ZYE,3129
 aify/_auth.py,sha256=56N-Fa3CnSI0k1chYKp3JcIbUqSQveLkE8pSUwSS8IA,2411
-aify/_entry.py,sha256=zwos8fdDvPJ0gtdJhNtkp8BN4HeUiVI4dRiTv6x5QoU,7063
+aify/_entry.py,sha256=-yTvmyDr4iWqR1enL58DVqArjPerXlKIoyoe1-sPVSY,7251
 aify/_env.py,sha256=MsNbVndyOBQODho36aUkVr8FyBhvzdQGSl_w_NcJG3c,415
 aify/_error.py,sha256=VCA0ZV7ivQ0pGHxdFHLc5-KBxQtccnbML_b_nV01-9I,37
 aify/_logging.py,sha256=CtB4dWhVt76j0ype0ii7YmoBN9FcDZ4m0-DCqCSnVws,51
 aify/_program.py,sha256=TVyceIgIsaGSQwWVLrk31HwmYZD2_hQLN0WrNZpFK4k,5062
-aify/_web_template.py,sha256=YHRgKN8bOM-b0qktG6OV2gLzxIUPZIPp_bj6nQWybrc,439
-aify/embeddings.py,sha256=vr-LkxblVKsqwwBbnOSpY7k_3y2fQ8OMWmVXPR4LoZo,1422
+aify/_web_template.py,sha256=g4PmKzEUop56ihfw2BD833VTGg5DCLNLTxseiSKXjAM,681
+aify/embeddings.py,sha256=AtLV1J9PDljDcXn_vdo57DOeXFcgVVD78sa9XNy4Hs0,1569
 aify/embeddings_openai.py,sha256=aGDGoYfv-F7DkI9pOJfCQOyTMdurxVCwJm6_AduSU0I,322
 aify/memory.py,sha256=dlfgafyph1C5DLRD_otZNqXMDb8gJo1bA70eQpTy4NE,2102
 aify/memories/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-aify/memories/google_cloud_datastore.py,sha256=Ssh4-bgqJkrz0y4uPMJASB5ygNPqwIQQju02Lg_KW78,1765
-aify-0.1.6.data/scripts/aify,sha256=ocvEBE3luWtvoqhheCj039mK_5OnuJ5UgPDUX2boMck,36
-aify-0.1.6.data/scripts/requirements.txt,sha256=trxB65baEVvkOHViMA3TxYeyZPywANzlCq2Fgq2PL3o,112
-aify-0.1.6.data/scripts/setup.py,sha256=lmsPrm7hdZNu25-NpZjzJSGe2QSg0NgMfrlaZQRGrNs,1351
+aify/memories/google_cloud_datastore.py,sha256=--DmVtp7GkhemF51lkci_ERXAYdFbH4WVJs6KiQk3do,1867
+aify-0.1.7.data/scripts/aify,sha256=ocvEBE3luWtvoqhheCj039mK_5OnuJ5UgPDUX2boMck,36
+aify-0.1.7.data/scripts/requirements.txt,sha256=trxB65baEVvkOHViMA3TxYeyZPywANzlCq2Fgq2PL3o,112
+aify-0.1.7.data/scripts/setup.py,sha256=lmsPrm7hdZNu25-NpZjzJSGe2QSg0NgMfrlaZQRGrNs,1351
 webui/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 webui/static/aify/aify.css,sha256=RA0SEF4RG6GT4ethKNKxTg8OzIQD5bj7dyIA4yVyDMA,241104
 webui/static/aify/aify.css.map,sha256=o7IC2Lpkr4o9TxNhuXmDNKhs2MTCDu_CHpMI8baedhI,656493
 webui/static/aify/aify.js,sha256=qYfuK5H7PviiTIyD3gyptwep4jxNNodPMyhIwXxlAW4,866765
 webui/static/aify/aify.js.LICENSE.txt,sha256=zNsFYopKdSoihu-yaqZFz6FfKE43eGeoLnRHd2IL41c,1852
 webui/static/aify/aify.js.map,sha256=Rbgrxtdvxf0DDoH7KI8mXU_UzUap0OFVTEbyn8JV8Zw,3611185
 webui/templates/auth.html,sha256=cndbRF4xry5Ng5MSWxjqGi8SQADlW_DrWDMh4BizUrc,559
 webui/templates/basic.html,sha256=G4Gzn1lvfG8pC4PSRTW38KgbgXQ3lbtqSaYc9MHctO8,543
 webui/templates/index.html,sha256=ARa99ojduQ5RoSZqoupv1wpvw1n-ZnzYqfikl6wW9Sc,665
-aify-0.1.6.dist-info/LICENSE,sha256=r-u8iAmSxCFjnZKeQcZnZF8KMi2Cs4cgGQMBxA2Hbwg,1071
-aify-0.1.6.dist-info/METADATA,sha256=i5MjdY3M2SJRb-AMqtDWN98qfKO8sKeuXld6tKZ91f4,5821
-aify-0.1.6.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-aify-0.1.6.dist-info/top_level.txt,sha256=P7ZAYFs-muF2wH0-BCCEU-jNq9bSQiaMUj9yqOX2hcQ,11
-aify-0.1.6.dist-info/RECORD,,
+aify-0.1.7.dist-info/LICENSE,sha256=r-u8iAmSxCFjnZKeQcZnZF8KMi2Cs4cgGQMBxA2Hbwg,1071
+aify-0.1.7.dist-info/METADATA,sha256=SKuE3SNCDd0I3m1QRKsiMiU5uRidmaANP7XfI41aIiE,6177
+aify-0.1.7.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+aify-0.1.7.dist-info/top_level.txt,sha256=P7ZAYFs-muF2wH0-BCCEU-jNq9bSQiaMUj9yqOX2hcQ,11
+aify-0.1.7.dist-info/RECORD,,
```

