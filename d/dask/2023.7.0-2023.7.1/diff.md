# Comparing `tmp/dask-2023.7.0.tar.gz` & `tmp/dask-2023.7.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dask-2023.7.0.tar", last modified: Fri Jul  7 17:35:33 2023, max compression
+gzip compressed data, was "dask-2023.7.1.tar", last modified: Thu Jul 20 21:06:45 2023, max compression
```

## Comparing `dask-2023.7.0.tar` & `dask-2023.7.1.tar`

### file list

```diff
@@ -1,487 +1,487 @@
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.661025 dask-2023.7.0/
--rw-r--r--   0 james      (501) staff       (20)     1531 2022-10-24 20:44:15.000000 dask-2023.7.0/LICENSE.txt
--rw-r--r--   0 james      (501) staff       (20)      325 2022-11-09 22:20:24.000000 dask-2023.7.0/MANIFEST.in
--rw-r--r--   0 james      (501) staff       (20)     2532 2023-07-07 17:35:33.659539 dask-2023.7.0/PKG-INFO
--rw-r--r--   0 james      (501) staff       (20)     1291 2022-11-09 22:20:24.000000 dask-2023.7.0/README.rst
--rw-r--r--   0 james      (501) staff       (20)     2397 2023-07-07 17:17:26.000000 dask-2023.7.0/conftest.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.661702 dask-2023.7.0/dask/
--rw-r--r--   0 james      (501) staff       (20)      485 2023-06-26 19:01:25.000000 dask-2023.7.0/dask/__init__.py
--rw-r--r--   0 james      (501) staff       (20)      133 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/__main__.py
--rw-r--r--   0 james      (501) staff       (20)      643 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/_compatibility.py
--rw-r--r--   0 james      (501) staff       (20)      500 2023-07-07 17:35:33.661850 dask-2023.7.0/dask/_version.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:32.928130 dask-2023.7.0/dask/array/
--rw-r--r--   0 james      (501) staff       (20)     1543 2021-06-08 02:50:30.000000 dask-2023.7.0/dask/array/NUMPY_LICENSE.txt
--rw-r--r--   0 james      (501) staff       (20)     5413 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    12600 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/backends.py
--rw-r--r--   0 james      (501) staff       (20)     9983 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/blockwise.py
--rw-r--r--   0 james      (501) staff       (20)    12304 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/chunk.py
--rw-r--r--   0 james      (501) staff       (20)     5066 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/chunk_types.py
--rw-r--r--   0 james      (501) staff       (20)   190831 2023-06-26 19:07:05.000000 dask-2023.7.0/dask/array/core.py
--rw-r--r--   0 james      (501) staff       (20)    40564 2023-05-03 18:02:08.000000 dask-2023.7.0/dask/array/creation.py
--rw-r--r--   0 james      (501) staff       (20)     2114 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/cupy_entry_point.py
--rw-r--r--   0 james      (501) staff       (20)      526 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/dispatch.py
--rw-r--r--   0 james      (501) staff       (20)     9146 2023-06-26 19:01:25.000000 dask-2023.7.0/dask/array/einsumfuncs.py
--rw-r--r--   0 james      (501) staff       (20)     7252 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/fft.py
--rw-r--r--   0 james      (501) staff       (20)    32656 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/gufunc.py
--rw-r--r--   0 james      (501) staff       (20)     1996 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/image.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:32.929442 dask-2023.7.0/dask/array/lib/
--rw-r--r--   0 james      (501) staff       (20)       77 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/lib/__init__.py
--rw-r--r--   0 james      (501) staff       (20)      101 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/lib/stride_tricks.py
--rw-r--r--   0 james      (501) staff       (20)    53335 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/linalg.py
--rw-r--r--   0 james      (501) staff       (20)     6363 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/ma.py
--rw-r--r--   0 james      (501) staff       (20)     5699 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/numpy_compat.py
--rw-r--r--   0 james      (501) staff       (20)    12838 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/optimization.py
--rw-r--r--   0 james      (501) staff       (20)    28480 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/overlap.py
--rw-r--r--   0 james      (501) staff       (20)    10652 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/percentile.py
--rw-r--r--   0 james      (501) staff       (20)    40604 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/random.py
--rw-r--r--   0 james      (501) staff       (20)    28324 2023-06-20 19:59:21.000000 dask-2023.7.0/dask/array/rechunk.py
--rw-r--r--   0 james      (501) staff       (20)    57287 2023-06-01 20:02:33.000000 dask-2023.7.0/dask/array/reductions.py
--rw-r--r--   0 james      (501) staff       (20)    10765 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/reshape.py
--rw-r--r--   0 james      (501) staff       (20)    81977 2023-06-20 20:00:03.000000 dask-2023.7.0/dask/array/routines.py
--rw-r--r--   0 james      (501) staff       (20)    72631 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/slicing.py
--rw-r--r--   0 james      (501) staff       (20)    16184 2023-07-07 00:51:47.000000 dask-2023.7.0/dask/array/stats.py
--rw-r--r--   0 james      (501) staff       (20)     8048 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/svg.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:32.966026 dask-2023.7.0/dask/array/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.7.0/dask/array/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)   161461 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_array_core.py
--rw-r--r--   0 james      (501) staff       (20)     6689 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_array_function.py
--rw-r--r--   0 james      (501) staff       (20)     3159 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_array_utils.py
--rw-r--r--   0 james      (501) staff       (20)    23222 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_atop.py
--rw-r--r--   0 james      (501) staff       (20)     3304 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_chunk.py
--rw-r--r--   0 james      (501) staff       (20)    31150 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_creation.py
--rw-r--r--   0 james      (501) staff       (20)    19888 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_cupy_core.py
--rw-r--r--   0 james      (501) staff       (20)     6456 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_cupy_creation.py
--rw-r--r--   0 james      (501) staff       (20)      594 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_cupy_gufunc.py
--rw-r--r--   0 james      (501) staff       (20)    13412 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_cupy_linalg.py
--rw-r--r--   0 james      (501) staff       (20)     4303 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_cupy_overlap.py
--rw-r--r--   0 james      (501) staff       (20)     2862 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_cupy_percentile.py
--rw-r--r--   0 james      (501) staff       (20)     9219 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_cupy_random.py
--rw-r--r--   0 james      (501) staff       (20)     2224 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_cupy_reductions.py
--rw-r--r--   0 james      (501) staff       (20)     7437 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_cupy_routines.py
--rw-r--r--   0 james      (501) staff       (20)     4877 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_cupy_slicing.py
--rw-r--r--   0 james      (501) staff       (20)     2982 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_cupy_sparse.py
--rw-r--r--   0 james      (501) staff       (20)     8865 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_dispatch.py
--rw-r--r--   0 james      (501) staff       (20)     8437 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_fft.py
--rw-r--r--   0 james      (501) staff       (20)    21013 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_gufunc.py
--rw-r--r--   0 james      (501) staff       (20)     1482 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_image.py
--rw-r--r--   0 james      (501) staff       (20)    36448 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_linalg.py
--rw-r--r--   0 james      (501) staff       (20)    15635 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_masked.py
--rw-r--r--   0 james      (501) staff       (20)     1087 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_numpy_compat.py
--rw-r--r--   0 james      (501) staff       (20)    17446 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_optimization.py
--rw-r--r--   0 james      (501) staff       (20)    26718 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_overlap.py
--rw-r--r--   0 james      (501) staff       (20)     3443 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_percentiles.py
--rw-r--r--   0 james      (501) staff       (20)    15353 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_random.py
--rw-r--r--   0 james      (501) staff       (20)    36262 2023-06-20 19:59:21.000000 dask-2023.7.0/dask/array/tests/test_rechunk.py
--rw-r--r--   0 james      (501) staff       (20)    32756 2023-06-01 20:02:33.000000 dask-2023.7.0/dask/array/tests/test_reductions.py
--rw-r--r--   0 james      (501) staff       (20)     7289 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_reshape.py
--rw-r--r--   0 james      (501) staff       (20)    83849 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_routines.py
--rw-r--r--   0 james      (501) staff       (20)    32302 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_slicing.py
--rw-r--r--   0 james      (501) staff       (20)     6592 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_sparse.py
--rw-r--r--   0 james      (501) staff       (20)     5489 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_stats.py
--rw-r--r--   0 james      (501) staff       (20)     2740 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_svg.py
--rw-r--r--   0 james      (501) staff       (20)      525 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_testing.py
--rw-r--r--   0 james      (501) staff       (20)    17390 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_ufunc.py
--rw-r--r--   0 james      (501) staff       (20)     2706 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_wrap.py
--rw-r--r--   0 james      (501) staff       (20)     1317 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tests/test_xarray.py
--rw-r--r--   0 james      (501) staff       (20)     4737 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/tiledb_io.py
--rw-r--r--   0 james      (501) staff       (20)     9943 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/ufunc.py
--rw-r--r--   0 james      (501) staff       (20)    18674 2023-06-26 19:11:47.000000 dask-2023.7.0/dask/array/utils.py
--rw-r--r--   0 james      (501) staff       (20)     6906 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/array/wrap.py
--rw-r--r--   0 james      (501) staff       (20)     4936 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/backends.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:32.970202 dask-2023.7.0/dask/bag/
--rw-r--r--   0 james      (501) staff       (20)      903 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/bag/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     9111 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/bag/avro.py
--rw-r--r--   0 james      (501) staff       (20)      763 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/bag/chunk.py
--rw-r--r--   0 james      (501) staff       (20)    84737 2023-06-20 19:59:21.000000 dask-2023.7.0/dask/bag/core.py
--rw-r--r--   0 james      (501) staff       (20)     5464 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/bag/random.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:32.975190 dask-2023.7.0/dask/bag/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.7.0/dask/bag/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     3808 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/bag/tests/test_avro.py
--rw-r--r--   0 james      (501) staff       (20)    51087 2023-06-20 19:59:21.000000 dask-2023.7.0/dask/bag/tests/test_bag.py
--rw-r--r--   0 james      (501) staff       (20)     6528 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/bag/tests/test_random.py
--rw-r--r--   0 james      (501) staff       (20)     5049 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/bag/tests/test_text.py
--rw-r--r--   0 james      (501) staff       (20)     6765 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/bag/text.py
--rw-r--r--   0 james      (501) staff       (20)      241 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/bag/utils.py
--rw-r--r--   0 james      (501) staff       (20)    53616 2023-07-07 00:51:47.000000 dask-2023.7.0/dask/base.py
--rw-r--r--   0 james      (501) staff       (20)    53252 2023-05-19 15:53:47.000000 dask-2023.7.0/dask/blockwise.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:32.977597 dask-2023.7.0/dask/bytes/
--rw-r--r--   0 james      (501) staff       (20)       75 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/bytes/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     6933 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/bytes/core.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:32.983404 dask-2023.7.0/dask/bytes/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.7.0/dask/bytes/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     5158 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/bytes/tests/test_bytes_utils.py
--rw-r--r--   0 james      (501) staff       (20)      530 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/bytes/tests/test_compression.py
--rw-r--r--   0 james      (501) staff       (20)     6657 2023-07-07 17:17:22.000000 dask-2023.7.0/dask/bytes/tests/test_http.py
--rw-r--r--   0 james      (501) staff       (20)    11476 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/bytes/tests/test_local.py
--rw-r--r--   0 james      (501) staff       (20)    19667 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/bytes/tests/test_s3.py
--rw-r--r--   0 james      (501) staff       (20)      500 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/bytes/utils.py
--rw-r--r--   0 james      (501) staff       (20)     2001 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/cache.py
--rw-r--r--   0 james      (501) staff       (20)     4067 2022-10-24 20:44:15.000000 dask-2023.7.0/dask/callbacks.py
--rw-r--r--   0 james      (501) staff       (20)     3272 2023-07-07 00:51:47.000000 dask-2023.7.0/dask/cli.py
--rw-r--r--   0 james      (501) staff       (20)      523 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/compatibility.py
--rw-r--r--   0 james      (501) staff       (20)    21703 2023-06-20 19:59:21.000000 dask-2023.7.0/dask/config.py
--rw-r--r--   0 james      (501) staff       (20)     1756 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/context.py
--rw-r--r--   0 james      (501) staff       (20)    14833 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/core.py
--rw-r--r--   0 james      (501) staff       (20)     8050 2023-07-07 17:17:26.000000 dask-2023.7.0/dask/dask-schema.yaml
--rw-r--r--   0 james      (501) staff       (20)     2123 2023-07-07 17:17:26.000000 dask-2023.7.0/dask/dask.yaml
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.029170 dask-2023.7.0/dask/dataframe/
--rw-r--r--   0 james      (501) staff       (20)     1812 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     7496 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/_compat.py
--rw-r--r--   0 james      (501) staff       (20)     2171 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/_dtypes.py
--rw-r--r--   0 james      (501) staff       (20)     3219 2023-07-07 17:17:22.000000 dask-2023.7.0/dask/dataframe/_pyarrow.py
--rw-r--r--   0 james      (501) staff       (20)     1936 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/_pyarrow_compat.py
--rw-r--r--   0 james      (501) staff       (20)    12101 2023-05-03 18:02:08.000000 dask-2023.7.0/dask/dataframe/accessor.py
--rw-r--r--   0 james      (501) staff       (20)    24817 2023-06-26 19:01:25.000000 dask-2023.7.0/dask/dataframe/backends.py
--rw-r--r--   0 james      (501) staff       (20)     9507 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/categorical.py
--rw-r--r--   0 james      (501) staff       (20)   301558 2023-07-07 17:17:26.000000 dask-2023.7.0/dask/dataframe/core.py
--rw-r--r--   0 james      (501) staff       (20)     4609 2023-06-20 19:59:21.000000 dask-2023.7.0/dask/dataframe/dispatch.py
--rw-r--r--   0 james      (501) staff       (20)      552 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/extensions.py
--rw-r--r--   0 james      (501) staff       (20)   115648 2023-06-26 19:01:25.000000 dask-2023.7.0/dask/dataframe/groupby.py
--rw-r--r--   0 james      (501) staff       (20)     2463 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/hyperloglog.py
--rw-r--r--   0 james      (501) staff       (20)    13412 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/indexing.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.037869 dask-2023.7.0/dask/dataframe/io/
--rw-r--r--   0 james      (501) staff       (20)      706 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/io/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    33854 2023-06-26 19:01:25.000000 dask-2023.7.0/dask/dataframe/io/csv.py
--rw-r--r--   0 james      (501) staff       (20)     5781 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/io/demo.py
--rw-r--r--   0 james      (501) staff       (20)    18275 2023-06-20 19:59:21.000000 dask-2023.7.0/dask/dataframe/io/hdf.py
--rw-r--r--   0 james      (501) staff       (20)    38599 2023-07-07 00:51:47.000000 dask-2023.7.0/dask/dataframe/io/io.py
--rw-r--r--   0 james      (501) staff       (20)    11163 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/io/json.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.041730 dask-2023.7.0/dask/dataframe/io/orc/
--rw-r--r--   0 james      (501) staff       (20)       92 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/io/orc/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     4487 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/io/orc/arrow.py
--rw-r--r--   0 james      (501) staff       (20)     7098 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/io/orc/core.py
--rw-r--r--   0 james      (501) staff       (20)      510 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/io/orc/utils.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.051720 dask-2023.7.0/dask/dataframe/io/parquet/
--rw-r--r--   0 james      (501) staff       (20)      166 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/io/parquet/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    71237 2023-07-07 17:17:26.000000 dask-2023.7.0/dask/dataframe/io/parquet/arrow.py
--rw-r--r--   0 james      (501) staff       (20)    67195 2023-06-26 19:01:25.000000 dask-2023.7.0/dask/dataframe/io/parquet/core.py
--rw-r--r--   0 james      (501) staff       (20)    52426 2023-07-07 17:17:22.000000 dask-2023.7.0/dask/dataframe/io/parquet/fastparquet.py
--rw-r--r--   0 james      (501) staff       (20)    32896 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/io/parquet/utils.py
--rw-r--r--   0 james      (501) staff       (20)    21108 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/io/sql.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.063777 dask-2023.7.0/dask/dataframe/io/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2023-03-07 20:03:52.000000 dask-2023.7.0/dask/dataframe/io/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    59293 2023-06-26 19:01:25.000000 dask-2023.7.0/dask/dataframe/io/tests/test_csv.py
--rw-r--r--   0 james      (501) staff       (20)     5036 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/io/tests/test_demo.py
--rw-r--r--   0 james      (501) staff       (20)    27232 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/io/tests/test_hdf.py
--rw-r--r--   0 james      (501) staff       (20)    34779 2023-07-07 00:51:47.000000 dask-2023.7.0/dask/dataframe/io/tests/test_io.py
--rw-r--r--   0 james      (501) staff       (20)     8625 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/io/tests/test_json.py
--rw-r--r--   0 james      (501) staff       (20)     5238 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/io/tests/test_orc.py
--rw-r--r--   0 james      (501) staff       (20)   165615 2023-07-07 17:17:22.000000 dask-2023.7.0/dask/dataframe/io/tests/test_parquet.py
--rw-r--r--   0 james      (501) staff       (20)    17632 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/io/tests/test_sql.py
--rw-r--r--   0 james      (501) staff       (20)     8041 2023-06-20 19:59:21.000000 dask-2023.7.0/dask/dataframe/io/utils.py
--rw-r--r--   0 james      (501) staff       (20)    14071 2023-06-26 19:01:25.000000 dask-2023.7.0/dask/dataframe/methods.py
--rw-r--r--   0 james      (501) staff       (20)    53878 2023-06-20 19:59:21.000000 dask-2023.7.0/dask/dataframe/multi.py
--rw-r--r--   0 james      (501) staff       (20)     1600 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/numeric.py
--rw-r--r--   0 james      (501) staff       (20)     8778 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/optimize.py
--rw-r--r--   0 james      (501) staff       (20)    20104 2023-07-07 00:51:47.000000 dask-2023.7.0/dask/dataframe/partitionquantiles.py
--rw-r--r--   0 james      (501) staff       (20)    11825 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/reshape.py
--rw-r--r--   0 james      (501) staff       (20)    22185 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/rolling.py
--rw-r--r--   0 james      (501) staff       (20)    38085 2023-06-26 19:01:25.000000 dask-2023.7.0/dask/dataframe/shuffle.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.096324 dask-2023.7.0/dask/dataframe/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.7.0/dask/dataframe/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    10633 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_accessors.py
--rw-r--r--   0 james      (501) staff       (20)    67628 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_arithmetics_reduction.py
--rw-r--r--   0 james      (501) staff       (20)      942 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_boolean.py
--rw-r--r--   0 james      (501) staff       (20)    16678 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_categorical.py
--rw-r--r--   0 james      (501) staff       (20)   193513 2023-07-07 00:51:47.000000 dask-2023.7.0/dask/dataframe/tests/test_dataframe.py
--rw-r--r--   0 james      (501) staff       (20)     1456 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_extensions.py
--rw-r--r--   0 james      (501) staff       (20)    14743 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_format.py
--rw-r--r--   0 james      (501) staff       (20)   121785 2023-06-26 19:01:25.000000 dask-2023.7.0/dask/dataframe/tests/test_groupby.py
--rw-r--r--   0 james      (501) staff       (20)     2702 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_hashing.py
--rw-r--r--   0 james      (501) staff       (20)     2897 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_hyperloglog.py
--rw-r--r--   0 james      (501) staff       (20)    22382 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_indexing.py
--rw-r--r--   0 james      (501) staff       (20)     7034 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_merge_column_and_index.py
--rw-r--r--   0 james      (501) staff       (20)      463 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_methods.py
--rw-r--r--   0 james      (501) staff       (20)    91017 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_multi.py
--rw-r--r--   0 james      (501) staff       (20)     2120 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_numeric.py
--rw-r--r--   0 james      (501) staff       (20)     1067 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_optimize_dataframe.py
--rw-r--r--   0 james      (501) staff       (20)     6662 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_pyarrow.py
--rw-r--r--   0 james      (501) staff       (20)     4550 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_pyarrow_compat.py
--rw-r--r--   0 james      (501) staff       (20)    11571 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_reshape.py
--rw-r--r--   0 james      (501) staff       (20)    17524 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_rolling.py
--rw-r--r--   0 james      (501) staff       (20)    54512 2023-06-26 19:01:25.000000 dask-2023.7.0/dask/dataframe/tests/test_shuffle.py
--rw-r--r--   0 james      (501) staff       (20)    16595 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_ufunc.py
--rw-r--r--   0 james      (501) staff       (20)    21288 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tests/test_utils_dataframe.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.099143 dask-2023.7.0/dask/dataframe/tseries/
--rw-r--r--   0 james      (501) staff       (20)        0 2021-06-08 02:50:30.000000 dask-2023.7.0/dask/dataframe/tseries/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     7664 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tseries/resample.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.100485 dask-2023.7.0/dask/dataframe/tseries/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.7.0/dask/dataframe/tseries/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)     6866 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/dataframe/tseries/tests/test_resample.py
--rw-r--r--   0 james      (501) staff       (20)    27404 2023-07-07 17:17:26.000000 dask-2023.7.0/dask/dataframe/utils.py
--rw-r--r--   0 james      (501) staff       (20)     5314 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/datasets.py
--rw-r--r--   0 james      (501) staff       (20)    24389 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/delayed.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.104116 dask-2023.7.0/dask/diagnostics/
--rw-r--r--   0 james      (501) staff       (20)      258 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/diagnostics/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    12136 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/diagnostics/profile.py
--rw-r--r--   0 james      (501) staff       (20)    16332 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/diagnostics/profile_visualize.py
--rw-r--r--   0 james      (501) staff       (20)     5001 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/diagnostics/progress.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.115980 dask-2023.7.0/dask/diagnostics/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.7.0/dask/diagnostics/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)    12045 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/diagnostics/tests/test_profiler.py
--rw-r--r--   0 james      (501) staff       (20)     3388 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/diagnostics/tests/test_progress.py
--rw-r--r--   0 james      (501) staff       (20)      715 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/distributed.py
--rw-r--r--   0 james      (501) staff       (20)    16587 2022-11-09 22:20:24.000000 dask-2023.7.0/dask/dot.py
--rw-r--r--   0 james      (501) staff       (20)    19595 2022-11-09 22:20:24.000000 dask-2023.7.0/dask/graph_manipulation.py
--rw-r--r--   0 james      (501) staff       (20)     2492 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/hashing.py
--rw-r--r--   0 james      (501) staff       (20)    34778 2023-06-26 19:01:25.000000 dask-2023.7.0/dask/highlevelgraph.py
--rw-r--r--   0 james      (501) staff       (20)    46007 2023-05-03 18:02:08.000000 dask-2023.7.0/dask/layers.py
--rw-r--r--   0 james      (501) staff       (20)    18888 2022-11-09 22:20:24.000000 dask-2023.7.0/dask/local.py
--rw-r--r--   0 james      (501) staff       (20)      487 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/ml.py
--rw-r--r--   0 james      (501) staff       (20)     8466 2022-11-09 22:20:24.000000 dask-2023.7.0/dask/multiprocessing.py
--rw-r--r--   0 james      (501) staff       (20)    35638 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/optimization.py
--rw-r--r--   0 james      (501) staff       (20)    45768 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/order.py
--rw-r--r--   0 james      (501) staff       (20)        0 2022-11-09 22:20:24.000000 dask-2023.7.0/dask/py.typed
--rw-r--r--   0 james      (501) staff       (20)    12597 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/rewrite.py
--rw-r--r--   0 james      (501) staff       (20)     7298 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/sizeof.py
--rw-r--r--   0 james      (501) staff       (20)     1510 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/system.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.169295 dask-2023.7.0/dask/tests/
--rw-r--r--   0 james      (501) staff       (20)        0 2023-03-07 20:04:31.000000 dask-2023.7.0/dask/tests/__init__.py
--rw-r--r--   0 james      (501) staff       (20)      742 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_backends.py
--rw-r--r--   0 james      (501) staff       (20)    51124 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_base.py
--rw-r--r--   0 james      (501) staff       (20)     1613 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_cache.py
--rw-r--r--   0 james      (501) staff       (20)     2570 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_callbacks.py
--rw-r--r--   0 james      (501) staff       (20)     1199 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_ci.py
--rw-r--r--   0 james      (501) staff       (20)     3550 2023-07-07 00:51:47.000000 dask-2023.7.0/dask/tests/test_cli.py
--rw-r--r--   0 james      (501) staff       (20)      379 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_compatibility.py
--rw-r--r--   0 james      (501) staff       (20)    17846 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_config.py
--rw-r--r--   0 james      (501) staff       (20)     1137 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_context.py
--rw-r--r--   0 james      (501) staff       (20)     7422 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_core.py
--rw-r--r--   0 james      (501) staff       (20)     1112 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_datasets.py
--rw-r--r--   0 james      (501) staff       (20)    22989 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_delayed.py
--rw-r--r--   0 james      (501) staff       (20)    35741 2023-06-20 20:00:03.000000 dask-2023.7.0/dask/tests/test_distributed.py
--rw-r--r--   0 james      (501) staff       (20)      925 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_docs.py
--rw-r--r--   0 james      (501) staff       (20)    12271 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_dot.py
--rw-r--r--   0 james      (501) staff       (20)    15070 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_graph_manipulation.py
--rw-r--r--   0 james      (501) staff       (20)     1095 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_hashing.py
--rw-r--r--   0 james      (501) staff       (20)     8860 2023-06-26 19:01:25.000000 dask-2023.7.0/dask/tests/test_highgraph.py
--rw-r--r--   0 james      (501) staff       (20)     9341 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_layers.py
--rw-r--r--   0 james      (501) staff       (20)     5008 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_local.py
--rw-r--r--   0 james      (501) staff       (20)      419 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_ml.py
--rw-r--r--   0 james      (501) staff       (20)     8457 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_multiprocessing.py
--rw-r--r--   0 james      (501) staff       (20)    45227 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_optimization.py
--rw-r--r--   0 james      (501) staff       (20)    28229 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_order.py
--rw-r--r--   0 james      (501) staff       (20)     4684 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_rewrite.py
--rw-r--r--   0 james      (501) staff       (20)     7518 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_sizeof.py
--rw-r--r--   0 james      (501) staff       (20)     7154 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_spark_compat.py
--rw-r--r--   0 james      (501) staff       (20)     1397 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_system.py
--rw-r--r--   0 james      (501) staff       (20)     4749 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_threaded.py
--rw-r--r--   0 james      (501) staff       (20)     5670 2023-04-25 18:34:46.000000 dask-2023.7.0/dask/tests/test_typing.py
--rw-r--r--   0 james      (501) staff       (20)    23807 2023-06-20 20:00:03.000000 dask-2023.7.0/dask/tests/test_utils.py
--rw-r--r--   0 james      (501) staff       (20)     1598 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/test_utils_test.py
--rw-r--r--   0 james      (501) staff       (20)      211 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/tests/warning_aliases.py
--rw-r--r--   0 james      (501) staff       (20)     2993 2022-11-09 22:20:24.000000 dask-2023.7.0/dask/threaded.py
--rw-r--r--   0 james      (501) staff       (20)    14538 2022-11-09 22:20:24.000000 dask-2023.7.0/dask/typing.py
--rw-r--r--   0 james      (501) staff       (20)    57828 2023-06-20 20:00:03.000000 dask-2023.7.0/dask/utils.py
--rw-r--r--   0 james      (501) staff       (20)     4825 2023-04-11 17:13:14.000000 dask-2023.7.0/dask/utils_test.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.173186 dask-2023.7.0/dask/widgets/
--rw-r--r--   0 james      (501) staff       (20)      792 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/widgets/__init__.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.182590 dask-2023.7.0/dask/widgets/templates/
--rw-r--r--   0 james      (501) staff       (20)     1295 2023-03-13 17:40:25.000000 dask-2023.7.0/dask/widgets/templates/array.html.j2
--rw-r--r--   0 james      (501) staff       (20)      124 2022-11-09 22:20:24.000000 dask-2023.7.0/dask/widgets/templates/dataframe.html.j2
--rw-r--r--   0 james      (501) staff       (20)     2579 2022-11-09 22:20:24.000000 dask-2023.7.0/dask/widgets/templates/highlevelgraph.html.j2
--rw-r--r--   0 james      (501) staff       (20)     1981 2022-11-09 22:20:24.000000 dask-2023.7.0/dask/widgets/templates/highlevelgraph_layer.html.j2
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.183594 dask-2023.7.0/dask/widgets/tests/
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.218686 dask-2023.7.0/dask/widgets/tests/templates/
--rw-r--r--   0 james      (501) staff       (20)       38 2022-10-24 20:44:15.000000 dask-2023.7.0/dask/widgets/tests/templates/bytes.html.j2
--rw-r--r--   0 james      (501) staff       (20)       39 2022-10-24 20:44:15.000000 dask-2023.7.0/dask/widgets/tests/templates/custom_filter.html.j2
--rw-r--r--   0 james      (501) staff       (20)       30 2022-10-24 20:44:15.000000 dask-2023.7.0/dask/widgets/tests/templates/example.html.j2
--rw-r--r--   0 james      (501) staff       (20)     1401 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/widgets/tests/test_widgets.py
--rw-r--r--   0 james      (501) staff       (20)     1120 2023-05-31 15:34:32.000000 dask-2023.7.0/dask/widgets/widgets.py
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:32.887375 dask-2023.7.0/dask.egg-info/
--rw-r--r--   0 james      (501) staff       (20)     2532 2023-07-07 17:35:32.000000 dask-2023.7.0/dask.egg-info/PKG-INFO
--rw-r--r--   0 james      (501) staff       (20)    13939 2023-07-07 17:35:32.000000 dask-2023.7.0/dask.egg-info/SOURCES.txt
--rw-r--r--   0 james      (501) staff       (20)        1 2023-07-07 17:35:32.000000 dask-2023.7.0/dask.egg-info/dependency_links.txt
--rw-r--r--   0 james      (501) staff       (20)      124 2023-07-07 17:35:32.000000 dask-2023.7.0/dask.egg-info/entry_points.txt
--rw-r--r--   0 james      (501) staff       (20)        1 2023-07-07 17:35:31.000000 dask-2023.7.0/dask.egg-info/not-zip-safe
--rw-r--r--   0 james      (501) staff       (20)      454 2023-07-07 17:35:32.000000 dask-2023.7.0/dask.egg-info/requires.txt
--rw-r--r--   0 james      (501) staff       (20)        5 2023-07-07 17:35:32.000000 dask-2023.7.0/dask.egg-info/top_level.txt
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.222040 dask-2023.7.0/docs/
--rw-r--r--   0 james      (501) staff       (20)     5741 2023-03-22 19:03:53.000000 dask-2023.7.0/docs/Makefile
--rw-r--r--   0 james      (501) staff       (20)     5186 2022-08-08 20:45:08.000000 dask-2023.7.0/docs/make.bat
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.446851 dask-2023.7.0/docs/source/
--rw-r--r--   0 james      (501) staff       (20)    17598 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/10-minutes-to-dask.rst
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.466281 dask-2023.7.0/docs/source/_static/
--rw-r--r--   0 james      (501) staff       (20)    10187 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/_static/config_converter.js
--rw-r--r--   0 james      (501) staff       (20)    11021 2021-06-08 02:50:31.000000 dask-2023.7.0/docs/source/_static/dask-simple.png
--rw-r--r--   0 james      (501) staff       (20)     2375 2021-06-08 02:51:08.000000 dask-2023.7.0/docs/source/_static/main-page.css
--rw-r--r--   0 james      (501) staff       (20)    15598 2022-08-08 20:45:08.000000 dask-2023.7.0/docs/source/_static/profile.html
--rw-r--r--   0 james      (501) staff       (20)    65304 2022-08-08 20:45:08.000000 dask-2023.7.0/docs/source/_static/stacked_profile.html
--rw-r--r--   0 james      (501) staff       (20)      523 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/_static/style.css
--rw-r--r--   0 james      (501) staff       (20)      365 2021-06-16 20:41:28.000000 dask-2023.7.0/docs/source/_static/theme_overrides.css
--rw-r--r--   0 james      (501) staff       (20)   292662 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/_static/transpose_cyto.html
--rw-r--r--   0 james      (501) staff       (20)    49423 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/_static/yaml.min.js
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.469057 dask-2023.7.0/docs/source/_templates/
--rw-r--r--   0 james      (501) staff       (20)      180 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/_templates/layout.html
--rw-r--r--   0 james      (501) staff       (20)     2269 2023-06-26 19:01:25.000000 dask-2023.7.0/docs/source/api.rst
--rw-r--r--   0 james      (501) staff       (20)     6968 2023-05-24 15:39:04.000000 dask-2023.7.0/docs/source/array-api.rst
--rw-r--r--   0 james      (501) staff       (20)     2943 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/array-assignment.rst
--rw-r--r--   0 james      (501) staff       (20)     4740 2023-03-13 17:40:25.000000 dask-2023.7.0/docs/source/array-best-practices.rst
--rw-r--r--   0 james      (501) staff       (20)    13262 2023-07-07 00:51:47.000000 dask-2023.7.0/docs/source/array-chunks.rst
--rw-r--r--   0 james      (501) staff       (20)    18437 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/array-creation.rst
--rw-r--r--   0 james      (501) staff       (20)     5885 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/array-design.rst
--rw-r--r--   0 james      (501) staff       (20)     2857 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/array-gufunc.rst
--rw-r--r--   0 james      (501) staff       (20)     6069 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/array-overlap.rst
--rw-r--r--   0 james      (501) staff       (20)     3924 2023-05-19 15:53:47.000000 dask-2023.7.0/docs/source/array-random.rst
--rw-r--r--   0 james      (501) staff       (20)     4137 2021-11-11 17:33:01.000000 dask-2023.7.0/docs/source/array-slicing.rst
--rw-r--r--   0 james      (501) staff       (20)     3291 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/array-sparse.rst
--rw-r--r--   0 james      (501) staff       (20)     2018 2022-10-07 21:37:36.000000 dask-2023.7.0/docs/source/array-stack.rst
--rw-r--r--   0 james      (501) staff       (20)     1140 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/array-stats.rst
--rw-r--r--   0 james      (501) staff       (20)     4121 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/array.rst
--rw-r--r--   0 james      (501) staff       (20)     1574 2022-08-08 20:45:08.000000 dask-2023.7.0/docs/source/bag-api.rst
--rw-r--r--   0 james      (501) staff       (20)     4557 2021-06-08 02:51:08.000000 dask-2023.7.0/docs/source/bag-creation.rst
--rw-r--r--   0 james      (501) staff       (20)     4068 2023-03-13 17:40:25.000000 dask-2023.7.0/docs/source/bag.rst
--rw-r--r--   0 james      (501) staff       (20)    14050 2023-05-22 17:52:26.000000 dask-2023.7.0/docs/source/best-practices.rst
--rw-r--r--   0 james      (501) staff       (20)     5553 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/caching.rst
--rw-r--r--   0 james      (501) staff       (20)   308830 2023-07-07 17:31:14.000000 dask-2023.7.0/docs/source/changelog.rst
--rw-r--r--   0 james      (501) staff       (20)      211 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/cheatsheet.rst
--rw-r--r--   0 james      (501) staff       (20)     4047 2023-03-13 17:40:25.000000 dask-2023.7.0/docs/source/cli.rst
--rw-r--r--   0 james      (501) staff       (20)    15465 2023-03-13 20:41:19.000000 dask-2023.7.0/docs/source/conf.py
--rw-r--r--   0 james      (501) staff       (20)    16654 2023-04-06 21:35:01.000000 dask-2023.7.0/docs/source/configuration.rst
--rw-r--r--   0 james      (501) staff       (20)    18651 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/custom-collections.rst
--rw-r--r--   0 james      (501) staff       (20)     3604 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/custom-graphs.rst
--rw-r--r--   0 james      (501) staff       (20)      932 2023-05-31 15:34:32.000000 dask-2023.7.0/docs/source/dashboard-progress-script.py
--rw-r--r--   0 james      (501) staff       (20)    15045 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/dashboard.rst
--rw-r--r--   0 james      (501) staff       (20)   203552 2021-06-08 02:51:08.000000 dask-2023.7.0/docs/source/daskcheatsheet.pdf
--rw-r--r--   0 james      (501) staff       (20)    13611 2023-06-26 19:01:25.000000 dask-2023.7.0/docs/source/dataframe-api.rst
--rw-r--r--   0 james      (501) staff       (20)     9611 2023-03-13 17:40:25.000000 dask-2023.7.0/docs/source/dataframe-best-practices.rst
--rw-r--r--   0 james      (501) staff       (20)     3951 2021-11-11 20:27:17.000000 dask-2023.7.0/docs/source/dataframe-categoricals.rst
--rw-r--r--   0 james      (501) staff       (20)     5967 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/dataframe-create.rst
--rw-r--r--   0 james      (501) staff       (20)     5002 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/dataframe-design.rst
--rw-r--r--   0 james      (501) staff       (20)     6224 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/dataframe-extend.rst
--rw-r--r--   0 james      (501) staff       (20)     8050 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/dataframe-groupby.rst
--rw-r--r--   0 james      (501) staff       (20)     6115 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/dataframe-indexing.rst
--rw-r--r--   0 james      (501) staff       (20)     3454 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/dataframe-joins.rst
--rw-r--r--   0 james      (501) staff       (20)    10952 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/dataframe-parquet.rst
--rw-r--r--   0 james      (501) staff       (20)    12661 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/dataframe-sql.rst
--rw-r--r--   0 james      (501) staff       (20)     7772 2023-03-13 17:40:25.000000 dask-2023.7.0/docs/source/dataframe.rst
--rw-r--r--   0 james      (501) staff       (20)      363 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/debugging-performance.rst
--rw-r--r--   0 james      (501) staff       (20)     1696 2022-08-08 20:45:08.000000 dask-2023.7.0/docs/source/delayed-api.rst
--rw-r--r--   0 james      (501) staff       (20)    17616 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/delayed-best-practices.rst
--rw-r--r--   0 james      (501) staff       (20)     1497 2022-10-07 21:37:36.000000 dask-2023.7.0/docs/source/delayed-collections.rst
--rw-r--r--   0 james      (501) staff       (20)     6357 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/delayed.rst
--rw-r--r--   0 james      (501) staff       (20)     3620 2023-03-13 17:40:25.000000 dask-2023.7.0/docs/source/deploying-cli.rst
--rw-r--r--   0 james      (501) staff       (20)     3012 2023-05-22 17:52:26.000000 dask-2023.7.0/docs/source/deploying-cloud.rst
--rw-r--r--   0 james      (501) staff       (20)     2868 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/deploying-docker.rst
--rw-r--r--   0 james      (501) staff       (20)     9939 2023-03-13 17:40:25.000000 dask-2023.7.0/docs/source/deploying-hpc.rst
--rw-r--r--   0 james      (501) staff       (20)     4001 2023-05-19 15:53:47.000000 dask-2023.7.0/docs/source/deploying-kubernetes.rst
--rw-r--r--   0 james      (501) staff       (20)     5823 2023-03-13 17:40:25.000000 dask-2023.7.0/docs/source/deploying-python-advanced.rst
--rw-r--r--   0 james      (501) staff       (20)     2839 2023-04-25 18:34:46.000000 dask-2023.7.0/docs/source/deploying-python.rst
--rw-r--r--   0 james      (501) staff       (20)     1619 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/deploying-ssh.rst
--rw-r--r--   0 james      (501) staff       (20)     7356 2023-06-12 20:31:35.000000 dask-2023.7.0/docs/source/deploying.rst
--rw-r--r--   0 james      (501) staff       (20)    10873 2023-05-22 17:52:26.000000 dask-2023.7.0/docs/source/deployment-considerations.rst
--rw-r--r--   0 james      (501) staff       (20)    13144 2023-05-31 15:34:32.000000 dask-2023.7.0/docs/source/develop.rst
--rw-r--r--   0 james      (501) staff       (20)     4442 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/diagnostics-distributed.rst
--rw-r--r--   0 james      (501) staff       (20)    10407 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/diagnostics-local.rst
--rw-r--r--   0 james      (501) staff       (20)     4364 2023-05-22 17:52:26.000000 dask-2023.7.0/docs/source/ecosystem.rst
--rw-r--r--   0 james      (501) staff       (20)    19999 2023-05-22 17:52:26.000000 dask-2023.7.0/docs/source/faq.rst
--rw-r--r--   0 james      (501) staff       (20)    25569 2023-05-19 15:53:47.000000 dask-2023.7.0/docs/source/futures.rst
--rw-r--r--   0 james      (501) staff       (20)     5820 2022-10-07 21:37:14.000000 dask-2023.7.0/docs/source/gpu.rst
--rw-r--r--   0 james      (501) staff       (20)     2541 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/graph_manipulation.rst
--rw-r--r--   0 james      (501) staff       (20)     5433 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/graphs.rst
--rw-r--r--   0 james      (501) staff       (20)     5399 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/graphviz.rst
--rw-r--r--   0 james      (501) staff       (20)     6946 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/high-level-graphs.rst
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.479019 dask-2023.7.0/docs/source/how-to/
--rw-r--r--   0 james      (501) staff       (20)     4364 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/how-to/adaptive.rst
--rw-r--r--   0 james      (501) staff       (20)    15360 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/how-to/connect-to-remote-data.rst
--rw-r--r--   0 james      (501) staff       (20)     4209 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/how-to/customize-initialization.rst
--rw-r--r--   0 james      (501) staff       (20)    10859 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/how-to/debug.rst
--rw-r--r--   0 james      (501) staff       (20)     1722 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/how-to/extend-sizeof.rst
--rw-r--r--   0 james      (501) staff       (20)      433 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/how-to/index.rst
--rw-r--r--   0 james      (501) staff       (20)     4562 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/how-to/manage-environments.rst
--rw-r--r--   0 james      (501) staff       (20)     6680 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/how-to/selecting-the-collection-backend.rst
--rw-r--r--   0 james      (501) staff       (20)      902 2023-04-25 18:34:46.000000 dask-2023.7.0/docs/source/how-to/setup-prometheus.rst
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.656797 dask-2023.7.0/docs/source/images/
--rw-r--r--   0 james      (501) staff       (20)    99565 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/images/10_minutes_array_graph.png
--rw-r--r--   0 james      (501) staff       (20)    22442 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/images/10_minutes_bag_graph.png
--rw-r--r--   0 james      (501) staff       (20)    56229 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/images/10_minutes_dataframe_graph.png
--rw-r--r--   0 james      (501) staff       (20)     4059 2021-06-08 02:51:08.000000 dask-2023.7.0/docs/source/images/HHMI_Janelia_Color.png
--rw-r--r--   0 james      (501) staff       (20)    18406 2021-06-08 02:50:31.000000 dask-2023.7.0/docs/source/images/array.svg
--rw-r--r--   0 james      (501) staff       (20)  1620104 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/images/async-embarrassing.gif
--rw-r--r--   0 james      (501) staff       (20)    10752 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/concurrent-futures-threaded.webp
--rw-r--r--   0 james      (501) staff       (20)   135129 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/crosstalk.svg
--rw-r--r--   0 james      (501) staff       (20)  2367087 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/dashboard_jupyterlab.png
--rw-r--r--   0 james      (501) staff       (20)    37971 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/dashboard_link.png
--rw-r--r--   0 james      (501) staff       (20)    68712 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/dashboard_memory.png
--rw-r--r--   0 james      (501) staff       (20)   281018 2023-04-25 18:34:46.000000 dask-2023.7.0/docs/source/images/dashboard_memory_new.gif
--rw-r--r--   0 james      (501) staff       (20)    25435 2023-03-13 17:40:25.000000 dask-2023.7.0/docs/source/images/dashboard_progress.png
--rw-r--r--   0 james      (501) staff       (20)   276928 2023-03-13 17:40:25.000000 dask-2023.7.0/docs/source/images/dashboard_status.png
--rw-r--r--   0 james      (501) staff       (20)    12009 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/images/dashboard_task_processing.png
--rw-r--r--   0 james      (501) staff       (20)    58238 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/dashboard_task_stream_unhealthy.png
--rw-r--r--   0 james      (501) staff       (20)   103654 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/dashboard_taskstream_healthy.png
--rw-r--r--   0 james      (501) staff       (20)   112822 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/images/dask-adaptive.svg
--rw-r--r--   0 james      (501) staff       (20)    14645 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/images/dask-array.svg
--rw-r--r--   0 james      (501) staff       (20)   222084 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/images/dask-cluster-manager.svg
--rw-r--r--   0 james      (501) staff       (20)    18782 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/images/dask-dataframe.svg
--rw-r--r--   0 james      (501) staff       (20)   381903 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/dask-overview-distributed-callout.svg
--rw-r--r--   0 james      (501) staff       (20)   357643 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/dask-overview-schedulers.svg
--rw-r--r--   0 james      (501) staff       (20)    97471 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/images/dask-overview.svg
--rw-r--r--   0 james      (501) staff       (20)     3022 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/dask_horizontal.svg
--rw-r--r--   0 james      (501) staff       (20)     3651 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/dask_horizontal_black.svg
--rw-r--r--   0 james      (501) staff       (20)     3767 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/dask_horizontal_on_blue.svg
--rw-r--r--   0 james      (501) staff       (20)     3738 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/dask_horizontal_on_pink.svg
--rw-r--r--   0 james      (501) staff       (20)     3738 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/dask_horizontal_white.svg
--rw-r--r--   0 james      (501) staff       (20)     1607 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/dask_icon.svg
--rw-r--r--   0 james      (501) staff       (20)     1571 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/dask_icon_black.svg
--rw-r--r--   0 james      (501) staff       (20)     1607 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/dask_icon_on_pink.svg
--rw-r--r--   0 james      (501) staff       (20)     1609 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/dask_icon_white.svg
--rw-r--r--   0 james      (501) staff       (20)    20216 2021-06-08 02:51:08.000000 dask-2023.7.0/docs/source/images/delayed-inc-double-add.svg
--rw-r--r--   0 james      (501) staff       (20)   104628 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/images/distributed-overview.svg
--rw-r--r--   0 james      (501) staff       (20)    18297 2021-06-08 02:50:31.000000 dask-2023.7.0/docs/source/images/frame-shuffle.svg
--rw-r--r--   0 james      (501) staff       (20)    22979 2021-06-08 02:50:31.000000 dask-2023.7.0/docs/source/images/frame-sort.svg
--rw-r--r--   0 james      (501) staff       (20)    12181 2021-06-08 02:50:31.000000 dask-2023.7.0/docs/source/images/frame.svg
--rw-r--r--   0 james      (501) staff       (20)    41828 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/images/gputester-msg.png
--rw-r--r--   0 james      (501) staff       (20)   210392 2021-11-11 17:33:01.000000 dask-2023.7.0/docs/source/images/growth_of_languages.png
--rw-r--r--   0 james      (501) staff       (20)   167834 2021-11-11 17:33:01.000000 dask-2023.7.0/docs/source/images/growth_of_libraries.png
--rw-r--r--   0 james      (501) staff       (20)     4097 2021-06-08 02:51:08.000000 dask-2023.7.0/docs/source/images/inc-add.svg
--rw-r--r--   0 james      (501) staff       (20)   123010 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/images/map-reduce-task-scheduling.svg
--rw-r--r--   0 james      (501) staff       (20)   482302 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/map_blocks_drop_axis.png
--rw-r--r--   0 james      (501) staff       (20)   113067 2021-11-11 20:27:17.000000 dask-2023.7.0/docs/source/images/merge_chunks.png
--rw-r--r--   0 james      (501) staff       (20)    63244 2021-11-11 20:27:17.000000 dask-2023.7.0/docs/source/images/merge_chunks_false.png
--rw-r--r--   0 james      (501) staff       (20)    13024 2021-11-11 17:33:01.000000 dask-2023.7.0/docs/source/images/optimize_dask1.svg
--rw-r--r--   0 james      (501) staff       (20)     8803 2021-11-11 17:33:01.000000 dask-2023.7.0/docs/source/images/optimize_dask2.svg
--rw-r--r--   0 james      (501) staff       (20)     5198 2021-11-11 17:33:01.000000 dask-2023.7.0/docs/source/images/optimize_dask3.svg
--rw-r--r--   0 james      (501) staff       (20)     4104 2021-11-11 17:33:01.000000 dask-2023.7.0/docs/source/images/optimize_dask4.svg
--rw-r--r--   0 james      (501) staff       (20)     2738 2021-11-11 17:33:01.000000 dask-2023.7.0/docs/source/images/optimize_dask5.svg
--rw-r--r--   0 james      (501) staff       (20)   292827 2021-11-11 20:27:17.000000 dask-2023.7.0/docs/source/images/order-failure.png
--rw-r--r--   0 james      (501) staff       (20)   239828 2021-11-11 20:27:17.000000 dask-2023.7.0/docs/source/images/order-success.png
--rw-r--r--   0 james      (501) staff       (20)    40833 2021-06-08 02:51:08.000000 dask-2023.7.0/docs/source/images/overlap.svg
--rw-r--r--   0 james      (501) staff       (20)    18785 2021-06-08 02:51:08.000000 dask-2023.7.0/docs/source/images/overlapping-blocks.svg
--rw-r--r--   0 james      (501) staff       (20)     4537 2021-06-08 02:51:08.000000 dask-2023.7.0/docs/source/images/overlapping-neighbors.svg
--rw-r--r--   0 james      (501) staff       (20)    20533 2021-06-08 02:51:08.000000 dask-2023.7.0/docs/source/images/pipeline.svg
--rw-r--r--   0 james      (501) staff       (20)    31576 2021-11-11 20:27:17.000000 dask-2023.7.0/docs/source/images/reshape.png
--rw-r--r--   0 james      (501) staff       (20)    31410 2021-11-11 20:27:17.000000 dask-2023.7.0/docs/source/images/reshape_problem.png
--rw-r--r--   0 james      (501) staff       (20)    33288 2021-11-11 20:27:17.000000 dask-2023.7.0/docs/source/images/reshape_rechunked.png
--rw-r--r--   0 james      (501) staff       (20)    50209 2021-06-08 02:50:31.000000 dask-2023.7.0/docs/source/images/scaling-edges.png
--rw-r--r--   0 james      (501) staff       (20)    68476 2021-06-08 02:50:31.000000 dask-2023.7.0/docs/source/images/scaling-nodes.png
--rw-r--r--   0 james      (501) staff       (20)    21294 2021-06-08 02:50:31.000000 dask-2023.7.0/docs/source/images/simple-dask.png
--rw-r--r--   0 james      (501) staff       (20)    27572 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/images/transpose-hlg-hovertooltip.png
--rw-r--r--   0 james      (501) staff       (20)    84492 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/images/transpose-hlg-html-repr.png
--rw-r--r--   0 james      (501) staff       (20)    39365 2021-06-08 02:51:08.000000 dask-2023.7.0/docs/source/images/transpose.svg
--rw-r--r--   0 james      (501) staff       (20)    22446 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/transpose_opt.svg
--rw-r--r--   0 james      (501) staff       (20)   115022 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/images/trivial.svg
--rw-r--r--   0 james      (501) staff       (20)     2451 2021-06-08 02:51:08.000000 dask-2023.7.0/docs/source/images/unoverlapping-neighbors.svg
--rw-r--r--   0 james      (501) staff       (20)     6237 2023-03-13 17:40:25.000000 dask-2023.7.0/docs/source/index.rst
--rw-r--r--   0 james      (501) staff       (20)    15235 2023-05-31 15:34:32.000000 dask-2023.7.0/docs/source/install.rst
--rw-r--r--   0 james      (501) staff       (20)      341 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/internals.rst
--rw-r--r--   0 james      (501) staff       (20)      868 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/logos.rst
--rw-r--r--   0 james      (501) staff       (20)     3573 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/maintainers.rst
--rw-r--r--   0 james      (501) staff       (20)    12200 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/optimize.rst
--rw-r--r--   0 james      (501) staff       (20)     7119 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/order.rst
--rw-r--r--   0 james      (501) staff       (20)     4810 2022-10-07 21:37:14.000000 dask-2023.7.0/docs/source/phases-of-computation.rst
--rw-r--r--   0 james      (501) staff       (20)     5089 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/presentations.rst
--rw-r--r--   0 james      (501) staff       (20)     6010 2022-10-07 21:37:14.000000 dask-2023.7.0/docs/source/scheduler-overview.rst
--rw-r--r--   0 james      (501) staff       (20)     4493 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/scheduling-policy.rst
--rw-r--r--   0 james      (501) staff       (20)    11015 2023-05-31 15:34:32.000000 dask-2023.7.0/docs/source/scheduling.rst
-drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-07 17:35:33.658485 dask-2023.7.0/docs/source/scripts/
--rw-r--r--   0 james      (501) staff       (20)     3294 2023-05-31 15:34:32.000000 dask-2023.7.0/docs/source/scripts/scheduling.py
--rw-r--r--   0 james      (501) staff       (20)     6104 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/shared.rst
--rw-r--r--   0 james      (501) staff       (20)     9342 2022-11-09 22:20:24.000000 dask-2023.7.0/docs/source/spark.rst
--rw-r--r--   0 james      (501) staff       (20)     3966 2022-10-07 21:37:14.000000 dask-2023.7.0/docs/source/spec.rst
--rw-r--r--   0 james      (501) staff       (20)     4754 2023-05-22 17:52:26.000000 dask-2023.7.0/docs/source/support.rst
--rw-r--r--   0 james      (501) staff       (20)     1831 2021-06-16 20:41:28.000000 dask-2023.7.0/docs/source/understanding-performance.rst
--rw-r--r--   0 james      (501) staff       (20)    12205 2023-05-03 18:02:08.000000 dask-2023.7.0/docs/source/user-interfaces.rst
--rw-r--r--   0 james      (501) staff       (20)    11744 2022-10-24 20:44:15.000000 dask-2023.7.0/docs/source/why.rst
--rw-r--r--   0 james      (501) staff       (20)     5526 2023-07-07 17:19:41.000000 dask-2023.7.0/pyproject.toml
--rw-r--r--   0 james      (501) staff       (20)       38 2023-07-07 17:35:33.661229 dask-2023.7.0/setup.cfg
--rwxr-xr-x   0 james      (501) staff       (20)      194 2023-05-03 18:02:08.000000 dask-2023.7.0/setup.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:45.218559 dask-2023.7.1/
+-rw-r--r--   0 james      (501) staff       (20)     1531 2022-10-24 20:44:15.000000 dask-2023.7.1/LICENSE.txt
+-rw-r--r--   0 james      (501) staff       (20)      325 2022-11-09 22:20:24.000000 dask-2023.7.1/MANIFEST.in
+-rw-r--r--   0 james      (501) staff       (20)     2532 2023-07-20 21:06:45.217983 dask-2023.7.1/PKG-INFO
+-rw-r--r--   0 james      (501) staff       (20)     1291 2022-11-09 22:20:24.000000 dask-2023.7.1/README.rst
+-rw-r--r--   0 james      (501) staff       (20)     2505 2023-07-20 20:35:59.000000 dask-2023.7.1/conftest.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:45.219183 dask-2023.7.1/dask/
+-rw-r--r--   0 james      (501) staff       (20)      485 2023-06-26 19:01:25.000000 dask-2023.7.1/dask/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)      133 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/__main__.py
+-rw-r--r--   0 james      (501) staff       (20)      643 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/_compatibility.py
+-rw-r--r--   0 james      (501) staff       (20)      500 2023-07-20 21:06:45.219343 dask-2023.7.1/dask/_version.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.686655 dask-2023.7.1/dask/array/
+-rw-r--r--   0 james      (501) staff       (20)     1543 2021-06-08 02:50:30.000000 dask-2023.7.1/dask/array/NUMPY_LICENSE.txt
+-rw-r--r--   0 james      (501) staff       (20)     5413 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    12600 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/backends.py
+-rw-r--r--   0 james      (501) staff       (20)     9983 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/blockwise.py
+-rw-r--r--   0 james      (501) staff       (20)    12304 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/chunk.py
+-rw-r--r--   0 james      (501) staff       (20)     5066 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/chunk_types.py
+-rw-r--r--   0 james      (501) staff       (20)   190831 2023-06-26 19:07:05.000000 dask-2023.7.1/dask/array/core.py
+-rw-r--r--   0 james      (501) staff       (20)    40564 2023-05-03 18:02:08.000000 dask-2023.7.1/dask/array/creation.py
+-rw-r--r--   0 james      (501) staff       (20)     2114 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/cupy_entry_point.py
+-rw-r--r--   0 james      (501) staff       (20)      526 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/dispatch.py
+-rw-r--r--   0 james      (501) staff       (20)     9146 2023-06-26 19:01:25.000000 dask-2023.7.1/dask/array/einsumfuncs.py
+-rw-r--r--   0 james      (501) staff       (20)     7252 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/fft.py
+-rw-r--r--   0 james      (501) staff       (20)    32656 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/gufunc.py
+-rw-r--r--   0 james      (501) staff       (20)     1996 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/image.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.691353 dask-2023.7.1/dask/array/lib/
+-rw-r--r--   0 james      (501) staff       (20)       77 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/lib/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)      101 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/lib/stride_tricks.py
+-rw-r--r--   0 james      (501) staff       (20)    53335 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/linalg.py
+-rw-r--r--   0 james      (501) staff       (20)     6363 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/ma.py
+-rw-r--r--   0 james      (501) staff       (20)     5699 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/numpy_compat.py
+-rw-r--r--   0 james      (501) staff       (20)    12838 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/optimization.py
+-rw-r--r--   0 james      (501) staff       (20)    28480 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/overlap.py
+-rw-r--r--   0 james      (501) staff       (20)    10652 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/percentile.py
+-rw-r--r--   0 james      (501) staff       (20)    40604 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/random.py
+-rw-r--r--   0 james      (501) staff       (20)    28324 2023-06-20 19:59:21.000000 dask-2023.7.1/dask/array/rechunk.py
+-rw-r--r--   0 james      (501) staff       (20)    57287 2023-06-01 20:02:33.000000 dask-2023.7.1/dask/array/reductions.py
+-rw-r--r--   0 james      (501) staff       (20)    10765 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/reshape.py
+-rw-r--r--   0 james      (501) staff       (20)    81977 2023-06-20 20:00:03.000000 dask-2023.7.1/dask/array/routines.py
+-rw-r--r--   0 james      (501) staff       (20)    72631 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/slicing.py
+-rw-r--r--   0 james      (501) staff       (20)    16184 2023-07-07 00:51:47.000000 dask-2023.7.1/dask/array/stats.py
+-rw-r--r--   0 james      (501) staff       (20)     8048 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/svg.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.730127 dask-2023.7.1/dask/array/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.7.1/dask/array/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)   161461 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_array_core.py
+-rw-r--r--   0 james      (501) staff       (20)     6689 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_array_function.py
+-rw-r--r--   0 james      (501) staff       (20)     3159 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_array_utils.py
+-rw-r--r--   0 james      (501) staff       (20)    23222 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_atop.py
+-rw-r--r--   0 james      (501) staff       (20)     3304 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_chunk.py
+-rw-r--r--   0 james      (501) staff       (20)    31150 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_creation.py
+-rw-r--r--   0 james      (501) staff       (20)    19888 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_cupy_core.py
+-rw-r--r--   0 james      (501) staff       (20)     6456 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_cupy_creation.py
+-rw-r--r--   0 james      (501) staff       (20)      594 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_cupy_gufunc.py
+-rw-r--r--   0 james      (501) staff       (20)    13412 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_cupy_linalg.py
+-rw-r--r--   0 james      (501) staff       (20)     4303 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_cupy_overlap.py
+-rw-r--r--   0 james      (501) staff       (20)     2862 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_cupy_percentile.py
+-rw-r--r--   0 james      (501) staff       (20)     9219 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_cupy_random.py
+-rw-r--r--   0 james      (501) staff       (20)     2224 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_cupy_reductions.py
+-rw-r--r--   0 james      (501) staff       (20)     7437 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_cupy_routines.py
+-rw-r--r--   0 james      (501) staff       (20)     4877 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_cupy_slicing.py
+-rw-r--r--   0 james      (501) staff       (20)     2982 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_cupy_sparse.py
+-rw-r--r--   0 james      (501) staff       (20)     8865 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_dispatch.py
+-rw-r--r--   0 james      (501) staff       (20)     8437 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_fft.py
+-rw-r--r--   0 james      (501) staff       (20)    21013 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_gufunc.py
+-rw-r--r--   0 james      (501) staff       (20)     1482 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_image.py
+-rw-r--r--   0 james      (501) staff       (20)    36448 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_linalg.py
+-rw-r--r--   0 james      (501) staff       (20)    15635 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_masked.py
+-rw-r--r--   0 james      (501) staff       (20)     1087 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_numpy_compat.py
+-rw-r--r--   0 james      (501) staff       (20)    17446 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_optimization.py
+-rw-r--r--   0 james      (501) staff       (20)    26718 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_overlap.py
+-rw-r--r--   0 james      (501) staff       (20)     3443 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_percentiles.py
+-rw-r--r--   0 james      (501) staff       (20)    15353 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_random.py
+-rw-r--r--   0 james      (501) staff       (20)    36262 2023-06-20 19:59:21.000000 dask-2023.7.1/dask/array/tests/test_rechunk.py
+-rw-r--r--   0 james      (501) staff       (20)    32756 2023-06-01 20:02:33.000000 dask-2023.7.1/dask/array/tests/test_reductions.py
+-rw-r--r--   0 james      (501) staff       (20)     7289 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_reshape.py
+-rw-r--r--   0 james      (501) staff       (20)    83849 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_routines.py
+-rw-r--r--   0 james      (501) staff       (20)    32302 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_slicing.py
+-rw-r--r--   0 james      (501) staff       (20)     6592 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_sparse.py
+-rw-r--r--   0 james      (501) staff       (20)     5489 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_stats.py
+-rw-r--r--   0 james      (501) staff       (20)     2740 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_svg.py
+-rw-r--r--   0 james      (501) staff       (20)      525 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_testing.py
+-rw-r--r--   0 james      (501) staff       (20)    17390 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_ufunc.py
+-rw-r--r--   0 james      (501) staff       (20)     2706 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_wrap.py
+-rw-r--r--   0 james      (501) staff       (20)     1317 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tests/test_xarray.py
+-rw-r--r--   0 james      (501) staff       (20)     4737 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/tiledb_io.py
+-rw-r--r--   0 james      (501) staff       (20)     9943 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/ufunc.py
+-rw-r--r--   0 james      (501) staff       (20)    18674 2023-06-26 19:11:47.000000 dask-2023.7.1/dask/array/utils.py
+-rw-r--r--   0 james      (501) staff       (20)     6906 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/array/wrap.py
+-rw-r--r--   0 james      (501) staff       (20)     4936 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/backends.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.734026 dask-2023.7.1/dask/bag/
+-rw-r--r--   0 james      (501) staff       (20)      903 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/bag/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     9111 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/bag/avro.py
+-rw-r--r--   0 james      (501) staff       (20)      763 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/bag/chunk.py
+-rw-r--r--   0 james      (501) staff       (20)    85425 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/bag/core.py
+-rw-r--r--   0 james      (501) staff       (20)     5464 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/bag/random.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.736400 dask-2023.7.1/dask/bag/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.7.1/dask/bag/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     3808 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/bag/tests/test_avro.py
+-rw-r--r--   0 james      (501) staff       (20)    51087 2023-06-20 19:59:21.000000 dask-2023.7.1/dask/bag/tests/test_bag.py
+-rw-r--r--   0 james      (501) staff       (20)     6528 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/bag/tests/test_random.py
+-rw-r--r--   0 james      (501) staff       (20)     5049 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/bag/tests/test_text.py
+-rw-r--r--   0 james      (501) staff       (20)     6765 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/bag/text.py
+-rw-r--r--   0 james      (501) staff       (20)      241 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/bag/utils.py
+-rw-r--r--   0 james      (501) staff       (20)    53616 2023-07-07 00:51:47.000000 dask-2023.7.1/dask/base.py
+-rw-r--r--   0 james      (501) staff       (20)    53252 2023-05-19 15:53:47.000000 dask-2023.7.1/dask/blockwise.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.738081 dask-2023.7.1/dask/bytes/
+-rw-r--r--   0 james      (501) staff       (20)       75 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/bytes/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     6933 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/bytes/core.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.741555 dask-2023.7.1/dask/bytes/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.7.1/dask/bytes/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     5158 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/bytes/tests/test_bytes_utils.py
+-rw-r--r--   0 james      (501) staff       (20)      530 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/bytes/tests/test_compression.py
+-rw-r--r--   0 james      (501) staff       (20)     6563 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/bytes/tests/test_http.py
+-rw-r--r--   0 james      (501) staff       (20)    11476 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/bytes/tests/test_local.py
+-rw-r--r--   0 james      (501) staff       (20)    19385 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/bytes/tests/test_s3.py
+-rw-r--r--   0 james      (501) staff       (20)      500 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/bytes/utils.py
+-rw-r--r--   0 james      (501) staff       (20)     2001 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/cache.py
+-rw-r--r--   0 james      (501) staff       (20)     4067 2022-10-24 20:44:15.000000 dask-2023.7.1/dask/callbacks.py
+-rw-r--r--   0 james      (501) staff       (20)     3272 2023-07-07 00:51:47.000000 dask-2023.7.1/dask/cli.py
+-rw-r--r--   0 james      (501) staff       (20)      523 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/compatibility.py
+-rw-r--r--   0 james      (501) staff       (20)    21703 2023-06-20 19:59:21.000000 dask-2023.7.1/dask/config.py
+-rw-r--r--   0 james      (501) staff       (20)     1756 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/context.py
+-rw-r--r--   0 james      (501) staff       (20)    14833 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/core.py
+-rw-r--r--   0 james      (501) staff       (20)     8060 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/dask-schema.yaml
+-rw-r--r--   0 james      (501) staff       (20)     2122 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/dask.yaml
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.756948 dask-2023.7.1/dask/dataframe/
+-rw-r--r--   0 james      (501) staff       (20)     1812 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     7496 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/_compat.py
+-rw-r--r--   0 james      (501) staff       (20)     2171 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/_dtypes.py
+-rw-r--r--   0 james      (501) staff       (20)     3959 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/dataframe/_pyarrow.py
+-rw-r--r--   0 james      (501) staff       (20)     1936 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/_pyarrow_compat.py
+-rw-r--r--   0 james      (501) staff       (20)    12101 2023-05-03 18:02:08.000000 dask-2023.7.1/dask/dataframe/accessor.py
+-rw-r--r--   0 james      (501) staff       (20)    24817 2023-06-26 19:01:25.000000 dask-2023.7.1/dask/dataframe/backends.py
+-rw-r--r--   0 james      (501) staff       (20)     9507 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/categorical.py
+-rw-r--r--   0 james      (501) staff       (20)   301737 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/dataframe/core.py
+-rw-r--r--   0 james      (501) staff       (20)     4609 2023-06-20 19:59:21.000000 dask-2023.7.1/dask/dataframe/dispatch.py
+-rw-r--r--   0 james      (501) staff       (20)      552 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/extensions.py
+-rw-r--r--   0 james      (501) staff       (20)   115448 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/dataframe/groupby.py
+-rw-r--r--   0 james      (501) staff       (20)     2463 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/hyperloglog.py
+-rw-r--r--   0 james      (501) staff       (20)    13412 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/indexing.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.762985 dask-2023.7.1/dask/dataframe/io/
+-rw-r--r--   0 james      (501) staff       (20)      706 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/io/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    33854 2023-06-26 19:01:25.000000 dask-2023.7.1/dask/dataframe/io/csv.py
+-rw-r--r--   0 james      (501) staff       (20)    17953 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/dataframe/io/demo.py
+-rw-r--r--   0 james      (501) staff       (20)    18275 2023-06-20 19:59:21.000000 dask-2023.7.1/dask/dataframe/io/hdf.py
+-rw-r--r--   0 james      (501) staff       (20)    38599 2023-07-07 00:51:47.000000 dask-2023.7.1/dask/dataframe/io/io.py
+-rw-r--r--   0 james      (501) staff       (20)    11163 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/io/json.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.764842 dask-2023.7.1/dask/dataframe/io/orc/
+-rw-r--r--   0 james      (501) staff       (20)       92 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/io/orc/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     4487 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/io/orc/arrow.py
+-rw-r--r--   0 james      (501) staff       (20)     7098 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/io/orc/core.py
+-rw-r--r--   0 james      (501) staff       (20)      510 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/io/orc/utils.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.768170 dask-2023.7.1/dask/dataframe/io/parquet/
+-rw-r--r--   0 james      (501) staff       (20)      166 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/io/parquet/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    71794 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/dataframe/io/parquet/arrow.py
+-rw-r--r--   0 james      (501) staff       (20)    67270 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/dataframe/io/parquet/core.py
+-rw-r--r--   0 james      (501) staff       (20)    52312 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/dataframe/io/parquet/fastparquet.py
+-rw-r--r--   0 james      (501) staff       (20)    32896 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/io/parquet/utils.py
+-rw-r--r--   0 james      (501) staff       (20)    21108 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/io/sql.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.774199 dask-2023.7.1/dask/dataframe/io/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2023-03-07 20:03:52.000000 dask-2023.7.1/dask/dataframe/io/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    59293 2023-06-26 19:01:25.000000 dask-2023.7.1/dask/dataframe/io/tests/test_csv.py
+-rw-r--r--   0 james      (501) staff       (20)    11113 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/dataframe/io/tests/test_demo.py
+-rw-r--r--   0 james      (501) staff       (20)    27232 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/io/tests/test_hdf.py
+-rw-r--r--   0 james      (501) staff       (20)    34779 2023-07-07 00:51:47.000000 dask-2023.7.1/dask/dataframe/io/tests/test_io.py
+-rw-r--r--   0 james      (501) staff       (20)     8625 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/io/tests/test_json.py
+-rw-r--r--   0 james      (501) staff       (20)     5238 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/io/tests/test_orc.py
+-rw-r--r--   0 james      (501) staff       (20)   166740 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/dataframe/io/tests/test_parquet.py
+-rw-r--r--   0 james      (501) staff       (20)    17632 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/io/tests/test_sql.py
+-rw-r--r--   0 james      (501) staff       (20)     8041 2023-06-20 19:59:21.000000 dask-2023.7.1/dask/dataframe/io/utils.py
+-rw-r--r--   0 james      (501) staff       (20)    14071 2023-06-26 19:01:25.000000 dask-2023.7.1/dask/dataframe/methods.py
+-rw-r--r--   0 james      (501) staff       (20)    54050 2023-07-20 20:35:55.000000 dask-2023.7.1/dask/dataframe/multi.py
+-rw-r--r--   0 james      (501) staff       (20)     1600 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/numeric.py
+-rw-r--r--   0 james      (501) staff       (20)     8778 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/optimize.py
+-rw-r--r--   0 james      (501) staff       (20)    20104 2023-07-07 00:51:47.000000 dask-2023.7.1/dask/dataframe/partitionquantiles.py
+-rw-r--r--   0 james      (501) staff       (20)    11825 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/reshape.py
+-rw-r--r--   0 james      (501) staff       (20)    22185 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/rolling.py
+-rw-r--r--   0 james      (501) staff       (20)    38106 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/dataframe/shuffle.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.791552 dask-2023.7.1/dask/dataframe/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.7.1/dask/dataframe/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    10633 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_accessors.py
+-rw-r--r--   0 james      (501) staff       (20)    67628 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_arithmetics_reduction.py
+-rw-r--r--   0 james      (501) staff       (20)      942 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_boolean.py
+-rw-r--r--   0 james      (501) staff       (20)    16678 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_categorical.py
+-rw-r--r--   0 james      (501) staff       (20)   194008 2023-07-20 20:35:55.000000 dask-2023.7.1/dask/dataframe/tests/test_dataframe.py
+-rw-r--r--   0 james      (501) staff       (20)     1456 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_extensions.py
+-rw-r--r--   0 james      (501) staff       (20)    14743 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_format.py
+-rw-r--r--   0 james      (501) staff       (20)   121782 2023-07-20 20:35:55.000000 dask-2023.7.1/dask/dataframe/tests/test_groupby.py
+-rw-r--r--   0 james      (501) staff       (20)     2702 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_hashing.py
+-rw-r--r--   0 james      (501) staff       (20)     2897 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_hyperloglog.py
+-rw-r--r--   0 james      (501) staff       (20)    22382 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_indexing.py
+-rw-r--r--   0 james      (501) staff       (20)     7034 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_merge_column_and_index.py
+-rw-r--r--   0 james      (501) staff       (20)      463 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_methods.py
+-rw-r--r--   0 james      (501) staff       (20)    91084 2023-07-20 20:35:55.000000 dask-2023.7.1/dask/dataframe/tests/test_multi.py
+-rw-r--r--   0 james      (501) staff       (20)     2120 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_numeric.py
+-rw-r--r--   0 james      (501) staff       (20)     1067 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_optimize_dataframe.py
+-rw-r--r--   0 james      (501) staff       (20)     6662 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_pyarrow.py
+-rw-r--r--   0 james      (501) staff       (20)     4550 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_pyarrow_compat.py
+-rw-r--r--   0 james      (501) staff       (20)    11571 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_reshape.py
+-rw-r--r--   0 james      (501) staff       (20)    17510 2023-07-20 20:35:55.000000 dask-2023.7.1/dask/dataframe/tests/test_rolling.py
+-rw-r--r--   0 james      (501) staff       (20)    54512 2023-06-26 19:01:25.000000 dask-2023.7.1/dask/dataframe/tests/test_shuffle.py
+-rw-r--r--   0 james      (501) staff       (20)    16595 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tests/test_ufunc.py
+-rw-r--r--   0 james      (501) staff       (20)    22156 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/dataframe/tests/test_utils_dataframe.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.792815 dask-2023.7.1/dask/dataframe/tseries/
+-rw-r--r--   0 james      (501) staff       (20)        0 2021-06-08 02:50:30.000000 dask-2023.7.1/dask/dataframe/tseries/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     7664 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tseries/resample.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.793993 dask-2023.7.1/dask/dataframe/tseries/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.7.1/dask/dataframe/tseries/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)     6866 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/dataframe/tseries/tests/test_resample.py
+-rw-r--r--   0 james      (501) staff       (20)    27606 2023-07-20 20:35:59.000000 dask-2023.7.1/dask/dataframe/utils.py
+-rw-r--r--   0 james      (501) staff       (20)     5314 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/datasets.py
+-rw-r--r--   0 james      (501) staff       (20)    24389 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/delayed.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.796567 dask-2023.7.1/dask/diagnostics/
+-rw-r--r--   0 james      (501) staff       (20)      258 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/diagnostics/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    12136 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/diagnostics/profile.py
+-rw-r--r--   0 james      (501) staff       (20)    16332 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/diagnostics/profile_visualize.py
+-rw-r--r--   0 james      (501) staff       (20)     5001 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/diagnostics/progress.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.798034 dask-2023.7.1/dask/diagnostics/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-02-04 20:18:56.000000 dask-2023.7.1/dask/diagnostics/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)    12045 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/diagnostics/tests/test_profiler.py
+-rw-r--r--   0 james      (501) staff       (20)     3388 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/diagnostics/tests/test_progress.py
+-rw-r--r--   0 james      (501) staff       (20)      715 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/distributed.py
+-rw-r--r--   0 james      (501) staff       (20)    16587 2022-11-09 22:20:24.000000 dask-2023.7.1/dask/dot.py
+-rw-r--r--   0 james      (501) staff       (20)    19595 2022-11-09 22:20:24.000000 dask-2023.7.1/dask/graph_manipulation.py
+-rw-r--r--   0 james      (501) staff       (20)     2492 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/hashing.py
+-rw-r--r--   0 james      (501) staff       (20)    34778 2023-06-26 19:01:25.000000 dask-2023.7.1/dask/highlevelgraph.py
+-rw-r--r--   0 james      (501) staff       (20)    46007 2023-05-03 18:02:08.000000 dask-2023.7.1/dask/layers.py
+-rw-r--r--   0 james      (501) staff       (20)    18888 2022-11-09 22:20:24.000000 dask-2023.7.1/dask/local.py
+-rw-r--r--   0 james      (501) staff       (20)      487 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/ml.py
+-rw-r--r--   0 james      (501) staff       (20)     8466 2022-11-09 22:20:24.000000 dask-2023.7.1/dask/multiprocessing.py
+-rw-r--r--   0 james      (501) staff       (20)    35638 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/optimization.py
+-rw-r--r--   0 james      (501) staff       (20)    45768 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/order.py
+-rw-r--r--   0 james      (501) staff       (20)        0 2022-11-09 22:20:24.000000 dask-2023.7.1/dask/py.typed
+-rw-r--r--   0 james      (501) staff       (20)    12597 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/rewrite.py
+-rw-r--r--   0 james      (501) staff       (20)     7298 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/sizeof.py
+-rw-r--r--   0 james      (501) staff       (20)     1510 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/system.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.820755 dask-2023.7.1/dask/tests/
+-rw-r--r--   0 james      (501) staff       (20)        0 2023-03-07 20:04:31.000000 dask-2023.7.1/dask/tests/__init__.py
+-rw-r--r--   0 james      (501) staff       (20)      742 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_backends.py
+-rw-r--r--   0 james      (501) staff       (20)    51124 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_base.py
+-rw-r--r--   0 james      (501) staff       (20)     1613 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_cache.py
+-rw-r--r--   0 james      (501) staff       (20)     2570 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_callbacks.py
+-rw-r--r--   0 james      (501) staff       (20)     1199 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_ci.py
+-rw-r--r--   0 james      (501) staff       (20)     3550 2023-07-07 00:51:47.000000 dask-2023.7.1/dask/tests/test_cli.py
+-rw-r--r--   0 james      (501) staff       (20)      379 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_compatibility.py
+-rw-r--r--   0 james      (501) staff       (20)    17846 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_config.py
+-rw-r--r--   0 james      (501) staff       (20)     1137 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_context.py
+-rw-r--r--   0 james      (501) staff       (20)     7422 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_core.py
+-rw-r--r--   0 james      (501) staff       (20)     1112 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_datasets.py
+-rw-r--r--   0 james      (501) staff       (20)    22989 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_delayed.py
+-rw-r--r--   0 james      (501) staff       (20)    35741 2023-06-20 20:00:03.000000 dask-2023.7.1/dask/tests/test_distributed.py
+-rw-r--r--   0 james      (501) staff       (20)      925 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_docs.py
+-rw-r--r--   0 james      (501) staff       (20)    12271 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_dot.py
+-rw-r--r--   0 james      (501) staff       (20)    15070 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_graph_manipulation.py
+-rw-r--r--   0 james      (501) staff       (20)     1095 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_hashing.py
+-rw-r--r--   0 james      (501) staff       (20)     8860 2023-06-26 19:01:25.000000 dask-2023.7.1/dask/tests/test_highgraph.py
+-rw-r--r--   0 james      (501) staff       (20)     9341 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_layers.py
+-rw-r--r--   0 james      (501) staff       (20)     5008 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_local.py
+-rw-r--r--   0 james      (501) staff       (20)      419 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_ml.py
+-rw-r--r--   0 james      (501) staff       (20)     8457 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_multiprocessing.py
+-rw-r--r--   0 james      (501) staff       (20)    45227 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_optimization.py
+-rw-r--r--   0 james      (501) staff       (20)    28229 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_order.py
+-rw-r--r--   0 james      (501) staff       (20)     4684 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_rewrite.py
+-rw-r--r--   0 james      (501) staff       (20)     7518 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_sizeof.py
+-rw-r--r--   0 james      (501) staff       (20)     7154 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_spark_compat.py
+-rw-r--r--   0 james      (501) staff       (20)     1397 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_system.py
+-rw-r--r--   0 james      (501) staff       (20)     4749 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_threaded.py
+-rw-r--r--   0 james      (501) staff       (20)     5670 2023-04-25 18:34:46.000000 dask-2023.7.1/dask/tests/test_typing.py
+-rw-r--r--   0 james      (501) staff       (20)    23923 2023-07-20 20:35:55.000000 dask-2023.7.1/dask/tests/test_utils.py
+-rw-r--r--   0 james      (501) staff       (20)     1598 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/test_utils_test.py
+-rw-r--r--   0 james      (501) staff       (20)      211 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/tests/warning_aliases.py
+-rw-r--r--   0 james      (501) staff       (20)     2993 2022-11-09 22:20:24.000000 dask-2023.7.1/dask/threaded.py
+-rw-r--r--   0 james      (501) staff       (20)    14538 2022-11-09 22:20:24.000000 dask-2023.7.1/dask/typing.py
+-rw-r--r--   0 james      (501) staff       (20)    58037 2023-07-20 20:35:55.000000 dask-2023.7.1/dask/utils.py
+-rw-r--r--   0 james      (501) staff       (20)     4825 2023-04-11 17:13:14.000000 dask-2023.7.1/dask/utils_test.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.822059 dask-2023.7.1/dask/widgets/
+-rw-r--r--   0 james      (501) staff       (20)      792 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/widgets/__init__.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.827928 dask-2023.7.1/dask/widgets/templates/
+-rw-r--r--   0 james      (501) staff       (20)     1295 2023-03-13 17:40:25.000000 dask-2023.7.1/dask/widgets/templates/array.html.j2
+-rw-r--r--   0 james      (501) staff       (20)      124 2022-11-09 22:20:24.000000 dask-2023.7.1/dask/widgets/templates/dataframe.html.j2
+-rw-r--r--   0 james      (501) staff       (20)     2579 2022-11-09 22:20:24.000000 dask-2023.7.1/dask/widgets/templates/highlevelgraph.html.j2
+-rw-r--r--   0 james      (501) staff       (20)     1981 2022-11-09 22:20:24.000000 dask-2023.7.1/dask/widgets/templates/highlevelgraph_layer.html.j2
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.828943 dask-2023.7.1/dask/widgets/tests/
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.831739 dask-2023.7.1/dask/widgets/tests/templates/
+-rw-r--r--   0 james      (501) staff       (20)       38 2022-10-24 20:44:15.000000 dask-2023.7.1/dask/widgets/tests/templates/bytes.html.j2
+-rw-r--r--   0 james      (501) staff       (20)       39 2022-10-24 20:44:15.000000 dask-2023.7.1/dask/widgets/tests/templates/custom_filter.html.j2
+-rw-r--r--   0 james      (501) staff       (20)       30 2022-10-24 20:44:15.000000 dask-2023.7.1/dask/widgets/tests/templates/example.html.j2
+-rw-r--r--   0 james      (501) staff       (20)     1401 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/widgets/tests/test_widgets.py
+-rw-r--r--   0 james      (501) staff       (20)     1120 2023-05-31 15:34:32.000000 dask-2023.7.1/dask/widgets/widgets.py
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.645095 dask-2023.7.1/dask.egg-info/
+-rw-r--r--   0 james      (501) staff       (20)     2532 2023-07-20 21:06:44.000000 dask-2023.7.1/dask.egg-info/PKG-INFO
+-rw-r--r--   0 james      (501) staff       (20)    13939 2023-07-20 21:06:44.000000 dask-2023.7.1/dask.egg-info/SOURCES.txt
+-rw-r--r--   0 james      (501) staff       (20)        1 2023-07-20 21:06:44.000000 dask-2023.7.1/dask.egg-info/dependency_links.txt
+-rw-r--r--   0 james      (501) staff       (20)      124 2023-07-20 21:06:44.000000 dask-2023.7.1/dask.egg-info/entry_points.txt
+-rw-r--r--   0 james      (501) staff       (20)        1 2023-07-20 21:06:43.000000 dask-2023.7.1/dask.egg-info/not-zip-safe
+-rw-r--r--   0 james      (501) staff       (20)      454 2023-07-20 21:06:44.000000 dask-2023.7.1/dask.egg-info/requires.txt
+-rw-r--r--   0 james      (501) staff       (20)        5 2023-07-20 21:06:44.000000 dask-2023.7.1/dask.egg-info/top_level.txt
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.833984 dask-2023.7.1/docs/
+-rw-r--r--   0 james      (501) staff       (20)     5741 2023-03-22 19:03:53.000000 dask-2023.7.1/docs/Makefile
+-rw-r--r--   0 james      (501) staff       (20)     5186 2022-08-08 20:45:08.000000 dask-2023.7.1/docs/make.bat
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.945646 dask-2023.7.1/docs/source/
+-rw-r--r--   0 james      (501) staff       (20)    17598 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/10-minutes-to-dask.rst
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.959982 dask-2023.7.1/docs/source/_static/
+-rw-r--r--   0 james      (501) staff       (20)    10187 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/_static/config_converter.js
+-rw-r--r--   0 james      (501) staff       (20)    11021 2021-06-08 02:50:31.000000 dask-2023.7.1/docs/source/_static/dask-simple.png
+-rw-r--r--   0 james      (501) staff       (20)     2375 2021-06-08 02:51:08.000000 dask-2023.7.1/docs/source/_static/main-page.css
+-rw-r--r--   0 james      (501) staff       (20)    15598 2022-08-08 20:45:08.000000 dask-2023.7.1/docs/source/_static/profile.html
+-rw-r--r--   0 james      (501) staff       (20)    65304 2022-08-08 20:45:08.000000 dask-2023.7.1/docs/source/_static/stacked_profile.html
+-rw-r--r--   0 james      (501) staff       (20)      523 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/_static/style.css
+-rw-r--r--   0 james      (501) staff       (20)      365 2021-06-16 20:41:28.000000 dask-2023.7.1/docs/source/_static/theme_overrides.css
+-rw-r--r--   0 james      (501) staff       (20)   292662 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/_static/transpose_cyto.html
+-rw-r--r--   0 james      (501) staff       (20)    49423 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/_static/yaml.min.js
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.963069 dask-2023.7.1/docs/source/_templates/
+-rw-r--r--   0 james      (501) staff       (20)      180 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/_templates/layout.html
+-rw-r--r--   0 james      (501) staff       (20)     3109 2023-07-20 20:35:59.000000 dask-2023.7.1/docs/source/api.rst
+-rw-r--r--   0 james      (501) staff       (20)     6968 2023-05-24 15:39:04.000000 dask-2023.7.1/docs/source/array-api.rst
+-rw-r--r--   0 james      (501) staff       (20)     2943 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/array-assignment.rst
+-rw-r--r--   0 james      (501) staff       (20)     4740 2023-03-13 17:40:25.000000 dask-2023.7.1/docs/source/array-best-practices.rst
+-rw-r--r--   0 james      (501) staff       (20)    13262 2023-07-07 00:51:47.000000 dask-2023.7.1/docs/source/array-chunks.rst
+-rw-r--r--   0 james      (501) staff       (20)    18437 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/array-creation.rst
+-rw-r--r--   0 james      (501) staff       (20)     5885 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/array-design.rst
+-rw-r--r--   0 james      (501) staff       (20)     2857 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/array-gufunc.rst
+-rw-r--r--   0 james      (501) staff       (20)     6069 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/array-overlap.rst
+-rw-r--r--   0 james      (501) staff       (20)     3924 2023-05-19 15:53:47.000000 dask-2023.7.1/docs/source/array-random.rst
+-rw-r--r--   0 james      (501) staff       (20)     4137 2021-11-11 17:33:01.000000 dask-2023.7.1/docs/source/array-slicing.rst
+-rw-r--r--   0 james      (501) staff       (20)     3291 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/array-sparse.rst
+-rw-r--r--   0 james      (501) staff       (20)     2018 2022-10-07 21:37:36.000000 dask-2023.7.1/docs/source/array-stack.rst
+-rw-r--r--   0 james      (501) staff       (20)     1140 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/array-stats.rst
+-rw-r--r--   0 james      (501) staff       (20)     4121 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/array.rst
+-rw-r--r--   0 james      (501) staff       (20)     1574 2022-08-08 20:45:08.000000 dask-2023.7.1/docs/source/bag-api.rst
+-rw-r--r--   0 james      (501) staff       (20)     4557 2021-06-08 02:51:08.000000 dask-2023.7.1/docs/source/bag-creation.rst
+-rw-r--r--   0 james      (501) staff       (20)     4068 2023-03-13 17:40:25.000000 dask-2023.7.1/docs/source/bag.rst
+-rw-r--r--   0 james      (501) staff       (20)    14050 2023-05-22 17:52:26.000000 dask-2023.7.1/docs/source/best-practices.rst
+-rw-r--r--   0 james      (501) staff       (20)     5553 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/caching.rst
+-rw-r--r--   0 james      (501) staff       (20)   310479 2023-07-20 21:00:24.000000 dask-2023.7.1/docs/source/changelog.rst
+-rw-r--r--   0 james      (501) staff       (20)      211 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/cheatsheet.rst
+-rw-r--r--   0 james      (501) staff       (20)     4047 2023-03-13 17:40:25.000000 dask-2023.7.1/docs/source/cli.rst
+-rw-r--r--   0 james      (501) staff       (20)    15465 2023-03-13 20:41:19.000000 dask-2023.7.1/docs/source/conf.py
+-rw-r--r--   0 james      (501) staff       (20)    16654 2023-04-06 21:35:01.000000 dask-2023.7.1/docs/source/configuration.rst
+-rw-r--r--   0 james      (501) staff       (20)    18651 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/custom-collections.rst
+-rw-r--r--   0 james      (501) staff       (20)     3604 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/custom-graphs.rst
+-rw-r--r--   0 james      (501) staff       (20)      932 2023-05-31 15:34:32.000000 dask-2023.7.1/docs/source/dashboard-progress-script.py
+-rw-r--r--   0 james      (501) staff       (20)    15045 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/dashboard.rst
+-rw-r--r--   0 james      (501) staff       (20)   203552 2021-06-08 02:51:08.000000 dask-2023.7.1/docs/source/daskcheatsheet.pdf
+-rw-r--r--   0 james      (501) staff       (20)    13611 2023-06-26 19:01:25.000000 dask-2023.7.1/docs/source/dataframe-api.rst
+-rw-r--r--   0 james      (501) staff       (20)     9611 2023-03-13 17:40:25.000000 dask-2023.7.1/docs/source/dataframe-best-practices.rst
+-rw-r--r--   0 james      (501) staff       (20)     3951 2021-11-11 20:27:17.000000 dask-2023.7.1/docs/source/dataframe-categoricals.rst
+-rw-r--r--   0 james      (501) staff       (20)     5967 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/dataframe-create.rst
+-rw-r--r--   0 james      (501) staff       (20)     5002 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/dataframe-design.rst
+-rw-r--r--   0 james      (501) staff       (20)     6224 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/dataframe-extend.rst
+-rw-r--r--   0 james      (501) staff       (20)     8050 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/dataframe-groupby.rst
+-rw-r--r--   0 james      (501) staff       (20)     6115 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/dataframe-indexing.rst
+-rw-r--r--   0 james      (501) staff       (20)     3454 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/dataframe-joins.rst
+-rw-r--r--   0 james      (501) staff       (20)    10952 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/dataframe-parquet.rst
+-rw-r--r--   0 james      (501) staff       (20)    12661 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/dataframe-sql.rst
+-rw-r--r--   0 james      (501) staff       (20)     7772 2023-03-13 17:40:25.000000 dask-2023.7.1/docs/source/dataframe.rst
+-rw-r--r--   0 james      (501) staff       (20)      363 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/debugging-performance.rst
+-rw-r--r--   0 james      (501) staff       (20)     1696 2022-08-08 20:45:08.000000 dask-2023.7.1/docs/source/delayed-api.rst
+-rw-r--r--   0 james      (501) staff       (20)    17616 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/delayed-best-practices.rst
+-rw-r--r--   0 james      (501) staff       (20)     1497 2022-10-07 21:37:36.000000 dask-2023.7.1/docs/source/delayed-collections.rst
+-rw-r--r--   0 james      (501) staff       (20)     6357 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/delayed.rst
+-rw-r--r--   0 james      (501) staff       (20)     3620 2023-03-13 17:40:25.000000 dask-2023.7.1/docs/source/deploying-cli.rst
+-rw-r--r--   0 james      (501) staff       (20)     3012 2023-05-22 17:52:26.000000 dask-2023.7.1/docs/source/deploying-cloud.rst
+-rw-r--r--   0 james      (501) staff       (20)     2868 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/deploying-docker.rst
+-rw-r--r--   0 james      (501) staff       (20)     9939 2023-03-13 17:40:25.000000 dask-2023.7.1/docs/source/deploying-hpc.rst
+-rw-r--r--   0 james      (501) staff       (20)     4001 2023-05-19 15:53:47.000000 dask-2023.7.1/docs/source/deploying-kubernetes.rst
+-rw-r--r--   0 james      (501) staff       (20)     5823 2023-03-13 17:40:25.000000 dask-2023.7.1/docs/source/deploying-python-advanced.rst
+-rw-r--r--   0 james      (501) staff       (20)     2839 2023-04-25 18:34:46.000000 dask-2023.7.1/docs/source/deploying-python.rst
+-rw-r--r--   0 james      (501) staff       (20)     1619 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/deploying-ssh.rst
+-rw-r--r--   0 james      (501) staff       (20)     7356 2023-06-12 20:31:35.000000 dask-2023.7.1/docs/source/deploying.rst
+-rw-r--r--   0 james      (501) staff       (20)    10873 2023-05-22 17:52:26.000000 dask-2023.7.1/docs/source/deployment-considerations.rst
+-rw-r--r--   0 james      (501) staff       (20)    13144 2023-05-31 15:34:32.000000 dask-2023.7.1/docs/source/develop.rst
+-rw-r--r--   0 james      (501) staff       (20)     4442 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/diagnostics-distributed.rst
+-rw-r--r--   0 james      (501) staff       (20)    10407 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/diagnostics-local.rst
+-rw-r--r--   0 james      (501) staff       (20)     4364 2023-05-22 17:52:26.000000 dask-2023.7.1/docs/source/ecosystem.rst
+-rw-r--r--   0 james      (501) staff       (20)    19999 2023-05-22 17:52:26.000000 dask-2023.7.1/docs/source/faq.rst
+-rw-r--r--   0 james      (501) staff       (20)    25569 2023-05-19 15:53:47.000000 dask-2023.7.1/docs/source/futures.rst
+-rw-r--r--   0 james      (501) staff       (20)     5820 2022-10-07 21:37:14.000000 dask-2023.7.1/docs/source/gpu.rst
+-rw-r--r--   0 james      (501) staff       (20)     2541 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/graph_manipulation.rst
+-rw-r--r--   0 james      (501) staff       (20)     5433 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/graphs.rst
+-rw-r--r--   0 james      (501) staff       (20)     5399 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/graphviz.rst
+-rw-r--r--   0 james      (501) staff       (20)     6946 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/high-level-graphs.rst
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:44.973411 dask-2023.7.1/docs/source/how-to/
+-rw-r--r--   0 james      (501) staff       (20)     4364 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/how-to/adaptive.rst
+-rw-r--r--   0 james      (501) staff       (20)    15360 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/how-to/connect-to-remote-data.rst
+-rw-r--r--   0 james      (501) staff       (20)     4209 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/how-to/customize-initialization.rst
+-rw-r--r--   0 james      (501) staff       (20)    10859 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/how-to/debug.rst
+-rw-r--r--   0 james      (501) staff       (20)     1722 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/how-to/extend-sizeof.rst
+-rw-r--r--   0 james      (501) staff       (20)      433 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/how-to/index.rst
+-rw-r--r--   0 james      (501) staff       (20)     4562 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/how-to/manage-environments.rst
+-rw-r--r--   0 james      (501) staff       (20)     6680 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/how-to/selecting-the-collection-backend.rst
+-rw-r--r--   0 james      (501) staff       (20)      902 2023-04-25 18:34:46.000000 dask-2023.7.1/docs/source/how-to/setup-prometheus.rst
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:45.216322 dask-2023.7.1/docs/source/images/
+-rw-r--r--   0 james      (501) staff       (20)    99565 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/images/10_minutes_array_graph.png
+-rw-r--r--   0 james      (501) staff       (20)    22442 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/images/10_minutes_bag_graph.png
+-rw-r--r--   0 james      (501) staff       (20)    56229 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/images/10_minutes_dataframe_graph.png
+-rw-r--r--   0 james      (501) staff       (20)     4059 2021-06-08 02:51:08.000000 dask-2023.7.1/docs/source/images/HHMI_Janelia_Color.png
+-rw-r--r--   0 james      (501) staff       (20)    18406 2021-06-08 02:50:31.000000 dask-2023.7.1/docs/source/images/array.svg
+-rw-r--r--   0 james      (501) staff       (20)  1620104 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/images/async-embarrassing.gif
+-rw-r--r--   0 james      (501) staff       (20)    10752 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/concurrent-futures-threaded.webp
+-rw-r--r--   0 james      (501) staff       (20)   135129 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/crosstalk.svg
+-rw-r--r--   0 james      (501) staff       (20)  2367087 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/dashboard_jupyterlab.png
+-rw-r--r--   0 james      (501) staff       (20)    37971 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/dashboard_link.png
+-rw-r--r--   0 james      (501) staff       (20)    68712 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/dashboard_memory.png
+-rw-r--r--   0 james      (501) staff       (20)   281018 2023-04-25 18:34:46.000000 dask-2023.7.1/docs/source/images/dashboard_memory_new.gif
+-rw-r--r--   0 james      (501) staff       (20)    25435 2023-03-13 17:40:25.000000 dask-2023.7.1/docs/source/images/dashboard_progress.png
+-rw-r--r--   0 james      (501) staff       (20)   276928 2023-03-13 17:40:25.000000 dask-2023.7.1/docs/source/images/dashboard_status.png
+-rw-r--r--   0 james      (501) staff       (20)    12009 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/images/dashboard_task_processing.png
+-rw-r--r--   0 james      (501) staff       (20)    58238 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/dashboard_task_stream_unhealthy.png
+-rw-r--r--   0 james      (501) staff       (20)   103654 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/dashboard_taskstream_healthy.png
+-rw-r--r--   0 james      (501) staff       (20)   112822 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/images/dask-adaptive.svg
+-rw-r--r--   0 james      (501) staff       (20)    14645 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/images/dask-array.svg
+-rw-r--r--   0 james      (501) staff       (20)   222084 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/images/dask-cluster-manager.svg
+-rw-r--r--   0 james      (501) staff       (20)    18782 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/images/dask-dataframe.svg
+-rw-r--r--   0 james      (501) staff       (20)   381903 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/dask-overview-distributed-callout.svg
+-rw-r--r--   0 james      (501) staff       (20)   357643 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/dask-overview-schedulers.svg
+-rw-r--r--   0 james      (501) staff       (20)    97471 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/images/dask-overview.svg
+-rw-r--r--   0 james      (501) staff       (20)     3022 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/dask_horizontal.svg
+-rw-r--r--   0 james      (501) staff       (20)     3651 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/dask_horizontal_black.svg
+-rw-r--r--   0 james      (501) staff       (20)     3767 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/dask_horizontal_on_blue.svg
+-rw-r--r--   0 james      (501) staff       (20)     3738 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/dask_horizontal_on_pink.svg
+-rw-r--r--   0 james      (501) staff       (20)     3738 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/dask_horizontal_white.svg
+-rw-r--r--   0 james      (501) staff       (20)     1607 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/dask_icon.svg
+-rw-r--r--   0 james      (501) staff       (20)     1571 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/dask_icon_black.svg
+-rw-r--r--   0 james      (501) staff       (20)     1607 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/dask_icon_on_pink.svg
+-rw-r--r--   0 james      (501) staff       (20)     1609 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/dask_icon_white.svg
+-rw-r--r--   0 james      (501) staff       (20)    20216 2021-06-08 02:51:08.000000 dask-2023.7.1/docs/source/images/delayed-inc-double-add.svg
+-rw-r--r--   0 james      (501) staff       (20)   104628 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/images/distributed-overview.svg
+-rw-r--r--   0 james      (501) staff       (20)    18297 2021-06-08 02:50:31.000000 dask-2023.7.1/docs/source/images/frame-shuffle.svg
+-rw-r--r--   0 james      (501) staff       (20)    22979 2021-06-08 02:50:31.000000 dask-2023.7.1/docs/source/images/frame-sort.svg
+-rw-r--r--   0 james      (501) staff       (20)    12181 2021-06-08 02:50:31.000000 dask-2023.7.1/docs/source/images/frame.svg
+-rw-r--r--   0 james      (501) staff       (20)    41828 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/images/gputester-msg.png
+-rw-r--r--   0 james      (501) staff       (20)   210392 2021-11-11 17:33:01.000000 dask-2023.7.1/docs/source/images/growth_of_languages.png
+-rw-r--r--   0 james      (501) staff       (20)   167834 2021-11-11 17:33:01.000000 dask-2023.7.1/docs/source/images/growth_of_libraries.png
+-rw-r--r--   0 james      (501) staff       (20)     4097 2021-06-08 02:51:08.000000 dask-2023.7.1/docs/source/images/inc-add.svg
+-rw-r--r--   0 james      (501) staff       (20)   123010 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/images/map-reduce-task-scheduling.svg
+-rw-r--r--   0 james      (501) staff       (20)   482302 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/map_blocks_drop_axis.png
+-rw-r--r--   0 james      (501) staff       (20)   113067 2021-11-11 20:27:17.000000 dask-2023.7.1/docs/source/images/merge_chunks.png
+-rw-r--r--   0 james      (501) staff       (20)    63244 2021-11-11 20:27:17.000000 dask-2023.7.1/docs/source/images/merge_chunks_false.png
+-rw-r--r--   0 james      (501) staff       (20)    13024 2021-11-11 17:33:01.000000 dask-2023.7.1/docs/source/images/optimize_dask1.svg
+-rw-r--r--   0 james      (501) staff       (20)     8803 2021-11-11 17:33:01.000000 dask-2023.7.1/docs/source/images/optimize_dask2.svg
+-rw-r--r--   0 james      (501) staff       (20)     5198 2021-11-11 17:33:01.000000 dask-2023.7.1/docs/source/images/optimize_dask3.svg
+-rw-r--r--   0 james      (501) staff       (20)     4104 2021-11-11 17:33:01.000000 dask-2023.7.1/docs/source/images/optimize_dask4.svg
+-rw-r--r--   0 james      (501) staff       (20)     2738 2021-11-11 17:33:01.000000 dask-2023.7.1/docs/source/images/optimize_dask5.svg
+-rw-r--r--   0 james      (501) staff       (20)   292827 2021-11-11 20:27:17.000000 dask-2023.7.1/docs/source/images/order-failure.png
+-rw-r--r--   0 james      (501) staff       (20)   239828 2021-11-11 20:27:17.000000 dask-2023.7.1/docs/source/images/order-success.png
+-rw-r--r--   0 james      (501) staff       (20)    40833 2021-06-08 02:51:08.000000 dask-2023.7.1/docs/source/images/overlap.svg
+-rw-r--r--   0 james      (501) staff       (20)    18785 2021-06-08 02:51:08.000000 dask-2023.7.1/docs/source/images/overlapping-blocks.svg
+-rw-r--r--   0 james      (501) staff       (20)     4537 2021-06-08 02:51:08.000000 dask-2023.7.1/docs/source/images/overlapping-neighbors.svg
+-rw-r--r--   0 james      (501) staff       (20)    20533 2021-06-08 02:51:08.000000 dask-2023.7.1/docs/source/images/pipeline.svg
+-rw-r--r--   0 james      (501) staff       (20)    31576 2021-11-11 20:27:17.000000 dask-2023.7.1/docs/source/images/reshape.png
+-rw-r--r--   0 james      (501) staff       (20)    31410 2021-11-11 20:27:17.000000 dask-2023.7.1/docs/source/images/reshape_problem.png
+-rw-r--r--   0 james      (501) staff       (20)    33288 2021-11-11 20:27:17.000000 dask-2023.7.1/docs/source/images/reshape_rechunked.png
+-rw-r--r--   0 james      (501) staff       (20)    50209 2021-06-08 02:50:31.000000 dask-2023.7.1/docs/source/images/scaling-edges.png
+-rw-r--r--   0 james      (501) staff       (20)    68476 2021-06-08 02:50:31.000000 dask-2023.7.1/docs/source/images/scaling-nodes.png
+-rw-r--r--   0 james      (501) staff       (20)    21294 2021-06-08 02:50:31.000000 dask-2023.7.1/docs/source/images/simple-dask.png
+-rw-r--r--   0 james      (501) staff       (20)    27572 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/images/transpose-hlg-hovertooltip.png
+-rw-r--r--   0 james      (501) staff       (20)    84492 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/images/transpose-hlg-html-repr.png
+-rw-r--r--   0 james      (501) staff       (20)    39365 2021-06-08 02:51:08.000000 dask-2023.7.1/docs/source/images/transpose.svg
+-rw-r--r--   0 james      (501) staff       (20)    22446 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/transpose_opt.svg
+-rw-r--r--   0 james      (501) staff       (20)   115022 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/images/trivial.svg
+-rw-r--r--   0 james      (501) staff       (20)     2451 2021-06-08 02:51:08.000000 dask-2023.7.1/docs/source/images/unoverlapping-neighbors.svg
+-rw-r--r--   0 james      (501) staff       (20)     6237 2023-03-13 17:40:25.000000 dask-2023.7.1/docs/source/index.rst
+-rw-r--r--   0 james      (501) staff       (20)    15235 2023-05-31 15:34:32.000000 dask-2023.7.1/docs/source/install.rst
+-rw-r--r--   0 james      (501) staff       (20)      341 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/internals.rst
+-rw-r--r--   0 james      (501) staff       (20)      868 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/logos.rst
+-rw-r--r--   0 james      (501) staff       (20)     3573 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/maintainers.rst
+-rw-r--r--   0 james      (501) staff       (20)    12200 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/optimize.rst
+-rw-r--r--   0 james      (501) staff       (20)     7119 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/order.rst
+-rw-r--r--   0 james      (501) staff       (20)     4810 2022-10-07 21:37:14.000000 dask-2023.7.1/docs/source/phases-of-computation.rst
+-rw-r--r--   0 james      (501) staff       (20)     5089 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/presentations.rst
+-rw-r--r--   0 james      (501) staff       (20)     6010 2022-10-07 21:37:14.000000 dask-2023.7.1/docs/source/scheduler-overview.rst
+-rw-r--r--   0 james      (501) staff       (20)     4493 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/scheduling-policy.rst
+-rw-r--r--   0 james      (501) staff       (20)    11015 2023-05-31 15:34:32.000000 dask-2023.7.1/docs/source/scheduling.rst
+drwxr-xr-x   0 james      (501) staff       (20)        0 2023-07-20 21:06:45.217250 dask-2023.7.1/docs/source/scripts/
+-rw-r--r--   0 james      (501) staff       (20)     3294 2023-05-31 15:34:32.000000 dask-2023.7.1/docs/source/scripts/scheduling.py
+-rw-r--r--   0 james      (501) staff       (20)     6104 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/shared.rst
+-rw-r--r--   0 james      (501) staff       (20)     9342 2022-11-09 22:20:24.000000 dask-2023.7.1/docs/source/spark.rst
+-rw-r--r--   0 james      (501) staff       (20)     3966 2022-10-07 21:37:14.000000 dask-2023.7.1/docs/source/spec.rst
+-rw-r--r--   0 james      (501) staff       (20)     4754 2023-05-22 17:52:26.000000 dask-2023.7.1/docs/source/support.rst
+-rw-r--r--   0 james      (501) staff       (20)     1831 2021-06-16 20:41:28.000000 dask-2023.7.1/docs/source/understanding-performance.rst
+-rw-r--r--   0 james      (501) staff       (20)    12205 2023-05-03 18:02:08.000000 dask-2023.7.1/docs/source/user-interfaces.rst
+-rw-r--r--   0 james      (501) staff       (20)    11744 2022-10-24 20:44:15.000000 dask-2023.7.1/docs/source/why.rst
+-rw-r--r--   0 james      (501) staff       (20)     5526 2023-07-20 20:46:10.000000 dask-2023.7.1/pyproject.toml
+-rw-r--r--   0 james      (501) staff       (20)       38 2023-07-20 21:06:45.218715 dask-2023.7.1/setup.cfg
+-rwxr-xr-x   0 james      (501) staff       (20)      194 2023-05-03 18:02:08.000000 dask-2023.7.1/setup.py
```

### Comparing `dask-2023.7.0/LICENSE.txt` & `dask-2023.7.1/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/PKG-INFO` & `dask-2023.7.1/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: dask
-Version: 2023.7.0
+Version: 2023.7.1
 Summary: Parallel PyData with Task Scheduling
 Maintainer-email: Matthew Rocklin <mrocklin@gmail.com>
 License: BSD
 Project-URL: Homepage, https://github.com/dask/dask/
 Keywords: task-scheduling parallel numpy pandas pydata
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
```

### Comparing `dask-2023.7.0/README.rst` & `dask-2023.7.1/README.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/conftest.py` & `dask-2023.7.1/conftest.py`

 * *Files 10% similar despite different names*

```diff
@@ -57,21 +57,28 @@
 
 
 def pytest_runtest_setup(item):
     if "slow" in item.keywords and not item.config.getoption("--runslow"):
         pytest.skip("need --runslow option to run")
 
 
+try:
+    from dask.dataframe.utils import pyarrow_strings_enabled
+
+    convert_string = pyarrow_strings_enabled()
+except (ImportError, RuntimeError):
+    convert_string = False
+
 skip_with_pyarrow_strings = pytest.mark.skipif(
-    bool(dask.config.get("dataframe.convert-string")),
+    convert_string,
     reason="No need to run with pyarrow strings",
 )
 
 xfail_with_pyarrow_strings = pytest.mark.xfail(
-    bool(dask.config.get("dataframe.convert-string")),
+    convert_string,
     reason="Known failure with pyarrow strings",
 )
 
 
 def pytest_collection_modifyitems(config, items):
     for item in items:
         if "skip_with_pyarrow_strings" in item.keywords:
```

### Comparing `dask-2023.7.0/dask/_compatibility.py` & `dask-2023.7.1/dask/_compatibility.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/NUMPY_LICENSE.txt` & `dask-2023.7.1/dask/array/NUMPY_LICENSE.txt`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/__init__.py` & `dask-2023.7.1/dask/array/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/backends.py` & `dask-2023.7.1/dask/array/backends.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/blockwise.py` & `dask-2023.7.1/dask/array/blockwise.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/chunk.py` & `dask-2023.7.1/dask/array/chunk.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/chunk_types.py` & `dask-2023.7.1/dask/array/chunk_types.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/core.py` & `dask-2023.7.1/dask/array/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/creation.py` & `dask-2023.7.1/dask/array/creation.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/cupy_entry_point.py` & `dask-2023.7.1/dask/array/cupy_entry_point.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/dispatch.py` & `dask-2023.7.1/dask/array/dispatch.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/einsumfuncs.py` & `dask-2023.7.1/dask/array/einsumfuncs.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/fft.py` & `dask-2023.7.1/dask/array/fft.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/gufunc.py` & `dask-2023.7.1/dask/array/gufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/image.py` & `dask-2023.7.1/dask/array/image.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/linalg.py` & `dask-2023.7.1/dask/array/linalg.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/ma.py` & `dask-2023.7.1/dask/array/ma.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/numpy_compat.py` & `dask-2023.7.1/dask/array/numpy_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/optimization.py` & `dask-2023.7.1/dask/array/optimization.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/overlap.py` & `dask-2023.7.1/dask/array/overlap.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/percentile.py` & `dask-2023.7.1/dask/array/percentile.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/random.py` & `dask-2023.7.1/dask/array/random.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/rechunk.py` & `dask-2023.7.1/dask/array/rechunk.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/reductions.py` & `dask-2023.7.1/dask/array/reductions.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/reshape.py` & `dask-2023.7.1/dask/array/reshape.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/routines.py` & `dask-2023.7.1/dask/array/routines.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/slicing.py` & `dask-2023.7.1/dask/array/slicing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/stats.py` & `dask-2023.7.1/dask/array/stats.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/svg.py` & `dask-2023.7.1/dask/array/svg.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_array_core.py` & `dask-2023.7.1/dask/array/tests/test_array_core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_array_function.py` & `dask-2023.7.1/dask/array/tests/test_array_function.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_array_utils.py` & `dask-2023.7.1/dask/array/tests/test_array_utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_atop.py` & `dask-2023.7.1/dask/array/tests/test_atop.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_chunk.py` & `dask-2023.7.1/dask/array/tests/test_chunk.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_creation.py` & `dask-2023.7.1/dask/array/tests/test_creation.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_cupy_core.py` & `dask-2023.7.1/dask/array/tests/test_cupy_core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_cupy_creation.py` & `dask-2023.7.1/dask/array/tests/test_cupy_creation.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_cupy_gufunc.py` & `dask-2023.7.1/dask/array/tests/test_cupy_gufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_cupy_linalg.py` & `dask-2023.7.1/dask/array/tests/test_cupy_linalg.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_cupy_overlap.py` & `dask-2023.7.1/dask/array/tests/test_cupy_overlap.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_cupy_percentile.py` & `dask-2023.7.1/dask/array/tests/test_cupy_percentile.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_cupy_random.py` & `dask-2023.7.1/dask/array/tests/test_cupy_random.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_cupy_reductions.py` & `dask-2023.7.1/dask/array/tests/test_cupy_reductions.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_cupy_routines.py` & `dask-2023.7.1/dask/array/tests/test_cupy_routines.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_cupy_slicing.py` & `dask-2023.7.1/dask/array/tests/test_cupy_slicing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_cupy_sparse.py` & `dask-2023.7.1/dask/array/tests/test_cupy_sparse.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_dispatch.py` & `dask-2023.7.1/dask/array/tests/test_dispatch.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_fft.py` & `dask-2023.7.1/dask/array/tests/test_fft.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_gufunc.py` & `dask-2023.7.1/dask/array/tests/test_gufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_image.py` & `dask-2023.7.1/dask/array/tests/test_image.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_linalg.py` & `dask-2023.7.1/dask/array/tests/test_linalg.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_masked.py` & `dask-2023.7.1/dask/array/tests/test_masked.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_numpy_compat.py` & `dask-2023.7.1/dask/array/tests/test_numpy_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_optimization.py` & `dask-2023.7.1/dask/array/tests/test_optimization.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_overlap.py` & `dask-2023.7.1/dask/array/tests/test_overlap.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_percentiles.py` & `dask-2023.7.1/dask/array/tests/test_percentiles.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_random.py` & `dask-2023.7.1/dask/array/tests/test_random.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_rechunk.py` & `dask-2023.7.1/dask/array/tests/test_rechunk.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_reductions.py` & `dask-2023.7.1/dask/array/tests/test_reductions.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_reshape.py` & `dask-2023.7.1/dask/array/tests/test_reshape.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_routines.py` & `dask-2023.7.1/dask/array/tests/test_routines.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_slicing.py` & `dask-2023.7.1/dask/array/tests/test_slicing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_sparse.py` & `dask-2023.7.1/dask/array/tests/test_sparse.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_stats.py` & `dask-2023.7.1/dask/array/tests/test_stats.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_svg.py` & `dask-2023.7.1/dask/array/tests/test_svg.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_testing.py` & `dask-2023.7.1/dask/array/tests/test_testing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_ufunc.py` & `dask-2023.7.1/dask/array/tests/test_ufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_wrap.py` & `dask-2023.7.1/dask/array/tests/test_wrap.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tests/test_xarray.py` & `dask-2023.7.1/dask/array/tests/test_xarray.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/tiledb_io.py` & `dask-2023.7.1/dask/array/tiledb_io.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/ufunc.py` & `dask-2023.7.1/dask/array/ufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/utils.py` & `dask-2023.7.1/dask/array/utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/array/wrap.py` & `dask-2023.7.1/dask/array/wrap.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/backends.py` & `dask-2023.7.1/dask/backends.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/bag/__init__.py` & `dask-2023.7.1/dask/bag/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/bag/avro.py` & `dask-2023.7.1/dask/bag/avro.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/bag/chunk.py` & `dask-2023.7.1/dask/bag/chunk.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/bag/core.py` & `dask-2023.7.1/dask/bag/core.py`

 * *Files 0% similar despite different names*

```diff
@@ -669,19 +669,19 @@
         random_state : int or random.Random, optional
             If an integer, will be used to seed a new ``random.Random`` object.
             If provided, results in deterministic sampling.
 
         Examples
         --------
         >>> import dask.bag as db
-        >>> b = db.from_sequence(range(5))
-        >>> list(b.random_sample(0.5, 43))
-        [0, 3, 4]
-        >>> list(b.random_sample(0.5, 43))
-        [0, 3, 4]
+        >>> b = db.from_sequence(range(10))
+        >>> b.random_sample(0.5, 43).compute()
+        [0, 1, 3, 4, 7, 9]
+        >>> b.random_sample(0.5, 43).compute()
+        [0, 1, 3, 4, 7, 9]
         """
         if not 0 <= prob <= 1:
             raise ValueError("prob must be a number in the interval [0, 1]")
         if not isinstance(random_state, Random):
             random_state = Random(random_state)
 
         name = "random-sample-%s" % tokenize(self, prob, random_state.getstate())
@@ -2526,37 +2526,57 @@
     random_state = Random()
     random_state.setstate(state_data)
     for i in x:
         if random_state.random() < prob:
             yield i
 
 
-def random_state_data_python(n, random_state=None):
+def random_state_data_python(
+    n: int, random_state: int | Random | None = None
+) -> list[tuple[int, tuple[int, ...], None]]:
     """Return a list of tuples that can be passed to
     ``random.Random.setstate``.
 
     Parameters
     ----------
     n : int
         Number of tuples to return.
     random_state : int or ``random.Random``, optional
         If an int, is used to seed a new ``random.Random``.
-    """
-    if not isinstance(random_state, Random):
-        random_state = Random(random_state)
 
+    See Also
+    --------
+    dask.utils.random_state_data
+    """
     maxuint32 = 1 << 32
-    return [
-        (
-            3,
-            tuple(random_state.randint(0, maxuint32) for i in range(624)) + (624,),
-            None,
-        )
-        for i in range(n)
-    ]
+
+    try:
+        import numpy as np
+
+        if isinstance(random_state, Random):
+            random_state = random_state.randint(0, maxuint32)
+        np_rng = np.random.default_rng(random_state)
+
+        random_data = np_rng.bytes(624 * n * 4)  # `n * 624` 32-bit integers
+        arr = np.frombuffer(random_data, dtype=np.uint32).reshape((n, -1))
+        return [(3, tuple(row) + (624,), None) for row in arr.tolist()]
+
+    except ImportError:
+        # Pure python (much slower)
+        if not isinstance(random_state, Random):
+            random_state = Random(random_state)
+
+        return [
+            (
+                3,
+                tuple(random_state.randint(0, maxuint32) for _ in range(624)) + (624,),
+                None,
+            )
+            for _ in range(n)
+        ]
 
 
 def split(seq, n):
     """Split apart a sequence into n equal pieces.
 
     >>> split(range(10), 3)
     [[0, 1, 2], [3, 4, 5], [6, 7, 8, 9]]
```

### Comparing `dask-2023.7.0/dask/bag/random.py` & `dask-2023.7.1/dask/bag/random.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/bag/tests/test_avro.py` & `dask-2023.7.1/dask/bag/tests/test_avro.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/bag/tests/test_bag.py` & `dask-2023.7.1/dask/bag/tests/test_bag.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/bag/tests/test_random.py` & `dask-2023.7.1/dask/bag/tests/test_random.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/bag/tests/test_text.py` & `dask-2023.7.1/dask/bag/tests/test_text.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/bag/text.py` & `dask-2023.7.1/dask/bag/text.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/base.py` & `dask-2023.7.1/dask/base.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/blockwise.py` & `dask-2023.7.1/dask/blockwise.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/bytes/core.py` & `dask-2023.7.1/dask/bytes/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/bytes/tests/test_bytes_utils.py` & `dask-2023.7.1/dask/bytes/tests/test_bytes_utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/bytes/tests/test_compression.py` & `dask-2023.7.1/dask/bytes/tests/test_compression.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/bytes/tests/test_http.py` & `dask-2023.7.1/dask/bytes/tests/test_http.py`

 * *Files 2% similar despite different names*

```diff
@@ -167,21 +167,15 @@
     root = "http://localhost:8999/"
     fs = open_files(root + "/*")
     assert fs[0].path == "http://localhost:8999/a"
     assert fs[1].path == "http://localhost:8999/b"
 
 
 @pytest.mark.network
-@pytest.mark.parametrize(
-    "engine",
-    (
-        "pyarrow",
-        pytest.param("fastparquet", marks=pytest.mark.xfail_with_pyarrow_strings),
-    ),
-)
+@pytest.mark.parametrize("engine", ["pyarrow", "fastparquet"])
 def test_parquet(engine):
     pytest.importorskip("requests", minversion="2.21.0")
     dd = pytest.importorskip("dask.dataframe")
     pytest.importorskip(engine)
     df = dd.read_parquet(
         [
             "https://github.com/Parquet/parquet-compatibility/raw/"
```

### Comparing `dask-2023.7.0/dask/bytes/tests/test_local.py` & `dask-2023.7.1/dask/bytes/tests/test_local.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/bytes/tests/test_s3.py` & `dask-2023.7.1/dask/bytes/tests/test_s3.py`

 * *Files 1% similar despite different names*

```diff
@@ -435,21 +435,15 @@
 
     with s3_context("compress", valmap(double, files)):
         _, c = read_bytes("s3://compress/test/accounts.*", anon=True, **s3so)
 
     assert [aa._key for aa in concat(a)] != [cc._key for cc in concat(c)]
 
 
-@pytest.mark.parametrize(
-    "engine",
-    [
-        "pyarrow",
-        pytest.param("fastparquet", marks=pytest.mark.xfail_with_pyarrow_strings),
-    ],
-)
+@pytest.mark.parametrize("engine", ["pyarrow", "fastparquet"])
 @pytest.mark.parametrize("metadata_file", [True, False])
 def test_parquet(s3, engine, s3so, metadata_file):
     dd = pytest.importorskip("dask.dataframe")
     pd = pytest.importorskip("pandas")
     np = pytest.importorskip("numpy")
     pytest.importorskip(engine)
 
@@ -540,21 +534,15 @@
         engine=engine,
         storage_options=s3so,
         open_file_options={"cache_type": "all"},
     )
     dd.utils.assert_eq(data, df4)
 
 
-@pytest.mark.parametrize(
-    "engine",
-    [
-        "pyarrow",
-        pytest.param("fastparquet", marks=pytest.mark.xfail_with_pyarrow_strings),
-    ],
-)
+@pytest.mark.parametrize("engine", ["pyarrow", "fastparquet"])
 def test_parquet_append(s3, engine, s3so):
     pytest.importorskip(engine)
     dd = pytest.importorskip("dask.dataframe")
     pd = pytest.importorskip("pandas")
     np = pytest.importorskip("numpy")
 
     url = "s3://%s/test.parquet.append" % test_bucket_name
@@ -601,21 +589,15 @@
     dd.utils.assert_eq(
         pd.concat([data, data]),
         df2,
         check_index=False,
     )
 
 
-@pytest.mark.parametrize(
-    "engine",
-    [
-        "pyarrow",
-        pytest.param("fastparquet", marks=pytest.mark.xfail_with_pyarrow_strings),
-    ],
-)
+@pytest.mark.parametrize("engine", ["pyarrow", "fastparquet"])
 def test_parquet_wstoragepars(s3, s3so, engine):
     pytest.importorskip(engine)
     dd = pytest.importorskip("dask.dataframe")
     pd = pytest.importorskip("pandas")
     np = pytest.importorskip("numpy")
 
     url = "s3://%s/test.parquet" % test_bucket_name
```

### Comparing `dask-2023.7.0/dask/cache.py` & `dask-2023.7.1/dask/cache.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/callbacks.py` & `dask-2023.7.1/dask/callbacks.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/cli.py` & `dask-2023.7.1/dask/cli.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/compatibility.py` & `dask-2023.7.1/dask/compatibility.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/config.py` & `dask-2023.7.1/dask/config.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/context.py` & `dask-2023.7.1/dask/context.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/core.py` & `dask-2023.7.1/dask/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dask-schema.yaml` & `dask-2023.7.1/dask/dask-schema.yaml`

 * *Files 0% similar despite different names*

```diff
@@ -82,15 +82,15 @@
             type: integer
             description: |
               The number of files to handle within each metadata-processing
               task when reading a parquet dataset from a REMOTE file system.
               Specifying 0 will result in serial execution on the client.
 
       convert-string:
-        type: boolean
+        type: [boolean, 'null']
         description: |
           Whether to convert string-like data to pyarrow strings.
 
   array:
     type: object
     properties:
```

### Comparing `dask-2023.7.0/dask/dask.yaml` & `dask-2023.7.1/dask/dask.yaml`

 * *Files 7% similar despite different names*

```diff
@@ -10,15 +10,15 @@
   backend: "pandas"  # Backend dataframe library for input IO and data creation
   shuffle:
     method: null
     compression: null  # compression for on disk-shuffling. Partd supports ZLib, BZ2, SNAPPY
   parquet:
     metadata-task-size-local: 512  # Number of files per local metadata-processing task
     metadata-task-size-remote: 1  # Number of files per remote metadata-processing task
-  convert-string: false  # Whether to convert string-like data to pyarrow strings
+  convert-string: null  # Whether to convert string-like data to pyarrow strings
 
 array:
   backend: "numpy"  # Backend array library for input IO and data creation
   chunk-size: "128MiB"
   rechunk:
     method: "tasks"  # Rechunking method to use
     threshold: 4
```

### Comparing `dask-2023.7.0/dask/dataframe/__init__.py` & `dask-2023.7.1/dask/dataframe/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/_compat.py` & `dask-2023.7.1/dask/dataframe/_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/_dtypes.py` & `dask-2023.7.1/dask/dataframe/_dtypes.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/_pyarrow.py` & `dask-2023.7.1/dask/dataframe/_pyarrow.py`

 * *Files 13% similar despite different names*

```diff
@@ -1,10 +1,13 @@
 from __future__ import annotations
 
+from functools import partial
+
 import pandas as pd
+from packaging.version import Version
 
 from dask.dataframe._compat import PANDAS_GT_150, PANDAS_GT_200
 from dask.dataframe.utils import is_dataframe_like, is_index_like, is_series_like
 
 try:
     import pyarrow as pa
 except ImportError:
@@ -29,14 +32,20 @@
     return (
         pd.api.types.is_string_dtype(dtype)
         and not is_pyarrow_string_dtype(dtype)
         and not pd.api.types.is_dtype_equal(dtype, "decimal")
     )
 
 
+def is_pyarrow_string_index(x):
+    if isinstance(x, pd.MultiIndex):
+        return any(is_pyarrow_string_index(level) for level in x.levels)
+    return isinstance(x, pd.Index) and is_pyarrow_string_dtype(x.dtype)
+
+
 def is_object_string_index(x):
     if isinstance(x, pd.MultiIndex):
         return any(is_object_string_index(level) for level in x.levels)
     return isinstance(x, pd.Index) and is_object_string_dtype(x.dtype)
 
 
 def is_object_string_series(x):
@@ -48,56 +57,70 @@
 def is_object_string_dataframe(x):
     return isinstance(x, pd.DataFrame) and (
         any(is_object_string_series(s) for _, s in x.items())
         or is_object_string_index(x.index)
     )
 
 
-def to_pyarrow_string(df):
+def _to_string_dtype(df, dtype_check, index_check, string_dtype):
     if not (is_dataframe_like(df) or is_series_like(df) or is_index_like(df)):
         return df
 
+    # Guards against importing `pyarrow` at the module level (where it may not be installed)
+    if string_dtype == "pyarrow":
+        string_dtype = pd.StringDtype("pyarrow")
+
     # Possibly convert DataFrame/Series/Index to `string[pyarrow]`
     dtypes = None
     if is_dataframe_like(df):
         dtypes = {
-            col: pd.StringDtype("pyarrow")
-            for col, dtype in df.dtypes.items()
-            if is_object_string_dtype(dtype)
+            col: string_dtype for col, dtype in df.dtypes.items() if dtype_check(dtype)
         }
-    elif is_object_string_dtype(df.dtype):
-        dtypes = pd.StringDtype("pyarrow")
+    elif dtype_check(df.dtype):
+        dtypes = string_dtype
 
     if dtypes:
         df = df.astype(dtypes, copy=False)
 
     # Convert DataFrame/Series index too
-    if (is_dataframe_like(df) or is_series_like(df)) and is_object_string_index(
-        df.index
-    ):
+    if (is_dataframe_like(df) or is_series_like(df)) and index_check(df.index):
         if isinstance(df.index, pd.MultiIndex):
             levels = {
-                i: level.astype(pd.StringDtype("pyarrow"))
+                i: level.astype(string_dtype)
                 for i, level in enumerate(df.index.levels)
-                if is_object_string_dtype(level.dtype)
+                if dtype_check(level.dtype)
             }
             # set verify_integrity=False to preserve index codes
             df.index = df.index.set_levels(
                 levels.values(), level=levels.keys(), verify_integrity=False
             )
         else:
-            df.index = df.index.astype(pd.StringDtype("pyarrow"))
+            df.index = df.index.astype(string_dtype)
     return df
 
 
+to_pyarrow_string = partial(
+    _to_string_dtype,
+    dtype_check=is_object_string_dtype,
+    index_check=is_object_string_index,
+    string_dtype="pyarrow",
+)
+to_object_string = partial(
+    _to_string_dtype,
+    dtype_check=is_pyarrow_string_dtype,
+    index_check=is_pyarrow_string_index,
+    string_dtype=object,
+)
+
+
 def check_pyarrow_string_supported():
     """Make sure we have all the required versions"""
-    if pa is None:
+    if not PANDAS_GT_200:
         raise RuntimeError(
             "Using dask's `dataframe.convert-string` configuration "
-            "option requires `pyarrow` to be installed."
+            "option requires `pandas>=2.0` to be installed."
         )
-    if not PANDAS_GT_200:
+    if pa is None or Version(pa.__version__) < Version("12.0.0"):
         raise RuntimeError(
             "Using dask's `dataframe.convert-string` configuration "
-            "option requires `pandas>=2.0` to be installed."
+            "option requires `pyarrow>=12` to be installed."
         )
```

### Comparing `dask-2023.7.0/dask/dataframe/_pyarrow_compat.py` & `dask-2023.7.1/dask/dataframe/_pyarrow_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/accessor.py` & `dask-2023.7.1/dask/dataframe/accessor.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/backends.py` & `dask-2023.7.1/dask/dataframe/backends.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/categorical.py` & `dask-2023.7.1/dask/dataframe/categorical.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/core.py` & `dask-2023.7.1/dask/dataframe/core.py`

 * *Files 1% similar despite different names*

```diff
@@ -30,18819 +30,18830 @@
 000001d0: 0a20 2020 2069 735f 6e75 6d65 7269 635f  .    is_numeric_
 000001e0: 6474 7970 652c 0a20 2020 2069 735f 7469  dtype,.    is_ti
 000001f0: 6d65 6465 6c74 6136 345f 6474 7970 652c  medelta64_dtype,
 00000200: 0a29 0a66 726f 6d20 746c 7a20 696d 706f  .).from tlz impo
 00000210: 7274 2066 6972 7374 2c20 6d65 7267 652c  rt first, merge,
 00000220: 2070 6172 7469 7469 6f6e 5f61 6c6c 2c20   partition_all, 
 00000230: 7265 6d6f 7665 2c20 756e 6971 7565 0a0a  remove, unique..
-00000240: 696d 706f 7274 2064 6173 6b0a 696d 706f  import dask.impo
-00000250: 7274 2064 6173 6b2e 6172 7261 7920 6173  rt dask.array as
-00000260: 2064 610a 6672 6f6d 2064 6173 6b20 696d   da.from dask im
-00000270: 706f 7274 2063 6f72 650a 6672 6f6d 2064  port core.from d
-00000280: 6173 6b2e 6172 7261 792e 636f 7265 2069  ask.array.core i
-00000290: 6d70 6f72 7420 4172 7261 792c 206e 6f72  mport Array, nor
-000002a0: 6d61 6c69 7a65 5f61 7267 0a66 726f 6d20  malize_arg.from 
-000002b0: 6461 736b 2e62 6167 2069 6d70 6f72 7420  dask.bag import 
-000002c0: 6d61 705f 7061 7274 6974 696f 6e73 2061  map_partitions a
-000002d0: 7320 6d61 705f 6261 675f 7061 7274 6974  s map_bag_partit
-000002e0: 696f 6e73 0a66 726f 6d20 6461 736b 2e62  ions.from dask.b
-000002f0: 6173 6520 696d 706f 7274 2028 0a20 2020  ase import (.   
-00000300: 2044 6173 6b4d 6574 686f 6473 4d69 7869   DaskMethodsMixi
-00000310: 6e2c 0a20 2020 2064 6f6e 745f 6f70 7469  n,.    dont_opti
-00000320: 6d69 7a65 2c0a 2020 2020 6973 5f64 6173  mize,.    is_das
-00000330: 6b5f 636f 6c6c 6563 7469 6f6e 2c0a 2020  k_collection,.  
-00000340: 2020 6e61 6d65 645f 7363 6865 6475 6c65    named_schedule
-00000350: 7273 2c0a 2020 2020 746f 6b65 6e69 7a65  rs,.    tokenize
-00000360: 2c0a 290a 6672 6f6d 2064 6173 6b2e 626c  ,.).from dask.bl
-00000370: 6f63 6b77 6973 6520 696d 706f 7274 2042  ockwise import B
-00000380: 6c6f 636b 7769 7365 2c20 426c 6f63 6b77  lockwise, Blockw
-00000390: 6973 6544 6570 2c20 426c 6f63 6b77 6973  iseDep, Blockwis
-000003a0: 6544 6570 4469 6374 2c20 626c 6f63 6b77  eDepDict, blockw
-000003b0: 6973 650a 6672 6f6d 2064 6173 6b2e 636f  ise.from dask.co
-000003c0: 6e74 6578 7420 696d 706f 7274 2067 6c6f  ntext import glo
-000003d0: 6261 6c6d 6574 686f 640a 6672 6f6d 2064  balmethod.from d
-000003e0: 6173 6b2e 6461 7461 6672 616d 6520 696d  ask.dataframe im
-000003f0: 706f 7274 206d 6574 686f 6473 0a66 726f  port methods.fro
-00000400: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
-00000410: 2e5f 636f 6d70 6174 2069 6d70 6f72 7420  ._compat import 
-00000420: 280a 2020 2020 5041 4e44 4153 5f47 545f  (.    PANDAS_GT_
-00000430: 3134 302c 0a20 2020 2050 414e 4441 535f  140,.    PANDAS_
-00000440: 4754 5f31 3530 2c0a 2020 2020 5041 4e44  GT_150,.    PAND
-00000450: 4153 5f47 545f 3230 302c 0a20 2020 2050  AS_GT_200,.    P
-00000460: 414e 4441 535f 4754 5f32 3130 2c0a 2020  ANDAS_GT_210,.  
-00000470: 2020 5041 4e44 4153 5f56 4552 5349 4f4e    PANDAS_VERSION
-00000480: 2c0a 2020 2020 6368 6563 6b5f 636f 6e76  ,.    check_conv
-00000490: 6572 745f 6474 7970 655f 6465 7072 6563  ert_dtype_deprec
-000004a0: 6174 696f 6e2c 0a20 2020 2063 6865 636b  ation,.    check
-000004b0: 5f6e 7569 7361 6e63 655f 636f 6c75 6d6e  _nuisance_column
-000004c0: 735f 7761 726e 696e 672c 0a20 2020 2063  s_warning,.    c
-000004d0: 6865 636b 5f6e 756d 6572 6963 5f6f 6e6c  heck_numeric_onl
-000004e0: 795f 6465 7072 6563 6174 696f 6e2c 0a20  y_deprecation,. 
-000004f0: 2020 2063 6865 636b 5f72 6564 7563 7469     check_reducti
-00000500: 6f6e 735f 7275 6e74 696d 655f 7761 726e  ons_runtime_warn
-00000510: 696e 672c 0a20 2020 2069 735f 7374 7269  ing,.    is_stri
-00000520: 6e67 5f64 7479 7065 2c0a 290a 6672 6f6d  ng_dtype,.).from
-00000530: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
-00000540: 6163 6365 7373 6f72 2069 6d70 6f72 7420  accessor import 
-00000550: 4361 6368 6564 4163 6365 7373 6f72 2c20  CachedAccessor, 
-00000560: 4461 7465 7469 6d65 4163 6365 7373 6f72  DatetimeAccessor
-00000570: 2c20 5374 7269 6e67 4163 6365 7373 6f72  , StringAccessor
-00000580: 0a66 726f 6d20 6461 736b 2e64 6174 6166  .from dask.dataf
-00000590: 7261 6d65 2e63 6174 6567 6f72 6963 616c  rame.categorical
-000005a0: 2069 6d70 6f72 7420 4361 7465 676f 7269   import Categori
-000005b0: 6361 6c41 6363 6573 736f 722c 2063 6174  calAccessor, cat
-000005c0: 6567 6f72 697a 650a 6672 6f6d 2064 6173  egorize.from das
-000005d0: 6b2e 6461 7461 6672 616d 652e 6469 7370  k.dataframe.disp
-000005e0: 6174 6368 2069 6d70 6f72 7420 280a 2020  atch import (.  
-000005f0: 2020 6765 745f 7061 7261 6c6c 656c 5f74    get_parallel_t
-00000600: 7970 652c 0a20 2020 2067 726f 7570 5f73  ype,.    group_s
-00000610: 706c 6974 5f64 6973 7061 7463 682c 0a20  plit_dispatch,. 
-00000620: 2020 2068 6173 685f 6f62 6a65 6374 5f64     hash_object_d
-00000630: 6973 7061 7463 682c 0a20 2020 206d 6574  ispatch,.    met
-00000640: 615f 6e6f 6e65 6d70 7479 2c0a 290a 6672  a_nonempty,.).fr
-00000650: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
-00000660: 652e 6f70 7469 6d69 7a65 2069 6d70 6f72  e.optimize impor
-00000670: 7420 6f70 7469 6d69 7a65 0a66 726f 6d20  t optimize.from 
-00000680: 6461 736b 2e64 6174 6166 7261 6d65 2e75  dask.dataframe.u
-00000690: 7469 6c73 2069 6d70 6f72 7420 280a 2020  tils import (.  
-000006a0: 2020 4174 7472 6962 7574 654e 6f74 496d    AttributeNotIm
-000006b0: 706c 656d 656e 7465 6445 7272 6f72 2c0a  plementedError,.
-000006c0: 2020 2020 6368 6563 6b5f 6d61 7463 6869      check_matchi
-000006d0: 6e67 5f63 6f6c 756d 6e73 2c0a 2020 2020  ng_columns,.    
-000006e0: 6368 6563 6b5f 6e75 6d65 7269 635f 6f6e  check_numeric_on
-000006f0: 6c79 5f76 616c 6964 2c0a 2020 2020 636c  ly_valid,.    cl
-00000700: 6561 725f 6b6e 6f77 6e5f 6361 7465 676f  ear_known_catego
-00000710: 7269 6573 2c0a 2020 2020 6472 6f70 5f62  ries,.    drop_b
-00000720: 795f 7368 616c 6c6f 775f 636f 7079 2c0a  y_shallow_copy,.
-00000730: 2020 2020 6765 745f 6e75 6d65 7269 635f      get_numeric_
-00000740: 6f6e 6c79 5f6b 7761 7267 732c 0a20 2020  only_kwargs,.   
-00000750: 2068 6173 5f6b 6e6f 776e 5f63 6174 6567   has_known_categ
-00000760: 6f72 6965 732c 0a20 2020 2069 6e64 6578  ories,.    index
-00000770: 5f73 756d 6d61 7279 2c0a 2020 2020 696e  _summary,.    in
-00000780: 7365 7274 5f6d 6574 615f 7061 7261 6d5f  sert_meta_param_
-00000790: 6465 7363 7269 7074 696f 6e2c 0a20 2020  description,.   
-000007a0: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
-000007b0: 6b65 2c0a 2020 2020 6973 5f69 6e64 6578  ke,.    is_index
-000007c0: 5f6c 696b 652c 0a20 2020 2069 735f 7365  _like,.    is_se
-000007d0: 7269 6573 5f6c 696b 652c 0a20 2020 206d  ries_like,.    m
-000007e0: 616b 655f 6d65 7461 2c0a 2020 2020 6d65  ake_meta,.    me
-000007f0: 7461 5f66 7261 6d65 5f63 6f6e 7374 7275  ta_frame_constru
-00000800: 6374 6f72 2c0a 2020 2020 6d65 7461 5f73  ctor,.    meta_s
-00000810: 6572 6965 735f 636f 6e73 7472 7563 746f  eries_constructo
-00000820: 722c 0a20 2020 2072 6169 7365 5f6f 6e5f  r,.    raise_on_
-00000830: 6d65 7461 5f65 7272 6f72 2c0a 2020 2020  meta_error,.    
-00000840: 7661 6c69 645f 6469 7669 7369 6f6e 732c  valid_divisions,
-00000850: 0a29 0a66 726f 6d20 6461 736b 2e64 656c  .).from dask.del
-00000860: 6179 6564 2069 6d70 6f72 7420 4465 6c61  ayed import Dela
-00000870: 7965 642c 2064 656c 6179 6564 2c20 756e  yed, delayed, un
-00000880: 7061 636b 5f63 6f6c 6c65 6374 696f 6e73  pack_collections
-00000890: 0a66 726f 6d20 6461 736b 2e68 6967 686c  .from dask.highl
-000008a0: 6576 656c 6772 6170 6820 696d 706f 7274  evelgraph import
-000008b0: 2048 6967 684c 6576 656c 4772 6170 680a   HighLevelGraph.
-000008c0: 6672 6f6d 2064 6173 6b2e 6c61 7965 7273  from dask.layers
-000008d0: 2069 6d70 6f72 7420 4461 7461 4672 616d   import DataFram
-000008e0: 6554 7265 6552 6564 7563 7469 6f6e 0a66  eTreeReduction.f
-000008f0: 726f 6d20 6461 736b 2e75 7469 6c73 2069  rom dask.utils i
-00000900: 6d70 6f72 7420 280a 2020 2020 496e 6465  mport (.    Inde
-00000910: 7843 616c 6c61 626c 652c 0a20 2020 204d  xCallable,.    M
-00000920: 2c0a 2020 2020 4f70 6572 6174 6f72 4d65  ,.    OperatorMe
-00000930: 7468 6f64 4d69 7869 6e2c 0a20 2020 205f  thodMixin,.    _
-00000940: 6465 7072 6563 6174 6564 2c0a 2020 2020  deprecated,.    
-00000950: 6170 706c 792c 0a20 2020 2064 6572 6976  apply,.    deriv
-00000960: 6564 5f66 726f 6d2c 0a20 2020 2066 756e  ed_from,.    fun
-00000970: 636e 616d 652c 0a20 2020 2067 6574 5f6d  cname,.    get_m
-00000980: 6574 615f 6c69 6272 6172 792c 0a20 2020  eta_library,.   
-00000990: 2068 6173 5f6b 6579 776f 7264 2c0a 2020   has_keyword,.  
-000009a0: 2020 6973 5f61 7272 6179 6c69 6b65 2c0a    is_arraylike,.
-000009b0: 2020 2020 6974 6572 5f63 6875 6e6b 732c      iter_chunks,
-000009c0: 0a20 2020 206b 6579 5f73 706c 6974 2c0a  .    key_split,.
-000009d0: 2020 2020 6d61 7962 655f 706c 7572 616c      maybe_plural
-000009e0: 697a 652c 0a20 2020 206d 656d 6f72 795f  ize,.    memory_
-000009f0: 7265 7072 2c0a 2020 2020 7061 7273 655f  repr,.    parse_
-00000a00: 6279 7465 732c 0a20 2020 2070 6172 7469  bytes,.    parti
-00000a10: 616c 5f62 795f 6f72 6465 722c 0a20 2020  al_by_order,.   
-00000a20: 2070 7365 7564 6f72 616e 646f 6d2c 0a20   pseudorandom,. 
-00000a30: 2020 2070 7574 5f6c 696e 6573 2c0a 2020     put_lines,.  
-00000a40: 2020 7261 6e64 6f6d 5f73 7461 7465 5f64    random_state_d
-00000a50: 6174 612c 0a20 2020 2074 7970 656e 616d  ata,.    typenam
-00000a60: 652c 0a29 0a66 726f 6d20 6461 736b 2e77  e,.).from dask.w
-00000a70: 6964 6765 7473 2069 6d70 6f72 7420 6765  idgets import ge
-00000a80: 745f 7465 6d70 6c61 7465 0a0a 4445 4641  t_template..DEFA
-00000a90: 554c 545f 4745 5420 3d20 6e61 6d65 645f  ULT_GET = named_
-00000aa0: 7363 6865 6475 6c65 7273 2e67 6574 2822  schedulers.get("
-00000ab0: 7468 7265 6164 7322 2c20 6e61 6d65 645f  threads", named_
-00000ac0: 7363 6865 6475 6c65 7273 5b22 7379 6e63  schedulers["sync
-00000ad0: 225d 290a 0a6e 6f5f 6465 6661 756c 7420  "])..no_default 
-00000ae0: 3d20 225f 5f6e 6f5f 6465 6661 756c 745f  = "__no_default_
-00000af0: 5f22 0a0a 4752 4f55 505f 4b45 5953 5f44  _"..GROUP_KEYS_D
-00000b00: 4546 4155 4c54 3a20 626f 6f6c 207c 204e  EFAULT: bool | N
-00000b10: 6f6e 6520 3d20 5472 7565 0a69 6620 5041  one = True.if PA
-00000b20: 4e44 4153 5f47 545f 3135 3020 616e 6420  NDAS_GT_150 and 
-00000b30: 6e6f 7420 5041 4e44 4153 5f47 545f 3230  not PANDAS_GT_20
-00000b40: 303a 0a20 2020 2047 524f 5550 5f4b 4559  0:.    GROUP_KEY
-00000b50: 535f 4445 4641 554c 5420 3d20 4e6f 6e65  S_DEFAULT = None
-00000b60: 0a0a 7064 2e73 6574 5f6f 7074 696f 6e28  ..pd.set_option(
-00000b70: 2263 6f6d 7075 7465 2e75 7365 5f6e 756d  "compute.use_num
-00000b80: 6578 7072 222c 2046 616c 7365 290a 0a0a  expr", False)...
-00000b90: 6465 6620 5f6e 756d 6572 6963 5f6f 6e6c  def _numeric_onl
-00000ba0: 7928 6675 6e63 293a 0a20 2020 2022 2222  y(func):.    """
-00000bb0: 4465 636f 7261 746f 7220 666f 7220 6d65  Decorator for me
-00000bc0: 7468 6f64 7320 7468 6174 2061 6363 6570  thods that accep
-00000bd0: 7420 6120 6e75 6d65 7269 635f 6f6e 6c79  t a numeric_only
-00000be0: 206b 7761 7267 2222 220a 0a20 2020 2040   kwarg"""..    @
-00000bf0: 7772 6170 7328 6675 6e63 290a 2020 2020  wraps(func).    
-00000c00: 6465 6620 7772 6170 7065 7228 7365 6c66  def wrapper(self
-00000c10: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-00000c20: 7329 3a0a 2020 2020 2020 2020 2320 6e75  s):.        # nu
-00000c30: 6d65 7269 635f 6f6e 6c79 2069 7320 4e6f  meric_only is No
-00000c40: 6e65 2062 7920 6465 6661 756c 7420 2d20  ne by default - 
-00000c50: 696e 2074 6861 7420 6361 7365 2073 656c  in that case sel
-00000c60: 6620 3d20 7365 6c66 2e0a 2020 2020 2020  f = self..      
-00000c70: 2020 6966 206b 7761 7267 732e 6765 7428    if kwargs.get(
-00000c80: 226e 756d 6572 6963 5f6f 6e6c 7922 2920  "numeric_only") 
-00000c90: 6973 2046 616c 7365 3a0a 2020 2020 2020  is False:.      
-00000ca0: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
-00000cb0: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
-00000cc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000cd0: 2022 276e 756d 6572 6963 5f6f 6e6c 793d   "'numeric_only=
-00000ce0: 4661 6c73 6527 2069 7320 6e6f 7420 696d  False' is not im
-00000cf0: 706c 656d 656e 7465 6420 696e 2044 6173  plemented in Das
-00000d00: 6b2e 220a 2020 2020 2020 2020 2020 2020  k.".            
-00000d10: 290a 2020 2020 2020 2020 656c 6966 206b  ).        elif k
-00000d20: 7761 7267 732e 6765 7428 226e 756d 6572  wargs.get("numer
-00000d30: 6963 5f6f 6e6c 7922 2920 6973 2054 7275  ic_only") is Tru
-00000d40: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-00000d50: 656c 6620 3d20 7365 6c66 2e5f 6765 745f  elf = self._get_
-00000d60: 6e75 6d65 7269 635f 6461 7461 2829 0a20  numeric_data(). 
-00000d70: 2020 2020 2020 2072 6574 7572 6e20 6675         return fu
-00000d80: 6e63 2873 656c 662c 202a 6172 6773 2c20  nc(self, *args, 
-00000d90: 2a2a 6b77 6172 6773 290a 0a20 2020 2072  **kwargs)..    r
-00000da0: 6574 7572 6e20 7772 6170 7065 720a 0a0a  eturn wrapper...
-00000db0: 6465 6620 5f6e 756d 6572 6963 5f64 6174  def _numeric_dat
-00000dc0: 6128 6675 6e63 293a 0a20 2020 2022 2222  a(func):.    """
-00000dd0: 4d6f 6469 6669 6564 2076 6572 7369 6f6e  Modified version
-00000de0: 206f 6620 7468 6520 6162 6f76 6520 6465   of the above de
-00000df0: 636f 7261 746f 722c 2072 6967 6874 206e  corator, right n
-00000e00: 6f77 206f 6e6c 7920 7573 6564 2077 6974  ow only used wit
-00000e10: 6820 7374 642e 2057 6520 646f 6e27 740a  h std. We don't.
-00000e20: 2020 2020 6e65 6564 2072 6169 7369 6e67      need raising
-00000e30: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
-00000e40: 7272 6f72 2074 6865 7265 2c20 6265 6361  rror there, beca
-00000e50: 7573 6520 6974 2773 2068 616e 646c 6564  use it's handled
-00000e60: 2062 790a 2020 2020 5f6e 756d 6572 6963   by.    _numeric
-00000e70: 5f6f 6e6c 795f 6d61 7962 655f 7761 726e  _only_maybe_warn
-00000e80: 2069 6e73 7465 6164 2e20 5468 6973 2069   instead. This i
-00000e90: 7320 6120 7465 6d70 6f72 6172 7920 736f  s a temporary so
-00000ea0: 6c75 7469 6f6e 2074 6861 7420 6e65 6564  lution that need
-00000eb0: 730a 2020 2020 6d6f 7265 2074 696d 6520  s.    more time 
-00000ec0: 746f 2062 6520 6765 6e65 7261 6c69 7a65  to be generalize
-00000ed0: 642e 2222 220a 0a20 2020 2040 7772 6170  d."""..    @wrap
-00000ee0: 7328 6675 6e63 290a 2020 2020 6465 6620  s(func).    def 
-00000ef0: 7772 6170 7065 7228 7365 6c66 2c20 2a61  wrapper(self, *a
-00000f00: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
-00000f10: 2020 2020 2020 2020 6966 206b 7761 7267          if kwarg
-00000f20: 732e 6765 7428 226e 756d 6572 6963 5f6f  s.get("numeric_o
-00000f30: 6e6c 7922 2920 6973 2054 7275 653a 0a20  nly") is True:. 
-00000f40: 2020 2020 2020 2020 2020 2073 656c 6620             self 
-00000f50: 3d20 7365 6c66 2e5f 6765 745f 6e75 6d65  = self._get_nume
-00000f60: 7269 635f 6461 7461 2829 0a20 2020 2020  ric_data().     
-00000f70: 2020 2072 6574 7572 6e20 6675 6e63 2873     return func(s
-00000f80: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
-00000f90: 6172 6773 290a 0a20 2020 2072 6574 7572  args)..    retur
-00000fa0: 6e20 7772 6170 7065 720a 0a0a 6465 6620  n wrapper...def 
-00000fb0: 5f6e 756d 6572 6963 5f6f 6e6c 795f 6d61  _numeric_only_ma
-00000fc0: 7962 655f 7761 726e 2864 662c 206e 756d  ybe_warn(df, num
-00000fd0: 6572 6963 5f6f 6e6c 792c 2064 6566 6175  eric_only, defau
-00000fe0: 6c74 3d4e 6f6e 6529 3a0a 2020 2020 2222  lt=None):.    ""
-00000ff0: 2255 7064 6174 6520 6e75 6d65 7269 635f  "Update numeric_
-00001000: 6f6e 6c79 2074 6f20 6765 7420 7269 6420  only to get rid 
-00001010: 6f66 206e 6f5f 6465 6661 756c 742c 2061  of no_default, a
-00001020: 6e64 2070 6f73 7369 626c 7920 7761 726e  nd possibly warn
-00001030: 2061 626f 7574 2064 6566 6175 6c74 2076   about default v
-00001040: 616c 7565 2e0a 2020 2020 544f 444f 3a20  alue..    TODO: 
-00001050: 7368 6f75 6c64 206d 6f76 6520 746f 206e  should move to n
-00001060: 756d 6572 6963 5f6f 6e6c 7920 6465 636f  umeric_only deco
-00001070: 7261 746f 722e 2053 6565 2068 7474 7073  rator. See https
-00001080: 3a2f 2f67 6974 6875 622e 636f 6d2f 6461  ://github.com/da
-00001090: 736b 2f64 6173 6b2f 7075 6c6c 2f39 3935  sk/dask/pull/995
-000010a0: 320a 2020 2020 2222 220a 2020 2020 6966  2.    """.    if
-000010b0: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
-000010c0: 6b65 2864 6629 3a0a 2020 2020 2020 2020  ke(df):.        
-000010d0: 7761 726e 5f6e 756d 6572 6963 5f6f 6e6c  warn_numeric_onl
-000010e0: 7920 3d20 4661 6c73 650a 2020 2020 2020  y = False.      
-000010f0: 2020 6966 206e 756d 6572 6963 5f6f 6e6c    if numeric_onl
-00001100: 7920 6973 206e 6f5f 6465 6661 756c 743a  y is no_default:
-00001110: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00001120: 5041 4e44 4153 5f47 545f 3230 303a 0a20  PANDAS_GT_200:. 
-00001130: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00001140: 756d 6572 6963 5f6f 6e6c 7920 3d20 4661  umeric_only = Fa
-00001150: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-00001160: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00001170: 2020 2020 2020 7761 726e 5f6e 756d 6572        warn_numer
-00001180: 6963 5f6f 6e6c 7920 3d20 5472 7565 0a0a  ic_only = True..
-00001190: 2020 2020 2020 2020 6e75 6d65 7269 6373          numerics
-000011a0: 203d 2064 662e 5f6d 6574 612e 5f67 6574   = df._meta._get
-000011b0: 5f6e 756d 6572 6963 5f64 6174 6128 290a  _numeric_data().
-000011c0: 2020 2020 2020 2020 6861 735f 6e6f 6e5f          has_non_
-000011d0: 6e75 6d65 7269 6373 203d 206c 656e 286e  numerics = len(n
-000011e0: 756d 6572 6963 732e 636f 6c75 6d6e 7329  umerics.columns)
-000011f0: 203c 206c 656e 2864 662e 5f6d 6574 612e   < len(df._meta.
-00001200: 636f 6c75 6d6e 7329 0a20 2020 2020 2020  columns).       
-00001210: 2069 6620 6861 735f 6e6f 6e5f 6e75 6d65   if has_non_nume
-00001220: 7269 6373 3a0a 2020 2020 2020 2020 2020  rics:.          
-00001230: 2020 6966 206e 756d 6572 6963 5f6f 6e6c    if numeric_onl
-00001240: 7920 6973 2046 616c 7365 3a0a 2020 2020  y is False:.    
-00001250: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00001260: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
-00001270: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00001280: 2020 2020 2020 2020 2020 2022 276e 756d             "'num
-00001290: 6572 6963 5f6f 6e6c 793d 4661 6c73 6527  eric_only=False'
-000012a0: 2069 7320 6e6f 7420 696d 706c 656d 656e   is not implemen
-000012b0: 7465 6420 696e 2044 6173 6b2e 220a 2020  ted in Dask.".  
-000012c0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-000012d0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-000012e0: 2077 6172 6e5f 6e75 6d65 7269 635f 6f6e   warn_numeric_on
-000012f0: 6c79 3a0a 2020 2020 2020 2020 2020 2020  ly:.            
-00001300: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00001310: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-00001320: 2020 2020 2020 2022 5468 6520 6465 6661         "The defa
-00001330: 756c 7420 7661 6c75 6520 6f66 206e 756d  ult value of num
-00001340: 6572 6963 5f6f 6e6c 7920 696e 2064 6173  eric_only in das
-00001350: 6b20 7769 6c6c 2062 6520 6368 616e 6765  k will be change
-00001360: 6420 746f 2046 616c 7365 2069 6e20 220a  d to False in ".
-00001370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001380: 2020 2020 2274 6865 2066 7574 7572 6520      "the future 
-00001390: 7768 656e 2075 7369 6e67 2064 6173 6b20  when using dask 
-000013a0: 7769 7468 2070 616e 6461 7320 322e 3022  with pandas 2.0"
-000013b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000013c0: 2020 2020 2020 4675 7475 7265 5761 726e        FutureWarn
-000013d0: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
-000013e0: 2020 2020 2029 0a20 2020 2069 6620 6e75       ).    if nu
-000013f0: 6d65 7269 635f 6f6e 6c79 2069 7320 6e6f  meric_only is no
-00001400: 5f64 6566 6175 6c74 2061 6e64 2064 6566  _default and def
-00001410: 6175 6c74 2069 7320 6e6f 7420 4e6f 6e65  ault is not None
-00001420: 3a0a 2020 2020 2020 2020 6e75 6d65 7269  :.        numeri
-00001430: 635f 6f6e 6c79 203d 2064 6566 6175 6c74  c_only = default
-00001440: 0a20 2020 2072 6574 7572 6e20 7b7d 2069  .    return {} i
-00001450: 6620 6e75 6d65 7269 635f 6f6e 6c79 2069  f numeric_only i
-00001460: 7320 6e6f 5f64 6566 6175 6c74 2065 6c73  s no_default els
-00001470: 6520 7b22 6e75 6d65 7269 635f 6f6e 6c79  e {"numeric_only
-00001480: 223a 206e 756d 6572 6963 5f6f 6e6c 797d  ": numeric_only}
-00001490: 0a0a 0a64 6566 205f 636f 6e63 6174 2861  ...def _concat(a
-000014a0: 7267 732c 2069 676e 6f72 655f 696e 6465  rgs, ignore_inde
-000014b0: 783d 4661 6c73 6529 3a0a 2020 2020 6966  x=False):.    if
-000014c0: 206e 6f74 2061 7267 733a 0a20 2020 2020   not args:.     
-000014d0: 2020 2072 6574 7572 6e20 6172 6773 0a20     return args. 
-000014e0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-000014f0: 2866 6972 7374 2863 6f72 652e 666c 6174  (first(core.flat
-00001500: 7465 6e28 6172 6773 2929 2c20 6e70 2e6e  ten(args)), np.n
-00001510: 6461 7272 6179 293a 0a20 2020 2020 2020  darray):.       
-00001520: 2072 6574 7572 6e20 6461 2e63 6f72 652e   return da.core.
-00001530: 636f 6e63 6174 656e 6174 6533 2861 7267  concatenate3(arg
-00001540: 7329 0a20 2020 2069 6620 6e6f 7420 6861  s).    if not ha
-00001550: 735f 7061 7261 6c6c 656c 5f74 7970 6528  s_parallel_type(
-00001560: 6172 6773 5b30 5d29 3a0a 2020 2020 2020  args[0]):.      
-00001570: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-00001580: 2020 2072 6574 7572 6e20 7064 2e53 6572     return pd.Ser
-00001590: 6965 7328 6172 6773 290a 2020 2020 2020  ies(args).      
-000015a0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
-000015b0: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-000015c0: 7265 7475 726e 2061 7267 730a 2020 2020  return args.    
-000015d0: 2320 5765 2066 696c 7465 7220 6f75 7420  # We filter out 
-000015e0: 656d 7074 7920 7061 7274 6974 696f 6e73  empty partitions
-000015f0: 2068 6572 6520 6265 6361 7573 6520 7061   here because pa
-00001600: 6e64 6173 2066 7265 7175 656e 746c 7920  ndas frequently 
-00001610: 6861 730a 2020 2020 2320 696e 636f 6e73  has.    # incons
-00001620: 6973 7465 6e74 2064 7479 7065 7320 696e  istent dtypes in
-00001630: 2072 6573 756c 7473 2062 6574 7765 656e   results between
-00001640: 2065 6d70 7479 2061 6e64 206e 6f6e 2d65   empty and non-e
-00001650: 6d70 7479 2066 7261 6d65 732e 0a20 2020  mpty frames..   
-00001660: 2023 2049 6465 616c 6c79 2074 6869 7320   # Ideally this 
-00001670: 776f 756c 6420 6265 2068 616e 646c 6564  would be handled
-00001680: 206c 6f63 616c 6c79 2066 6f72 2065 6163   locally for eac
-00001690: 6820 6f70 6572 6174 696f 6e2c 2062 7574  h operation, but
-000016a0: 2069 6e20 7072 6163 7469 6365 0a20 2020   in practice.   
-000016b0: 2023 2074 6869 7320 7365 656d 7320 6561   # this seems ea
-000016c0: 7369 6572 2e20 544f 444f 3a20 646f 6e27  sier. TODO: don'
-000016d0: 7420 646f 2074 6869 732e 0a20 2020 2061  t do this..    a
-000016e0: 7267 7332 203d 205b 6920 666f 7220 6920  rgs2 = [i for i 
-000016f0: 696e 2061 7267 7320 6966 206c 656e 2869  in args if len(i
-00001700: 295d 0a20 2020 2072 6574 7572 6e20 280a  )].    return (.
-00001710: 2020 2020 2020 2020 6172 6773 5b30 5d0a          args[0].
-00001720: 2020 2020 2020 2020 6966 206e 6f74 2061          if not a
-00001730: 7267 7332 0a20 2020 2020 2020 2065 6c73  rgs2.        els
-00001740: 6520 6d65 7468 6f64 732e 636f 6e63 6174  e methods.concat
-00001750: 2861 7267 7332 2c20 756e 6966 6f72 6d3d  (args2, uniform=
-00001760: 5472 7565 2c20 6967 6e6f 7265 5f69 6e64  True, ignore_ind
-00001770: 6578 3d69 676e 6f72 655f 696e 6465 7829  ex=ignore_index)
-00001780: 0a20 2020 2029 0a0a 0a64 6566 2066 696e  .    )...def fin
-00001790: 616c 697a 6528 7265 7375 6c74 7329 3a0a  alize(results):.
-000017a0: 2020 2020 7265 7475 726e 205f 636f 6e63      return _conc
-000017b0: 6174 2872 6573 756c 7473 290a 0a0a 636c  at(results)...cl
-000017c0: 6173 7320 5363 616c 6172 2844 6173 6b4d  ass Scalar(DaskM
-000017d0: 6574 686f 6473 4d69 7869 6e2c 204f 7065  ethodsMixin, Ope
-000017e0: 7261 746f 724d 6574 686f 644d 6978 696e  ratorMethodMixin
-000017f0: 293a 0a20 2020 2022 2222 4120 4461 736b  ):.    """A Dask
-00001800: 206f 626a 6563 7420 746f 2072 6570 7265   object to repre
-00001810: 7365 6e74 2061 2070 616e 6461 7320 7363  sent a pandas sc
-00001820: 616c 6172 2222 220a 0a20 2020 2064 6566  alar"""..    def
-00001830: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-00001840: 6473 6b2c 206e 616d 652c 206d 6574 612c  dsk, name, meta,
-00001850: 2064 6976 6973 696f 6e73 3d4e 6f6e 6529   divisions=None)
-00001860: 3a0a 2020 2020 2020 2020 2320 6469 7669  :.        # divi
-00001870: 7369 6f6e 7320 6973 2069 676e 6f72 6564  sions is ignored
-00001880: 2c20 6f6e 6c79 2070 7265 7365 6e74 2074  , only present t
-00001890: 6f20 6265 2063 6f6d 7061 7469 626c 6520  o be compatible 
-000018a0: 7769 7468 206f 7468 6572 0a20 2020 2020  with other.     
-000018b0: 2020 2023 206f 626a 6563 7473 2e0a 2020     # objects..  
-000018c0: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-000018d0: 6e73 7461 6e63 6528 6473 6b2c 2048 6967  nstance(dsk, Hig
-000018e0: 684c 6576 656c 4772 6170 6829 3a0a 2020  hLevelGraph):.  
-000018f0: 2020 2020 2020 2020 2020 6473 6b20 3d20            dsk = 
-00001900: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
-00001910: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
-00001920: 6e61 6d65 2c20 6473 6b2c 2064 6570 656e  name, dsk, depen
-00001930: 6465 6e63 6965 733d 5b5d 290a 2020 2020  dencies=[]).    
-00001940: 2020 2020 7365 6c66 2e64 6173 6b20 3d20      self.dask = 
-00001950: 6473 6b0a 2020 2020 2020 2020 7365 6c66  dsk.        self
-00001960: 2e5f 6e61 6d65 203d 206e 616d 650a 2020  ._name = name.  
-00001970: 2020 2020 2020 7365 6c66 2e5f 7061 7265        self._pare
-00001980: 6e74 5f6d 6574 6120 3d20 7064 2e53 6572  nt_meta = pd.Ser
-00001990: 6965 7328 6474 7970 653d 2266 6c6f 6174  ies(dtype="float
-000019a0: 3634 2229 0a0a 2020 2020 2020 2020 6d65  64")..        me
-000019b0: 7461 203d 206d 616b 655f 6d65 7461 286d  ta = make_meta(m
-000019c0: 6574 612c 2070 6172 656e 745f 6d65 7461  eta, parent_meta
-000019d0: 3d73 656c 662e 5f70 6172 656e 745f 6d65  =self._parent_me
-000019e0: 7461 290a 2020 2020 2020 2020 6966 2069  ta).        if i
-000019f0: 735f 6461 7461 6672 616d 655f 6c69 6b65  s_dataframe_like
-00001a00: 286d 6574 6129 206f 7220 6973 5f73 6572  (meta) or is_ser
-00001a10: 6965 735f 6c69 6b65 286d 6574 6129 206f  ies_like(meta) o
-00001a20: 7220 6973 5f69 6e64 6578 5f6c 696b 6528  r is_index_like(
-00001a30: 6d65 7461 293a 0a20 2020 2020 2020 2020  meta):.         
-00001a40: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-00001a50: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00001a60: 2020 2020 6622 4578 7065 6374 6564 206d      f"Expected m
-00001a70: 6574 6120 746f 2073 7065 6369 6679 2073  eta to specify s
-00001a80: 6361 6c61 722c 2067 6f74 207b 7479 7065  calar, got {type
-00001a90: 6e61 6d65 2874 7970 6528 6d65 7461 2929  name(type(meta))
-00001aa0: 7d22 0a20 2020 2020 2020 2020 2020 2029  }".            )
-00001ab0: 0a20 2020 2020 2020 2073 656c 662e 5f6d  .        self._m
-00001ac0: 6574 6120 3d20 6d65 7461 0a0a 2020 2020  eta = meta..    
-00001ad0: 6465 6620 5f5f 6461 736b 5f67 7261 7068  def __dask_graph
-00001ae0: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-00001af0: 2020 7265 7475 726e 2073 656c 662e 6461    return self.da
-00001b00: 736b 0a0a 2020 2020 6465 6620 5f5f 6461  sk..    def __da
-00001b10: 736b 5f6b 6579 735f 5f28 7365 6c66 293a  sk_keys__(self):
-00001b20: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00001b30: 5b73 656c 662e 6b65 795d 0a0a 2020 2020  [self.key]..    
-00001b40: 6465 6620 5f5f 6461 736b 5f74 6f6b 656e  def __dask_token
-00001b50: 697a 655f 5f28 7365 6c66 293a 0a20 2020  ize__(self):.   
-00001b60: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00001b70: 2e5f 6e61 6d65 0a0a 2020 2020 6465 6620  ._name..    def 
-00001b80: 5f5f 6461 736b 5f6c 6179 6572 735f 5f28  __dask_layers__(
-00001b90: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00001ba0: 6574 7572 6e20 2873 656c 662e 5f6e 616d  eturn (self._nam
-00001bb0: 652c 290a 0a20 2020 205f 5f64 6173 6b5f  e,)..    __dask_
-00001bc0: 6f70 7469 6d69 7a65 5f5f 203d 2067 6c6f  optimize__ = glo
-00001bd0: 6261 6c6d 6574 686f 6428 0a20 2020 2020  balmethod(.     
-00001be0: 2020 206f 7074 696d 697a 652c 206b 6579     optimize, key
-00001bf0: 3d22 6461 7461 6672 616d 655f 6f70 7469  ="dataframe_opti
-00001c00: 6d69 7a65 222c 2066 616c 7365 793d 646f  mize", falsey=do
-00001c10: 6e74 5f6f 7074 696d 697a 650a 2020 2020  nt_optimize.    
-00001c20: 290a 2020 2020 5f5f 6461 736b 5f73 6368  ).    __dask_sch
-00001c30: 6564 756c 6572 5f5f 203d 2073 7461 7469  eduler__ = stati
-00001c40: 636d 6574 686f 6428 4445 4641 554c 545f  cmethod(DEFAULT_
-00001c50: 4745 5429 0a0a 2020 2020 6465 6620 5f5f  GET)..    def __
-00001c60: 6461 736b 5f70 6f73 7463 6f6d 7075 7465  dask_postcompute
-00001c70: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-00001c80: 2020 7265 7475 726e 2066 6972 7374 2c20    return first, 
-00001c90: 2829 0a0a 2020 2020 6465 6620 5f5f 6461  ()..    def __da
-00001ca0: 736b 5f70 6f73 7470 6572 7369 7374 5f5f  sk_postpersist__
-00001cb0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00001cc0: 7265 7475 726e 2073 656c 662e 5f72 6562  return self._reb
-00001cd0: 7569 6c64 2c20 2829 0a0a 2020 2020 6465  uild, ()..    de
-00001ce0: 6620 5f72 6562 7569 6c64 2873 656c 662c  f _rebuild(self,
-00001cf0: 2064 736b 2c20 2a2c 2072 656e 616d 653d   dsk, *, rename=
-00001d00: 4e6f 6e65 293a 0a20 2020 2020 2020 206e  None):.        n
-00001d10: 616d 6520 3d20 7365 6c66 2e5f 6e61 6d65  ame = self._name
-00001d20: 0a20 2020 2020 2020 2069 6620 7265 6e61  .        if rena
-00001d30: 6d65 3a0a 2020 2020 2020 2020 2020 2020  me:.            
-00001d40: 6e61 6d65 203d 2072 656e 616d 652e 6765  name = rename.ge
-00001d50: 7428 6e61 6d65 2c20 6e61 6d65 290a 2020  t(name, name).  
-00001d60: 2020 2020 2020 7265 7475 726e 2053 6361        return Sca
-00001d70: 6c61 7228 6473 6b2c 206e 616d 652c 2073  lar(dsk, name, s
-00001d80: 656c 662e 5f6d 6574 612c 2073 656c 662e  elf._meta, self.
-00001d90: 6469 7669 7369 6f6e 7329 0a0a 2020 2020  divisions)..    
-00001da0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00001db0: 6620 5f6d 6574 615f 6e6f 6e65 6d70 7479  f _meta_nonempty
-00001dc0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00001dd0: 7265 7475 726e 2073 656c 662e 5f6d 6574  return self._met
-00001de0: 610a 0a20 2020 2040 7072 6f70 6572 7479  a..    @property
-00001df0: 0a20 2020 2064 6566 2064 7479 7065 2873  .    def dtype(s
-00001e00: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00001e10: 7475 726e 2073 656c 662e 5f6d 6574 612e  turn self._meta.
-00001e20: 6474 7970 650a 0a20 2020 2064 6566 205f  dtype..    def _
-00001e30: 5f64 6972 5f5f 2873 656c 6629 3a0a 2020  _dir__(self):.  
-00001e40: 2020 2020 2020 6f20 3d20 7365 7428 6469        o = set(di
-00001e50: 7228 7479 7065 2873 656c 6629 2929 0a20  r(type(self))). 
-00001e60: 2020 2020 2020 206f 2e75 7064 6174 6528         o.update(
-00001e70: 7365 6c66 2e5f 5f64 6963 745f 5f29 0a20  self.__dict__). 
-00001e80: 2020 2020 2020 2069 6620 6e6f 7420 6861         if not ha
-00001e90: 7361 7474 7228 7365 6c66 2e5f 6d65 7461  sattr(self._meta
-00001ea0: 2c20 2264 7479 7065 2229 3a0a 2020 2020  , "dtype"):.    
-00001eb0: 2020 2020 2020 2020 6f2e 7265 6d6f 7665          o.remove
-00001ec0: 2822 6474 7970 6522 2920 2023 2064 7479  ("dtype")  # dty
-00001ed0: 7065 206f 6e6c 7920 696e 2060 6469 7260  pe only in `dir`
-00001ee0: 2069 6620 6176 6169 6c61 626c 650a 2020   if available.  
-00001ef0: 2020 2020 2020 7265 7475 726e 206c 6973        return lis
-00001f00: 7428 6f29 0a0a 2020 2020 4070 726f 7065  t(o)..    @prope
-00001f10: 7274 790a 2020 2020 6465 6620 6469 7669  rty.    def divi
-00001f20: 7369 6f6e 7328 7365 6c66 293a 0a20 2020  sions(self):.   
-00001f30: 2020 2020 2022 2222 4475 6d6d 7920 6469       """Dummy di
-00001f40: 7669 7369 6f6e 7320 746f 2062 6520 636f  visions to be co
-00001f50: 6d70 6174 2077 6974 6820 5365 7269 6573  mpat with Series
-00001f60: 2061 6e64 2044 6174 6146 7261 6d65 2222   and DataFrame""
-00001f70: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00001f80: 2028 4e6f 6e65 2c20 4e6f 6e65 290a 0a20   (None, None).. 
-00001f90: 2020 2064 6566 205f 5f72 6570 725f 5f28     def __repr__(
-00001fa0: 7365 6c66 293a 0a20 2020 2020 2020 206e  self):.        n
-00001fb0: 616d 6520 3d20 7365 6c66 2e5f 6e61 6d65  ame = self._name
-00001fc0: 2069 6620 6c65 6e28 7365 6c66 2e5f 6e61   if len(self._na
-00001fd0: 6d65 2920 3c20 3130 2065 6c73 6520 7365  me) < 10 else se
-00001fe0: 6c66 2e5f 6e61 6d65 5b3a 375d 202b 2022  lf._name[:7] + "
-00001ff0: 2e2e 2e22 0a20 2020 2020 2020 2069 6620  ...".        if 
-00002000: 6861 7361 7474 7228 7365 6c66 2e5f 6d65  hasattr(self._me
-00002010: 7461 2c20 2264 7479 7065 2229 3a0a 2020  ta, "dtype"):.  
-00002020: 2020 2020 2020 2020 2020 6578 7472 6120            extra 
-00002030: 3d20 222c 2064 7479 7065 3d25 7322 2025  = ", dtype=%s" %
-00002040: 2073 656c 662e 5f6d 6574 612e 6474 7970   self._meta.dtyp
-00002050: 650a 2020 2020 2020 2020 656c 7365 3a0a  e.        else:.
-00002060: 2020 2020 2020 2020 2020 2020 6578 7472              extr
-00002070: 6120 3d20 222c 2074 7970 653d 2573 2220  a = ", type=%s" 
-00002080: 2520 7479 7065 2873 656c 662e 5f6d 6574  % type(self._met
-00002090: 6129 2e5f 5f6e 616d 655f 5f0a 2020 2020  a).__name__.    
-000020a0: 2020 2020 7265 7475 726e 2066 2264 642e      return f"dd.
-000020b0: 5363 616c 6172 3c7b 6e61 6d65 7d7b 6578  Scalar<{name}{ex
-000020c0: 7472 617d 3e22 0a0a 2020 2020 6465 6620  tra}>"..    def 
-000020d0: 5f5f 6172 7261 795f 5f28 7365 6c66 293a  __array__(self):
-000020e0: 0a20 2020 2020 2020 2023 2061 7272 6179  .        # array
-000020f0: 2069 6e74 6572 6661 6365 2069 7320 7265   interface is re
-00002100: 7175 6972 6564 2074 6f20 7375 7070 6f72  quired to suppor
-00002110: 7420 7061 6e64 6173 2069 6e73 7461 6e63  t pandas instanc
-00002120: 6520 2b20 5363 616c 6172 0a20 2020 2020  e + Scalar.     
-00002130: 2020 2023 204f 7468 6572 7769 7365 2c20     # Otherwise, 
-00002140: 6162 6f76 6520 6f70 2072 6573 756c 7473  above op results
-00002150: 2069 6e20 7064 2e53 6572 6965 7320 6f66   in pd.Series of
-00002160: 2053 6361 6c61 7220 286f 626a 6563 7420   Scalar (object 
-00002170: 6474 7970 6529 0a20 2020 2020 2020 2072  dtype).        r
-00002180: 6574 7572 6e20 6e70 2e61 7361 7272 6179  eturn np.asarray
-00002190: 2873 656c 662e 636f 6d70 7574 6528 2929  (self.compute())
-000021a0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-000021b0: 2020 2020 6465 6620 5f61 7267 7328 7365      def _args(se
-000021c0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-000021d0: 7572 6e20 2873 656c 662e 6461 736b 2c20  urn (self.dask, 
-000021e0: 7365 6c66 2e5f 6e61 6d65 2c20 7365 6c66  self._name, self
-000021f0: 2e5f 6d65 7461 290a 0a20 2020 2064 6566  ._meta)..    def
-00002200: 205f 5f67 6574 7374 6174 655f 5f28 7365   __getstate__(se
-00002210: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00002220: 7572 6e20 7365 6c66 2e5f 6172 6773 0a0a  urn self._args..
-00002230: 2020 2020 6465 6620 5f5f 7365 7473 7461      def __setsta
-00002240: 7465 5f5f 2873 656c 662c 2073 7461 7465  te__(self, state
-00002250: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-00002260: 6461 736b 2c20 7365 6c66 2e5f 6e61 6d65  dask, self._name
-00002270: 2c20 7365 6c66 2e5f 6d65 7461 203d 2073  , self._meta = s
-00002280: 7461 7465 0a0a 2020 2020 6465 6620 5f5f  tate..    def __
-00002290: 626f 6f6c 5f5f 2873 656c 6629 3a0a 2020  bool__(self):.  
-000022a0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-000022b0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-000022c0: 2020 2066 2254 7279 696e 6720 746f 2063     f"Trying to c
-000022d0: 6f6e 7665 7274 207b 7365 6c66 7d20 746f  onvert {self} to
-000022e0: 2061 2062 6f6f 6c65 616e 2076 616c 7565   a boolean value
-000022f0: 2e20 4265 6361 7573 6520 4461 736b 206f  . Because Dask o
-00002300: 626a 6563 7473 2061 7265 2022 0a20 2020  bjects are ".   
-00002310: 2020 2020 2020 2020 2022 6c61 7a69 6c79           "lazily
-00002320: 2065 7661 6c75 6174 6564 2c20 7468 6579   evaluated, they
-00002330: 2063 616e 6e6f 7420 6265 2063 6f6e 7665   cannot be conve
-00002340: 7274 6564 2074 6f20 6120 626f 6f6c 6561  rted to a boolea
-00002350: 6e20 7661 6c75 6520 6f72 2075 7365 6420  n value or used 
-00002360: 220a 2020 2020 2020 2020 2020 2020 2269  ".            "i
-00002370: 6e20 626f 6f6c 6561 6e20 636f 6e64 6974  n boolean condit
-00002380: 696f 6e73 206c 696b 6520 6966 2073 7461  ions like if sta
-00002390: 7465 6d65 6e74 732e 2054 7279 2063 616c  tements. Try cal
-000023a0: 6c69 6e67 202e 636f 6d70 7574 6528 2920  ling .compute() 
-000023b0: 746f 2022 0a20 2020 2020 2020 2020 2020  to ".           
-000023c0: 2022 666f 7263 6520 636f 6d70 7574 6174   "force computat
-000023d0: 696f 6e20 7072 696f 7220 746f 2063 6f6e  ion prior to con
-000023e0: 7665 7274 696e 6720 746f 2061 2062 6f6f  verting to a boo
-000023f0: 6c65 616e 2076 616c 7565 206f 7220 7573  lean value or us
-00002400: 696e 6720 696e 2022 0a20 2020 2020 2020  ing in ".       
-00002410: 2020 2020 2022 6120 636f 6e64 6974 696f       "a conditio
-00002420: 6e61 6c20 7374 6174 656d 656e 742e 220a  nal statement.".
-00002430: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-00002440: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00002450: 206b 6579 2873 656c 6629 3a0a 2020 2020   key(self):.    
-00002460: 2020 2020 7265 7475 726e 2028 7365 6c66      return (self
-00002470: 2e5f 6e61 6d65 2c20 3029 0a0a 2020 2020  ._name, 0)..    
-00002480: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
-00002490: 2064 6566 205f 6765 745f 756e 6172 795f   def _get_unary_
-000024a0: 6f70 6572 6174 6f72 2863 6c73 2c20 6f70  operator(cls, op
-000024b0: 293a 0a20 2020 2020 2020 2064 6566 2066  ):.        def f
-000024c0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000024d0: 2020 2020 6e61 6d65 203d 2066 756e 636e      name = funcn
-000024e0: 616d 6528 6f70 2920 2b20 222d 2220 2b20  ame(op) + "-" + 
-000024f0: 746f 6b65 6e69 7a65 2873 656c 6629 0a20  tokenize(self). 
-00002500: 2020 2020 2020 2020 2020 2064 736b 203d             dsk =
-00002510: 207b 286e 616d 652c 2030 293a 2028 6f70   {(name, 0): (op
-00002520: 2c20 2873 656c 662e 5f6e 616d 652c 2030  , (self._name, 0
-00002530: 2929 7d0a 2020 2020 2020 2020 2020 2020  ))}.            
-00002540: 6d65 7461 203d 206f 7028 7365 6c66 2e5f  meta = op(self._
-00002550: 6d65 7461 5f6e 6f6e 656d 7074 7929 0a20  meta_nonempty). 
-00002560: 2020 2020 2020 2020 2020 2067 7261 7068             graph
-00002570: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
-00002580: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
-00002590: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
-000025a0: 7065 6e64 656e 6369 6573 3d5b 7365 6c66  pendencies=[self
-000025b0: 5d29 0a20 2020 2020 2020 2020 2020 2072  ]).            r
-000025c0: 6574 7572 6e20 5363 616c 6172 2867 7261  eturn Scalar(gra
-000025d0: 7068 2c20 6e61 6d65 2c20 6d65 7461 290a  ph, name, meta).
-000025e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000025f0: 660a 0a20 2020 2040 636c 6173 736d 6574  f..    @classmet
-00002600: 686f 640a 2020 2020 6465 6620 5f67 6574  hod.    def _get
-00002610: 5f62 696e 6172 795f 6f70 6572 6174 6f72  _binary_operator
-00002620: 2863 6c73 2c20 6f70 2c20 696e 763d 4661  (cls, op, inv=Fa
-00002630: 6c73 6529 3a0a 2020 2020 2020 2020 7265  lse):.        re
-00002640: 7475 726e 206c 616d 6264 6120 7365 6c66  turn lambda self
-00002650: 2c20 6f74 6865 723a 205f 7363 616c 6172  , other: _scalar
-00002660: 5f62 696e 6172 7928 6f70 2c20 7365 6c66  _binary(op, self
-00002670: 2c20 6f74 6865 722c 2069 6e76 3d69 6e76  , other, inv=inv
-00002680: 290a 0a20 2020 2064 6566 2074 6f5f 6465  )..    def to_de
-00002690: 6c61 7965 6428 7365 6c66 2c20 6f70 7469  layed(self, opti
-000026a0: 6d69 7a65 5f67 7261 7068 3d54 7275 6529  mize_graph=True)
-000026b0: 3a0a 2020 2020 2020 2020 2222 2243 6f6e  :.        """Con
-000026c0: 7665 7274 2069 6e74 6f20 6120 6060 6461  vert into a ``da
-000026d0: 736b 2e64 656c 6179 6564 6060 206f 626a  sk.delayed`` obj
-000026e0: 6563 742e 0a0a 2020 2020 2020 2020 5061  ect...        Pa
-000026f0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-00002700: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00002710: 2020 2020 6f70 7469 6d69 7a65 5f67 7261      optimize_gra
-00002720: 7068 203a 2062 6f6f 6c2c 206f 7074 696f  ph : bool, optio
-00002730: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00002740: 4966 2054 7275 6520 5b64 6566 6175 6c74  If True [default
-00002750: 5d2c 2074 6865 2067 7261 7068 2069 7320  ], the graph is 
-00002760: 6f70 7469 6d69 7a65 6420 6265 666f 7265  optimized before
-00002770: 2063 6f6e 7665 7274 696e 6720 696e 746f   converting into
-00002780: 0a20 2020 2020 2020 2020 2020 2060 6064  .            ``d
-00002790: 6173 6b2e 6465 6c61 7965 6460 6020 6f62  ask.delayed`` ob
-000027a0: 6a65 6374 732e 0a20 2020 2020 2020 2022  jects..        "
-000027b0: 2222 0a20 2020 2020 2020 2064 736b 203d  "".        dsk =
-000027c0: 2073 656c 662e 5f5f 6461 736b 5f67 7261   self.__dask_gra
-000027d0: 7068 5f5f 2829 0a20 2020 2020 2020 206c  ph__().        l
-000027e0: 6179 6572 203d 2073 656c 662e 5f5f 6461  ayer = self.__da
-000027f0: 736b 5f6c 6179 6572 735f 5f28 295b 305d  sk_layers__()[0]
-00002800: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
-00002810: 6d69 7a65 5f67 7261 7068 3a0a 2020 2020  mize_graph:.    
-00002820: 2020 2020 2020 2020 6473 6b20 3d20 7365          dsk = se
-00002830: 6c66 2e5f 5f64 6173 6b5f 6f70 7469 6d69  lf.__dask_optimi
-00002840: 7a65 5f5f 2864 736b 2c20 7365 6c66 2e5f  ze__(dsk, self._
-00002850: 5f64 6173 6b5f 6b65 7973 5f5f 2829 290a  _dask_keys__()).
-00002860: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
-00002870: 7220 3d20 2264 656c 6179 6564 2d22 202b  r = "delayed-" +
-00002880: 2073 656c 662e 5f6e 616d 650a 2020 2020   self._name.    
-00002890: 2020 2020 2020 2020 6473 6b20 3d20 4869          dsk = Hi
-000028a0: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-000028b0: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6c61  m_collections(la
-000028c0: 7965 722c 2064 736b 2c20 6465 7065 6e64  yer, dsk, depend
-000028d0: 656e 6369 6573 3d28 2929 0a20 2020 2020  encies=()).     
-000028e0: 2020 2072 6574 7572 6e20 4465 6c61 7965     return Delaye
-000028f0: 6428 7365 6c66 2e6b 6579 2c20 6473 6b2c  d(self.key, dsk,
-00002900: 206c 6179 6572 3d6c 6179 6572 290a 0a0a   layer=layer)...
-00002910: 6465 6620 5f73 6361 6c61 725f 6269 6e61  def _scalar_bina
-00002920: 7279 286f 702c 2073 656c 662c 206f 7468  ry(op, self, oth
-00002930: 6572 2c20 696e 763d 4661 6c73 6529 3a0a  er, inv=False):.
-00002940: 2020 2020 6e61 6d65 203d 2066 227b 6675      name = f"{fu
-00002950: 6e63 6e61 6d65 286f 7029 7d2d 7b74 6f6b  ncname(op)}-{tok
-00002960: 656e 697a 6528 7365 6c66 2c20 6f74 6865  enize(self, othe
-00002970: 7229 7d22 0a20 2020 2064 6570 656e 6465  r)}".    depende
-00002980: 6e63 6965 7320 3d20 5b73 656c 665d 0a0a  ncies = [self]..
-00002990: 2020 2020 6473 6b20 3d20 7b7d 0a20 2020      dsk = {}.   
-000029a0: 2072 6574 7572 6e5f 7479 7065 203d 2067   return_type = g
-000029b0: 6574 5f70 6172 616c 6c65 6c5f 7479 7065  et_parallel_type
-000029c0: 286f 7468 6572 290a 0a20 2020 2069 6620  (other)..    if 
-000029d0: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
-000029e0: 2c20 5363 616c 6172 293a 0a20 2020 2020  , Scalar):.     
-000029f0: 2020 2064 6570 656e 6465 6e63 6965 732e     dependencies.
-00002a00: 6170 7065 6e64 286f 7468 6572 290a 2020  append(other).  
-00002a10: 2020 2020 2020 6f74 6865 725f 6b65 7920        other_key 
-00002a20: 3d20 286f 7468 6572 2e5f 6e61 6d65 2c20  = (other._name, 
-00002a30: 3029 0a20 2020 2065 6c69 6620 6973 5f64  0).    elif is_d
-00002a40: 6173 6b5f 636f 6c6c 6563 7469 6f6e 286f  ask_collection(o
-00002a50: 7468 6572 293a 0a20 2020 2020 2020 2072  ther):.        r
-00002a60: 6574 7572 6e20 4e6f 7449 6d70 6c65 6d65  eturn NotImpleme
-00002a70: 6e74 6564 0a20 2020 2065 6c73 653a 0a20  nted.    else:. 
-00002a80: 2020 2020 2020 206f 7468 6572 5f6b 6579         other_key
-00002a90: 203d 206f 7468 6572 0a0a 2020 2020 6473   = other..    ds
-00002aa0: 6b5b 286e 616d 652c 2030 295d 203d 2028  k[(name, 0)] = (
-00002ab0: 0a20 2020 2020 2020 2028 6f70 2c20 6f74  .        (op, ot
-00002ac0: 6865 725f 6b65 792c 2028 7365 6c66 2e5f  her_key, (self._
-00002ad0: 6e61 6d65 2c20 3029 2920 6966 2069 6e76  name, 0)) if inv
-00002ae0: 2065 6c73 6520 286f 702c 2028 7365 6c66   else (op, (self
-00002af0: 2e5f 6e61 6d65 2c20 3029 2c20 6f74 6865  ._name, 0), othe
-00002b00: 725f 6b65 7929 0a20 2020 2029 0a0a 2020  r_key).    )..  
-00002b10: 2020 6f74 6865 725f 6d65 7461 203d 206d    other_meta = m
-00002b20: 616b 655f 6d65 7461 286f 7468 6572 2c20  ake_meta(other, 
-00002b30: 7061 7265 6e74 5f6d 6574 613d 7365 6c66  parent_meta=self
-00002b40: 2e5f 7061 7265 6e74 5f6d 6574 6129 0a20  ._parent_meta). 
-00002b50: 2020 206f 7468 6572 5f6d 6574 615f 6e6f     other_meta_no
-00002b60: 6e65 6d70 7479 203d 206d 6574 615f 6e6f  nempty = meta_no
-00002b70: 6e65 6d70 7479 286f 7468 6572 5f6d 6574  nempty(other_met
-00002b80: 6129 0a20 2020 2069 6620 696e 763a 0a20  a).    if inv:. 
-00002b90: 2020 2020 2020 206d 6574 6120 3d20 6f70         meta = op
-00002ba0: 286f 7468 6572 5f6d 6574 615f 6e6f 6e65  (other_meta_none
-00002bb0: 6d70 7479 2c20 7365 6c66 2e5f 6d65 7461  mpty, self._meta
-00002bc0: 5f6e 6f6e 656d 7074 7929 0a20 2020 2065  _nonempty).    e
-00002bd0: 6c73 653a 0a20 2020 2020 2020 206d 6574  lse:.        met
-00002be0: 6120 3d20 6f70 2873 656c 662e 5f6d 6574  a = op(self._met
-00002bf0: 615f 6e6f 6e65 6d70 7479 2c20 6f74 6865  a_nonempty, othe
-00002c00: 725f 6d65 7461 5f6e 6f6e 656d 7074 7929  r_meta_nonempty)
-00002c10: 0a0a 2020 2020 6772 6170 6820 3d20 4869  ..    graph = Hi
-00002c20: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-00002c30: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6e61  m_collections(na
-00002c40: 6d65 2c20 6473 6b2c 2064 6570 656e 6465  me, dsk, depende
-00002c50: 6e63 6965 733d 6465 7065 6e64 656e 6369  ncies=dependenci
-00002c60: 6573 290a 2020 2020 6966 2072 6574 7572  es).    if retur
-00002c70: 6e5f 7479 7065 2069 7320 6e6f 7420 5363  n_type is not Sc
-00002c80: 616c 6172 3a0a 2020 2020 2020 2020 7265  alar:.        re
-00002c90: 7475 726e 2072 6574 7572 6e5f 7479 7065  turn return_type
-00002ca0: 2867 7261 7068 2c20 6e61 6d65 2c20 6d65  (graph, name, me
-00002cb0: 7461 2c20 5b6f 7468 6572 2e69 6e64 6578  ta, [other.index
-00002cc0: 2e6d 696e 2829 2c20 6f74 6865 722e 696e  .min(), other.in
-00002cd0: 6465 782e 6d61 7828 295d 290a 2020 2020  dex.max()]).    
-00002ce0: 656c 7365 3a0a 2020 2020 2020 2020 7265  else:.        re
-00002cf0: 7475 726e 2053 6361 6c61 7228 6772 6170  turn Scalar(grap
-00002d00: 682c 206e 616d 652c 206d 6574 6129 0a0a  h, name, meta)..
-00002d10: 0a63 6c61 7373 205f 4672 616d 6528 4461  .class _Frame(Da
-00002d20: 736b 4d65 7468 6f64 734d 6978 696e 2c20  skMethodsMixin, 
-00002d30: 4f70 6572 6174 6f72 4d65 7468 6f64 4d69  OperatorMethodMi
-00002d40: 7869 6e29 3a0a 2020 2020 2222 2253 7570  xin):.    """Sup
-00002d50: 6572 636c 6173 7320 666f 7220 4461 7461  erclass for Data
-00002d60: 4672 616d 6520 616e 6420 5365 7269 6573  Frame and Series
-00002d70: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-00002d80: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-00002d90: 2020 2020 6473 6b3a 2064 6963 740a 2020      dsk: dict.  
-00002da0: 2020 2020 2020 5468 6520 6461 736b 2067        The dask g
-00002db0: 7261 7068 2074 6f20 636f 6d70 7574 6520  raph to compute 
-00002dc0: 7468 6973 2044 6174 6146 7261 6d65 0a20  this DataFrame. 
-00002dd0: 2020 206e 616d 653a 2073 7472 0a20 2020     name: str.   
-00002de0: 2020 2020 2054 6865 206b 6579 2070 7265       The key pre
-00002df0: 6669 7820 7468 6174 2073 7065 6369 6669  fix that specifi
-00002e00: 6573 2077 6869 6368 206b 6579 7320 696e  es which keys in
-00002e10: 2074 6865 2064 6173 6b20 636f 6d70 7269   the dask compri
-00002e20: 7365 2074 6869 730a 2020 2020 2020 2020  se this.        
-00002e30: 7061 7274 6963 756c 6172 2044 6174 6146  particular DataF
-00002e40: 7261 6d65 202f 2053 6572 6965 730a 2020  rame / Series.  
-00002e50: 2020 6d65 7461 3a20 7061 6e64 6173 2e44    meta: pandas.D
-00002e60: 6174 6146 7261 6d65 2c20 7061 6e64 6173  ataFrame, pandas
-00002e70: 2e53 6572 6965 732c 206f 7220 7061 6e64  .Series, or pand
-00002e80: 6173 2e49 6e64 6578 0a20 2020 2020 2020  as.Index.       
-00002e90: 2041 6e20 656d 7074 7920 7061 6e64 6173   An empty pandas
-00002ea0: 206f 626a 6563 7420 7769 7468 206e 616d   object with nam
-00002eb0: 6573 2c20 6474 7970 6573 2c20 616e 6420  es, dtypes, and 
-00002ec0: 696e 6469 6365 7320 6d61 7463 6869 6e67  indices matching
-00002ed0: 2074 6865 0a20 2020 2020 2020 2065 7870   the.        exp
-00002ee0: 6563 7465 6420 6f75 7470 7574 2e0a 2020  ected output..  
-00002ef0: 2020 6469 7669 7369 6f6e 733a 2074 7570    divisions: tup
-00002f00: 6c65 206f 6620 696e 6465 7820 7661 6c75  le of index valu
-00002f10: 6573 0a20 2020 2020 2020 2056 616c 7565  es.        Value
-00002f20: 7320 616c 6f6e 6720 7768 6963 6820 7765  s along which we
-00002f30: 2070 6172 7469 7469 6f6e 206f 7572 2062   partition our b
-00002f40: 6c6f 636b 7320 6f6e 2074 6865 2069 6e64  locks on the ind
-00002f50: 6578 0a20 2020 2022 2222 0a0a 2020 2020  ex.    """..    
-00002f60: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
-00002f70: 662c 2064 736b 2c20 6e61 6d65 2c20 6d65  f, dsk, name, me
-00002f80: 7461 2c20 6469 7669 7369 6f6e 7329 3a0a  ta, divisions):.
-00002f90: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-00002fa0: 7369 6e73 7461 6e63 6528 6473 6b2c 2048  sinstance(dsk, H
-00002fb0: 6967 684c 6576 656c 4772 6170 6829 3a0a  ighLevelGraph):.
-00002fc0: 2020 2020 2020 2020 2020 2020 6473 6b20              dsk 
-00002fd0: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
-00002fe0: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
-00002ff0: 7328 6e61 6d65 2c20 6473 6b2c 2064 6570  s(name, dsk, dep
-00003000: 656e 6465 6e63 6965 733d 5b5d 290a 2020  endencies=[]).  
-00003010: 2020 2020 2020 7365 6c66 2e64 6173 6b20        self.dask 
-00003020: 3d20 6473 6b0a 2020 2020 2020 2020 7365  = dsk.        se
-00003030: 6c66 2e5f 6e61 6d65 203d 206e 616d 650a  lf._name = name.
-00003040: 2020 2020 2020 2020 6d65 7461 203d 206d          meta = m
-00003050: 616b 655f 6d65 7461 286d 6574 6129 0a20  ake_meta(meta). 
-00003060: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-00003070: 6c66 2e5f 6973 5f70 6172 7469 7469 6f6e  lf._is_partition
-00003080: 5f74 7970 6528 6d65 7461 293a 0a20 2020  _type(meta):.   
-00003090: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-000030a0: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
-000030b0: 2020 2020 2020 2020 2020 6622 4578 7065            f"Expe
-000030c0: 6374 6564 206d 6574 6120 746f 2073 7065  cted meta to spe
-000030d0: 6369 6679 2074 7970 6520 7b74 7970 6528  cify type {type(
-000030e0: 7365 6c66 292e 5f5f 6e61 6d65 5f5f 7d2c  self).__name__},
-000030f0: 2067 6f74 2074 7970 6520 220a 2020 2020   got type ".    
-00003100: 2020 2020 2020 2020 2020 2020 6622 7b74              f"{t
-00003110: 7970 656e 616d 6528 7479 7065 286d 6574  ypename(type(met
-00003120: 6129 297d 220a 2020 2020 2020 2020 2020  a))}".          
-00003130: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-00003140: 2e5f 6d65 7461 203d 206d 6574 610a 2020  ._meta = meta.  
-00003150: 2020 2020 2020 7365 6c66 2e64 6976 6973        self.divis
-00003160: 696f 6e73 203d 2074 7570 6c65 2864 6976  ions = tuple(div
-00003170: 6973 696f 6e73 290a 0a20 2020 2020 2020  isions)..       
-00003180: 2023 204f 7074 696f 6e61 6c6c 7920 6361   # Optionally ca
-00003190: 7374 206f 626a 6563 7420 6474 7970 6573  st object dtypes
-000031a0: 2074 6f20 6070 7961 7272 6f77 6020 7374   to `pyarrow` st
-000031b0: 7269 6e67 730a 2020 2020 2020 2020 6966  rings.        if
-000031c0: 2064 6173 6b2e 636f 6e66 6967 2e67 6574   dask.config.get
-000031d0: 2822 6461 7461 6672 616d 652e 636f 6e76  ("dataframe.conv
-000031e0: 6572 742d 7374 7269 6e67 2229 3a0a 2020  ert-string"):.  
-000031f0: 2020 2020 2020 2020 2020 6672 6f6d 2064            from d
-00003200: 6173 6b2e 6461 7461 6672 616d 652e 5f70  ask.dataframe._p
-00003210: 7961 7272 6f77 2069 6d70 6f72 7420 6368  yarrow import ch
-00003220: 6563 6b5f 7079 6172 726f 775f 7374 7269  eck_pyarrow_stri
-00003230: 6e67 5f73 7570 706f 7274 6564 0a0a 2020  ng_supported..  
-00003240: 2020 2020 2020 2020 2020 6368 6563 6b5f            check_
-00003250: 7079 6172 726f 775f 7374 7269 6e67 5f73  pyarrow_string_s
-00003260: 7570 706f 7274 6564 2829 0a0a 2020 2020  upported()..    
-00003270: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-00003280: 6b2e 6461 7461 6672 616d 652e 5f70 7961  k.dataframe._pya
-00003290: 7272 6f77 2069 6d70 6f72 7420 280a 2020  rrow import (.  
-000032a0: 2020 2020 2020 2020 2020 2020 2020 6973                is
-000032b0: 5f6f 626a 6563 745f 7374 7269 6e67 5f64  _object_string_d
-000032c0: 6174 6166 7261 6d65 2c0a 2020 2020 2020  ataframe,.      
-000032d0: 2020 2020 2020 2020 2020 6973 5f6f 626a            is_obj
-000032e0: 6563 745f 7374 7269 6e67 5f64 7479 7065  ect_string_dtype
-000032f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00003300: 2020 6973 5f6f 626a 6563 745f 7374 7269    is_object_stri
-00003310: 6e67 5f69 6e64 6578 2c0a 2020 2020 2020  ng_index,.      
-00003320: 2020 2020 2020 2020 2020 6973 5f6f 626a            is_obj
-00003330: 6563 745f 7374 7269 6e67 5f73 6572 6965  ect_string_serie
-00003340: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00003350: 2020 2074 6f5f 7079 6172 726f 775f 7374     to_pyarrow_st
-00003360: 7269 6e67 2c0a 2020 2020 2020 2020 2020  ring,.          
-00003370: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-00003380: 2069 6620 280a 2020 2020 2020 2020 2020   if (.          
-00003390: 2020 2020 2020 6973 5f6f 626a 6563 745f        is_object_
-000033a0: 7374 7269 6e67 5f64 6174 6166 7261 6d65  string_dataframe
-000033b0: 286d 6574 6129 0a20 2020 2020 2020 2020  (meta).         
-000033c0: 2020 2020 2020 206f 7220 6973 5f6f 626a         or is_obj
-000033d0: 6563 745f 7374 7269 6e67 5f73 6572 6965  ect_string_serie
-000033e0: 7328 6d65 7461 290a 2020 2020 2020 2020  s(meta).        
-000033f0: 2020 2020 2020 2020 6f72 2069 735f 6f62          or is_ob
-00003400: 6a65 6374 5f73 7472 696e 675f 696e 6465  ject_string_inde
-00003410: 7828 6d65 7461 290a 2020 2020 2020 2020  x(meta).        
-00003420: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-00003430: 2020 2020 2020 2023 2050 7269 6f72 2074         # Prior t
-00003440: 6f20 7061 6e64 6173 3d31 2e34 2c20 6070  o pandas=1.4, `p
-00003450: 642e 496e 6465 7860 2063 6f75 6c64 6e27  d.Index` couldn'
-00003460: 7420 636f 6e74 6169 6e20 6578 7465 6e73  t contain extens
-00003470: 696f 6e20 6474 7970 6573 2e0a 2020 2020  ion dtypes..    
-00003480: 2020 2020 2020 2020 2020 2020 2320 4865              # He
-00003490: 7265 2077 6520 646f 6e27 7420 6361 7374  re we don't cast
-000034a0: 206f 626a 6563 7473 2074 6f20 7079 6172   objects to pyar
-000034b0: 726f 7720 7374 7269 6e67 7320 7768 6572  row strings wher
-000034c0: 6520 6f6e 6c79 2074 6865 2069 6e64 6578  e only the index
-000034d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000034e0: 2023 2063 6f6e 7461 696e 7320 6e6f 6e2d   # contains non-
-000034f0: 7079 6172 726f 7720 7374 7269 6e67 2064  pyarrow string d
-00003500: 6174 612e 0a20 2020 2020 2020 2020 2020  ata..           
-00003510: 2020 2020 2069 6620 6e6f 7420 5041 4e44       if not PAND
-00003520: 4153 5f47 545f 3134 3020 616e 6420 280a  AS_GT_140 and (.
-00003530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003540: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
-00003550: 2020 2020 2020 2020 2020 2020 2020 6973                is
-00003560: 5f6f 626a 6563 745f 7374 7269 6e67 5f64  _object_string_d
-00003570: 6174 6166 7261 6d65 286d 6574 6129 0a20  ataframe(meta). 
-00003580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003590: 2020 2020 2020 2061 6e64 206e 6f74 2061         and not a
-000035a0: 6e79 2869 735f 6f62 6a65 6374 5f73 7472  ny(is_object_str
-000035b0: 696e 675f 6474 7970 6528 6429 2066 6f72  ing_dtype(d) for
-000035c0: 2064 2069 6e20 6d65 7461 2e64 7479 7065   d in meta.dtype
-000035d0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-000035e0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000035f0: 2020 2020 2020 2020 2020 2020 206f 7220               or 
-00003600: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00003610: 2020 2020 2020 2020 2020 6973 5f6f 626a            is_obj
-00003620: 6563 745f 7374 7269 6e67 5f73 6572 6965  ect_string_serie
-00003630: 7328 6d65 7461 290a 2020 2020 2020 2020  s(meta).        
+00000240: 696d 706f 7274 2064 6173 6b2e 6172 7261  import dask.arra
+00000250: 7920 6173 2064 610a 6672 6f6d 2064 6173  y as da.from das
+00000260: 6b20 696d 706f 7274 2063 6f72 650a 6672  k import core.fr
+00000270: 6f6d 2064 6173 6b2e 6172 7261 792e 636f  om dask.array.co
+00000280: 7265 2069 6d70 6f72 7420 4172 7261 792c  re import Array,
+00000290: 206e 6f72 6d61 6c69 7a65 5f61 7267 0a66   normalize_arg.f
+000002a0: 726f 6d20 6461 736b 2e62 6167 2069 6d70  rom dask.bag imp
+000002b0: 6f72 7420 6d61 705f 7061 7274 6974 696f  ort map_partitio
+000002c0: 6e73 2061 7320 6d61 705f 6261 675f 7061  ns as map_bag_pa
+000002d0: 7274 6974 696f 6e73 0a66 726f 6d20 6461  rtitions.from da
+000002e0: 736b 2e62 6173 6520 696d 706f 7274 2028  sk.base import (
+000002f0: 0a20 2020 2044 6173 6b4d 6574 686f 6473  .    DaskMethods
+00000300: 4d69 7869 6e2c 0a20 2020 2064 6f6e 745f  Mixin,.    dont_
+00000310: 6f70 7469 6d69 7a65 2c0a 2020 2020 6973  optimize,.    is
+00000320: 5f64 6173 6b5f 636f 6c6c 6563 7469 6f6e  _dask_collection
+00000330: 2c0a 2020 2020 6e61 6d65 645f 7363 6865  ,.    named_sche
+00000340: 6475 6c65 7273 2c0a 2020 2020 746f 6b65  dulers,.    toke
+00000350: 6e69 7a65 2c0a 290a 6672 6f6d 2064 6173  nize,.).from das
+00000360: 6b2e 626c 6f63 6b77 6973 6520 696d 706f  k.blockwise impo
+00000370: 7274 2042 6c6f 636b 7769 7365 2c20 426c  rt Blockwise, Bl
+00000380: 6f63 6b77 6973 6544 6570 2c20 426c 6f63  ockwiseDep, Bloc
+00000390: 6b77 6973 6544 6570 4469 6374 2c20 626c  kwiseDepDict, bl
+000003a0: 6f63 6b77 6973 650a 6672 6f6d 2064 6173  ockwise.from das
+000003b0: 6b2e 636f 6e74 6578 7420 696d 706f 7274  k.context import
+000003c0: 2067 6c6f 6261 6c6d 6574 686f 640a 6672   globalmethod.fr
+000003d0: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
+000003e0: 6520 696d 706f 7274 206d 6574 686f 6473  e import methods
+000003f0: 0a66 726f 6d20 6461 736b 2e64 6174 6166  .from dask.dataf
+00000400: 7261 6d65 2e5f 636f 6d70 6174 2069 6d70  rame._compat imp
+00000410: 6f72 7420 280a 2020 2020 5041 4e44 4153  ort (.    PANDAS
+00000420: 5f47 545f 3134 302c 0a20 2020 2050 414e  _GT_140,.    PAN
+00000430: 4441 535f 4754 5f31 3530 2c0a 2020 2020  DAS_GT_150,.    
+00000440: 5041 4e44 4153 5f47 545f 3230 302c 0a20  PANDAS_GT_200,. 
+00000450: 2020 2050 414e 4441 535f 4754 5f32 3130     PANDAS_GT_210
+00000460: 2c0a 2020 2020 5041 4e44 4153 5f56 4552  ,.    PANDAS_VER
+00000470: 5349 4f4e 2c0a 2020 2020 6368 6563 6b5f  SION,.    check_
+00000480: 636f 6e76 6572 745f 6474 7970 655f 6465  convert_dtype_de
+00000490: 7072 6563 6174 696f 6e2c 0a20 2020 2063  precation,.    c
+000004a0: 6865 636b 5f6e 7569 7361 6e63 655f 636f  heck_nuisance_co
+000004b0: 6c75 6d6e 735f 7761 726e 696e 672c 0a20  lumns_warning,. 
+000004c0: 2020 2063 6865 636b 5f6e 756d 6572 6963     check_numeric
+000004d0: 5f6f 6e6c 795f 6465 7072 6563 6174 696f  _only_deprecatio
+000004e0: 6e2c 0a20 2020 2063 6865 636b 5f72 6564  n,.    check_red
+000004f0: 7563 7469 6f6e 735f 7275 6e74 696d 655f  uctions_runtime_
+00000500: 7761 726e 696e 672c 0a20 2020 2069 735f  warning,.    is_
+00000510: 7374 7269 6e67 5f64 7479 7065 2c0a 290a  string_dtype,.).
+00000520: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
+00000530: 616d 652e 6163 6365 7373 6f72 2069 6d70  ame.accessor imp
+00000540: 6f72 7420 4361 6368 6564 4163 6365 7373  ort CachedAccess
+00000550: 6f72 2c20 4461 7465 7469 6d65 4163 6365  or, DatetimeAcce
+00000560: 7373 6f72 2c20 5374 7269 6e67 4163 6365  ssor, StringAcce
+00000570: 7373 6f72 0a66 726f 6d20 6461 736b 2e64  ssor.from dask.d
+00000580: 6174 6166 7261 6d65 2e63 6174 6567 6f72  ataframe.categor
+00000590: 6963 616c 2069 6d70 6f72 7420 4361 7465  ical import Cate
+000005a0: 676f 7269 6361 6c41 6363 6573 736f 722c  goricalAccessor,
+000005b0: 2063 6174 6567 6f72 697a 650a 6672 6f6d   categorize.from
+000005c0: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
+000005d0: 6469 7370 6174 6368 2069 6d70 6f72 7420  dispatch import 
+000005e0: 280a 2020 2020 6765 745f 7061 7261 6c6c  (.    get_parall
+000005f0: 656c 5f74 7970 652c 0a20 2020 2067 726f  el_type,.    gro
+00000600: 7570 5f73 706c 6974 5f64 6973 7061 7463  up_split_dispatc
+00000610: 682c 0a20 2020 2068 6173 685f 6f62 6a65  h,.    hash_obje
+00000620: 6374 5f64 6973 7061 7463 682c 0a20 2020  ct_dispatch,.   
+00000630: 206d 6574 615f 6e6f 6e65 6d70 7479 2c0a   meta_nonempty,.
+00000640: 290a 6672 6f6d 2064 6173 6b2e 6461 7461  ).from dask.data
+00000650: 6672 616d 652e 6f70 7469 6d69 7a65 2069  frame.optimize i
+00000660: 6d70 6f72 7420 6f70 7469 6d69 7a65 0a66  mport optimize.f
+00000670: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
+00000680: 6d65 2e75 7469 6c73 2069 6d70 6f72 7420  me.utils import 
+00000690: 280a 2020 2020 4174 7472 6962 7574 654e  (.    AttributeN
+000006a0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+000006b0: 6f72 2c0a 2020 2020 6368 6563 6b5f 6d61  or,.    check_ma
+000006c0: 7463 6869 6e67 5f63 6f6c 756d 6e73 2c0a  tching_columns,.
+000006d0: 2020 2020 6368 6563 6b5f 6e75 6d65 7269      check_numeri
+000006e0: 635f 6f6e 6c79 5f76 616c 6964 2c0a 2020  c_only_valid,.  
+000006f0: 2020 636c 6561 725f 6b6e 6f77 6e5f 6361    clear_known_ca
+00000700: 7465 676f 7269 6573 2c0a 2020 2020 6472  tegories,.    dr
+00000710: 6f70 5f62 795f 7368 616c 6c6f 775f 636f  op_by_shallow_co
+00000720: 7079 2c0a 2020 2020 6765 745f 6e75 6d65  py,.    get_nume
+00000730: 7269 635f 6f6e 6c79 5f6b 7761 7267 732c  ric_only_kwargs,
+00000740: 0a20 2020 2068 6173 5f6b 6e6f 776e 5f63  .    has_known_c
+00000750: 6174 6567 6f72 6965 732c 0a20 2020 2069  ategories,.    i
+00000760: 6e64 6578 5f73 756d 6d61 7279 2c0a 2020  ndex_summary,.  
+00000770: 2020 696e 7365 7274 5f6d 6574 615f 7061    insert_meta_pa
+00000780: 7261 6d5f 6465 7363 7269 7074 696f 6e2c  ram_description,
+00000790: 0a20 2020 2069 735f 6461 7461 6672 616d  .    is_datafram
+000007a0: 655f 6c69 6b65 2c0a 2020 2020 6973 5f69  e_like,.    is_i
+000007b0: 6e64 6578 5f6c 696b 652c 0a20 2020 2069  ndex_like,.    i
+000007c0: 735f 7365 7269 6573 5f6c 696b 652c 0a20  s_series_like,. 
+000007d0: 2020 206d 616b 655f 6d65 7461 2c0a 2020     make_meta,.  
+000007e0: 2020 6d65 7461 5f66 7261 6d65 5f63 6f6e    meta_frame_con
+000007f0: 7374 7275 6374 6f72 2c0a 2020 2020 6d65  structor,.    me
+00000800: 7461 5f73 6572 6965 735f 636f 6e73 7472  ta_series_constr
+00000810: 7563 746f 722c 0a20 2020 2070 7961 7272  uctor,.    pyarr
+00000820: 6f77 5f73 7472 696e 6773 5f65 6e61 626c  ow_strings_enabl
+00000830: 6564 2c0a 2020 2020 7261 6973 655f 6f6e  ed,.    raise_on
+00000840: 5f6d 6574 615f 6572 726f 722c 0a20 2020  _meta_error,.   
+00000850: 2076 616c 6964 5f64 6976 6973 696f 6e73   valid_divisions
+00000860: 2c0a 290a 6672 6f6d 2064 6173 6b2e 6465  ,.).from dask.de
+00000870: 6c61 7965 6420 696d 706f 7274 2044 656c  layed import Del
+00000880: 6179 6564 2c20 6465 6c61 7965 642c 2075  ayed, delayed, u
+00000890: 6e70 6163 6b5f 636f 6c6c 6563 7469 6f6e  npack_collection
+000008a0: 730a 6672 6f6d 2064 6173 6b2e 6869 6768  s.from dask.high
+000008b0: 6c65 7665 6c67 7261 7068 2069 6d70 6f72  levelgraph impor
+000008c0: 7420 4869 6768 4c65 7665 6c47 7261 7068  t HighLevelGraph
+000008d0: 0a66 726f 6d20 6461 736b 2e6c 6179 6572  .from dask.layer
+000008e0: 7320 696d 706f 7274 2044 6174 6146 7261  s import DataFra
+000008f0: 6d65 5472 6565 5265 6475 6374 696f 6e0a  meTreeReduction.
+00000900: 6672 6f6d 2064 6173 6b2e 7574 696c 7320  from dask.utils 
+00000910: 696d 706f 7274 2028 0a20 2020 2049 6e64  import (.    Ind
+00000920: 6578 4361 6c6c 6162 6c65 2c0a 2020 2020  exCallable,.    
+00000930: 4d2c 0a20 2020 204f 7065 7261 746f 724d  M,.    OperatorM
+00000940: 6574 686f 644d 6978 696e 2c0a 2020 2020  ethodMixin,.    
+00000950: 5f64 6570 7265 6361 7465 642c 0a20 2020  _deprecated,.   
+00000960: 2061 7070 6c79 2c0a 2020 2020 6465 7269   apply,.    deri
+00000970: 7665 645f 6672 6f6d 2c0a 2020 2020 6675  ved_from,.    fu
+00000980: 6e63 6e61 6d65 2c0a 2020 2020 6765 745f  ncname,.    get_
+00000990: 6d65 7461 5f6c 6962 7261 7279 2c0a 2020  meta_library,.  
+000009a0: 2020 6861 735f 6b65 7977 6f72 642c 0a20    has_keyword,. 
+000009b0: 2020 2069 735f 6172 7261 796c 696b 652c     is_arraylike,
+000009c0: 0a20 2020 2069 7465 725f 6368 756e 6b73  .    iter_chunks
+000009d0: 2c0a 2020 2020 6b65 795f 7370 6c69 742c  ,.    key_split,
+000009e0: 0a20 2020 206d 6179 6265 5f70 6c75 7261  .    maybe_plura
+000009f0: 6c69 7a65 2c0a 2020 2020 6d65 6d6f 7279  lize,.    memory
+00000a00: 5f72 6570 722c 0a20 2020 2070 6172 7365  _repr,.    parse
+00000a10: 5f62 7974 6573 2c0a 2020 2020 7061 7274  _bytes,.    part
+00000a20: 6961 6c5f 6279 5f6f 7264 6572 2c0a 2020  ial_by_order,.  
+00000a30: 2020 7073 6575 646f 7261 6e64 6f6d 2c0a    pseudorandom,.
+00000a40: 2020 2020 7075 745f 6c69 6e65 732c 0a20      put_lines,. 
+00000a50: 2020 2072 616e 646f 6d5f 7374 6174 655f     random_state_
+00000a60: 6461 7461 2c0a 2020 2020 7479 7065 6e61  data,.    typena
+00000a70: 6d65 2c0a 290a 6672 6f6d 2064 6173 6b2e  me,.).from dask.
+00000a80: 7769 6467 6574 7320 696d 706f 7274 2067  widgets import g
+00000a90: 6574 5f74 656d 706c 6174 650a 0a44 4546  et_template..DEF
+00000aa0: 4155 4c54 5f47 4554 203d 206e 616d 6564  AULT_GET = named
+00000ab0: 5f73 6368 6564 756c 6572 732e 6765 7428  _schedulers.get(
+00000ac0: 2274 6872 6561 6473 222c 206e 616d 6564  "threads", named
+00000ad0: 5f73 6368 6564 756c 6572 735b 2273 796e  _schedulers["syn
+00000ae0: 6322 5d29 0a0a 6e6f 5f64 6566 6175 6c74  c"])..no_default
+00000af0: 203d 2022 5f5f 6e6f 5f64 6566 6175 6c74   = "__no_default
+00000b00: 5f5f 220a 0a47 524f 5550 5f4b 4559 535f  __"..GROUP_KEYS_
+00000b10: 4445 4641 554c 543a 2062 6f6f 6c20 7c20  DEFAULT: bool | 
+00000b20: 4e6f 6e65 203d 2054 7275 650a 6966 2050  None = True.if P
+00000b30: 414e 4441 535f 4754 5f31 3530 2061 6e64  ANDAS_GT_150 and
+00000b40: 206e 6f74 2050 414e 4441 535f 4754 5f32   not PANDAS_GT_2
+00000b50: 3030 3a0a 2020 2020 4752 4f55 505f 4b45  00:.    GROUP_KE
+00000b60: 5953 5f44 4546 4155 4c54 203d 204e 6f6e  YS_DEFAULT = Non
+00000b70: 650a 0a70 642e 7365 745f 6f70 7469 6f6e  e..pd.set_option
+00000b80: 2822 636f 6d70 7574 652e 7573 655f 6e75  ("compute.use_nu
+00000b90: 6d65 7870 7222 2c20 4661 6c73 6529 0a0a  mexpr", False)..
+00000ba0: 0a64 6566 205f 6e75 6d65 7269 635f 6f6e  .def _numeric_on
+00000bb0: 6c79 2866 756e 6329 3a0a 2020 2020 2222  ly(func):.    ""
+00000bc0: 2244 6563 6f72 6174 6f72 2066 6f72 206d  "Decorator for m
+00000bd0: 6574 686f 6473 2074 6861 7420 6163 6365  ethods that acce
+00000be0: 7074 2061 206e 756d 6572 6963 5f6f 6e6c  pt a numeric_onl
+00000bf0: 7920 6b77 6172 6722 2222 0a0a 2020 2020  y kwarg"""..    
+00000c00: 4077 7261 7073 2866 756e 6329 0a20 2020  @wraps(func).   
+00000c10: 2064 6566 2077 7261 7070 6572 2873 656c   def wrapper(sel
+00000c20: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
+00000c30: 6773 293a 0a20 2020 2020 2020 2023 206e  gs):.        # n
+00000c40: 756d 6572 6963 5f6f 6e6c 7920 6973 204e  umeric_only is N
+00000c50: 6f6e 6520 6279 2064 6566 6175 6c74 202d  one by default -
+00000c60: 2069 6e20 7468 6174 2063 6173 6520 7365   in that case se
+00000c70: 6c66 203d 2073 656c 662e 0a20 2020 2020  lf = self..     
+00000c80: 2020 2069 6620 6b77 6172 6773 2e67 6574     if kwargs.get
+00000c90: 2822 6e75 6d65 7269 635f 6f6e 6c79 2229  ("numeric_only")
+00000ca0: 2069 7320 4661 6c73 653a 0a20 2020 2020   is False:.     
+00000cb0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+00000cc0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+00000cd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00000ce0: 2020 2227 6e75 6d65 7269 635f 6f6e 6c79    "'numeric_only
+00000cf0: 3d46 616c 7365 2720 6973 206e 6f74 2069  =False' is not i
+00000d00: 6d70 6c65 6d65 6e74 6564 2069 6e20 4461  mplemented in Da
+00000d10: 736b 2e22 0a20 2020 2020 2020 2020 2020  sk.".           
+00000d20: 2029 0a20 2020 2020 2020 2065 6c69 6620   ).        elif 
+00000d30: 6b77 6172 6773 2e67 6574 2822 6e75 6d65  kwargs.get("nume
+00000d40: 7269 635f 6f6e 6c79 2229 2069 7320 5472  ric_only") is Tr
+00000d50: 7565 3a0a 2020 2020 2020 2020 2020 2020  ue:.            
+00000d60: 7365 6c66 203d 2073 656c 662e 5f67 6574  self = self._get
+00000d70: 5f6e 756d 6572 6963 5f64 6174 6128 290a  _numeric_data().
+00000d80: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+00000d90: 756e 6328 7365 6c66 2c20 2a61 7267 732c  unc(self, *args,
+00000da0: 202a 2a6b 7761 7267 7329 0a0a 2020 2020   **kwargs)..    
+00000db0: 7265 7475 726e 2077 7261 7070 6572 0a0a  return wrapper..
+00000dc0: 0a64 6566 205f 6e75 6d65 7269 635f 6461  .def _numeric_da
+00000dd0: 7461 2866 756e 6329 3a0a 2020 2020 2222  ta(func):.    ""
+00000de0: 224d 6f64 6966 6965 6420 7665 7273 696f  "Modified versio
+00000df0: 6e20 6f66 2074 6865 2061 626f 7665 2064  n of the above d
+00000e00: 6563 6f72 6174 6f72 2c20 7269 6768 7420  ecorator, right 
+00000e10: 6e6f 7720 6f6e 6c79 2075 7365 6420 7769  now only used wi
+00000e20: 7468 2073 7464 2e20 5765 2064 6f6e 2774  th std. We don't
+00000e30: 0a20 2020 206e 6565 6420 7261 6973 696e  .    need raisin
+00000e40: 6720 4e6f 7449 6d70 6c65 6d65 6e74 6564  g NotImplemented
+00000e50: 4572 726f 7220 7468 6572 652c 2062 6563  Error there, bec
+00000e60: 6175 7365 2069 7427 7320 6861 6e64 6c65  ause it's handle
+00000e70: 6420 6279 0a20 2020 205f 6e75 6d65 7269  d by.    _numeri
+00000e80: 635f 6f6e 6c79 5f6d 6179 6265 5f77 6172  c_only_maybe_war
+00000e90: 6e20 696e 7374 6561 642e 2054 6869 7320  n instead. This 
+00000ea0: 6973 2061 2074 656d 706f 7261 7279 2073  is a temporary s
+00000eb0: 6f6c 7574 696f 6e20 7468 6174 206e 6565  olution that nee
+00000ec0: 6473 0a20 2020 206d 6f72 6520 7469 6d65  ds.    more time
+00000ed0: 2074 6f20 6265 2067 656e 6572 616c 697a   to be generaliz
+00000ee0: 6564 2e22 2222 0a0a 2020 2020 4077 7261  ed."""..    @wra
+00000ef0: 7073 2866 756e 6329 0a20 2020 2064 6566  ps(func).    def
+00000f00: 2077 7261 7070 6572 2873 656c 662c 202a   wrapper(self, *
+00000f10: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
+00000f20: 0a20 2020 2020 2020 2069 6620 6b77 6172  .        if kwar
+00000f30: 6773 2e67 6574 2822 6e75 6d65 7269 635f  gs.get("numeric_
+00000f40: 6f6e 6c79 2229 2069 7320 5472 7565 3a0a  only") is True:.
+00000f50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00000f60: 203d 2073 656c 662e 5f67 6574 5f6e 756d   = self._get_num
+00000f70: 6572 6963 5f64 6174 6128 290a 2020 2020  eric_data().    
+00000f80: 2020 2020 7265 7475 726e 2066 756e 6328      return func(
+00000f90: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+00000fa0: 7761 7267 7329 0a0a 2020 2020 7265 7475  wargs)..    retu
+00000fb0: 726e 2077 7261 7070 6572 0a0a 0a64 6566  rn wrapper...def
+00000fc0: 205f 6e75 6d65 7269 635f 6f6e 6c79 5f6d   _numeric_only_m
+00000fd0: 6179 6265 5f77 6172 6e28 6466 2c20 6e75  aybe_warn(df, nu
+00000fe0: 6d65 7269 635f 6f6e 6c79 2c20 6465 6661  meric_only, defa
+00000ff0: 756c 743d 4e6f 6e65 293a 0a20 2020 2022  ult=None):.    "
+00001000: 2222 5570 6461 7465 206e 756d 6572 6963  ""Update numeric
+00001010: 5f6f 6e6c 7920 746f 2067 6574 2072 6964  _only to get rid
+00001020: 206f 6620 6e6f 5f64 6566 6175 6c74 2c20   of no_default, 
+00001030: 616e 6420 706f 7373 6962 6c79 2077 6172  and possibly war
+00001040: 6e20 6162 6f75 7420 6465 6661 756c 7420  n about default 
+00001050: 7661 6c75 652e 0a20 2020 2054 4f44 4f3a  value..    TODO:
+00001060: 2073 686f 756c 6420 6d6f 7665 2074 6f20   should move to 
+00001070: 6e75 6d65 7269 635f 6f6e 6c79 2064 6563  numeric_only dec
+00001080: 6f72 6174 6f72 2e20 5365 6520 6874 7470  orator. See http
+00001090: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f64  s://github.com/d
+000010a0: 6173 6b2f 6461 736b 2f70 756c 6c2f 3939  ask/dask/pull/99
+000010b0: 3532 0a20 2020 2022 2222 0a20 2020 2069  52.    """.    i
+000010c0: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
+000010d0: 696b 6528 6466 293a 0a20 2020 2020 2020  ike(df):.       
+000010e0: 2077 6172 6e5f 6e75 6d65 7269 635f 6f6e   warn_numeric_on
+000010f0: 6c79 203d 2046 616c 7365 0a20 2020 2020  ly = False.     
+00001100: 2020 2069 6620 6e75 6d65 7269 635f 6f6e     if numeric_on
+00001110: 6c79 2069 7320 6e6f 5f64 6566 6175 6c74  ly is no_default
+00001120: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00001130: 2050 414e 4441 535f 4754 5f32 3030 3a0a   PANDAS_GT_200:.
+00001140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001150: 6e75 6d65 7269 635f 6f6e 6c79 203d 2046  numeric_only = F
+00001160: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+00001170: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00001180: 2020 2020 2020 2077 6172 6e5f 6e75 6d65         warn_nume
+00001190: 7269 635f 6f6e 6c79 203d 2054 7275 650a  ric_only = True.
+000011a0: 0a20 2020 2020 2020 206e 756d 6572 6963  .        numeric
+000011b0: 7320 3d20 6466 2e5f 6d65 7461 2e5f 6765  s = df._meta._ge
+000011c0: 745f 6e75 6d65 7269 635f 6461 7461 2829  t_numeric_data()
+000011d0: 0a20 2020 2020 2020 2068 6173 5f6e 6f6e  .        has_non
+000011e0: 5f6e 756d 6572 6963 7320 3d20 6c65 6e28  _numerics = len(
+000011f0: 6e75 6d65 7269 6373 2e63 6f6c 756d 6e73  numerics.columns
+00001200: 2920 3c20 6c65 6e28 6466 2e5f 6d65 7461  ) < len(df._meta
+00001210: 2e63 6f6c 756d 6e73 290a 2020 2020 2020  .columns).      
+00001220: 2020 6966 2068 6173 5f6e 6f6e 5f6e 756d    if has_non_num
+00001230: 6572 6963 733a 0a20 2020 2020 2020 2020  erics:.         
+00001240: 2020 2069 6620 6e75 6d65 7269 635f 6f6e     if numeric_on
+00001250: 6c79 2069 7320 4661 6c73 653a 0a20 2020  ly is False:.   
+00001260: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00001270: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+00001280: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
+00001290: 2020 2020 2020 2020 2020 2020 2227 6e75              "'nu
+000012a0: 6d65 7269 635f 6f6e 6c79 3d46 616c 7365  meric_only=False
+000012b0: 2720 6973 206e 6f74 2069 6d70 6c65 6d65  ' is not impleme
+000012c0: 6e74 6564 2069 6e20 4461 736b 2e22 0a20  nted in Dask.". 
+000012d0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000012e0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+000012f0: 6620 7761 726e 5f6e 756d 6572 6963 5f6f  f warn_numeric_o
+00001300: 6e6c 793a 0a20 2020 2020 2020 2020 2020  nly:.           
+00001310: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+00001320: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+00001330: 2020 2020 2020 2020 2254 6865 2064 6566          "The def
+00001340: 6175 6c74 2076 616c 7565 206f 6620 6e75  ault value of nu
+00001350: 6d65 7269 635f 6f6e 6c79 2069 6e20 6461  meric_only in da
+00001360: 736b 2077 696c 6c20 6265 2063 6861 6e67  sk will be chang
+00001370: 6564 2074 6f20 4661 6c73 6520 696e 2022  ed to False in "
+00001380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001390: 2020 2020 2022 7468 6520 6675 7475 7265       "the future
+000013a0: 2077 6865 6e20 7573 696e 6720 6461 736b   when using dask
+000013b0: 2077 6974 6820 7061 6e64 6173 2032 2e30   with pandas 2.0
+000013c0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000013d0: 2020 2020 2020 2046 7574 7572 6557 6172         FutureWar
+000013e0: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
+000013f0: 2020 2020 2020 290a 2020 2020 6966 206e        ).    if n
+00001400: 756d 6572 6963 5f6f 6e6c 7920 6973 206e  umeric_only is n
+00001410: 6f5f 6465 6661 756c 7420 616e 6420 6465  o_default and de
+00001420: 6661 756c 7420 6973 206e 6f74 204e 6f6e  fault is not Non
+00001430: 653a 0a20 2020 2020 2020 206e 756d 6572  e:.        numer
+00001440: 6963 5f6f 6e6c 7920 3d20 6465 6661 756c  ic_only = defaul
+00001450: 740a 2020 2020 7265 7475 726e 207b 7d20  t.    return {} 
+00001460: 6966 206e 756d 6572 6963 5f6f 6e6c 7920  if numeric_only 
+00001470: 6973 206e 6f5f 6465 6661 756c 7420 656c  is no_default el
+00001480: 7365 207b 226e 756d 6572 6963 5f6f 6e6c  se {"numeric_onl
+00001490: 7922 3a20 6e75 6d65 7269 635f 6f6e 6c79  y": numeric_only
+000014a0: 7d0a 0a0a 6465 6620 5f63 6f6e 6361 7428  }...def _concat(
+000014b0: 6172 6773 2c20 6967 6e6f 7265 5f69 6e64  args, ignore_ind
+000014c0: 6578 3d46 616c 7365 293a 0a20 2020 2069  ex=False):.    i
+000014d0: 6620 6e6f 7420 6172 6773 3a0a 2020 2020  f not args:.    
+000014e0: 2020 2020 7265 7475 726e 2061 7267 730a      return args.
+000014f0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00001500: 6528 6669 7273 7428 636f 7265 2e66 6c61  e(first(core.fla
+00001510: 7474 656e 2861 7267 7329 292c 206e 702e  tten(args)), np.
+00001520: 6e64 6172 7261 7929 3a0a 2020 2020 2020  ndarray):.      
+00001530: 2020 7265 7475 726e 2064 612e 636f 7265    return da.core
+00001540: 2e63 6f6e 6361 7465 6e61 7465 3328 6172  .concatenate3(ar
+00001550: 6773 290a 2020 2020 6966 206e 6f74 2068  gs).    if not h
+00001560: 6173 5f70 6172 616c 6c65 6c5f 7479 7065  as_parallel_type
+00001570: 2861 7267 735b 305d 293a 0a20 2020 2020  (args[0]):.     
+00001580: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00001590: 2020 2020 7265 7475 726e 2070 642e 5365      return pd.Se
+000015a0: 7269 6573 2861 7267 7329 0a20 2020 2020  ries(args).     
+000015b0: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
+000015c0: 696f 6e3a 0a20 2020 2020 2020 2020 2020  ion:.           
+000015d0: 2072 6574 7572 6e20 6172 6773 0a20 2020   return args.   
+000015e0: 2023 2057 6520 6669 6c74 6572 206f 7574   # We filter out
+000015f0: 2065 6d70 7479 2070 6172 7469 7469 6f6e   empty partition
+00001600: 7320 6865 7265 2062 6563 6175 7365 2070  s here because p
+00001610: 616e 6461 7320 6672 6571 7565 6e74 6c79  andas frequently
+00001620: 2068 6173 0a20 2020 2023 2069 6e63 6f6e   has.    # incon
+00001630: 7369 7374 656e 7420 6474 7970 6573 2069  sistent dtypes i
+00001640: 6e20 7265 7375 6c74 7320 6265 7477 6565  n results betwee
+00001650: 6e20 656d 7074 7920 616e 6420 6e6f 6e2d  n empty and non-
+00001660: 656d 7074 7920 6672 616d 6573 2e0a 2020  empty frames..  
+00001670: 2020 2320 4964 6561 6c6c 7920 7468 6973    # Ideally this
+00001680: 2077 6f75 6c64 2062 6520 6861 6e64 6c65   would be handle
+00001690: 6420 6c6f 6361 6c6c 7920 666f 7220 6561  d locally for ea
+000016a0: 6368 206f 7065 7261 7469 6f6e 2c20 6275  ch operation, bu
+000016b0: 7420 696e 2070 7261 6374 6963 650a 2020  t in practice.  
+000016c0: 2020 2320 7468 6973 2073 6565 6d73 2065    # this seems e
+000016d0: 6173 6965 722e 2054 4f44 4f3a 2064 6f6e  asier. TODO: don
+000016e0: 2774 2064 6f20 7468 6973 2e0a 2020 2020  't do this..    
+000016f0: 6172 6773 3220 3d20 5b69 2066 6f72 2069  args2 = [i for i
+00001700: 2069 6e20 6172 6773 2069 6620 6c65 6e28   in args if len(
+00001710: 6929 5d0a 2020 2020 7265 7475 726e 2028  i)].    return (
+00001720: 0a20 2020 2020 2020 2061 7267 735b 305d  .        args[0]
+00001730: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00001740: 6172 6773 320a 2020 2020 2020 2020 656c  args2.        el
+00001750: 7365 206d 6574 686f 6473 2e63 6f6e 6361  se methods.conca
+00001760: 7428 6172 6773 322c 2075 6e69 666f 726d  t(args2, uniform
+00001770: 3d54 7275 652c 2069 676e 6f72 655f 696e  =True, ignore_in
+00001780: 6465 783d 6967 6e6f 7265 5f69 6e64 6578  dex=ignore_index
+00001790: 290a 2020 2020 290a 0a0a 6465 6620 6669  ).    )...def fi
+000017a0: 6e61 6c69 7a65 2872 6573 756c 7473 293a  nalize(results):
+000017b0: 0a20 2020 2072 6574 7572 6e20 5f63 6f6e  .    return _con
+000017c0: 6361 7428 7265 7375 6c74 7329 0a0a 0a63  cat(results)...c
+000017d0: 6c61 7373 2053 6361 6c61 7228 4461 736b  lass Scalar(Dask
+000017e0: 4d65 7468 6f64 734d 6978 696e 2c20 4f70  MethodsMixin, Op
+000017f0: 6572 6174 6f72 4d65 7468 6f64 4d69 7869  eratorMethodMixi
+00001800: 6e29 3a0a 2020 2020 2222 2241 2044 6173  n):.    """A Das
+00001810: 6b20 6f62 6a65 6374 2074 6f20 7265 7072  k object to repr
+00001820: 6573 656e 7420 6120 7061 6e64 6173 2073  esent a pandas s
+00001830: 6361 6c61 7222 2222 0a0a 2020 2020 6465  calar"""..    de
+00001840: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
+00001850: 2064 736b 2c20 6e61 6d65 2c20 6d65 7461   dsk, name, meta
+00001860: 2c20 6469 7669 7369 6f6e 733d 4e6f 6e65  , divisions=None
+00001870: 293a 0a20 2020 2020 2020 2023 2064 6976  ):.        # div
+00001880: 6973 696f 6e73 2069 7320 6967 6e6f 7265  isions is ignore
+00001890: 642c 206f 6e6c 7920 7072 6573 656e 7420  d, only present 
+000018a0: 746f 2062 6520 636f 6d70 6174 6962 6c65  to be compatible
+000018b0: 2077 6974 6820 6f74 6865 720a 2020 2020   with other.    
+000018c0: 2020 2020 2320 6f62 6a65 6374 732e 0a20      # objects.. 
+000018d0: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+000018e0: 696e 7374 616e 6365 2864 736b 2c20 4869  instance(dsk, Hi
+000018f0: 6768 4c65 7665 6c47 7261 7068 293a 0a20  ghLevelGraph):. 
+00001900: 2020 2020 2020 2020 2020 2064 736b 203d             dsk =
+00001910: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
+00001920: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
+00001930: 286e 616d 652c 2064 736b 2c20 6465 7065  (name, dsk, depe
+00001940: 6e64 656e 6369 6573 3d5b 5d29 0a20 2020  ndencies=[]).   
+00001950: 2020 2020 2073 656c 662e 6461 736b 203d       self.dask =
+00001960: 2064 736b 0a20 2020 2020 2020 2073 656c   dsk.        sel
+00001970: 662e 5f6e 616d 6520 3d20 6e61 6d65 0a20  f._name = name. 
+00001980: 2020 2020 2020 2073 656c 662e 5f70 6172         self._par
+00001990: 656e 745f 6d65 7461 203d 2070 642e 5365  ent_meta = pd.Se
+000019a0: 7269 6573 2864 7479 7065 3d22 666c 6f61  ries(dtype="floa
+000019b0: 7436 3422 290a 0a20 2020 2020 2020 206d  t64")..        m
+000019c0: 6574 6120 3d20 6d61 6b65 5f6d 6574 6128  eta = make_meta(
+000019d0: 6d65 7461 2c20 7061 7265 6e74 5f6d 6574  meta, parent_met
+000019e0: 613d 7365 6c66 2e5f 7061 7265 6e74 5f6d  a=self._parent_m
+000019f0: 6574 6129 0a20 2020 2020 2020 2069 6620  eta).        if 
+00001a00: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+00001a10: 6528 6d65 7461 2920 6f72 2069 735f 7365  e(meta) or is_se
+00001a20: 7269 6573 5f6c 696b 6528 6d65 7461 2920  ries_like(meta) 
+00001a30: 6f72 2069 735f 696e 6465 785f 6c69 6b65  or is_index_like
+00001a40: 286d 6574 6129 3a0a 2020 2020 2020 2020  (meta):.        
+00001a50: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00001a60: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+00001a70: 2020 2020 2066 2245 7870 6563 7465 6420       f"Expected 
+00001a80: 6d65 7461 2074 6f20 7370 6563 6966 7920  meta to specify 
+00001a90: 7363 616c 6172 2c20 676f 7420 7b74 7970  scalar, got {typ
+00001aa0: 656e 616d 6528 7479 7065 286d 6574 6129  ename(type(meta)
+00001ab0: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+00001ac0: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+00001ad0: 6d65 7461 203d 206d 6574 610a 0a20 2020  meta = meta..   
+00001ae0: 2064 6566 205f 5f64 6173 6b5f 6772 6170   def __dask_grap
+00001af0: 685f 5f28 7365 6c66 293a 0a20 2020 2020  h__(self):.     
+00001b00: 2020 2072 6574 7572 6e20 7365 6c66 2e64     return self.d
+00001b10: 6173 6b0a 0a20 2020 2064 6566 205f 5f64  ask..    def __d
+00001b20: 6173 6b5f 6b65 7973 5f5f 2873 656c 6629  ask_keys__(self)
+00001b30: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00001b40: 205b 7365 6c66 2e6b 6579 5d0a 0a20 2020   [self.key]..   
+00001b50: 2064 6566 205f 5f64 6173 6b5f 746f 6b65   def __dask_toke
+00001b60: 6e69 7a65 5f5f 2873 656c 6629 3a0a 2020  nize__(self):.  
+00001b70: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00001b80: 662e 5f6e 616d 650a 0a20 2020 2064 6566  f._name..    def
+00001b90: 205f 5f64 6173 6b5f 6c61 7965 7273 5f5f   __dask_layers__
+00001ba0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00001bb0: 7265 7475 726e 2028 7365 6c66 2e5f 6e61  return (self._na
+00001bc0: 6d65 2c29 0a0a 2020 2020 5f5f 6461 736b  me,)..    __dask
+00001bd0: 5f6f 7074 696d 697a 655f 5f20 3d20 676c  _optimize__ = gl
+00001be0: 6f62 616c 6d65 7468 6f64 280a 2020 2020  obalmethod(.    
+00001bf0: 2020 2020 6f70 7469 6d69 7a65 2c20 6b65      optimize, ke
+00001c00: 793d 2264 6174 6166 7261 6d65 5f6f 7074  y="dataframe_opt
+00001c10: 696d 697a 6522 2c20 6661 6c73 6579 3d64  imize", falsey=d
+00001c20: 6f6e 745f 6f70 7469 6d69 7a65 0a20 2020  ont_optimize.   
+00001c30: 2029 0a20 2020 205f 5f64 6173 6b5f 7363   ).    __dask_sc
+00001c40: 6865 6475 6c65 725f 5f20 3d20 7374 6174  heduler__ = stat
+00001c50: 6963 6d65 7468 6f64 2844 4546 4155 4c54  icmethod(DEFAULT
+00001c60: 5f47 4554 290a 0a20 2020 2064 6566 205f  _GET)..    def _
+00001c70: 5f64 6173 6b5f 706f 7374 636f 6d70 7574  _dask_postcomput
+00001c80: 655f 5f28 7365 6c66 293a 0a20 2020 2020  e__(self):.     
+00001c90: 2020 2072 6574 7572 6e20 6669 7273 742c     return first,
+00001ca0: 2028 290a 0a20 2020 2064 6566 205f 5f64   ()..    def __d
+00001cb0: 6173 6b5f 706f 7374 7065 7273 6973 745f  ask_postpersist_
+00001cc0: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00001cd0: 2072 6574 7572 6e20 7365 6c66 2e5f 7265   return self._re
+00001ce0: 6275 696c 642c 2028 290a 0a20 2020 2064  build, ()..    d
+00001cf0: 6566 205f 7265 6275 696c 6428 7365 6c66  ef _rebuild(self
+00001d00: 2c20 6473 6b2c 202a 2c20 7265 6e61 6d65  , dsk, *, rename
+00001d10: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00001d20: 6e61 6d65 203d 2073 656c 662e 5f6e 616d  name = self._nam
+00001d30: 650a 2020 2020 2020 2020 6966 2072 656e  e.        if ren
+00001d40: 616d 653a 0a20 2020 2020 2020 2020 2020  ame:.           
+00001d50: 206e 616d 6520 3d20 7265 6e61 6d65 2e67   name = rename.g
+00001d60: 6574 286e 616d 652c 206e 616d 6529 0a20  et(name, name). 
+00001d70: 2020 2020 2020 2072 6574 7572 6e20 5363         return Sc
+00001d80: 616c 6172 2864 736b 2c20 6e61 6d65 2c20  alar(dsk, name, 
+00001d90: 7365 6c66 2e5f 6d65 7461 2c20 7365 6c66  self._meta, self
+00001da0: 2e64 6976 6973 696f 6e73 290a 0a20 2020  .divisions)..   
+00001db0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00001dc0: 6566 205f 6d65 7461 5f6e 6f6e 656d 7074  ef _meta_nonempt
+00001dd0: 7928 7365 6c66 293a 0a20 2020 2020 2020  y(self):.       
+00001de0: 2072 6574 7572 6e20 7365 6c66 2e5f 6d65   return self._me
+00001df0: 7461 0a0a 2020 2020 4070 726f 7065 7274  ta..    @propert
+00001e00: 790a 2020 2020 6465 6620 6474 7970 6528  y.    def dtype(
+00001e10: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00001e20: 6574 7572 6e20 7365 6c66 2e5f 6d65 7461  eturn self._meta
+00001e30: 2e64 7479 7065 0a0a 2020 2020 6465 6620  .dtype..    def 
+00001e40: 5f5f 6469 725f 5f28 7365 6c66 293a 0a20  __dir__(self):. 
+00001e50: 2020 2020 2020 206f 203d 2073 6574 2864         o = set(d
+00001e60: 6972 2874 7970 6528 7365 6c66 2929 290a  ir(type(self))).
+00001e70: 2020 2020 2020 2020 6f2e 7570 6461 7465          o.update
+00001e80: 2873 656c 662e 5f5f 6469 6374 5f5f 290a  (self.__dict__).
+00001e90: 2020 2020 2020 2020 6966 206e 6f74 2068          if not h
+00001ea0: 6173 6174 7472 2873 656c 662e 5f6d 6574  asattr(self._met
+00001eb0: 612c 2022 6474 7970 6522 293a 0a20 2020  a, "dtype"):.   
+00001ec0: 2020 2020 2020 2020 206f 2e72 656d 6f76           o.remov
+00001ed0: 6528 2264 7479 7065 2229 2020 2320 6474  e("dtype")  # dt
+00001ee0: 7970 6520 6f6e 6c79 2069 6e20 6064 6972  ype only in `dir
+00001ef0: 6020 6966 2061 7661 696c 6162 6c65 0a20  ` if available. 
+00001f00: 2020 2020 2020 2072 6574 7572 6e20 6c69         return li
+00001f10: 7374 286f 290a 0a20 2020 2040 7072 6f70  st(o)..    @prop
+00001f20: 6572 7479 0a20 2020 2064 6566 2064 6976  erty.    def div
+00001f30: 6973 696f 6e73 2873 656c 6629 3a0a 2020  isions(self):.  
+00001f40: 2020 2020 2020 2222 2244 756d 6d79 2064        """Dummy d
+00001f50: 6976 6973 696f 6e73 2074 6f20 6265 2063  ivisions to be c
+00001f60: 6f6d 7061 7420 7769 7468 2053 6572 6965  ompat with Serie
+00001f70: 7320 616e 6420 4461 7461 4672 616d 6522  s and DataFrame"
+00001f80: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00001f90: 6e20 284e 6f6e 652c 204e 6f6e 6529 0a0a  n (None, None)..
+00001fa0: 2020 2020 6465 6620 5f5f 7265 7072 5f5f      def __repr__
+00001fb0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00001fc0: 6e61 6d65 203d 2073 656c 662e 5f6e 616d  name = self._nam
+00001fd0: 6520 6966 206c 656e 2873 656c 662e 5f6e  e if len(self._n
+00001fe0: 616d 6529 203c 2031 3020 656c 7365 2073  ame) < 10 else s
+00001ff0: 656c 662e 5f6e 616d 655b 3a37 5d20 2b20  elf._name[:7] + 
+00002000: 222e 2e2e 220a 2020 2020 2020 2020 6966  "...".        if
+00002010: 2068 6173 6174 7472 2873 656c 662e 5f6d   hasattr(self._m
+00002020: 6574 612c 2022 6474 7970 6522 293a 0a20  eta, "dtype"):. 
+00002030: 2020 2020 2020 2020 2020 2065 7874 7261             extra
+00002040: 203d 2022 2c20 6474 7970 653d 2573 2220   = ", dtype=%s" 
+00002050: 2520 7365 6c66 2e5f 6d65 7461 2e64 7479  % self._meta.dty
+00002060: 7065 0a20 2020 2020 2020 2065 6c73 653a  pe.        else:
+00002070: 0a20 2020 2020 2020 2020 2020 2065 7874  .            ext
+00002080: 7261 203d 2022 2c20 7479 7065 3d25 7322  ra = ", type=%s"
+00002090: 2025 2074 7970 6528 7365 6c66 2e5f 6d65   % type(self._me
+000020a0: 7461 292e 5f5f 6e61 6d65 5f5f 0a20 2020  ta).__name__.   
+000020b0: 2020 2020 2072 6574 7572 6e20 6622 6464       return f"dd
+000020c0: 2e53 6361 6c61 723c 7b6e 616d 657d 7b65  .Scalar<{name}{e
+000020d0: 7874 7261 7d3e 220a 0a20 2020 2064 6566  xtra}>"..    def
+000020e0: 205f 5f61 7272 6179 5f5f 2873 656c 6629   __array__(self)
+000020f0: 3a0a 2020 2020 2020 2020 2320 6172 7261  :.        # arra
+00002100: 7920 696e 7465 7266 6163 6520 6973 2072  y interface is r
+00002110: 6571 7569 7265 6420 746f 2073 7570 706f  equired to suppo
+00002120: 7274 2070 616e 6461 7320 696e 7374 616e  rt pandas instan
+00002130: 6365 202b 2053 6361 6c61 720a 2020 2020  ce + Scalar.    
+00002140: 2020 2020 2320 4f74 6865 7277 6973 652c      # Otherwise,
+00002150: 2061 626f 7665 206f 7020 7265 7375 6c74   above op result
+00002160: 7320 696e 2070 642e 5365 7269 6573 206f  s in pd.Series o
+00002170: 6620 5363 616c 6172 2028 6f62 6a65 6374  f Scalar (object
+00002180: 2064 7479 7065 290a 2020 2020 2020 2020   dtype).        
+00002190: 7265 7475 726e 206e 702e 6173 6172 7261  return np.asarra
+000021a0: 7928 7365 6c66 2e63 6f6d 7075 7465 2829  y(self.compute()
+000021b0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+000021c0: 0a20 2020 2064 6566 205f 6172 6773 2873  .    def _args(s
+000021d0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+000021e0: 7475 726e 2028 7365 6c66 2e64 6173 6b2c  turn (self.dask,
+000021f0: 2073 656c 662e 5f6e 616d 652c 2073 656c   self._name, sel
+00002200: 662e 5f6d 6574 6129 0a0a 2020 2020 6465  f._meta)..    de
+00002210: 6620 5f5f 6765 7473 7461 7465 5f5f 2873  f __getstate__(s
+00002220: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00002230: 7475 726e 2073 656c 662e 5f61 7267 730a  turn self._args.
+00002240: 0a20 2020 2064 6566 205f 5f73 6574 7374  .    def __setst
+00002250: 6174 655f 5f28 7365 6c66 2c20 7374 6174  ate__(self, stat
+00002260: 6529 3a0a 2020 2020 2020 2020 7365 6c66  e):.        self
+00002270: 2e64 6173 6b2c 2073 656c 662e 5f6e 616d  .dask, self._nam
+00002280: 652c 2073 656c 662e 5f6d 6574 6120 3d20  e, self._meta = 
+00002290: 7374 6174 650a 0a20 2020 2064 6566 205f  state..    def _
+000022a0: 5f62 6f6f 6c5f 5f28 7365 6c66 293a 0a20  _bool__(self):. 
+000022b0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+000022c0: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+000022d0: 2020 2020 6622 5472 7969 6e67 2074 6f20      f"Trying to 
+000022e0: 636f 6e76 6572 7420 7b73 656c 667d 2074  convert {self} t
+000022f0: 6f20 6120 626f 6f6c 6561 6e20 7661 6c75  o a boolean valu
+00002300: 652e 2042 6563 6175 7365 2044 6173 6b20  e. Because Dask 
+00002310: 6f62 6a65 6374 7320 6172 6520 220a 2020  objects are ".  
+00002320: 2020 2020 2020 2020 2020 226c 617a 696c            "lazil
+00002330: 7920 6576 616c 7561 7465 642c 2074 6865  y evaluated, the
+00002340: 7920 6361 6e6e 6f74 2062 6520 636f 6e76  y cannot be conv
+00002350: 6572 7465 6420 746f 2061 2062 6f6f 6c65  erted to a boole
+00002360: 616e 2076 616c 7565 206f 7220 7573 6564  an value or used
+00002370: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
+00002380: 696e 2062 6f6f 6c65 616e 2063 6f6e 6469  in boolean condi
+00002390: 7469 6f6e 7320 6c69 6b65 2069 6620 7374  tions like if st
+000023a0: 6174 656d 656e 7473 2e20 5472 7920 6361  atements. Try ca
+000023b0: 6c6c 696e 6720 2e63 6f6d 7075 7465 2829  lling .compute()
+000023c0: 2074 6f20 220a 2020 2020 2020 2020 2020   to ".          
+000023d0: 2020 2266 6f72 6365 2063 6f6d 7075 7461    "force computa
+000023e0: 7469 6f6e 2070 7269 6f72 2074 6f20 636f  tion prior to co
+000023f0: 6e76 6572 7469 6e67 2074 6f20 6120 626f  nverting to a bo
+00002400: 6f6c 6561 6e20 7661 6c75 6520 6f72 2075  olean value or u
+00002410: 7369 6e67 2069 6e20 220a 2020 2020 2020  sing in ".      
+00002420: 2020 2020 2020 2261 2063 6f6e 6469 7469        "a conditi
+00002430: 6f6e 616c 2073 7461 7465 6d65 6e74 2e22  onal statement."
+00002440: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00002450: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00002460: 6620 6b65 7928 7365 6c66 293a 0a20 2020  f key(self):.   
+00002470: 2020 2020 2072 6574 7572 6e20 2873 656c       return (sel
+00002480: 662e 5f6e 616d 652c 2030 290a 0a20 2020  f._name, 0)..   
+00002490: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
+000024a0: 2020 6465 6620 5f67 6574 5f75 6e61 7279    def _get_unary
+000024b0: 5f6f 7065 7261 746f 7228 636c 732c 206f  _operator(cls, o
+000024c0: 7029 3a0a 2020 2020 2020 2020 6465 6620  p):.        def 
+000024d0: 6628 7365 6c66 293a 0a20 2020 2020 2020  f(self):.       
+000024e0: 2020 2020 206e 616d 6520 3d20 6675 6e63       name = func
+000024f0: 6e61 6d65 286f 7029 202b 2022 2d22 202b  name(op) + "-" +
+00002500: 2074 6f6b 656e 697a 6528 7365 6c66 290a   tokenize(self).
+00002510: 2020 2020 2020 2020 2020 2020 6473 6b20              dsk 
+00002520: 3d20 7b28 6e61 6d65 2c20 3029 3a20 286f  = {(name, 0): (o
+00002530: 702c 2028 7365 6c66 2e5f 6e61 6d65 2c20  p, (self._name, 
+00002540: 3029 297d 0a20 2020 2020 2020 2020 2020  0))}.           
+00002550: 206d 6574 6120 3d20 6f70 2873 656c 662e   meta = op(self.
+00002560: 5f6d 6574 615f 6e6f 6e65 6d70 7479 290a  _meta_nonempty).
+00002570: 2020 2020 2020 2020 2020 2020 6772 6170              grap
+00002580: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
+00002590: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
+000025a0: 6f6e 7328 6e61 6d65 2c20 6473 6b2c 2064  ons(name, dsk, d
+000025b0: 6570 656e 6465 6e63 6965 733d 5b73 656c  ependencies=[sel
+000025c0: 665d 290a 2020 2020 2020 2020 2020 2020  f]).            
+000025d0: 7265 7475 726e 2053 6361 6c61 7228 6772  return Scalar(gr
+000025e0: 6170 682c 206e 616d 652c 206d 6574 6129  aph, name, meta)
+000025f0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00002600: 2066 0a0a 2020 2020 4063 6c61 7373 6d65   f..    @classme
+00002610: 7468 6f64 0a20 2020 2064 6566 205f 6765  thod.    def _ge
+00002620: 745f 6269 6e61 7279 5f6f 7065 7261 746f  t_binary_operato
+00002630: 7228 636c 732c 206f 702c 2069 6e76 3d46  r(cls, op, inv=F
+00002640: 616c 7365 293a 0a20 2020 2020 2020 2072  alse):.        r
+00002650: 6574 7572 6e20 6c61 6d62 6461 2073 656c  eturn lambda sel
+00002660: 662c 206f 7468 6572 3a20 5f73 6361 6c61  f, other: _scala
+00002670: 725f 6269 6e61 7279 286f 702c 2073 656c  r_binary(op, sel
+00002680: 662c 206f 7468 6572 2c20 696e 763d 696e  f, other, inv=in
+00002690: 7629 0a0a 2020 2020 6465 6620 746f 5f64  v)..    def to_d
+000026a0: 656c 6179 6564 2873 656c 662c 206f 7074  elayed(self, opt
+000026b0: 696d 697a 655f 6772 6170 683d 5472 7565  imize_graph=True
+000026c0: 293a 0a20 2020 2020 2020 2022 2222 436f  ):.        """Co
+000026d0: 6e76 6572 7420 696e 746f 2061 2060 6064  nvert into a ``d
+000026e0: 6173 6b2e 6465 6c61 7965 6460 6020 6f62  ask.delayed`` ob
+000026f0: 6a65 6374 2e0a 0a20 2020 2020 2020 2050  ject...        P
+00002700: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00002710: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00002720: 2020 2020 206f 7074 696d 697a 655f 6772       optimize_gr
+00002730: 6170 6820 3a20 626f 6f6c 2c20 6f70 7469  aph : bool, opti
+00002740: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+00002750: 2049 6620 5472 7565 205b 6465 6661 756c   If True [defaul
+00002760: 745d 2c20 7468 6520 6772 6170 6820 6973  t], the graph is
+00002770: 206f 7074 696d 697a 6564 2062 6566 6f72   optimized befor
+00002780: 6520 636f 6e76 6572 7469 6e67 2069 6e74  e converting int
+00002790: 6f0a 2020 2020 2020 2020 2020 2020 6060  o.            ``
+000027a0: 6461 736b 2e64 656c 6179 6564 6060 206f  dask.delayed`` o
+000027b0: 626a 6563 7473 2e0a 2020 2020 2020 2020  bjects..        
+000027c0: 2222 220a 2020 2020 2020 2020 6473 6b20  """.        dsk 
+000027d0: 3d20 7365 6c66 2e5f 5f64 6173 6b5f 6772  = self.__dask_gr
+000027e0: 6170 685f 5f28 290a 2020 2020 2020 2020  aph__().        
+000027f0: 6c61 7965 7220 3d20 7365 6c66 2e5f 5f64  layer = self.__d
+00002800: 6173 6b5f 6c61 7965 7273 5f5f 2829 5b30  ask_layers__()[0
+00002810: 5d0a 2020 2020 2020 2020 6966 206f 7074  ].        if opt
+00002820: 696d 697a 655f 6772 6170 683a 0a20 2020  imize_graph:.   
+00002830: 2020 2020 2020 2020 2064 736b 203d 2073           dsk = s
+00002840: 656c 662e 5f5f 6461 736b 5f6f 7074 696d  elf.__dask_optim
+00002850: 697a 655f 5f28 6473 6b2c 2073 656c 662e  ize__(dsk, self.
+00002860: 5f5f 6461 736b 5f6b 6579 735f 5f28 2929  __dask_keys__())
+00002870: 0a20 2020 2020 2020 2020 2020 206c 6179  .            lay
+00002880: 6572 203d 2022 6465 6c61 7965 642d 2220  er = "delayed-" 
+00002890: 2b20 7365 6c66 2e5f 6e61 6d65 0a20 2020  + self._name.   
+000028a0: 2020 2020 2020 2020 2064 736b 203d 2048           dsk = H
+000028b0: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
+000028c0: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286c  om_collections(l
+000028d0: 6179 6572 2c20 6473 6b2c 2064 6570 656e  ayer, dsk, depen
+000028e0: 6465 6e63 6965 733d 2829 290a 2020 2020  dencies=()).    
+000028f0: 2020 2020 7265 7475 726e 2044 656c 6179      return Delay
+00002900: 6564 2873 656c 662e 6b65 792c 2064 736b  ed(self.key, dsk
+00002910: 2c20 6c61 7965 723d 6c61 7965 7229 0a0a  , layer=layer)..
+00002920: 0a64 6566 205f 7363 616c 6172 5f62 696e  .def _scalar_bin
+00002930: 6172 7928 6f70 2c20 7365 6c66 2c20 6f74  ary(op, self, ot
+00002940: 6865 722c 2069 6e76 3d46 616c 7365 293a  her, inv=False):
+00002950: 0a20 2020 206e 616d 6520 3d20 6622 7b66  .    name = f"{f
+00002960: 756e 636e 616d 6528 6f70 297d 2d7b 746f  uncname(op)}-{to
+00002970: 6b65 6e69 7a65 2873 656c 662c 206f 7468  kenize(self, oth
+00002980: 6572 297d 220a 2020 2020 6465 7065 6e64  er)}".    depend
+00002990: 656e 6369 6573 203d 205b 7365 6c66 5d0a  encies = [self].
+000029a0: 0a20 2020 2064 736b 203d 207b 7d0a 2020  .    dsk = {}.  
+000029b0: 2020 7265 7475 726e 5f74 7970 6520 3d20    return_type = 
+000029c0: 6765 745f 7061 7261 6c6c 656c 5f74 7970  get_parallel_typ
+000029d0: 6528 6f74 6865 7229 0a0a 2020 2020 6966  e(other)..    if
+000029e0: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
+000029f0: 722c 2053 6361 6c61 7229 3a0a 2020 2020  r, Scalar):.    
+00002a00: 2020 2020 6465 7065 6e64 656e 6369 6573      dependencies
+00002a10: 2e61 7070 656e 6428 6f74 6865 7229 0a20  .append(other). 
+00002a20: 2020 2020 2020 206f 7468 6572 5f6b 6579         other_key
+00002a30: 203d 2028 6f74 6865 722e 5f6e 616d 652c   = (other._name,
+00002a40: 2030 290a 2020 2020 656c 6966 2069 735f   0).    elif is_
+00002a50: 6461 736b 5f63 6f6c 6c65 6374 696f 6e28  dask_collection(
+00002a60: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
+00002a70: 7265 7475 726e 204e 6f74 496d 706c 656d  return NotImplem
+00002a80: 656e 7465 640a 2020 2020 656c 7365 3a0a  ented.    else:.
+00002a90: 2020 2020 2020 2020 6f74 6865 725f 6b65          other_ke
+00002aa0: 7920 3d20 6f74 6865 720a 0a20 2020 2064  y = other..    d
+00002ab0: 736b 5b28 6e61 6d65 2c20 3029 5d20 3d20  sk[(name, 0)] = 
+00002ac0: 280a 2020 2020 2020 2020 286f 702c 206f  (.        (op, o
+00002ad0: 7468 6572 5f6b 6579 2c20 2873 656c 662e  ther_key, (self.
+00002ae0: 5f6e 616d 652c 2030 2929 2069 6620 696e  _name, 0)) if in
+00002af0: 7620 656c 7365 2028 6f70 2c20 2873 656c  v else (op, (sel
+00002b00: 662e 5f6e 616d 652c 2030 292c 206f 7468  f._name, 0), oth
+00002b10: 6572 5f6b 6579 290a 2020 2020 290a 0a20  er_key).    ).. 
+00002b20: 2020 206f 7468 6572 5f6d 6574 6120 3d20     other_meta = 
+00002b30: 6d61 6b65 5f6d 6574 6128 6f74 6865 722c  make_meta(other,
+00002b40: 2070 6172 656e 745f 6d65 7461 3d73 656c   parent_meta=sel
+00002b50: 662e 5f70 6172 656e 745f 6d65 7461 290a  f._parent_meta).
+00002b60: 2020 2020 6f74 6865 725f 6d65 7461 5f6e      other_meta_n
+00002b70: 6f6e 656d 7074 7920 3d20 6d65 7461 5f6e  onempty = meta_n
+00002b80: 6f6e 656d 7074 7928 6f74 6865 725f 6d65  onempty(other_me
+00002b90: 7461 290a 2020 2020 6966 2069 6e76 3a0a  ta).    if inv:.
+00002ba0: 2020 2020 2020 2020 6d65 7461 203d 206f          meta = o
+00002bb0: 7028 6f74 6865 725f 6d65 7461 5f6e 6f6e  p(other_meta_non
+00002bc0: 656d 7074 792c 2073 656c 662e 5f6d 6574  empty, self._met
+00002bd0: 615f 6e6f 6e65 6d70 7479 290a 2020 2020  a_nonempty).    
+00002be0: 656c 7365 3a0a 2020 2020 2020 2020 6d65  else:.        me
+00002bf0: 7461 203d 206f 7028 7365 6c66 2e5f 6d65  ta = op(self._me
+00002c00: 7461 5f6e 6f6e 656d 7074 792c 206f 7468  ta_nonempty, oth
+00002c10: 6572 5f6d 6574 615f 6e6f 6e65 6d70 7479  er_meta_nonempty
+00002c20: 290a 0a20 2020 2067 7261 7068 203d 2048  )..    graph = H
+00002c30: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
+00002c40: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
+00002c50: 616d 652c 2064 736b 2c20 6465 7065 6e64  ame, dsk, depend
+00002c60: 656e 6369 6573 3d64 6570 656e 6465 6e63  encies=dependenc
+00002c70: 6965 7329 0a20 2020 2069 6620 7265 7475  ies).    if retu
+00002c80: 726e 5f74 7970 6520 6973 206e 6f74 2053  rn_type is not S
+00002c90: 6361 6c61 723a 0a20 2020 2020 2020 2072  calar:.        r
+00002ca0: 6574 7572 6e20 7265 7475 726e 5f74 7970  eturn return_typ
+00002cb0: 6528 6772 6170 682c 206e 616d 652c 206d  e(graph, name, m
+00002cc0: 6574 612c 205b 6f74 6865 722e 696e 6465  eta, [other.inde
+00002cd0: 782e 6d69 6e28 292c 206f 7468 6572 2e69  x.min(), other.i
+00002ce0: 6e64 6578 2e6d 6178 2829 5d29 0a20 2020  ndex.max()]).   
+00002cf0: 2065 6c73 653a 0a20 2020 2020 2020 2072   else:.        r
+00002d00: 6574 7572 6e20 5363 616c 6172 2867 7261  eturn Scalar(gra
+00002d10: 7068 2c20 6e61 6d65 2c20 6d65 7461 290a  ph, name, meta).
+00002d20: 0a0a 636c 6173 7320 5f46 7261 6d65 2844  ..class _Frame(D
+00002d30: 6173 6b4d 6574 686f 6473 4d69 7869 6e2c  askMethodsMixin,
+00002d40: 204f 7065 7261 746f 724d 6574 686f 644d   OperatorMethodM
+00002d50: 6978 696e 293a 0a20 2020 2022 2222 5375  ixin):.    """Su
+00002d60: 7065 7263 6c61 7373 2066 6f72 2044 6174  perclass for Dat
+00002d70: 6146 7261 6d65 2061 6e64 2053 6572 6965  aFrame and Serie
+00002d80: 730a 0a20 2020 2050 6172 616d 6574 6572  s..    Parameter
+00002d90: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+00002da0: 0a20 2020 2064 736b 3a20 6469 6374 0a20  .    dsk: dict. 
+00002db0: 2020 2020 2020 2054 6865 2064 6173 6b20         The dask 
+00002dc0: 6772 6170 6820 746f 2063 6f6d 7075 7465  graph to compute
+00002dd0: 2074 6869 7320 4461 7461 4672 616d 650a   this DataFrame.
+00002de0: 2020 2020 6e61 6d65 3a20 7374 720a 2020      name: str.  
+00002df0: 2020 2020 2020 5468 6520 6b65 7920 7072        The key pr
+00002e00: 6566 6978 2074 6861 7420 7370 6563 6966  efix that specif
+00002e10: 6965 7320 7768 6963 6820 6b65 7973 2069  ies which keys i
+00002e20: 6e20 7468 6520 6461 736b 2063 6f6d 7072  n the dask compr
+00002e30: 6973 6520 7468 6973 0a20 2020 2020 2020  ise this.       
+00002e40: 2070 6172 7469 6375 6c61 7220 4461 7461   particular Data
+00002e50: 4672 616d 6520 2f20 5365 7269 6573 0a20  Frame / Series. 
+00002e60: 2020 206d 6574 613a 2070 616e 6461 732e     meta: pandas.
+00002e70: 4461 7461 4672 616d 652c 2070 616e 6461  DataFrame, panda
+00002e80: 732e 5365 7269 6573 2c20 6f72 2070 616e  s.Series, or pan
+00002e90: 6461 732e 496e 6465 780a 2020 2020 2020  das.Index.      
+00002ea0: 2020 416e 2065 6d70 7479 2070 616e 6461    An empty panda
+00002eb0: 7320 6f62 6a65 6374 2077 6974 6820 6e61  s object with na
+00002ec0: 6d65 732c 2064 7479 7065 732c 2061 6e64  mes, dtypes, and
+00002ed0: 2069 6e64 6963 6573 206d 6174 6368 696e   indices matchin
+00002ee0: 6720 7468 650a 2020 2020 2020 2020 6578  g the.        ex
+00002ef0: 7065 6374 6564 206f 7574 7075 742e 0a20  pected output.. 
+00002f00: 2020 2064 6976 6973 696f 6e73 3a20 7475     divisions: tu
+00002f10: 706c 6520 6f66 2069 6e64 6578 2076 616c  ple of index val
+00002f20: 7565 730a 2020 2020 2020 2020 5661 6c75  ues.        Valu
+00002f30: 6573 2061 6c6f 6e67 2077 6869 6368 2077  es along which w
+00002f40: 6520 7061 7274 6974 696f 6e20 6f75 7220  e partition our 
+00002f50: 626c 6f63 6b73 206f 6e20 7468 6520 696e  blocks on the in
+00002f60: 6465 780a 2020 2020 2222 220a 0a20 2020  dex.    """..   
+00002f70: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
+00002f80: 6c66 2c20 6473 6b2c 206e 616d 652c 206d  lf, dsk, name, m
+00002f90: 6574 612c 2064 6976 6973 696f 6e73 293a  eta, divisions):
+00002fa0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00002fb0: 6973 696e 7374 616e 6365 2864 736b 2c20  isinstance(dsk, 
+00002fc0: 4869 6768 4c65 7665 6c47 7261 7068 293a  HighLevelGraph):
+00002fd0: 0a20 2020 2020 2020 2020 2020 2064 736b  .            dsk
+00002fe0: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+00002ff0: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+00003000: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
+00003010: 7065 6e64 656e 6369 6573 3d5b 5d29 0a20  pendencies=[]). 
+00003020: 2020 2020 2020 2073 656c 662e 6461 736b         self.dask
+00003030: 203d 2064 736b 0a20 2020 2020 2020 2073   = dsk.        s
+00003040: 656c 662e 5f6e 616d 6520 3d20 6e61 6d65  elf._name = name
+00003050: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
+00003060: 6d61 6b65 5f6d 6574 6128 6d65 7461 290a  make_meta(meta).
+00003070: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+00003080: 656c 662e 5f69 735f 7061 7274 6974 696f  elf._is_partitio
+00003090: 6e5f 7479 7065 286d 6574 6129 3a0a 2020  n_type(meta):.  
+000030a0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000030b0: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
+000030c0: 2020 2020 2020 2020 2020 2066 2245 7870             f"Exp
+000030d0: 6563 7465 6420 6d65 7461 2074 6f20 7370  ected meta to sp
+000030e0: 6563 6966 7920 7479 7065 207b 7479 7065  ecify type {type
+000030f0: 2873 656c 6629 2e5f 5f6e 616d 655f 5f7d  (self).__name__}
+00003100: 2c20 676f 7420 7479 7065 2022 0a20 2020  , got type ".   
+00003110: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
+00003120: 7479 7065 6e61 6d65 2874 7970 6528 6d65  typename(type(me
+00003130: 7461 2929 7d22 0a20 2020 2020 2020 2020  ta))}".         
+00003140: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+00003150: 662e 5f6d 6574 6120 3d20 6d65 7461 0a20  f._meta = meta. 
+00003160: 2020 2020 2020 2073 656c 662e 6469 7669         self.divi
+00003170: 7369 6f6e 7320 3d20 7475 706c 6528 6469  sions = tuple(di
+00003180: 7669 7369 6f6e 7329 0a0a 2020 2020 2020  visions)..      
+00003190: 2020 2320 4f70 7469 6f6e 616c 6c79 2063    # Optionally c
+000031a0: 6173 7420 6f62 6a65 6374 2064 7479 7065  ast object dtype
+000031b0: 7320 746f 2060 7079 6172 726f 7760 2073  s to `pyarrow` s
+000031c0: 7472 696e 6773 2e0a 2020 2020 2020 2020  trings..        
+000031d0: 2320 4279 2064 6566 6175 6c74 2c20 6966  # By default, if
+000031e0: 2060 7079 6172 726f 7760 2061 6e64 2060   `pyarrow` and `
+000031f0: 7061 6e64 6173 3e3d 3260 2061 7265 2069  pandas>=2` are i
+00003200: 6e73 7461 6c6c 6564 2c0a 2020 2020 2020  nstalled,.      
+00003210: 2020 2320 7765 2063 6f6e 7665 7274 2074    # we convert t
+00003220: 6f20 7079 6172 726f 7720 7374 7269 6e67  o pyarrow string
+00003230: 732e 0a20 2020 2020 2020 2069 6620 7079  s..        if py
+00003240: 6172 726f 775f 7374 7269 6e67 735f 656e  arrow_strings_en
+00003250: 6162 6c65 6428 293a 0a20 2020 2020 2020  abled():.       
+00003260: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
+00003270: 6174 6166 7261 6d65 2e5f 7079 6172 726f  ataframe._pyarro
+00003280: 7720 696d 706f 7274 2063 6865 636b 5f70  w import check_p
+00003290: 7961 7272 6f77 5f73 7472 696e 675f 7375  yarrow_string_su
+000032a0: 7070 6f72 7465 640a 0a20 2020 2020 2020  pported..       
+000032b0: 2020 2020 2063 6865 636b 5f70 7961 7272       check_pyarr
+000032c0: 6f77 5f73 7472 696e 675f 7375 7070 6f72  ow_string_suppor
+000032d0: 7465 6428 290a 0a20 2020 2020 2020 2020  ted()..         
+000032e0: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
+000032f0: 6166 7261 6d65 2e5f 7079 6172 726f 7720  aframe._pyarrow 
+00003300: 696d 706f 7274 2028 0a20 2020 2020 2020  import (.       
+00003310: 2020 2020 2020 2020 2069 735f 6f62 6a65           is_obje
+00003320: 6374 5f73 7472 696e 675f 6461 7461 6672  ct_string_datafr
+00003330: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+00003340: 2020 2020 2069 735f 6f62 6a65 6374 5f73       is_object_s
+00003350: 7472 696e 675f 6474 7970 652c 0a20 2020  tring_dtype,.   
+00003360: 2020 2020 2020 2020 2020 2020 2069 735f               is_
+00003370: 6f62 6a65 6374 5f73 7472 696e 675f 696e  object_string_in
+00003380: 6465 782c 0a20 2020 2020 2020 2020 2020  dex,.           
+00003390: 2020 2020 2069 735f 6f62 6a65 6374 5f73       is_object_s
+000033a0: 7472 696e 675f 7365 7269 6573 2c0a 2020  tring_series,.  
+000033b0: 2020 2020 2020 2020 2020 2020 2020 746f                to
+000033c0: 5f70 7961 7272 6f77 5f73 7472 696e 672c  _pyarrow_string,
+000033d0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+000033e0: 2020 2020 2020 2020 2020 2020 6966 2028              if (
+000033f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003400: 2069 735f 6f62 6a65 6374 5f73 7472 696e   is_object_strin
+00003410: 675f 6461 7461 6672 616d 6528 6d65 7461  g_dataframe(meta
+00003420: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00003430: 2020 6f72 2069 735f 6f62 6a65 6374 5f73    or is_object_s
+00003440: 7472 696e 675f 7365 7269 6573 286d 6574  tring_series(met
+00003450: 6129 0a20 2020 2020 2020 2020 2020 2020  a).             
+00003460: 2020 206f 7220 6973 5f6f 626a 6563 745f     or is_object_
+00003470: 7374 7269 6e67 5f69 6e64 6578 286d 6574  string_index(met
+00003480: 6129 0a20 2020 2020 2020 2020 2020 2029  a).            )
+00003490: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000034a0: 2020 2320 5072 696f 7220 746f 2070 616e    # Prior to pan
+000034b0: 6461 733d 312e 342c 2060 7064 2e49 6e64  das=1.4, `pd.Ind
+000034c0: 6578 6020 636f 756c 646e 2774 2063 6f6e  ex` couldn't con
+000034d0: 7461 696e 2065 7874 656e 7369 6f6e 2064  tain extension d
+000034e0: 7479 7065 732e 0a20 2020 2020 2020 2020  types..         
+000034f0: 2020 2020 2020 2023 2048 6572 6520 7765         # Here we
+00003500: 2064 6f6e 2774 2063 6173 7420 6f62 6a65   don't cast obje
+00003510: 6374 7320 746f 2070 7961 7272 6f77 2073  cts to pyarrow s
+00003520: 7472 696e 6773 2077 6865 7265 206f 6e6c  trings where onl
+00003530: 7920 7468 6520 696e 6465 780a 2020 2020  y the index.    
+00003540: 2020 2020 2020 2020 2020 2020 2320 636f              # co
+00003550: 6e74 6169 6e73 206e 6f6e 2d70 7961 7272  ntains non-pyarr
+00003560: 6f77 2073 7472 696e 6720 6461 7461 2e0a  ow string data..
+00003570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003580: 6966 206e 6f74 2050 414e 4441 535f 4754  if not PANDAS_GT
+00003590: 5f31 3430 2061 6e64 2028 0a20 2020 2020  _140 and (.     
+000035a0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+000035b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000035c0: 2020 2020 2020 2020 2069 735f 6f62 6a65           is_obje
+000035d0: 6374 5f73 7472 696e 675f 6461 7461 6672  ct_string_datafr
+000035e0: 616d 6528 6d65 7461 290a 2020 2020 2020  ame(meta).      
+000035f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003600: 2020 616e 6420 6e6f 7420 616e 7928 6973    and not any(is
+00003610: 5f6f 626a 6563 745f 7374 7269 6e67 5f64  _object_string_d
+00003620: 7479 7065 2864 2920 666f 7220 6420 696e  type(d) for d in
+00003630: 206d 6574 612e 6474 7970 6573 290a 2020   meta.dtypes).  
 00003640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003650: 616e 6420 6e6f 7420 6973 5f6f 626a 6563  and not is_objec
-00003660: 745f 7374 7269 6e67 5f64 7479 7065 286d  t_string_dtype(m
-00003670: 6574 612e 6474 7970 6529 0a20 2020 2020  eta.dtype).     
-00003680: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00003690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000036a0: 2020 2020 206f 7220 6973 5f6f 626a 6563       or is_objec
-000036b0: 745f 7374 7269 6e67 5f69 6e64 6578 286d  t_string_index(m
-000036c0: 6574 6129 0a20 2020 2020 2020 2020 2020  eta).           
-000036d0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-000036e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000036f0: 726e 0a0a 2020 2020 2020 2020 2020 2020  rn..            
-00003700: 2020 2020 2320 7468 6973 2069 7320 616e      # this is an
-00003710: 2069 6e74 6572 6e61 6c20 6361 6c6c 2c20   internal call, 
-00003720: 616e 6420 6966 2077 6520 656e 666f 7263  and if we enforc
-00003730: 6520 6d65 7461 6461 7461 2c0a 2020 2020  e metadata,.    
-00003740: 2020 2020 2020 2020 2020 2020 2320 6974              # it
-00003750: 206d 6179 2069 6e74 6572 6665 7265 2077   may interfere w
-00003760: 6865 6e20 7265 6164 696e 6720 6373 7620  hen reading csv 
-00003770: 7769 7468 2065 6e66 6f72 6365 3d46 616c  with enforce=Fal
-00003780: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
-00003790: 2020 2072 6573 756c 7420 3d20 7365 6c66     result = self
-000037a0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-000037b0: 746f 5f70 7961 7272 6f77 5f73 7472 696e  to_pyarrow_strin
-000037c0: 672c 2065 6e66 6f72 6365 5f6d 6574 6164  g, enforce_metad
-000037d0: 6174 613d 4661 6c73 6529 0a20 2020 2020  ata=False).     
-000037e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000037f0: 6461 736b 203d 2072 6573 756c 742e 6461  dask = result.da
-00003800: 736b 0a20 2020 2020 2020 2020 2020 2020  sk.             
-00003810: 2020 2073 656c 662e 5f6e 616d 6520 3d20     self._name = 
-00003820: 7265 7375 6c74 2e5f 6e61 6d65 0a20 2020  result._name.   
-00003830: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00003840: 662e 5f6d 6574 6120 3d20 7265 7375 6c74  f._meta = result
-00003850: 2e5f 6d65 7461 0a20 2020 2020 2020 2020  ._meta.         
-00003860: 2020 2020 2020 2073 656c 662e 6469 7669         self.divi
-00003870: 7369 6f6e 7320 3d20 7265 7375 6c74 2e64  sions = result.d
-00003880: 6976 6973 696f 6e73 0a0a 2020 2020 6465  ivisions..    de
-00003890: 6620 5f5f 6461 736b 5f67 7261 7068 5f5f  f __dask_graph__
-000038a0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000038b0: 7265 7475 726e 2073 656c 662e 6461 736b  return self.dask
-000038c0: 0a0a 2020 2020 6465 6620 5f5f 6461 736b  ..    def __dask
-000038d0: 5f6b 6579 735f 5f28 7365 6c66 2920 2d3e  _keys__(self) ->
-000038e0: 206c 6973 745b 4861 7368 6162 6c65 5d3a   list[Hashable]:
-000038f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00003900: 5b28 7365 6c66 2e5f 6e61 6d65 2c20 6929  [(self._name, i)
-00003910: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-00003920: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
-00003930: 295d 0a0a 2020 2020 6465 6620 5f5f 6461  )]..    def __da
-00003940: 736b 5f6c 6179 6572 735f 5f28 7365 6c66  sk_layers__(self
-00003950: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00003960: 6e20 2873 656c 662e 5f6e 616d 652c 290a  n (self._name,).
-00003970: 0a20 2020 2064 6566 205f 5f64 6173 6b5f  .    def __dask_
-00003980: 746f 6b65 6e69 7a65 5f5f 2873 656c 6629  tokenize__(self)
-00003990: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-000039a0: 2073 656c 662e 5f6e 616d 650a 0a20 2020   self._name..   
-000039b0: 205f 5f64 6173 6b5f 6f70 7469 6d69 7a65   __dask_optimize
-000039c0: 5f5f 203d 2067 6c6f 6261 6c6d 6574 686f  __ = globalmetho
-000039d0: 6428 0a20 2020 2020 2020 206f 7074 696d  d(.        optim
-000039e0: 697a 652c 206b 6579 3d22 6461 7461 6672  ize, key="datafr
-000039f0: 616d 655f 6f70 7469 6d69 7a65 222c 2066  ame_optimize", f
-00003a00: 616c 7365 793d 646f 6e74 5f6f 7074 696d  alsey=dont_optim
-00003a10: 697a 650a 2020 2020 290a 2020 2020 5f5f  ize.    ).    __
-00003a20: 6461 736b 5f73 6368 6564 756c 6572 5f5f  dask_scheduler__
-00003a30: 203d 2073 7461 7469 636d 6574 686f 6428   = staticmethod(
-00003a40: 4445 4641 554c 545f 4745 5429 0a0a 2020  DEFAULT_GET)..  
-00003a50: 2020 6465 6620 5f5f 6461 736b 5f70 6f73    def __dask_pos
-00003a60: 7463 6f6d 7075 7465 5f5f 2873 656c 6629  tcompute__(self)
-00003a70: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00003a80: 2066 696e 616c 697a 652c 2028 290a 0a20   finalize, ().. 
-00003a90: 2020 2064 6566 205f 5f64 6173 6b5f 706f     def __dask_po
-00003aa0: 7374 7065 7273 6973 745f 5f28 7365 6c66  stpersist__(self
-00003ab0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00003ac0: 6e20 7365 6c66 2e5f 7265 6275 696c 642c  n self._rebuild,
-00003ad0: 2028 290a 0a20 2020 2064 6566 205f 7265   ()..    def _re
-00003ae0: 6275 696c 6428 7365 6c66 2c20 6473 6b2c  build(self, dsk,
-00003af0: 202a 2c20 7265 6e61 6d65 3d4e 6f6e 6529   *, rename=None)
-00003b00: 3a0a 2020 2020 2020 2020 6e61 6d65 203d  :.        name =
-00003b10: 2073 656c 662e 5f6e 616d 650a 2020 2020   self._name.    
-00003b20: 2020 2020 6966 2072 656e 616d 653a 0a20      if rename:. 
-00003b30: 2020 2020 2020 2020 2020 206e 616d 6520             name 
-00003b40: 3d20 7265 6e61 6d65 2e67 6574 286e 616d  = rename.get(nam
-00003b50: 652c 206e 616d 6529 0a20 2020 2020 2020  e, name).       
-00003b60: 2072 6574 7572 6e20 7479 7065 2873 656c   return type(sel
-00003b70: 6629 2864 736b 2c20 6e61 6d65 2c20 7365  f)(dsk, name, se
-00003b80: 6c66 2e5f 6d65 7461 2c20 7365 6c66 2e64  lf._meta, self.d
-00003b90: 6976 6973 696f 6e73 290a 0a20 2020 2040  ivisions)..    @
-00003ba0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00003bb0: 205f 636f 6e73 7472 7563 746f 7228 7365   _constructor(se
-00003bc0: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00003bd0: 7572 6e20 6e65 775f 6464 5f6f 626a 6563  urn new_dd_objec
-00003be0: 740a 0a20 2020 2040 7072 6f70 6572 7479  t..    @property
-00003bf0: 0a20 2020 2064 6566 2064 6976 6973 696f  .    def divisio
-00003c00: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
-00003c10: 2020 2222 220a 2020 2020 2020 2020 5475    """.        Tu
-00003c20: 706c 6520 6f66 2060 606e 7061 7274 6974  ple of ``npartit
-00003c30: 696f 6e73 202b 2031 6060 2076 616c 7565  ions + 1`` value
-00003c40: 732c 2069 6e20 6173 6365 6e64 696e 6720  s, in ascending 
-00003c50: 6f72 6465 722c 206d 6172 6b69 6e67 2074  order, marking t
-00003c60: 6865 0a20 2020 2020 2020 206c 6f77 6572  he.        lower
-00003c70: 2f75 7070 6572 2062 6f75 6e64 7320 6f66  /upper bounds of
-00003c80: 2065 6163 6820 7061 7274 6974 696f 6e27   each partition'
-00003c90: 7320 696e 6465 782e 2044 6976 6973 696f  s index. Divisio
-00003ca0: 6e73 2061 6c6c 6f77 2044 6173 6b0a 2020  ns allow Dask.  
-00003cb0: 2020 2020 2020 746f 206b 6e6f 7720 7768        to know wh
-00003cc0: 6963 6820 7061 7274 6974 696f 6e20 7769  ich partition wi
-00003cd0: 6c6c 2063 6f6e 7461 696e 2061 2067 6976  ll contain a giv
-00003ce0: 656e 2076 616c 7565 2c20 7369 676e 6966  en value, signif
-00003cf0: 6963 616e 746c 790a 2020 2020 2020 2020  icantly.        
-00003d00: 7370 6565 6469 6e67 2075 7020 6f70 6572  speeding up oper
-00003d10: 6174 696f 6e73 206c 696b 6520 606c 6f63  ations like `loc
-00003d20: 602c 2060 6d65 7267 6560 2c20 616e 6420  `, `merge`, and 
-00003d30: 6067 726f 7570 6279 6020 6279 206e 6f74  `groupby` by not
-00003d40: 0a20 2020 2020 2020 2068 6176 696e 6720  .        having 
-00003d50: 746f 2073 6561 7263 6820 7468 6520 6675  to search the fu
-00003d60: 6c6c 2064 6174 6173 6574 2e0a 0a20 2020  ll dataset...   
-00003d70: 2020 2020 2045 7861 6d70 6c65 3a20 666f       Example: fo
-00003d80: 7220 6060 6469 7669 7369 6f6e 7320 3d20  r ``divisions = 
-00003d90: 2830 2c20 3130 2c20 3530 2c20 3130 3029  (0, 10, 50, 100)
-00003da0: 6060 2c20 7468 6572 6520 6172 6520 7468  ``, there are th
-00003db0: 7265 6520 7061 7274 6974 696f 6e73 2c0a  ree partitions,.
-00003dc0: 2020 2020 2020 2020 7768 6572 6520 7468          where th
-00003dd0: 6520 696e 6465 7820 696e 2065 6163 6820  e index in each 
-00003de0: 7061 7274 6974 696f 6e20 636f 6e74 6169  partition contai
-00003df0: 6e73 2076 616c 7565 7320 5b30 2c20 3130  ns values [0, 10
-00003e00: 292c 205b 3130 2c20 3530 292c 0a20 2020  ), [10, 50),.   
-00003e10: 2020 2020 2061 6e64 205b 3530 2c20 3130       and [50, 10
-00003e20: 305d 2c20 7265 7370 6563 7469 7665 6c79  0], respectively
-00003e30: 2e20 4461 736b 2074 6865 7265 666f 7265  . Dask therefore
-00003e40: 206b 6e6f 7773 2060 6064 662e 6c6f 635b   knows ``df.loc[
-00003e50: 3435 5d60 600a 2020 2020 2020 2020 7769  45]``.        wi
-00003e60: 6c6c 2062 6520 696e 2074 6865 2073 6563  ll be in the sec
-00003e70: 6f6e 6420 7061 7274 6974 696f 6e2e 0a0a  ond partition...
-00003e80: 2020 2020 2020 2020 5768 656e 2065 7665          When eve
-00003e90: 7279 2069 7465 6d20 696e 2060 6064 6976  ry item in ``div
-00003ea0: 6973 696f 6e73 6060 2069 7320 6060 4e6f  isions`` is ``No
-00003eb0: 6e65 6060 2c20 7468 6520 6469 7669 7369  ne``, the divisi
-00003ec0: 6f6e 7320 6172 6520 756e 6b6e 6f77 6e2e  ons are unknown.
-00003ed0: 0a20 2020 2020 2020 204d 6f73 7420 6f70  .        Most op
-00003ee0: 6572 6174 696f 6e73 2063 616e 2073 7469  erations can sti
-00003ef0: 6c6c 2062 6520 7065 7266 6f72 6d65 642c  ll be performed,
-00003f00: 2062 7574 2073 6f6d 6520 7769 6c6c 2062   but some will b
-00003f10: 6520 6d75 6368 2073 6c6f 7765 722c 0a20  e much slower,. 
-00003f20: 2020 2020 2020 2061 6e64 2061 2066 6577         and a few
-00003f30: 206d 6179 2066 6169 6c2e 0a0a 2020 2020   may fail...    
-00003f40: 2020 2020 4974 2069 7320 756e 636f 6d6d      It is uncomm
-00003f50: 6f6e 2074 6f20 7365 7420 6060 6469 7669  on to set ``divi
-00003f60: 7369 6f6e 7360 6020 6469 7265 6374 6c79  sions`` directly
-00003f70: 2e20 496e 7374 6561 642c 2075 7365 2060  . Instead, use `
-00003f80: 6073 6574 5f69 6e64 6578 6060 2c0a 2020  `set_index``,.  
-00003f90: 2020 2020 2020 7768 6963 6820 736f 7274        which sort
-00003fa0: 7320 616e 6420 7370 6c69 7473 2074 6865  s and splits the
-00003fb0: 2064 6174 6120 6173 206e 6565 6465 642e   data as needed.
-00003fc0: 0a20 2020 2020 2020 2053 6565 2068 7474  .        See htt
-00003fd0: 7073 3a2f 2f64 6f63 732e 6461 736b 2e6f  ps://docs.dask.o
-00003fe0: 7267 2f65 6e2f 6c61 7465 7374 2f64 6174  rg/en/latest/dat
-00003ff0: 6166 7261 6d65 2d64 6573 6967 6e2e 6874  aframe-design.ht
-00004000: 6d6c 2370 6172 7469 7469 6f6e 732e 0a20  ml#partitions.. 
-00004010: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00004020: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00004030: 6469 7669 7369 6f6e 730a 0a20 2020 2040  divisions..    @
-00004040: 6469 7669 7369 6f6e 732e 7365 7474 6572  divisions.setter
-00004050: 0a20 2020 2064 6566 2064 6976 6973 696f  .    def divisio
-00004060: 6e73 2873 656c 662c 2076 616c 7565 293a  ns(self, value):
-00004070: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00004080: 6973 696e 7374 616e 6365 2876 616c 7565  isinstance(value
-00004090: 2c20 7475 706c 6529 3a0a 2020 2020 2020  , tuple):.      
-000040a0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-000040b0: 4572 726f 7228 2264 6976 6973 696f 6e73  Error("divisions
-000040c0: 206d 7573 7420 6265 2061 2074 7570 6c65   must be a tuple
-000040d0: 2229 0a0a 2020 2020 2020 2020 6966 2068  ")..        if h
-000040e0: 6173 6174 7472 2873 656c 662c 2022 5f64  asattr(self, "_d
-000040f0: 6976 6973 696f 6e73 2229 2061 6e64 206c  ivisions") and l
-00004100: 656e 2876 616c 7565 2920 213d 206c 656e  en(value) != len
-00004110: 2873 656c 662e 5f64 6976 6973 696f 6e73  (self._divisions
-00004120: 293a 0a20 2020 2020 2020 2020 2020 206e  ):.            n
-00004130: 203d 206c 656e 2873 656c 662e 5f64 6976   = len(self._div
-00004140: 6973 696f 6e73 290a 2020 2020 2020 2020  isions).        
-00004150: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00004160: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00004170: 2020 2020 2020 6622 5468 6973 2064 6174        f"This dat
-00004180: 6166 7261 6d65 2068 6173 206e 7061 7274  aframe has npart
-00004190: 6974 696f 6e73 3d7b 6e20 2d20 317d 2c20  itions={n - 1}, 
-000041a0: 6469 7669 7369 6f6e 7320 7368 6f75 6c64  divisions should
-000041b0: 2062 6520 6120 220a 2020 2020 2020 2020   be a ".        
-000041c0: 2020 2020 2020 2020 6622 7475 706c 6520          f"tuple 
-000041d0: 6f66 206c 656e 6774 683d 7b6e 7d2c 2067  of length={n}, g
-000041e0: 6f74 207b 6c65 6e28 7661 6c75 6529 7d22  ot {len(value)}"
-000041f0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00004200: 2020 2020 2020 2020 6966 204e 6f6e 6520          if None 
-00004210: 696e 2076 616c 7565 3a0a 2020 2020 2020  in value:.      
-00004220: 2020 2020 2020 6966 2061 6e79 2876 2069        if any(v i
-00004230: 7320 6e6f 7420 4e6f 6e65 2066 6f72 2076  s not None for v
-00004240: 2069 6e20 7661 6c75 6529 3a0a 2020 2020   in value):.    
-00004250: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00004260: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
-00004270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004280: 2020 2264 6976 6973 696f 6e73 206d 6179    "divisions may
-00004290: 206e 6f74 2063 6f6e 7461 696e 2061 206d   not contain a m
-000042a0: 6978 206f 6620 4e6f 6e65 2061 6e64 206e  ix of None and n
-000042b0: 6f6e 2d4e 6f6e 6520 7661 6c75 6573 220a  on-None values".
-000042c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000042d0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-000042e0: 2020 2020 2020 2020 2020 2020 2320 4b6e              # Kn
-000042f0: 6f77 6e20 6469 7669 7369 6f6e 732c 2063  own divisions, c
-00004300: 6865 636b 206d 6f6e 6f74 6f6e 6963 616c  heck monotonical
-00004310: 6c79 2069 6e63 7265 6173 696e 670a 0a20  ly increasing.. 
-00004320: 2020 2020 2020 2020 2020 2023 2058 5858             # XXX
-00004330: 3a20 6966 2074 6865 2069 6e64 6578 2064  : if the index d
-00004340: 7479 7065 2069 7320 616e 206f 7264 6572  type is an order
-00004350: 6564 2063 6174 6567 6f72 6963 616c 2064  ed categorical d
-00004360: 7479 7065 2c20 7468 656e 2077 6520 736b  type, then we sk
-00004370: 6970 2074 6865 0a20 2020 2020 2020 2020  ip the.         
-00004380: 2020 2023 2073 6f72 7465 646e 6573 7320     # sortedness 
-00004390: 6368 6563 6b2c 2073 696e 6365 2074 6865  check, since the
-000043a0: 206f 7264 6572 2069 7320 6474 7970 6520   order is dtype 
-000043b0: 6465 7065 6e64 656e 740a 2020 2020 2020  dependent.      
-000043c0: 2020 2020 2020 696e 6465 785f 6474 7970        index_dtyp
-000043d0: 6520 3d20 6765 7461 7474 7228 7365 6c66  e = getattr(self
-000043e0: 2e5f 6d65 7461 2c20 2269 6e64 6578 222c  ._meta, "index",
-000043f0: 2073 656c 662e 5f6d 6574 6129 2e64 7479   self._meta).dty
-00004400: 7065 0a20 2020 2020 2020 2020 2020 2069  pe.            i
-00004410: 6620 6e6f 7420 280a 2020 2020 2020 2020  f not (.        
-00004420: 2020 2020 2020 2020 6973 696e 7374 616e          isinstan
-00004430: 6365 2869 6e64 6578 5f64 7479 7065 2c20  ce(index_dtype, 
-00004440: 7064 2e43 6174 6567 6f72 6963 616c 4474  pd.CategoricalDt
-00004450: 7970 6529 2061 6e64 2069 6e64 6578 5f64  ype) and index_d
-00004460: 7479 7065 2e6f 7264 6572 6564 0a20 2020  type.ordered.   
-00004470: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
-00004480: 2020 2020 2020 2020 2020 2020 6966 2076              if v
-00004490: 616c 7565 2021 3d20 7475 706c 6528 736f  alue != tuple(so
-000044a0: 7274 6564 2876 616c 7565 2929 3a0a 2020  rted(value)):.  
-000044b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000044c0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-000044d0: 6f72 2822 6469 7669 7369 6f6e 7320 6d75  or("divisions mu
-000044e0: 7374 2062 6520 736f 7274 6564 2229 0a0a  st be sorted")..
-000044f0: 2020 2020 2020 2020 7365 6c66 2e5f 6469          self._di
-00004500: 7669 7369 6f6e 7320 3d20 7661 6c75 650a  visions = value.
-00004510: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00004520: 2020 2064 6566 206e 7061 7274 6974 696f     def npartitio
-00004530: 6e73 2873 656c 6629 202d 3e20 696e 743a  ns(self) -> int:
-00004540: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00004550: 726e 206e 756d 6265 7220 6f66 2070 6172  rn number of par
-00004560: 7469 7469 6f6e 7322 2222 0a20 2020 2020  titions""".     
-00004570: 2020 2072 6574 7572 6e20 6c65 6e28 7365     return len(se
-00004580: 6c66 2e64 6976 6973 696f 6e73 2920 2d20  lf.divisions) - 
-00004590: 310a 0a20 2020 2040 7072 6f70 6572 7479  1..    @property
-000045a0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-000045b0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-000045c0: 0a20 2020 2064 6566 2061 7474 7273 2873  .    def attrs(s
-000045d0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-000045e0: 7475 726e 2073 656c 662e 5f6d 6574 612e  turn self._meta.
-000045f0: 6174 7472 730a 0a20 2020 2040 6174 7472  attrs..    @attr
-00004600: 732e 7365 7474 6572 0a20 2020 2064 6566  s.setter.    def
-00004610: 2061 7474 7273 2873 656c 662c 2076 616c   attrs(self, val
-00004620: 7565 293a 0a20 2020 2020 2020 2073 656c  ue):.        sel
-00004630: 662e 5f6d 6574 612e 6174 7472 7320 3d20  f._meta.attrs = 
-00004640: 6469 6374 2876 616c 7565 290a 0a20 2020  dict(value)..   
-00004650: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00004660: 6566 2073 697a 6528 7365 6c66 293a 0a20  ef size(self):. 
-00004670: 2020 2020 2020 2022 2222 5369 7a65 206f         """Size o
-00004680: 6620 7468 6520 5365 7269 6573 206f 7220  f the Series or 
-00004690: 4461 7461 4672 616d 6520 6173 2061 2044  DataFrame as a D
-000046a0: 656c 6179 6564 206f 626a 6563 742e 0a0a  elayed object...
-000046b0: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
-000046c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000046d0: 2d0a 2020 2020 2020 2020 3e3e 3e20 7365  -.        >>> se
-000046e0: 7269 6573 2e73 697a 6520 2023 2064 6f63  ries.size  # doc
-000046f0: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
-00004700: 2020 2020 6464 2e53 6361 6c61 723c 7369      dd.Scalar<si
-00004710: 7a65 2d61 672e 2e2e 2c20 6474 7970 653d  ze-ag..., dtype=
-00004720: 696e 7436 343e 0a20 2020 2020 2020 2022  int64>.        "
-00004730: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00004740: 6e20 7365 6c66 2e72 6564 7563 7469 6f6e  n self.reduction
-00004750: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
-00004760: 7468 6f64 732e 7369 7a65 2c20 6e70 2e73  thods.size, np.s
-00004770: 756d 2c20 746f 6b65 6e3d 2273 697a 6522  um, token="size"
-00004780: 2c20 6d65 7461 3d69 6e74 2c20 7370 6c69  , meta=int, spli
-00004790: 745f 6576 6572 793d 4661 6c73 650a 2020  t_every=False.  
-000047a0: 2020 2020 2020 290a 0a20 2020 2040 7072        )..    @pr
-000047b0: 6f70 6572 7479 0a20 2020 2064 6566 205f  operty.    def _
-000047c0: 6d65 7461 5f6e 6f6e 656d 7074 7928 7365  meta_nonempty(se
-000047d0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-000047e0: 4120 6e6f 6e2d 656d 7074 7920 7665 7273  A non-empty vers
-000047f0: 696f 6e20 6f66 2060 5f6d 6574 6160 2077  ion of `_meta` w
-00004800: 6974 6820 6661 6b65 2064 6174 612e 2222  ith fake data.""
-00004810: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00004820: 206d 6574 615f 6e6f 6e65 6d70 7479 2873   meta_nonempty(s
-00004830: 656c 662e 5f6d 6574 6129 0a0a 2020 2020  elf._meta)..    
-00004840: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00004850: 6620 5f61 7267 7328 7365 6c66 293a 0a20  f _args(self):. 
-00004860: 2020 2020 2020 2072 6574 7572 6e20 2873         return (s
-00004870: 656c 662e 6461 736b 2c20 7365 6c66 2e5f  elf.dask, self._
-00004880: 6e61 6d65 2c20 7365 6c66 2e5f 6d65 7461  name, self._meta
-00004890: 2c20 7365 6c66 2e64 6976 6973 696f 6e73  , self.divisions
-000048a0: 290a 0a20 2020 2064 6566 205f 5f67 6574  )..    def __get
-000048b0: 7374 6174 655f 5f28 7365 6c66 293a 0a20  state__(self):. 
-000048c0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000048d0: 6c66 2e5f 6172 6773 0a0a 2020 2020 6465  lf._args..    de
-000048e0: 6620 5f5f 7365 7473 7461 7465 5f5f 2873  f __setstate__(s
-000048f0: 656c 662c 2073 7461 7465 293a 0a20 2020  elf, state):.   
-00004900: 2020 2020 2073 656c 662e 6461 736b 2c20       self.dask, 
-00004910: 7365 6c66 2e5f 6e61 6d65 2c20 7365 6c66  self._name, self
-00004920: 2e5f 6d65 7461 2c20 7365 6c66 2e5f 6469  ._meta, self._di
-00004930: 7669 7369 6f6e 7320 3d20 7374 6174 650a  visions = state.
-00004940: 0a20 2020 2064 6566 2063 6f70 7928 7365  .    def copy(se
-00004950: 6c66 2c20 6465 6570 3d46 616c 7365 293a  lf, deep=False):
-00004960: 0a20 2020 2020 2020 2022 2222 4d61 6b65  .        """Make
-00004970: 2061 2063 6f70 7920 6f66 2074 6865 2064   a copy of the d
-00004980: 6174 6166 7261 6d65 0a0a 2020 2020 2020  ataframe..      
-00004990: 2020 5468 6973 2069 7320 7374 7269 6374    This is strict
-000049a0: 6c79 2061 2073 6861 6c6c 6f77 2063 6f70  ly a shallow cop
-000049b0: 7920 6f66 2074 6865 2075 6e64 6572 6c79  y of the underly
-000049c0: 696e 6720 636f 6d70 7574 6174 696f 6e61  ing computationa
-000049d0: 6c20 6772 6170 682e 0a20 2020 2020 2020  l graph..       
-000049e0: 2049 7420 646f 6573 206e 6f74 2061 6666   It does not aff
-000049f0: 6563 7420 7468 6520 756e 6465 726c 7969  ect the underlyi
-00004a00: 6e67 2064 6174 610a 0a20 2020 2020 2020  ng data..       
-00004a10: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00004a20: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00004a30: 2020 2020 2020 2064 6565 7020 3a20 626f         deep : bo
-00004a40: 6f6c 6561 6e2c 2064 6566 6175 6c74 2046  olean, default F
-00004a50: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00004a60: 2054 6865 2064 6565 7020 7661 6c75 6520   The deep value 
-00004a70: 6d75 7374 2062 6520 6046 616c 7365 6020  must be `False` 
-00004a80: 616e 6420 6974 2069 7320 6465 636c 6172  and it is declar
-00004a90: 6564 2061 7320 6120 7061 7261 6d65 7465  ed as a paramete
-00004aa0: 7220 6a75 7374 2066 6f72 0a20 2020 2020  r just for.     
-00004ab0: 2020 2020 2020 2063 6f6d 7061 7469 6269         compatibi
-00004ac0: 6c69 7479 2077 6974 6820 7468 6972 642d  lity with third-
-00004ad0: 7061 7274 7920 6c69 6272 6172 6965 7320  party libraries 
-00004ae0: 6c69 6b65 2063 7544 460a 2020 2020 2020  like cuDF.      
-00004af0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-00004b00: 2064 6565 7020 6973 206e 6f74 2046 616c   deep is not Fal
-00004b10: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00004b20: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00004b30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00004b40: 2020 2254 6865 2060 6465 6570 6020 7661    "The `deep` va
-00004b50: 6c75 6520 6d75 7374 2062 6520 4661 6c73  lue must be Fals
-00004b60: 652e 2054 6869 7320 6973 2073 7472 6963  e. This is stric
-00004b70: 746c 7920 6120 7368 616c 6c6f 7720 636f  tly a shallow co
-00004b80: 7079 2022 0a20 2020 2020 2020 2020 2020  py ".           
-00004b90: 2020 2020 2022 6f66 2074 6865 2075 6e64       "of the und
-00004ba0: 6572 6c79 696e 6720 636f 6d70 7574 6174  erlying computat
-00004bb0: 696f 6e61 6c20 6772 6170 682e 220a 2020  ional graph.".  
-00004bc0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00004bd0: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
-00004be0: 645f 6f62 6a65 6374 2873 656c 662e 6461  d_object(self.da
-00004bf0: 736b 2c20 7365 6c66 2e5f 6e61 6d65 2c20  sk, self._name, 
-00004c00: 7365 6c66 2e5f 6d65 7461 2c20 7365 6c66  self._meta, self
-00004c10: 2e64 6976 6973 696f 6e73 290a 0a20 2020  .divisions)..   
-00004c20: 2064 6566 205f 5f61 7272 6179 5f5f 2873   def __array__(s
-00004c30: 656c 662c 2064 7479 7065 3d4e 6f6e 652c  elf, dtype=None,
-00004c40: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
-00004c50: 2020 2020 7365 6c66 2e5f 636f 6d70 7574      self._comput
-00004c60: 6564 203d 2073 656c 662e 636f 6d70 7574  ed = self.comput
-00004c70: 6528 290a 2020 2020 2020 2020 7820 3d20  e().        x = 
-00004c80: 6e70 2e61 7272 6179 2873 656c 662e 5f63  np.array(self._c
-00004c90: 6f6d 7075 7465 6429 0a20 2020 2020 2020  omputed).       
-00004ca0: 2072 6574 7572 6e20 780a 0a20 2020 2064   return x..    d
-00004cb0: 6566 205f 5f61 7272 6179 5f77 7261 705f  ef __array_wrap_
-00004cc0: 5f28 7365 6c66 2c20 6172 7261 792c 2063  _(self, array, c
-00004cd0: 6f6e 7465 7874 3d4e 6f6e 6529 3a0a 2020  ontext=None):.  
-00004ce0: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
-00004cf0: 6d70 6c65 6d65 6e74 6564 4572 726f 720a  mplementedError.
-00004d00: 0a20 2020 2064 6566 205f 5f61 7272 6179  .    def __array
-00004d10: 5f75 6675 6e63 5f5f 2873 656c 662c 206e  _ufunc__(self, n
-00004d20: 756d 7079 5f75 6675 6e63 2c20 6d65 7468  umpy_ufunc, meth
-00004d30: 6f64 2c20 2a69 6e70 7574 732c 202a 2a6b  od, *inputs, **k
-00004d40: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
-00004d50: 6f75 7420 3d20 6b77 6172 6773 2e67 6574  out = kwargs.get
-00004d60: 2822 6f75 7422 2c20 2829 290a 2020 2020  ("out", ()).    
-00004d70: 2020 2020 666f 7220 7820 696e 2069 6e70      for x in inp
-00004d80: 7574 7320 2b20 6f75 743a 0a20 2020 2020  uts + out:.     
-00004d90: 2020 2020 2020 2023 2075 6675 6e63 7320         # ufuncs 
-00004da0: 776f 726b 2077 6974 6820 302d 6469 6d65  work with 0-dime
-00004db0: 6e73 696f 6e61 6c20 4e75 6d50 7920 6e64  nsional NumPy nd
-00004dc0: 6172 7261 7973 0a20 2020 2020 2020 2020  arrays.         
-00004dd0: 2020 2023 2073 6f20 7765 2064 6f6e 2774     # so we don't
-00004de0: 2077 616e 7420 746f 2072 6169 7365 204e   want to raise N
-00004df0: 6f74 496d 706c 656d 656e 7465 640a 2020  otImplemented.  
-00004e00: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-00004e10: 6e73 7461 6e63 6528 782c 206e 702e 6e64  nstance(x, np.nd
-00004e20: 6172 7261 7929 2061 6e64 2078 2e73 6861  array) and x.sha
-00004e30: 7065 203d 3d20 2829 3a0a 2020 2020 2020  pe == ():.      
-00004e40: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
-00004e50: 7565 0a20 2020 2020 2020 2020 2020 2065  ue.            e
-00004e60: 6c69 6620 6e6f 7420 6973 696e 7374 616e  lif not isinstan
-00004e70: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
-00004e80: 2020 2020 782c 2028 4e75 6d62 6572 2c20      x, (Number, 
-00004e90: 5363 616c 6172 2c20 5f46 7261 6d65 2c20  Scalar, _Frame, 
-00004ea0: 4172 7261 792c 2070 642e 4461 7461 4672  Array, pd.DataFr
-00004eb0: 616d 652c 2070 642e 5365 7269 6573 2c20  ame, pd.Series, 
-00004ec0: 7064 2e49 6e64 6578 290a 2020 2020 2020  pd.Index).      
-00004ed0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-00004ee0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00004ef0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 0a0a  NotImplemented..
-00004f00: 2020 2020 2020 2020 6966 206d 6574 686f          if metho
-00004f10: 6420 3d3d 2022 5f5f 6361 6c6c 5f5f 223a  d == "__call__":
-00004f20: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00004f30: 6e75 6d70 795f 7566 756e 632e 7369 676e  numpy_ufunc.sign
-00004f40: 6174 7572 6520 6973 206e 6f74 204e 6f6e  ature is not Non
-00004f50: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00004f60: 2020 2072 6574 7572 6e20 4e6f 7449 6d70     return NotImp
-00004f70: 6c65 6d65 6e74 6564 0a20 2020 2020 2020  lemented.       
-00004f80: 2020 2020 2069 6620 6e75 6d70 795f 7566       if numpy_uf
-00004f90: 756e 632e 6e6f 7574 203e 2031 3a0a 2020  unc.nout > 1:.  
-00004fa0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00004fb0: 7566 756e 6373 2077 6974 6820 6d75 6c74  ufuncs with mult
-00004fc0: 6970 6c65 206f 7574 7075 7420 7661 6c75  iple output valu
-00004fd0: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
-00004fe0: 2020 2023 2061 7265 206e 6f74 2079 6574     # are not yet
-00004ff0: 2073 7570 706f 7274 6564 2066 6f72 2066   supported for f
-00005000: 7261 6d65 730a 2020 2020 2020 2020 2020  rames.          
-00005010: 2020 2020 2020 7265 7475 726e 204e 6f74        return Not
-00005020: 496d 706c 656d 656e 7465 640a 2020 2020  Implemented.    
-00005030: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00005040: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00005050: 7475 726e 2065 6c65 6d77 6973 6528 6e75  turn elemwise(nu
-00005060: 6d70 795f 7566 756e 632c 202a 696e 7075  mpy_ufunc, *inpu
-00005070: 7473 2c20 2a2a 6b77 6172 6773 290a 2020  ts, **kwargs).  
-00005080: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00005090: 2020 2020 2020 2020 2320 7566 756e 6320          # ufunc 
-000050a0: 6d65 7468 6f64 7320 6172 6520 6e6f 7420  methods are not 
-000050b0: 7965 7420 7375 7070 6f72 7465 6420 666f  yet supported fo
-000050c0: 7220 6672 616d 6573 0a20 2020 2020 2020  r frames.       
-000050d0: 2020 2020 2072 6574 7572 6e20 4e6f 7449       return NotI
-000050e0: 6d70 6c65 6d65 6e74 6564 0a0a 2020 2020  mplemented..    
-000050f0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00005100: 6620 5f65 6c65 6d77 6973 6528 7365 6c66  f _elemwise(self
-00005110: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00005120: 6e20 656c 656d 7769 7365 0a0a 2020 2020  n elemwise..    
-00005130: 6465 6620 5f72 6570 725f 6461 7461 2873  def _repr_data(s
-00005140: 656c 6629 3a0a 2020 2020 2020 2020 7261  elf):.        ra
-00005150: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-00005160: 6564 4572 726f 720a 0a20 2020 2040 7072  edError..    @pr
-00005170: 6f70 6572 7479 0a20 2020 2064 6566 205f  operty.    def _
-00005180: 7265 7072 5f64 6976 6973 696f 6e73 2873  repr_divisions(s
-00005190: 656c 6629 3a0a 2020 2020 2020 2020 6e61  elf):.        na
-000051a0: 6d65 203d 2066 226e 7061 7274 6974 696f  me = f"npartitio
-000051b0: 6e73 3d7b 7365 6c66 2e6e 7061 7274 6974  ns={self.npartit
-000051c0: 696f 6e73 7d22 0a20 2020 2020 2020 2069  ions}".        i
-000051d0: 6620 7365 6c66 2e6b 6e6f 776e 5f64 6976  f self.known_div
-000051e0: 6973 696f 6e73 3a0a 2020 2020 2020 2020  isions:.        
-000051f0: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
-00005200: 7064 2e49 6e64 6578 2873 656c 662e 6469  pd.Index(self.di
-00005210: 7669 7369 6f6e 732c 206e 616d 653d 6e61  visions, name=na
-00005220: 6d65 290a 2020 2020 2020 2020 656c 7365  me).        else
-00005230: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-00005240: 6176 6f69 6420 746f 2062 6520 636f 6e76  avoid to be conv
-00005250: 6572 7465 6420 746f 204e 614e 0a20 2020  erted to NaN.   
-00005260: 2020 2020 2020 2020 2064 6976 6973 696f           divisio
-00005270: 6e73 203d 2070 642e 496e 6465 7828 5b22  ns = pd.Index(["
-00005280: 225d 202a 2028 7365 6c66 2e6e 7061 7274  "] * (self.npart
-00005290: 6974 696f 6e73 202b 2031 292c 206e 616d  itions + 1), nam
-000052a0: 653d 6e61 6d65 290a 2020 2020 2020 2020  e=name).        
-000052b0: 7265 7475 726e 2064 6976 6973 696f 6e73  return divisions
-000052c0: 0a0a 2020 2020 6465 6620 5f5f 7265 7072  ..    def __repr
-000052d0: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-000052e0: 2020 6461 7461 203d 2073 656c 662e 5f72    data = self._r
-000052f0: 6570 725f 6461 7461 2829 2e74 6f5f 7374  epr_data().to_st
-00005300: 7269 6e67 286d 6178 5f72 6f77 733d 352c  ring(max_rows=5,
-00005310: 2073 686f 775f 6469 6d65 6e73 696f 6e73   show_dimensions
-00005320: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
-00005330: 5f73 7472 5f66 6d74 203d 2022 2222 4461  _str_fmt = """Da
-00005340: 736b 207b 6b6c 6173 737d 2053 7472 7563  sk {klass} Struc
-00005350: 7475 7265 3a0a 7b64 6174 617d 0a44 6173  ture:.{data}.Das
-00005360: 6b20 4e61 6d65 3a20 7b6e 616d 657d 2c20  k Name: {name}, 
-00005370: 7b6c 6179 6572 737d 2222 220a 2020 2020  {layers}""".    
-00005380: 2020 2020 6966 206c 656e 2873 656c 662e      if len(self.
-00005390: 636f 6c75 6d6e 7329 203d 3d20 303a 0a20  columns) == 0:. 
-000053a0: 2020 2020 2020 2020 2020 2064 6174 6120             data 
-000053b0: 3d20 6461 7461 2e70 6172 7469 7469 6f6e  = data.partition
-000053c0: 2822 5c6e 2229 5b2d 315d 2e72 6570 6c61  ("\n")[-1].repla
-000053d0: 6365 2822 496e 6465 7822 2c20 2244 6976  ce("Index", "Div
-000053e0: 6973 696f 6e73 2229 0a20 2020 2020 2020  isions").       
-000053f0: 2020 2020 205f 7374 725f 666d 7420 3d20       _str_fmt = 
-00005400: 6622 456d 7074 7920 7b5f 7374 725f 666d  f"Empty {_str_fm
-00005410: 747d 220a 2020 2020 2020 2020 7265 7475  t}".        retu
-00005420: 726e 205f 7374 725f 666d 742e 666f 726d  rn _str_fmt.form
-00005430: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
-00005440: 6b6c 6173 733d 7365 6c66 2e5f 5f63 6c61  klass=self.__cla
-00005450: 7373 5f5f 2e5f 5f6e 616d 655f 5f2c 0a20  ss__.__name__,. 
-00005460: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-00005470: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
-00005480: 2020 6e61 6d65 3d6b 6579 5f73 706c 6974    name=key_split
-00005490: 2873 656c 662e 5f6e 616d 6529 2c0a 2020  (self._name),.  
-000054a0: 2020 2020 2020 2020 2020 6c61 7965 7273            layers
-000054b0: 3d6d 6179 6265 5f70 6c75 7261 6c69 7a65  =maybe_pluralize
-000054c0: 286c 656e 2873 656c 662e 6461 736b 2e6c  (len(self.dask.l
-000054d0: 6179 6572 7329 2c20 2267 7261 7068 206c  ayers), "graph l
-000054e0: 6179 6572 2229 2c0a 2020 2020 2020 2020  ayer"),.        
-000054f0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-00005500: 0a20 2020 2064 6566 2069 6e64 6578 2873  .    def index(s
-00005510: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00005520: 2252 6574 7572 6e20 6461 736b 2049 6e64  "Return dask Ind
-00005530: 6578 2069 6e73 7461 6e63 6522 2222 0a20  ex instance""". 
-00005540: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00005550: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-00005560: 7328 0a20 2020 2020 2020 2020 2020 2067  s(.            g
-00005570: 6574 6174 7472 2c0a 2020 2020 2020 2020  etattr,.        
-00005580: 2020 2020 2269 6e64 6578 222c 0a20 2020      "index",.   
-00005590: 2020 2020 2020 2020 2074 6f6b 656e 3d6b           token=k
-000055a0: 6579 5f73 706c 6974 2873 656c 662e 5f6e  ey_split(self._n
-000055b0: 616d 6529 202b 2022 2d69 6e64 6578 222c  ame) + "-index",
-000055c0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-000055d0: 613d 7365 6c66 2e5f 6d65 7461 2e69 6e64  a=self._meta.ind
-000055e0: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
-000055f0: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-00005600: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00005610: 290a 0a20 2020 2040 696e 6465 782e 7365  )..    @index.se
-00005620: 7474 6572 0a20 2020 2064 6566 2069 6e64  tter.    def ind
-00005630: 6578 2873 656c 662c 2076 616c 7565 293a  ex(self, value):
-00005640: 0a20 2020 2020 2020 2073 656c 662e 6469  .        self.di
-00005650: 7669 7369 6f6e 7320 3d20 7661 6c75 652e  visions = value.
-00005660: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
-00005670: 2020 7265 7375 6c74 203d 206d 6170 5f70    result = map_p
-00005680: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-00005690: 2020 2020 2020 206d 6574 686f 6473 2e61         methods.a
-000056a0: 7373 6967 6e5f 696e 6465 782c 2073 656c  ssign_index, sel
-000056b0: 662c 2076 616c 7565 2c20 656e 666f 7263  f, value, enforc
-000056c0: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
-000056d0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-000056e0: 2020 2073 656c 662e 6461 736b 203d 2072     self.dask = r
-000056f0: 6573 756c 742e 6461 736b 0a20 2020 2020  esult.dask.     
-00005700: 2020 2073 656c 662e 5f6e 616d 6520 3d20     self._name = 
-00005710: 7265 7375 6c74 2e5f 6e61 6d65 0a20 2020  result._name.   
-00005720: 2020 2020 2073 656c 662e 5f6d 6574 6120       self._meta 
-00005730: 3d20 7265 7375 6c74 2e5f 6d65 7461 0a0a  = result._meta..
-00005740: 2020 2020 6465 6620 7265 7365 745f 696e      def reset_in
-00005750: 6465 7828 7365 6c66 2c20 6472 6f70 3d46  dex(self, drop=F
-00005760: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
-00005770: 2222 5265 7365 7420 7468 6520 696e 6465  ""Reset the inde
-00005780: 7820 746f 2074 6865 2064 6566 6175 6c74  x to the default
-00005790: 2069 6e64 6578 2e0a 0a20 2020 2020 2020   index...       
-000057a0: 204e 6f74 6520 7468 6174 2075 6e6c 696b   Note that unlik
-000057b0: 6520 696e 2060 6070 616e 6461 7360 602c  e in ``pandas``,
-000057c0: 2074 6865 2072 6573 6574 2060 6064 6173   the reset ``das
-000057d0: 6b2e 6461 7461 6672 616d 6560 6020 696e  k.dataframe`` in
-000057e0: 6465 7820 7769 6c6c 0a20 2020 2020 2020  dex will.       
-000057f0: 206e 6f74 2062 6520 6d6f 6e6f 746f 6e69   not be monotoni
-00005800: 6361 6c6c 7920 696e 6372 6561 7369 6e67  cally increasing
-00005810: 2066 726f 6d20 302e 2049 6e73 7465 6164   from 0. Instead
-00005820: 2c20 6974 2077 696c 6c20 7265 7374 6172  , it will restar
-00005830: 7420 6174 2030 0a20 2020 2020 2020 2066  t at 0.        f
-00005840: 6f72 2065 6163 6820 7061 7274 6974 696f  or each partitio
-00005850: 6e20 2865 2e67 2e20 6060 696e 6465 7831  n (e.g. ``index1
-00005860: 203d 205b 302c 202e 2e2e 2c20 3130 5d2c   = [0, ..., 10],
-00005870: 2069 6e64 6578 3220 3d20 5b30 2c20 2e2e   index2 = [0, ..
-00005880: 2e5d 6060 292e 0a20 2020 2020 2020 2054  .]``)..        T
-00005890: 6869 7320 6973 2064 7565 2074 6f20 7468  his is due to th
-000058a0: 6520 696e 6162 696c 6974 7920 746f 2073  e inability to s
-000058b0: 7461 7469 6361 6c6c 7920 6b6e 6f77 2074  tatically know t
-000058c0: 6865 2066 756c 6c20 6c65 6e67 7468 206f  he full length o
-000058d0: 6620 7468 650a 2020 2020 2020 2020 696e  f the.        in
-000058e0: 6465 782e 0a0a 2020 2020 2020 2020 466f  dex...        Fo
-000058f0: 7220 4461 7461 4672 616d 6520 7769 7468  r DataFrame with
-00005900: 206d 756c 7469 2d6c 6576 656c 2069 6e64   multi-level ind
-00005910: 6578 2c20 7265 7475 726e 7320 6120 6e65  ex, returns a ne
-00005920: 7720 4461 7461 4672 616d 6520 7769 7468  w DataFrame with
-00005930: 0a20 2020 2020 2020 206c 6162 656c 696e  .        labelin
-00005940: 6720 696e 666f 726d 6174 696f 6e20 696e  g information in
-00005950: 2074 6865 2063 6f6c 756d 6e73 2075 6e64   the columns und
-00005960: 6572 2074 6865 2069 6e64 6578 206e 616d  er the index nam
-00005970: 6573 2c20 6465 6661 756c 7469 6e67 0a20  es, defaulting. 
-00005980: 2020 2020 2020 2074 6f20 276c 6576 656c         to 'level
-00005990: 5f30 272c 2027 6c65 7665 6c5f 3127 2c20  _0', 'level_1', 
-000059a0: 6574 632e 2069 6620 616e 7920 6172 6520  etc. if any are 
-000059b0: 4e6f 6e65 2e20 466f 7220 6120 7374 616e  None. For a stan
-000059c0: 6461 7264 2069 6e64 6578 2c0a 2020 2020  dard index,.    
-000059d0: 2020 2020 7468 6520 696e 6465 7820 6e61      the index na
-000059e0: 6d65 2077 696c 6c20 6265 2075 7365 6420  me will be used 
-000059f0: 2869 6620 7365 7429 2c20 6f74 6865 7277  (if set), otherw
-00005a00: 6973 6520 6120 6465 6661 756c 7420 2769  ise a default 'i
-00005a10: 6e64 6578 2720 6f72 0a20 2020 2020 2020  ndex' or.       
-00005a20: 2027 6c65 7665 6c5f 3027 2028 6966 2027   'level_0' (if '
-00005a30: 696e 6465 7827 2069 7320 616c 7265 6164  index' is alread
-00005a40: 7920 7461 6b65 6e29 2077 696c 6c20 6265  y taken) will be
-00005a50: 2075 7365 642e 0a0a 2020 2020 2020 2020   used...        
-00005a60: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-00005a70: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00005a80: 2020 2020 2020 6472 6f70 203a 2062 6f6f        drop : boo
-00005a90: 6c65 616e 2c20 6465 6661 756c 7420 4661  lean, default Fa
-00005aa0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-00005ab0: 446f 206e 6f74 2074 7279 2074 6f20 696e  Do not try to in
-00005ac0: 7365 7274 2069 6e64 6578 2069 6e74 6f20  sert index into 
-00005ad0: 6461 7461 6672 616d 6520 636f 6c75 6d6e  dataframe column
-00005ae0: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
-00005af0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00005b00: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-00005b10: 7328 0a20 2020 2020 2020 2020 2020 204d  s(.            M
-00005b20: 2e72 6573 6574 5f69 6e64 6578 2c20 6472  .reset_index, dr
-00005b30: 6f70 3d64 726f 702c 2065 6e66 6f72 6365  op=drop, enforce
-00005b40: 5f6d 6574 6164 6174 613d 4661 6c73 650a  _metadata=False.
-00005b50: 2020 2020 2020 2020 292e 636c 6561 725f          ).clear_
-00005b60: 6469 7669 7369 6f6e 7328 290a 0a20 2020  divisions()..   
-00005b70: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00005b80: 6566 206b 6e6f 776e 5f64 6976 6973 696f  ef known_divisio
-00005b90: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
-00005ba0: 2020 2222 2257 6865 7468 6572 2064 6976    """Whether div
-00005bb0: 6973 696f 6e73 2061 7265 2061 6c72 6561  isions are alrea
-00005bc0: 6479 206b 6e6f 776e 2222 220a 2020 2020  dy known""".    
-00005bd0: 2020 2020 7265 7475 726e 206c 656e 2873      return len(s
-00005be0: 656c 662e 6469 7669 7369 6f6e 7329 203e  elf.divisions) >
-00005bf0: 2030 2061 6e64 2073 656c 662e 6469 7669   0 and self.divi
-00005c00: 7369 6f6e 735b 305d 2069 7320 6e6f 7420  sions[0] is not 
-00005c10: 4e6f 6e65 0a0a 2020 2020 6465 6620 636c  None..    def cl
-00005c20: 6561 725f 6469 7669 7369 6f6e 7328 7365  ear_divisions(se
-00005c30: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00005c40: 466f 7267 6574 2064 6976 6973 696f 6e20  Forget division 
-00005c50: 696e 666f 726d 6174 696f 6e22 2222 0a20  information""". 
-00005c60: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
-00005c70: 203d 2028 4e6f 6e65 2c29 202a 2028 7365   = (None,) * (se
-00005c80: 6c66 2e6e 7061 7274 6974 696f 6e73 202b  lf.npartitions +
-00005c90: 2031 290a 2020 2020 2020 2020 7265 7475   1).        retu
-00005ca0: 726e 2074 7970 6528 7365 6c66 2928 7365  rn type(self)(se
-00005cb0: 6c66 2e64 6173 6b2c 2073 656c 662e 5f6e  lf.dask, self._n
-00005cc0: 616d 652c 2073 656c 662e 5f6d 6574 612c  ame, self._meta,
-00005cd0: 2064 6976 6973 696f 6e73 290a 0a20 2020   divisions)..   
-00005ce0: 2064 6566 2063 6f6d 7075 7465 5f63 7572   def compute_cur
-00005cf0: 7265 6e74 5f64 6976 6973 696f 6e73 2873  rent_divisions(s
-00005d00: 656c 662c 2063 6f6c 3d4e 6f6e 6529 3a0a  elf, col=None):.
-00005d10: 2020 2020 2020 2020 2222 2243 6f6d 7075          """Compu
-00005d20: 7465 2074 6865 2063 7572 7265 6e74 2064  te the current d
-00005d30: 6976 6973 696f 6e73 206f 6620 7468 6520  ivisions of the 
-00005d40: 4461 7461 4672 616d 652e 0a0a 2020 2020  DataFrame...    
-00005d50: 2020 2020 5468 6973 206d 6574 686f 6420      This method 
-00005d60: 7472 6967 6765 7273 2069 6d6d 6564 6961  triggers immedia
-00005d70: 7465 2063 6f6d 7075 7461 7469 6f6e 2e20  te computation. 
-00005d80: 4966 2079 6f75 2066 696e 6420 796f 7572  If you find your
-00005d90: 7365 6c66 2072 756e 6e69 6e67 2074 6869  self running thi
-00005da0: 7320 636f 6d6d 616e 640a 2020 2020 2020  s command.      
-00005db0: 2020 7265 7065 6174 6564 6c79 2066 6f72    repeatedly for
-00005dc0: 2074 6865 2073 616d 6520 6461 7461 6672   the same datafr
-00005dd0: 616d 652c 2077 6520 7265 636f 6d6d 656e  ame, we recommen
-00005de0: 6420 7374 6f72 696e 6720 7468 6520 7265  d storing the re
-00005df0: 7375 6c74 0a20 2020 2020 2020 2073 6f20  sult.        so 
-00005e00: 796f 7520 646f 6e27 7420 6861 7665 2074  you don't have t
-00005e10: 6f20 7265 7275 6e20 6974 2e0a 0a20 2020  o rerun it...   
-00005e20: 2020 2020 2049 6620 7468 6520 636f 6c75       If the colu
-00005e30: 6d6e 206f 7220 696e 6465 7820 7661 6c75  mn or index valu
-00005e40: 6573 206f 7665 726c 6170 2062 6574 7765  es overlap betwe
-00005e50: 656e 2070 6172 7469 7469 6f6e 732c 2072  en partitions, r
-00005e60: 6169 7365 7320 6060 5661 6c75 6545 7272  aises ``ValueErr
-00005e70: 6f72 6060 2e0a 2020 2020 2020 2020 546f  or``..        To
-00005e80: 2070 7265 7665 6e74 2074 6869 732c 206d   prevent this, m
-00005e90: 616b 6520 7375 7265 2074 6865 2064 6174  ake sure the dat
-00005ea0: 6120 6172 6520 736f 7274 6564 2062 7920  a are sorted by 
-00005eb0: 7468 6520 636f 6c75 6d6e 206f 7220 696e  the column or in
-00005ec0: 6465 782e 0a0a 2020 2020 2020 2020 5061  dex...        Pa
-00005ed0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-00005ee0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00005ef0: 2020 2020 636f 6c20 3a20 7374 7269 6e67      col : string
-00005f00: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00005f10: 2020 2020 2020 2043 616c 6375 6c61 7465         Calculate
-00005f20: 2074 6865 2064 6976 6973 696f 6e73 2066   the divisions f
-00005f30: 6f72 2061 206e 6f6e 2d69 6e64 6578 2063  or a non-index c
-00005f40: 6f6c 756d 6e20 6279 2070 6173 7369 6e67  olumn by passing
-00005f50: 2069 6e20 7468 6520 6e61 6d65 206f 6620   in the name of 
-00005f60: 7468 6520 636f 6c75 6d6e 2e0a 2020 2020  the column..    
-00005f70: 2020 2020 2020 2020 4966 2063 6f6c 2069          If col i
-00005f80: 7320 6e6f 7420 7370 6563 6966 6965 642c  s not specified,
-00005f90: 2074 6865 2069 6e64 6578 2077 696c 6c20   the index will 
-00005fa0: 6265 2075 7365 6420 746f 2063 616c 6375  be used to calcu
-00005fb0: 6c61 7465 2064 6976 6973 696f 6e73 2e0a  late divisions..
-00005fc0: 2020 2020 2020 2020 2020 2020 496e 2074              In t
-00005fd0: 6869 7320 6361 7365 2c20 6966 2074 6865  his case, if the
-00005fe0: 2064 6976 6973 696f 6e73 2061 7265 2061   divisions are a
-00005ff0: 6c72 6561 6479 206b 6e6f 776e 2c20 7468  lready known, th
-00006000: 6579 2077 696c 6c20 6265 2072 6574 7572  ey will be retur
-00006010: 6e65 640a 2020 2020 2020 2020 2020 2020  ned.            
-00006020: 696d 6d65 6469 6174 656c 7920 7769 7468  immediately with
-00006030: 6f75 7420 636f 6d70 7574 696e 672e 0a0a  out computing...
-00006040: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
-00006050: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00006060: 2d0a 2020 2020 2020 2020 3e3e 3e20 696d  -.        >>> im
-00006070: 706f 7274 2064 6173 6b0a 2020 2020 2020  port dask.      
-00006080: 2020 3e3e 3e20 6464 6620 3d20 6461 736b    >>> ddf = dask
-00006090: 2e64 6174 6173 6574 732e 7469 6d65 7365  .datasets.timese
-000060a0: 7269 6573 2873 7461 7274 3d22 3230 3231  ries(start="2021
-000060b0: 2d30 312d 3031 222c 2065 6e64 3d22 3230  -01-01", end="20
-000060c0: 3231 2d30 312d 3037 222c 2066 7265 713d  21-01-07", freq=
-000060d0: 2231 4822 292e 636c 6561 725f 6469 7669  "1H").clear_divi
-000060e0: 7369 6f6e 7328 290a 2020 2020 2020 2020  sions().        
-000060f0: 3e3e 3e20 6469 7669 7369 6f6e 7320 3d20  >>> divisions = 
-00006100: 6464 662e 636f 6d70 7574 655f 6375 7272  ddf.compute_curr
-00006110: 656e 745f 6469 7669 7369 6f6e 7328 290a  ent_divisions().
-00006120: 2020 2020 2020 2020 3e3e 3e20 7072 696e          >>> prin
-00006130: 7428 6469 7669 7369 6f6e 7329 2020 2320  t(divisions)  # 
-00006140: 646f 6374 6573 743a 202b 4e4f 524d 414c  doctest: +NORMAL
-00006150: 495a 455f 5748 4954 4553 5041 4345 0a20  IZE_WHITESPACE. 
-00006160: 2020 2020 2020 2028 5469 6d65 7374 616d         (Timestam
-00006170: 7028 2732 3032 312d 3031 2d30 3120 3030  p('2021-01-01 00
-00006180: 3a30 303a 3030 2729 2c0a 2020 2020 2020  :00:00'),.      
-00006190: 2020 2054 696d 6573 7461 6d70 2827 3230     Timestamp('20
-000061a0: 3231 2d30 312d 3032 2030 303a 3030 3a30  21-01-02 00:00:0
-000061b0: 3027 292c 0a20 2020 2020 2020 2020 5469  0'),.         Ti
-000061c0: 6d65 7374 616d 7028 2732 3032 312d 3031  mestamp('2021-01
-000061d0: 2d30 3320 3030 3a30 303a 3030 2729 2c0a  -03 00:00:00'),.
-000061e0: 2020 2020 2020 2020 2054 696d 6573 7461           Timesta
-000061f0: 6d70 2827 3230 3231 2d30 312d 3034 2030  mp('2021-01-04 0
-00006200: 303a 3030 3a30 3027 292c 0a20 2020 2020  0:00:00'),.     
-00006210: 2020 2020 5469 6d65 7374 616d 7028 2732      Timestamp('2
-00006220: 3032 312d 3031 2d30 3520 3030 3a30 303a  021-01-05 00:00:
+00003650: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00003660: 2020 2020 2020 2020 6f72 2028 0a20 2020          or (.   
+00003670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003680: 2020 2020 2069 735f 6f62 6a65 6374 5f73       is_object_s
+00003690: 7472 696e 675f 7365 7269 6573 286d 6574  tring_series(met
+000036a0: 6129 0a20 2020 2020 2020 2020 2020 2020  a).             
+000036b0: 2020 2020 2020 2020 2020 2061 6e64 206e             and n
+000036c0: 6f74 2069 735f 6f62 6a65 6374 5f73 7472  ot is_object_str
+000036d0: 696e 675f 6474 7970 6528 6d65 7461 2e64  ing_dtype(meta.d
+000036e0: 7479 7065 290a 2020 2020 2020 2020 2020  type).          
+000036f0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00003700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003710: 6f72 2069 735f 6f62 6a65 6374 5f73 7472  or is_object_str
+00003720: 696e 675f 696e 6465 7828 6d65 7461 290a  ing_index(meta).
+00003730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003740: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00003750: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
+00003760: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00003770: 2074 6869 7320 6973 2061 6e20 696e 7465   this is an inte
+00003780: 726e 616c 2063 616c 6c2c 2061 6e64 2069  rnal call, and i
+00003790: 6620 7765 2065 6e66 6f72 6365 206d 6574  f we enforce met
+000037a0: 6164 6174 612c 0a20 2020 2020 2020 2020  adata,.         
+000037b0: 2020 2020 2020 2023 2069 7420 6d61 7920         # it may 
+000037c0: 696e 7465 7266 6572 6520 7768 656e 2072  interfere when r
+000037d0: 6561 6469 6e67 2063 7376 2077 6974 6820  eading csv with 
+000037e0: 656e 666f 7263 653d 4661 6c73 650a 2020  enforce=False.  
+000037f0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00003800: 7375 6c74 203d 2073 656c 662e 6d61 705f  sult = self.map_
+00003810: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+00003820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003830: 746f 5f70 7961 7272 6f77 5f73 7472 696e  to_pyarrow_strin
+00003840: 672c 2065 6e66 6f72 6365 5f6d 6574 6164  g, enforce_metad
+00003850: 6174 613d 4661 6c73 652c 2074 6f6b 656e  ata=False, token
+00003860: 3d22 746f 5f70 7961 7272 6f77 5f73 7472  ="to_pyarrow_str
+00003870: 696e 6722 0a20 2020 2020 2020 2020 2020  ing".           
+00003880: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00003890: 2020 2020 2020 2073 656c 662e 6461 736b         self.dask
+000038a0: 203d 2072 6573 756c 742e 6461 736b 0a20   = result.dask. 
+000038b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000038c0: 656c 662e 5f6e 616d 6520 3d20 7265 7375  elf._name = resu
+000038d0: 6c74 2e5f 6e61 6d65 0a20 2020 2020 2020  lt._name.       
+000038e0: 2020 2020 2020 2020 2073 656c 662e 5f6d           self._m
+000038f0: 6574 6120 3d20 7265 7375 6c74 2e5f 6d65  eta = result._me
+00003900: 7461 0a20 2020 2020 2020 2020 2020 2020  ta.             
+00003910: 2020 2073 656c 662e 6469 7669 7369 6f6e     self.division
+00003920: 7320 3d20 7265 7375 6c74 2e64 6976 6973  s = result.divis
+00003930: 696f 6e73 0a0a 2020 2020 6465 6620 5f5f  ions..    def __
+00003940: 6461 736b 5f67 7261 7068 5f5f 2873 656c  dask_graph__(sel
+00003950: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00003960: 726e 2073 656c 662e 6461 736b 0a0a 2020  rn self.dask..  
+00003970: 2020 6465 6620 5f5f 6461 736b 5f6b 6579    def __dask_key
+00003980: 735f 5f28 7365 6c66 2920 2d3e 206c 6973  s__(self) -> lis
+00003990: 745b 4861 7368 6162 6c65 5d3a 0a20 2020  t[Hashable]:.   
+000039a0: 2020 2020 2072 6574 7572 6e20 5b28 7365       return [(se
+000039b0: 6c66 2e5f 6e61 6d65 2c20 6929 2066 6f72  lf._name, i) for
+000039c0: 2069 2069 6e20 7261 6e67 6528 7365 6c66   i in range(self
+000039d0: 2e6e 7061 7274 6974 696f 6e73 295d 0a0a  .npartitions)]..
+000039e0: 2020 2020 6465 6620 5f5f 6461 736b 5f6c      def __dask_l
+000039f0: 6179 6572 735f 5f28 7365 6c66 293a 0a20  ayers__(self):. 
+00003a00: 2020 2020 2020 2072 6574 7572 6e20 2873         return (s
+00003a10: 656c 662e 5f6e 616d 652c 290a 0a20 2020  elf._name,)..   
+00003a20: 2064 6566 205f 5f64 6173 6b5f 746f 6b65   def __dask_toke
+00003a30: 6e69 7a65 5f5f 2873 656c 6629 3a0a 2020  nize__(self):.  
+00003a40: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00003a50: 662e 5f6e 616d 650a 0a20 2020 205f 5f64  f._name..    __d
+00003a60: 6173 6b5f 6f70 7469 6d69 7a65 5f5f 203d  ask_optimize__ =
+00003a70: 2067 6c6f 6261 6c6d 6574 686f 6428 0a20   globalmethod(. 
+00003a80: 2020 2020 2020 206f 7074 696d 697a 652c         optimize,
+00003a90: 206b 6579 3d22 6461 7461 6672 616d 655f   key="dataframe_
+00003aa0: 6f70 7469 6d69 7a65 222c 2066 616c 7365  optimize", false
+00003ab0: 793d 646f 6e74 5f6f 7074 696d 697a 650a  y=dont_optimize.
+00003ac0: 2020 2020 290a 2020 2020 5f5f 6461 736b      ).    __dask
+00003ad0: 5f73 6368 6564 756c 6572 5f5f 203d 2073  _scheduler__ = s
+00003ae0: 7461 7469 636d 6574 686f 6428 4445 4641  taticmethod(DEFA
+00003af0: 554c 545f 4745 5429 0a0a 2020 2020 6465  ULT_GET)..    de
+00003b00: 6620 5f5f 6461 736b 5f70 6f73 7463 6f6d  f __dask_postcom
+00003b10: 7075 7465 5f5f 2873 656c 6629 3a0a 2020  pute__(self):.  
+00003b20: 2020 2020 2020 7265 7475 726e 2066 696e        return fin
+00003b30: 616c 697a 652c 2028 290a 0a20 2020 2064  alize, ()..    d
+00003b40: 6566 205f 5f64 6173 6b5f 706f 7374 7065  ef __dask_postpe
+00003b50: 7273 6973 745f 5f28 7365 6c66 293a 0a20  rsist__(self):. 
+00003b60: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00003b70: 6c66 2e5f 7265 6275 696c 642c 2028 290a  lf._rebuild, ().
+00003b80: 0a20 2020 2064 6566 205f 7265 6275 696c  .    def _rebuil
+00003b90: 6428 7365 6c66 2c20 6473 6b2c 202a 2c20  d(self, dsk, *, 
+00003ba0: 7265 6e61 6d65 3d4e 6f6e 6529 3a0a 2020  rename=None):.  
+00003bb0: 2020 2020 2020 6e61 6d65 203d 2073 656c        name = sel
+00003bc0: 662e 5f6e 616d 650a 2020 2020 2020 2020  f._name.        
+00003bd0: 6966 2072 656e 616d 653a 0a20 2020 2020  if rename:.     
+00003be0: 2020 2020 2020 206e 616d 6520 3d20 7265         name = re
+00003bf0: 6e61 6d65 2e67 6574 286e 616d 652c 206e  name.get(name, n
+00003c00: 616d 6529 0a20 2020 2020 2020 2072 6574  ame).        ret
+00003c10: 7572 6e20 7479 7065 2873 656c 6629 2864  urn type(self)(d
+00003c20: 736b 2c20 6e61 6d65 2c20 7365 6c66 2e5f  sk, name, self._
+00003c30: 6d65 7461 2c20 7365 6c66 2e64 6976 6973  meta, self.divis
+00003c40: 696f 6e73 290a 0a20 2020 2040 7072 6f70  ions)..    @prop
+00003c50: 6572 7479 0a20 2020 2064 6566 205f 636f  erty.    def _co
+00003c60: 6e73 7472 7563 746f 7228 7365 6c66 293a  nstructor(self):
+00003c70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00003c80: 6e65 775f 6464 5f6f 626a 6563 740a 0a20  new_dd_object.. 
+00003c90: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00003ca0: 2064 6566 2064 6976 6973 696f 6e73 2873   def divisions(s
+00003cb0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00003cc0: 220a 2020 2020 2020 2020 5475 706c 6520  ".        Tuple 
+00003cd0: 6f66 2060 606e 7061 7274 6974 696f 6e73  of ``npartitions
+00003ce0: 202b 2031 6060 2076 616c 7565 732c 2069   + 1`` values, i
+00003cf0: 6e20 6173 6365 6e64 696e 6720 6f72 6465  n ascending orde
+00003d00: 722c 206d 6172 6b69 6e67 2074 6865 0a20  r, marking the. 
+00003d10: 2020 2020 2020 206c 6f77 6572 2f75 7070         lower/upp
+00003d20: 6572 2062 6f75 6e64 7320 6f66 2065 6163  er bounds of eac
+00003d30: 6820 7061 7274 6974 696f 6e27 7320 696e  h partition's in
+00003d40: 6465 782e 2044 6976 6973 696f 6e73 2061  dex. Divisions a
+00003d50: 6c6c 6f77 2044 6173 6b0a 2020 2020 2020  llow Dask.      
+00003d60: 2020 746f 206b 6e6f 7720 7768 6963 6820    to know which 
+00003d70: 7061 7274 6974 696f 6e20 7769 6c6c 2063  partition will c
+00003d80: 6f6e 7461 696e 2061 2067 6976 656e 2076  ontain a given v
+00003d90: 616c 7565 2c20 7369 676e 6966 6963 616e  alue, significan
+00003da0: 746c 790a 2020 2020 2020 2020 7370 6565  tly.        spee
+00003db0: 6469 6e67 2075 7020 6f70 6572 6174 696f  ding up operatio
+00003dc0: 6e73 206c 696b 6520 606c 6f63 602c 2060  ns like `loc`, `
+00003dd0: 6d65 7267 6560 2c20 616e 6420 6067 726f  merge`, and `gro
+00003de0: 7570 6279 6020 6279 206e 6f74 0a20 2020  upby` by not.   
+00003df0: 2020 2020 2068 6176 696e 6720 746f 2073       having to s
+00003e00: 6561 7263 6820 7468 6520 6675 6c6c 2064  earch the full d
+00003e10: 6174 6173 6574 2e0a 0a20 2020 2020 2020  ataset...       
+00003e20: 2045 7861 6d70 6c65 3a20 666f 7220 6060   Example: for ``
+00003e30: 6469 7669 7369 6f6e 7320 3d20 2830 2c20  divisions = (0, 
+00003e40: 3130 2c20 3530 2c20 3130 3029 6060 2c20  10, 50, 100)``, 
+00003e50: 7468 6572 6520 6172 6520 7468 7265 6520  there are three 
+00003e60: 7061 7274 6974 696f 6e73 2c0a 2020 2020  partitions,.    
+00003e70: 2020 2020 7768 6572 6520 7468 6520 696e      where the in
+00003e80: 6465 7820 696e 2065 6163 6820 7061 7274  dex in each part
+00003e90: 6974 696f 6e20 636f 6e74 6169 6e73 2076  ition contains v
+00003ea0: 616c 7565 7320 5b30 2c20 3130 292c 205b  alues [0, 10), [
+00003eb0: 3130 2c20 3530 292c 0a20 2020 2020 2020  10, 50),.       
+00003ec0: 2061 6e64 205b 3530 2c20 3130 305d 2c20   and [50, 100], 
+00003ed0: 7265 7370 6563 7469 7665 6c79 2e20 4461  respectively. Da
+00003ee0: 736b 2074 6865 7265 666f 7265 206b 6e6f  sk therefore kno
+00003ef0: 7773 2060 6064 662e 6c6f 635b 3435 5d60  ws ``df.loc[45]`
+00003f00: 600a 2020 2020 2020 2020 7769 6c6c 2062  `.        will b
+00003f10: 6520 696e 2074 6865 2073 6563 6f6e 6420  e in the second 
+00003f20: 7061 7274 6974 696f 6e2e 0a0a 2020 2020  partition...    
+00003f30: 2020 2020 5768 656e 2065 7665 7279 2069      When every i
+00003f40: 7465 6d20 696e 2060 6064 6976 6973 696f  tem in ``divisio
+00003f50: 6e73 6060 2069 7320 6060 4e6f 6e65 6060  ns`` is ``None``
+00003f60: 2c20 7468 6520 6469 7669 7369 6f6e 7320  , the divisions 
+00003f70: 6172 6520 756e 6b6e 6f77 6e2e 0a20 2020  are unknown..   
+00003f80: 2020 2020 204d 6f73 7420 6f70 6572 6174       Most operat
+00003f90: 696f 6e73 2063 616e 2073 7469 6c6c 2062  ions can still b
+00003fa0: 6520 7065 7266 6f72 6d65 642c 2062 7574  e performed, but
+00003fb0: 2073 6f6d 6520 7769 6c6c 2062 6520 6d75   some will be mu
+00003fc0: 6368 2073 6c6f 7765 722c 0a20 2020 2020  ch slower,.     
+00003fd0: 2020 2061 6e64 2061 2066 6577 206d 6179     and a few may
+00003fe0: 2066 6169 6c2e 0a0a 2020 2020 2020 2020   fail...        
+00003ff0: 4974 2069 7320 756e 636f 6d6d 6f6e 2074  It is uncommon t
+00004000: 6f20 7365 7420 6060 6469 7669 7369 6f6e  o set ``division
+00004010: 7360 6020 6469 7265 6374 6c79 2e20 496e  s`` directly. In
+00004020: 7374 6561 642c 2075 7365 2060 6073 6574  stead, use ``set
+00004030: 5f69 6e64 6578 6060 2c0a 2020 2020 2020  _index``,.      
+00004040: 2020 7768 6963 6820 736f 7274 7320 616e    which sorts an
+00004050: 6420 7370 6c69 7473 2074 6865 2064 6174  d splits the dat
+00004060: 6120 6173 206e 6565 6465 642e 0a20 2020  a as needed..   
+00004070: 2020 2020 2053 6565 2068 7474 7073 3a2f       See https:/
+00004080: 2f64 6f63 732e 6461 736b 2e6f 7267 2f65  /docs.dask.org/e
+00004090: 6e2f 6c61 7465 7374 2f64 6174 6166 7261  n/latest/datafra
+000040a0: 6d65 2d64 6573 6967 6e2e 6874 6d6c 2370  me-design.html#p
+000040b0: 6172 7469 7469 6f6e 732e 0a20 2020 2020  artitions..     
+000040c0: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+000040d0: 6574 7572 6e20 7365 6c66 2e5f 6469 7669  eturn self._divi
+000040e0: 7369 6f6e 730a 0a20 2020 2040 6469 7669  sions..    @divi
+000040f0: 7369 6f6e 732e 7365 7474 6572 0a20 2020  sions.setter.   
+00004100: 2064 6566 2064 6976 6973 696f 6e73 2873   def divisions(s
+00004110: 656c 662c 2076 616c 7565 293a 0a20 2020  elf, value):.   
+00004120: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+00004130: 7374 616e 6365 2876 616c 7565 2c20 7475  stance(value, tu
+00004140: 706c 6529 3a0a 2020 2020 2020 2020 2020  ple):.          
+00004150: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00004160: 7228 2264 6976 6973 696f 6e73 206d 7573  r("divisions mus
+00004170: 7420 6265 2061 2074 7570 6c65 2229 0a0a  t be a tuple")..
+00004180: 2020 2020 2020 2020 6966 2068 6173 6174          if hasat
+00004190: 7472 2873 656c 662c 2022 5f64 6976 6973  tr(self, "_divis
+000041a0: 696f 6e73 2229 2061 6e64 206c 656e 2876  ions") and len(v
+000041b0: 616c 7565 2920 213d 206c 656e 2873 656c  alue) != len(sel
+000041c0: 662e 5f64 6976 6973 696f 6e73 293a 0a20  f._divisions):. 
+000041d0: 2020 2020 2020 2020 2020 206e 203d 206c             n = l
+000041e0: 656e 2873 656c 662e 5f64 6976 6973 696f  en(self._divisio
+000041f0: 6e73 290a 2020 2020 2020 2020 2020 2020  ns).            
+00004200: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00004210: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00004220: 2020 6622 5468 6973 2064 6174 6166 7261    f"This datafra
+00004230: 6d65 2068 6173 206e 7061 7274 6974 696f  me has npartitio
+00004240: 6e73 3d7b 6e20 2d20 317d 2c20 6469 7669  ns={n - 1}, divi
+00004250: 7369 6f6e 7320 7368 6f75 6c64 2062 6520  sions should be 
+00004260: 6120 220a 2020 2020 2020 2020 2020 2020  a ".            
+00004270: 2020 2020 6622 7475 706c 6520 6f66 206c      f"tuple of l
+00004280: 656e 6774 683d 7b6e 7d2c 2067 6f74 207b  ength={n}, got {
+00004290: 6c65 6e28 7661 6c75 6529 7d22 0a20 2020  len(value)}".   
+000042a0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+000042b0: 2020 2020 6966 204e 6f6e 6520 696e 2076      if None in v
+000042c0: 616c 7565 3a0a 2020 2020 2020 2020 2020  alue:.          
+000042d0: 2020 6966 2061 6e79 2876 2069 7320 6e6f    if any(v is no
+000042e0: 7420 4e6f 6e65 2066 6f72 2076 2069 6e20  t None for v in 
+000042f0: 7661 6c75 6529 3a0a 2020 2020 2020 2020  value):.        
+00004300: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00004310: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+00004320: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+00004330: 6976 6973 696f 6e73 206d 6179 206e 6f74  ivisions may not
+00004340: 2063 6f6e 7461 696e 2061 206d 6978 206f   contain a mix o
+00004350: 6620 4e6f 6e65 2061 6e64 206e 6f6e 2d4e  f None and non-N
+00004360: 6f6e 6520 7661 6c75 6573 220a 2020 2020  one values".    
+00004370: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00004380: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00004390: 2020 2020 2020 2020 2320 4b6e 6f77 6e20          # Known 
+000043a0: 6469 7669 7369 6f6e 732c 2063 6865 636b  divisions, check
+000043b0: 206d 6f6e 6f74 6f6e 6963 616c 6c79 2069   monotonically i
+000043c0: 6e63 7265 6173 696e 670a 0a20 2020 2020  ncreasing..     
+000043d0: 2020 2020 2020 2023 2058 5858 3a20 6966         # XXX: if
+000043e0: 2074 6865 2069 6e64 6578 2064 7479 7065   the index dtype
+000043f0: 2069 7320 616e 206f 7264 6572 6564 2063   is an ordered c
+00004400: 6174 6567 6f72 6963 616c 2064 7479 7065  ategorical dtype
+00004410: 2c20 7468 656e 2077 6520 736b 6970 2074  , then we skip t
+00004420: 6865 0a20 2020 2020 2020 2020 2020 2023  he.            #
+00004430: 2073 6f72 7465 646e 6573 7320 6368 6563   sortedness chec
+00004440: 6b2c 2073 696e 6365 2074 6865 206f 7264  k, since the ord
+00004450: 6572 2069 7320 6474 7970 6520 6465 7065  er is dtype depe
+00004460: 6e64 656e 740a 2020 2020 2020 2020 2020  ndent.          
+00004470: 2020 696e 6465 785f 6474 7970 6520 3d20    index_dtype = 
+00004480: 6765 7461 7474 7228 7365 6c66 2e5f 6d65  getattr(self._me
+00004490: 7461 2c20 2269 6e64 6578 222c 2073 656c  ta, "index", sel
+000044a0: 662e 5f6d 6574 6129 2e64 7479 7065 0a20  f._meta).dtype. 
+000044b0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+000044c0: 7420 280a 2020 2020 2020 2020 2020 2020  t (.            
+000044d0: 2020 2020 6973 696e 7374 616e 6365 2869      isinstance(i
+000044e0: 6e64 6578 5f64 7479 7065 2c20 7064 2e43  ndex_dtype, pd.C
+000044f0: 6174 6567 6f72 6963 616c 4474 7970 6529  ategoricalDtype)
+00004500: 2061 6e64 2069 6e64 6578 5f64 7479 7065   and index_dtype
+00004510: 2e6f 7264 6572 6564 0a20 2020 2020 2020  .ordered.       
+00004520: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+00004530: 2020 2020 2020 2020 6966 2076 616c 7565          if value
+00004540: 2021 3d20 7475 706c 6528 736f 7274 6564   != tuple(sorted
+00004550: 2876 616c 7565 2929 3a0a 2020 2020 2020  (value)):.      
+00004560: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00004570: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+00004580: 6469 7669 7369 6f6e 7320 6d75 7374 2062  divisions must b
+00004590: 6520 736f 7274 6564 2229 0a0a 2020 2020  e sorted")..    
+000045a0: 2020 2020 7365 6c66 2e5f 6469 7669 7369      self._divisi
+000045b0: 6f6e 7320 3d20 7661 6c75 650a 0a20 2020  ons = value..   
+000045c0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+000045d0: 6566 206e 7061 7274 6974 696f 6e73 2873  ef npartitions(s
+000045e0: 656c 6629 202d 3e20 696e 743a 0a20 2020  elf) -> int:.   
+000045f0: 2020 2020 2022 2222 5265 7475 726e 206e       """Return n
+00004600: 756d 6265 7220 6f66 2070 6172 7469 7469  umber of partiti
+00004610: 6f6e 7322 2222 0a20 2020 2020 2020 2072  ons""".        r
+00004620: 6574 7572 6e20 6c65 6e28 7365 6c66 2e64  eturn len(self.d
+00004630: 6976 6973 696f 6e73 2920 2d20 310a 0a20  ivisions) - 1.. 
+00004640: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00004650: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00004660: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+00004670: 2064 6566 2061 7474 7273 2873 656c 6629   def attrs(self)
+00004680: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00004690: 2073 656c 662e 5f6d 6574 612e 6174 7472   self._meta.attr
+000046a0: 730a 0a20 2020 2040 6174 7472 732e 7365  s..    @attrs.se
+000046b0: 7474 6572 0a20 2020 2064 6566 2061 7474  tter.    def att
+000046c0: 7273 2873 656c 662c 2076 616c 7565 293a  rs(self, value):
+000046d0: 0a20 2020 2020 2020 2073 656c 662e 5f6d  .        self._m
+000046e0: 6574 612e 6174 7472 7320 3d20 6469 6374  eta.attrs = dict
+000046f0: 2876 616c 7565 290a 0a20 2020 2040 7072  (value)..    @pr
+00004700: 6f70 6572 7479 0a20 2020 2064 6566 2073  operty.    def s
+00004710: 697a 6528 7365 6c66 293a 0a20 2020 2020  ize(self):.     
+00004720: 2020 2022 2222 5369 7a65 206f 6620 7468     """Size of th
+00004730: 6520 5365 7269 6573 206f 7220 4461 7461  e Series or Data
+00004740: 4672 616d 6520 6173 2061 2044 656c 6179  Frame as a Delay
+00004750: 6564 206f 626a 6563 742e 0a0a 2020 2020  ed object...    
+00004760: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+00004770: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00004780: 2020 2020 2020 3e3e 3e20 7365 7269 6573        >>> series
+00004790: 2e73 697a 6520 2023 2064 6f63 7465 7374  .size  # doctest
+000047a0: 3a20 2b53 4b49 500a 2020 2020 2020 2020  : +SKIP.        
+000047b0: 6464 2e53 6361 6c61 723c 7369 7a65 2d61  dd.Scalar<size-a
+000047c0: 672e 2e2e 2c20 6474 7970 653d 696e 7436  g..., dtype=int6
+000047d0: 343e 0a20 2020 2020 2020 2022 2222 0a20  4>.        """. 
+000047e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000047f0: 6c66 2e72 6564 7563 7469 6f6e 280a 2020  lf.reduction(.  
+00004800: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00004810: 732e 7369 7a65 2c20 6e70 2e73 756d 2c20  s.size, np.sum, 
+00004820: 746f 6b65 6e3d 2273 697a 6522 2c20 6d65  token="size", me
+00004830: 7461 3d69 6e74 2c20 7370 6c69 745f 6576  ta=int, split_ev
+00004840: 6572 793d 4661 6c73 650a 2020 2020 2020  ery=False.      
+00004850: 2020 290a 0a20 2020 2040 7072 6f70 6572    )..    @proper
+00004860: 7479 0a20 2020 2064 6566 205f 6d65 7461  ty.    def _meta
+00004870: 5f6e 6f6e 656d 7074 7928 7365 6c66 293a  _nonempty(self):
+00004880: 0a20 2020 2020 2020 2022 2222 4120 6e6f  .        """A no
+00004890: 6e2d 656d 7074 7920 7665 7273 696f 6e20  n-empty version 
+000048a0: 6f66 2060 5f6d 6574 6160 2077 6974 6820  of `_meta` with 
+000048b0: 6661 6b65 2064 6174 612e 2222 220a 2020  fake data.""".  
+000048c0: 2020 2020 2020 7265 7475 726e 206d 6574        return met
+000048d0: 615f 6e6f 6e65 6d70 7479 2873 656c 662e  a_nonempty(self.
+000048e0: 5f6d 6574 6129 0a0a 2020 2020 4070 726f  _meta)..    @pro
+000048f0: 7065 7274 790a 2020 2020 6465 6620 5f61  perty.    def _a
+00004900: 7267 7328 7365 6c66 293a 0a20 2020 2020  rgs(self):.     
+00004910: 2020 2072 6574 7572 6e20 2873 656c 662e     return (self.
+00004920: 6461 736b 2c20 7365 6c66 2e5f 6e61 6d65  dask, self._name
+00004930: 2c20 7365 6c66 2e5f 6d65 7461 2c20 7365  , self._meta, se
+00004940: 6c66 2e64 6976 6973 696f 6e73 290a 0a20  lf.divisions).. 
+00004950: 2020 2064 6566 205f 5f67 6574 7374 6174     def __getstat
+00004960: 655f 5f28 7365 6c66 293a 0a20 2020 2020  e__(self):.     
+00004970: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00004980: 6172 6773 0a0a 2020 2020 6465 6620 5f5f  args..    def __
+00004990: 7365 7473 7461 7465 5f5f 2873 656c 662c  setstate__(self,
+000049a0: 2073 7461 7465 293a 0a20 2020 2020 2020   state):.       
+000049b0: 2073 656c 662e 6461 736b 2c20 7365 6c66   self.dask, self
+000049c0: 2e5f 6e61 6d65 2c20 7365 6c66 2e5f 6d65  ._name, self._me
+000049d0: 7461 2c20 7365 6c66 2e5f 6469 7669 7369  ta, self._divisi
+000049e0: 6f6e 7320 3d20 7374 6174 650a 0a20 2020  ons = state..   
+000049f0: 2064 6566 2063 6f70 7928 7365 6c66 2c20   def copy(self, 
+00004a00: 6465 6570 3d46 616c 7365 293a 0a20 2020  deep=False):.   
+00004a10: 2020 2020 2022 2222 4d61 6b65 2061 2063       """Make a c
+00004a20: 6f70 7920 6f66 2074 6865 2064 6174 6166  opy of the dataf
+00004a30: 7261 6d65 0a0a 2020 2020 2020 2020 5468  rame..        Th
+00004a40: 6973 2069 7320 7374 7269 6374 6c79 2061  is is strictly a
+00004a50: 2073 6861 6c6c 6f77 2063 6f70 7920 6f66   shallow copy of
+00004a60: 2074 6865 2075 6e64 6572 6c79 696e 6720   the underlying 
+00004a70: 636f 6d70 7574 6174 696f 6e61 6c20 6772  computational gr
+00004a80: 6170 682e 0a20 2020 2020 2020 2049 7420  aph..        It 
+00004a90: 646f 6573 206e 6f74 2061 6666 6563 7420  does not affect 
+00004aa0: 7468 6520 756e 6465 726c 7969 6e67 2064  the underlying d
+00004ab0: 6174 610a 0a20 2020 2020 2020 2050 6172  ata..        Par
+00004ac0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+00004ad0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00004ae0: 2020 2064 6565 7020 3a20 626f 6f6c 6561     deep : boolea
+00004af0: 6e2c 2064 6566 6175 6c74 2046 616c 7365  n, default False
+00004b00: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+00004b10: 2064 6565 7020 7661 6c75 6520 6d75 7374   deep value must
+00004b20: 2062 6520 6046 616c 7365 6020 616e 6420   be `False` and 
+00004b30: 6974 2069 7320 6465 636c 6172 6564 2061  it is declared a
+00004b40: 7320 6120 7061 7261 6d65 7465 7220 6a75  s a parameter ju
+00004b50: 7374 2066 6f72 0a20 2020 2020 2020 2020  st for.         
+00004b60: 2020 2063 6f6d 7061 7469 6269 6c69 7479     compatibility
+00004b70: 2077 6974 6820 7468 6972 642d 7061 7274   with third-part
+00004b80: 7920 6c69 6272 6172 6965 7320 6c69 6b65  y libraries like
+00004b90: 2063 7544 460a 2020 2020 2020 2020 2222   cuDF.        ""
+00004ba0: 220a 2020 2020 2020 2020 6966 2064 6565  ".        if dee
+00004bb0: 7020 6973 206e 6f74 2046 616c 7365 3a0a  p is not False:.
+00004bc0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00004bd0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+00004be0: 2020 2020 2020 2020 2020 2020 2020 2254                "T
+00004bf0: 6865 2060 6465 6570 6020 7661 6c75 6520  he `deep` value 
+00004c00: 6d75 7374 2062 6520 4661 6c73 652e 2054  must be False. T
+00004c10: 6869 7320 6973 2073 7472 6963 746c 7920  his is strictly 
+00004c20: 6120 7368 616c 6c6f 7720 636f 7079 2022  a shallow copy "
+00004c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004c40: 2022 6f66 2074 6865 2075 6e64 6572 6c79   "of the underly
+00004c50: 696e 6720 636f 6d70 7574 6174 696f 6e61  ing computationa
+00004c60: 6c20 6772 6170 682e 220a 2020 2020 2020  l graph.".      
+00004c70: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00004c80: 7265 7475 726e 206e 6577 5f64 645f 6f62  return new_dd_ob
+00004c90: 6a65 6374 2873 656c 662e 6461 736b 2c20  ject(self.dask, 
+00004ca0: 7365 6c66 2e5f 6e61 6d65 2c20 7365 6c66  self._name, self
+00004cb0: 2e5f 6d65 7461 2c20 7365 6c66 2e64 6976  ._meta, self.div
+00004cc0: 6973 696f 6e73 290a 0a20 2020 2064 6566  isions)..    def
+00004cd0: 205f 5f61 7272 6179 5f5f 2873 656c 662c   __array__(self,
+00004ce0: 2064 7479 7065 3d4e 6f6e 652c 202a 2a6b   dtype=None, **k
+00004cf0: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+00004d00: 7365 6c66 2e5f 636f 6d70 7574 6564 203d  self._computed =
+00004d10: 2073 656c 662e 636f 6d70 7574 6528 290a   self.compute().
+00004d20: 2020 2020 2020 2020 7820 3d20 6e70 2e61          x = np.a
+00004d30: 7272 6179 2873 656c 662e 5f63 6f6d 7075  rray(self._compu
+00004d40: 7465 6429 0a20 2020 2020 2020 2072 6574  ted).        ret
+00004d50: 7572 6e20 780a 0a20 2020 2064 6566 205f  urn x..    def _
+00004d60: 5f61 7272 6179 5f77 7261 705f 5f28 7365  _array_wrap__(se
+00004d70: 6c66 2c20 6172 7261 792c 2063 6f6e 7465  lf, array, conte
+00004d80: 7874 3d4e 6f6e 6529 3a0a 2020 2020 2020  xt=None):.      
+00004d90: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+00004da0: 6d65 6e74 6564 4572 726f 720a 0a20 2020  mentedError..   
+00004db0: 2064 6566 205f 5f61 7272 6179 5f75 6675   def __array_ufu
+00004dc0: 6e63 5f5f 2873 656c 662c 206e 756d 7079  nc__(self, numpy
+00004dd0: 5f75 6675 6e63 2c20 6d65 7468 6f64 2c20  _ufunc, method, 
+00004de0: 2a69 6e70 7574 732c 202a 2a6b 7761 7267  *inputs, **kwarg
+00004df0: 7329 3a0a 2020 2020 2020 2020 6f75 7420  s):.        out 
+00004e00: 3d20 6b77 6172 6773 2e67 6574 2822 6f75  = kwargs.get("ou
+00004e10: 7422 2c20 2829 290a 2020 2020 2020 2020  t", ()).        
+00004e20: 666f 7220 7820 696e 2069 6e70 7574 7320  for x in inputs 
+00004e30: 2b20 6f75 743a 0a20 2020 2020 2020 2020  + out:.         
+00004e40: 2020 2023 2075 6675 6e63 7320 776f 726b     # ufuncs work
+00004e50: 2077 6974 6820 302d 6469 6d65 6e73 696f   with 0-dimensio
+00004e60: 6e61 6c20 4e75 6d50 7920 6e64 6172 7261  nal NumPy ndarra
+00004e70: 7973 0a20 2020 2020 2020 2020 2020 2023  ys.            #
+00004e80: 2073 6f20 7765 2064 6f6e 2774 2077 616e   so we don't wan
+00004e90: 7420 746f 2072 6169 7365 204e 6f74 496d  t to raise NotIm
+00004ea0: 706c 656d 656e 7465 640a 2020 2020 2020  plemented.      
+00004eb0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00004ec0: 6e63 6528 782c 206e 702e 6e64 6172 7261  nce(x, np.ndarra
+00004ed0: 7929 2061 6e64 2078 2e73 6861 7065 203d  y) and x.shape =
+00004ee0: 3d20 2829 3a0a 2020 2020 2020 2020 2020  = ():.          
+00004ef0: 2020 2020 2020 636f 6e74 696e 7565 0a20        continue. 
+00004f00: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00004f10: 6e6f 7420 6973 696e 7374 616e 6365 280a  not isinstance(.
+00004f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004f30: 782c 2028 4e75 6d62 6572 2c20 5363 616c  x, (Number, Scal
+00004f40: 6172 2c20 5f46 7261 6d65 2c20 4172 7261  ar, _Frame, Arra
+00004f50: 792c 2070 642e 4461 7461 4672 616d 652c  y, pd.DataFrame,
+00004f60: 2070 642e 5365 7269 6573 2c20 7064 2e49   pd.Series, pd.I
+00004f70: 6e64 6578 290a 2020 2020 2020 2020 2020  ndex).          
+00004f80: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+00004f90: 2020 2020 2072 6574 7572 6e20 4e6f 7449       return NotI
+00004fa0: 6d70 6c65 6d65 6e74 6564 0a0a 2020 2020  mplemented..    
+00004fb0: 2020 2020 6966 206d 6574 686f 6420 3d3d      if method ==
+00004fc0: 2022 5f5f 6361 6c6c 5f5f 223a 0a20 2020   "__call__":.   
+00004fd0: 2020 2020 2020 2020 2069 6620 6e75 6d70           if nump
+00004fe0: 795f 7566 756e 632e 7369 676e 6174 7572  y_ufunc.signatur
+00004ff0: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+00005000: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00005010: 6574 7572 6e20 4e6f 7449 6d70 6c65 6d65  eturn NotImpleme
+00005020: 6e74 6564 0a20 2020 2020 2020 2020 2020  nted.           
+00005030: 2069 6620 6e75 6d70 795f 7566 756e 632e   if numpy_ufunc.
+00005040: 6e6f 7574 203e 2031 3a0a 2020 2020 2020  nout > 1:.      
+00005050: 2020 2020 2020 2020 2020 2320 7566 756e            # ufun
+00005060: 6373 2077 6974 6820 6d75 6c74 6970 6c65  cs with multiple
+00005070: 206f 7574 7075 7420 7661 6c75 6573 0a20   output values. 
+00005080: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00005090: 2061 7265 206e 6f74 2079 6574 2073 7570   are not yet sup
+000050a0: 706f 7274 6564 2066 6f72 2066 7261 6d65  ported for frame
+000050b0: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+000050c0: 2020 7265 7475 726e 204e 6f74 496d 706c    return NotImpl
+000050d0: 656d 656e 7465 640a 2020 2020 2020 2020  emented.        
+000050e0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000050f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00005100: 2065 6c65 6d77 6973 6528 6e75 6d70 795f   elemwise(numpy_
+00005110: 7566 756e 632c 202a 696e 7075 7473 2c20  ufunc, *inputs, 
+00005120: 2a2a 6b77 6172 6773 290a 2020 2020 2020  **kwargs).      
+00005130: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00005140: 2020 2020 2320 7566 756e 6320 6d65 7468      # ufunc meth
+00005150: 6f64 7320 6172 6520 6e6f 7420 7965 7420  ods are not yet 
+00005160: 7375 7070 6f72 7465 6420 666f 7220 6672  supported for fr
+00005170: 616d 6573 0a20 2020 2020 2020 2020 2020  ames.           
+00005180: 2072 6574 7572 6e20 4e6f 7449 6d70 6c65   return NotImple
+00005190: 6d65 6e74 6564 0a0a 2020 2020 4070 726f  mented..    @pro
+000051a0: 7065 7274 790a 2020 2020 6465 6620 5f65  perty.    def _e
+000051b0: 6c65 6d77 6973 6528 7365 6c66 293a 0a20  lemwise(self):. 
+000051c0: 2020 2020 2020 2072 6574 7572 6e20 656c         return el
+000051d0: 656d 7769 7365 0a0a 2020 2020 6465 6620  emwise..    def 
+000051e0: 5f72 6570 725f 6461 7461 2873 656c 6629  _repr_data(self)
+000051f0: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
+00005200: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+00005210: 726f 720a 0a20 2020 2040 7072 6f70 6572  ror..    @proper
+00005220: 7479 0a20 2020 2064 6566 205f 7265 7072  ty.    def _repr
+00005230: 5f64 6976 6973 696f 6e73 2873 656c 6629  _divisions(self)
+00005240: 3a0a 2020 2020 2020 2020 6e61 6d65 203d  :.        name =
+00005250: 2066 226e 7061 7274 6974 696f 6e73 3d7b   f"npartitions={
+00005260: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
+00005270: 7d22 0a20 2020 2020 2020 2069 6620 7365  }".        if se
+00005280: 6c66 2e6b 6e6f 776e 5f64 6976 6973 696f  lf.known_divisio
+00005290: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+000052a0: 6469 7669 7369 6f6e 7320 3d20 7064 2e49  divisions = pd.I
+000052b0: 6e64 6578 2873 656c 662e 6469 7669 7369  ndex(self.divisi
+000052c0: 6f6e 732c 206e 616d 653d 6e61 6d65 290a  ons, name=name).
+000052d0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000052e0: 2020 2020 2020 2020 2020 2320 6176 6f69            # avoi
+000052f0: 6420 746f 2062 6520 636f 6e76 6572 7465  d to be converte
+00005300: 6420 746f 204e 614e 0a20 2020 2020 2020  d to NaN.       
+00005310: 2020 2020 2064 6976 6973 696f 6e73 203d       divisions =
+00005320: 2070 642e 496e 6465 7828 5b22 225d 202a   pd.Index([""] *
+00005330: 2028 7365 6c66 2e6e 7061 7274 6974 696f   (self.npartitio
+00005340: 6e73 202b 2031 292c 206e 616d 653d 6e61  ns + 1), name=na
+00005350: 6d65 290a 2020 2020 2020 2020 7265 7475  me).        retu
+00005360: 726e 2064 6976 6973 696f 6e73 0a0a 2020  rn divisions..  
+00005370: 2020 6465 6620 5f5f 7265 7072 5f5f 2873    def __repr__(s
+00005380: 656c 6629 3a0a 2020 2020 2020 2020 6461  elf):.        da
+00005390: 7461 203d 2073 656c 662e 5f72 6570 725f  ta = self._repr_
+000053a0: 6461 7461 2829 2e74 6f5f 7374 7269 6e67  data().to_string
+000053b0: 286d 6178 5f72 6f77 733d 352c 2073 686f  (max_rows=5, sho
+000053c0: 775f 6469 6d65 6e73 696f 6e73 3d46 616c  w_dimensions=Fal
+000053d0: 7365 290a 2020 2020 2020 2020 5f73 7472  se).        _str
+000053e0: 5f66 6d74 203d 2022 2222 4461 736b 207b  _fmt = """Dask {
+000053f0: 6b6c 6173 737d 2053 7472 7563 7475 7265  klass} Structure
+00005400: 3a0a 7b64 6174 617d 0a44 6173 6b20 4e61  :.{data}.Dask Na
+00005410: 6d65 3a20 7b6e 616d 657d 2c20 7b6c 6179  me: {name}, {lay
+00005420: 6572 737d 2222 220a 2020 2020 2020 2020  ers}""".        
+00005430: 6966 206c 656e 2873 656c 662e 636f 6c75  if len(self.colu
+00005440: 6d6e 7329 203d 3d20 303a 0a20 2020 2020  mns) == 0:.     
+00005450: 2020 2020 2020 2064 6174 6120 3d20 6461         data = da
+00005460: 7461 2e70 6172 7469 7469 6f6e 2822 5c6e  ta.partition("\n
+00005470: 2229 5b2d 315d 2e72 6570 6c61 6365 2822  ")[-1].replace("
+00005480: 496e 6465 7822 2c20 2244 6976 6973 696f  Index", "Divisio
+00005490: 6e73 2229 0a20 2020 2020 2020 2020 2020  ns").           
+000054a0: 205f 7374 725f 666d 7420 3d20 6622 456d   _str_fmt = f"Em
+000054b0: 7074 7920 7b5f 7374 725f 666d 747d 220a  pty {_str_fmt}".
+000054c0: 2020 2020 2020 2020 7265 7475 726e 205f          return _
+000054d0: 7374 725f 666d 742e 666f 726d 6174 280a  str_fmt.format(.
+000054e0: 2020 2020 2020 2020 2020 2020 6b6c 6173              klas
+000054f0: 733d 7365 6c66 2e5f 5f63 6c61 7373 5f5f  s=self.__class__
+00005500: 2e5f 5f6e 616d 655f 5f2c 0a20 2020 2020  .__name__,.     
+00005510: 2020 2020 2020 2064 6174 613d 6461 7461         data=data
+00005520: 2c0a 2020 2020 2020 2020 2020 2020 6e61  ,.            na
+00005530: 6d65 3d6b 6579 5f73 706c 6974 2873 656c  me=key_split(sel
+00005540: 662e 5f6e 616d 6529 2c0a 2020 2020 2020  f._name),.      
+00005550: 2020 2020 2020 6c61 7965 7273 3d6d 6179        layers=may
+00005560: 6265 5f70 6c75 7261 6c69 7a65 286c 656e  be_pluralize(len
+00005570: 2873 656c 662e 6461 736b 2e6c 6179 6572  (self.dask.layer
+00005580: 7329 2c20 2267 7261 7068 206c 6179 6572  s), "graph layer
+00005590: 2229 2c0a 2020 2020 2020 2020 290a 0a20  "),.        ).. 
+000055a0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+000055b0: 2064 6566 2069 6e64 6578 2873 656c 6629   def index(self)
+000055c0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+000055d0: 7572 6e20 6461 736b 2049 6e64 6578 2069  urn dask Index i
+000055e0: 6e73 7461 6e63 6522 2222 0a20 2020 2020  nstance""".     
+000055f0: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
+00005600: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
+00005610: 2020 2020 2020 2020 2020 2067 6574 6174             getat
+00005620: 7472 2c0a 2020 2020 2020 2020 2020 2020  tr,.            
+00005630: 2269 6e64 6578 222c 0a20 2020 2020 2020  "index",.       
+00005640: 2020 2020 2074 6f6b 656e 3d6b 6579 5f73       token=key_s
+00005650: 706c 6974 2873 656c 662e 5f6e 616d 6529  plit(self._name)
+00005660: 202b 2022 2d69 6e64 6578 222c 0a20 2020   + "-index",.   
+00005670: 2020 2020 2020 2020 206d 6574 613d 7365           meta=se
+00005680: 6c66 2e5f 6d65 7461 2e69 6e64 6578 2c0a  lf._meta.index,.
+00005690: 2020 2020 2020 2020 2020 2020 656e 666f              enfo
+000056a0: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
+000056b0: 7365 2c0a 2020 2020 2020 2020 290a 0a20  se,.        ).. 
+000056c0: 2020 2040 696e 6465 782e 7365 7474 6572     @index.setter
+000056d0: 0a20 2020 2064 6566 2069 6e64 6578 2873  .    def index(s
+000056e0: 656c 662c 2076 616c 7565 293a 0a20 2020  elf, value):.   
+000056f0: 2020 2020 2073 656c 662e 6469 7669 7369       self.divisi
+00005700: 6f6e 7320 3d20 7661 6c75 652e 6469 7669  ons = value.divi
+00005710: 7369 6f6e 730a 2020 2020 2020 2020 7265  sions.        re
+00005720: 7375 6c74 203d 206d 6170 5f70 6172 7469  sult = map_parti
+00005730: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
+00005740: 2020 206d 6574 686f 6473 2e61 7373 6967     methods.assig
+00005750: 6e5f 696e 6465 782c 2073 656c 662c 2076  n_index, self, v
+00005760: 616c 7565 2c20 656e 666f 7263 655f 6d65  alue, enforce_me
+00005770: 7461 6461 7461 3d46 616c 7365 0a20 2020  tadata=False.   
+00005780: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00005790: 656c 662e 6461 736b 203d 2072 6573 756c  elf.dask = resul
+000057a0: 742e 6461 736b 0a20 2020 2020 2020 2073  t.dask.        s
+000057b0: 656c 662e 5f6e 616d 6520 3d20 7265 7375  elf._name = resu
+000057c0: 6c74 2e5f 6e61 6d65 0a20 2020 2020 2020  lt._name.       
+000057d0: 2073 656c 662e 5f6d 6574 6120 3d20 7265   self._meta = re
+000057e0: 7375 6c74 2e5f 6d65 7461 0a0a 2020 2020  sult._meta..    
+000057f0: 6465 6620 7265 7365 745f 696e 6465 7828  def reset_index(
+00005800: 7365 6c66 2c20 6472 6f70 3d46 616c 7365  self, drop=False
+00005810: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+00005820: 7365 7420 7468 6520 696e 6465 7820 746f  set the index to
+00005830: 2074 6865 2064 6566 6175 6c74 2069 6e64   the default ind
+00005840: 6578 2e0a 0a20 2020 2020 2020 204e 6f74  ex...        Not
+00005850: 6520 7468 6174 2075 6e6c 696b 6520 696e  e that unlike in
+00005860: 2060 6070 616e 6461 7360 602c 2074 6865   ``pandas``, the
+00005870: 2072 6573 6574 2060 6064 6173 6b2e 6461   reset ``dask.da
+00005880: 7461 6672 616d 6560 6020 696e 6465 7820  taframe`` index 
+00005890: 7769 6c6c 0a20 2020 2020 2020 206e 6f74  will.        not
+000058a0: 2062 6520 6d6f 6e6f 746f 6e69 6361 6c6c   be monotonicall
+000058b0: 7920 696e 6372 6561 7369 6e67 2066 726f  y increasing fro
+000058c0: 6d20 302e 2049 6e73 7465 6164 2c20 6974  m 0. Instead, it
+000058d0: 2077 696c 6c20 7265 7374 6172 7420 6174   will restart at
+000058e0: 2030 0a20 2020 2020 2020 2066 6f72 2065   0.        for e
+000058f0: 6163 6820 7061 7274 6974 696f 6e20 2865  ach partition (e
+00005900: 2e67 2e20 6060 696e 6465 7831 203d 205b  .g. ``index1 = [
+00005910: 302c 202e 2e2e 2c20 3130 5d2c 2069 6e64  0, ..., 10], ind
+00005920: 6578 3220 3d20 5b30 2c20 2e2e 2e5d 6060  ex2 = [0, ...]``
+00005930: 292e 0a20 2020 2020 2020 2054 6869 7320  )..        This 
+00005940: 6973 2064 7565 2074 6f20 7468 6520 696e  is due to the in
+00005950: 6162 696c 6974 7920 746f 2073 7461 7469  ability to stati
+00005960: 6361 6c6c 7920 6b6e 6f77 2074 6865 2066  cally know the f
+00005970: 756c 6c20 6c65 6e67 7468 206f 6620 7468  ull length of th
+00005980: 650a 2020 2020 2020 2020 696e 6465 782e  e.        index.
+00005990: 0a0a 2020 2020 2020 2020 466f 7220 4461  ..        For Da
+000059a0: 7461 4672 616d 6520 7769 7468 206d 756c  taFrame with mul
+000059b0: 7469 2d6c 6576 656c 2069 6e64 6578 2c20  ti-level index, 
+000059c0: 7265 7475 726e 7320 6120 6e65 7720 4461  returns a new Da
+000059d0: 7461 4672 616d 6520 7769 7468 0a20 2020  taFrame with.   
+000059e0: 2020 2020 206c 6162 656c 696e 6720 696e       labeling in
+000059f0: 666f 726d 6174 696f 6e20 696e 2074 6865  formation in the
+00005a00: 2063 6f6c 756d 6e73 2075 6e64 6572 2074   columns under t
+00005a10: 6865 2069 6e64 6578 206e 616d 6573 2c20  he index names, 
+00005a20: 6465 6661 756c 7469 6e67 0a20 2020 2020  defaulting.     
+00005a30: 2020 2074 6f20 276c 6576 656c 5f30 272c     to 'level_0',
+00005a40: 2027 6c65 7665 6c5f 3127 2c20 6574 632e   'level_1', etc.
+00005a50: 2069 6620 616e 7920 6172 6520 4e6f 6e65   if any are None
+00005a60: 2e20 466f 7220 6120 7374 616e 6461 7264  . For a standard
+00005a70: 2069 6e64 6578 2c0a 2020 2020 2020 2020   index,.        
+00005a80: 7468 6520 696e 6465 7820 6e61 6d65 2077  the index name w
+00005a90: 696c 6c20 6265 2075 7365 6420 2869 6620  ill be used (if 
+00005aa0: 7365 7429 2c20 6f74 6865 7277 6973 6520  set), otherwise 
+00005ab0: 6120 6465 6661 756c 7420 2769 6e64 6578  a default 'index
+00005ac0: 2720 6f72 0a20 2020 2020 2020 2027 6c65  ' or.        'le
+00005ad0: 7665 6c5f 3027 2028 6966 2027 696e 6465  vel_0' (if 'inde
+00005ae0: 7827 2069 7320 616c 7265 6164 7920 7461  x' is already ta
+00005af0: 6b65 6e29 2077 696c 6c20 6265 2075 7365  ken) will be use
+00005b00: 642e 0a0a 2020 2020 2020 2020 5061 7261  d...        Para
+00005b10: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+00005b20: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00005b30: 2020 6472 6f70 203a 2062 6f6f 6c65 616e    drop : boolean
+00005b40: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
+00005b50: 2020 2020 2020 2020 2020 2020 446f 206e              Do n
+00005b60: 6f74 2074 7279 2074 6f20 696e 7365 7274  ot try to insert
+00005b70: 2069 6e64 6578 2069 6e74 6f20 6461 7461   index into data
+00005b80: 6672 616d 6520 636f 6c75 6d6e 732e 0a20  frame columns.. 
+00005b90: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00005ba0: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
+00005bb0: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
+00005bc0: 2020 2020 2020 2020 2020 204d 2e72 6573             M.res
+00005bd0: 6574 5f69 6e64 6578 2c20 6472 6f70 3d64  et_index, drop=d
+00005be0: 726f 702c 2065 6e66 6f72 6365 5f6d 6574  rop, enforce_met
+00005bf0: 6164 6174 613d 4661 6c73 650a 2020 2020  adata=False.    
+00005c00: 2020 2020 292e 636c 6561 725f 6469 7669      ).clear_divi
+00005c10: 7369 6f6e 7328 290a 0a20 2020 2040 7072  sions()..    @pr
+00005c20: 6f70 6572 7479 0a20 2020 2064 6566 206b  operty.    def k
+00005c30: 6e6f 776e 5f64 6976 6973 696f 6e73 2873  nown_divisions(s
+00005c40: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00005c50: 2257 6865 7468 6572 2064 6976 6973 696f  "Whether divisio
+00005c60: 6e73 2061 7265 2061 6c72 6561 6479 206b  ns are already k
+00005c70: 6e6f 776e 2222 220a 2020 2020 2020 2020  nown""".        
+00005c80: 7265 7475 726e 206c 656e 2873 656c 662e  return len(self.
+00005c90: 6469 7669 7369 6f6e 7329 203e 2030 2061  divisions) > 0 a
+00005ca0: 6e64 2073 656c 662e 6469 7669 7369 6f6e  nd self.division
+00005cb0: 735b 305d 2069 7320 6e6f 7420 4e6f 6e65  s[0] is not None
+00005cc0: 0a0a 2020 2020 6465 6620 636c 6561 725f  ..    def clear_
+00005cd0: 6469 7669 7369 6f6e 7328 7365 6c66 293a  divisions(self):
+00005ce0: 0a20 2020 2020 2020 2022 2222 466f 7267  .        """Forg
+00005cf0: 6574 2064 6976 6973 696f 6e20 696e 666f  et division info
+00005d00: 726d 6174 696f 6e22 2222 0a20 2020 2020  rmation""".     
+00005d10: 2020 2064 6976 6973 696f 6e73 203d 2028     divisions = (
+00005d20: 4e6f 6e65 2c29 202a 2028 7365 6c66 2e6e  None,) * (self.n
+00005d30: 7061 7274 6974 696f 6e73 202b 2031 290a  partitions + 1).
+00005d40: 2020 2020 2020 2020 7265 7475 726e 2074          return t
+00005d50: 7970 6528 7365 6c66 2928 7365 6c66 2e64  ype(self)(self.d
+00005d60: 6173 6b2c 2073 656c 662e 5f6e 616d 652c  ask, self._name,
+00005d70: 2073 656c 662e 5f6d 6574 612c 2064 6976   self._meta, div
+00005d80: 6973 696f 6e73 290a 0a20 2020 2064 6566  isions)..    def
+00005d90: 2063 6f6d 7075 7465 5f63 7572 7265 6e74   compute_current
+00005da0: 5f64 6976 6973 696f 6e73 2873 656c 662c  _divisions(self,
+00005db0: 2063 6f6c 3d4e 6f6e 6529 3a0a 2020 2020   col=None):.    
+00005dc0: 2020 2020 2222 2243 6f6d 7075 7465 2074      """Compute t
+00005dd0: 6865 2063 7572 7265 6e74 2064 6976 6973  he current divis
+00005de0: 696f 6e73 206f 6620 7468 6520 4461 7461  ions of the Data
+00005df0: 4672 616d 652e 0a0a 2020 2020 2020 2020  Frame...        
+00005e00: 5468 6973 206d 6574 686f 6420 7472 6967  This method trig
+00005e10: 6765 7273 2069 6d6d 6564 6961 7465 2063  gers immediate c
+00005e20: 6f6d 7075 7461 7469 6f6e 2e20 4966 2079  omputation. If y
+00005e30: 6f75 2066 696e 6420 796f 7572 7365 6c66  ou find yourself
+00005e40: 2072 756e 6e69 6e67 2074 6869 7320 636f   running this co
+00005e50: 6d6d 616e 640a 2020 2020 2020 2020 7265  mmand.        re
+00005e60: 7065 6174 6564 6c79 2066 6f72 2074 6865  peatedly for the
+00005e70: 2073 616d 6520 6461 7461 6672 616d 652c   same dataframe,
+00005e80: 2077 6520 7265 636f 6d6d 656e 6420 7374   we recommend st
+00005e90: 6f72 696e 6720 7468 6520 7265 7375 6c74  oring the result
+00005ea0: 0a20 2020 2020 2020 2073 6f20 796f 7520  .        so you 
+00005eb0: 646f 6e27 7420 6861 7665 2074 6f20 7265  don't have to re
+00005ec0: 7275 6e20 6974 2e0a 0a20 2020 2020 2020  run it...       
+00005ed0: 2049 6620 7468 6520 636f 6c75 6d6e 206f   If the column o
+00005ee0: 7220 696e 6465 7820 7661 6c75 6573 206f  r index values o
+00005ef0: 7665 726c 6170 2062 6574 7765 656e 2070  verlap between p
+00005f00: 6172 7469 7469 6f6e 732c 2072 6169 7365  artitions, raise
+00005f10: 7320 6060 5661 6c75 6545 7272 6f72 6060  s ``ValueError``
+00005f20: 2e0a 2020 2020 2020 2020 546f 2070 7265  ..        To pre
+00005f30: 7665 6e74 2074 6869 732c 206d 616b 6520  vent this, make 
+00005f40: 7375 7265 2074 6865 2064 6174 6120 6172  sure the data ar
+00005f50: 6520 736f 7274 6564 2062 7920 7468 6520  e sorted by the 
+00005f60: 636f 6c75 6d6e 206f 7220 696e 6465 782e  column or index.
+00005f70: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00005f80: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+00005f90: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00005fa0: 636f 6c20 3a20 7374 7269 6e67 2c20 6f70  col : string, op
+00005fb0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00005fc0: 2020 2043 616c 6375 6c61 7465 2074 6865     Calculate the
+00005fd0: 2064 6976 6973 696f 6e73 2066 6f72 2061   divisions for a
+00005fe0: 206e 6f6e 2d69 6e64 6578 2063 6f6c 756d   non-index colum
+00005ff0: 6e20 6279 2070 6173 7369 6e67 2069 6e20  n by passing in 
+00006000: 7468 6520 6e61 6d65 206f 6620 7468 6520  the name of the 
+00006010: 636f 6c75 6d6e 2e0a 2020 2020 2020 2020  column..        
+00006020: 2020 2020 4966 2063 6f6c 2069 7320 6e6f      If col is no
+00006030: 7420 7370 6563 6966 6965 642c 2074 6865  t specified, the
+00006040: 2069 6e64 6578 2077 696c 6c20 6265 2075   index will be u
+00006050: 7365 6420 746f 2063 616c 6375 6c61 7465  sed to calculate
+00006060: 2064 6976 6973 696f 6e73 2e0a 2020 2020   divisions..    
+00006070: 2020 2020 2020 2020 496e 2074 6869 7320          In this 
+00006080: 6361 7365 2c20 6966 2074 6865 2064 6976  case, if the div
+00006090: 6973 696f 6e73 2061 7265 2061 6c72 6561  isions are alrea
+000060a0: 6479 206b 6e6f 776e 2c20 7468 6579 2077  dy known, they w
+000060b0: 696c 6c20 6265 2072 6574 7572 6e65 640a  ill be returned.
+000060c0: 2020 2020 2020 2020 2020 2020 696d 6d65              imme
+000060d0: 6469 6174 656c 7920 7769 7468 6f75 7420  diately without 
+000060e0: 636f 6d70 7574 696e 672e 0a0a 2020 2020  computing...    
+000060f0: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+00006100: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00006110: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
+00006120: 2064 6173 6b0a 2020 2020 2020 2020 3e3e   dask.        >>
+00006130: 3e20 6464 6620 3d20 6461 736b 2e64 6174  > ddf = dask.dat
+00006140: 6173 6574 732e 7469 6d65 7365 7269 6573  asets.timeseries
+00006150: 2873 7461 7274 3d22 3230 3231 2d30 312d  (start="2021-01-
+00006160: 3031 222c 2065 6e64 3d22 3230 3231 2d30  01", end="2021-0
+00006170: 312d 3037 222c 2066 7265 713d 2231 4822  1-07", freq="1H"
+00006180: 292e 636c 6561 725f 6469 7669 7369 6f6e  ).clear_division
+00006190: 7328 290a 2020 2020 2020 2020 3e3e 3e20  s().        >>> 
+000061a0: 6469 7669 7369 6f6e 7320 3d20 6464 662e  divisions = ddf.
+000061b0: 636f 6d70 7574 655f 6375 7272 656e 745f  compute_current_
+000061c0: 6469 7669 7369 6f6e 7328 290a 2020 2020  divisions().    
+000061d0: 2020 2020 3e3e 3e20 7072 696e 7428 6469      >>> print(di
+000061e0: 7669 7369 6f6e 7329 2020 2320 646f 6374  visions)  # doct
+000061f0: 6573 743a 202b 4e4f 524d 414c 495a 455f  est: +NORMALIZE_
+00006200: 5748 4954 4553 5041 4345 0a20 2020 2020  WHITESPACE.     
+00006210: 2020 2028 5469 6d65 7374 616d 7028 2732     (Timestamp('2
+00006220: 3032 312d 3031 2d30 3120 3030 3a30 303a  021-01-01 00:00:
 00006230: 3030 2729 2c0a 2020 2020 2020 2020 2054  00'),.         T
 00006240: 696d 6573 7461 6d70 2827 3230 3231 2d30  imestamp('2021-0
-00006250: 312d 3036 2030 303a 3030 3a30 3027 292c  1-06 00:00:00'),
+00006250: 312d 3032 2030 303a 3030 3a30 3027 292c  1-02 00:00:00'),
 00006260: 0a20 2020 2020 2020 2020 5469 6d65 7374  .         Timest
-00006270: 616d 7028 2732 3032 312d 3031 2d30 3620  amp('2021-01-06 
-00006280: 3233 3a30 303a 3030 2729 290a 0a20 2020  23:00:00'))..   
-00006290: 2020 2020 203e 3e3e 2064 6466 2e64 6976       >>> ddf.div
-000062a0: 6973 696f 6e73 203d 2064 6976 6973 696f  isions = divisio
-000062b0: 6e73 0a20 2020 2020 2020 203e 3e3e 2064  ns.        >>> d
-000062c0: 6466 2e6b 6e6f 776e 5f64 6976 6973 696f  df.known_divisio
-000062d0: 6e73 0a20 2020 2020 2020 2054 7275 650a  ns.        True.
-000062e0: 0a20 2020 2020 2020 203e 3e3e 2064 6466  .        >>> ddf
-000062f0: 203d 2064 6466 2e72 6573 6574 5f69 6e64   = ddf.reset_ind
-00006300: 6578 2829 2e63 6c65 6172 5f64 6976 6973  ex().clear_divis
-00006310: 696f 6e73 2829 0a20 2020 2020 2020 203e  ions().        >
-00006320: 3e3e 2064 6976 6973 696f 6e73 203d 2064  >> divisions = d
-00006330: 6466 2e63 6f6d 7075 7465 5f63 7572 7265  df.compute_curre
-00006340: 6e74 5f64 6976 6973 696f 6e73 2822 7469  nt_divisions("ti
-00006350: 6d65 7374 616d 7022 290a 2020 2020 2020  mestamp").      
-00006360: 2020 3e3e 3e20 7072 696e 7428 6469 7669    >>> print(divi
-00006370: 7369 6f6e 7329 2020 2320 646f 6374 6573  sions)  # doctes
-00006380: 743a 202b 4e4f 524d 414c 495a 455f 5748  t: +NORMALIZE_WH
-00006390: 4954 4553 5041 4345 0a20 2020 2020 2020  ITESPACE.       
-000063a0: 2028 5469 6d65 7374 616d 7028 2732 3032   (Timestamp('202
-000063b0: 312d 3031 2d30 3120 3030 3a30 303a 3030  1-01-01 00:00:00
-000063c0: 2729 2c0a 2020 2020 2020 2020 2054 696d  '),.         Tim
-000063d0: 6573 7461 6d70 2827 3230 3231 2d30 312d  estamp('2021-01-
-000063e0: 3032 2030 303a 3030 3a30 3027 292c 0a20  02 00:00:00'),. 
-000063f0: 2020 2020 2020 2020 5469 6d65 7374 616d          Timestam
-00006400: 7028 2732 3032 312d 3031 2d30 3320 3030  p('2021-01-03 00
-00006410: 3a30 303a 3030 2729 2c0a 2020 2020 2020  :00:00'),.      
-00006420: 2020 2054 696d 6573 7461 6d70 2827 3230     Timestamp('20
-00006430: 3231 2d30 312d 3034 2030 303a 3030 3a30  21-01-04 00:00:0
-00006440: 3027 292c 0a20 2020 2020 2020 2020 5469  0'),.         Ti
+00006270: 616d 7028 2732 3032 312d 3031 2d30 3320  amp('2021-01-03 
+00006280: 3030 3a30 303a 3030 2729 2c0a 2020 2020  00:00:00'),.    
+00006290: 2020 2020 2054 696d 6573 7461 6d70 2827       Timestamp('
+000062a0: 3230 3231 2d30 312d 3034 2030 303a 3030  2021-01-04 00:00
+000062b0: 3a30 3027 292c 0a20 2020 2020 2020 2020  :00'),.         
+000062c0: 5469 6d65 7374 616d 7028 2732 3032 312d  Timestamp('2021-
+000062d0: 3031 2d30 3520 3030 3a30 303a 3030 2729  01-05 00:00:00')
+000062e0: 2c0a 2020 2020 2020 2020 2054 696d 6573  ,.         Times
+000062f0: 7461 6d70 2827 3230 3231 2d30 312d 3036  tamp('2021-01-06
+00006300: 2030 303a 3030 3a30 3027 292c 0a20 2020   00:00:00'),.   
+00006310: 2020 2020 2020 5469 6d65 7374 616d 7028        Timestamp(
+00006320: 2732 3032 312d 3031 2d30 3620 3233 3a30  '2021-01-06 23:0
+00006330: 303a 3030 2729 290a 0a20 2020 2020 2020  0:00'))..       
+00006340: 203e 3e3e 2064 6466 2e64 6976 6973 696f   >>> ddf.divisio
+00006350: 6e73 203d 2064 6976 6973 696f 6e73 0a20  ns = divisions. 
+00006360: 2020 2020 2020 203e 3e3e 2064 6466 2e6b         >>> ddf.k
+00006370: 6e6f 776e 5f64 6976 6973 696f 6e73 0a20  nown_divisions. 
+00006380: 2020 2020 2020 2054 7275 650a 0a20 2020         True..   
+00006390: 2020 2020 203e 3e3e 2064 6466 203d 2064       >>> ddf = d
+000063a0: 6466 2e72 6573 6574 5f69 6e64 6578 2829  df.reset_index()
+000063b0: 2e63 6c65 6172 5f64 6976 6973 696f 6e73  .clear_divisions
+000063c0: 2829 0a20 2020 2020 2020 203e 3e3e 2064  ().        >>> d
+000063d0: 6976 6973 696f 6e73 203d 2064 6466 2e63  ivisions = ddf.c
+000063e0: 6f6d 7075 7465 5f63 7572 7265 6e74 5f64  ompute_current_d
+000063f0: 6976 6973 696f 6e73 2822 7469 6d65 7374  ivisions("timest
+00006400: 616d 7022 290a 2020 2020 2020 2020 3e3e  amp").        >>
+00006410: 3e20 7072 696e 7428 6469 7669 7369 6f6e  > print(division
+00006420: 7329 2020 2320 646f 6374 6573 743a 202b  s)  # doctest: +
+00006430: 4e4f 524d 414c 495a 455f 5748 4954 4553  NORMALIZE_WHITES
+00006440: 5041 4345 0a20 2020 2020 2020 2028 5469  PACE.        (Ti
 00006450: 6d65 7374 616d 7028 2732 3032 312d 3031  mestamp('2021-01
-00006460: 2d30 3520 3030 3a30 303a 3030 2729 2c0a  -05 00:00:00'),.
+00006460: 2d30 3120 3030 3a30 303a 3030 2729 2c0a  -01 00:00:00'),.
 00006470: 2020 2020 2020 2020 2054 696d 6573 7461           Timesta
-00006480: 6d70 2827 3230 3231 2d30 312d 3036 2030  mp('2021-01-06 0
+00006480: 6d70 2827 3230 3231 2d30 312d 3032 2030  mp('2021-01-02 0
 00006490: 303a 3030 3a30 3027 292c 0a20 2020 2020  0:00:00'),.     
 000064a0: 2020 2020 5469 6d65 7374 616d 7028 2732      Timestamp('2
-000064b0: 3032 312d 3031 2d30 3620 3233 3a30 303a  021-01-06 23:00:
-000064c0: 3030 2729 290a 0a20 2020 2020 2020 203e  00'))..        >
-000064d0: 3e3e 2064 6466 203d 2064 6466 2e73 6574  >> ddf = ddf.set
-000064e0: 5f69 6e64 6578 2822 7469 6d65 7374 616d  _index("timestam
-000064f0: 7022 2c20 6469 7669 7369 6f6e 733d 6469  p", divisions=di
-00006500: 7669 7369 6f6e 732c 2073 6f72 7465 643d  visions, sorted=
-00006510: 5472 7565 290a 2020 2020 2020 2020 2222  True).        ""
-00006520: 220a 2020 2020 2020 2020 6966 2063 6f6c  ".        if col
-00006530: 2069 7320 4e6f 6e65 2061 6e64 2073 656c   is None and sel
-00006540: 662e 6b6e 6f77 6e5f 6469 7669 7369 6f6e  f.known_division
-00006550: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
-00006560: 6574 7572 6e20 7365 6c66 2e64 6976 6973  eturn self.divis
-00006570: 696f 6e73 0a0a 2020 2020 2020 2020 6672  ions..        fr
-00006580: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
-00006590: 652e 7368 7566 666c 6520 696d 706f 7274  e.shuffle import
-000065a0: 2063 6f6d 7075 7465 5f64 6976 6973 696f   compute_divisio
-000065b0: 6e73 0a0a 2020 2020 2020 2020 7265 7475  ns..        retu
-000065c0: 726e 2063 6f6d 7075 7465 5f64 6976 6973  rn compute_divis
-000065d0: 696f 6e73 2873 656c 662c 2063 6f6c 3d63  ions(self, col=c
-000065e0: 6f6c 290a 0a20 2020 2064 6566 2067 6574  ol)..    def get
-000065f0: 5f70 6172 7469 7469 6f6e 2873 656c 662c  _partition(self,
-00006600: 206e 293a 0a20 2020 2020 2020 2022 2222   n):.        """
-00006610: 0a20 2020 2020 2020 2047 6574 2061 2064  .        Get a d
-00006620: 6173 6b20 4461 7461 4672 616d 652f 5365  ask DataFrame/Se
-00006630: 7269 6573 2072 6570 7265 7365 6e74 696e  ries representin
-00006640: 6720 7468 6520 606e 7468 6020 7061 7274  g the `nth` part
-00006650: 6974 696f 6e2e 0a0a 2020 2020 2020 2020  ition...        
-00006660: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-00006670: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00006680: 2020 2020 2020 6e20 3a20 696e 740a 2020        n : int.  
-00006690: 2020 2020 2020 2020 2020 5468 6520 302d            The 0-
-000066a0: 696e 6465 7865 6420 7061 7274 6974 696f  indexed partitio
-000066b0: 6e20 6e75 6d62 6572 2074 6f20 7365 6c65  n number to sele
-000066c0: 6374 2e0a 0a20 2020 2020 2020 2052 6574  ct...        Ret
-000066d0: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
-000066e0: 2d2d 2d2d 0a20 2020 2020 2020 2044 6173  ----.        Das
-000066f0: 6b20 4461 7461 4672 616d 6520 6f72 2053  k DataFrame or S
-00006700: 6572 6965 730a 2020 2020 2020 2020 2020  eries.          
-00006710: 2020 5468 6520 7361 6d65 2074 7970 6520    The same type 
-00006720: 6173 2074 6865 206f 7269 6769 6e61 6c20  as the original 
-00006730: 6f62 6a65 6374 2e0a 0a20 2020 2020 2020  object...       
-00006740: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
-00006750: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-00006760: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-00006770: 736b 0a20 2020 2020 2020 203e 3e3e 2064  sk.        >>> d
-00006780: 6466 203d 2064 6173 6b2e 6461 7461 7365  df = dask.datase
-00006790: 7473 2e74 696d 6573 6572 6965 7328 7374  ts.timeseries(st
-000067a0: 6172 743d 2232 3032 312d 3031 2d30 3122  art="2021-01-01"
-000067b0: 2c20 656e 643d 2232 3032 312d 3031 2d30  , end="2021-01-0
-000067c0: 3722 2c20 6672 6571 3d22 3148 2229 0a20  7", freq="1H"). 
-000067d0: 2020 2020 2020 203e 3e3e 2064 6466 2e67         >>> ddf.g
-000067e0: 6574 5f70 6172 7469 7469 6f6e 2830 2920  et_partition(0) 
-000067f0: 2023 2064 6f63 7465 7374 3a20 2b4e 4f52   # doctest: +NOR
-00006800: 4d41 4c49 5a45 5f57 4849 5445 5350 4143  MALIZE_WHITESPAC
-00006810: 450a 2020 2020 2020 2020 4461 736b 2044  E.        Dask D
-00006820: 6174 6146 7261 6d65 2053 7472 7563 7475  ataFrame Structu
-00006830: 7265 3a0a 2020 2020 2020 2020 2020 2020  re:.            
-00006840: 2020 2020 2020 2020 2020 2020 206e 616d               nam
-00006850: 6520 2020 2020 6964 2020 2020 2020 2020  e     id        
-00006860: 7820 2020 2020 2020 2079 0a20 2020 2020  x        y.     
-00006870: 2020 206e 7061 7274 6974 696f 6e73 3d31     npartitions=1
-00006880: 0a20 2020 2020 2020 2032 3032 312d 3031  .        2021-01
-00006890: 2d30 3120 2020 2020 6f62 6a65 6374 2020  -01     object  
-000068a0: 696e 7436 3420 2066 6c6f 6174 3634 2020  int64  float64  
-000068b0: 666c 6f61 7436 340a 2020 2020 2020 2020  float64.        
-000068c0: 3230 3231 2d30 312d 3032 2020 2020 2020  2021-01-02      
-000068d0: 2020 2e2e 2e20 2020 202e 2e2e 2020 2020    ...    ...    
-000068e0: 2020 2e2e 2e20 2020 2020 202e 2e2e 0a20    ...      .... 
-000068f0: 2020 2020 2020 2044 6173 6b20 4e61 6d65         Dask Name
-00006900: 3a20 6765 742d 7061 7274 6974 696f 6e2c  : get-partition,
-00006910: 2032 2067 7261 7068 206c 6179 6572 730a   2 graph layers.
-00006920: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
-00006930: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
-00006940: 2d2d 0a20 2020 2020 2020 2044 6174 6146  --.        DataF
-00006950: 7261 6d65 2e70 6172 7469 7469 6f6e 730a  rame.partitions.
-00006960: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00006970: 2020 2020 6966 2030 203c 3d20 6e20 3c20      if 0 <= n < 
-00006980: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
-00006990: 3a0a 2020 2020 2020 2020 2020 2020 6e61  :.            na
-000069a0: 6d65 203d 2066 2267 6574 2d70 6172 7469  me = f"get-parti
-000069b0: 7469 6f6e 2d7b 7374 7228 6e29 7d2d 7b73  tion-{str(n)}-{s
-000069c0: 656c 662e 5f6e 616d 657d 220a 2020 2020  elf._name}".    
-000069d0: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
-000069e0: 7320 3d20 7365 6c66 2e64 6976 6973 696f  s = self.divisio
-000069f0: 6e73 5b6e 203a 206e 202b 2032 5d0a 2020  ns[n : n + 2].  
-00006a00: 2020 2020 2020 2020 2020 6c61 7965 7220            layer 
-00006a10: 3d20 7b28 6e61 6d65 2c20 3029 3a20 2873  = {(name, 0): (s
-00006a20: 656c 662e 5f6e 616d 652c 206e 297d 0a20  elf._name, n)}. 
-00006a30: 2020 2020 2020 2020 2020 2067 7261 7068             graph
-00006a40: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
-00006a50: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
-00006a60: 6e73 286e 616d 652c 206c 6179 6572 2c20  ns(name, layer, 
-00006a70: 6465 7065 6e64 656e 6369 6573 3d5b 7365  dependencies=[se
-00006a80: 6c66 5d29 0a20 2020 2020 2020 2020 2020  lf]).           
-00006a90: 2072 6574 7572 6e20 6e65 775f 6464 5f6f   return new_dd_o
-00006aa0: 626a 6563 7428 6772 6170 682c 206e 616d  bject(graph, nam
-00006ab0: 652c 2073 656c 662e 5f6d 6574 612c 2064  e, self._meta, d
-00006ac0: 6976 6973 696f 6e73 290a 2020 2020 2020  ivisions).      
-00006ad0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00006ae0: 2020 2020 6d73 6720 3d20 6622 6e20 6d75      msg = f"n mu
-00006af0: 7374 2062 6520 3020 3c3d 206e 203c 207b  st be 0 <= n < {
-00006b00: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
-00006b10: 7d22 0a20 2020 2020 2020 2020 2020 2072  }".            r
-00006b20: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00006b30: 6d73 6729 0a0a 2020 2020 4064 6572 6976  msg)..    @deriv
-00006b40: 6564 5f66 726f 6d28 0a20 2020 2020 2020  ed_from(.       
-00006b50: 2070 642e 4461 7461 4672 616d 652c 0a20   pd.DataFrame,. 
-00006b60: 2020 2020 2020 2069 6e63 6f6e 7369 7374         inconsist
-00006b70: 656e 6369 6573 3d22 6b65 6570 3d46 616c  encies="keep=Fal
-00006b80: 7365 2077 696c 6c20 7261 6973 6520 6120  se will raise a 
-00006b90: 6060 4e6f 7449 6d70 6c65 6d65 6e74 6564  ``NotImplemented
-00006ba0: 4572 726f 7260 6022 2c0a 2020 2020 290a  Error``",.    ).
-00006bb0: 2020 2020 6465 6620 6472 6f70 5f64 7570      def drop_dup
-00006bc0: 6c69 6361 7465 7328 0a20 2020 2020 2020  licates(.       
-00006bd0: 2073 656c 662c 2073 7562 7365 743d 4e6f   self, subset=No
-00006be0: 6e65 2c20 7370 6c69 745f 6576 6572 793d  ne, split_every=
-00006bf0: 4e6f 6e65 2c20 7370 6c69 745f 6f75 743d  None, split_out=
-00006c00: 312c 2069 676e 6f72 655f 696e 6465 783d  1, ignore_index=
-00006c10: 4661 6c73 652c 202a 2a6b 7761 7267 730a  False, **kwargs.
-00006c20: 2020 2020 293a 0a20 2020 2020 2020 2069      ):.        i
-00006c30: 6620 7375 6273 6574 2069 7320 6e6f 7420  f subset is not 
-00006c40: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00006c50: 2020 2320 4c65 7420 7061 6e64 6173 2065    # Let pandas e
-00006c60: 7272 6f72 206f 6e20 6261 6420 696e 7075  rror on bad inpu
-00006c70: 7473 0a20 2020 2020 2020 2020 2020 2073  ts.            s
-00006c80: 656c 662e 5f6d 6574 615f 6e6f 6e65 6d70  elf._meta_nonemp
-00006c90: 7479 2e64 726f 705f 6475 706c 6963 6174  ty.drop_duplicat
-00006ca0: 6573 2873 7562 7365 743d 7375 6273 6574  es(subset=subset
-00006cb0: 2c20 2a2a 6b77 6172 6773 290a 2020 2020  , **kwargs).    
-00006cc0: 2020 2020 2020 2020 6b77 6172 6773 5b22          kwargs["
-00006cd0: 7375 6273 6574 225d 203d 2073 7562 7365  subset"] = subse
-00006ce0: 740a 2020 2020 2020 2020 2020 2020 7370  t.            sp
-00006cf0: 6c69 745f 6f75 745f 7365 7475 7020 3d20  lit_out_setup = 
-00006d00: 7370 6c69 745f 6f75 745f 6f6e 5f63 6f6c  split_out_on_col
-00006d10: 730a 2020 2020 2020 2020 2020 2020 7370  s.            sp
-00006d20: 6c69 745f 6f75 745f 7365 7475 705f 6b77  lit_out_setup_kw
-00006d30: 6172 6773 203d 207b 2263 6f6c 7322 3a20  args = {"cols": 
-00006d40: 7375 6273 6574 7d0a 2020 2020 2020 2020  subset}.        
-00006d50: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00006d60: 2020 7365 6c66 2e5f 6d65 7461 5f6e 6f6e    self._meta_non
-00006d70: 656d 7074 792e 6472 6f70 5f64 7570 6c69  empty.drop_dupli
-00006d80: 6361 7465 7328 2a2a 6b77 6172 6773 290a  cates(**kwargs).
-00006d90: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
-00006da0: 745f 6f75 745f 7365 7475 7020 3d20 7370  t_out_setup = sp
-00006db0: 6c69 745f 6f75 745f 7365 7475 705f 6b77  lit_out_setup_kw
-00006dc0: 6172 6773 203d 204e 6f6e 650a 0a20 2020  args = None..   
-00006dd0: 2020 2020 2069 6620 6b77 6172 6773 2e67       if kwargs.g
-00006de0: 6574 2822 6b65 6570 222c 2054 7275 6529  et("keep", True)
-00006df0: 2069 7320 4661 6c73 653a 0a20 2020 2020   is False:.     
-00006e00: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-00006e10: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-00006e20: 2822 6472 6f70 5f64 7570 6c69 6361 7465  ("drop_duplicate
-00006e30: 7320 7769 7468 206b 6565 703d 4661 6c73  s with keep=Fals
-00006e40: 6522 290a 0a20 2020 2020 2020 2063 6875  e")..        chu
-00006e50: 6e6b 203d 204d 2e64 726f 705f 6475 706c  nk = M.drop_dupl
-00006e60: 6963 6174 6573 0a20 2020 2020 2020 2072  icates.        r
-00006e70: 6574 7572 6e20 6163 6128 0a20 2020 2020  eturn aca(.     
-00006e80: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00006e90: 2020 2020 2020 2020 2063 6875 6e6b 3d63           chunk=c
-00006ea0: 6875 6e6b 2c0a 2020 2020 2020 2020 2020  hunk,.          
-00006eb0: 2020 6167 6772 6567 6174 653d 6368 756e    aggregate=chun
-00006ec0: 6b2c 0a20 2020 2020 2020 2020 2020 206d  k,.            m
-00006ed0: 6574 613d 7365 6c66 2e5f 6d65 7461 2c0a  eta=self._meta,.
-00006ee0: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
-00006ef0: 6e3d 2264 726f 702d 6475 706c 6963 6174  n="drop-duplicat
-00006f00: 6573 222c 0a20 2020 2020 2020 2020 2020  es",.           
-00006f10: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
-00006f20: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
-00006f30: 2020 2020 2020 7370 6c69 745f 6f75 743d        split_out=
-00006f40: 7370 6c69 745f 6f75 742c 0a20 2020 2020  split_out,.     
-00006f50: 2020 2020 2020 2073 706c 6974 5f6f 7574         split_out
-00006f60: 5f73 6574 7570 3d73 706c 6974 5f6f 7574  _setup=split_out
-00006f70: 5f73 6574 7570 2c0a 2020 2020 2020 2020  _setup,.        
-00006f80: 2020 2020 7370 6c69 745f 6f75 745f 7365      split_out_se
-00006f90: 7475 705f 6b77 6172 6773 3d73 706c 6974  tup_kwargs=split
-00006fa0: 5f6f 7574 5f73 6574 7570 5f6b 7761 7267  _out_setup_kwarg
-00006fb0: 732c 0a20 2020 2020 2020 2020 2020 2069  s,.            i
-00006fc0: 676e 6f72 655f 696e 6465 783d 6967 6e6f  gnore_index=igno
-00006fd0: 7265 5f69 6e64 6578 2c0a 2020 2020 2020  re_index,.      
-00006fe0: 2020 2020 2020 2a2a 6b77 6172 6773 2c0a        **kwargs,.
-00006ff0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00007000: 6566 205f 5f6c 656e 5f5f 2873 656c 6629  ef __len__(self)
-00007010: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00007020: 2073 656c 662e 7265 6475 6374 696f 6e28   self.reduction(
-00007030: 0a20 2020 2020 2020 2020 2020 206c 656e  .            len
-00007040: 2c20 6e70 2e73 756d 2c20 746f 6b65 6e3d  , np.sum, token=
-00007050: 226c 656e 222c 206d 6574 613d 696e 742c  "len", meta=int,
-00007060: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-00007070: 7365 0a20 2020 2020 2020 2029 2e63 6f6d  se.        ).com
-00007080: 7075 7465 2829 0a0a 2020 2020 6465 6620  pute()..    def 
-00007090: 5f5f 626f 6f6c 5f5f 2873 656c 6629 3a0a  __bool__(self):.
-000070a0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-000070b0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-000070c0: 2020 2020 2020 6622 5468 6520 7472 7574        f"The trut
-000070d0: 6820 7661 6c75 6520 6f66 2061 207b 7365  h value of a {se
-000070e0: 6c66 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  lf.__class__.__n
-000070f0: 616d 655f 5f7d 2069 7320 616d 6269 6775  ame__} is ambigu
-00007100: 6f75 732e 2022 0a20 2020 2020 2020 2020  ous. ".         
-00007110: 2020 2022 5573 6520 612e 616e 7928 2920     "Use a.any() 
-00007120: 6f72 2061 2e61 6c6c 2829 2e22 0a20 2020  or a.all().".   
-00007130: 2020 2020 2029 0a0a 2020 2020 5f5f 6e6f       )..    __no
-00007140: 6e7a 6572 6f5f 5f20 3d20 5f5f 626f 6f6c  nzero__ = __bool
-00007150: 5f5f 2020 2320 7079 7468 6f6e 2032 0a0a  __  # python 2..
-00007160: 2020 2020 6465 6620 5f73 6361 6c61 7266      def _scalarf
-00007170: 756e 6328 7365 6c66 2c20 6361 7374 5f74  unc(self, cast_t
-00007180: 7970 6529 3a0a 2020 2020 2020 2020 6465  ype):.        de
-00007190: 6620 7772 6170 7065 7228 293a 0a20 2020  f wrapper():.   
-000071a0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-000071b0: 7970 6545 7272 6f72 2866 2263 616e 6e6f  ypeError(f"canno
-000071c0: 7420 636f 6e76 6572 7420 7468 6520 7365  t convert the se
-000071d0: 7269 6573 2074 6f20 7b63 6173 745f 7479  ries to {cast_ty
-000071e0: 7065 7d22 290a 0a20 2020 2020 2020 2072  pe}")..        r
-000071f0: 6574 7572 6e20 7772 6170 7065 720a 0a20  eturn wrapper.. 
-00007200: 2020 2064 6566 205f 5f66 6c6f 6174 5f5f     def __float__
-00007210: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00007220: 7265 7475 726e 2073 656c 662e 5f73 6361  return self._sca
-00007230: 6c61 7266 756e 6328 666c 6f61 7429 0a0a  larfunc(float)..
-00007240: 2020 2020 6465 6620 5f5f 696e 745f 5f28      def __int__(
-00007250: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00007260: 6574 7572 6e20 7365 6c66 2e5f 7363 616c  eturn self._scal
-00007270: 6172 6675 6e63 2869 6e74 290a 0a20 2020  arfunc(int)..   
-00007280: 205f 5f6c 6f6e 675f 5f20 3d20 5f5f 696e   __long__ = __in
-00007290: 745f 5f20 2023 2070 7974 686f 6e20 320a  t__  # python 2.
-000072a0: 0a20 2020 2064 6566 205f 5f63 6f6d 706c  .    def __compl
-000072b0: 6578 5f5f 2873 656c 6629 3a0a 2020 2020  ex__(self):.    
-000072c0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-000072d0: 5f73 6361 6c61 7266 756e 6328 636f 6d70  _scalarfunc(comp
-000072e0: 6c65 7829 0a0a 2020 2020 4069 6e73 6572  lex)..    @inser
-000072f0: 745f 6d65 7461 5f70 6172 616d 5f64 6573  t_meta_param_des
-00007300: 6372 6970 7469 6f6e 2870 6164 3d31 3229  cription(pad=12)
-00007310: 0a20 2020 2064 6566 206d 6170 5f70 6172  .    def map_par
-00007320: 7469 7469 6f6e 7328 7365 6c66 2c20 6675  titions(self, fu
-00007330: 6e63 2c20 2a61 7267 732c 202a 2a6b 7761  nc, *args, **kwa
-00007340: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
-00007350: 2241 7070 6c79 2050 7974 686f 6e20 6675  "Apply Python fu
-00007360: 6e63 7469 6f6e 206f 6e20 6561 6368 2044  nction on each D
-00007370: 6174 6146 7261 6d65 2070 6172 7469 7469  ataFrame partiti
-00007380: 6f6e 2e0a 0a20 2020 2020 2020 204e 6f74  on...        Not
-00007390: 6520 7468 6174 2074 6865 2069 6e64 6578  e that the index
-000073a0: 2061 6e64 2064 6976 6973 696f 6e73 2061   and divisions a
-000073b0: 7265 2061 7373 756d 6564 2074 6f20 7265  re assumed to re
-000073c0: 6d61 696e 2075 6e63 6861 6e67 6564 2e0a  main unchanged..
-000073d0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-000073e0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-000073f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2066  ------.        f
-00007400: 756e 6320 3a20 6675 6e63 7469 6f6e 0a20  unc : function. 
-00007410: 2020 2020 2020 2020 2020 2054 6865 2066             The f
-00007420: 756e 6374 696f 6e20 6170 706c 6965 6420  unction applied 
-00007430: 746f 2065 6163 6820 7061 7274 6974 696f  to each partitio
-00007440: 6e2e 2049 6620 7468 6973 2066 756e 6374  n. If this funct
-00007450: 696f 6e20 6163 6365 7074 730a 2020 2020  ion accepts.    
-00007460: 2020 2020 2020 2020 7468 6520 7370 6563          the spec
-00007470: 6961 6c20 6060 7061 7274 6974 696f 6e5f  ial ``partition_
-00007480: 696e 666f 6060 206b 6579 776f 7264 2061  info`` keyword a
-00007490: 7267 756d 656e 742c 2069 7420 7769 6c6c  rgument, it will
-000074a0: 2072 6563 6569 7665 0a20 2020 2020 2020   receive.       
-000074b0: 2020 2020 2069 6e66 6f72 6d61 7469 6f6e       information
-000074c0: 206f 6e20 7468 6520 7061 7274 6974 696f   on the partitio
-000074d0: 6e27 7320 7265 6c61 7469 7665 206c 6f63  n's relative loc
-000074e0: 6174 696f 6e20 7769 7468 696e 2074 6865  ation within the
-000074f0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-00007500: 6166 7261 6d65 2e0a 2020 2020 2020 2020  aframe..        
-00007510: 6172 6773 2c20 6b77 6172 6773 203a 0a20  args, kwargs :. 
-00007520: 2020 2020 2020 2020 2020 2050 6f73 6974             Posit
-00007530: 696f 6e61 6c20 616e 6420 6b65 7977 6f72  ional and keywor
-00007540: 6420 6172 6775 6d65 6e74 7320 746f 2070  d arguments to p
-00007550: 6173 7320 746f 2074 6865 2066 756e 6374  ass to the funct
-00007560: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
-00007570: 2050 6f73 6974 696f 6e61 6c20 6172 6775   Positional argu
-00007580: 6d65 6e74 7320 6172 6520 636f 6d70 7574  ments are comput
-00007590: 6564 206f 6e20 6120 7065 722d 7061 7274  ed on a per-part
-000075a0: 6974 696f 6e20 6261 7369 732c 2077 6869  ition basis, whi
-000075b0: 6c65 0a20 2020 2020 2020 2020 2020 206b  le.            k
-000075c0: 6579 776f 7264 2061 7267 756d 656e 7473  eyword arguments
-000075d0: 2061 7265 2073 6861 7265 6420 6163 726f   are shared acro
-000075e0: 7373 2061 6c6c 2070 6172 7469 7469 6f6e  ss all partition
-000075f0: 732e 2054 6865 2070 6172 7469 7469 6f6e  s. The partition
-00007600: 0a20 2020 2020 2020 2020 2020 2069 7473  .            its
-00007610: 656c 6620 7769 6c6c 2062 6520 7468 6520  elf will be the 
-00007620: 6669 7273 7420 706f 7369 7469 6f6e 616c  first positional
-00007630: 2061 7267 756d 656e 742c 2077 6974 6820   argument, with 
-00007640: 616c 6c20 6f74 6865 720a 2020 2020 2020  all other.      
-00007650: 2020 2020 2020 6172 6775 6d65 6e74 7320        arguments 
-00007660: 7061 7373 6564 202a 6166 7465 722a 2e20  passed *after*. 
-00007670: 4172 6775 6d65 6e74 7320 6361 6e20 6265  Arguments can be
-00007680: 2060 6053 6361 6c61 7260 602c 2060 6044   ``Scalar``, ``D
-00007690: 656c 6179 6564 6060 2c0a 2020 2020 2020  elayed``,.      
-000076a0: 2020 2020 2020 6f72 2072 6567 756c 6172        or regular
-000076b0: 2050 7974 686f 6e20 6f62 6a65 6374 732e   Python objects.
-000076c0: 2044 6174 6146 7261 6d65 2d6c 696b 6520   DataFrame-like 
-000076d0: 6172 6773 2028 626f 7468 2064 6173 6b20  args (both dask 
-000076e0: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
-000076f0: 7061 6e64 6173 2920 7769 6c6c 2062 6520  pandas) will be 
-00007700: 7265 7061 7274 6974 696f 6e65 6420 746f  repartitioned to
-00007710: 2061 6c69 676e 2028 6966 206e 6563 6573   align (if neces
-00007720: 7361 7279 2920 6265 666f 7265 0a20 2020  sary) before.   
-00007730: 2020 2020 2020 2020 2061 7070 6c79 696e           applyin
-00007740: 6720 7468 6520 6675 6e63 7469 6f6e 3b20  g the function; 
-00007750: 7365 6520 6060 616c 6967 6e5f 6461 7461  see ``align_data
-00007760: 6672 616d 6573 6060 2074 6f20 636f 6e74  frames`` to cont
-00007770: 726f 6c20 7468 6973 0a20 2020 2020 2020  rol this.       
-00007780: 2020 2020 2062 6568 6176 696f 722e 0a20       behavior.. 
-00007790: 2020 2020 2020 2065 6e66 6f72 6365 5f6d         enforce_m
-000077a0: 6574 6164 6174 6120 3a20 626f 6f6c 2c20  etadata : bool, 
-000077b0: 6465 6661 756c 7420 5472 7565 0a20 2020  default True.   
-000077c0: 2020 2020 2020 2020 2057 6865 7468 6572           Whether
-000077d0: 2074 6f20 656e 666f 7263 6520 6174 2072   to enforce at r
-000077e0: 756e 7469 6d65 2074 6861 7420 7468 6520  untime that the 
-000077f0: 7374 7275 6374 7572 6520 6f66 2074 6865  structure of the
-00007800: 2044 6174 6146 7261 6d65 0a20 2020 2020   DataFrame.     
-00007810: 2020 2020 2020 2070 726f 6475 6365 6420         produced 
-00007820: 6279 2060 6066 756e 6360 6020 6163 7475  by ``func`` actu
-00007830: 616c 6c79 206d 6174 6368 6573 2074 6865  ally matches the
-00007840: 2073 7472 7563 7475 7265 206f 6620 6060   structure of ``
-00007850: 6d65 7461 6060 2e0a 2020 2020 2020 2020  meta``..        
-00007860: 2020 2020 5468 6973 2077 696c 6c20 7265      This will re
-00007870: 6e61 6d65 2061 6e64 2072 656f 7264 6572  name and reorder
-00007880: 2063 6f6c 756d 6e73 2066 6f72 2065 6163   columns for eac
-00007890: 6820 7061 7274 6974 696f 6e2c 0a20 2020  h partition,.   
-000078a0: 2020 2020 2020 2020 2061 6e64 2077 696c           and wil
-000078b0: 6c20 7261 6973 6520 616e 2065 7272 6f72  l raise an error
-000078c0: 2069 6620 7468 6973 2064 6f65 736e 2774   if this doesn't
-000078d0: 2077 6f72 6b2c 0a20 2020 2020 2020 2020   work,.         
-000078e0: 2020 2062 7574 2069 7420 776f 6e27 7420     but it won't 
-000078f0: 7261 6973 6520 6966 2064 7479 7065 7320  raise if dtypes 
-00007900: 646f 6e27 7420 6d61 7463 682e 0a20 2020  don't match..   
-00007910: 2020 2020 2074 7261 6e73 666f 726d 5f64       transform_d
-00007920: 6976 6973 696f 6e73 203a 2062 6f6f 6c2c  ivisions : bool,
-00007930: 2064 6566 6175 6c74 2054 7275 650a 2020   default True.  
-00007940: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
-00007950: 7220 746f 2061 7070 6c79 2074 6865 2066  r to apply the f
-00007960: 756e 6374 696f 6e20 6f6e 746f 2074 6865  unction onto the
-00007970: 2064 6976 6973 696f 6e73 2061 6e64 2061   divisions and a
-00007980: 7070 6c79 2074 686f 7365 0a20 2020 2020  pply those.     
-00007990: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
-000079a0: 6564 2064 6976 6973 696f 6e73 2074 6f20  ed divisions to 
-000079b0: 7468 6520 6f75 7470 7574 2e0a 2020 2020  the output..    
-000079c0: 2020 2020 616c 6967 6e5f 6461 7461 6672      align_datafr
-000079d0: 616d 6573 203a 2062 6f6f 6c2c 2064 6566  ames : bool, def
+000064b0: 3032 312d 3031 2d30 3320 3030 3a30 303a  021-01-03 00:00:
+000064c0: 3030 2729 2c0a 2020 2020 2020 2020 2054  00'),.         T
+000064d0: 696d 6573 7461 6d70 2827 3230 3231 2d30  imestamp('2021-0
+000064e0: 312d 3034 2030 303a 3030 3a30 3027 292c  1-04 00:00:00'),
+000064f0: 0a20 2020 2020 2020 2020 5469 6d65 7374  .         Timest
+00006500: 616d 7028 2732 3032 312d 3031 2d30 3520  amp('2021-01-05 
+00006510: 3030 3a30 303a 3030 2729 2c0a 2020 2020  00:00:00'),.    
+00006520: 2020 2020 2054 696d 6573 7461 6d70 2827       Timestamp('
+00006530: 3230 3231 2d30 312d 3036 2030 303a 3030  2021-01-06 00:00
+00006540: 3a30 3027 292c 0a20 2020 2020 2020 2020  :00'),.         
+00006550: 5469 6d65 7374 616d 7028 2732 3032 312d  Timestamp('2021-
+00006560: 3031 2d30 3620 3233 3a30 303a 3030 2729  01-06 23:00:00')
+00006570: 290a 0a20 2020 2020 2020 203e 3e3e 2064  )..        >>> d
+00006580: 6466 203d 2064 6466 2e73 6574 5f69 6e64  df = ddf.set_ind
+00006590: 6578 2822 7469 6d65 7374 616d 7022 2c20  ex("timestamp", 
+000065a0: 6469 7669 7369 6f6e 733d 6469 7669 7369  divisions=divisi
+000065b0: 6f6e 732c 2073 6f72 7465 643d 5472 7565  ons, sorted=True
+000065c0: 290a 2020 2020 2020 2020 2222 220a 2020  ).        """.  
+000065d0: 2020 2020 2020 6966 2063 6f6c 2069 7320        if col is 
+000065e0: 4e6f 6e65 2061 6e64 2073 656c 662e 6b6e  None and self.kn
+000065f0: 6f77 6e5f 6469 7669 7369 6f6e 733a 0a20  own_divisions:. 
+00006600: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00006610: 6e20 7365 6c66 2e64 6976 6973 696f 6e73  n self.divisions
+00006620: 0a0a 2020 2020 2020 2020 6672 6f6d 2064  ..        from d
+00006630: 6173 6b2e 6461 7461 6672 616d 652e 7368  ask.dataframe.sh
+00006640: 7566 666c 6520 696d 706f 7274 2063 6f6d  uffle import com
+00006650: 7075 7465 5f64 6976 6973 696f 6e73 0a0a  pute_divisions..
+00006660: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+00006670: 6f6d 7075 7465 5f64 6976 6973 696f 6e73  ompute_divisions
+00006680: 2873 656c 662c 2063 6f6c 3d63 6f6c 290a  (self, col=col).
+00006690: 0a20 2020 2064 6566 2067 6574 5f70 6172  .    def get_par
+000066a0: 7469 7469 6f6e 2873 656c 662c 206e 293a  tition(self, n):
+000066b0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000066c0: 2020 2020 2047 6574 2061 2064 6173 6b20       Get a dask 
+000066d0: 4461 7461 4672 616d 652f 5365 7269 6573  DataFrame/Series
+000066e0: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
+000066f0: 6520 606e 7468 6020 7061 7274 6974 696f  e `nth` partitio
+00006700: 6e2e 0a0a 2020 2020 2020 2020 5061 7261  n...        Para
+00006710: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+00006720: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00006730: 2020 6e20 3a20 696e 740a 2020 2020 2020    n : int.      
+00006740: 2020 2020 2020 5468 6520 302d 696e 6465        The 0-inde
+00006750: 7865 6420 7061 7274 6974 696f 6e20 6e75  xed partition nu
+00006760: 6d62 6572 2074 6f20 7365 6c65 6374 2e0a  mber to select..
+00006770: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00006780: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00006790: 0a20 2020 2020 2020 2044 6173 6b20 4461  .        Dask Da
+000067a0: 7461 4672 616d 6520 6f72 2053 6572 6965  taFrame or Serie
+000067b0: 730a 2020 2020 2020 2020 2020 2020 5468  s.            Th
+000067c0: 6520 7361 6d65 2074 7970 6520 6173 2074  e same type as t
+000067d0: 6865 206f 7269 6769 6e61 6c20 6f62 6a65  he original obje
+000067e0: 6374 2e0a 0a20 2020 2020 2020 2045 7861  ct...        Exa
+000067f0: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
+00006800: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
+00006810: 3e3e 2069 6d70 6f72 7420 6461 736b 0a20  >> import dask. 
+00006820: 2020 2020 2020 203e 3e3e 2064 6466 203d         >>> ddf =
+00006830: 2064 6173 6b2e 6461 7461 7365 7473 2e74   dask.datasets.t
+00006840: 696d 6573 6572 6965 7328 7374 6172 743d  imeseries(start=
+00006850: 2232 3032 312d 3031 2d30 3122 2c20 656e  "2021-01-01", en
+00006860: 643d 2232 3032 312d 3031 2d30 3722 2c20  d="2021-01-07", 
+00006870: 6672 6571 3d22 3148 2229 0a20 2020 2020  freq="1H").     
+00006880: 2020 203e 3e3e 2064 6466 2e67 6574 5f70     >>> ddf.get_p
+00006890: 6172 7469 7469 6f6e 2830 2920 2023 2064  artition(0)  # d
+000068a0: 6f63 7465 7374 3a20 2b4e 4f52 4d41 4c49  octest: +NORMALI
+000068b0: 5a45 5f57 4849 5445 5350 4143 450a 2020  ZE_WHITESPACE.  
+000068c0: 2020 2020 2020 4461 736b 2044 6174 6146        Dask DataF
+000068d0: 7261 6d65 2053 7472 7563 7475 7265 3a0a  rame Structure:.
+000068e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000068f0: 2020 2020 2020 2020 206e 616d 6520 2020           name   
+00006900: 2020 6964 2020 2020 2020 2020 7820 2020    id        x   
+00006910: 2020 2020 2079 0a20 2020 2020 2020 206e       y.        n
+00006920: 7061 7274 6974 696f 6e73 3d31 0a20 2020  partitions=1.   
+00006930: 2020 2020 2032 3032 312d 3031 2d30 3120       2021-01-01 
+00006940: 2020 2020 6f62 6a65 6374 2020 696e 7436      object  int6
+00006950: 3420 2066 6c6f 6174 3634 2020 666c 6f61  4  float64  floa
+00006960: 7436 340a 2020 2020 2020 2020 3230 3231  t64.        2021
+00006970: 2d30 312d 3032 2020 2020 2020 2020 2e2e  -01-02        ..
+00006980: 2e20 2020 202e 2e2e 2020 2020 2020 2e2e  .    ...      ..
+00006990: 2e20 2020 2020 202e 2e2e 0a20 2020 2020  .      ....     
+000069a0: 2020 2044 6173 6b20 4e61 6d65 3a20 6765     Dask Name: ge
+000069b0: 742d 7061 7274 6974 696f 6e2c 2032 2067  t-partition, 2 g
+000069c0: 7261 7068 206c 6179 6572 730a 0a20 2020  raph layers..   
+000069d0: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
+000069e0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+000069f0: 2020 2020 2020 2044 6174 6146 7261 6d65         DataFrame
+00006a00: 2e70 6172 7469 7469 6f6e 730a 2020 2020  .partitions.    
+00006a10: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00006a20: 6966 2030 203c 3d20 6e20 3c20 7365 6c66  if 0 <= n < self
+00006a30: 2e6e 7061 7274 6974 696f 6e73 3a0a 2020  .npartitions:.  
+00006a40: 2020 2020 2020 2020 2020 6e61 6d65 203d            name =
+00006a50: 2066 2267 6574 2d70 6172 7469 7469 6f6e   f"get-partition
+00006a60: 2d7b 7374 7228 6e29 7d2d 7b73 656c 662e  -{str(n)}-{self.
+00006a70: 5f6e 616d 657d 220a 2020 2020 2020 2020  _name}".        
+00006a80: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
+00006a90: 7365 6c66 2e64 6976 6973 696f 6e73 5b6e  self.divisions[n
+00006aa0: 203a 206e 202b 2032 5d0a 2020 2020 2020   : n + 2].      
+00006ab0: 2020 2020 2020 6c61 7965 7220 3d20 7b28        layer = {(
+00006ac0: 6e61 6d65 2c20 3029 3a20 2873 656c 662e  name, 0): (self.
+00006ad0: 5f6e 616d 652c 206e 297d 0a20 2020 2020  _name, n)}.     
+00006ae0: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
+00006af0: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
+00006b00: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
+00006b10: 616d 652c 206c 6179 6572 2c20 6465 7065  ame, layer, depe
+00006b20: 6e64 656e 6369 6573 3d5b 7365 6c66 5d29  ndencies=[self])
+00006b30: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00006b40: 7572 6e20 6e65 775f 6464 5f6f 626a 6563  urn new_dd_objec
+00006b50: 7428 6772 6170 682c 206e 616d 652c 2073  t(graph, name, s
+00006b60: 656c 662e 5f6d 6574 612c 2064 6976 6973  elf._meta, divis
+00006b70: 696f 6e73 290a 2020 2020 2020 2020 656c  ions).        el
+00006b80: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00006b90: 6d73 6720 3d20 6622 6e20 6d75 7374 2062  msg = f"n must b
+00006ba0: 6520 3020 3c3d 206e 203c 207b 7365 6c66  e 0 <= n < {self
+00006bb0: 2e6e 7061 7274 6974 696f 6e73 7d22 0a20  .npartitions}". 
+00006bc0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00006bd0: 2056 616c 7565 4572 726f 7228 6d73 6729   ValueError(msg)
+00006be0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00006bf0: 726f 6d28 0a20 2020 2020 2020 2070 642e  rom(.        pd.
+00006c00: 4461 7461 4672 616d 652c 0a20 2020 2020  DataFrame,.     
+00006c10: 2020 2069 6e63 6f6e 7369 7374 656e 6369     inconsistenci
+00006c20: 6573 3d22 6b65 6570 3d46 616c 7365 2077  es="keep=False w
+00006c30: 696c 6c20 7261 6973 6520 6120 6060 4e6f  ill raise a ``No
+00006c40: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
+00006c50: 7260 6022 2c0a 2020 2020 290a 2020 2020  r``",.    ).    
+00006c60: 6465 6620 6472 6f70 5f64 7570 6c69 6361  def drop_duplica
+00006c70: 7465 7328 0a20 2020 2020 2020 2073 656c  tes(.        sel
+00006c80: 662c 2073 7562 7365 743d 4e6f 6e65 2c20  f, subset=None, 
+00006c90: 7370 6c69 745f 6576 6572 793d 4e6f 6e65  split_every=None
+00006ca0: 2c20 7370 6c69 745f 6f75 743d 312c 2069  , split_out=1, i
+00006cb0: 676e 6f72 655f 696e 6465 783d 4661 6c73  gnore_index=Fals
+00006cc0: 652c 202a 2a6b 7761 7267 730a 2020 2020  e, **kwargs.    
+00006cd0: 293a 0a20 2020 2020 2020 2069 6620 7375  ):.        if su
+00006ce0: 6273 6574 2069 7320 6e6f 7420 4e6f 6e65  bset is not None
+00006cf0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00006d00: 4c65 7420 7061 6e64 6173 2065 7272 6f72  Let pandas error
+00006d10: 206f 6e20 6261 6420 696e 7075 7473 0a20   on bad inputs. 
+00006d20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00006d30: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e64  _meta_nonempty.d
+00006d40: 726f 705f 6475 706c 6963 6174 6573 2873  rop_duplicates(s
+00006d50: 7562 7365 743d 7375 6273 6574 2c20 2a2a  ubset=subset, **
+00006d60: 6b77 6172 6773 290a 2020 2020 2020 2020  kwargs).        
+00006d70: 2020 2020 6b77 6172 6773 5b22 7375 6273      kwargs["subs
+00006d80: 6574 225d 203d 2073 7562 7365 740a 2020  et"] = subset.  
+00006d90: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
+00006da0: 6f75 745f 7365 7475 7020 3d20 7370 6c69  out_setup = spli
+00006db0: 745f 6f75 745f 6f6e 5f63 6f6c 730a 2020  t_out_on_cols.  
+00006dc0: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
+00006dd0: 6f75 745f 7365 7475 705f 6b77 6172 6773  out_setup_kwargs
+00006de0: 203d 207b 2263 6f6c 7322 3a20 7375 6273   = {"cols": subs
+00006df0: 6574 7d0a 2020 2020 2020 2020 656c 7365  et}.        else
+00006e00: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00006e10: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
+00006e20: 792e 6472 6f70 5f64 7570 6c69 6361 7465  y.drop_duplicate
+00006e30: 7328 2a2a 6b77 6172 6773 290a 2020 2020  s(**kwargs).    
+00006e40: 2020 2020 2020 2020 7370 6c69 745f 6f75          split_ou
+00006e50: 745f 7365 7475 7020 3d20 7370 6c69 745f  t_setup = split_
+00006e60: 6f75 745f 7365 7475 705f 6b77 6172 6773  out_setup_kwargs
+00006e70: 203d 204e 6f6e 650a 0a20 2020 2020 2020   = None..       
+00006e80: 2069 6620 6b77 6172 6773 2e67 6574 2822   if kwargs.get("
+00006e90: 6b65 6570 222c 2054 7275 6529 2069 7320  keep", True) is 
+00006ea0: 4661 6c73 653a 0a20 2020 2020 2020 2020  False:.         
+00006eb0: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+00006ec0: 656d 656e 7465 6445 7272 6f72 2822 6472  ementedError("dr
+00006ed0: 6f70 5f64 7570 6c69 6361 7465 7320 7769  op_duplicates wi
+00006ee0: 7468 206b 6565 703d 4661 6c73 6522 290a  th keep=False").
+00006ef0: 0a20 2020 2020 2020 2063 6875 6e6b 203d  .        chunk =
+00006f00: 204d 2e64 726f 705f 6475 706c 6963 6174   M.drop_duplicat
+00006f10: 6573 0a20 2020 2020 2020 2072 6574 7572  es.        retur
+00006f20: 6e20 6163 6128 0a20 2020 2020 2020 2020  n aca(.         
+00006f30: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00006f40: 2020 2020 2063 6875 6e6b 3d63 6875 6e6b       chunk=chunk
+00006f50: 2c0a 2020 2020 2020 2020 2020 2020 6167  ,.            ag
+00006f60: 6772 6567 6174 653d 6368 756e 6b2c 0a20  gregate=chunk,. 
+00006f70: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
+00006f80: 7365 6c66 2e5f 6d65 7461 2c0a 2020 2020  self._meta,.    
+00006f90: 2020 2020 2020 2020 746f 6b65 6e3d 2264          token="d
+00006fa0: 726f 702d 6475 706c 6963 6174 6573 222c  rop-duplicates",
+00006fb0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+00006fc0: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+00006fd0: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
+00006fe0: 2020 7370 6c69 745f 6f75 743d 7370 6c69    split_out=spli
+00006ff0: 745f 6f75 742c 0a20 2020 2020 2020 2020  t_out,.         
+00007000: 2020 2073 706c 6974 5f6f 7574 5f73 6574     split_out_set
+00007010: 7570 3d73 706c 6974 5f6f 7574 5f73 6574  up=split_out_set
+00007020: 7570 2c0a 2020 2020 2020 2020 2020 2020  up,.            
+00007030: 7370 6c69 745f 6f75 745f 7365 7475 705f  split_out_setup_
+00007040: 6b77 6172 6773 3d73 706c 6974 5f6f 7574  kwargs=split_out
+00007050: 5f73 6574 7570 5f6b 7761 7267 732c 0a20  _setup_kwargs,. 
+00007060: 2020 2020 2020 2020 2020 2069 676e 6f72             ignor
+00007070: 655f 696e 6465 783d 6967 6e6f 7265 5f69  e_index=ignore_i
+00007080: 6e64 6578 2c0a 2020 2020 2020 2020 2020  ndex,.          
+00007090: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
+000070a0: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
+000070b0: 5f6c 656e 5f5f 2873 656c 6629 3a0a 2020  _len__(self):.  
+000070c0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000070d0: 662e 7265 6475 6374 696f 6e28 0a20 2020  f.reduction(.   
+000070e0: 2020 2020 2020 2020 206c 656e 2c20 6e70           len, np
+000070f0: 2e73 756d 2c20 746f 6b65 6e3d 226c 656e  .sum, token="len
+00007100: 222c 206d 6574 613d 696e 742c 2073 706c  ", meta=int, spl
+00007110: 6974 5f65 7665 7279 3d46 616c 7365 0a20  it_every=False. 
+00007120: 2020 2020 2020 2029 2e63 6f6d 7075 7465         ).compute
+00007130: 2829 0a0a 2020 2020 6465 6620 5f5f 626f  ()..    def __bo
+00007140: 6f6c 5f5f 2873 656c 6629 3a0a 2020 2020  ol__(self):.    
+00007150: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00007160: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00007170: 2020 6622 5468 6520 7472 7574 6820 7661    f"The truth va
+00007180: 6c75 6520 6f66 2061 207b 7365 6c66 2e5f  lue of a {self._
+00007190: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
+000071a0: 5f7d 2069 7320 616d 6269 6775 6f75 732e  _} is ambiguous.
+000071b0: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
+000071c0: 5573 6520 612e 616e 7928 2920 6f72 2061  Use a.any() or a
+000071d0: 2e61 6c6c 2829 2e22 0a20 2020 2020 2020  .all().".       
+000071e0: 2029 0a0a 2020 2020 5f5f 6e6f 6e7a 6572   )..    __nonzer
+000071f0: 6f5f 5f20 3d20 5f5f 626f 6f6c 5f5f 2020  o__ = __bool__  
+00007200: 2320 7079 7468 6f6e 2032 0a0a 2020 2020  # python 2..    
+00007210: 6465 6620 5f73 6361 6c61 7266 756e 6328  def _scalarfunc(
+00007220: 7365 6c66 2c20 6361 7374 5f74 7970 6529  self, cast_type)
+00007230: 3a0a 2020 2020 2020 2020 6465 6620 7772  :.        def wr
+00007240: 6170 7065 7228 293a 0a20 2020 2020 2020  apper():.       
+00007250: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00007260: 7272 6f72 2866 2263 616e 6e6f 7420 636f  rror(f"cannot co
+00007270: 6e76 6572 7420 7468 6520 7365 7269 6573  nvert the series
+00007280: 2074 6f20 7b63 6173 745f 7479 7065 7d22   to {cast_type}"
+00007290: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+000072a0: 6e20 7772 6170 7065 720a 0a20 2020 2064  n wrapper..    d
+000072b0: 6566 205f 5f66 6c6f 6174 5f5f 2873 656c  ef __float__(sel
+000072c0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+000072d0: 726e 2073 656c 662e 5f73 6361 6c61 7266  rn self._scalarf
+000072e0: 756e 6328 666c 6f61 7429 0a0a 2020 2020  unc(float)..    
+000072f0: 6465 6620 5f5f 696e 745f 5f28 7365 6c66  def __int__(self
+00007300: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00007310: 6e20 7365 6c66 2e5f 7363 616c 6172 6675  n self._scalarfu
+00007320: 6e63 2869 6e74 290a 0a20 2020 205f 5f6c  nc(int)..    __l
+00007330: 6f6e 675f 5f20 3d20 5f5f 696e 745f 5f20  ong__ = __int__ 
+00007340: 2023 2070 7974 686f 6e20 320a 0a20 2020   # python 2..   
+00007350: 2064 6566 205f 5f63 6f6d 706c 6578 5f5f   def __complex__
+00007360: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00007370: 7265 7475 726e 2073 656c 662e 5f73 6361  return self._sca
+00007380: 6c61 7266 756e 6328 636f 6d70 6c65 7829  larfunc(complex)
+00007390: 0a0a 2020 2020 4069 6e73 6572 745f 6d65  ..    @insert_me
+000073a0: 7461 5f70 6172 616d 5f64 6573 6372 6970  ta_param_descrip
+000073b0: 7469 6f6e 2870 6164 3d31 3229 0a20 2020  tion(pad=12).   
+000073c0: 2064 6566 206d 6170 5f70 6172 7469 7469   def map_partiti
+000073d0: 6f6e 7328 7365 6c66 2c20 6675 6e63 2c20  ons(self, func, 
+000073e0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+000073f0: 3a0a 2020 2020 2020 2020 2222 2241 7070  :.        """App
+00007400: 6c79 2050 7974 686f 6e20 6675 6e63 7469  ly Python functi
+00007410: 6f6e 206f 6e20 6561 6368 2044 6174 6146  on on each DataF
+00007420: 7261 6d65 2070 6172 7469 7469 6f6e 2e0a  rame partition..
+00007430: 0a20 2020 2020 2020 204e 6f74 6520 7468  .        Note th
+00007440: 6174 2074 6865 2069 6e64 6578 2061 6e64  at the index and
+00007450: 2064 6976 6973 696f 6e73 2061 7265 2061   divisions are a
+00007460: 7373 756d 6564 2074 6f20 7265 6d61 696e  ssumed to remain
+00007470: 2075 6e63 6861 6e67 6564 2e0a 0a20 2020   unchanged...   
+00007480: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+00007490: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000074a0: 2d2d 0a20 2020 2020 2020 2066 756e 6320  --.        func 
+000074b0: 3a20 6675 6e63 7469 6f6e 0a20 2020 2020  : function.     
+000074c0: 2020 2020 2020 2054 6865 2066 756e 6374         The funct
+000074d0: 696f 6e20 6170 706c 6965 6420 746f 2065  ion applied to e
+000074e0: 6163 6820 7061 7274 6974 696f 6e2e 2049  ach partition. I
+000074f0: 6620 7468 6973 2066 756e 6374 696f 6e20  f this function 
+00007500: 6163 6365 7074 730a 2020 2020 2020 2020  accepts.        
+00007510: 2020 2020 7468 6520 7370 6563 6961 6c20      the special 
+00007520: 6060 7061 7274 6974 696f 6e5f 696e 666f  ``partition_info
+00007530: 6060 206b 6579 776f 7264 2061 7267 756d  `` keyword argum
+00007540: 656e 742c 2069 7420 7769 6c6c 2072 6563  ent, it will rec
+00007550: 6569 7665 0a20 2020 2020 2020 2020 2020  eive.           
+00007560: 2069 6e66 6f72 6d61 7469 6f6e 206f 6e20   information on 
+00007570: 7468 6520 7061 7274 6974 696f 6e27 7320  the partition's 
+00007580: 7265 6c61 7469 7665 206c 6f63 6174 696f  relative locatio
+00007590: 6e20 7769 7468 696e 2074 6865 0a20 2020  n within the.   
+000075a0: 2020 2020 2020 2020 2064 6174 6166 7261           datafra
+000075b0: 6d65 2e0a 2020 2020 2020 2020 6172 6773  me..        args
+000075c0: 2c20 6b77 6172 6773 203a 0a20 2020 2020  , kwargs :.     
+000075d0: 2020 2020 2020 2050 6f73 6974 696f 6e61         Positiona
+000075e0: 6c20 616e 6420 6b65 7977 6f72 6420 6172  l and keyword ar
+000075f0: 6775 6d65 6e74 7320 746f 2070 6173 7320  guments to pass 
+00007600: 746f 2074 6865 2066 756e 6374 696f 6e2e  to the function.
+00007610: 0a20 2020 2020 2020 2020 2020 2050 6f73  .            Pos
+00007620: 6974 696f 6e61 6c20 6172 6775 6d65 6e74  itional argument
+00007630: 7320 6172 6520 636f 6d70 7574 6564 206f  s are computed o
+00007640: 6e20 6120 7065 722d 7061 7274 6974 696f  n a per-partitio
+00007650: 6e20 6261 7369 732c 2077 6869 6c65 0a20  n basis, while. 
+00007660: 2020 2020 2020 2020 2020 206b 6579 776f             keywo
+00007670: 7264 2061 7267 756d 656e 7473 2061 7265  rd arguments are
+00007680: 2073 6861 7265 6420 6163 726f 7373 2061   shared across a
+00007690: 6c6c 2070 6172 7469 7469 6f6e 732e 2054  ll partitions. T
+000076a0: 6865 2070 6172 7469 7469 6f6e 0a20 2020  he partition.   
+000076b0: 2020 2020 2020 2020 2069 7473 656c 6620           itself 
+000076c0: 7769 6c6c 2062 6520 7468 6520 6669 7273  will be the firs
+000076d0: 7420 706f 7369 7469 6f6e 616c 2061 7267  t positional arg
+000076e0: 756d 656e 742c 2077 6974 6820 616c 6c20  ument, with all 
+000076f0: 6f74 6865 720a 2020 2020 2020 2020 2020  other.          
+00007700: 2020 6172 6775 6d65 6e74 7320 7061 7373    arguments pass
+00007710: 6564 202a 6166 7465 722a 2e20 4172 6775  ed *after*. Argu
+00007720: 6d65 6e74 7320 6361 6e20 6265 2060 6053  ments can be ``S
+00007730: 6361 6c61 7260 602c 2060 6044 656c 6179  calar``, ``Delay
+00007740: 6564 6060 2c0a 2020 2020 2020 2020 2020  ed``,.          
+00007750: 2020 6f72 2072 6567 756c 6172 2050 7974    or regular Pyt
+00007760: 686f 6e20 6f62 6a65 6374 732e 2044 6174  hon objects. Dat
+00007770: 6146 7261 6d65 2d6c 696b 6520 6172 6773  aFrame-like args
+00007780: 2028 626f 7468 2064 6173 6b20 616e 640a   (both dask and.
+00007790: 2020 2020 2020 2020 2020 2020 7061 6e64              pand
+000077a0: 6173 2920 7769 6c6c 2062 6520 7265 7061  as) will be repa
+000077b0: 7274 6974 696f 6e65 6420 746f 2061 6c69  rtitioned to ali
+000077c0: 676e 2028 6966 206e 6563 6573 7361 7279  gn (if necessary
+000077d0: 2920 6265 666f 7265 0a20 2020 2020 2020  ) before.       
+000077e0: 2020 2020 2061 7070 6c79 696e 6720 7468       applying th
+000077f0: 6520 6675 6e63 7469 6f6e 3b20 7365 6520  e function; see 
+00007800: 6060 616c 6967 6e5f 6461 7461 6672 616d  ``align_datafram
+00007810: 6573 6060 2074 6f20 636f 6e74 726f 6c20  es`` to control 
+00007820: 7468 6973 0a20 2020 2020 2020 2020 2020  this.           
+00007830: 2062 6568 6176 696f 722e 0a20 2020 2020   behavior..     
+00007840: 2020 2065 6e66 6f72 6365 5f6d 6574 6164     enforce_metad
+00007850: 6174 6120 3a20 626f 6f6c 2c20 6465 6661  ata : bool, defa
+00007860: 756c 7420 5472 7565 0a20 2020 2020 2020  ult True.       
+00007870: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
+00007880: 656e 666f 7263 6520 6174 2072 756e 7469  enforce at runti
+00007890: 6d65 2074 6861 7420 7468 6520 7374 7275  me that the stru
+000078a0: 6374 7572 6520 6f66 2074 6865 2044 6174  cture of the Dat
+000078b0: 6146 7261 6d65 0a20 2020 2020 2020 2020  aFrame.         
+000078c0: 2020 2070 726f 6475 6365 6420 6279 2060     produced by `
+000078d0: 6066 756e 6360 6020 6163 7475 616c 6c79  `func`` actually
+000078e0: 206d 6174 6368 6573 2074 6865 2073 7472   matches the str
+000078f0: 7563 7475 7265 206f 6620 6060 6d65 7461  ucture of ``meta
+00007900: 6060 2e0a 2020 2020 2020 2020 2020 2020  ``..            
+00007910: 5468 6973 2077 696c 6c20 7265 6e61 6d65  This will rename
+00007920: 2061 6e64 2072 656f 7264 6572 2063 6f6c   and reorder col
+00007930: 756d 6e73 2066 6f72 2065 6163 6820 7061  umns for each pa
+00007940: 7274 6974 696f 6e2c 0a20 2020 2020 2020  rtition,.       
+00007950: 2020 2020 2061 6e64 2077 696c 6c20 7261       and will ra
+00007960: 6973 6520 616e 2065 7272 6f72 2069 6620  ise an error if 
+00007970: 7468 6973 2064 6f65 736e 2774 2077 6f72  this doesn't wor
+00007980: 6b2c 0a20 2020 2020 2020 2020 2020 2062  k,.            b
+00007990: 7574 2069 7420 776f 6e27 7420 7261 6973  ut it won't rais
+000079a0: 6520 6966 2064 7479 7065 7320 646f 6e27  e if dtypes don'
+000079b0: 7420 6d61 7463 682e 0a20 2020 2020 2020  t match..       
+000079c0: 2074 7261 6e73 666f 726d 5f64 6976 6973   transform_divis
+000079d0: 696f 6e73 203a 2062 6f6f 6c2c 2064 6566  ions : bool, def
 000079e0: 6175 6c74 2054 7275 650a 2020 2020 2020  ault True.      
 000079f0: 2020 2020 2020 5768 6574 6865 7220 746f        Whether to
-00007a00: 2072 6570 6172 7469 7469 6f6e 2044 6174   repartition Dat
-00007a10: 6146 7261 6d65 2d20 6f72 2053 6572 6965  aFrame- or Serie
-00007a20: 732d 6c69 6b65 2061 7267 730a 2020 2020  s-like args.    
-00007a30: 2020 2020 2020 2020 2862 6f74 6820 6461          (both da
-00007a40: 736b 2061 6e64 2070 616e 6461 7329 2073  sk and pandas) s
-00007a50: 6f20 7468 6569 7220 6469 7669 7369 6f6e  o their division
-00007a60: 7320 616c 6967 6e20 6265 666f 7265 2061  s align before a
-00007a70: 7070 6c79 696e 670a 2020 2020 2020 2020  pplying.        
-00007a80: 2020 2020 7468 6520 6675 6e63 7469 6f6e      the function
-00007a90: 2e20 5468 6973 2072 6571 7569 7265 7320  . This requires 
-00007aa0: 616c 6c20 696e 7075 7473 2074 6f20 6861  all inputs to ha
-00007ab0: 7665 206b 6e6f 776e 2064 6976 6973 696f  ve known divisio
-00007ac0: 6e73 2e0a 2020 2020 2020 2020 2020 2020  ns..            
-00007ad0: 5369 6e67 6c65 2d70 6172 7469 7469 6f6e  Single-partition
-00007ae0: 2069 6e70 7574 7320 7769 6c6c 2062 6520   inputs will be 
-00007af0: 7370 6c69 7420 696e 746f 206d 756c 7469  split into multi
-00007b00: 706c 6520 7061 7274 6974 696f 6e73 2e0a  ple partitions..
-00007b10: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00007b20: 4661 6c73 652c 2061 6c6c 2069 6e70 7574  False, all input
-00007b30: 7320 6d75 7374 2068 6176 6520 6569 7468  s must have eith
-00007b40: 6572 2074 6865 2073 616d 6520 6e75 6d62  er the same numb
-00007b50: 6572 206f 6620 7061 7274 6974 696f 6e73  er of partitions
-00007b60: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
-00007b70: 6120 7369 6e67 6c65 2070 6172 7469 7469  a single partiti
-00007b80: 6f6e 2e20 5369 6e67 6c65 2d70 6172 7469  on. Single-parti
-00007b90: 7469 6f6e 2069 6e70 7574 7320 7769 6c6c  tion inputs will
-00007ba0: 2062 6520 6272 6f61 6463 6173 7420 746f   be broadcast to
-00007bb0: 0a20 2020 2020 2020 2020 2020 2065 7665  .            eve
-00007bc0: 7279 2070 6172 7469 7469 6f6e 206f 6620  ry partition of 
-00007bd0: 6d75 6c74 692d 7061 7274 6974 696f 6e20  multi-partition 
-00007be0: 696e 7075 7473 2e0a 2020 2020 2020 2020  inputs..        
-00007bf0: 244d 4554 410a 0a20 2020 2020 2020 2045  $META..        E
-00007c00: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
-00007c10: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00007c20: 2047 6976 656e 2061 2044 6174 6146 7261   Given a DataFra
-00007c30: 6d65 2c20 5365 7269 6573 2c20 6f72 2049  me, Series, or I
-00007c40: 6e64 6578 2c20 7375 6368 2061 733a 0a0a  ndex, such as:..
-00007c50: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
-00007c60: 7274 2070 616e 6461 7320 6173 2070 640a  rt pandas as pd.
-00007c70: 2020 2020 2020 2020 3e3e 3e20 696d 706f          >>> impo
-00007c80: 7274 2064 6173 6b2e 6461 7461 6672 616d  rt dask.datafram
-00007c90: 6520 6173 2064 640a 2020 2020 2020 2020  e as dd.        
-00007ca0: 3e3e 3e20 6466 203d 2070 642e 4461 7461  >>> df = pd.Data
-00007cb0: 4672 616d 6528 7b27 7827 3a20 5b31 2c20  Frame({'x': [1, 
-00007cc0: 322c 2033 2c20 342c 2035 5d2c 0a20 2020  2, 3, 4, 5],.   
-00007cd0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-00007ce0: 2020 2020 2020 2020 2020 2020 2779 273a              'y':
-00007cf0: 205b 312e 2c20 322e 2c20 332e 2c20 342e   [1., 2., 3., 4.
-00007d00: 2c20 352e 5d7d 290a 2020 2020 2020 2020  , 5.]}).        
-00007d10: 3e3e 3e20 6464 6620 3d20 6464 2e66 726f  >>> ddf = dd.fro
-00007d20: 6d5f 7061 6e64 6173 2864 662c 206e 7061  m_pandas(df, npa
-00007d30: 7274 6974 696f 6e73 3d32 290a 0a20 2020  rtitions=2)..   
-00007d40: 2020 2020 204f 6e65 2063 616e 2075 7365       One can use
-00007d50: 2060 606d 6170 5f70 6172 7469 7469 6f6e   ``map_partition
-00007d60: 7360 6020 746f 2061 7070 6c79 2061 2066  s`` to apply a f
-00007d70: 756e 6374 696f 6e20 6f6e 2065 6163 6820  unction on each 
-00007d80: 7061 7274 6974 696f 6e2e 0a20 2020 2020  partition..     
-00007d90: 2020 2045 7874 7261 2061 7267 756d 656e     Extra argumen
-00007da0: 7473 2061 6e64 206b 6579 776f 7264 7320  ts and keywords 
-00007db0: 6361 6e20 6f70 7469 6f6e 616c 6c79 2062  can optionally b
-00007dc0: 6520 7072 6f76 6964 6564 2c20 616e 6420  e provided, and 
-00007dd0: 7769 6c6c 2062 650a 2020 2020 2020 2020  will be.        
-00007de0: 7061 7373 6564 2074 6f20 7468 6520 6675  passed to the fu
-00007df0: 6e63 7469 6f6e 2061 6674 6572 2074 6865  nction after the
-00007e00: 2070 6172 7469 7469 6f6e 2e0a 0a20 2020   partition...   
-00007e10: 2020 2020 2048 6572 6520 7765 2061 7070       Here we app
-00007e20: 6c79 2061 2066 756e 6374 696f 6e20 7769  ly a function wi
-00007e30: 7468 2061 7267 756d 656e 7473 2061 6e64  th arguments and
-00007e40: 206b 6579 776f 7264 7320 746f 2061 2044   keywords to a D
-00007e50: 6174 6146 7261 6d65 2c0a 2020 2020 2020  ataFrame,.      
-00007e60: 2020 7265 7375 6c74 696e 6720 696e 2061    resulting in a
-00007e70: 2053 6572 6965 733a 0a0a 2020 2020 2020   Series:..      
-00007e80: 2020 3e3e 3e20 6465 6620 6d79 6164 6428    >>> def myadd(
-00007e90: 6466 2c20 612c 2062 3d31 293a 0a20 2020  df, a, b=1):.   
-00007ea0: 2020 2020 202e 2e2e 2020 2020 2072 6574       ...     ret
-00007eb0: 7572 6e20 6466 2e78 202b 2064 662e 7920  urn df.x + df.y 
-00007ec0: 2b20 6120 2b20 620a 2020 2020 2020 2020  + a + b.        
-00007ed0: 3e3e 3e20 7265 7320 3d20 6464 662e 6d61  >>> res = ddf.ma
-00007ee0: 705f 7061 7274 6974 696f 6e73 286d 7961  p_partitions(mya
-00007ef0: 6464 2c20 312c 2062 3d32 290a 2020 2020  dd, 1, b=2).    
-00007f00: 2020 2020 3e3e 3e20 7265 732e 6474 7970      >>> res.dtyp
-00007f10: 650a 2020 2020 2020 2020 6474 7970 6528  e.        dtype(
-00007f20: 2766 6c6f 6174 3634 2729 0a0a 2020 2020  'float64')..    
-00007f30: 2020 2020 4865 7265 2077 6520 6170 706c      Here we appl
-00007f40: 7920 6120 6675 6e63 7469 6f6e 2074 6f20  y a function to 
-00007f50: 6120 5365 7269 6573 2072 6573 756c 7469  a Series resulti
-00007f60: 6e67 2069 6e20 6120 5365 7269 6573 3a0a  ng in a Series:.
-00007f70: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
-00007f80: 203d 2064 6466 2e78 2e6d 6170 5f70 6172   = ddf.x.map_par
-00007f90: 7469 7469 6f6e 7328 6c61 6d62 6461 2078  titions(lambda x
-00007fa0: 3a20 6c65 6e28 7829 2920 2320 6464 662e  : len(x)) # ddf.
-00007fb0: 7820 6973 2061 2044 6173 6b20 5365 7269  x is a Dask Seri
-00007fc0: 6573 2053 7472 7563 7475 7265 0a20 2020  es Structure.   
-00007fd0: 2020 2020 203e 3e3e 2072 6573 2e64 7479       >>> res.dty
-00007fe0: 7065 0a20 2020 2020 2020 2064 7479 7065  pe.        dtype
-00007ff0: 2827 696e 7436 3427 290a 0a20 2020 2020  ('int64')..     
-00008000: 2020 2042 7920 6465 6661 756c 742c 2064     By default, d
-00008010: 6173 6b20 7472 6965 7320 746f 2069 6e66  ask tries to inf
-00008020: 6572 2074 6865 206f 7574 7075 7420 6d65  er the output me
-00008030: 7461 6461 7461 2062 7920 7275 6e6e 696e  tadata by runnin
-00008040: 6720 796f 7572 0a20 2020 2020 2020 2070  g your.        p
-00008050: 726f 7669 6465 6420 6675 6e63 7469 6f6e  rovided function
-00008060: 206f 6e20 736f 6d65 2066 616b 6520 6461   on some fake da
-00008070: 7461 2e20 5468 6973 2077 6f72 6b73 2077  ta. This works w
-00008080: 656c 6c20 696e 206d 616e 7920 6361 7365  ell in many case
-00008090: 732c 2062 7574 0a20 2020 2020 2020 2063  s, but.        c
-000080a0: 616e 2073 6f6d 6574 696d 6573 2062 6520  an sometimes be 
-000080b0: 6578 7065 6e73 6976 652c 206f 7220 6576  expensive, or ev
-000080c0: 656e 2066 6169 6c2e 2054 6f20 6176 6f69  en fail. To avoi
-000080d0: 6420 7468 6973 2c20 796f 7520 6361 6e0a  d this, you can.
-000080e0: 2020 2020 2020 2020 6d61 6e75 616c 6c79          manually
-000080f0: 2073 7065 6369 6679 2074 6865 206f 7574   specify the out
-00008100: 7075 7420 6d65 7461 6461 7461 2077 6974  put metadata wit
-00008110: 6820 7468 6520 6060 6d65 7461 6060 206b  h the ``meta`` k
-00008120: 6579 776f 7264 2e20 5468 6973 0a20 2020  eyword. This.   
-00008130: 2020 2020 2063 616e 2062 6520 7370 6563       can be spec
-00008140: 6966 6965 6420 696e 206d 616e 7920 666f  ified in many fo
-00008150: 726d 732c 2066 6f72 206d 6f72 6520 696e  rms, for more in
-00008160: 666f 726d 6174 696f 6e20 7365 650a 2020  formation see.  
-00008170: 2020 2020 2020 6060 6461 736b 2e64 6174        ``dask.dat
-00008180: 6166 7261 6d65 2e75 7469 6c73 2e6d 616b  aframe.utils.mak
-00008190: 655f 6d65 7461 6060 2e0a 0a20 2020 2020  e_meta``...     
-000081a0: 2020 2048 6572 6520 7765 2073 7065 6369     Here we speci
-000081b0: 6679 2074 6865 206f 7574 7075 7420 6973  fy the output is
-000081c0: 2061 2053 6572 6965 7320 7769 7468 206e   a Series with n
-000081d0: 6f20 6e61 6d65 2c20 616e 6420 6474 7970  o name, and dtyp
-000081e0: 650a 2020 2020 2020 2020 6060 666c 6f61  e.        ``floa
-000081f0: 7436 3460 603a 0a0a 2020 2020 2020 2020  t64``:..        
-00008200: 3e3e 3e20 7265 7320 3d20 6464 662e 6d61  >>> res = ddf.ma
-00008210: 705f 7061 7274 6974 696f 6e73 286d 7961  p_partitions(mya
-00008220: 6464 2c20 312c 2062 3d32 2c20 6d65 7461  dd, 1, b=2, meta
-00008230: 3d28 4e6f 6e65 2c20 2766 3827 2929 0a0a  =(None, 'f8'))..
-00008240: 2020 2020 2020 2020 4865 7265 2077 6520          Here we 
-00008250: 6d61 7020 6120 6675 6e63 7469 6f6e 2074  map a function t
-00008260: 6861 7420 7461 6b65 7320 696e 2061 2044  hat takes in a D
-00008270: 6174 6146 7261 6d65 2c20 616e 6420 7265  ataFrame, and re
-00008280: 7475 726e 7320 610a 2020 2020 2020 2020  turns a.        
-00008290: 4461 7461 4672 616d 6520 7769 7468 2061  DataFrame with a
-000082a0: 206e 6577 2063 6f6c 756d 6e3a 0a0a 2020   new column:..  
-000082b0: 2020 2020 2020 3e3e 3e20 7265 7320 3d20        >>> res = 
-000082c0: 6464 662e 6d61 705f 7061 7274 6974 696f  ddf.map_partitio
-000082d0: 6e73 286c 616d 6264 6120 6466 3a20 6466  ns(lambda df: df
-000082e0: 2e61 7373 6967 6e28 7a3d 6466 2e78 202a  .assign(z=df.x *
-000082f0: 2064 662e 7929 290a 2020 2020 2020 2020   df.y)).        
-00008300: 3e3e 3e20 7265 732e 6474 7970 6573 0a20  >>> res.dtypes. 
-00008310: 2020 2020 2020 2078 2020 2020 2020 696e         x      in
-00008320: 7436 340a 2020 2020 2020 2020 7920 2020  t64.        y   
-00008330: 2066 6c6f 6174 3634 0a20 2020 2020 2020   float64.       
-00008340: 207a 2020 2020 666c 6f61 7436 340a 2020   z    float64.  
-00008350: 2020 2020 2020 6474 7970 653a 206f 626a        dtype: obj
-00008360: 6563 740a 0a20 2020 2020 2020 2041 7320  ect..        As 
-00008370: 6265 666f 7265 2c20 7468 6520 6f75 7470  before, the outp
-00008380: 7574 206d 6574 6164 6174 6120 6361 6e20  ut metadata can 
-00008390: 616c 736f 2062 6520 7370 6563 6966 6965  also be specifie
-000083a0: 6420 6d61 6e75 616c 6c79 2e20 5468 6973  d manually. This
-000083b0: 0a20 2020 2020 2020 2074 696d 6520 7765  .        time we
-000083c0: 2070 6173 7320 696e 2061 2060 6064 6963   pass in a ``dic
-000083d0: 7460 602c 2061 7320 7468 6520 6f75 7470  t``, as the outp
-000083e0: 7574 2069 7320 6120 4461 7461 4672 616d  ut is a DataFram
-000083f0: 653a 0a0a 2020 2020 2020 2020 3e3e 3e20  e:..        >>> 
-00008400: 7265 7320 3d20 6464 662e 6d61 705f 7061  res = ddf.map_pa
-00008410: 7274 6974 696f 6e73 286c 616d 6264 6120  rtitions(lambda 
-00008420: 6466 3a20 6466 2e61 7373 6967 6e28 7a3d  df: df.assign(z=
-00008430: 6466 2e78 202a 2064 662e 7929 2c0a 2020  df.x * df.y),.  
-00008440: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-00008450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008460: 2020 206d 6574 613d 7b27 7827 3a20 2769     meta={'x': 'i
-00008470: 3827 2c20 2779 273a 2027 6638 272c 2027  8', 'y': 'f8', '
-00008480: 7a27 3a20 2766 3827 7d29 0a0a 2020 2020  z': 'f8'})..    
-00008490: 2020 2020 496e 2074 6865 2063 6173 6520      In the case 
-000084a0: 7768 6572 6520 7468 6520 6d65 7461 6461  where the metada
-000084b0: 7461 2064 6f65 736e 2774 2063 6861 6e67  ta doesn't chang
-000084c0: 652c 2079 6f75 2063 616e 2061 6c73 6f20  e, you can also 
-000084d0: 7061 7373 2069 6e0a 2020 2020 2020 2020  pass in.        
-000084e0: 7468 6520 6f62 6a65 6374 2069 7473 656c  the object itsel
-000084f0: 6620 6469 7265 6374 6c79 3a0a 0a20 2020  f directly:..   
-00008500: 2020 2020 203e 3e3e 2072 6573 203d 2064       >>> res = d
-00008510: 6466 2e6d 6170 5f70 6172 7469 7469 6f6e  df.map_partition
-00008520: 7328 6c61 6d62 6461 2064 663a 2064 662e  s(lambda df: df.
-00008530: 6865 6164 2829 2c20 6d65 7461 3d64 6466  head(), meta=ddf
-00008540: 290a 0a20 2020 2020 2020 2041 6c73 6f20  )..        Also 
-00008550: 6e6f 7465 2074 6861 7420 7468 6520 696e  note that the in
-00008560: 6465 7820 616e 6420 6469 7669 7369 6f6e  dex and division
-00008570: 7320 6172 6520 6173 7375 6d65 6420 746f  s are assumed to
-00008580: 2072 656d 6169 6e20 756e 6368 616e 6765   remain unchange
-00008590: 642e 0a20 2020 2020 2020 2049 6620 7468  d..        If th
-000085a0: 6520 6675 6e63 7469 6f6e 2079 6f75 2772  e function you'r
-000085b0: 6520 6d61 7070 696e 6720 6368 616e 6765  e mapping change
-000085c0: 7320 7468 6520 696e 6465 782f 6469 7669  s the index/divi
-000085d0: 7369 6f6e 732c 2079 6f75 276c 6c20 6e65  sions, you'll ne
-000085e0: 6564 0a20 2020 2020 2020 2074 6f20 636c  ed.        to cl
-000085f0: 6561 7220 7468 656d 2061 6674 6572 7761  ear them afterwa
-00008600: 7264 733a 0a0a 2020 2020 2020 2020 3e3e  rds:..        >>
-00008610: 3e20 6464 662e 6d61 705f 7061 7274 6974  > ddf.map_partit
-00008620: 696f 6e73 2866 756e 6329 2e63 6c65 6172  ions(func).clear
-00008630: 5f64 6976 6973 696f 6e73 2829 2020 2320  _divisions()  # 
-00008640: 646f 6374 6573 743a 202b 534b 4950 0a0a  doctest: +SKIP..
-00008650: 2020 2020 2020 2020 596f 7572 206d 6170          Your map
-00008660: 2066 756e 6374 696f 6e20 6765 7473 2069   function gets i
-00008670: 6e66 6f72 6d61 7469 6f6e 2061 626f 7574  nformation about
-00008680: 2077 6865 7265 2069 7420 6973 2069 6e20   where it is in 
-00008690: 7468 6520 6461 7461 6672 616d 6520 6279  the dataframe by
-000086a0: 0a20 2020 2020 2020 2061 6363 6570 7469  .        accepti
-000086b0: 6e67 2061 2073 7065 6369 616c 2060 6070  ng a special ``p
-000086c0: 6172 7469 7469 6f6e 5f69 6e66 6f60 6020  artition_info`` 
-000086d0: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
-000086e0: 2e0a 0a20 2020 2020 2020 203e 3e3e 2064  ...        >>> d
-000086f0: 6566 2066 756e 6328 7061 7274 6974 696f  ef func(partitio
-00008700: 6e2c 2070 6172 7469 7469 6f6e 5f69 6e66  n, partition_inf
-00008710: 6f3d 4e6f 6e65 293a 0a20 2020 2020 2020  o=None):.       
-00008720: 202e 2e2e 2020 2020 2070 6173 730a 0a20   ...     pass.. 
-00008730: 2020 2020 2020 2054 6869 7320 7769 6c6c         This will
-00008740: 2072 6563 6569 7665 2074 6865 2066 6f6c   receive the fol
-00008750: 6c6f 7769 6e67 2069 6e66 6f72 6d61 7469  lowing informati
-00008760: 6f6e 3a0a 0a20 2020 2020 2020 203e 3e3e  on:..        >>>
-00008770: 2070 6172 7469 7469 6f6e 5f69 6e66 6f20   partition_info 
-00008780: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
-00008790: 500a 2020 2020 2020 2020 7b27 6e75 6d62  P.        {'numb
-000087a0: 6572 273a 2031 2c20 2764 6976 6973 696f  er': 1, 'divisio
-000087b0: 6e27 3a20 337d 0a0a 2020 2020 2020 2020  n': 3}..        
-000087c0: 466f 7220 6561 6368 2061 7267 756d 656e  For each argumen
-000087d0: 7420 616e 6420 6b65 7977 6f72 6420 6172  t and keyword ar
-000087e0: 6775 6d65 6e74 7320 7468 6174 2061 7265  guments that are
-000087f0: 2064 6173 6b20 6461 7461 6672 616d 6573   dask dataframes
-00008800: 2079 6f75 2077 696c 6c0a 2020 2020 2020   you will.      
-00008810: 2020 7265 6365 6976 6520 7468 6520 6e75    receive the nu
-00008820: 6d62 6572 2028 6e29 2077 6869 6368 2072  mber (n) which r
-00008830: 6570 7265 7365 6e74 7320 7468 6520 6e74  epresents the nt
-00008840: 6820 7061 7274 6974 696f 6e20 6f66 2074  h partition of t
-00008850: 6865 2064 6174 6166 7261 6d65 0a20 2020  he dataframe.   
-00008860: 2020 2020 2061 6e64 2074 6865 2064 6976       and the div
-00008870: 6973 696f 6e20 2874 6865 2066 6972 7374  ision (the first
-00008880: 2069 6e64 6578 2076 616c 7565 2069 6e20   index value in 
-00008890: 7468 6520 7061 7274 6974 696f 6e29 2e20  the partition). 
-000088a0: 4966 2064 6976 6973 696f 6e73 0a20 2020  If divisions.   
-000088b0: 2020 2020 2061 7265 206e 6f74 206b 6e6f       are not kno
-000088c0: 776e 2028 666f 7220 696e 7374 616e 6365  wn (for instance
-000088d0: 2069 6620 7468 6520 696e 6465 7820 6973   if the index is
-000088e0: 206e 6f74 2073 6f72 7465 6429 2074 6865   not sorted) the
-000088f0: 6e20 796f 7520 7769 6c6c 2067 6574 0a20  n you will get. 
-00008900: 2020 2020 2020 204e 6f6e 6520 6173 2074         None as t
-00008910: 6865 2064 6976 6973 696f 6e2e 0a20 2020  he division..   
-00008920: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00008930: 2072 6574 7572 6e20 6d61 705f 7061 7274   return map_part
-00008940: 6974 696f 6e73 2866 756e 632c 2073 656c  itions(func, sel
-00008950: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
-00008960: 6773 290a 0a20 2020 2040 696e 7365 7274  gs)..    @insert
-00008970: 5f6d 6574 615f 7061 7261 6d5f 6465 7363  _meta_param_desc
-00008980: 7269 7074 696f 6e28 7061 643d 3132 290a  ription(pad=12).
-00008990: 2020 2020 6465 6620 6d61 705f 6f76 6572      def map_over
-000089a0: 6c61 7028 7365 6c66 2c20 6675 6e63 2c20  lap(self, func, 
-000089b0: 6265 666f 7265 2c20 6166 7465 722c 202a  before, after, *
-000089c0: 6172 6773 2c20 2a2a 6b77 6172 6773 293a  args, **kwargs):
-000089d0: 0a20 2020 2020 2020 2022 2222 4170 706c  .        """Appl
-000089e0: 7920 6120 6675 6e63 7469 6f6e 2074 6f20  y a function to 
-000089f0: 6561 6368 2070 6172 7469 7469 6f6e 2c20  each partition, 
-00008a00: 7368 6172 696e 6720 726f 7773 2077 6974  sharing rows wit
-00008a10: 6820 6164 6a61 6365 6e74 2070 6172 7469  h adjacent parti
-00008a20: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
-00008a30: 5468 6973 2063 616e 2062 6520 7573 6566  This can be usef
-00008a40: 756c 2066 6f72 2069 6d70 6c65 6d65 6e74  ul for implement
-00008a50: 696e 6720 7769 6e64 6f77 696e 6720 6675  ing windowing fu
-00008a60: 6e63 7469 6f6e 7320 7375 6368 2061 730a  nctions such as.
-00008a70: 2020 2020 2020 2020 6060 6466 2e72 6f6c          ``df.rol
-00008a80: 6c69 6e67 282e 2e2e 292e 6d65 616e 2829  ling(...).mean()
-00008a90: 6060 206f 7220 6060 6466 2e64 6966 6628  `` or ``df.diff(
-00008aa0: 2960 602e 0a0a 2020 2020 2020 2020 5061  )``...        Pa
-00008ab0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-00008ac0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00008ad0: 2020 2020 6675 6e63 203a 2066 756e 6374      func : funct
-00008ae0: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-00008af0: 4675 6e63 7469 6f6e 2061 7070 6c69 6564  Function applied
-00008b00: 2074 6f20 6561 6368 2070 6172 7469 7469   to each partiti
-00008b10: 6f6e 2e0a 2020 2020 2020 2020 6265 666f  on..        befo
-00008b20: 7265 203a 2069 6e74 2c20 7469 6d65 6465  re : int, timede
-00008b30: 6c74 6120 6f72 2073 7472 696e 6720 7469  lta or string ti
-00008b40: 6d65 6465 6c74 610a 2020 2020 2020 2020  medelta.        
-00008b50: 2020 2020 5468 6520 726f 7773 2074 6f20      The rows to 
-00008b60: 7072 6570 656e 6420 746f 2070 6172 7469  prepend to parti
-00008b70: 7469 6f6e 2060 6069 6060 2066 726f 6d20  tion ``i`` from 
-00008b80: 7468 6520 656e 6420 6f66 0a20 2020 2020  the end of.     
-00008b90: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00008ba0: 2060 6069 202d 2031 6060 2e0a 2020 2020   ``i - 1``..    
-00008bb0: 2020 2020 6166 7465 7220 3a20 696e 742c      after : int,
-00008bc0: 2074 696d 6564 656c 7461 206f 7220 7374   timedelta or st
-00008bd0: 7269 6e67 2074 696d 6564 656c 7461 0a20  ring timedelta. 
-00008be0: 2020 2020 2020 2020 2020 2054 6865 2072             The r
-00008bf0: 6f77 7320 746f 2061 7070 656e 6420 746f  ows to append to
-00008c00: 2070 6172 7469 7469 6f6e 2060 6069 6060   partition ``i``
-00008c10: 2066 726f 6d20 7468 6520 6265 6769 6e6e   from the beginn
-00008c20: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
-00008c30: 6f66 2070 6172 7469 7469 6f6e 2060 6069  of partition ``i
-00008c40: 202b 2031 6060 2e0a 2020 2020 2020 2020   + 1``..        
-00008c50: 6172 6773 2c20 6b77 6172 6773 203a 0a20  args, kwargs :. 
-00008c60: 2020 2020 2020 2020 2020 2050 6f73 6974             Posit
-00008c70: 696f 6e61 6c20 616e 6420 6b65 7977 6f72  ional and keywor
-00008c80: 6420 6172 6775 6d65 6e74 7320 746f 2070  d arguments to p
-00008c90: 6173 7320 746f 2074 6865 2066 756e 6374  ass to the funct
-00008ca0: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
-00008cb0: 2050 6f73 6974 696f 6e61 6c20 6172 6775   Positional argu
-00008cc0: 6d65 6e74 7320 6172 6520 636f 6d70 7574  ments are comput
-00008cd0: 6564 206f 6e20 6120 7065 722d 7061 7274  ed on a per-part
-00008ce0: 6974 696f 6e20 6261 7369 732c 2077 6869  ition basis, whi
-00008cf0: 6c65 0a20 2020 2020 2020 2020 2020 206b  le.            k
-00008d00: 6579 776f 7264 2061 7267 756d 656e 7473  eyword arguments
-00008d10: 2061 7265 2073 6861 7265 6420 6163 726f   are shared acro
-00008d20: 7373 2061 6c6c 2070 6172 7469 7469 6f6e  ss all partition
-00008d30: 732e 2054 6865 2070 6172 7469 7469 6f6e  s. The partition
-00008d40: 0a20 2020 2020 2020 2020 2020 2069 7473  .            its
-00008d50: 656c 6620 7769 6c6c 2062 6520 7468 6520  elf will be the 
-00008d60: 6669 7273 7420 706f 7369 7469 6f6e 616c  first positional
-00008d70: 2061 7267 756d 656e 742c 2077 6974 6820   argument, with 
-00008d80: 616c 6c20 6f74 6865 720a 2020 2020 2020  all other.      
-00008d90: 2020 2020 2020 6172 6775 6d65 6e74 7320        arguments 
-00008da0: 7061 7373 6564 202a 6166 7465 722a 2e20  passed *after*. 
-00008db0: 4172 6775 6d65 6e74 7320 6361 6e20 6265  Arguments can be
-00008dc0: 2060 6053 6361 6c61 7260 602c 2060 6044   ``Scalar``, ``D
-00008dd0: 656c 6179 6564 6060 2c0a 2020 2020 2020  elayed``,.      
-00008de0: 2020 2020 2020 6f72 2072 6567 756c 6172        or regular
-00008df0: 2050 7974 686f 6e20 6f62 6a65 6374 732e   Python objects.
-00008e00: 2044 6174 6146 7261 6d65 2d6c 696b 6520   DataFrame-like 
-00008e10: 6172 6773 2028 626f 7468 2064 6173 6b20  args (both dask 
-00008e20: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
-00008e30: 7061 6e64 6173 2920 7769 6c6c 2062 6520  pandas) will be 
-00008e40: 7265 7061 7274 6974 696f 6e65 6420 746f  repartitioned to
-00008e50: 2061 6c69 676e 2028 6966 206e 6563 6573   align (if neces
-00008e60: 7361 7279 2920 6265 666f 7265 0a20 2020  sary) before.   
-00008e70: 2020 2020 2020 2020 2061 7070 6c79 696e           applyin
-00008e80: 6720 7468 6520 6675 6e63 7469 6f6e 3b20  g the function; 
-00008e90: 7365 6520 6060 616c 6967 6e5f 6461 7461  see ``align_data
-00008ea0: 6672 616d 6573 6060 2074 6f20 636f 6e74  frames`` to cont
-00008eb0: 726f 6c20 7468 6973 0a20 2020 2020 2020  rol this.       
-00008ec0: 2020 2020 2062 6568 6176 696f 722e 0a20       behavior.. 
-00008ed0: 2020 2020 2020 2065 6e66 6f72 6365 5f6d         enforce_m
-00008ee0: 6574 6164 6174 6120 3a20 626f 6f6c 2c20  etadata : bool, 
-00008ef0: 6465 6661 756c 7420 5472 7565 0a20 2020  default True.   
-00008f00: 2020 2020 2020 2020 2057 6865 7468 6572           Whether
-00008f10: 2074 6f20 656e 666f 7263 6520 6174 2072   to enforce at r
-00008f20: 756e 7469 6d65 2074 6861 7420 7468 6520  untime that the 
-00008f30: 7374 7275 6374 7572 6520 6f66 2074 6865  structure of the
-00008f40: 2044 6174 6146 7261 6d65 0a20 2020 2020   DataFrame.     
-00008f50: 2020 2020 2020 2070 726f 6475 6365 6420         produced 
-00008f60: 6279 2060 6066 756e 6360 6020 6163 7475  by ``func`` actu
-00008f70: 616c 6c79 206d 6174 6368 6573 2074 6865  ally matches the
-00008f80: 2073 7472 7563 7475 7265 206f 6620 6060   structure of ``
-00008f90: 6d65 7461 6060 2e0a 2020 2020 2020 2020  meta``..        
-00008fa0: 2020 2020 5468 6973 2077 696c 6c20 7265      This will re
-00008fb0: 6e61 6d65 2061 6e64 2072 656f 7264 6572  name and reorder
-00008fc0: 2063 6f6c 756d 6e73 2066 6f72 2065 6163   columns for eac
-00008fd0: 6820 7061 7274 6974 696f 6e2c 0a20 2020  h partition,.   
-00008fe0: 2020 2020 2020 2020 2061 6e64 2077 696c           and wil
-00008ff0: 6c20 7261 6973 6520 616e 2065 7272 6f72  l raise an error
-00009000: 2069 6620 7468 6973 2064 6f65 736e 2774   if this doesn't
-00009010: 2077 6f72 6b2c 0a20 2020 2020 2020 2020   work,.         
-00009020: 2020 2062 7574 2069 7420 776f 6e27 7420     but it won't 
-00009030: 7261 6973 6520 6966 2064 7479 7065 7320  raise if dtypes 
-00009040: 646f 6e27 7420 6d61 7463 682e 0a20 2020  don't match..   
-00009050: 2020 2020 2074 7261 6e73 666f 726d 5f64       transform_d
-00009060: 6976 6973 696f 6e73 203a 2062 6f6f 6c2c  ivisions : bool,
-00009070: 2064 6566 6175 6c74 2054 7275 650a 2020   default True.  
-00009080: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
-00009090: 7220 746f 2061 7070 6c79 2074 6865 2066  r to apply the f
-000090a0: 756e 6374 696f 6e20 6f6e 746f 2074 6865  unction onto the
-000090b0: 2064 6976 6973 696f 6e73 2061 6e64 2061   divisions and a
-000090c0: 7070 6c79 2074 686f 7365 0a20 2020 2020  pply those.     
-000090d0: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
-000090e0: 6564 2064 6976 6973 696f 6e73 2074 6f20  ed divisions to 
-000090f0: 7468 6520 6f75 7470 7574 2e0a 2020 2020  the output..    
-00009100: 2020 2020 616c 6967 6e5f 6461 7461 6672      align_datafr
-00009110: 616d 6573 203a 2062 6f6f 6c2c 2064 6566  ames : bool, def
+00007a00: 2061 7070 6c79 2074 6865 2066 756e 6374   apply the funct
+00007a10: 696f 6e20 6f6e 746f 2074 6865 2064 6976  ion onto the div
+00007a20: 6973 696f 6e73 2061 6e64 2061 7070 6c79  isions and apply
+00007a30: 2074 686f 7365 0a20 2020 2020 2020 2020   those.         
+00007a40: 2020 2074 7261 6e73 666f 726d 6564 2064     transformed d
+00007a50: 6976 6973 696f 6e73 2074 6f20 7468 6520  ivisions to the 
+00007a60: 6f75 7470 7574 2e0a 2020 2020 2020 2020  output..        
+00007a70: 616c 6967 6e5f 6461 7461 6672 616d 6573  align_dataframes
+00007a80: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
+00007a90: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+00007aa0: 2020 5768 6574 6865 7220 746f 2072 6570    Whether to rep
+00007ab0: 6172 7469 7469 6f6e 2044 6174 6146 7261  artition DataFra
+00007ac0: 6d65 2d20 6f72 2053 6572 6965 732d 6c69  me- or Series-li
+00007ad0: 6b65 2061 7267 730a 2020 2020 2020 2020  ke args.        
+00007ae0: 2020 2020 2862 6f74 6820 6461 736b 2061      (both dask a
+00007af0: 6e64 2070 616e 6461 7329 2073 6f20 7468  nd pandas) so th
+00007b00: 6569 7220 6469 7669 7369 6f6e 7320 616c  eir divisions al
+00007b10: 6967 6e20 6265 666f 7265 2061 7070 6c79  ign before apply
+00007b20: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+00007b30: 7468 6520 6675 6e63 7469 6f6e 2e20 5468  the function. Th
+00007b40: 6973 2072 6571 7569 7265 7320 616c 6c20  is requires all 
+00007b50: 696e 7075 7473 2074 6f20 6861 7665 206b  inputs to have k
+00007b60: 6e6f 776e 2064 6976 6973 696f 6e73 2e0a  nown divisions..
+00007b70: 2020 2020 2020 2020 2020 2020 5369 6e67              Sing
+00007b80: 6c65 2d70 6172 7469 7469 6f6e 2069 6e70  le-partition inp
+00007b90: 7574 7320 7769 6c6c 2062 6520 7370 6c69  uts will be spli
+00007ba0: 7420 696e 746f 206d 756c 7469 706c 6520  t into multiple 
+00007bb0: 7061 7274 6974 696f 6e73 2e0a 0a20 2020  partitions...   
+00007bc0: 2020 2020 2020 2020 2049 6620 4661 6c73           If Fals
+00007bd0: 652c 2061 6c6c 2069 6e70 7574 7320 6d75  e, all inputs mu
+00007be0: 7374 2068 6176 6520 6569 7468 6572 2074  st have either t
+00007bf0: 6865 2073 616d 6520 6e75 6d62 6572 206f  he same number o
+00007c00: 6620 7061 7274 6974 696f 6e73 0a20 2020  f partitions.   
+00007c10: 2020 2020 2020 2020 206f 7220 6120 7369           or a si
+00007c20: 6e67 6c65 2070 6172 7469 7469 6f6e 2e20  ngle partition. 
+00007c30: 5369 6e67 6c65 2d70 6172 7469 7469 6f6e  Single-partition
+00007c40: 2069 6e70 7574 7320 7769 6c6c 2062 6520   inputs will be 
+00007c50: 6272 6f61 6463 6173 7420 746f 0a20 2020  broadcast to.   
+00007c60: 2020 2020 2020 2020 2065 7665 7279 2070           every p
+00007c70: 6172 7469 7469 6f6e 206f 6620 6d75 6c74  artition of mult
+00007c80: 692d 7061 7274 6974 696f 6e20 696e 7075  i-partition inpu
+00007c90: 7473 2e0a 2020 2020 2020 2020 244d 4554  ts..        $MET
+00007ca0: 410a 0a20 2020 2020 2020 2045 7861 6d70  A..        Examp
+00007cb0: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
+00007cc0: 2d2d 2d2d 0a20 2020 2020 2020 2047 6976  ----.        Giv
+00007cd0: 656e 2061 2044 6174 6146 7261 6d65 2c20  en a DataFrame, 
+00007ce0: 5365 7269 6573 2c20 6f72 2049 6e64 6578  Series, or Index
+00007cf0: 2c20 7375 6368 2061 733a 0a0a 2020 2020  , such as:..    
+00007d00: 2020 2020 3e3e 3e20 696d 706f 7274 2070      >>> import p
+00007d10: 616e 6461 7320 6173 2070 640a 2020 2020  andas as pd.    
+00007d20: 2020 2020 3e3e 3e20 696d 706f 7274 2064      >>> import d
+00007d30: 6173 6b2e 6461 7461 6672 616d 6520 6173  ask.dataframe as
+00007d40: 2064 640a 2020 2020 2020 2020 3e3e 3e20   dd.        >>> 
+00007d50: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
+00007d60: 6528 7b27 7827 3a20 5b31 2c20 322c 2033  e({'x': [1, 2, 3
+00007d70: 2c20 342c 2035 5d2c 0a20 2020 2020 2020  , 4, 5],.       
+00007d80: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
+00007d90: 2020 2020 2020 2020 2779 273a 205b 312e          'y': [1.
+00007da0: 2c20 322e 2c20 332e 2c20 342e 2c20 352e  , 2., 3., 4., 5.
+00007db0: 5d7d 290a 2020 2020 2020 2020 3e3e 3e20  ]}).        >>> 
+00007dc0: 6464 6620 3d20 6464 2e66 726f 6d5f 7061  ddf = dd.from_pa
+00007dd0: 6e64 6173 2864 662c 206e 7061 7274 6974  ndas(df, npartit
+00007de0: 696f 6e73 3d32 290a 0a20 2020 2020 2020  ions=2)..       
+00007df0: 204f 6e65 2063 616e 2075 7365 2060 606d   One can use ``m
+00007e00: 6170 5f70 6172 7469 7469 6f6e 7360 6020  ap_partitions`` 
+00007e10: 746f 2061 7070 6c79 2061 2066 756e 6374  to apply a funct
+00007e20: 696f 6e20 6f6e 2065 6163 6820 7061 7274  ion on each part
+00007e30: 6974 696f 6e2e 0a20 2020 2020 2020 2045  ition..        E
+00007e40: 7874 7261 2061 7267 756d 656e 7473 2061  xtra arguments a
+00007e50: 6e64 206b 6579 776f 7264 7320 6361 6e20  nd keywords can 
+00007e60: 6f70 7469 6f6e 616c 6c79 2062 6520 7072  optionally be pr
+00007e70: 6f76 6964 6564 2c20 616e 6420 7769 6c6c  ovided, and will
+00007e80: 2062 650a 2020 2020 2020 2020 7061 7373   be.        pass
+00007e90: 6564 2074 6f20 7468 6520 6675 6e63 7469  ed to the functi
+00007ea0: 6f6e 2061 6674 6572 2074 6865 2070 6172  on after the par
+00007eb0: 7469 7469 6f6e 2e0a 0a20 2020 2020 2020  tition...       
+00007ec0: 2048 6572 6520 7765 2061 7070 6c79 2061   Here we apply a
+00007ed0: 2066 756e 6374 696f 6e20 7769 7468 2061   function with a
+00007ee0: 7267 756d 656e 7473 2061 6e64 206b 6579  rguments and key
+00007ef0: 776f 7264 7320 746f 2061 2044 6174 6146  words to a DataF
+00007f00: 7261 6d65 2c0a 2020 2020 2020 2020 7265  rame,.        re
+00007f10: 7375 6c74 696e 6720 696e 2061 2053 6572  sulting in a Ser
+00007f20: 6965 733a 0a0a 2020 2020 2020 2020 3e3e  ies:..        >>
+00007f30: 3e20 6465 6620 6d79 6164 6428 6466 2c20  > def myadd(df, 
+00007f40: 612c 2062 3d31 293a 0a20 2020 2020 2020  a, b=1):.       
+00007f50: 202e 2e2e 2020 2020 2072 6574 7572 6e20   ...     return 
+00007f60: 6466 2e78 202b 2064 662e 7920 2b20 6120  df.x + df.y + a 
+00007f70: 2b20 620a 2020 2020 2020 2020 3e3e 3e20  + b.        >>> 
+00007f80: 7265 7320 3d20 6464 662e 6d61 705f 7061  res = ddf.map_pa
+00007f90: 7274 6974 696f 6e73 286d 7961 6464 2c20  rtitions(myadd, 
+00007fa0: 312c 2062 3d32 290a 2020 2020 2020 2020  1, b=2).        
+00007fb0: 3e3e 3e20 7265 732e 6474 7970 650a 2020  >>> res.dtype.  
+00007fc0: 2020 2020 2020 6474 7970 6528 2766 6c6f        dtype('flo
+00007fd0: 6174 3634 2729 0a0a 2020 2020 2020 2020  at64')..        
+00007fe0: 4865 7265 2077 6520 6170 706c 7920 6120  Here we apply a 
+00007ff0: 6675 6e63 7469 6f6e 2074 6f20 6120 5365  function to a Se
+00008000: 7269 6573 2072 6573 756c 7469 6e67 2069  ries resulting i
+00008010: 6e20 6120 5365 7269 6573 3a0a 0a20 2020  n a Series:..   
+00008020: 2020 2020 203e 3e3e 2072 6573 203d 2064       >>> res = d
+00008030: 6466 2e78 2e6d 6170 5f70 6172 7469 7469  df.x.map_partiti
+00008040: 6f6e 7328 6c61 6d62 6461 2078 3a20 6c65  ons(lambda x: le
+00008050: 6e28 7829 2920 2320 6464 662e 7820 6973  n(x)) # ddf.x is
+00008060: 2061 2044 6173 6b20 5365 7269 6573 2053   a Dask Series S
+00008070: 7472 7563 7475 7265 0a20 2020 2020 2020  tructure.       
+00008080: 203e 3e3e 2072 6573 2e64 7479 7065 0a20   >>> res.dtype. 
+00008090: 2020 2020 2020 2064 7479 7065 2827 696e         dtype('in
+000080a0: 7436 3427 290a 0a20 2020 2020 2020 2042  t64')..        B
+000080b0: 7920 6465 6661 756c 742c 2064 6173 6b20  y default, dask 
+000080c0: 7472 6965 7320 746f 2069 6e66 6572 2074  tries to infer t
+000080d0: 6865 206f 7574 7075 7420 6d65 7461 6461  he output metada
+000080e0: 7461 2062 7920 7275 6e6e 696e 6720 796f  ta by running yo
+000080f0: 7572 0a20 2020 2020 2020 2070 726f 7669  ur.        provi
+00008100: 6465 6420 6675 6e63 7469 6f6e 206f 6e20  ded function on 
+00008110: 736f 6d65 2066 616b 6520 6461 7461 2e20  some fake data. 
+00008120: 5468 6973 2077 6f72 6b73 2077 656c 6c20  This works well 
+00008130: 696e 206d 616e 7920 6361 7365 732c 2062  in many cases, b
+00008140: 7574 0a20 2020 2020 2020 2063 616e 2073  ut.        can s
+00008150: 6f6d 6574 696d 6573 2062 6520 6578 7065  ometimes be expe
+00008160: 6e73 6976 652c 206f 7220 6576 656e 2066  nsive, or even f
+00008170: 6169 6c2e 2054 6f20 6176 6f69 6420 7468  ail. To avoid th
+00008180: 6973 2c20 796f 7520 6361 6e0a 2020 2020  is, you can.    
+00008190: 2020 2020 6d61 6e75 616c 6c79 2073 7065      manually spe
+000081a0: 6369 6679 2074 6865 206f 7574 7075 7420  cify the output 
+000081b0: 6d65 7461 6461 7461 2077 6974 6820 7468  metadata with th
+000081c0: 6520 6060 6d65 7461 6060 206b 6579 776f  e ``meta`` keywo
+000081d0: 7264 2e20 5468 6973 0a20 2020 2020 2020  rd. This.       
+000081e0: 2063 616e 2062 6520 7370 6563 6966 6965   can be specifie
+000081f0: 6420 696e 206d 616e 7920 666f 726d 732c  d in many forms,
+00008200: 2066 6f72 206d 6f72 6520 696e 666f 726d   for more inform
+00008210: 6174 696f 6e20 7365 650a 2020 2020 2020  ation see.      
+00008220: 2020 6060 6461 736b 2e64 6174 6166 7261    ``dask.datafra
+00008230: 6d65 2e75 7469 6c73 2e6d 616b 655f 6d65  me.utils.make_me
+00008240: 7461 6060 2e0a 0a20 2020 2020 2020 2048  ta``...        H
+00008250: 6572 6520 7765 2073 7065 6369 6679 2074  ere we specify t
+00008260: 6865 206f 7574 7075 7420 6973 2061 2053  he output is a S
+00008270: 6572 6965 7320 7769 7468 206e 6f20 6e61  eries with no na
+00008280: 6d65 2c20 616e 6420 6474 7970 650a 2020  me, and dtype.  
+00008290: 2020 2020 2020 6060 666c 6f61 7436 3460        ``float64`
+000082a0: 603a 0a0a 2020 2020 2020 2020 3e3e 3e20  `:..        >>> 
+000082b0: 7265 7320 3d20 6464 662e 6d61 705f 7061  res = ddf.map_pa
+000082c0: 7274 6974 696f 6e73 286d 7961 6464 2c20  rtitions(myadd, 
+000082d0: 312c 2062 3d32 2c20 6d65 7461 3d28 4e6f  1, b=2, meta=(No
+000082e0: 6e65 2c20 2766 3827 2929 0a0a 2020 2020  ne, 'f8'))..    
+000082f0: 2020 2020 4865 7265 2077 6520 6d61 7020      Here we map 
+00008300: 6120 6675 6e63 7469 6f6e 2074 6861 7420  a function that 
+00008310: 7461 6b65 7320 696e 2061 2044 6174 6146  takes in a DataF
+00008320: 7261 6d65 2c20 616e 6420 7265 7475 726e  rame, and return
+00008330: 7320 610a 2020 2020 2020 2020 4461 7461  s a.        Data
+00008340: 4672 616d 6520 7769 7468 2061 206e 6577  Frame with a new
+00008350: 2063 6f6c 756d 6e3a 0a0a 2020 2020 2020   column:..      
+00008360: 2020 3e3e 3e20 7265 7320 3d20 6464 662e    >>> res = ddf.
+00008370: 6d61 705f 7061 7274 6974 696f 6e73 286c  map_partitions(l
+00008380: 616d 6264 6120 6466 3a20 6466 2e61 7373  ambda df: df.ass
+00008390: 6967 6e28 7a3d 6466 2e78 202a 2064 662e  ign(z=df.x * df.
+000083a0: 7929 290a 2020 2020 2020 2020 3e3e 3e20  y)).        >>> 
+000083b0: 7265 732e 6474 7970 6573 0a20 2020 2020  res.dtypes.     
+000083c0: 2020 2078 2020 2020 2020 696e 7436 340a     x      int64.
+000083d0: 2020 2020 2020 2020 7920 2020 2066 6c6f          y    flo
+000083e0: 6174 3634 0a20 2020 2020 2020 207a 2020  at64.        z  
+000083f0: 2020 666c 6f61 7436 340a 2020 2020 2020    float64.      
+00008400: 2020 6474 7970 653a 206f 626a 6563 740a    dtype: object.
+00008410: 0a20 2020 2020 2020 2041 7320 6265 666f  .        As befo
+00008420: 7265 2c20 7468 6520 6f75 7470 7574 206d  re, the output m
+00008430: 6574 6164 6174 6120 6361 6e20 616c 736f  etadata can also
+00008440: 2062 6520 7370 6563 6966 6965 6420 6d61   be specified ma
+00008450: 6e75 616c 6c79 2e20 5468 6973 0a20 2020  nually. This.   
+00008460: 2020 2020 2074 696d 6520 7765 2070 6173       time we pas
+00008470: 7320 696e 2061 2060 6064 6963 7460 602c  s in a ``dict``,
+00008480: 2061 7320 7468 6520 6f75 7470 7574 2069   as the output i
+00008490: 7320 6120 4461 7461 4672 616d 653a 0a0a  s a DataFrame:..
+000084a0: 2020 2020 2020 2020 3e3e 3e20 7265 7320          >>> res 
+000084b0: 3d20 6464 662e 6d61 705f 7061 7274 6974  = ddf.map_partit
+000084c0: 696f 6e73 286c 616d 6264 6120 6466 3a20  ions(lambda df: 
+000084d0: 6466 2e61 7373 6967 6e28 7a3d 6466 2e78  df.assign(z=df.x
+000084e0: 202a 2064 662e 7929 2c0a 2020 2020 2020   * df.y),.      
+000084f0: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
+00008500: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00008510: 6574 613d 7b27 7827 3a20 2769 3827 2c20  eta={'x': 'i8', 
+00008520: 2779 273a 2027 6638 272c 2027 7a27 3a20  'y': 'f8', 'z': 
+00008530: 2766 3827 7d29 0a0a 2020 2020 2020 2020  'f8'})..        
+00008540: 496e 2074 6865 2063 6173 6520 7768 6572  In the case wher
+00008550: 6520 7468 6520 6d65 7461 6461 7461 2064  e the metadata d
+00008560: 6f65 736e 2774 2063 6861 6e67 652c 2079  oesn't change, y
+00008570: 6f75 2063 616e 2061 6c73 6f20 7061 7373  ou can also pass
+00008580: 2069 6e0a 2020 2020 2020 2020 7468 6520   in.        the 
+00008590: 6f62 6a65 6374 2069 7473 656c 6620 6469  object itself di
+000085a0: 7265 6374 6c79 3a0a 0a20 2020 2020 2020  rectly:..       
+000085b0: 203e 3e3e 2072 6573 203d 2064 6466 2e6d   >>> res = ddf.m
+000085c0: 6170 5f70 6172 7469 7469 6f6e 7328 6c61  ap_partitions(la
+000085d0: 6d62 6461 2064 663a 2064 662e 6865 6164  mbda df: df.head
+000085e0: 2829 2c20 6d65 7461 3d64 6466 290a 0a20  (), meta=ddf).. 
+000085f0: 2020 2020 2020 2041 6c73 6f20 6e6f 7465         Also note
+00008600: 2074 6861 7420 7468 6520 696e 6465 7820   that the index 
+00008610: 616e 6420 6469 7669 7369 6f6e 7320 6172  and divisions ar
+00008620: 6520 6173 7375 6d65 6420 746f 2072 656d  e assumed to rem
+00008630: 6169 6e20 756e 6368 616e 6765 642e 0a20  ain unchanged.. 
+00008640: 2020 2020 2020 2049 6620 7468 6520 6675         If the fu
+00008650: 6e63 7469 6f6e 2079 6f75 2772 6520 6d61  nction you're ma
+00008660: 7070 696e 6720 6368 616e 6765 7320 7468  pping changes th
+00008670: 6520 696e 6465 782f 6469 7669 7369 6f6e  e index/division
+00008680: 732c 2079 6f75 276c 6c20 6e65 6564 0a20  s, you'll need. 
+00008690: 2020 2020 2020 2074 6f20 636c 6561 7220         to clear 
+000086a0: 7468 656d 2061 6674 6572 7761 7264 733a  them afterwards:
+000086b0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6464  ..        >>> dd
+000086c0: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+000086d0: 2866 756e 6329 2e63 6c65 6172 5f64 6976  (func).clear_div
+000086e0: 6973 696f 6e73 2829 2020 2320 646f 6374  isions()  # doct
+000086f0: 6573 743a 202b 534b 4950 0a0a 2020 2020  est: +SKIP..    
+00008700: 2020 2020 596f 7572 206d 6170 2066 756e      Your map fun
+00008710: 6374 696f 6e20 6765 7473 2069 6e66 6f72  ction gets infor
+00008720: 6d61 7469 6f6e 2061 626f 7574 2077 6865  mation about whe
+00008730: 7265 2069 7420 6973 2069 6e20 7468 6520  re it is in the 
+00008740: 6461 7461 6672 616d 6520 6279 0a20 2020  dataframe by.   
+00008750: 2020 2020 2061 6363 6570 7469 6e67 2061       accepting a
+00008760: 2073 7065 6369 616c 2060 6070 6172 7469   special ``parti
+00008770: 7469 6f6e 5f69 6e66 6f60 6020 6b65 7977  tion_info`` keyw
+00008780: 6f72 6420 6172 6775 6d65 6e74 2e0a 0a20  ord argument... 
+00008790: 2020 2020 2020 203e 3e3e 2064 6566 2066         >>> def f
+000087a0: 756e 6328 7061 7274 6974 696f 6e2c 2070  unc(partition, p
+000087b0: 6172 7469 7469 6f6e 5f69 6e66 6f3d 4e6f  artition_info=No
+000087c0: 6e65 293a 0a20 2020 2020 2020 202e 2e2e  ne):.        ...
+000087d0: 2020 2020 2070 6173 730a 0a20 2020 2020       pass..     
+000087e0: 2020 2054 6869 7320 7769 6c6c 2072 6563     This will rec
+000087f0: 6569 7665 2074 6865 2066 6f6c 6c6f 7769  eive the followi
+00008800: 6e67 2069 6e66 6f72 6d61 7469 6f6e 3a0a  ng information:.
+00008810: 0a20 2020 2020 2020 203e 3e3e 2070 6172  .        >>> par
+00008820: 7469 7469 6f6e 5f69 6e66 6f20 2023 2064  tition_info  # d
+00008830: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
+00008840: 2020 2020 2020 7b27 6e75 6d62 6572 273a        {'number':
+00008850: 2031 2c20 2764 6976 6973 696f 6e27 3a20   1, 'division': 
+00008860: 337d 0a0a 2020 2020 2020 2020 466f 7220  3}..        For 
+00008870: 6561 6368 2061 7267 756d 656e 7420 616e  each argument an
+00008880: 6420 6b65 7977 6f72 6420 6172 6775 6d65  d keyword argume
+00008890: 6e74 7320 7468 6174 2061 7265 2064 6173  nts that are das
+000088a0: 6b20 6461 7461 6672 616d 6573 2079 6f75  k dataframes you
+000088b0: 2077 696c 6c0a 2020 2020 2020 2020 7265   will.        re
+000088c0: 6365 6976 6520 7468 6520 6e75 6d62 6572  ceive the number
+000088d0: 2028 6e29 2077 6869 6368 2072 6570 7265   (n) which repre
+000088e0: 7365 6e74 7320 7468 6520 6e74 6820 7061  sents the nth pa
+000088f0: 7274 6974 696f 6e20 6f66 2074 6865 2064  rtition of the d
+00008900: 6174 6166 7261 6d65 0a20 2020 2020 2020  ataframe.       
+00008910: 2061 6e64 2074 6865 2064 6976 6973 696f   and the divisio
+00008920: 6e20 2874 6865 2066 6972 7374 2069 6e64  n (the first ind
+00008930: 6578 2076 616c 7565 2069 6e20 7468 6520  ex value in the 
+00008940: 7061 7274 6974 696f 6e29 2e20 4966 2064  partition). If d
+00008950: 6976 6973 696f 6e73 0a20 2020 2020 2020  ivisions.       
+00008960: 2061 7265 206e 6f74 206b 6e6f 776e 2028   are not known (
+00008970: 666f 7220 696e 7374 616e 6365 2069 6620  for instance if 
+00008980: 7468 6520 696e 6465 7820 6973 206e 6f74  the index is not
+00008990: 2073 6f72 7465 6429 2074 6865 6e20 796f   sorted) then yo
+000089a0: 7520 7769 6c6c 2067 6574 0a20 2020 2020  u will get.     
+000089b0: 2020 204e 6f6e 6520 6173 2074 6865 2064     None as the d
+000089c0: 6976 6973 696f 6e2e 0a20 2020 2020 2020  ivision..       
+000089d0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+000089e0: 7572 6e20 6d61 705f 7061 7274 6974 696f  urn map_partitio
+000089f0: 6e73 2866 756e 632c 2073 656c 662c 202a  ns(func, self, *
+00008a00: 6172 6773 2c20 2a2a 6b77 6172 6773 290a  args, **kwargs).
+00008a10: 0a20 2020 2040 696e 7365 7274 5f6d 6574  .    @insert_met
+00008a20: 615f 7061 7261 6d5f 6465 7363 7269 7074  a_param_descript
+00008a30: 696f 6e28 7061 643d 3132 290a 2020 2020  ion(pad=12).    
+00008a40: 6465 6620 6d61 705f 6f76 6572 6c61 7028  def map_overlap(
+00008a50: 7365 6c66 2c20 6675 6e63 2c20 6265 666f  self, func, befo
+00008a60: 7265 2c20 6166 7465 722c 202a 6172 6773  re, after, *args
+00008a70: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00008a80: 2020 2020 2022 2222 4170 706c 7920 6120       """Apply a 
+00008a90: 6675 6e63 7469 6f6e 2074 6f20 6561 6368  function to each
+00008aa0: 2070 6172 7469 7469 6f6e 2c20 7368 6172   partition, shar
+00008ab0: 696e 6720 726f 7773 2077 6974 6820 6164  ing rows with ad
+00008ac0: 6a61 6365 6e74 2070 6172 7469 7469 6f6e  jacent partition
+00008ad0: 732e 0a0a 2020 2020 2020 2020 5468 6973  s...        This
+00008ae0: 2063 616e 2062 6520 7573 6566 756c 2066   can be useful f
+00008af0: 6f72 2069 6d70 6c65 6d65 6e74 696e 6720  or implementing 
+00008b00: 7769 6e64 6f77 696e 6720 6675 6e63 7469  windowing functi
+00008b10: 6f6e 7320 7375 6368 2061 730a 2020 2020  ons such as.    
+00008b20: 2020 2020 6060 6466 2e72 6f6c 6c69 6e67      ``df.rolling
+00008b30: 282e 2e2e 292e 6d65 616e 2829 6060 206f  (...).mean()`` o
+00008b40: 7220 6060 6466 2e64 6966 6628 2960 602e  r ``df.diff()``.
+00008b50: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00008b60: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+00008b70: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00008b80: 6675 6e63 203a 2066 756e 6374 696f 6e0a  func : function.
+00008b90: 2020 2020 2020 2020 2020 2020 4675 6e63              Func
+00008ba0: 7469 6f6e 2061 7070 6c69 6564 2074 6f20  tion applied to 
+00008bb0: 6561 6368 2070 6172 7469 7469 6f6e 2e0a  each partition..
+00008bc0: 2020 2020 2020 2020 6265 666f 7265 203a          before :
+00008bd0: 2069 6e74 2c20 7469 6d65 6465 6c74 6120   int, timedelta 
+00008be0: 6f72 2073 7472 696e 6720 7469 6d65 6465  or string timede
+00008bf0: 6c74 610a 2020 2020 2020 2020 2020 2020  lta.            
+00008c00: 5468 6520 726f 7773 2074 6f20 7072 6570  The rows to prep
+00008c10: 656e 6420 746f 2070 6172 7469 7469 6f6e  end to partition
+00008c20: 2060 6069 6060 2066 726f 6d20 7468 6520   ``i`` from the 
+00008c30: 656e 6420 6f66 0a20 2020 2020 2020 2020  end of.         
+00008c40: 2020 2070 6172 7469 7469 6f6e 2060 6069     partition ``i
+00008c50: 202d 2031 6060 2e0a 2020 2020 2020 2020   - 1``..        
+00008c60: 6166 7465 7220 3a20 696e 742c 2074 696d  after : int, tim
+00008c70: 6564 656c 7461 206f 7220 7374 7269 6e67  edelta or string
+00008c80: 2074 696d 6564 656c 7461 0a20 2020 2020   timedelta.     
+00008c90: 2020 2020 2020 2054 6865 2072 6f77 7320         The rows 
+00008ca0: 746f 2061 7070 656e 6420 746f 2070 6172  to append to par
+00008cb0: 7469 7469 6f6e 2060 6069 6060 2066 726f  tition ``i`` fro
+00008cc0: 6d20 7468 6520 6265 6769 6e6e 696e 670a  m the beginning.
+00008cd0: 2020 2020 2020 2020 2020 2020 6f66 2070              of p
+00008ce0: 6172 7469 7469 6f6e 2060 6069 202b 2031  artition ``i + 1
+00008cf0: 6060 2e0a 2020 2020 2020 2020 6172 6773  ``..        args
+00008d00: 2c20 6b77 6172 6773 203a 0a20 2020 2020  , kwargs :.     
+00008d10: 2020 2020 2020 2050 6f73 6974 696f 6e61         Positiona
+00008d20: 6c20 616e 6420 6b65 7977 6f72 6420 6172  l and keyword ar
+00008d30: 6775 6d65 6e74 7320 746f 2070 6173 7320  guments to pass 
+00008d40: 746f 2074 6865 2066 756e 6374 696f 6e2e  to the function.
+00008d50: 0a20 2020 2020 2020 2020 2020 2050 6f73  .            Pos
+00008d60: 6974 696f 6e61 6c20 6172 6775 6d65 6e74  itional argument
+00008d70: 7320 6172 6520 636f 6d70 7574 6564 206f  s are computed o
+00008d80: 6e20 6120 7065 722d 7061 7274 6974 696f  n a per-partitio
+00008d90: 6e20 6261 7369 732c 2077 6869 6c65 0a20  n basis, while. 
+00008da0: 2020 2020 2020 2020 2020 206b 6579 776f             keywo
+00008db0: 7264 2061 7267 756d 656e 7473 2061 7265  rd arguments are
+00008dc0: 2073 6861 7265 6420 6163 726f 7373 2061   shared across a
+00008dd0: 6c6c 2070 6172 7469 7469 6f6e 732e 2054  ll partitions. T
+00008de0: 6865 2070 6172 7469 7469 6f6e 0a20 2020  he partition.   
+00008df0: 2020 2020 2020 2020 2069 7473 656c 6620           itself 
+00008e00: 7769 6c6c 2062 6520 7468 6520 6669 7273  will be the firs
+00008e10: 7420 706f 7369 7469 6f6e 616c 2061 7267  t positional arg
+00008e20: 756d 656e 742c 2077 6974 6820 616c 6c20  ument, with all 
+00008e30: 6f74 6865 720a 2020 2020 2020 2020 2020  other.          
+00008e40: 2020 6172 6775 6d65 6e74 7320 7061 7373    arguments pass
+00008e50: 6564 202a 6166 7465 722a 2e20 4172 6775  ed *after*. Argu
+00008e60: 6d65 6e74 7320 6361 6e20 6265 2060 6053  ments can be ``S
+00008e70: 6361 6c61 7260 602c 2060 6044 656c 6179  calar``, ``Delay
+00008e80: 6564 6060 2c0a 2020 2020 2020 2020 2020  ed``,.          
+00008e90: 2020 6f72 2072 6567 756c 6172 2050 7974    or regular Pyt
+00008ea0: 686f 6e20 6f62 6a65 6374 732e 2044 6174  hon objects. Dat
+00008eb0: 6146 7261 6d65 2d6c 696b 6520 6172 6773  aFrame-like args
+00008ec0: 2028 626f 7468 2064 6173 6b20 616e 640a   (both dask and.
+00008ed0: 2020 2020 2020 2020 2020 2020 7061 6e64              pand
+00008ee0: 6173 2920 7769 6c6c 2062 6520 7265 7061  as) will be repa
+00008ef0: 7274 6974 696f 6e65 6420 746f 2061 6c69  rtitioned to ali
+00008f00: 676e 2028 6966 206e 6563 6573 7361 7279  gn (if necessary
+00008f10: 2920 6265 666f 7265 0a20 2020 2020 2020  ) before.       
+00008f20: 2020 2020 2061 7070 6c79 696e 6720 7468       applying th
+00008f30: 6520 6675 6e63 7469 6f6e 3b20 7365 6520  e function; see 
+00008f40: 6060 616c 6967 6e5f 6461 7461 6672 616d  ``align_datafram
+00008f50: 6573 6060 2074 6f20 636f 6e74 726f 6c20  es`` to control 
+00008f60: 7468 6973 0a20 2020 2020 2020 2020 2020  this.           
+00008f70: 2062 6568 6176 696f 722e 0a20 2020 2020   behavior..     
+00008f80: 2020 2065 6e66 6f72 6365 5f6d 6574 6164     enforce_metad
+00008f90: 6174 6120 3a20 626f 6f6c 2c20 6465 6661  ata : bool, defa
+00008fa0: 756c 7420 5472 7565 0a20 2020 2020 2020  ult True.       
+00008fb0: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
+00008fc0: 656e 666f 7263 6520 6174 2072 756e 7469  enforce at runti
+00008fd0: 6d65 2074 6861 7420 7468 6520 7374 7275  me that the stru
+00008fe0: 6374 7572 6520 6f66 2074 6865 2044 6174  cture of the Dat
+00008ff0: 6146 7261 6d65 0a20 2020 2020 2020 2020  aFrame.         
+00009000: 2020 2070 726f 6475 6365 6420 6279 2060     produced by `
+00009010: 6066 756e 6360 6020 6163 7475 616c 6c79  `func`` actually
+00009020: 206d 6174 6368 6573 2074 6865 2073 7472   matches the str
+00009030: 7563 7475 7265 206f 6620 6060 6d65 7461  ucture of ``meta
+00009040: 6060 2e0a 2020 2020 2020 2020 2020 2020  ``..            
+00009050: 5468 6973 2077 696c 6c20 7265 6e61 6d65  This will rename
+00009060: 2061 6e64 2072 656f 7264 6572 2063 6f6c   and reorder col
+00009070: 756d 6e73 2066 6f72 2065 6163 6820 7061  umns for each pa
+00009080: 7274 6974 696f 6e2c 0a20 2020 2020 2020  rtition,.       
+00009090: 2020 2020 2061 6e64 2077 696c 6c20 7261       and will ra
+000090a0: 6973 6520 616e 2065 7272 6f72 2069 6620  ise an error if 
+000090b0: 7468 6973 2064 6f65 736e 2774 2077 6f72  this doesn't wor
+000090c0: 6b2c 0a20 2020 2020 2020 2020 2020 2062  k,.            b
+000090d0: 7574 2069 7420 776f 6e27 7420 7261 6973  ut it won't rais
+000090e0: 6520 6966 2064 7479 7065 7320 646f 6e27  e if dtypes don'
+000090f0: 7420 6d61 7463 682e 0a20 2020 2020 2020  t match..       
+00009100: 2074 7261 6e73 666f 726d 5f64 6976 6973   transform_divis
+00009110: 696f 6e73 203a 2062 6f6f 6c2c 2064 6566  ions : bool, def
 00009120: 6175 6c74 2054 7275 650a 2020 2020 2020  ault True.      
 00009130: 2020 2020 2020 5768 6574 6865 7220 746f        Whether to
-00009140: 2072 6570 6172 7469 7469 6f6e 2044 6174   repartition Dat
-00009150: 6146 7261 6d65 2d20 6f72 2053 6572 6965  aFrame- or Serie
-00009160: 732d 6c69 6b65 2061 7267 730a 2020 2020  s-like args.    
-00009170: 2020 2020 2020 2020 2862 6f74 6820 6461          (both da
-00009180: 736b 2061 6e64 2070 616e 6461 7329 2073  sk and pandas) s
-00009190: 6f20 7468 6569 7220 6469 7669 7369 6f6e  o their division
-000091a0: 7320 616c 6967 6e20 6265 666f 7265 2061  s align before a
-000091b0: 7070 6c79 696e 670a 2020 2020 2020 2020  pplying.        
-000091c0: 2020 2020 7468 6520 6675 6e63 7469 6f6e      the function
-000091d0: 2e20 5468 6973 2072 6571 7569 7265 7320  . This requires 
-000091e0: 616c 6c20 696e 7075 7473 2074 6f20 6861  all inputs to ha
-000091f0: 7665 206b 6e6f 776e 2064 6976 6973 696f  ve known divisio
-00009200: 6e73 2e0a 2020 2020 2020 2020 2020 2020  ns..            
-00009210: 5369 6e67 6c65 2d70 6172 7469 7469 6f6e  Single-partition
-00009220: 2069 6e70 7574 7320 7769 6c6c 2062 6520   inputs will be 
-00009230: 7370 6c69 7420 696e 746f 206d 756c 7469  split into multi
-00009240: 706c 6520 7061 7274 6974 696f 6e73 2e0a  ple partitions..
-00009250: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00009260: 4661 6c73 652c 2061 6c6c 2069 6e70 7574  False, all input
-00009270: 7320 6d75 7374 2068 6176 6520 6569 7468  s must have eith
-00009280: 6572 2074 6865 2073 616d 6520 6e75 6d62  er the same numb
-00009290: 6572 206f 6620 7061 7274 6974 696f 6e73  er of partitions
-000092a0: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
-000092b0: 6120 7369 6e67 6c65 2070 6172 7469 7469  a single partiti
-000092c0: 6f6e 2e20 5369 6e67 6c65 2d70 6172 7469  on. Single-parti
-000092d0: 7469 6f6e 2069 6e70 7574 7320 7769 6c6c  tion inputs will
-000092e0: 2062 6520 6272 6f61 6463 6173 7420 746f   be broadcast to
-000092f0: 0a20 2020 2020 2020 2020 2020 2065 7665  .            eve
-00009300: 7279 2070 6172 7469 7469 6f6e 206f 6620  ry partition of 
-00009310: 6d75 6c74 692d 7061 7274 6974 696f 6e20  multi-partition 
-00009320: 696e 7075 7473 2e0a 2020 2020 2020 2020  inputs..        
-00009330: 244d 4554 410a 0a20 2020 2020 2020 204e  $META..        N
-00009340: 6f74 6573 0a20 2020 2020 2020 202d 2d2d  otes.        ---
-00009350: 2d2d 0a20 2020 2020 2020 2047 6976 656e  --.        Given
-00009360: 2070 6f73 6974 6976 6520 696e 7465 6765   positive intege
-00009370: 7273 2060 6062 6566 6f72 6560 6020 616e  rs ``before`` an
-00009380: 6420 6060 6166 7465 7260 602c 2061 6e64  d ``after``, and
-00009390: 2061 2066 756e 6374 696f 6e0a 2020 2020   a function.    
-000093a0: 2020 2020 6060 6675 6e63 6060 2c20 6060      ``func``, ``
-000093b0: 6d61 705f 6f76 6572 6c61 7060 6020 646f  map_overlap`` do
-000093c0: 6573 2074 6865 2066 6f6c 6c6f 7769 6e67  es the following
-000093d0: 3a0a 0a20 2020 2020 2020 2031 2e20 5072  :..        1. Pr
-000093e0: 6570 656e 6420 6060 6265 666f 7265 6060  epend ``before``
-000093f0: 2072 6f77 7320 746f 2065 6163 6820 7061   rows to each pa
-00009400: 7274 6974 696f 6e20 6060 6960 6020 6672  rtition ``i`` fr
-00009410: 6f6d 2074 6865 2065 6e64 206f 660a 2020  om the end of.  
-00009420: 2020 2020 2020 2020 2070 6172 7469 7469           partiti
-00009430: 6f6e 2060 6069 202d 2031 6060 2e20 5468  on ``i - 1``. Th
-00009440: 6520 6669 7273 7420 7061 7274 6974 696f  e first partitio
-00009450: 6e20 6861 7320 6e6f 2072 6f77 7320 7072  n has no rows pr
-00009460: 6570 656e 6465 642e 0a0a 2020 2020 2020  epended...      
-00009470: 2020 322e 2041 7070 656e 6420 6060 6166    2. Append ``af
-00009480: 7465 7260 6020 726f 7773 2074 6f20 6561  ter`` rows to ea
-00009490: 6368 2070 6172 7469 7469 6f6e 2060 6069  ch partition ``i
-000094a0: 6060 2066 726f 6d20 7468 6520 6265 6769  `` from the begi
-000094b0: 6e6e 696e 6720 6f66 0a20 2020 2020 2020  nning of.       
-000094c0: 2020 2020 7061 7274 6974 696f 6e20 6060      partition ``
-000094d0: 6920 2b20 3160 602e 2054 6865 206c 6173  i + 1``. The las
-000094e0: 7420 7061 7274 6974 696f 6e20 6861 7320  t partition has 
-000094f0: 6e6f 2072 6f77 7320 6170 7065 6e64 6564  no rows appended
-00009500: 2e0a 0a20 2020 2020 2020 2033 2e20 4170  ...        3. Ap
-00009510: 706c 7920 6060 6675 6e63 6060 2074 6f20  ply ``func`` to 
-00009520: 6561 6368 2070 6172 7469 7469 6f6e 2c20  each partition, 
-00009530: 7061 7373 696e 6720 696e 2061 6e79 2065  passing in any e
-00009540: 7874 7261 2060 6061 7267 7360 6020 616e  xtra ``args`` an
-00009550: 640a 2020 2020 2020 2020 2020 2060 606b  d.           ``k
-00009560: 7761 7267 7360 6020 6966 2070 726f 7669  wargs`` if provi
-00009570: 6465 642e 0a0a 2020 2020 2020 2020 342e  ded...        4.
-00009580: 2054 7269 6d20 6060 6265 666f 7265 6060   Trim ``before``
-00009590: 2072 6f77 7320 6672 6f6d 2074 6865 2062   rows from the b
-000095a0: 6567 696e 6e69 6e67 206f 6620 616c 6c20  eginning of all 
-000095b0: 6275 7420 7468 6520 6669 7273 740a 2020  but the first.  
-000095c0: 2020 2020 2020 2020 2070 6172 7469 7469           partiti
-000095d0: 6f6e 2e0a 0a20 2020 2020 2020 2035 2e20  on...        5. 
-000095e0: 5472 696d 2060 6061 6674 6572 6060 2072  Trim ``after`` r
-000095f0: 6f77 7320 6672 6f6d 2074 6865 2065 6e64  ows from the end
-00009600: 206f 6620 616c 6c20 6275 7420 7468 6520   of all but the 
-00009610: 6c61 7374 2070 6172 7469 7469 6f6e 2e0a  last partition..
-00009620: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
-00009630: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00009640: 2d2d 0a20 2020 2020 2020 2047 6976 656e  --.        Given
-00009650: 2061 2044 6174 6146 7261 6d65 2c20 5365   a DataFrame, Se
-00009660: 7269 6573 2c20 6f72 2049 6e64 6578 2c20  ries, or Index, 
-00009670: 7375 6368 2061 733a 0a0a 2020 2020 2020  such as:..      
-00009680: 2020 3e3e 3e20 696d 706f 7274 2070 616e    >>> import pan
-00009690: 6461 7320 6173 2070 640a 2020 2020 2020  das as pd.      
-000096a0: 2020 3e3e 3e20 696d 706f 7274 2064 6173    >>> import das
-000096b0: 6b2e 6461 7461 6672 616d 6520 6173 2064  k.dataframe as d
-000096c0: 640a 2020 2020 2020 2020 3e3e 3e20 6466  d.        >>> df
-000096d0: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-000096e0: 7b27 7827 3a20 5b31 2c20 322c 2034 2c20  {'x': [1, 2, 4, 
-000096f0: 372c 2031 315d 2c0a 2020 2020 2020 2020  7, 11],.        
-00009700: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-00009710: 2020 2020 2020 2027 7927 3a20 5b31 2e2c         'y': [1.,
-00009720: 2032 2e2c 2033 2e2c 2034 2e2c 2035 2e5d   2., 3., 4., 5.]
-00009730: 7d29 0a20 2020 2020 2020 203e 3e3e 2064  }).        >>> d
-00009740: 6466 203d 2064 642e 6672 6f6d 5f70 616e  df = dd.from_pan
-00009750: 6461 7328 6466 2c20 6e70 6172 7469 7469  das(df, npartiti
-00009760: 6f6e 733d 3229 0a0a 2020 2020 2020 2020  ons=2)..        
-00009770: 4120 726f 6c6c 696e 6720 7375 6d20 7769  A rolling sum wi
-00009780: 7468 2061 2074 7261 696c 696e 6720 6d6f  th a trailing mo
-00009790: 7669 6e67 2077 696e 646f 7720 6f66 2073  ving window of s
-000097a0: 697a 6520 3220 6361 6e20 6265 2063 6f6d  ize 2 can be com
-000097b0: 7075 7465 6420 6279 0a20 2020 2020 2020  puted by.       
-000097c0: 206f 7665 726c 6170 7069 6e67 2032 2072   overlapping 2 r
-000097d0: 6f77 7320 6265 666f 7265 2065 6163 6820  ows before each 
-000097e0: 7061 7274 6974 696f 6e2c 2061 6e64 2074  partition, and t
-000097f0: 6865 6e20 6d61 7070 696e 6720 6361 6c6c  hen mapping call
-00009800: 7320 746f 0a20 2020 2020 2020 2060 6064  s to.        ``d
-00009810: 662e 726f 6c6c 696e 6728 3229 2e73 756d  f.rolling(2).sum
-00009820: 2829 6060 3a0a 0a20 2020 2020 2020 203e  ()``:..        >
-00009830: 3e3e 2064 6466 2e63 6f6d 7075 7465 2829  >> ddf.compute()
-00009840: 0a20 2020 2020 2020 2020 2020 2078 2020  .            x  
-00009850: 2020 790a 2020 2020 2020 2020 3020 2020    y.        0   
-00009860: 3120 2031 2e30 0a20 2020 2020 2020 2031  1  1.0.        1
-00009870: 2020 2032 2020 322e 300a 2020 2020 2020     2  2.0.      
-00009880: 2020 3220 2020 3420 2033 2e30 0a20 2020    2   4  3.0.   
-00009890: 2020 2020 2033 2020 2037 2020 342e 300a       3   7  4.0.
-000098a0: 2020 2020 2020 2020 3420 2031 3120 2035          4  11  5
-000098b0: 2e30 0a20 2020 2020 2020 203e 3e3e 2064  .0.        >>> d
-000098c0: 6466 2e6d 6170 5f6f 7665 726c 6170 286c  df.map_overlap(l
-000098d0: 616d 6264 6120 6466 3a20 6466 2e72 6f6c  ambda df: df.rol
-000098e0: 6c69 6e67 2832 292e 7375 6d28 292c 2032  ling(2).sum(), 2
-000098f0: 2c20 3029 2e63 6f6d 7075 7465 2829 0a20  , 0).compute(). 
-00009900: 2020 2020 2020 2020 2020 2020 2078 2020               x  
-00009910: 2020 790a 2020 2020 2020 2020 3020 2020    y.        0   
-00009920: 4e61 4e20 204e 614e 0a20 2020 2020 2020  NaN  NaN.       
-00009930: 2031 2020 2033 2e30 2020 332e 300a 2020   1   3.0  3.0.  
-00009940: 2020 2020 2020 3220 2020 362e 3020 2035        2   6.0  5
-00009950: 2e30 0a20 2020 2020 2020 2033 2020 3131  .0.        3  11
-00009960: 2e30 2020 372e 300a 2020 2020 2020 2020  .0  7.0.        
-00009970: 3420 2031 382e 3020 2039 2e30 0a0a 2020  4  18.0  9.0..  
-00009980: 2020 2020 2020 5468 6520 7061 6e64 6173        The pandas
-00009990: 2060 6064 6966 6660 6020 6d65 7468 6f64   ``diff`` method
-000099a0: 2063 6f6d 7075 7465 7320 6120 6469 7363   computes a disc
-000099b0: 7265 7465 2064 6966 6665 7265 6e63 6520  rete difference 
-000099c0: 7368 6966 7465 6420 6279 2061 0a20 2020  shifted by a.   
-000099d0: 2020 2020 206e 756d 6265 7220 6f66 2070       number of p
-000099e0: 6572 696f 6473 2028 6361 6e20 6265 2070  eriods (can be p
-000099f0: 6f73 6974 6976 6520 6f72 206e 6567 6174  ositive or negat
-00009a00: 6976 6529 2e20 5468 6973 2063 616e 2062  ive). This can b
-00009a10: 650a 2020 2020 2020 2020 696d 706c 656d  e.        implem
-00009a20: 656e 7465 6420 6279 206d 6170 7069 6e67  ented by mapping
-00009a30: 2063 616c 6c73 2074 6f20 6060 6466 2e64   calls to ``df.d
-00009a40: 6966 6660 6020 746f 2065 6163 6820 7061  iff`` to each pa
-00009a50: 7274 6974 696f 6e20 6166 7465 720a 2020  rtition after.  
-00009a60: 2020 2020 2020 7072 6570 656e 6469 6e67        prepending
-00009a70: 2f61 7070 656e 6469 6e67 2074 6861 7420  /appending that 
-00009a80: 6d61 6e79 2072 6f77 732c 2064 6570 656e  many rows, depen
-00009a90: 6469 6e67 206f 6e20 7369 676e 3a0a 0a20  ding on sign:.. 
-00009aa0: 2020 2020 2020 203e 3e3e 2064 6566 2064         >>> def d
-00009ab0: 6966 6628 6466 2c20 7065 7269 6f64 733d  iff(df, periods=
-00009ac0: 3129 3a0a 2020 2020 2020 2020 2e2e 2e20  1):.        ... 
-00009ad0: 2020 2020 6265 666f 7265 2c20 6166 7465      before, afte
-00009ae0: 7220 3d20 2870 6572 696f 6473 2c20 3029  r = (periods, 0)
-00009af0: 2069 6620 7065 7269 6f64 7320 3e20 3020   if periods > 0 
-00009b00: 656c 7365 2028 302c 202d 7065 7269 6f64  else (0, -period
-00009b10: 7329 0a20 2020 2020 2020 202e 2e2e 2020  s).        ...  
-00009b20: 2020 2072 6574 7572 6e20 6466 2e6d 6170     return df.map
-00009b30: 5f6f 7665 726c 6170 286c 616d 6264 6120  _overlap(lambda 
-00009b40: 6466 2c20 7065 7269 6f64 733d 313a 2064  df, periods=1: d
-00009b50: 662e 6469 6666 2870 6572 696f 6473 292c  f.diff(periods),
-00009b60: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00009b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009b80: 2020 2020 2020 2070 6572 696f 6473 2c20         periods, 
-00009b90: 302c 2070 6572 696f 6473 3d70 6572 696f  0, periods=perio
-00009ba0: 6473 290a 2020 2020 2020 2020 3e3e 3e20  ds).        >>> 
-00009bb0: 6469 6666 2864 6466 2c20 3129 2e63 6f6d  diff(ddf, 1).com
-00009bc0: 7075 7465 2829 0a20 2020 2020 2020 2020  pute().         
-00009bd0: 2020 2020 7820 2020 2079 0a20 2020 2020      x    y.     
-00009be0: 2020 2030 2020 4e61 4e20 204e 614e 0a20     0  NaN  NaN. 
-00009bf0: 2020 2020 2020 2031 2020 312e 3020 2031         1  1.0  1
-00009c00: 2e30 0a20 2020 2020 2020 2032 2020 322e  .0.        2  2.
-00009c10: 3020 2031 2e30 0a20 2020 2020 2020 2033  0  1.0.        3
-00009c20: 2020 332e 3020 2031 2e30 0a20 2020 2020    3.0  1.0.     
-00009c30: 2020 2034 2020 342e 3020 2031 2e30 0a0a     4  4.0  1.0..
-00009c40: 2020 2020 2020 2020 4966 2079 6f75 2068          If you h
-00009c50: 6176 6520 6120 6060 4461 7465 7469 6d65  ave a ``Datetime
-00009c60: 496e 6465 7860 602c 2079 6f75 2063 616e  Index``, you can
-00009c70: 2075 7365 2061 2060 6070 642e 5469 6d65   use a ``pd.Time
-00009c80: 6465 6c74 6160 6020 666f 7220 7469 6d65  delta`` for time
-00009c90: 2d0a 2020 2020 2020 2020 6261 7365 6420  -.        based 
-00009ca0: 7769 6e64 6f77 7320 6f72 2061 6e79 2060  windows or any `
-00009cb0: 6070 642e 5469 6d65 6465 6c74 6160 6020  `pd.Timedelta`` 
-00009cc0: 636f 6e76 6572 7469 626c 6520 7374 7269  convertible stri
-00009cd0: 6e67 3a0a 0a20 2020 2020 2020 203e 3e3e  ng:..        >>>
-00009ce0: 2074 7320 3d20 7064 2e53 6572 6965 7328   ts = pd.Series(
-00009cf0: 7261 6e67 6528 3130 292c 2069 6e64 6578  range(10), index
-00009d00: 3d70 642e 6461 7465 5f72 616e 6765 2827  =pd.date_range('
-00009d10: 3230 3137 272c 2070 6572 696f 6473 3d31  2017', periods=1
-00009d20: 3029 290a 2020 2020 2020 2020 3e3e 3e20  0)).        >>> 
-00009d30: 6474 7320 3d20 6464 2e66 726f 6d5f 7061  dts = dd.from_pa
-00009d40: 6e64 6173 2874 732c 206e 7061 7274 6974  ndas(ts, npartit
-00009d50: 696f 6e73 3d32 290a 2020 2020 2020 2020  ions=2).        
-00009d60: 3e3e 3e20 6474 732e 6d61 705f 6f76 6572  >>> dts.map_over
-00009d70: 6c61 7028 6c61 6d62 6461 2064 663a 2064  lap(lambda df: d
-00009d80: 662e 726f 6c6c 696e 6728 2732 4427 292e  f.rolling('2D').
-00009d90: 7375 6d28 292c 0a20 2020 2020 2020 202e  sum(),.        .
-00009da0: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
-00009db0: 2020 2070 642e 5469 6d65 6465 6c74 6128     pd.Timedelta(
-00009dc0: 2732 4427 292c 2030 292e 636f 6d70 7574  '2D'), 0).comput
-00009dd0: 6528 290a 2020 2020 2020 2020 3230 3137  e().        2017
-00009de0: 2d30 312d 3031 2020 2020 2030 2e30 0a20  -01-01     0.0. 
-00009df0: 2020 2020 2020 2032 3031 372d 3031 2d30         2017-01-0
-00009e00: 3220 2020 2020 312e 300a 2020 2020 2020  2     1.0.      
-00009e10: 2020 3230 3137 2d30 312d 3033 2020 2020    2017-01-03    
-00009e20: 2033 2e30 0a20 2020 2020 2020 2032 3031   3.0.        201
-00009e30: 372d 3031 2d30 3420 2020 2020 352e 300a  7-01-04     5.0.
-00009e40: 2020 2020 2020 2020 3230 3137 2d30 312d          2017-01-
-00009e50: 3035 2020 2020 2037 2e30 0a20 2020 2020  05     7.0.     
-00009e60: 2020 2032 3031 372d 3031 2d30 3620 2020     2017-01-06   
-00009e70: 2020 392e 300a 2020 2020 2020 2020 3230    9.0.        20
-00009e80: 3137 2d30 312d 3037 2020 2020 3131 2e30  17-01-07    11.0
-00009e90: 0a20 2020 2020 2020 2032 3031 372d 3031  .        2017-01
-00009ea0: 2d30 3820 2020 2031 332e 300a 2020 2020  -08    13.0.    
-00009eb0: 2020 2020 3230 3137 2d30 312d 3039 2020      2017-01-09  
-00009ec0: 2020 3135 2e30 0a20 2020 2020 2020 2032    15.0.        2
-00009ed0: 3031 372d 3031 2d31 3020 2020 2031 372e  017-01-10    17.
-00009ee0: 300a 2020 2020 2020 2020 4672 6571 3a20  0.        Freq: 
-00009ef0: 442c 2064 7479 7065 3a20 666c 6f61 7436  D, dtype: float6
-00009f00: 340a 2020 2020 2020 2020 2222 220a 2020  4.        """.  
-00009f10: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-00009f20: 6461 7461 6672 616d 652e 726f 6c6c 696e  dataframe.rollin
-00009f30: 6720 696d 706f 7274 206d 6170 5f6f 7665  g import map_ove
-00009f40: 726c 6170 0a0a 2020 2020 2020 2020 7265  rlap..        re
-00009f50: 7475 726e 206d 6170 5f6f 7665 726c 6170  turn map_overlap
-00009f60: 2866 756e 632c 2073 656c 662c 2062 6566  (func, self, bef
-00009f70: 6f72 652c 2061 6674 6572 2c20 2a61 7267  ore, after, *arg
-00009f80: 732c 202a 2a6b 7761 7267 7329 0a0a 2020  s, **kwargs)..  
-00009f90: 2020 6465 6620 6d65 6d6f 7279 5f75 7361    def memory_usa
-00009fa0: 6765 5f70 6572 5f70 6172 7469 7469 6f6e  ge_per_partition
-00009fb0: 2873 656c 662c 2069 6e64 6578 3d54 7275  (self, index=Tru
-00009fc0: 652c 2064 6565 703d 4661 6c73 6529 3a0a  e, deep=False):.
-00009fd0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-00009fe0: 6e20 7468 6520 6d65 6d6f 7279 2075 7361  n the memory usa
-00009ff0: 6765 206f 6620 6561 6368 2070 6172 7469  ge of each parti
-0000a000: 7469 6f6e 0a0a 2020 2020 2020 2020 5061  tion..        Pa
-0000a010: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-0000a020: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-0000a030: 2020 2020 696e 6465 7820 3a20 626f 6f6c      index : bool
-0000a040: 2c20 6465 6661 756c 7420 5472 7565 0a20  , default True. 
-0000a050: 2020 2020 2020 2020 2020 2053 7065 6369             Speci
-0000a060: 6669 6573 2077 6865 7468 6572 2074 6f20  fies whether to 
-0000a070: 696e 636c 7564 6520 7468 6520 6d65 6d6f  include the memo
-0000a080: 7279 2075 7361 6765 206f 6620 7468 6520  ry usage of the 
-0000a090: 696e 6465 7820 696e 0a20 2020 2020 2020  index in.       
-0000a0a0: 2020 2020 2072 6574 7572 6e65 6420 5365       returned Se
-0000a0b0: 7269 6573 2e0a 2020 2020 2020 2020 6465  ries..        de
-0000a0c0: 6570 203a 2062 6f6f 6c2c 2064 6566 6175  ep : bool, defau
-0000a0d0: 6c74 2046 616c 7365 0a20 2020 2020 2020  lt False.       
-0000a0e0: 2020 2020 2049 6620 5472 7565 2c20 696e       If True, in
-0000a0f0: 7472 6f73 7065 6374 2074 6865 2064 6174  trospect the dat
-0000a100: 6120 6465 6570 6c79 2062 7920 696e 7465  a deeply by inte
-0000a110: 7272 6f67 6174 696e 670a 2020 2020 2020  rrogating.      
-0000a120: 2020 2020 2020 6060 6f62 6a65 6374 6060        ``object``
-0000a130: 2064 7479 7065 7320 666f 7220 7379 7374   dtypes for syst
-0000a140: 656d 2d6c 6576 656c 206d 656d 6f72 7920  em-level memory 
-0000a150: 636f 6e73 756d 7074 696f 6e2c 2061 6e64  consumption, and
-0000a160: 2069 6e63 6c75 6465 0a20 2020 2020 2020   include.       
-0000a170: 2020 2020 2069 7420 696e 2074 6865 2072       it in the r
-0000a180: 6574 7572 6e65 6420 7661 6c75 6573 2e0a  eturned values..
-0000a190: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0000a1a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000a1b0: 0a20 2020 2020 2020 2053 6572 6965 730a  .        Series.
-0000a1c0: 2020 2020 2020 2020 2020 2020 4120 5365              A Se
-0000a1d0: 7269 6573 2077 686f 7365 2069 6e64 6578  ries whose index
-0000a1e0: 2069 7320 7468 6520 7061 7274 6974 696f   is the partitio
-0000a1f0: 6e20 6e75 6d62 6572 2061 6e64 2077 686f  n number and who
-0000a200: 7365 2076 616c 7565 730a 2020 2020 2020  se values.      
-0000a210: 2020 2020 2020 6172 6520 7468 6520 6d65        are the me
-0000a220: 6d6f 7279 2075 7361 6765 206f 6620 6561  mory usage of ea
-0000a230: 6368 2070 6172 7469 7469 6f6e 2069 6e20  ch partition in 
-0000a240: 6279 7465 732e 0a20 2020 2020 2020 2022  bytes..        "
-0000a250: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-0000a260: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
-0000a270: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
-0000a280: 2020 2074 6f74 616c 5f6d 656d 5f75 7361     total_mem_usa
-0000a290: 6765 2c20 696e 6465 783d 696e 6465 782c  ge, index=index,
-0000a2a0: 2064 6565 703d 6465 6570 0a20 2020 2020   deep=deep.     
-0000a2b0: 2020 2029 2e63 6c65 6172 5f64 6976 6973     ).clear_divis
-0000a2c0: 696f 6e73 2829 0a0a 2020 2020 4069 6e73  ions()..    @ins
-0000a2d0: 6572 745f 6d65 7461 5f70 6172 616d 5f64  ert_meta_param_d
-0000a2e0: 6573 6372 6970 7469 6f6e 2870 6164 3d31  escription(pad=1
-0000a2f0: 3229 0a20 2020 2064 6566 2072 6564 7563  2).    def reduc
-0000a300: 7469 6f6e 280a 2020 2020 2020 2020 7365  tion(.        se
-0000a310: 6c66 2c0a 2020 2020 2020 2020 6368 756e  lf,.        chun
-0000a320: 6b2c 0a20 2020 2020 2020 2061 6767 7265  k,.        aggre
-0000a330: 6761 7465 3d4e 6f6e 652c 0a20 2020 2020  gate=None,.     
-0000a340: 2020 2063 6f6d 6269 6e65 3d4e 6f6e 652c     combine=None,
-0000a350: 0a20 2020 2020 2020 206d 6574 613d 6e6f  .        meta=no
-0000a360: 5f64 6566 6175 6c74 2c0a 2020 2020 2020  _default,.      
-0000a370: 2020 746f 6b65 6e3d 4e6f 6e65 2c0a 2020    token=None,.  
-0000a380: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
-0000a390: 793d 4e6f 6e65 2c0a 2020 2020 2020 2020  y=None,.        
-0000a3a0: 6368 756e 6b5f 6b77 6172 6773 3d4e 6f6e  chunk_kwargs=Non
-0000a3b0: 652c 0a20 2020 2020 2020 2061 6767 7265  e,.        aggre
-0000a3c0: 6761 7465 5f6b 7761 7267 733d 4e6f 6e65  gate_kwargs=None
-0000a3d0: 2c0a 2020 2020 2020 2020 636f 6d62 696e  ,.        combin
-0000a3e0: 655f 6b77 6172 6773 3d4e 6f6e 652c 0a20  e_kwargs=None,. 
-0000a3f0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
-0000a400: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0000a410: 2222 2247 656e 6572 6963 2072 6f77 2d77  """Generic row-w
-0000a420: 6973 6520 7265 6475 6374 696f 6e73 2e0a  ise reductions..
-0000a430: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0000a440: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-0000a450: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2063  ------.        c
-0000a460: 6875 6e6b 203a 2063 616c 6c61 626c 650a  hunk : callable.
-0000a470: 2020 2020 2020 2020 2020 2020 4675 6e63              Func
-0000a480: 7469 6f6e 2074 6f20 6f70 6572 6174 6520  tion to operate 
-0000a490: 6f6e 2065 6163 6820 7061 7274 6974 696f  on each partitio
-0000a4a0: 6e2e 2053 686f 756c 6420 7265 7475 726e  n. Should return
-0000a4b0: 2061 0a20 2020 2020 2020 2020 2020 2060   a.            `
-0000a4c0: 6070 616e 6461 732e 4461 7461 4672 616d  `pandas.DataFram
-0000a4d0: 6560 602c 2060 6070 616e 6461 732e 5365  e``, ``pandas.Se
-0000a4e0: 7269 6573 6060 2c20 6f72 2061 2073 6361  ries``, or a sca
-0000a4f0: 6c61 722e 0a20 2020 2020 2020 2061 6767  lar..        agg
-0000a500: 7265 6761 7465 203a 2063 616c 6c61 626c  regate : callabl
-0000a510: 652c 206f 7074 696f 6e61 6c0a 2020 2020  e, optional.    
+00009140: 2061 7070 6c79 2074 6865 2066 756e 6374   apply the funct
+00009150: 696f 6e20 6f6e 746f 2074 6865 2064 6976  ion onto the div
+00009160: 6973 696f 6e73 2061 6e64 2061 7070 6c79  isions and apply
+00009170: 2074 686f 7365 0a20 2020 2020 2020 2020   those.         
+00009180: 2020 2074 7261 6e73 666f 726d 6564 2064     transformed d
+00009190: 6976 6973 696f 6e73 2074 6f20 7468 6520  ivisions to the 
+000091a0: 6f75 7470 7574 2e0a 2020 2020 2020 2020  output..        
+000091b0: 616c 6967 6e5f 6461 7461 6672 616d 6573  align_dataframes
+000091c0: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
+000091d0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+000091e0: 2020 5768 6574 6865 7220 746f 2072 6570    Whether to rep
+000091f0: 6172 7469 7469 6f6e 2044 6174 6146 7261  artition DataFra
+00009200: 6d65 2d20 6f72 2053 6572 6965 732d 6c69  me- or Series-li
+00009210: 6b65 2061 7267 730a 2020 2020 2020 2020  ke args.        
+00009220: 2020 2020 2862 6f74 6820 6461 736b 2061      (both dask a
+00009230: 6e64 2070 616e 6461 7329 2073 6f20 7468  nd pandas) so th
+00009240: 6569 7220 6469 7669 7369 6f6e 7320 616c  eir divisions al
+00009250: 6967 6e20 6265 666f 7265 2061 7070 6c79  ign before apply
+00009260: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+00009270: 7468 6520 6675 6e63 7469 6f6e 2e20 5468  the function. Th
+00009280: 6973 2072 6571 7569 7265 7320 616c 6c20  is requires all 
+00009290: 696e 7075 7473 2074 6f20 6861 7665 206b  inputs to have k
+000092a0: 6e6f 776e 2064 6976 6973 696f 6e73 2e0a  nown divisions..
+000092b0: 2020 2020 2020 2020 2020 2020 5369 6e67              Sing
+000092c0: 6c65 2d70 6172 7469 7469 6f6e 2069 6e70  le-partition inp
+000092d0: 7574 7320 7769 6c6c 2062 6520 7370 6c69  uts will be spli
+000092e0: 7420 696e 746f 206d 756c 7469 706c 6520  t into multiple 
+000092f0: 7061 7274 6974 696f 6e73 2e0a 0a20 2020  partitions...   
+00009300: 2020 2020 2020 2020 2049 6620 4661 6c73           If Fals
+00009310: 652c 2061 6c6c 2069 6e70 7574 7320 6d75  e, all inputs mu
+00009320: 7374 2068 6176 6520 6569 7468 6572 2074  st have either t
+00009330: 6865 2073 616d 6520 6e75 6d62 6572 206f  he same number o
+00009340: 6620 7061 7274 6974 696f 6e73 0a20 2020  f partitions.   
+00009350: 2020 2020 2020 2020 206f 7220 6120 7369           or a si
+00009360: 6e67 6c65 2070 6172 7469 7469 6f6e 2e20  ngle partition. 
+00009370: 5369 6e67 6c65 2d70 6172 7469 7469 6f6e  Single-partition
+00009380: 2069 6e70 7574 7320 7769 6c6c 2062 6520   inputs will be 
+00009390: 6272 6f61 6463 6173 7420 746f 0a20 2020  broadcast to.   
+000093a0: 2020 2020 2020 2020 2065 7665 7279 2070           every p
+000093b0: 6172 7469 7469 6f6e 206f 6620 6d75 6c74  artition of mult
+000093c0: 692d 7061 7274 6974 696f 6e20 696e 7075  i-partition inpu
+000093d0: 7473 2e0a 2020 2020 2020 2020 244d 4554  ts..        $MET
+000093e0: 410a 0a20 2020 2020 2020 204e 6f74 6573  A..        Notes
+000093f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 0a20  .        -----. 
+00009400: 2020 2020 2020 2047 6976 656e 2070 6f73         Given pos
+00009410: 6974 6976 6520 696e 7465 6765 7273 2060  itive integers `
+00009420: 6062 6566 6f72 6560 6020 616e 6420 6060  `before`` and ``
+00009430: 6166 7465 7260 602c 2061 6e64 2061 2066  after``, and a f
+00009440: 756e 6374 696f 6e0a 2020 2020 2020 2020  unction.        
+00009450: 6060 6675 6e63 6060 2c20 6060 6d61 705f  ``func``, ``map_
+00009460: 6f76 6572 6c61 7060 6020 646f 6573 2074  overlap`` does t
+00009470: 6865 2066 6f6c 6c6f 7769 6e67 3a0a 0a20  he following:.. 
+00009480: 2020 2020 2020 2031 2e20 5072 6570 656e         1. Prepen
+00009490: 6420 6060 6265 666f 7265 6060 2072 6f77  d ``before`` row
+000094a0: 7320 746f 2065 6163 6820 7061 7274 6974  s to each partit
+000094b0: 696f 6e20 6060 6960 6020 6672 6f6d 2074  ion ``i`` from t
+000094c0: 6865 2065 6e64 206f 660a 2020 2020 2020  he end of.      
+000094d0: 2020 2020 2070 6172 7469 7469 6f6e 2060       partition `
+000094e0: 6069 202d 2031 6060 2e20 5468 6520 6669  `i - 1``. The fi
+000094f0: 7273 7420 7061 7274 6974 696f 6e20 6861  rst partition ha
+00009500: 7320 6e6f 2072 6f77 7320 7072 6570 656e  s no rows prepen
+00009510: 6465 642e 0a0a 2020 2020 2020 2020 322e  ded...        2.
+00009520: 2041 7070 656e 6420 6060 6166 7465 7260   Append ``after`
+00009530: 6020 726f 7773 2074 6f20 6561 6368 2070  ` rows to each p
+00009540: 6172 7469 7469 6f6e 2060 6069 6060 2066  artition ``i`` f
+00009550: 726f 6d20 7468 6520 6265 6769 6e6e 696e  rom the beginnin
+00009560: 6720 6f66 0a20 2020 2020 2020 2020 2020  g of.           
+00009570: 7061 7274 6974 696f 6e20 6060 6920 2b20  partition ``i + 
+00009580: 3160 602e 2054 6865 206c 6173 7420 7061  1``. The last pa
+00009590: 7274 6974 696f 6e20 6861 7320 6e6f 2072  rtition has no r
+000095a0: 6f77 7320 6170 7065 6e64 6564 2e0a 0a20  ows appended... 
+000095b0: 2020 2020 2020 2033 2e20 4170 706c 7920         3. Apply 
+000095c0: 6060 6675 6e63 6060 2074 6f20 6561 6368  ``func`` to each
+000095d0: 2070 6172 7469 7469 6f6e 2c20 7061 7373   partition, pass
+000095e0: 696e 6720 696e 2061 6e79 2065 7874 7261  ing in any extra
+000095f0: 2060 6061 7267 7360 6020 616e 640a 2020   ``args`` and.  
+00009600: 2020 2020 2020 2020 2060 606b 7761 7267           ``kwarg
+00009610: 7360 6020 6966 2070 726f 7669 6465 642e  s`` if provided.
+00009620: 0a0a 2020 2020 2020 2020 342e 2054 7269  ..        4. Tri
+00009630: 6d20 6060 6265 666f 7265 6060 2072 6f77  m ``before`` row
+00009640: 7320 6672 6f6d 2074 6865 2062 6567 696e  s from the begin
+00009650: 6e69 6e67 206f 6620 616c 6c20 6275 7420  ning of all but 
+00009660: 7468 6520 6669 7273 740a 2020 2020 2020  the first.      
+00009670: 2020 2020 2070 6172 7469 7469 6f6e 2e0a       partition..
+00009680: 0a20 2020 2020 2020 2035 2e20 5472 696d  .        5. Trim
+00009690: 2060 6061 6674 6572 6060 2072 6f77 7320   ``after`` rows 
+000096a0: 6672 6f6d 2074 6865 2065 6e64 206f 6620  from the end of 
+000096b0: 616c 6c20 6275 7420 7468 6520 6c61 7374  all but the last
+000096c0: 2070 6172 7469 7469 6f6e 2e0a 0a20 2020   partition...   
+000096d0: 2020 2020 2045 7861 6d70 6c65 730a 2020       Examples.  
+000096e0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+000096f0: 2020 2020 2020 2047 6976 656e 2061 2044         Given a D
+00009700: 6174 6146 7261 6d65 2c20 5365 7269 6573  ataFrame, Series
+00009710: 2c20 6f72 2049 6e64 6578 2c20 7375 6368  , or Index, such
+00009720: 2061 733a 0a0a 2020 2020 2020 2020 3e3e   as:..        >>
+00009730: 3e20 696d 706f 7274 2070 616e 6461 7320  > import pandas 
+00009740: 6173 2070 640a 2020 2020 2020 2020 3e3e  as pd.        >>
+00009750: 3e20 696d 706f 7274 2064 6173 6b2e 6461  > import dask.da
+00009760: 7461 6672 616d 6520 6173 2064 640a 2020  taframe as dd.  
+00009770: 2020 2020 2020 3e3e 3e20 6466 203d 2070        >>> df = p
+00009780: 642e 4461 7461 4672 616d 6528 7b27 7827  d.DataFrame({'x'
+00009790: 3a20 5b31 2c20 322c 2034 2c20 372c 2031  : [1, 2, 4, 7, 1
+000097a0: 315d 2c0a 2020 2020 2020 2020 2e2e 2e20  1],.        ... 
+000097b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000097c0: 2020 2027 7927 3a20 5b31 2e2c 2032 2e2c     'y': [1., 2.,
+000097d0: 2033 2e2c 2034 2e2c 2035 2e5d 7d29 0a20   3., 4., 5.]}). 
+000097e0: 2020 2020 2020 203e 3e3e 2064 6466 203d         >>> ddf =
+000097f0: 2064 642e 6672 6f6d 5f70 616e 6461 7328   dd.from_pandas(
+00009800: 6466 2c20 6e70 6172 7469 7469 6f6e 733d  df, npartitions=
+00009810: 3229 0a0a 2020 2020 2020 2020 4120 726f  2)..        A ro
+00009820: 6c6c 696e 6720 7375 6d20 7769 7468 2061  lling sum with a
+00009830: 2074 7261 696c 696e 6720 6d6f 7669 6e67   trailing moving
+00009840: 2077 696e 646f 7720 6f66 2073 697a 6520   window of size 
+00009850: 3220 6361 6e20 6265 2063 6f6d 7075 7465  2 can be compute
+00009860: 6420 6279 0a20 2020 2020 2020 206f 7665  d by.        ove
+00009870: 726c 6170 7069 6e67 2032 2072 6f77 7320  rlapping 2 rows 
+00009880: 6265 666f 7265 2065 6163 6820 7061 7274  before each part
+00009890: 6974 696f 6e2c 2061 6e64 2074 6865 6e20  ition, and then 
+000098a0: 6d61 7070 696e 6720 6361 6c6c 7320 746f  mapping calls to
+000098b0: 0a20 2020 2020 2020 2060 6064 662e 726f  .        ``df.ro
+000098c0: 6c6c 696e 6728 3229 2e73 756d 2829 6060  lling(2).sum()``
+000098d0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+000098e0: 6466 2e63 6f6d 7075 7465 2829 0a20 2020  df.compute().   
+000098f0: 2020 2020 2020 2020 2078 2020 2020 790a           x    y.
+00009900: 2020 2020 2020 2020 3020 2020 3120 2031          0   1  1
+00009910: 2e30 0a20 2020 2020 2020 2031 2020 2032  .0.        1   2
+00009920: 2020 322e 300a 2020 2020 2020 2020 3220    2.0.        2 
+00009930: 2020 3420 2033 2e30 0a20 2020 2020 2020    4  3.0.       
+00009940: 2033 2020 2037 2020 342e 300a 2020 2020   3   7  4.0.    
+00009950: 2020 2020 3420 2031 3120 2035 2e30 0a20      4  11  5.0. 
+00009960: 2020 2020 2020 203e 3e3e 2064 6466 2e6d         >>> ddf.m
+00009970: 6170 5f6f 7665 726c 6170 286c 616d 6264  ap_overlap(lambd
+00009980: 6120 6466 3a20 6466 2e72 6f6c 6c69 6e67  a df: df.rolling
+00009990: 2832 292e 7375 6d28 292c 2032 2c20 3029  (2).sum(), 2, 0)
+000099a0: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
+000099b0: 2020 2020 2020 2020 2078 2020 2020 790a           x    y.
+000099c0: 2020 2020 2020 2020 3020 2020 4e61 4e20          0   NaN 
+000099d0: 204e 614e 0a20 2020 2020 2020 2031 2020   NaN.        1  
+000099e0: 2033 2e30 2020 332e 300a 2020 2020 2020   3.0  3.0.      
+000099f0: 2020 3220 2020 362e 3020 2035 2e30 0a20    2   6.0  5.0. 
+00009a00: 2020 2020 2020 2033 2020 3131 2e30 2020         3  11.0  
+00009a10: 372e 300a 2020 2020 2020 2020 3420 2031  7.0.        4  1
+00009a20: 382e 3020 2039 2e30 0a0a 2020 2020 2020  8.0  9.0..      
+00009a30: 2020 5468 6520 7061 6e64 6173 2060 6064    The pandas ``d
+00009a40: 6966 6660 6020 6d65 7468 6f64 2063 6f6d  iff`` method com
+00009a50: 7075 7465 7320 6120 6469 7363 7265 7465  putes a discrete
+00009a60: 2064 6966 6665 7265 6e63 6520 7368 6966   difference shif
+00009a70: 7465 6420 6279 2061 0a20 2020 2020 2020  ted by a.       
+00009a80: 206e 756d 6265 7220 6f66 2070 6572 696f   number of perio
+00009a90: 6473 2028 6361 6e20 6265 2070 6f73 6974  ds (can be posit
+00009aa0: 6976 6520 6f72 206e 6567 6174 6976 6529  ive or negative)
+00009ab0: 2e20 5468 6973 2063 616e 2062 650a 2020  . This can be.  
+00009ac0: 2020 2020 2020 696d 706c 656d 656e 7465        implemente
+00009ad0: 6420 6279 206d 6170 7069 6e67 2063 616c  d by mapping cal
+00009ae0: 6c73 2074 6f20 6060 6466 2e64 6966 6660  ls to ``df.diff`
+00009af0: 6020 746f 2065 6163 6820 7061 7274 6974  ` to each partit
+00009b00: 696f 6e20 6166 7465 720a 2020 2020 2020  ion after.      
+00009b10: 2020 7072 6570 656e 6469 6e67 2f61 7070    prepending/app
+00009b20: 656e 6469 6e67 2074 6861 7420 6d61 6e79  ending that many
+00009b30: 2072 6f77 732c 2064 6570 656e 6469 6e67   rows, depending
+00009b40: 206f 6e20 7369 676e 3a0a 0a20 2020 2020   on sign:..     
+00009b50: 2020 203e 3e3e 2064 6566 2064 6966 6628     >>> def diff(
+00009b60: 6466 2c20 7065 7269 6f64 733d 3129 3a0a  df, periods=1):.
+00009b70: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00009b80: 6265 666f 7265 2c20 6166 7465 7220 3d20  before, after = 
+00009b90: 2870 6572 696f 6473 2c20 3029 2069 6620  (periods, 0) if 
+00009ba0: 7065 7269 6f64 7320 3e20 3020 656c 7365  periods > 0 else
+00009bb0: 2028 302c 202d 7065 7269 6f64 7329 0a20   (0, -periods). 
+00009bc0: 2020 2020 2020 202e 2e2e 2020 2020 2072         ...     r
+00009bd0: 6574 7572 6e20 6466 2e6d 6170 5f6f 7665  eturn df.map_ove
+00009be0: 726c 6170 286c 616d 6264 6120 6466 2c20  rlap(lambda df, 
+00009bf0: 7065 7269 6f64 733d 313a 2064 662e 6469  periods=1: df.di
+00009c00: 6666 2870 6572 696f 6473 292c 0a20 2020  ff(periods),.   
+00009c10: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+00009c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009c30: 2020 2070 6572 696f 6473 2c20 302c 2070     periods, 0, p
+00009c40: 6572 696f 6473 3d70 6572 696f 6473 290a  eriods=periods).
+00009c50: 2020 2020 2020 2020 3e3e 3e20 6469 6666          >>> diff
+00009c60: 2864 6466 2c20 3129 2e63 6f6d 7075 7465  (ddf, 1).compute
+00009c70: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+00009c80: 7820 2020 2079 0a20 2020 2020 2020 2030  x    y.        0
+00009c90: 2020 4e61 4e20 204e 614e 0a20 2020 2020    NaN  NaN.     
+00009ca0: 2020 2031 2020 312e 3020 2031 2e30 0a20     1  1.0  1.0. 
+00009cb0: 2020 2020 2020 2032 2020 322e 3020 2031         2  2.0  1
+00009cc0: 2e30 0a20 2020 2020 2020 2033 2020 332e  .0.        3  3.
+00009cd0: 3020 2031 2e30 0a20 2020 2020 2020 2034  0  1.0.        4
+00009ce0: 2020 342e 3020 2031 2e30 0a0a 2020 2020    4.0  1.0..    
+00009cf0: 2020 2020 4966 2079 6f75 2068 6176 6520      If you have 
+00009d00: 6120 6060 4461 7465 7469 6d65 496e 6465  a ``DatetimeInde
+00009d10: 7860 602c 2079 6f75 2063 616e 2075 7365  x``, you can use
+00009d20: 2061 2060 6070 642e 5469 6d65 6465 6c74   a ``pd.Timedelt
+00009d30: 6160 6020 666f 7220 7469 6d65 2d0a 2020  a`` for time-.  
+00009d40: 2020 2020 2020 6261 7365 6420 7769 6e64        based wind
+00009d50: 6f77 7320 6f72 2061 6e79 2060 6070 642e  ows or any ``pd.
+00009d60: 5469 6d65 6465 6c74 6160 6020 636f 6e76  Timedelta`` conv
+00009d70: 6572 7469 626c 6520 7374 7269 6e67 3a0a  ertible string:.
+00009d80: 0a20 2020 2020 2020 203e 3e3e 2074 7320  .        >>> ts 
+00009d90: 3d20 7064 2e53 6572 6965 7328 7261 6e67  = pd.Series(rang
+00009da0: 6528 3130 292c 2069 6e64 6578 3d70 642e  e(10), index=pd.
+00009db0: 6461 7465 5f72 616e 6765 2827 3230 3137  date_range('2017
+00009dc0: 272c 2070 6572 696f 6473 3d31 3029 290a  ', periods=10)).
+00009dd0: 2020 2020 2020 2020 3e3e 3e20 6474 7320          >>> dts 
+00009de0: 3d20 6464 2e66 726f 6d5f 7061 6e64 6173  = dd.from_pandas
+00009df0: 2874 732c 206e 7061 7274 6974 696f 6e73  (ts, npartitions
+00009e00: 3d32 290a 2020 2020 2020 2020 3e3e 3e20  =2).        >>> 
+00009e10: 6474 732e 6d61 705f 6f76 6572 6c61 7028  dts.map_overlap(
+00009e20: 6c61 6d62 6461 2064 663a 2064 662e 726f  lambda df: df.ro
+00009e30: 6c6c 696e 6728 2732 4427 292e 7375 6d28  lling('2D').sum(
+00009e40: 292c 0a20 2020 2020 2020 202e 2e2e 2020  ),.        ...  
+00009e50: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00009e60: 642e 5469 6d65 6465 6c74 6128 2732 4427  d.Timedelta('2D'
+00009e70: 292c 2030 292e 636f 6d70 7574 6528 290a  ), 0).compute().
+00009e80: 2020 2020 2020 2020 3230 3137 2d30 312d          2017-01-
+00009e90: 3031 2020 2020 2030 2e30 0a20 2020 2020  01     0.0.     
+00009ea0: 2020 2032 3031 372d 3031 2d30 3220 2020     2017-01-02   
+00009eb0: 2020 312e 300a 2020 2020 2020 2020 3230    1.0.        20
+00009ec0: 3137 2d30 312d 3033 2020 2020 2033 2e30  17-01-03     3.0
+00009ed0: 0a20 2020 2020 2020 2032 3031 372d 3031  .        2017-01
+00009ee0: 2d30 3420 2020 2020 352e 300a 2020 2020  -04     5.0.    
+00009ef0: 2020 2020 3230 3137 2d30 312d 3035 2020      2017-01-05  
+00009f00: 2020 2037 2e30 0a20 2020 2020 2020 2032     7.0.        2
+00009f10: 3031 372d 3031 2d30 3620 2020 2020 392e  017-01-06     9.
+00009f20: 300a 2020 2020 2020 2020 3230 3137 2d30  0.        2017-0
+00009f30: 312d 3037 2020 2020 3131 2e30 0a20 2020  1-07    11.0.   
+00009f40: 2020 2020 2032 3031 372d 3031 2d30 3820       2017-01-08 
+00009f50: 2020 2031 332e 300a 2020 2020 2020 2020     13.0.        
+00009f60: 3230 3137 2d30 312d 3039 2020 2020 3135  2017-01-09    15
+00009f70: 2e30 0a20 2020 2020 2020 2032 3031 372d  .0.        2017-
+00009f80: 3031 2d31 3020 2020 2031 372e 300a 2020  01-10    17.0.  
+00009f90: 2020 2020 2020 4672 6571 3a20 442c 2064        Freq: D, d
+00009fa0: 7479 7065 3a20 666c 6f61 7436 340a 2020  type: float64.  
+00009fb0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00009fc0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
+00009fd0: 6672 616d 652e 726f 6c6c 696e 6720 696d  frame.rolling im
+00009fe0: 706f 7274 206d 6170 5f6f 7665 726c 6170  port map_overlap
+00009ff0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000a000: 206d 6170 5f6f 7665 726c 6170 2866 756e   map_overlap(fun
+0000a010: 632c 2073 656c 662c 2062 6566 6f72 652c  c, self, before,
+0000a020: 2061 6674 6572 2c20 2a61 7267 732c 202a   after, *args, *
+0000a030: 2a6b 7761 7267 7329 0a0a 2020 2020 6465  *kwargs)..    de
+0000a040: 6620 6d65 6d6f 7279 5f75 7361 6765 5f70  f memory_usage_p
+0000a050: 6572 5f70 6172 7469 7469 6f6e 2873 656c  er_partition(sel
+0000a060: 662c 2069 6e64 6578 3d54 7275 652c 2064  f, index=True, d
+0000a070: 6565 703d 4661 6c73 6529 3a0a 2020 2020  eep=False):.    
+0000a080: 2020 2020 2222 2252 6574 7572 6e20 7468      """Return th
+0000a090: 6520 6d65 6d6f 7279 2075 7361 6765 206f  e memory usage o
+0000a0a0: 6620 6561 6368 2070 6172 7469 7469 6f6e  f each partition
+0000a0b0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0000a0c0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+0000a0d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000a0e0: 696e 6465 7820 3a20 626f 6f6c 2c20 6465  index : bool, de
+0000a0f0: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
+0000a100: 2020 2020 2020 2053 7065 6369 6669 6573         Specifies
+0000a110: 2077 6865 7468 6572 2074 6f20 696e 636c   whether to incl
+0000a120: 7564 6520 7468 6520 6d65 6d6f 7279 2075  ude the memory u
+0000a130: 7361 6765 206f 6620 7468 6520 696e 6465  sage of the inde
+0000a140: 7820 696e 0a20 2020 2020 2020 2020 2020  x in.           
+0000a150: 2072 6574 7572 6e65 6420 5365 7269 6573   returned Series
+0000a160: 2e0a 2020 2020 2020 2020 6465 6570 203a  ..        deep :
+0000a170: 2062 6f6f 6c2c 2064 6566 6175 6c74 2046   bool, default F
+0000a180: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+0000a190: 2049 6620 5472 7565 2c20 696e 7472 6f73   If True, intros
+0000a1a0: 7065 6374 2074 6865 2064 6174 6120 6465  pect the data de
+0000a1b0: 6570 6c79 2062 7920 696e 7465 7272 6f67  eply by interrog
+0000a1c0: 6174 696e 670a 2020 2020 2020 2020 2020  ating.          
+0000a1d0: 2020 6060 6f62 6a65 6374 6060 2064 7479    ``object`` dty
+0000a1e0: 7065 7320 666f 7220 7379 7374 656d 2d6c  pes for system-l
+0000a1f0: 6576 656c 206d 656d 6f72 7920 636f 6e73  evel memory cons
+0000a200: 756d 7074 696f 6e2c 2061 6e64 2069 6e63  umption, and inc
+0000a210: 6c75 6465 0a20 2020 2020 2020 2020 2020  lude.           
+0000a220: 2069 7420 696e 2074 6865 2072 6574 7572   it in the retur
+0000a230: 6e65 6420 7661 6c75 6573 2e0a 0a20 2020  ned values...   
+0000a240: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+0000a250: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+0000a260: 2020 2020 2053 6572 6965 730a 2020 2020       Series.    
+0000a270: 2020 2020 2020 2020 4120 5365 7269 6573          A Series
+0000a280: 2077 686f 7365 2069 6e64 6578 2069 7320   whose index is 
+0000a290: 7468 6520 7061 7274 6974 696f 6e20 6e75  the partition nu
+0000a2a0: 6d62 6572 2061 6e64 2077 686f 7365 2076  mber and whose v
+0000a2b0: 616c 7565 730a 2020 2020 2020 2020 2020  alues.          
+0000a2c0: 2020 6172 6520 7468 6520 6d65 6d6f 7279    are the memory
+0000a2d0: 2075 7361 6765 206f 6620 6561 6368 2070   usage of each p
+0000a2e0: 6172 7469 7469 6f6e 2069 6e20 6279 7465  artition in byte
+0000a2f0: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
+0000a300: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000a310: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+0000a320: 7328 0a20 2020 2020 2020 2020 2020 2074  s(.            t
+0000a330: 6f74 616c 5f6d 656d 5f75 7361 6765 2c20  otal_mem_usage, 
+0000a340: 696e 6465 783d 696e 6465 782c 2064 6565  index=index, dee
+0000a350: 703d 6465 6570 0a20 2020 2020 2020 2029  p=deep.        )
+0000a360: 2e63 6c65 6172 5f64 6976 6973 696f 6e73  .clear_divisions
+0000a370: 2829 0a0a 2020 2020 4069 6e73 6572 745f  ()..    @insert_
+0000a380: 6d65 7461 5f70 6172 616d 5f64 6573 6372  meta_param_descr
+0000a390: 6970 7469 6f6e 2870 6164 3d31 3229 0a20  iption(pad=12). 
+0000a3a0: 2020 2064 6566 2072 6564 7563 7469 6f6e     def reduction
+0000a3b0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0000a3c0: 2020 2020 2020 2020 6368 756e 6b2c 0a20          chunk,. 
+0000a3d0: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
+0000a3e0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2063  =None,.        c
+0000a3f0: 6f6d 6269 6e65 3d4e 6f6e 652c 0a20 2020  ombine=None,.   
+0000a400: 2020 2020 206d 6574 613d 6e6f 5f64 6566       meta=no_def
+0000a410: 6175 6c74 2c0a 2020 2020 2020 2020 746f  ault,.        to
+0000a420: 6b65 6e3d 4e6f 6e65 2c0a 2020 2020 2020  ken=None,.      
+0000a430: 2020 7370 6c69 745f 6576 6572 793d 4e6f    split_every=No
+0000a440: 6e65 2c0a 2020 2020 2020 2020 6368 756e  ne,.        chun
+0000a450: 6b5f 6b77 6172 6773 3d4e 6f6e 652c 0a20  k_kwargs=None,. 
+0000a460: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
+0000a470: 5f6b 7761 7267 733d 4e6f 6e65 2c0a 2020  _kwargs=None,.  
+0000a480: 2020 2020 2020 636f 6d62 696e 655f 6b77        combine_kw
+0000a490: 6172 6773 3d4e 6f6e 652c 0a20 2020 2020  args=None,.     
+0000a4a0: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
+0000a4b0: 2029 3a0a 2020 2020 2020 2020 2222 2247   ):.        """G
+0000a4c0: 656e 6572 6963 2072 6f77 2d77 6973 6520  eneric row-wise 
+0000a4d0: 7265 6475 6374 696f 6e73 2e0a 0a20 2020  reductions...   
+0000a4e0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+0000a4f0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000a500: 2d2d 0a20 2020 2020 2020 2063 6875 6e6b  --.        chunk
+0000a510: 203a 2063 616c 6c61 626c 650a 2020 2020   : callable.    
 0000a520: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
-0000a530: 2074 6f20 6f70 6572 6174 6520 6f6e 2074   to operate on t
-0000a540: 6865 2063 6f6e 6361 7465 6e61 7465 6420  he concatenated 
-0000a550: 7265 7375 6c74 206f 6620 6060 6368 756e  result of ``chun
-0000a560: 6b60 602e 2049 6620 6e6f 740a 2020 2020  k``. If not.    
-0000a570: 2020 2020 2020 2020 7370 6563 6966 6965          specifie
-0000a580: 642c 2064 6566 6175 6c74 7320 746f 2060  d, defaults to `
-0000a590: 6063 6875 6e6b 6060 2e20 5573 6564 2074  `chunk``. Used t
-0000a5a0: 6f20 646f 2074 6865 2066 696e 616c 2061  o do the final a
-0000a5b0: 6767 7265 6761 7469 6f6e 0a20 2020 2020  ggregation.     
-0000a5c0: 2020 2020 2020 2069 6e20 6120 7472 6565         in a tree
-0000a5d0: 2072 6564 7563 7469 6f6e 2e0a 0a20 2020   reduction...   
-0000a5e0: 2020 2020 2020 2020 2054 6865 2069 6e70           The inp
-0000a5f0: 7574 2074 6f20 6060 6167 6772 6567 6174  ut to ``aggregat
-0000a600: 6560 6020 6465 7065 6e64 7320 6f6e 2074  e`` depends on t
-0000a610: 6865 206f 7574 7075 7420 6f66 2060 6063  he output of ``c
-0000a620: 6875 6e6b 6060 2e0a 2020 2020 2020 2020  hunk``..        
-0000a630: 2020 2020 4966 2074 6865 206f 7574 7075      If the outpu
-0000a640: 7420 6f66 2060 6063 6875 6e6b 6060 2069  t of ``chunk`` i
-0000a650: 7320 613a 0a0a 2020 2020 2020 2020 2020  s a:..          
-0000a660: 2020 2d20 7363 616c 6172 3a20 496e 7075    - scalar: Inpu
-0000a670: 7420 6973 2061 2053 6572 6965 732c 2077  t is a Series, w
-0000a680: 6974 6820 6f6e 6520 726f 7720 7065 7220  ith one row per 
-0000a690: 7061 7274 6974 696f 6e2e 0a20 2020 2020  partition..     
-0000a6a0: 2020 2020 2020 202d 2053 6572 6965 733a         - Series:
-0000a6b0: 2049 6e70 7574 2069 7320 6120 4461 7461   Input is a Data
-0000a6c0: 4672 616d 652c 2077 6974 6820 6f6e 6520  Frame, with one 
-0000a6d0: 726f 7720 7065 7220 7061 7274 6974 696f  row per partitio
-0000a6e0: 6e2e 2043 6f6c 756d 6e73 0a20 2020 2020  n. Columns.     
-0000a6f0: 2020 2020 2020 2020 2061 7265 2074 6865           are the
-0000a700: 2072 6f77 7320 696e 2074 6865 206f 7574   rows in the out
-0000a710: 7075 7420 7365 7269 6573 2e0a 2020 2020  put series..    
-0000a720: 2020 2020 2020 2020 2d20 4461 7461 4672          - DataFr
-0000a730: 616d 653a 2049 6e70 7574 2069 7320 6120  ame: Input is a 
-0000a740: 4461 7461 4672 616d 652c 2077 6974 6820  DataFrame, with 
-0000a750: 6f6e 6520 726f 7720 7065 7220 7061 7274  one row per part
-0000a760: 6974 696f 6e2e 0a20 2020 2020 2020 2020  ition..         
-0000a770: 2020 2020 2043 6f6c 756d 6e73 2061 7265       Columns are
-0000a780: 2074 6865 2063 6f6c 756d 6e73 2069 6e20   the columns in 
-0000a790: 7468 6520 6f75 7470 7574 2064 6174 6166  the output dataf
-0000a7a0: 7261 6d65 732e 0a0a 2020 2020 2020 2020  rames...        
-0000a7b0: 2020 2020 5368 6f75 6c64 2072 6574 7572      Should retur
-0000a7c0: 6e20 6120 6060 7061 6e64 6173 2e44 6174  n a ``pandas.Dat
-0000a7d0: 6146 7261 6d65 6060 2c20 6060 7061 6e64  aFrame``, ``pand
-0000a7e0: 6173 2e53 6572 6965 7360 602c 206f 7220  as.Series``, or 
-0000a7f0: 610a 2020 2020 2020 2020 2020 2020 7363  a.            sc
-0000a800: 616c 6172 2e0a 2020 2020 2020 2020 636f  alar..        co
-0000a810: 6d62 696e 6520 3a20 6361 6c6c 6162 6c65  mbine : callable
-0000a820: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-0000a830: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
-0000a840: 746f 206f 7065 7261 7465 206f 6e20 696e  to operate on in
-0000a850: 7465 726d 6564 6961 7465 2063 6f6e 6361  termediate conca
-0000a860: 7465 6e61 7465 6420 7265 7375 6c74 7320  tenated results 
-0000a870: 6f66 0a20 2020 2020 2020 2020 2020 2060  of.            `
-0000a880: 6063 6875 6e6b 6060 2069 6e20 6120 7472  `chunk`` in a tr
-0000a890: 6565 2d72 6564 7563 7469 6f6e 2e20 4966  ee-reduction. If
-0000a8a0: 206e 6f74 2070 726f 7669 6465 642c 2064   not provided, d
-0000a8b0: 6566 6175 6c74 7320 746f 0a20 2020 2020  efaults to.     
-0000a8c0: 2020 2020 2020 2060 6061 6767 7265 6761         ``aggrega
-0000a8d0: 7465 6060 2e20 5468 6520 696e 7075 742f  te``. The input/
-0000a8e0: 6f75 7470 7574 2072 6571 7569 7265 6d65  output requireme
-0000a8f0: 6e74 7320 7368 6f75 6c64 206d 6174 6368  nts should match
-0000a900: 2074 6861 7420 6f66 0a20 2020 2020 2020   that of.       
-0000a910: 2020 2020 2060 6061 6767 7265 6761 7465       ``aggregate
-0000a920: 6060 2064 6573 6372 6962 6564 2061 626f  `` described abo
-0000a930: 7665 2e0a 2020 2020 2020 2020 244d 4554  ve..        $MET
-0000a940: 410a 2020 2020 2020 2020 746f 6b65 6e20  A.        token 
-0000a950: 3a20 7374 722c 206f 7074 696f 6e61 6c0a  : str, optional.
-0000a960: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-0000a970: 6e61 6d65 2074 6f20 7573 6520 666f 7220  name to use for 
-0000a980: 7468 6520 6f75 7470 7574 206b 6579 732e  the output keys.
-0000a990: 0a20 2020 2020 2020 2073 706c 6974 5f65  .        split_e
-0000a9a0: 7665 7279 203a 2069 6e74 2c20 6f70 7469  very : int, opti
-0000a9b0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-0000a9c0: 2047 726f 7570 2070 6172 7469 7469 6f6e   Group partition
-0000a9d0: 7320 696e 746f 2067 726f 7570 7320 6f66  s into groups of
-0000a9e0: 2074 6869 7320 7369 7a65 2077 6869 6c65   this size while
-0000a9f0: 2070 6572 666f 726d 696e 6720 610a 2020   performing a.  
-0000aa00: 2020 2020 2020 2020 2020 7472 6565 2d72            tree-r
-0000aa10: 6564 7563 7469 6f6e 2e20 4966 2073 6574  eduction. If set
-0000aa20: 2074 6f20 4661 6c73 652c 206e 6f20 7472   to False, no tr
-0000aa30: 6565 2d72 6564 7563 7469 6f6e 2077 696c  ee-reduction wil
-0000aa40: 6c20 6265 2075 7365 642c 0a20 2020 2020  l be used,.     
-0000aa50: 2020 2020 2020 2061 6e64 2061 6c6c 2069         and all i
-0000aa60: 6e74 6572 6d65 6469 6174 6573 2077 696c  ntermediates wil
-0000aa70: 6c20 6265 2063 6f6e 6361 7465 6e61 7465  l be concatenate
-0000aa80: 6420 616e 6420 7061 7373 6564 2074 6f0a  d and passed to.
-0000aa90: 2020 2020 2020 2020 2020 2020 6060 6167              ``ag
-0000aaa0: 6772 6567 6174 6560 602e 2044 6566 6175  gregate``. Defau
-0000aab0: 6c74 2069 7320 382e 0a20 2020 2020 2020  lt is 8..       
-0000aac0: 2063 6875 6e6b 5f6b 7761 7267 7320 3a20   chunk_kwargs : 
-0000aad0: 6469 6374 2c20 6f70 7469 6f6e 616c 0a20  dict, optional. 
-0000aae0: 2020 2020 2020 2020 2020 204b 6579 776f             Keywo
-0000aaf0: 7264 2061 7267 756d 656e 7473 2074 6f20  rd arguments to 
-0000ab00: 7061 7373 206f 6e20 746f 2060 6063 6875  pass on to ``chu
-0000ab10: 6e6b 6060 206f 6e6c 792e 0a20 2020 2020  nk`` only..     
-0000ab20: 2020 2061 6767 7265 6761 7465 5f6b 7761     aggregate_kwa
-0000ab30: 7267 7320 3a20 6469 6374 2c20 6f70 7469  rgs : dict, opti
-0000ab40: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-0000ab50: 204b 6579 776f 7264 2061 7267 756d 656e   Keyword argumen
-0000ab60: 7473 2074 6f20 7061 7373 206f 6e20 746f  ts to pass on to
-0000ab70: 2060 6061 6767 7265 6761 7465 6060 206f   ``aggregate`` o
-0000ab80: 6e6c 792e 0a20 2020 2020 2020 2063 6f6d  nly..        com
-0000ab90: 6269 6e65 5f6b 7761 7267 7320 3a20 6469  bine_kwargs : di
-0000aba0: 6374 2c20 6f70 7469 6f6e 616c 0a20 2020  ct, optional.   
-0000abb0: 2020 2020 2020 2020 204b 6579 776f 7264           Keyword
-0000abc0: 2061 7267 756d 656e 7473 2074 6f20 7061   arguments to pa
-0000abd0: 7373 206f 6e20 746f 2060 6063 6f6d 6269  ss on to ``combi
-0000abe0: 6e65 6060 206f 6e6c 792e 0a20 2020 2020  ne`` only..     
-0000abf0: 2020 206b 7761 7267 7320 3a0a 2020 2020     kwargs :.    
-0000ac00: 2020 2020 2020 2020 416c 6c20 7265 6d61          All rema
-0000ac10: 696e 696e 6720 6b65 7977 6f72 6473 2077  ining keywords w
-0000ac20: 696c 6c20 6265 2070 6173 7365 6420 746f  ill be passed to
-0000ac30: 2060 6063 6875 6e6b 6060 2c20 6060 636f   ``chunk``, ``co
-0000ac40: 6d62 696e 6560 602c 0a20 2020 2020 2020  mbine``,.       
-0000ac50: 2020 2020 2061 6e64 2060 6061 6767 7265       and ``aggre
-0000ac60: 6761 7465 6060 2e0a 0a20 2020 2020 2020  gate``...       
-0000ac70: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
-0000ac80: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-0000ac90: 2020 203e 3e3e 2069 6d70 6f72 7420 7061     >>> import pa
-0000aca0: 6e64 6173 2061 7320 7064 0a20 2020 2020  ndas as pd.     
-0000acb0: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-0000acc0: 736b 2e64 6174 6166 7261 6d65 2061 7320  sk.dataframe as 
-0000acd0: 6464 0a20 2020 2020 2020 203e 3e3e 2064  dd.        >>> d
-0000ace0: 6620 3d20 7064 2e44 6174 6146 7261 6d65  f = pd.DataFrame
-0000acf0: 287b 2778 273a 2072 616e 6765 2835 3029  ({'x': range(50)
-0000ad00: 2c20 2779 273a 2072 616e 6765 2835 302c  , 'y': range(50,
-0000ad10: 2031 3030 297d 290a 2020 2020 2020 2020   100)}).        
-0000ad20: 3e3e 3e20 6464 6620 3d20 6464 2e66 726f  >>> ddf = dd.fro
-0000ad30: 6d5f 7061 6e64 6173 2864 662c 206e 7061  m_pandas(df, npa
-0000ad40: 7274 6974 696f 6e73 3d34 290a 0a20 2020  rtitions=4)..   
-0000ad50: 2020 2020 2043 6f75 6e74 2074 6865 206e       Count the n
-0000ad60: 756d 6265 7220 6f66 2072 6f77 7320 696e  umber of rows in
-0000ad70: 2061 2044 6174 6146 7261 6d65 2e20 546f   a DataFrame. To
-0000ad80: 2064 6f20 7468 6973 2c20 636f 756e 7420   do this, count 
-0000ad90: 7468 6520 6e75 6d62 6572 0a20 2020 2020  the number.     
-0000ada0: 2020 206f 6620 726f 7773 2069 6e20 6561     of rows in ea
-0000adb0: 6368 2070 6172 7469 7469 6f6e 2c20 7468  ch partition, th
-0000adc0: 656e 2073 756d 2074 6865 2072 6573 756c  en sum the resul
-0000add0: 7473 3a0a 0a20 2020 2020 2020 203e 3e3e  ts:..        >>>
-0000ade0: 2072 6573 203d 2064 6466 2e72 6564 7563   res = ddf.reduc
-0000adf0: 7469 6f6e 286c 616d 6264 6120 783a 2078  tion(lambda x: x
-0000ae00: 2e63 6f75 6e74 2829 2c0a 2020 2020 2020  .count(),.      
-0000ae10: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
-0000ae20: 2020 2020 2020 2020 2020 6167 6772 6567            aggreg
-0000ae30: 6174 653d 6c61 6d62 6461 2078 3a20 782e  ate=lambda x: x.
-0000ae40: 7375 6d28 2929 0a20 2020 2020 2020 203e  sum()).        >
-0000ae50: 3e3e 2072 6573 2e63 6f6d 7075 7465 2829  >> res.compute()
-0000ae60: 0a20 2020 2020 2020 2078 2020 2020 3530  .        x    50
-0000ae70: 0a20 2020 2020 2020 2079 2020 2020 3530  .        y    50
-0000ae80: 0a20 2020 2020 2020 2064 7479 7065 3a20  .        dtype: 
-0000ae90: 696e 7436 340a 0a20 2020 2020 2020 2043  int64..        C
-0000aea0: 6f75 6e74 2074 6865 206e 756d 6265 7220  ount the number 
-0000aeb0: 6f66 2072 6f77 7320 696e 2061 2053 6572  of rows in a Ser
-0000aec0: 6965 7320 7769 7468 2065 6c65 6d65 6e74  ies with element
-0000aed0: 7320 6772 6561 7465 7220 7468 616e 206f  s greater than o
-0000aee0: 720a 2020 2020 2020 2020 6571 7561 6c20  r.        equal 
-0000aef0: 746f 2061 2076 616c 7565 2028 7072 6f76  to a value (prov
-0000af00: 6964 6564 2076 6961 2061 206b 6579 776f  ided via a keywo
-0000af10: 7264 292e 0a0a 2020 2020 2020 2020 3e3e  rd)...        >>
-0000af20: 3e20 6465 6620 636f 756e 745f 6772 6561  > def count_grea
-0000af30: 7465 7228 782c 2076 616c 7565 3d30 293a  ter(x, value=0):
-0000af40: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0000af50: 2072 6574 7572 6e20 2878 203e 3d20 7661   return (x >= va
-0000af60: 6c75 6529 2e73 756d 2829 0a20 2020 2020  lue).sum().     
-0000af70: 2020 203e 3e3e 2072 6573 203d 2064 6466     >>> res = ddf
-0000af80: 2e78 2e72 6564 7563 7469 6f6e 2863 6f75  .x.reduction(cou
-0000af90: 6e74 5f67 7265 6174 6572 2c20 6167 6772  nt_greater, aggr
-0000afa0: 6567 6174 653d 6c61 6d62 6461 2078 3a20  egate=lambda x: 
-0000afb0: 782e 7375 6d28 292c 0a20 2020 2020 2020  x.sum(),.       
-0000afc0: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
-0000afd0: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
-0000afe0: 5f6b 7761 7267 733d 7b27 7661 6c75 6527  _kwargs={'value'
-0000aff0: 3a20 3235 7d29 0a20 2020 2020 2020 203e  : 25}).        >
-0000b000: 3e3e 2072 6573 2e63 6f6d 7075 7465 2829  >> res.compute()
-0000b010: 0a20 2020 2020 2020 2032 350a 0a20 2020  .        25..   
-0000b020: 2020 2020 2041 6767 7265 6761 7465 2062       Aggregate b
-0000b030: 6f74 6820 7468 6520 7375 6d20 616e 6420  oth the sum and 
-0000b040: 636f 756e 7420 6f66 2061 2053 6572 6965  count of a Serie
-0000b050: 7320 6174 2074 6865 2073 616d 6520 7469  s at the same ti
-0000b060: 6d65 3a0a 0a20 2020 2020 2020 203e 3e3e  me:..        >>>
-0000b070: 2064 6566 2073 756d 5f61 6e64 5f63 6f75   def sum_and_cou
-0000b080: 6e74 2878 293a 0a20 2020 2020 2020 202e  nt(x):.        .
-0000b090: 2e2e 2020 2020 2072 6574 7572 6e20 7064  ..     return pd
-0000b0a0: 2e53 6572 6965 7328 7b27 636f 756e 7427  .Series({'count'
-0000b0b0: 3a20 782e 636f 756e 7428 292c 2027 7375  : x.count(), 'su
-0000b0c0: 6d27 3a20 782e 7375 6d28 297d 2c0a 2020  m': x.sum()},.  
-0000b0d0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-0000b0e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000b0f0: 6e64 6578 3d5b 2763 6f75 6e74 272c 2027  ndex=['count', '
-0000b100: 7375 6d27 5d29 0a20 2020 2020 2020 203e  sum']).        >
-0000b110: 3e3e 2072 6573 203d 2064 6466 2e78 2e72  >> res = ddf.x.r
-0000b120: 6564 7563 7469 6f6e 2873 756d 5f61 6e64  eduction(sum_and
-0000b130: 5f63 6f75 6e74 2c20 6167 6772 6567 6174  _count, aggregat
-0000b140: 653d 6c61 6d62 6461 2078 3a20 782e 7375  e=lambda x: x.su
-0000b150: 6d28 2929 0a20 2020 2020 2020 203e 3e3e  m()).        >>>
-0000b160: 2072 6573 2e63 6f6d 7075 7465 2829 0a20   res.compute(). 
-0000b170: 2020 2020 2020 2063 6f75 6e74 2020 2020         count    
-0000b180: 2020 3530 0a20 2020 2020 2020 2073 756d    50.        sum
-0000b190: 2020 2020 2020 3132 3235 0a20 2020 2020        1225.     
-0000b1a0: 2020 2064 7479 7065 3a20 696e 7436 340a     dtype: int64.
-0000b1b0: 0a20 2020 2020 2020 2044 6f69 6e67 2074  .        Doing t
-0000b1c0: 6865 2073 616d 652c 2062 7574 2066 6f72  he same, but for
-0000b1d0: 2061 2044 6174 6146 7261 6d65 2e20 4865   a DataFrame. He
-0000b1e0: 7265 2060 6063 6875 6e6b 6060 2072 6574  re ``chunk`` ret
-0000b1f0: 7572 6e73 2061 0a20 2020 2020 2020 2044  urns a.        D
-0000b200: 6174 6146 7261 6d65 2c20 6d65 616e 696e  ataFrame, meanin
-0000b210: 6720 7468 6520 696e 7075 7420 746f 2060  g the input to `
-0000b220: 6061 6767 7265 6761 7465 6060 2069 7320  `aggregate`` is 
-0000b230: 6120 4461 7461 4672 616d 6520 7769 7468  a DataFrame with
-0000b240: 2061 6e0a 2020 2020 2020 2020 696e 6465   an.        inde
-0000b250: 7820 7769 7468 206e 6f6e 2d75 6e69 7175  x with non-uniqu
-0000b260: 6520 656e 7472 6965 7320 666f 7220 626f  e entries for bo
-0000b270: 7468 2027 7827 2061 6e64 2027 7927 2e20  th 'x' and 'y'. 
-0000b280: 5765 2067 726f 7570 6279 2074 6865 0a20  We groupby the. 
-0000b290: 2020 2020 2020 2069 6e64 6578 2c20 616e         index, an
-0000b2a0: 6420 7375 6d20 6561 6368 2067 726f 7570  d sum each group
-0000b2b0: 2074 6f20 6765 7420 7468 6520 6669 6e61   to get the fina
-0000b2c0: 6c20 7265 7375 6c74 2e0a 0a20 2020 2020  l result...     
-0000b2d0: 2020 203e 3e3e 2064 6566 2073 756d 5f61     >>> def sum_a
-0000b2e0: 6e64 5f63 6f75 6e74 2878 293a 0a20 2020  nd_count(x):.   
-0000b2f0: 2020 2020 202e 2e2e 2020 2020 2072 6574       ...     ret
-0000b300: 7572 6e20 7064 2e44 6174 6146 7261 6d65  urn pd.DataFrame
-0000b310: 287b 2763 6f75 6e74 273a 2078 2e63 6f75  ({'count': x.cou
-0000b320: 6e74 2829 2c20 2773 756d 273a 2078 2e73  nt(), 'sum': x.s
-0000b330: 756d 2829 7d2c 0a20 2020 2020 2020 202e  um()},.        .
-0000b340: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
-0000b350: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-0000b360: 6e73 3d5b 2763 6f75 6e74 272c 2027 7375  ns=['count', 'su
-0000b370: 6d27 5d29 0a20 2020 2020 2020 203e 3e3e  m']).        >>>
-0000b380: 2072 6573 203d 2064 6466 2e72 6564 7563   res = ddf.reduc
-0000b390: 7469 6f6e 2873 756d 5f61 6e64 5f63 6f75  tion(sum_and_cou
-0000b3a0: 6e74 2c0a 2020 2020 2020 2020 2e2e 2e20  nt,.        ... 
-0000b3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b3c0: 2020 2020 6167 6772 6567 6174 653d 6c61      aggregate=la
-0000b3d0: 6d62 6461 2078 3a20 782e 6772 6f75 7062  mbda x: x.groupb
-0000b3e0: 7928 6c65 7665 6c3d 3029 2e73 756d 2829  y(level=0).sum()
-0000b3f0: 290a 2020 2020 2020 2020 3e3e 3e20 7265  ).        >>> re
-0000b400: 732e 636f 6d70 7574 6528 290a 2020 2020  s.compute().    
-0000b410: 2020 2020 2020 2063 6f75 6e74 2020 2073         count   s
-0000b420: 756d 0a20 2020 2020 2020 2078 2020 2020  um.        x    
-0000b430: 2035 3020 2031 3232 350a 2020 2020 2020   50  1225.      
-0000b440: 2020 7920 2020 2020 3530 2020 3337 3235    y     50  3725
-0000b450: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000b460: 2020 2020 2069 6620 6167 6772 6567 6174       if aggregat
-0000b470: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-0000b480: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
-0000b490: 203d 2063 6875 6e6b 0a0a 2020 2020 2020   = chunk..      
-0000b4a0: 2020 6966 2063 6f6d 6269 6e65 2069 7320    if combine is 
-0000b4b0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0000b4c0: 2020 6966 2063 6f6d 6269 6e65 5f6b 7761    if combine_kwa
-0000b4d0: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
-0000b4e0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0000b4f0: 4572 726f 7228 2260 636f 6d62 696e 655f  Error("`combine_
-0000b500: 6b77 6172 6773 6020 7072 6f76 6964 6564  kwargs` provided
-0000b510: 2077 6974 6820 6e6f 2060 636f 6d62 696e   with no `combin
-0000b520: 6560 2229 0a20 2020 2020 2020 2020 2020  e`").           
-0000b530: 2063 6f6d 6269 6e65 203d 2061 6767 7265   combine = aggre
-0000b540: 6761 7465 0a20 2020 2020 2020 2020 2020  gate.           
-0000b550: 2063 6f6d 6269 6e65 5f6b 7761 7267 7320   combine_kwargs 
-0000b560: 3d20 6167 6772 6567 6174 655f 6b77 6172  = aggregate_kwar
-0000b570: 6773 0a0a 2020 2020 2020 2020 6368 756e  gs..        chun
-0000b580: 6b5f 6b77 6172 6773 203d 2063 6875 6e6b  k_kwargs = chunk
-0000b590: 5f6b 7761 7267 732e 636f 7079 2829 2069  _kwargs.copy() i
-0000b5a0: 6620 6368 756e 6b5f 6b77 6172 6773 2065  f chunk_kwargs e
-0000b5b0: 6c73 6520 7b7d 0a20 2020 2020 2020 2063  lse {}.        c
-0000b5c0: 6875 6e6b 5f6b 7761 7267 735b 2261 6361  hunk_kwargs["aca
-0000b5d0: 5f63 6875 6e6b 225d 203d 2063 6875 6e6b  _chunk"] = chunk
-0000b5e0: 0a0a 2020 2020 2020 2020 636f 6d62 696e  ..        combin
-0000b5f0: 655f 6b77 6172 6773 203d 2063 6f6d 6269  e_kwargs = combi
-0000b600: 6e65 5f6b 7761 7267 732e 636f 7079 2829  ne_kwargs.copy()
-0000b610: 2069 6620 636f 6d62 696e 655f 6b77 6172   if combine_kwar
-0000b620: 6773 2065 6c73 6520 7b7d 0a20 2020 2020  gs else {}.     
-0000b630: 2020 2063 6f6d 6269 6e65 5f6b 7761 7267     combine_kwarg
-0000b640: 735b 2261 6361 5f63 6f6d 6269 6e65 225d  s["aca_combine"]
-0000b650: 203d 2063 6f6d 6269 6e65 0a0a 2020 2020   = combine..    
-0000b660: 2020 2020 6167 6772 6567 6174 655f 6b77      aggregate_kw
-0000b670: 6172 6773 203d 2061 6767 7265 6761 7465  args = aggregate
-0000b680: 5f6b 7761 7267 732e 636f 7079 2829 2069  _kwargs.copy() i
-0000b690: 6620 6167 6772 6567 6174 655f 6b77 6172  f aggregate_kwar
-0000b6a0: 6773 2065 6c73 6520 7b7d 0a20 2020 2020  gs else {}.     
-0000b6b0: 2020 2061 6767 7265 6761 7465 5f6b 7761     aggregate_kwa
-0000b6c0: 7267 735b 2261 6361 5f61 6767 7265 6761  rgs["aca_aggrega
-0000b6d0: 7465 225d 203d 2061 6767 7265 6761 7465  te"] = aggregate
-0000b6e0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0000b6f0: 2061 6361 280a 2020 2020 2020 2020 2020   aca(.          
-0000b700: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0000b710: 2020 2020 6368 756e 6b3d 5f72 6564 7563      chunk=_reduc
-0000b720: 7469 6f6e 5f63 6875 6e6b 2c0a 2020 2020  tion_chunk,.    
-0000b730: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-0000b740: 653d 5f72 6564 7563 7469 6f6e 5f61 6767  e=_reduction_agg
-0000b750: 7265 6761 7465 2c0a 2020 2020 2020 2020  regate,.        
-0000b760: 2020 2020 636f 6d62 696e 653d 5f72 6564      combine=_red
-0000b770: 7563 7469 6f6e 5f63 6f6d 6269 6e65 2c0a  uction_combine,.
-0000b780: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-0000b790: 3d6d 6574 612c 0a20 2020 2020 2020 2020  =meta,.         
-0000b7a0: 2020 2074 6f6b 656e 3d74 6f6b 656e 2c0a     token=token,.
-0000b7b0: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
-0000b7c0: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
-0000b7d0: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
-0000b7e0: 2063 6875 6e6b 5f6b 7761 7267 733d 6368   chunk_kwargs=ch
-0000b7f0: 756e 6b5f 6b77 6172 6773 2c0a 2020 2020  unk_kwargs,.    
-0000b800: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-0000b810: 655f 6b77 6172 6773 3d61 6767 7265 6761  e_kwargs=aggrega
-0000b820: 7465 5f6b 7761 7267 732c 0a20 2020 2020  te_kwargs,.     
-0000b830: 2020 2020 2020 2063 6f6d 6269 6e65 5f6b         combine_k
-0000b840: 7761 7267 733d 636f 6d62 696e 655f 6b77  wargs=combine_kw
-0000b850: 6172 6773 2c0a 2020 2020 2020 2020 2020  args,.          
-0000b860: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
-0000b870: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
-0000b880: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-0000b890: 4672 616d 6529 0a20 2020 2064 6566 2070  Frame).    def p
-0000b8a0: 6970 6528 7365 6c66 2c20 6675 6e63 2c20  ipe(self, func, 
-0000b8b0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-0000b8c0: 3a0a 2020 2020 2020 2020 2320 5461 6b65  :.        # Take
-0000b8d0: 6e20 6672 6f6d 2070 616e 6461 733a 0a20  n from pandas:. 
-0000b8e0: 2020 2020 2020 2023 2068 7474 7073 3a2f         # https:/
-0000b8f0: 2f67 6974 6875 622e 636f 6d2f 7079 6461  /github.com/pyda
-0000b900: 7461 2f70 616e 6461 732f 626c 6f62 2f6d  ta/pandas/blob/m
-0000b910: 6173 7465 722f 7061 6e64 6173 2f63 6f72  aster/pandas/cor
-0000b920: 652f 6765 6e65 7269 632e 7079 234c 3236  e/generic.py#L26
-0000b930: 3938 2d4c 3237 3037 0a20 2020 2020 2020  98-L2707.       
-0000b940: 2069 6620 6973 696e 7374 616e 6365 2866   if isinstance(f
-0000b950: 756e 632c 2074 7570 6c65 293a 0a20 2020  unc, tuple):.   
-0000b960: 2020 2020 2020 2020 2066 756e 632c 2074           func, t
-0000b970: 6172 6765 7420 3d20 6675 6e63 0a20 2020  arget = func.   
-0000b980: 2020 2020 2020 2020 2069 6620 7461 7267           if targ
-0000b990: 6574 2069 6e20 6b77 6172 6773 3a0a 2020  et in kwargs:.  
-0000b9a0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0000b9b0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-0000b9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b9d0: 2020 2020 2225 7320 6973 2062 6f74 6820      "%s is both 
-0000b9e0: 7468 6520 7069 7065 2074 6172 6765 7420  the pipe target 
-0000b9f0: 616e 6420 6120 6b65 7977 6f72 6420 6172  and a keyword ar
-0000ba00: 6775 6d65 6e74 2220 2520 7461 7267 6574  gument" % target
-0000ba10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ba20: 2029 0a20 2020 2020 2020 2020 2020 206b   ).            k
-0000ba30: 7761 7267 735b 7461 7267 6574 5d20 3d20  wargs[target] = 
-0000ba40: 7365 6c66 0a20 2020 2020 2020 2020 2020  self.           
-0000ba50: 2072 6574 7572 6e20 6675 6e63 282a 6172   return func(*ar
-0000ba60: 6773 2c20 2a2a 6b77 6172 6773 290a 2020  gs, **kwargs).  
-0000ba70: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000ba80: 2020 2020 2020 2020 7265 7475 726e 2066          return f
-0000ba90: 756e 6328 7365 6c66 2c20 2a61 7267 732c  unc(self, *args,
-0000baa0: 202a 2a6b 7761 7267 7329 0a0a 2020 2020   **kwargs)..    
-0000bab0: 6465 6620 7261 6e64 6f6d 5f73 706c 6974  def random_split
-0000bac0: 2873 656c 662c 2066 7261 632c 2072 616e  (self, frac, ran
-0000bad0: 646f 6d5f 7374 6174 653d 4e6f 6e65 2c20  dom_state=None, 
-0000bae0: 7368 7566 666c 653d 4661 6c73 6529 3a0a  shuffle=False):.
-0000baf0: 2020 2020 2020 2020 2222 2250 7365 7564          """Pseud
-0000bb00: 6f72 616e 646f 6d6c 7920 7370 6c69 7420  orandomly split 
-0000bb10: 6461 7461 6672 616d 6520 696e 746f 2064  dataframe into d
-0000bb20: 6966 6665 7265 6e74 2070 6965 6365 7320  ifferent pieces 
-0000bb30: 726f 772d 7769 7365 0a0a 2020 2020 2020  row-wise..      
-0000bb40: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0000bb50: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-0000bb60: 2020 2020 2020 2020 6672 6163 203a 206c          frac : l
-0000bb70: 6973 740a 2020 2020 2020 2020 2020 2020  ist.            
-0000bb80: 4c69 7374 206f 6620 666c 6f61 7473 2074  List of floats t
-0000bb90: 6861 7420 7368 6f75 6c64 2073 756d 2074  hat should sum t
-0000bba0: 6f20 6f6e 652e 0a20 2020 2020 2020 2072  o one..        r
-0000bbb0: 616e 646f 6d5f 7374 6174 6520 3a20 696e  andom_state : in
-0000bbc0: 7420 6f72 206e 702e 7261 6e64 6f6d 2e52  t or np.random.R
-0000bbd0: 616e 646f 6d53 7461 7465 0a20 2020 2020  andomState.     
-0000bbe0: 2020 2020 2020 2049 6620 696e 7420 6372         If int cr
-0000bbf0: 6561 7465 2061 206e 6577 2052 616e 646f  eate a new Rando
-0000bc00: 6d53 7461 7465 2077 6974 6820 7468 6973  mState with this
-0000bc10: 2061 7320 7468 6520 7365 6564 2e0a 2020   as the seed..  
-0000bc20: 2020 2020 2020 2020 2020 4f74 6865 7277            Otherw
-0000bc30: 6973 6520 6472 6177 2066 726f 6d20 7468  ise draw from th
-0000bc40: 6520 7061 7373 6564 2052 616e 646f 6d53  e passed RandomS
-0000bc50: 7461 7465 2e0a 2020 2020 2020 2020 7368  tate..        sh
-0000bc60: 7566 666c 6520 3a20 626f 6f6c 2c20 6465  uffle : bool, de
-0000bc70: 6661 756c 7420 4661 6c73 650a 2020 2020  fault False.    
-0000bc80: 2020 2020 2020 2020 4966 2073 6574 2074          If set t
-0000bc90: 6f20 5472 7565 2c20 7468 6520 6461 7461  o True, the data
-0000bca0: 6672 616d 6520 6973 2073 6875 6666 6c65  frame is shuffle
-0000bcb0: 6420 2877 6974 6869 6e20 7061 7274 6974  d (within partit
-0000bcc0: 696f 6e29 0a20 2020 2020 2020 2020 2020  ion).           
-0000bcd0: 2062 6566 6f72 6520 7468 6520 7370 6c69   before the spli
-0000bce0: 742e 0a0a 2020 2020 2020 2020 4578 616d  t...        Exam
-0000bcf0: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
-0000bd00: 2d2d 2d2d 2d0a 0a20 2020 2020 2020 2035  -----..        5
-0000bd10: 302f 3530 2073 706c 6974 0a0a 2020 2020  0/50 split..    
-0000bd20: 2020 2020 3e3e 3e20 612c 2062 203d 2064      >>> a, b = d
-0000bd30: 662e 7261 6e64 6f6d 5f73 706c 6974 285b  f.random_split([
-0000bd40: 302e 352c 2030 2e35 5d29 2020 2320 646f  0.5, 0.5])  # do
-0000bd50: 6374 6573 743a 202b 534b 4950 0a0a 2020  ctest: +SKIP..  
-0000bd60: 2020 2020 2020 3830 2f31 302f 3130 2073        80/10/10 s
-0000bd70: 706c 6974 2c20 636f 6e73 6973 7465 6e74  plit, consistent
-0000bd80: 2072 616e 646f 6d5f 7374 6174 650a 0a20   random_state.. 
-0000bd90: 2020 2020 2020 203e 3e3e 2061 2c20 622c         >>> a, b,
-0000bda0: 2063 203d 2064 662e 7261 6e64 6f6d 5f73   c = df.random_s
-0000bdb0: 706c 6974 285b 302e 382c 2030 2e31 2c20  plit([0.8, 0.1, 
-0000bdc0: 302e 315d 2c20 7261 6e64 6f6d 5f73 7461  0.1], random_sta
-0000bdd0: 7465 3d31 3233 2920 2023 2064 6f63 7465  te=123)  # docte
-0000bde0: 7374 3a20 2b53 4b49 500a 0a20 2020 2020  st: +SKIP..     
-0000bdf0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
-0000be00: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-0000be10: 2020 2020 2064 6173 6b2e 4461 7461 4672       dask.DataFr
-0000be20: 616d 652e 7361 6d70 6c65 0a20 2020 2020  ame.sample.     
-0000be30: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-0000be40: 6620 6e6f 7420 6e70 2e61 6c6c 636c 6f73  f not np.allclos
-0000be50: 6528 7375 6d28 6672 6163 292c 2031 293a  e(sum(frac), 1):
-0000be60: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000be70: 7365 2056 616c 7565 4572 726f 7228 2266  se ValueError("f
-0000be80: 7261 6320 7368 6f75 6c64 2073 756d 2074  rac should sum t
-0000be90: 6f20 3122 290a 2020 2020 2020 2020 7374  o 1").        st
-0000bea0: 6174 655f 6461 7461 203d 2072 616e 646f  ate_data = rando
-0000beb0: 6d5f 7374 6174 655f 6461 7461 2873 656c  m_state_data(sel
-0000bec0: 662e 6e70 6172 7469 7469 6f6e 732c 2072  f.npartitions, r
-0000bed0: 616e 646f 6d5f 7374 6174 6529 0a20 2020  andom_state).   
-0000bee0: 2020 2020 2074 6f6b 656e 203d 2074 6f6b       token = tok
-0000bef0: 656e 697a 6528 7365 6c66 2c20 6672 6163  enize(self, frac
-0000bf00: 2c20 7261 6e64 6f6d 5f73 7461 7465 290a  , random_state).
-0000bf10: 2020 2020 2020 2020 6e61 6d65 203d 2022          name = "
-0000bf20: 7370 6c69 742d 2220 2b20 746f 6b65 6e0a  split-" + token.
-0000bf30: 2020 2020 2020 2020 6c61 7965 7220 3d20          layer = 
-0000bf40: 7b0a 2020 2020 2020 2020 2020 2020 286e  {.            (n
-0000bf50: 616d 652c 2069 293a 2028 7064 5f73 706c  ame, i): (pd_spl
-0000bf60: 6974 2c20 2873 656c 662e 5f6e 616d 652c  it, (self._name,
-0000bf70: 2069 292c 2066 7261 632c 2073 7461 7465   i), frac, state
-0000bf80: 2c20 7368 7566 666c 6529 0a20 2020 2020  , shuffle).     
-0000bf90: 2020 2020 2020 2066 6f72 2069 2c20 7374         for i, st
-0000bfa0: 6174 6520 696e 2065 6e75 6d65 7261 7465  ate in enumerate
-0000bfb0: 2873 7461 7465 5f64 6174 6129 0a20 2020  (state_data).   
-0000bfc0: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
-0000bfd0: 6f75 7420 3d20 5b5d 0a20 2020 2020 2020  out = [].       
-0000bfe0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0000bff0: 6c65 6e28 6672 6163 2929 3a0a 2020 2020  len(frac)):.    
-0000c000: 2020 2020 2020 2020 6e61 6d65 3220 3d20          name2 = 
-0000c010: 2273 706c 6974 2d25 642d 2573 2220 2520  "split-%d-%s" % 
-0000c020: 2869 2c20 746f 6b65 6e29 0a20 2020 2020  (i, token).     
-0000c030: 2020 2020 2020 2064 736b 3220 3d20 7b0a         dsk2 = {.
-0000c040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c050: 286e 616d 6532 2c20 6a29 3a20 2867 6574  (name2, j): (get
-0000c060: 6974 656d 2c20 286e 616d 652c 206a 292c  item, (name, j),
-0000c070: 2069 2920 666f 7220 6a20 696e 2072 616e   i) for j in ran
-0000c080: 6765 2873 656c 662e 6e70 6172 7469 7469  ge(self.npartiti
-0000c090: 6f6e 7329 0a20 2020 2020 2020 2020 2020  ons).           
-0000c0a0: 207d 0a20 2020 2020 2020 2020 2020 2067   }.            g
-0000c0b0: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
-0000c0c0: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-0000c0d0: 6374 696f 6e73 280a 2020 2020 2020 2020  ctions(.        
-0000c0e0: 2020 2020 2020 2020 6e61 6d65 322c 206d          name2, m
-0000c0f0: 6572 6765 2864 736b 322c 206c 6179 6572  erge(dsk2, layer
-0000c100: 292c 2064 6570 656e 6465 6e63 6965 733d  ), dependencies=
-0000c110: 5b73 656c 665d 0a20 2020 2020 2020 2020  [self].         
-0000c120: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0000c130: 206f 7574 5f64 6620 3d20 7479 7065 2873   out_df = type(s
-0000c140: 656c 6629 2867 7261 7068 2c20 6e61 6d65  elf)(graph, name
-0000c150: 322c 2073 656c 662e 5f6d 6574 612c 2073  2, self._meta, s
-0000c160: 656c 662e 6469 7669 7369 6f6e 7329 0a20  elf.divisions). 
-0000c170: 2020 2020 2020 2020 2020 206f 7574 2e61             out.a
-0000c180: 7070 656e 6428 6f75 745f 6466 290a 2020  ppend(out_df).  
-0000c190: 2020 2020 2020 7265 7475 726e 206f 7574        return out
-0000c1a0: 0a0a 2020 2020 6465 6620 6865 6164 2873  ..    def head(s
-0000c1b0: 656c 662c 206e 3d35 2c20 6e70 6172 7469  elf, n=5, nparti
-0000c1c0: 7469 6f6e 733d 312c 2063 6f6d 7075 7465  tions=1, compute
-0000c1d0: 3d54 7275 6529 3a0a 2020 2020 2020 2020  =True):.        
-0000c1e0: 2222 2246 6972 7374 206e 2072 6f77 7320  """First n rows 
-0000c1f0: 6f66 2074 6865 2064 6174 6173 6574 0a0a  of the dataset..
-0000c200: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0000c210: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-0000c220: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6e20  -----.        n 
-0000c230: 3a20 696e 742c 206f 7074 696f 6e61 6c0a  : int, optional.
-0000c240: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-0000c250: 6e75 6d62 6572 206f 6620 726f 7773 2074  number of rows t
-0000c260: 6f20 7265 7475 726e 2e20 4465 6661 756c  o return. Defaul
-0000c270: 7420 6973 2035 2e0a 2020 2020 2020 2020  t is 5..        
-0000c280: 6e70 6172 7469 7469 6f6e 7320 3a20 696e  npartitions : in
-0000c290: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-0000c2a0: 2020 2020 2020 2020 456c 656d 656e 7473          Elements
-0000c2b0: 2061 7265 206f 6e6c 7920 7461 6b65 6e20   are only taken 
-0000c2c0: 6672 6f6d 2074 6865 2066 6972 7374 2060  from the first `
-0000c2d0: 606e 7061 7274 6974 696f 6e73 6060 2c20  `npartitions``, 
-0000c2e0: 7769 7468 2061 0a20 2020 2020 2020 2020  with a.         
-0000c2f0: 2020 2064 6566 6175 6c74 206f 6620 312e     default of 1.
-0000c300: 2049 6620 7468 6572 6520 6172 6520 6665   If there are fe
-0000c310: 7765 7220 7468 616e 2060 606e 6060 2072  wer than ``n`` r
-0000c320: 6f77 7320 696e 2074 6865 2066 6972 7374  ows in the first
-0000c330: 0a20 2020 2020 2020 2020 2020 2060 606e  .            ``n
-0000c340: 7061 7274 6974 696f 6e73 6060 2061 2077  partitions`` a w
-0000c350: 6172 6e69 6e67 2077 696c 6c20 6265 2072  arning will be r
-0000c360: 6169 7365 6420 616e 6420 616e 7920 666f  aised and any fo
-0000c370: 756e 6420 726f 7773 0a20 2020 2020 2020  und rows.       
-0000c380: 2020 2020 2072 6574 7572 6e65 642e 2050       returned. P
-0000c390: 6173 7320 2d31 2074 6f20 7573 6520 616c  ass -1 to use al
-0000c3a0: 6c20 7061 7274 6974 696f 6e73 2e0a 2020  l partitions..  
-0000c3b0: 2020 2020 2020 636f 6d70 7574 6520 3a20        compute : 
-0000c3c0: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0a20  bool, optional. 
-0000c3d0: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
-0000c3e0: 6572 2074 6f20 636f 6d70 7574 6520 7468  er to compute th
-0000c3f0: 6520 7265 7375 6c74 2c20 6465 6661 756c  e result, defaul
-0000c400: 7420 6973 2054 7275 652e 0a20 2020 2020  t is True..     
-0000c410: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-0000c420: 6620 6e70 6172 7469 7469 6f6e 7320 3c3d  f npartitions <=
-0000c430: 202d 313a 0a20 2020 2020 2020 2020 2020   -1:.           
-0000c440: 206e 7061 7274 6974 696f 6e73 203d 2073   npartitions = s
-0000c450: 656c 662e 6e70 6172 7469 7469 6f6e 730a  elf.npartitions.
-0000c460: 2020 2020 2020 2020 2320 4e6f 206e 6565          # No nee
-0000c470: 6420 746f 2077 6172 6e20 6966 2077 6527  d to warn if we'
-0000c480: 7265 2061 6c72 6561 6479 206c 6f6f 6b69  re already looki
-0000c490: 6e67 2061 7420 616c 6c20 7061 7274 6974  ng at all partit
-0000c4a0: 696f 6e73 0a20 2020 2020 2020 2073 6166  ions.        saf
-0000c4b0: 6520 3d20 6e70 6172 7469 7469 6f6e 7320  e = npartitions 
-0000c4c0: 213d 2073 656c 662e 6e70 6172 7469 7469  != self.npartiti
-0000c4d0: 6f6e 730a 2020 2020 2020 2020 7265 7475  ons.        retu
-0000c4e0: 726e 2073 656c 662e 5f68 6561 6428 6e3d  rn self._head(n=
-0000c4f0: 6e2c 206e 7061 7274 6974 696f 6e73 3d6e  n, npartitions=n
-0000c500: 7061 7274 6974 696f 6e73 2c20 636f 6d70  partitions, comp
-0000c510: 7574 653d 636f 6d70 7574 652c 2073 6166  ute=compute, saf
-0000c520: 653d 7361 6665 290a 0a20 2020 2064 6566  e=safe)..    def
-0000c530: 205f 6865 6164 2873 656c 662c 206e 2c20   _head(self, n, 
-0000c540: 6e70 6172 7469 7469 6f6e 732c 2063 6f6d  npartitions, com
-0000c550: 7075 7465 2c20 7361 6665 293a 0a20 2020  pute, safe):.   
-0000c560: 2020 2020 2069 6620 6e70 6172 7469 7469       if npartiti
-0000c570: 6f6e 7320 3c3d 202d 313a 0a20 2020 2020  ons <= -1:.     
-0000c580: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
-0000c590: 6e73 203d 2073 656c 662e 6e70 6172 7469  ns = self.nparti
-0000c5a0: 7469 6f6e 730a 2020 2020 2020 2020 6966  tions.        if
-0000c5b0: 206e 7061 7274 6974 696f 6e73 203e 2073   npartitions > s
-0000c5c0: 656c 662e 6e70 6172 7469 7469 6f6e 733a  elf.npartitions:
-0000c5d0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0000c5e0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0000c5f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000c600: 226f 6e6c 7920 7b73 656c 662e 6e70 6172  "only {self.npar
-0000c610: 7469 7469 6f6e 737d 2070 6172 7469 7469  titions} partiti
-0000c620: 6f6e 732c 2068 6561 6420 7265 6365 6976  ons, head receiv
-0000c630: 6564 207b 6e70 6172 7469 7469 6f6e 737d  ed {npartitions}
-0000c640: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-0000c650: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
-0000c660: 6622 6865 6164 2d7b 6e70 6172 7469 7469  f"head-{npartiti
-0000c670: 6f6e 737d 2d7b 6e7d 2d7b 7365 6c66 2e5f  ons}-{n}-{self._
-0000c680: 6e61 6d65 7d22 0a20 2020 2020 2020 2069  name}".        i
-0000c690: 6620 7361 6665 3a0a 2020 2020 2020 2020  f safe:.        
-0000c6a0: 2020 2020 6865 6164 203d 2073 6166 655f      head = safe_
-0000c6b0: 6865 6164 0a20 2020 2020 2020 2065 6c73  head.        els
-0000c6c0: 653a 0a20 2020 2020 2020 2020 2020 2068  e:.            h
-0000c6d0: 6561 6420 3d20 4d2e 6865 6164 0a0a 2020  ead = M.head..  
-0000c6e0: 2020 2020 2020 6966 206e 7061 7274 6974        if npartit
-0000c6f0: 696f 6e73 203e 2031 3a0a 2020 2020 2020  ions > 1:.      
-0000c700: 2020 2020 2020 6e61 6d65 5f70 203d 2066        name_p = f
-0000c710: 2268 6561 642d 7061 7274 6961 6c2d 7b6e  "head-partial-{n
-0000c720: 7d2d 7b73 656c 662e 5f6e 616d 657d 220a  }-{self._name}".
-0000c730: 0a20 2020 2020 2020 2020 2020 2064 736b  .            dsk
-0000c740: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
-0000c750: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-0000c760: 286e 7061 7274 6974 696f 6e73 293a 0a20  (npartitions):. 
-0000c770: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0000c780: 736b 5b28 6e61 6d65 5f70 2c20 6929 5d20  sk[(name_p, i)] 
-0000c790: 3d20 284d 2e68 6561 642c 2028 7365 6c66  = (M.head, (self
-0000c7a0: 2e5f 6e61 6d65 2c20 6929 2c20 6e29 0a0a  ._name, i), n)..
-0000c7b0: 2020 2020 2020 2020 2020 2020 636f 6e63              conc
-0000c7c0: 6174 203d 2028 5f63 6f6e 6361 742c 205b  at = (_concat, [
-0000c7d0: 286e 616d 655f 702c 2069 2920 666f 7220  (name_p, i) for 
-0000c7e0: 6920 696e 2072 616e 6765 286e 7061 7274  i in range(npart
-0000c7f0: 6974 696f 6e73 295d 290a 2020 2020 2020  itions)]).      
-0000c800: 2020 2020 2020 6473 6b5b 286e 616d 652c        dsk[(name,
-0000c810: 2030 295d 203d 2028 6865 6164 2c20 636f   0)] = (head, co
-0000c820: 6e63 6174 2c20 6e29 0a20 2020 2020 2020  ncat, n).       
-0000c830: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000c840: 2020 2064 736b 203d 207b 286e 616d 652c     dsk = {(name,
-0000c850: 2030 293a 2028 6865 6164 2c20 2873 656c   0): (head, (sel
-0000c860: 662e 5f6e 616d 652c 2030 292c 206e 297d  f._name, 0), n)}
-0000c870: 0a0a 2020 2020 2020 2020 6772 6170 6820  ..        graph 
-0000c880: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
-0000c890: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
-0000c8a0: 7328 6e61 6d65 2c20 6473 6b2c 2064 6570  s(name, dsk, dep
-0000c8b0: 656e 6465 6e63 6965 733d 5b73 656c 665d  endencies=[self]
-0000c8c0: 290a 2020 2020 2020 2020 7265 7375 6c74  ).        result
-0000c8d0: 203d 206e 6577 5f64 645f 6f62 6a65 6374   = new_dd_object
-0000c8e0: 280a 2020 2020 2020 2020 2020 2020 6772  (.            gr
-0000c8f0: 6170 682c 206e 616d 652c 2073 656c 662e  aph, name, self.
-0000c900: 5f6d 6574 612c 205b 7365 6c66 2e64 6976  _meta, [self.div
-0000c910: 6973 696f 6e73 5b30 5d2c 2073 656c 662e  isions[0], self.
-0000c920: 6469 7669 7369 6f6e 735b 6e70 6172 7469  divisions[nparti
-0000c930: 7469 6f6e 735d 5d0a 2020 2020 2020 2020  tions]].        
-0000c940: 290a 0a20 2020 2020 2020 2069 6620 636f  )..        if co
-0000c950: 6d70 7574 653a 0a20 2020 2020 2020 2020  mpute:.         
-0000c960: 2020 2072 6573 756c 7420 3d20 7265 7375     result = resu
-0000c970: 6c74 2e63 6f6d 7075 7465 2829 0a20 2020  lt.compute().   
-0000c980: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
-0000c990: 6c74 0a0a 2020 2020 6465 6620 7461 696c  lt..    def tail
-0000c9a0: 2873 656c 662c 206e 3d35 2c20 636f 6d70  (self, n=5, comp
-0000c9b0: 7574 653d 5472 7565 293a 0a20 2020 2020  ute=True):.     
-0000c9c0: 2020 2022 2222 4c61 7374 206e 2072 6f77     """Last n row
-0000c9d0: 7320 6f66 2074 6865 2064 6174 6173 6574  s of the dataset
-0000c9e0: 0a0a 2020 2020 2020 2020 4361 7665 6174  ..        Caveat
-0000c9f0: 2c20 7468 6520 6f6e 6c79 2063 6865 636b  , the only check
-0000ca00: 7320 7468 6520 6c61 7374 206e 2072 6f77  s the last n row
-0000ca10: 7320 6f66 2074 6865 206c 6173 7420 7061  s of the last pa
-0000ca20: 7274 6974 696f 6e2e 0a20 2020 2020 2020  rtition..       
-0000ca30: 2022 2222 0a20 2020 2020 2020 206e 616d   """.        nam
-0000ca40: 6520 3d20 2274 6169 6c2d 2564 2d25 7322  e = "tail-%d-%s"
-0000ca50: 2025 2028 6e2c 2073 656c 662e 5f6e 616d   % (n, self._nam
-0000ca60: 6529 0a20 2020 2020 2020 2064 736b 203d  e).        dsk =
-0000ca70: 207b 286e 616d 652c 2030 293a 2028 4d2e   {(name, 0): (M.
-0000ca80: 7461 696c 2c20 2873 656c 662e 5f6e 616d  tail, (self._nam
-0000ca90: 652c 2073 656c 662e 6e70 6172 7469 7469  e, self.npartiti
-0000caa0: 6f6e 7320 2d20 3129 2c20 6e29 7d0a 0a20  ons - 1), n)}.. 
-0000cab0: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
-0000cac0: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
-0000cad0: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
-0000cae0: 616d 652c 2064 736b 2c20 6465 7065 6e64  ame, dsk, depend
-0000caf0: 656e 6369 6573 3d5b 7365 6c66 5d29 0a20  encies=[self]). 
-0000cb00: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-0000cb10: 6e65 775f 6464 5f6f 626a 6563 7428 6772  new_dd_object(gr
-0000cb20: 6170 682c 206e 616d 652c 2073 656c 662e  aph, name, self.
-0000cb30: 5f6d 6574 612c 2073 656c 662e 6469 7669  _meta, self.divi
-0000cb40: 7369 6f6e 735b 2d32 3a5d 290a 0a20 2020  sions[-2:])..   
-0000cb50: 2020 2020 2069 6620 636f 6d70 7574 653a       if compute:
-0000cb60: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-0000cb70: 756c 7420 3d20 7265 7375 6c74 2e63 6f6d  ult = result.com
-0000cb80: 7075 7465 2829 0a20 2020 2020 2020 2072  pute().        r
-0000cb90: 6574 7572 6e20 7265 7375 6c74 0a0a 2020  eturn result..  
-0000cba0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-0000cbb0: 6465 6620 6c6f 6328 7365 6c66 293a 0a20  def loc(self):. 
-0000cbc0: 2020 2020 2020 2022 2222 5075 7265 6c79         """Purely
-0000cbd0: 206c 6162 656c 2d6c 6f63 6174 696f 6e20   label-location 
-0000cbe0: 6261 7365 6420 696e 6465 7865 7220 666f  based indexer fo
-0000cbf0: 7220 7365 6c65 6374 696f 6e20 6279 206c  r selection by l
-0000cc00: 6162 656c 2e0a 0a20 2020 2020 2020 203e  abel...        >
-0000cc10: 3e3e 2064 662e 6c6f 635b 2262 225d 2020  >> df.loc["b"]  
-0000cc20: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
-0000cc30: 0a20 2020 2020 2020 203e 3e3e 2064 662e  .        >>> df.
-0000cc40: 6c6f 635b 2262 223a 2264 225d 2020 2320  loc["b":"d"]  # 
-0000cc50: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
-0000cc60: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000cc70: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
-0000cc80: 6166 7261 6d65 2e69 6e64 6578 696e 6720  aframe.indexing 
-0000cc90: 696d 706f 7274 205f 4c6f 6349 6e64 6578  import _LocIndex
-0000cca0: 6572 0a0a 2020 2020 2020 2020 7265 7475  er..        retu
-0000ccb0: 726e 205f 4c6f 6349 6e64 6578 6572 2873  rn _LocIndexer(s
-0000ccc0: 656c 6629 0a0a 2020 2020 6465 6620 5f70  elf)..    def _p
-0000ccd0: 6172 7469 7469 6f6e 7328 7365 6c66 2c20  artitions(self, 
-0000cce0: 696e 6465 7829 3a0a 2020 2020 2020 2020  index):.        
-0000ccf0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-0000cd00: 6528 696e 6465 782c 2074 7570 6c65 293a  e(index, tuple):
-0000cd10: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-0000cd20: 6578 203d 2028 696e 6465 782c 290a 2020  ex = (index,).  
-0000cd30: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-0000cd40: 6172 7261 792e 736c 6963 696e 6720 696d  array.slicing im
-0000cd50: 706f 7274 206e 6f72 6d61 6c69 7a65 5f69  port normalize_i
-0000cd60: 6e64 6578 0a0a 2020 2020 2020 2020 696e  ndex..        in
-0000cd70: 6465 7820 3d20 6e6f 726d 616c 697a 655f  dex = normalize_
-0000cd80: 696e 6465 7828 696e 6465 782c 2028 7365  index(index, (se
-0000cd90: 6c66 2e6e 7061 7274 6974 696f 6e73 2c29  lf.npartitions,)
-0000cda0: 290a 2020 2020 2020 2020 696e 6465 7820  ).        index 
-0000cdb0: 3d20 7475 706c 6528 736c 6963 6528 6b2c  = tuple(slice(k,
-0000cdc0: 206b 202b 2031 2920 6966 2069 7369 6e73   k + 1) if isins
-0000cdd0: 7461 6e63 6528 6b2c 204e 756d 6265 7229  tance(k, Number)
-0000cde0: 2065 6c73 6520 6b20 666f 7220 6b20 696e   else k for k in
-0000cdf0: 2069 6e64 6578 290a 2020 2020 2020 2020   index).        
-0000ce00: 6e61 6d65 203d 2022 626c 6f63 6b73 2d22  name = "blocks-"
-0000ce10: 202b 2074 6f6b 656e 697a 6528 7365 6c66   + tokenize(self
-0000ce20: 2c20 696e 6465 7829 0a20 2020 2020 2020  , index).       
-0000ce30: 206e 6577 5f6b 6579 7320 3d20 6e70 2e61   new_keys = np.a
-0000ce40: 7272 6179 2873 656c 662e 5f5f 6461 736b  rray(self.__dask
-0000ce50: 5f6b 6579 735f 5f28 292c 2064 7479 7065  _keys__(), dtype
-0000ce60: 3d6f 626a 6563 7429 5b69 6e64 6578 5d2e  =object)[index].
-0000ce70: 746f 6c69 7374 2829 0a0a 2020 2020 2020  tolist()..      
-0000ce80: 2020 6469 7669 7369 6f6e 7320 3d20 5b73    divisions = [s
-0000ce90: 656c 662e 6469 7669 7369 6f6e 735b 695d  elf.divisions[i]
-0000cea0: 2066 6f72 205f 2c20 6920 696e 206e 6577   for _, i in new
-0000ceb0: 5f6b 6579 735d 202b 205b 0a20 2020 2020  _keys] + [.     
-0000cec0: 2020 2020 2020 2073 656c 662e 6469 7669         self.divi
-0000ced0: 7369 6f6e 735b 6e65 775f 6b65 7973 5b2d  sions[new_keys[-
-0000cee0: 315d 5b31 5d20 2b20 315d 0a20 2020 2020  1][1] + 1].     
-0000cef0: 2020 205d 0a20 2020 2020 2020 2064 736b     ].        dsk
-0000cf00: 203d 207b 286e 616d 652c 2069 293a 2074   = {(name, i): t
-0000cf10: 7570 6c65 286b 6579 2920 666f 7220 692c  uple(key) for i,
-0000cf20: 206b 6579 2069 6e20 656e 756d 6572 6174   key in enumerat
-0000cf30: 6528 6e65 775f 6b65 7973 297d 0a0a 2020  e(new_keys)}..  
-0000cf40: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
-0000cf50: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-0000cf60: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6e61  m_collections(na
-0000cf70: 6d65 2c20 6473 6b2c 2064 6570 656e 6465  me, dsk, depende
-0000cf80: 6e63 6965 733d 5b73 656c 665d 290a 2020  ncies=[self]).  
-0000cf90: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-0000cfa0: 5f64 645f 6f62 6a65 6374 2867 7261 7068  _dd_object(graph
-0000cfb0: 2c20 6e61 6d65 2c20 7365 6c66 2e5f 6d65  , name, self._me
-0000cfc0: 7461 2c20 6469 7669 7369 6f6e 7329 0a0a  ta, divisions)..
-0000cfd0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0000cfe0: 2020 6465 6620 7061 7274 6974 696f 6e73    def partitions
-0000cff0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0000d000: 2222 2253 6c69 6365 2064 6174 6166 7261  """Slice datafra
-0000d010: 6d65 2062 7920 7061 7274 6974 696f 6e73  me by partitions
-0000d020: 0a0a 2020 2020 2020 2020 5468 6973 2061  ..        This a
-0000d030: 6c6c 6f77 7320 7061 7274 6974 696f 6e77  llows partitionw
-0000d040: 6973 6520 736c 6963 696e 6720 6f66 2061  ise slicing of a
-0000d050: 2044 6173 6b20 4461 7461 6672 616d 652e   Dask Dataframe.
-0000d060: 2020 596f 7520 6361 6e20 7065 7266 6f72    You can perfor
-0000d070: 6d20 6e6f 726d 616c 0a20 2020 2020 2020  m normal.       
-0000d080: 204e 756d 7079 2d73 7479 6c65 2073 6c69   Numpy-style sli
-0000d090: 6369 6e67 2c20 6275 7420 6e6f 7720 7261  cing, but now ra
-0000d0a0: 7468 6572 2074 6861 6e20 736c 6963 6520  ther than slice 
-0000d0b0: 656c 656d 656e 7473 206f 6620 7468 6520  elements of the 
-0000d0c0: 6172 7261 7920 796f 750a 2020 2020 2020  array you.      
-0000d0d0: 2020 736c 6963 6520 616c 6f6e 6720 7061    slice along pa
-0000d0e0: 7274 6974 696f 6e73 2073 6f2c 2066 6f72  rtitions so, for
-0000d0f0: 2065 7861 6d70 6c65 2c20 6060 6466 2e70   example, ``df.p
-0000d100: 6172 7469 7469 6f6e 735b 3a35 5d60 6020  artitions[:5]`` 
-0000d110: 7072 6f64 7563 6573 2061 206e 6577 0a20  produces a new. 
-0000d120: 2020 2020 2020 2044 6173 6b20 4461 7461         Dask Data
-0000d130: 6672 616d 6520 6f66 2074 6865 2066 6972  frame of the fir
-0000d140: 7374 2066 6976 6520 7061 7274 6974 696f  st five partitio
-0000d150: 6e73 2e20 5661 6c69 6420 696e 6465 7865  ns. Valid indexe
-0000d160: 7273 2061 7265 2069 6e74 6567 6572 732c  rs are integers,
-0000d170: 2073 6571 7565 6e63 6573 0a20 2020 2020   sequences.     
-0000d180: 2020 206f 6620 696e 7465 6765 7273 2c20     of integers, 
-0000d190: 736c 6963 6573 2c20 6f72 2062 6f6f 6c65  slices, or boole
-0000d1a0: 616e 206d 6173 6b73 2e0a 0a20 2020 2020  an masks...     
-0000d1b0: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-0000d1c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-0000d1d0: 2020 2020 203e 3e3e 2064 662e 7061 7274       >>> df.part
-0000d1e0: 6974 696f 6e73 5b30 5d20 2023 2064 6f63  itions[0]  # doc
-0000d1f0: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
-0000d200: 2020 2020 3e3e 3e20 6466 2e70 6172 7469      >>> df.parti
-0000d210: 7469 6f6e 735b 3a33 5d20 2023 2064 6f63  tions[:3]  # doc
-0000d220: 7465 7374 3a20 2b53 4b49 500a 2020 2020  test: +SKIP.    
-0000d230: 2020 2020 3e3e 3e20 6466 2e70 6172 7469      >>> df.parti
-0000d240: 7469 6f6e 735b 3a3a 3130 5d20 2023 2064  tions[::10]  # d
-0000d250: 6f63 7465 7374 3a20 2b53 4b49 500a 0a20  octest: +SKIP.. 
-0000d260: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-0000d270: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-0000d280: 2020 2020 2020 2041 2044 6173 6b20 4461         A Dask Da
-0000d290: 7461 4672 616d 650a 2020 2020 2020 2020  taFrame.        
-0000d2a0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-0000d2b0: 726e 2049 6e64 6578 4361 6c6c 6162 6c65  rn IndexCallable
-0000d2c0: 2873 656c 662e 5f70 6172 7469 7469 6f6e  (self._partition
-0000d2d0: 7329 0a0a 2020 2020 2320 4e6f 7465 3a20  s)..    # Note: 
-0000d2e0: 696c 6f63 2069 7320 696d 706c 656d 656e  iloc is implemen
-0000d2f0: 7465 6420 6f6e 6c79 206f 6e20 4461 7461  ted only on Data
-0000d300: 4672 616d 650a 0a20 2020 2064 6566 2072  Frame..    def r
-0000d310: 6570 6172 7469 7469 6f6e 280a 2020 2020  epartition(.    
-0000d320: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0000d330: 2020 6469 7669 7369 6f6e 733d 4e6f 6e65    divisions=None
-0000d340: 2c0a 2020 2020 2020 2020 6e70 6172 7469  ,.        nparti
-0000d350: 7469 6f6e 733d 4e6f 6e65 2c0a 2020 2020  tions=None,.    
-0000d360: 2020 2020 7061 7274 6974 696f 6e5f 7369      partition_si
-0000d370: 7a65 3d4e 6f6e 652c 0a20 2020 2020 2020  ze=None,.       
-0000d380: 2066 7265 713d 4e6f 6e65 2c0a 2020 2020   freq=None,.    
-0000d390: 2020 2020 666f 7263 653d 4661 6c73 652c      force=False,
-0000d3a0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0000d3b0: 2222 2252 6570 6172 7469 7469 6f6e 2064  """Repartition d
-0000d3c0: 6174 6166 7261 6d65 2061 6c6f 6e67 206e  ataframe along n
-0000d3d0: 6577 2064 6976 6973 696f 6e73 0a0a 2020  ew divisions..  
-0000d3e0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-0000d3f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000d400: 2d2d 2d0a 2020 2020 2020 2020 6469 7669  ---.        divi
-0000d410: 7369 6f6e 7320 3a20 6c69 7374 2c20 6f70  sions : list, op
-0000d420: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-0000d430: 2020 2054 6865 2022 6469 7669 6469 6e67     The "dividing
-0000d440: 206c 696e 6573 2220 7573 6564 2074 6f20   lines" used to 
-0000d450: 7370 6c69 7420 7468 6520 6461 7461 6672  split the datafr
-0000d460: 616d 6520 696e 746f 2070 6172 7469 7469  ame into partiti
-0000d470: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
-0000d480: 2046 6f72 2060 6064 6976 6973 696f 6e73   For ``divisions
-0000d490: 3d5b 302c 2031 302c 2035 302c 2031 3030  =[0, 10, 50, 100
-0000d4a0: 5d60 602c 2074 6865 7265 2077 6f75 6c64  ]``, there would
-0000d4b0: 2062 6520 7468 7265 6520 6f75 7470 7574   be three output
-0000d4c0: 2070 6172 7469 7469 6f6e 732c 0a20 2020   partitions,.   
-0000d4d0: 2020 2020 2020 2020 2077 6865 7265 2074           where t
-0000d4e0: 6865 206e 6577 2069 6e64 6578 2063 6f6e  he new index con
-0000d4f0: 7461 696e 6564 205b 302c 2031 3029 2c20  tained [0, 10), 
-0000d500: 5b31 302c 2035 3029 2c20 616e 6420 5b35  [10, 50), and [5
-0000d510: 302c 2031 3030 292c 2072 6573 7065 6374  0, 100), respect
-0000d520: 6976 656c 792e 0a20 2020 2020 2020 2020  ively..         
-0000d530: 2020 2053 6565 2068 7474 7073 3a2f 2f64     See https://d
-0000d540: 6f63 732e 6461 736b 2e6f 7267 2f65 6e2f  ocs.dask.org/en/
-0000d550: 6c61 7465 7374 2f64 6174 6166 7261 6d65  latest/dataframe
-0000d560: 2d64 6573 6967 6e2e 6874 6d6c 2370 6172  -design.html#par
-0000d570: 7469 7469 6f6e 732e 0a20 2020 2020 2020  titions..       
-0000d580: 2020 2020 204f 6e6c 7920 7573 6564 2069       Only used i
-0000d590: 6620 6e70 6172 7469 7469 6f6e 7320 616e  f npartitions an
-0000d5a0: 6420 7061 7274 6974 696f 6e5f 7369 7a65  d partition_size
-0000d5b0: 2069 736e 2774 2073 7065 6369 6669 6564   isn't specified
-0000d5c0: 2e0a 2020 2020 2020 2020 2020 2020 466f  ..            Fo
-0000d5d0: 7220 636f 6e76 656e 6965 6e63 6520 6966  r convenience if
-0000d5e0: 2067 6976 656e 2061 6e20 696e 7465 6765   given an intege
-0000d5f0: 7220 7468 6973 2077 696c 6c20 6465 6665  r this will defe
-0000d600: 7220 746f 206e 7061 7274 6974 696f 6e73  r to npartitions
-0000d610: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-0000d620: 2069 6620 6769 7665 6e20 6120 7374 7269   if given a stri
-0000d630: 6e67 2069 7420 7769 6c6c 2064 6566 6572  ng it will defer
-0000d640: 2074 6f20 7061 7274 6974 696f 6e5f 7369   to partition_si
-0000d650: 7a65 2028 7365 6520 6265 6c6f 7729 0a20  ze (see below). 
-0000d660: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
-0000d670: 6e73 203a 2069 6e74 2c20 6f70 7469 6f6e  ns : int, option
-0000d680: 616c 0a20 2020 2020 2020 2020 2020 2041  al.            A
-0000d690: 7070 726f 7869 6d61 7465 206e 756d 6265  pproximate numbe
-0000d6a0: 7220 6f66 2070 6172 7469 7469 6f6e 7320  r of partitions 
-0000d6b0: 6f66 206f 7574 7075 742e 204f 6e6c 7920  of output. Only 
-0000d6c0: 7573 6564 2069 6620 7061 7274 6974 696f  used if partitio
-0000d6d0: 6e5f 7369 7a65 0a20 2020 2020 2020 2020  n_size.         
-0000d6e0: 2020 2069 736e 2774 2073 7065 6369 6669     isn't specifi
-0000d6f0: 6564 2e20 5468 6520 6e75 6d62 6572 206f  ed. The number o
-0000d700: 6620 7061 7274 6974 696f 6e73 2075 7365  f partitions use
-0000d710: 6420 6d61 7920 6265 2073 6c69 6768 746c  d may be slightl
-0000d720: 790a 2020 2020 2020 2020 2020 2020 6c6f  y.            lo
-0000d730: 7765 7220 7468 616e 206e 7061 7274 6974  wer than npartit
-0000d740: 696f 6e73 2064 6570 656e 6469 6e67 206f  ions depending o
-0000d750: 6e20 6461 7461 2064 6973 7472 6962 7574  n data distribut
-0000d760: 696f 6e2c 2062 7574 2077 696c 6c20 6e65  ion, but will ne
-0000d770: 7665 7220 6265 0a20 2020 2020 2020 2020  ver be.         
-0000d780: 2020 2068 6967 6865 722e 0a20 2020 2020     higher..     
-0000d790: 2020 2070 6172 7469 7469 6f6e 5f73 697a     partition_siz
-0000d7a0: 653a 2069 6e74 206f 7220 7374 7269 6e67  e: int or string
-0000d7b0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-0000d7c0: 2020 2020 2020 204d 6178 206e 756d 6265         Max numbe
-0000d7d0: 7220 6f66 2062 7974 6573 206f 6620 6d65  r of bytes of me
-0000d7e0: 6d6f 7279 2066 6f72 2065 6163 6820 7061  mory for each pa
-0000d7f0: 7274 6974 696f 6e2e 2055 7365 206e 756d  rtition. Use num
-0000d800: 6265 7273 206f 720a 2020 2020 2020 2020  bers or.        
-0000d810: 2020 2020 7374 7269 6e67 7320 6c69 6b65      strings like
-0000d820: 2035 4d42 2e20 4966 2073 7065 6369 6669   5MB. If specifi
-0000d830: 6564 206e 7061 7274 6974 696f 6e73 2061  ed npartitions a
-0000d840: 6e64 2064 6976 6973 696f 6e73 2077 696c  nd divisions wil
-0000d850: 6c20 6265 0a20 2020 2020 2020 2020 2020  l be.           
-0000d860: 2069 676e 6f72 6564 2e20 4e6f 7465 2074   ignored. Note t
-0000d870: 6861 7420 7468 6520 7369 7a65 2072 6566  hat the size ref
-0000d880: 6c65 6374 7320 7468 6520 6e75 6d62 6572  lects the number
-0000d890: 206f 6620 6279 7465 7320 7573 6564 2061   of bytes used a
-0000d8a0: 730a 2020 2020 2020 2020 2020 2020 636f  s.            co
-0000d8b0: 6d70 7574 6564 2062 7920 6060 7061 6e64  mputed by ``pand
-0000d8c0: 6173 2e44 6174 6146 7261 6d65 2e6d 656d  as.DataFrame.mem
-0000d8d0: 6f72 795f 7573 6167 6560 602c 2077 6869  ory_usage``, whi
-0000d8e0: 6368 2077 696c 6c20 6e6f 740a 2020 2020  ch will not.    
-0000d8f0: 2020 2020 2020 2020 6e65 6365 7373 6172          necessar
-0000d900: 696c 7920 6d61 7463 6820 7468 6520 7369  ily match the si
-0000d910: 7a65 2077 6865 6e20 7374 6f72 696e 6720  ze when storing 
-0000d920: 746f 2064 6973 6b2e 0a0a 2020 2020 2020  to disk...      
-0000d930: 2020 2020 2020 2e2e 2077 6172 6e69 6e67        .. warning
-0000d940: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
-0000d950: 2020 2054 6869 7320 6b65 7977 6f72 6420     This keyword 
-0000d960: 6172 6775 6d65 6e74 2074 7269 6767 6572  argument trigger
-0000d970: 7320 636f 6d70 7574 6174 696f 6e20 746f  s computation to
-0000d980: 2064 6574 6572 6d69 6e65 0a20 2020 2020   determine.     
-0000d990: 2020 2020 2020 2020 2020 7468 6520 6d65            the me
-0000d9a0: 6d6f 7279 2073 697a 6520 6f66 2065 6163  mory size of eac
-0000d9b0: 6820 7061 7274 6974 696f 6e2c 2077 6869  h partition, whi
-0000d9c0: 6368 206d 6179 2062 6520 6578 7065 6e73  ch may be expens
-0000d9d0: 6976 652e 0a0a 2020 2020 2020 2020 6672  ive...        fr
-0000d9e0: 6571 203a 2073 7472 2c20 7064 2e54 696d  eq : str, pd.Tim
-0000d9f0: 6564 656c 7461 0a20 2020 2020 2020 2020  edelta.         
-0000da00: 2020 2041 2070 6572 696f 6420 6f6e 2077     A period on w
-0000da10: 6869 6368 2074 6f20 7061 7274 6974 696f  hich to partitio
-0000da20: 6e20 7469 6d65 7365 7269 6573 2064 6174  n timeseries dat
-0000da30: 6120 6c69 6b65 2060 6027 3744 2760 6020  a like ``'7D'`` 
-0000da40: 6f72 0a20 2020 2020 2020 2020 2020 2060  or.            `
-0000da50: 6027 3132 6827 6060 206f 7220 6060 7064  `'12h'`` or ``pd
-0000da60: 2e54 696d 6564 656c 7461 2868 6f75 7273  .Timedelta(hours
-0000da70: 3d31 3229 6060 2e20 2041 7373 756d 6573  =12)``.  Assumes
-0000da80: 2061 2064 6174 6574 696d 6520 696e 6465   a datetime inde
-0000da90: 782e 0a20 2020 2020 2020 2066 6f72 6365  x..        force
-0000daa0: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
-0000dab0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-0000dac0: 2020 2041 6c6c 6f77 7320 7468 6520 6578     Allows the ex
-0000dad0: 7061 6e73 696f 6e20 6f66 2074 6865 2065  pansion of the e
-0000dae0: 7869 7374 696e 6720 6469 7669 7369 6f6e  xisting division
-0000daf0: 732e 0a20 2020 2020 2020 2020 2020 2049  s..            I
-0000db00: 6620 4661 6c73 6520 7468 656e 2074 6865  f False then the
-0000db10: 206e 6577 2064 6976 6973 696f 6e73 2720   new divisions' 
-0000db20: 6c6f 7765 7220 616e 6420 7570 7065 7220  lower and upper 
-0000db30: 626f 756e 6473 206d 7573 7420 6265 0a20  bounds must be. 
-0000db40: 2020 2020 2020 2020 2020 2074 6865 2073             the s
-0000db50: 616d 6520 6173 2074 6865 206f 6c64 2064  ame as the old d
-0000db60: 6976 6973 696f 6e73 272e 0a0a 2020 2020  ivisions'...    
-0000db70: 2020 2020 4e6f 7465 730a 2020 2020 2020      Notes.      
-0000db80: 2020 2d2d 2d2d 2d0a 2020 2020 2020 2020    -----.        
-0000db90: 4578 6163 746c 7920 6f6e 6520 6f66 2060  Exactly one of `
-0000dba0: 6469 7669 7369 6f6e 7360 2c20 606e 7061  divisions`, `npa
-0000dbb0: 7274 6974 696f 6e73 602c 2060 7061 7274  rtitions`, `part
-0000dbc0: 6974 696f 6e5f 7369 7a65 602c 206f 7220  ition_size`, or 
-0000dbd0: 6066 7265 7160 0a20 2020 2020 2020 2073  `freq`.        s
-0000dbe0: 686f 756c 6420 6265 2073 7065 6369 6669  hould be specifi
-0000dbf0: 6564 2e20 4120 6060 5661 6c75 6545 7272  ed. A ``ValueErr
-0000dc00: 6f72 6060 2077 696c 6c20 6265 2072 6169  or`` will be rai
-0000dc10: 7365 6420 7768 656e 2074 6861 7420 6973  sed when that is
-0000dc20: 0a20 2020 2020 2020 206e 6f74 2074 6865  .        not the
-0000dc30: 2063 6173 652e 0a0a 2020 2020 2020 2020   case...        
-0000dc40: 416c 736f 206e 6f74 6520 7468 6174 2060  Also note that `
-0000dc50: 606c 656e 2864 6976 6973 6f6e 7329 6060  `len(divisons)``
-0000dc60: 2069 7320 6571 7561 6c20 746f 2060 606e   is equal to ``n
-0000dc70: 7061 7274 6974 696f 6e73 202b 2031 6060  partitions + 1``
-0000dc80: 2e20 5468 6973 2069 7320 6265 6361 7573  . This is becaus
-0000dc90: 6520 6060 6469 7669 7369 6f6e 7360 600a  e ``divisions``.
-0000dca0: 2020 2020 2020 2020 7265 7072 6573 656e          represen
-0000dcb0: 7473 2074 6865 2075 7070 6572 2061 6e64  ts the upper and
-0000dcc0: 206c 6f77 6572 2062 6f75 6e64 7320 6f66   lower bounds of
-0000dcd0: 2065 6163 6820 7061 7274 6974 696f 6e2e   each partition.
-0000dce0: 2054 6865 2066 6972 7374 2069 7465 6d20   The first item 
-0000dcf0: 6973 2074 6865 0a20 2020 2020 2020 206c  is the.        l
-0000dd00: 6f77 6572 2062 6f75 6e64 206f 6620 7468  ower bound of th
-0000dd10: 6520 6669 7273 7420 7061 7274 6974 696f  e first partitio
-0000dd20: 6e2c 2074 6865 2073 6563 6f6e 6420 6974  n, the second it
-0000dd30: 656d 2069 7320 7468 6520 6c6f 7765 7220  em is the lower 
-0000dd40: 626f 756e 6420 6f66 2074 6865 0a20 2020  bound of the.   
-0000dd50: 2020 2020 2073 6563 6f6e 6420 7061 7274       second part
-0000dd60: 6974 696f 6e20 616e 6420 7468 6520 7570  ition and the up
-0000dd70: 7065 7220 626f 756e 6420 6f66 2074 6865  per bound of the
-0000dd80: 2066 6972 7374 2070 6172 7469 7469 6f6e   first partition
-0000dd90: 2c20 616e 6420 736f 206f 6e2e 0a20 2020  , and so on..   
-0000dda0: 2020 2020 2054 6865 2073 6563 6f6e 642d       The second-
-0000ddb0: 746f 2d6c 6173 7420 6974 656d 2069 7320  to-last item is 
-0000ddc0: 7468 6520 6c6f 7765 7220 626f 756e 6420  the lower bound 
-0000ddd0: 6f66 2074 6865 206c 6173 7420 7061 7274  of the last part
-0000dde0: 6974 696f 6e2c 2061 6e64 2074 6865 206c  ition, and the l
-0000ddf0: 6173 740a 2020 2020 2020 2020 2865 7874  ast.        (ext
-0000de00: 7261 2920 6974 656d 2069 7320 7468 6520  ra) item is the 
-0000de10: 7570 7065 7220 626f 756e 6420 6f66 2074  upper bound of t
-0000de20: 6865 206c 6173 7420 7061 7274 6974 696f  he last partitio
-0000de30: 6e2e 0a0a 2020 2020 2020 2020 4578 616d  n...        Exam
-0000de40: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
-0000de50: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
-0000de60: 3e20 6466 203d 2064 662e 7265 7061 7274  > df = df.repart
-0000de70: 6974 696f 6e28 6e70 6172 7469 7469 6f6e  ition(npartition
-0000de80: 733d 3130 2920 2023 2064 6f63 7465 7374  s=10)  # doctest
-0000de90: 3a20 2b53 4b49 500a 2020 2020 2020 2020  : +SKIP.        
-0000dea0: 3e3e 3e20 6466 203d 2064 662e 7265 7061  >>> df = df.repa
-0000deb0: 7274 6974 696f 6e28 6469 7669 7369 6f6e  rtition(division
-0000dec0: 733d 5b30 2c20 352c 2031 302c 2032 305d  s=[0, 5, 10, 20]
-0000ded0: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
-0000dee0: 4b49 500a 2020 2020 2020 2020 3e3e 3e20  KIP.        >>> 
-0000def0: 6466 203d 2064 662e 7265 7061 7274 6974  df = df.repartit
-0000df00: 696f 6e28 6672 6571 3d27 3764 2729 2020  ion(freq='7d')  
-0000df10: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
-0000df20: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
-0000df30: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
-0000df40: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
-0000df50: 4672 616d 652e 6d65 6d6f 7279 5f75 7361  Frame.memory_usa
-0000df60: 6765 5f70 6572 5f70 6172 7469 7469 6f6e  ge_per_partition
-0000df70: 0a20 2020 2020 2020 2070 616e 6461 732e  .        pandas.
-0000df80: 4461 7461 4672 616d 652e 6d65 6d6f 7279  DataFrame.memory
-0000df90: 5f75 7361 6765 0a20 2020 2020 2020 2022  _usage.        "
-0000dfa0: 2222 0a20 2020 2020 2020 2069 6620 6973  "".        if is
-0000dfb0: 696e 7374 616e 6365 2864 6976 6973 696f  instance(divisio
-0000dfc0: 6e73 2c20 696e 7429 3a0a 2020 2020 2020  ns, int):.      
-0000dfd0: 2020 2020 2020 6e70 6172 7469 7469 6f6e        npartition
-0000dfe0: 7320 3d20 6469 7669 7369 6f6e 730a 2020  s = divisions.  
-0000dff0: 2020 2020 2020 2020 2020 6469 7669 7369            divisi
-0000e000: 6f6e 7320 3d20 4e6f 6e65 0a20 2020 2020  ons = None.     
-0000e010: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0000e020: 2864 6976 6973 696f 6e73 2c20 7374 7229  (divisions, str)
-0000e030: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
-0000e040: 7274 6974 696f 6e5f 7369 7a65 203d 2064  rtition_size = d
-0000e050: 6976 6973 696f 6e73 0a20 2020 2020 2020  ivisions.       
-0000e060: 2020 2020 2064 6976 6973 696f 6e73 203d       divisions =
-0000e070: 204e 6f6e 650a 2020 2020 2020 2020 6966   None.        if
-0000e080: 2028 0a20 2020 2020 2020 2020 2020 2073   (.            s
-0000e090: 756d 280a 2020 2020 2020 2020 2020 2020  um(.            
-0000e0a0: 2020 2020 5b0a 2020 2020 2020 2020 2020      [.          
-0000e0b0: 2020 2020 2020 2020 2020 7061 7274 6974            partit
-0000e0c0: 696f 6e5f 7369 7a65 2069 7320 6e6f 7420  ion_size is not 
-0000e0d0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0000e0e0: 2020 2020 2020 2020 2020 6469 7669 7369            divisi
-0000e0f0: 6f6e 7320 6973 206e 6f74 204e 6f6e 652c  ons is not None,
-0000e100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e110: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
-0000e120: 2069 7320 6e6f 7420 4e6f 6e65 2c0a 2020   is not None,.  
-0000e130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e140: 2020 6672 6571 2069 7320 6e6f 7420 4e6f    freq is not No
-0000e150: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0000e160: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
-0000e170: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0000e180: 213d 2031 0a20 2020 2020 2020 2029 3a0a  != 1.        ):.
-0000e190: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000e1a0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
-0000e1b0: 2020 2020 2020 2020 2020 2020 2020 2250                "P
-0000e1c0: 6c65 6173 6520 7072 6f76 6964 6520 6578  lease provide ex
-0000e1d0: 6163 746c 7920 6f6e 6520 6f66 2060 606e  actly one of ``n
-0000e1e0: 7061 7274 6974 696f 6e73 3d60 602c 2060  partitions=``, `
-0000e1f0: 6066 7265 713d 6060 2c20 220a 2020 2020  `freq=``, ".    
-0000e200: 2020 2020 2020 2020 2020 2020 2260 6064              "``d
-0000e210: 6976 6973 696f 6e73 3d60 602c 2060 6070  ivisions=``, ``p
-0000e220: 6172 7469 7469 6f6e 5f73 697a 653d 6060  artition_size=``
-0000e230: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
-0000e240: 7473 220a 2020 2020 2020 2020 2020 2020  ts".            
-0000e250: 290a 0a20 2020 2020 2020 2069 6620 7061  )..        if pa
-0000e260: 7274 6974 696f 6e5f 7369 7a65 2069 7320  rtition_size is 
-0000e270: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0000e280: 2020 2020 2020 7265 7475 726e 2072 6570        return rep
-0000e290: 6172 7469 7469 6f6e 5f73 697a 6528 7365  artition_size(se
-0000e2a0: 6c66 2c20 7061 7274 6974 696f 6e5f 7369  lf, partition_si
-0000e2b0: 7a65 290a 2020 2020 2020 2020 656c 6966  ze).        elif
-0000e2c0: 206e 7061 7274 6974 696f 6e73 2069 7320   npartitions is 
-0000e2d0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0000e2e0: 2020 2020 2020 7265 7475 726e 2072 6570        return rep
-0000e2f0: 6172 7469 7469 6f6e 5f6e 7061 7274 6974  artition_npartit
-0000e300: 696f 6e73 2873 656c 662c 206e 7061 7274  ions(self, npart
-0000e310: 6974 696f 6e73 290a 2020 2020 2020 2020  itions).        
-0000e320: 656c 6966 2064 6976 6973 696f 6e73 2069  elif divisions i
-0000e330: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0000e340: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-0000e350: 6570 6172 7469 7469 6f6e 2873 656c 662c  epartition(self,
-0000e360: 2064 6976 6973 696f 6e73 2c20 666f 7263   divisions, forc
-0000e370: 653d 666f 7263 6529 0a20 2020 2020 2020  e=force).       
-0000e380: 2065 6c69 6620 6672 6571 2069 7320 6e6f   elif freq is no
-0000e390: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0000e3a0: 2020 2020 7265 7475 726e 2072 6570 6172      return repar
-0000e3b0: 7469 7469 6f6e 5f66 7265 7128 7365 6c66  tition_freq(self
-0000e3c0: 2c20 6672 6571 3d66 7265 7129 0a0a 2020  , freq=freq)..  
-0000e3d0: 2020 6465 6620 7368 7566 666c 6528 0a20    def shuffle(. 
-0000e3e0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0000e3f0: 2020 2020 206f 6e2c 0a20 2020 2020 2020       on,.       
-0000e400: 206e 7061 7274 6974 696f 6e73 3d4e 6f6e   npartitions=Non
-0000e410: 652c 0a20 2020 2020 2020 206d 6178 5f62  e,.        max_b
-0000e420: 7261 6e63 683d 4e6f 6e65 2c0a 2020 2020  ranch=None,.    
-0000e430: 2020 2020 7368 7566 666c 653d 4e6f 6e65      shuffle=None
-0000e440: 2c0a 2020 2020 2020 2020 6967 6e6f 7265  ,.        ignore
-0000e450: 5f69 6e64 6578 3d46 616c 7365 2c0a 2020  _index=False,.  
-0000e460: 2020 2020 2020 636f 6d70 7574 653d 4e6f        compute=No
-0000e470: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
-0000e480: 2020 2022 2222 5265 6172 7261 6e67 6520     """Rearrange 
-0000e490: 4461 7461 4672 616d 6520 696e 746f 206e  DataFrame into n
-0000e4a0: 6577 2070 6172 7469 7469 6f6e 730a 0a20  ew partitions.. 
-0000e4b0: 2020 2020 2020 2055 7365 7320 6861 7368         Uses hash
-0000e4c0: 696e 6720 6f66 2060 6f6e 6020 746f 206d  ing of `on` to m
-0000e4d0: 6170 2072 6f77 7320 746f 206f 7574 7075  ap rows to outpu
-0000e4e0: 7420 7061 7274 6974 696f 6e73 2e20 4166  t partitions. Af
-0000e4f0: 7465 7220 7468 6973 0a20 2020 2020 2020  ter this.       
-0000e500: 206f 7065 7261 7469 6f6e 2c20 726f 7773   operation, rows
-0000e510: 2077 6974 6820 7468 6520 7361 6d65 2076   with the same v
-0000e520: 616c 7565 206f 6620 606f 6e60 2077 696c  alue of `on` wil
-0000e530: 6c20 6265 2069 6e20 7468 6520 7361 6d65  l be in the same
-0000e540: 0a20 2020 2020 2020 2070 6172 7469 7469  .        partiti
-0000e550: 6f6e 2e0a 0a20 2020 2020 2020 2050 6172  on...        Par
-0000e560: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-0000e570: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0000e580: 2020 206f 6e20 3a20 7374 722c 206c 6973     on : str, lis
-0000e590: 7420 6f66 2073 7472 2c20 6f72 2053 6572  t of str, or Ser
-0000e5a0: 6965 732c 2049 6e64 6578 2c20 6f72 2044  ies, Index, or D
-0000e5b0: 6174 6146 7261 6d65 0a20 2020 2020 2020  ataFrame.       
-0000e5c0: 2020 2020 2043 6f6c 756d 6e28 7329 206f       Column(s) o
-0000e5d0: 7220 696e 6465 7820 746f 2062 6520 7573  r index to be us
-0000e5e0: 6564 2074 6f20 6d61 7020 726f 7773 2074  ed to map rows t
-0000e5f0: 6f20 6f75 7470 7574 2070 6172 7469 7469  o output partiti
-0000e600: 6f6e 730a 2020 2020 2020 2020 6e70 6172  ons.        npar
-0000e610: 7469 7469 6f6e 7320 3a20 696e 742c 206f  titions : int, o
-0000e620: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-0000e630: 2020 2020 4e75 6d62 6572 206f 6620 7061      Number of pa
-0000e640: 7274 6974 696f 6e73 206f 6620 6f75 7470  rtitions of outp
-0000e650: 7574 2e20 5061 7274 6974 696f 6e20 636f  ut. Partition co
-0000e660: 756e 7420 7769 6c6c 206e 6f74 2062 650a  unt will not be.
-0000e670: 2020 2020 2020 2020 2020 2020 6368 616e              chan
-0000e680: 6765 6420 6279 2064 6566 6175 6c74 2e0a  ged by default..
-0000e690: 2020 2020 2020 2020 6d61 785f 6272 616e          max_bran
-0000e6a0: 6368 3a20 696e 742c 206f 7074 696f 6e61  ch: int, optiona
-0000e6b0: 6c0a 2020 2020 2020 2020 2020 2020 5468  l.            Th
-0000e6c0: 6520 6d61 7869 6d75 6d20 6e75 6d62 6572  e maximum number
-0000e6d0: 206f 6620 7370 6c69 7473 2070 6572 2069   of splits per i
-0000e6e0: 6e70 7574 2070 6172 7469 7469 6f6e 2e20  nput partition. 
-0000e6f0: 5573 6564 2077 6974 6869 6e0a 2020 2020  Used within.    
-0000e700: 2020 2020 2020 2020 7468 6520 7374 6167          the stag
-0000e710: 6564 2073 6875 6666 6c69 6e67 2061 6c67  ed shuffling alg
-0000e720: 6f72 6974 686d 2e0a 2020 2020 2020 2020  orithm..        
-0000e730: 7368 7566 666c 653a 207b 2764 6973 6b27  shuffle: {'disk'
-0000e740: 2c20 2774 6173 6b73 277d 2c20 6f70 7469  , 'tasks'}, opti
-0000e750: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-0000e760: 2045 6974 6865 7220 6060 2764 6973 6b27   Either ``'disk'
-0000e770: 6060 2066 6f72 2073 696e 676c 652d 6e6f  `` for single-no
-0000e780: 6465 206f 7065 7261 7469 6f6e 206f 7220  de operation or 
-0000e790: 6060 2774 6173 6b73 2760 6020 666f 720a  ``'tasks'`` for.
-0000e7a0: 2020 2020 2020 2020 2020 2020 6469 7374              dist
-0000e7b0: 7269 6275 7465 6420 6f70 6572 6174 696f  ributed operatio
-0000e7c0: 6e2e 2020 5769 6c6c 2062 6520 696e 6665  n.  Will be infe
-0000e7d0: 7272 6564 2062 7920 796f 7572 2063 7572  rred by your cur
-0000e7e0: 7265 6e74 2073 6368 6564 756c 6572 2e0a  rent scheduler..
-0000e7f0: 2020 2020 2020 2020 6967 6e6f 7265 5f69          ignore_i
-0000e800: 6e64 6578 3a20 626f 6f6c 2c20 6465 6661  ndex: bool, defa
-0000e810: 756c 7420 4661 6c73 650a 2020 2020 2020  ult False.      
-0000e820: 2020 2020 2020 4967 6e6f 7265 2069 6e64        Ignore ind
-0000e830: 6578 2064 7572 696e 6720 7368 7566 666c  ex during shuffl
-0000e840: 652e 2020 4966 2060 6054 7275 6560 602c  e.  If ``True``,
-0000e850: 2070 6572 666f 726d 616e 6365 206d 6179   performance may
-0000e860: 2069 6d70 726f 7665 2c0a 2020 2020 2020   improve,.      
-0000e870: 2020 2020 2020 6275 7420 696e 6465 7820        but index 
-0000e880: 7661 6c75 6573 2077 696c 6c20 6e6f 7420  values will not 
-0000e890: 6265 2070 7265 7365 7276 6564 2e0a 2020  be preserved..  
-0000e8a0: 2020 2020 2020 636f 6d70 7574 653a 2062        compute: b
-0000e8b0: 6f6f 6c0a 2020 2020 2020 2020 2020 2020  ool.            
-0000e8c0: 5768 6574 6865 7220 6f72 206e 6f74 2074  Whether or not t
-0000e8d0: 6f20 7472 6967 6765 7220 616e 2069 6d6d  o trigger an imm
-0000e8e0: 6564 6961 7465 2063 6f6d 7075 7461 7469  ediate computati
-0000e8f0: 6f6e 2e20 4465 6661 756c 7473 2074 6f20  on. Defaults to 
-0000e900: 4661 6c73 652e 0a0a 2020 2020 2020 2020  False...        
-0000e910: 4e6f 7465 730a 2020 2020 2020 2020 2d2d  Notes.        --
-0000e920: 2d2d 2d0a 2020 2020 2020 2020 5468 6973  ---.        This
-0000e930: 2064 6f65 7320 6e6f 7420 7072 6573 6572   does not preser
-0000e940: 7665 2061 206d 6561 6e69 6e67 6675 6c20  ve a meaningful 
-0000e950: 696e 6465 782f 7061 7274 6974 696f 6e69  index/partitioni
-0000e960: 6e67 2073 6368 656d 652e 2054 6869 730a  ng scheme. This.
-0000e970: 2020 2020 2020 2020 6973 206e 6f74 2064          is not d
-0000e980: 6574 6572 6d69 6e69 7374 6963 2069 6620  eterministic if 
-0000e990: 646f 6e65 2069 6e20 7061 7261 6c6c 656c  done in parallel
-0000e9a0: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-0000e9b0: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
-0000e9c0: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
-0000e9d0: 2064 6620 3d20 6466 2e73 6875 6666 6c65   df = df.shuffle
-0000e9e0: 2864 662e 636f 6c75 6d6e 735b 305d 2920  (df.columns[0]) 
-0000e9f0: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
-0000ea00: 500a 2020 2020 2020 2020 2222 220a 2020  P.        """.  
-0000ea10: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-0000ea20: 6461 7461 6672 616d 652e 7368 7566 666c  dataframe.shuffl
-0000ea30: 6520 696d 706f 7274 2073 6875 6666 6c65  e import shuffle
-0000ea40: 2061 7320 6464 5f73 6875 6666 6c65 0a0a   as dd_shuffle..
-0000ea50: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-0000ea60: 645f 7368 7566 666c 6528 0a20 2020 2020  d_shuffle(.     
-0000ea70: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0000ea80: 2020 2020 2020 2020 206f 6e2c 0a20 2020           on,.   
-0000ea90: 2020 2020 2020 2020 206e 7061 7274 6974           npartit
-0000eaa0: 696f 6e73 3d6e 7061 7274 6974 696f 6e73  ions=npartitions
-0000eab0: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
-0000eac0: 785f 6272 616e 6368 3d6d 6178 5f62 7261  x_branch=max_bra
-0000ead0: 6e63 682c 0a20 2020 2020 2020 2020 2020  nch,.           
-0000eae0: 2073 6875 6666 6c65 3d73 6875 6666 6c65   shuffle=shuffle
-0000eaf0: 2c0a 2020 2020 2020 2020 2020 2020 6967  ,.            ig
-0000eb00: 6e6f 7265 5f69 6e64 6578 3d69 676e 6f72  nore_index=ignor
-0000eb10: 655f 696e 6465 782c 0a20 2020 2020 2020  e_index,.       
-0000eb20: 2020 2020 2063 6f6d 7075 7465 3d63 6f6d       compute=com
-0000eb30: 7075 7465 2c0a 2020 2020 2020 2020 290a  pute,.        ).
-0000eb40: 0a20 2020 2064 6566 205f 6c69 6d69 745f  .    def _limit_
-0000eb50: 6669 6c6c 6e61 2873 656c 662c 206d 6574  fillna(self, met
-0000eb60: 686f 643d 4e6f 6e65 2c20 2a2c 206c 696d  hod=None, *, lim
-0000eb70: 6974 3d4e 6f6e 652c 2073 6b69 705f 6368  it=None, skip_ch
-0000eb80: 6563 6b3d 4e6f 6e65 2c20 6d65 7461 3d4e  eck=None, meta=N
-0000eb90: 6f6e 6529 3a0a 2020 2020 2020 2020 6966  one):.        if
-0000eba0: 206c 696d 6974 2069 7320 4e6f 6e65 3a0a   limit is None:.
-0000ebb0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-0000ebc0: 203d 2022 6669 6c6c 6e61 2d63 6875 6e6b   = "fillna-chunk
-0000ebd0: 2d22 202b 2074 6f6b 656e 697a 6528 7365  -" + tokenize(se
-0000ebe0: 6c66 2c20 6d65 7468 6f64 290a 2020 2020  lf, method).    
-0000ebf0: 2020 2020 2020 2020 6473 6b20 3d20 7b0a          dsk = {.
-0000ec00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ec10: 286e 616d 652c 2069 293a 2028 0a20 2020  (name, i): (.   
-0000ec20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ec30: 206d 6574 686f 6473 2e66 696c 6c6e 615f   methods.fillna_
-0000ec40: 6368 6563 6b2c 0a20 2020 2020 2020 2020  check,.         
-0000ec50: 2020 2020 2020 2020 2020 2028 7365 6c66             (self
-0000ec60: 2e5f 6e61 6d65 2c20 6929 2c0a 2020 2020  ._name, i),.    
-0000ec70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ec80: 6d65 7468 6f64 2c0a 2020 2020 2020 2020  method,.        
-0000ec90: 2020 2020 2020 2020 2020 2020 6920 213d              i !=
-0000eca0: 2073 6b69 705f 6368 6563 6b2c 0a20 2020   skip_check,.   
-0000ecb0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0000ecc0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000ecd0: 6f72 2069 2069 6e20 7261 6e67 6528 7365  or i in range(se
-0000ece0: 6c66 2e6e 7061 7274 6974 696f 6e73 290a  lf.npartitions).
-0000ecf0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-0000ed00: 2020 2020 2020 2020 2020 6772 6170 6820            graph 
-0000ed10: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
-0000ed20: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
-0000ed30: 7328 6e61 6d65 2c20 6473 6b2c 2064 6570  s(name, dsk, dep
-0000ed40: 656e 6465 6e63 6965 733d 5b73 656c 665d  endencies=[self]
-0000ed50: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-0000ed60: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
-0000ed70: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
-0000ed80: 6d65 7461 2c20 7365 6c66 2e64 6976 6973  meta, self.divis
-0000ed90: 696f 6e73 290a 2020 2020 2020 2020 656c  ions).        el
-0000eda0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000edb0: 7265 7475 726e 2073 656c 660a 0a20 2020  return self..   
-0000edc0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0000edd0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0000ede0: 2064 6566 2066 696c 6c6e 6128 7365 6c66   def fillna(self
-0000edf0: 2c20 7661 6c75 653d 4e6f 6e65 2c20 6d65  , value=None, me
-0000ee00: 7468 6f64 3d4e 6f6e 652c 206c 696d 6974  thod=None, limit
-0000ee10: 3d4e 6f6e 652c 2061 7869 733d 4e6f 6e65  =None, axis=None
-0000ee20: 293a 0a20 2020 2020 2020 2069 6620 6d65  ):.        if me
-0000ee30: 7468 6f64 2069 7320 4e6f 6e65 2061 6e64  thod is None and
-0000ee40: 206c 696d 6974 2069 7320 6e6f 7420 4e6f   limit is not No
-0000ee50: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0000ee60: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-0000ee70: 6e74 6564 4572 726f 7228 2266 696c 6c6e  ntedError("filln
-0000ee80: 6120 7769 7468 2073 6574 206c 696d 6974  a with set limit
-0000ee90: 2061 6e64 206d 6574 686f 643d 4e6f 6e65   and method=None
-0000eea0: 2229 0a0a 2020 2020 2020 2020 6178 6973  ")..        axis
-0000eeb0: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
-0000eec0: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
-0000eed0: 2020 2020 2074 6573 745f 7661 6c75 6520       test_value 
-0000eee0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-0000eef0: 7661 6c75 652e 5f6d 6574 615f 6e6f 6e65  value._meta_none
-0000ef00: 6d70 7479 2069 6620 6973 696e 7374 616e  mpty if isinstan
-0000ef10: 6365 2876 616c 7565 2c20 285f 4672 616d  ce(value, (_Fram
-0000ef20: 652c 2053 6361 6c61 7229 2920 656c 7365  e, Scalar)) else
-0000ef30: 2076 616c 7565 0a20 2020 2020 2020 2029   value.        )
-0000ef40: 0a0a 2020 2020 2020 2020 2320 6c65 7420  ..        # let 
-0000ef50: 6974 2072 6169 7365 2061 2046 7574 7572  it raise a Futur
-0000ef60: 6557 6172 6e69 6e67 2069 6620 606d 6574  eWarning if `met
-0000ef70: 686f 6460 2069 7320 6e6f 7420 4e6f 6e65  hod` is not None
-0000ef80: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
-0000ef90: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
-0000efa0: 7074 792e 6669 6c6c 6e61 280a 2020 2020  pty.fillna(.    
-0000efb0: 2020 2020 2020 2020 7661 6c75 653d 7465          value=te
-0000efc0: 7374 5f76 616c 7565 2c20 6d65 7468 6f64  st_value, method
-0000efd0: 3d6d 6574 686f 642c 206c 696d 6974 3d6c  =method, limit=l
-0000efe0: 696d 6974 2c20 6178 6973 3d61 7869 730a  imit, axis=axis.
-0000eff0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0000f000: 2020 2069 6620 6d65 7468 6f64 2069 7320     if method is 
-0000f010: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0000f020: 2020 2320 436f 6e74 726f 6c20 7768 6574    # Control whet
-0000f030: 6865 7220 6f72 206e 6f74 2064 6173 6b27  her or not dask'
-0000f040: 7320 7061 7274 6974 696f 6e20 616c 6967  s partition alig
-0000f050: 6e6d 656e 7420 6861 7070 656e 732e 0a20  nment happens.. 
-0000f060: 2020 2020 2020 2020 2020 2023 2057 6520             # We 
-0000f070: 646f 6e27 7420 7761 6e74 2066 6f72 2061  don't want for a
-0000f080: 2070 616e 6461 7320 5365 7269 6573 2e0a   pandas Series..
-0000f090: 2020 2020 2020 2020 2020 2020 2320 5765              # We
-0000f0a0: 2064 6f20 7761 6e74 2069 7420 666f 7220   do want it for 
-0000f0b0: 6120 6461 736b 2053 6572 6965 730a 2020  a dask Series.  
-0000f0c0: 2020 2020 2020 2020 2020 6966 2069 735f            if is_
-0000f0d0: 7365 7269 6573 5f6c 696b 6528 7661 6c75  series_like(valu
-0000f0e0: 6529 2061 6e64 206e 6f74 2069 735f 6461  e) and not is_da
-0000f0f0: 736b 5f63 6f6c 6c65 6374 696f 6e28 7661  sk_collection(va
-0000f100: 6c75 6529 3a0a 2020 2020 2020 2020 2020  lue):.          
-0000f110: 2020 2020 2020 6172 6773 203d 2028 290a        args = ().
-0000f120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f130: 6b77 6172 6773 203d 207b 2276 616c 7565  kwargs = {"value
-0000f140: 223a 2076 616c 7565 7d0a 2020 2020 2020  ": value}.      
-0000f150: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000f160: 2020 2020 2020 2020 2020 2020 6172 6773              args
-0000f170: 203d 2028 7661 6c75 652c 290a 2020 2020   = (value,).    
-0000f180: 2020 2020 2020 2020 2020 2020 6b77 6172              kwar
-0000f190: 6773 203d 207b 7d0a 0a20 2020 2020 2020  gs = {}..       
-0000f1a0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000f1b0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-0000f1c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f1d0: 204d 2e66 696c 6c6e 612c 0a20 2020 2020   M.fillna,.     
-0000f1e0: 2020 2020 2020 2020 2020 202a 6172 6773             *args
-0000f1f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000f200: 2020 6c69 6d69 743d 6c69 6d69 742c 0a20    limit=limit,. 
-0000f210: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0000f220: 7869 733d 6178 6973 2c0a 2020 2020 2020  xis=axis,.      
-0000f230: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
-0000f240: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
-0000f250: 2020 2020 2065 6e66 6f72 6365 5f6d 6574       enforce_met
-0000f260: 6164 6174 613d 4661 6c73 652c 0a20 2020  adata=False,.   
-0000f270: 2020 2020 2020 2020 2020 2020 202a 2a6b               **k
-0000f280: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
-0000f290: 2020 2029 0a20 2020 2020 2020 2065 6c69     ).        eli
-0000f2a0: 6620 6d65 7468 6f64 2069 6e20 2822 7061  f method in ("pa
-0000f2b0: 6422 2c20 2266 6669 6c6c 2229 3a0a 2020  d", "ffill"):.  
-0000f2c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000f2d0: 2073 656c 662e 6666 696c 6c28 6c69 6d69   self.ffill(limi
-0000f2e0: 743d 6c69 6d69 742c 2061 7869 733d 6178  t=limit, axis=ax
-0000f2f0: 6973 290a 2020 2020 2020 2020 656c 7365  is).        else
-0000f300: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0000f310: 7475 726e 2073 656c 662e 6266 696c 6c28  turn self.bfill(
-0000f320: 6c69 6d69 743d 6c69 6d69 742c 2061 7869  limit=limit, axi
-0000f330: 733d 6178 6973 290a 0a20 2020 2040 6465  s=axis)..    @de
-0000f340: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-0000f350: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-0000f360: 2066 6669 6c6c 2873 656c 662c 2061 7869   ffill(self, axi
-0000f370: 733d 4e6f 6e65 2c20 6c69 6d69 743d 4e6f  s=None, limit=No
-0000f380: 6e65 293a 0a20 2020 2020 2020 2061 7869  ne):.        axi
-0000f390: 7320 3d20 7365 6c66 2e5f 7661 6c69 6461  s = self._valida
-0000f3a0: 7465 5f61 7869 7328 6178 6973 290a 2020  te_axis(axis).  
-0000f3b0: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
-0000f3c0: 662e 5f6d 6574 615f 6e6f 6e65 6d70 7479  f._meta_nonempty
-0000f3d0: 2e66 6669 6c6c 286c 696d 6974 3d6c 696d  .ffill(limit=lim
-0000f3e0: 6974 2c20 6178 6973 3d61 7869 7329 0a0a  it, axis=axis)..
-0000f3f0: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
-0000f400: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-0000f410: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
-0000f420: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
-0000f430: 2020 2020 2020 2020 2020 2020 2020 4d2e                M.
-0000f440: 6666 696c 6c2c 206c 696d 6974 3d6c 696d  ffill, limit=lim
-0000f450: 6974 2c20 6178 6973 3d61 7869 732c 206d  it, axis=axis, m
-0000f460: 6574 613d 6d65 7461 2c20 656e 666f 7263  eta=meta, enforc
-0000f470: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
-0000f480: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-0000f490: 2020 2020 2020 2020 6265 666f 7265 2c20          before, 
-0000f4a0: 6166 7465 7220 3d20 3120 6966 206c 696d  after = 1 if lim
-0000f4b0: 6974 2069 7320 4e6f 6e65 2065 6c73 6520  it is None else 
-0000f4c0: 6c69 6d69 742c 2030 0a20 2020 2020 2020  limit, 0.       
-0000f4d0: 2070 6172 7473 203d 2073 656c 662e 5f6c   parts = self._l
-0000f4e0: 696d 6974 5f66 696c 6c6e 6128 2266 6669  imit_fillna("ffi
-0000f4f0: 6c6c 222c 206c 696d 6974 3d6c 696d 6974  ll", limit=limit
-0000f500: 2c20 736b 6970 5f63 6865 636b 3d30 2c20  , skip_check=0, 
-0000f510: 6d65 7461 3d6d 6574 6129 0a20 2020 2020  meta=meta).     
-0000f520: 2020 2072 6574 7572 6e20 7061 7274 732e     return parts.
-0000f530: 6d61 705f 6f76 6572 6c61 7028 4d2e 6666  map_overlap(M.ff
-0000f540: 696c 6c2c 2062 6566 6f72 652c 2061 6674  ill, before, aft
-0000f550: 6572 2c20 6c69 6d69 743d 6c69 6d69 742c  er, limit=limit,
-0000f560: 206d 6574 613d 6d65 7461 290a 0a20 2020   meta=meta)..   
-0000f570: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-0000f580: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
-0000f590: 2064 6566 2062 6669 6c6c 2873 656c 662c   def bfill(self,
-0000f5a0: 2061 7869 733d 4e6f 6e65 2c20 6c69 6d69   axis=None, limi
-0000f5b0: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
-0000f5c0: 2061 7869 7320 3d20 7365 6c66 2e5f 7661   axis = self._va
-0000f5d0: 6c69 6461 7465 5f61 7869 7328 6178 6973  lidate_axis(axis
-0000f5e0: 290a 2020 2020 2020 2020 6d65 7461 203d  ).        meta =
-0000f5f0: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
-0000f600: 6d70 7479 2e62 6669 6c6c 286c 696d 6974  mpty.bfill(limit
-0000f610: 3d6c 696d 6974 2c20 6178 6973 3d61 7869  =limit, axis=axi
-0000f620: 7329 0a0a 2020 2020 2020 2020 6966 2061  s)..        if a
-0000f630: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
-0000f640: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000f650: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
-0000f660: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000f670: 2020 4d2e 6266 696c 6c2c 206c 696d 6974    M.bfill, limit
-0000f680: 3d6c 696d 6974 2c20 6178 6973 3d61 7869  =limit, axis=axi
-0000f690: 732c 206d 6574 613d 6d65 7461 2c20 656e  s, meta=meta, en
-0000f6a0: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
-0000f6b0: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-0000f6c0: 2029 0a0a 2020 2020 2020 2020 6265 666f   )..        befo
-0000f6d0: 7265 2c20 6166 7465 7220 3d20 302c 2031  re, after = 0, 1
-0000f6e0: 2069 6620 6c69 6d69 7420 6973 204e 6f6e   if limit is Non
-0000f6f0: 6520 656c 7365 206c 696d 6974 0a20 2020  e else limit.   
-0000f700: 2020 2020 2070 6172 7473 203d 2073 656c       parts = sel
-0000f710: 662e 5f6c 696d 6974 5f66 696c 6c6e 6128  f._limit_fillna(
-0000f720: 0a20 2020 2020 2020 2020 2020 2022 6266  .            "bf
-0000f730: 696c 6c22 2c20 6c69 6d69 743d 6c69 6d69  ill", limit=limi
-0000f740: 742c 2073 6b69 705f 6368 6563 6b3d 7365  t, skip_check=se
-0000f750: 6c66 2e6e 7061 7274 6974 696f 6e73 202d  lf.npartitions -
-0000f760: 2031 2c20 6d65 7461 3d6d 6574 610a 2020   1, meta=meta.  
-0000f770: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000f780: 7265 7475 726e 2070 6172 7473 2e6d 6170  return parts.map
-0000f790: 5f6f 7665 726c 6170 284d 2e62 6669 6c6c  _overlap(M.bfill
-0000f7a0: 2c20 6265 666f 7265 2c20 6166 7465 722c  , before, after,
-0000f7b0: 206c 696d 6974 3d6c 696d 6974 2c20 6d65   limit=limit, me
-0000f7c0: 7461 3d6d 6574 6129 0a0a 2020 2020 6465  ta=meta)..    de
-0000f7d0: 6620 7361 6d70 6c65 2873 656c 662c 206e  f sample(self, n
-0000f7e0: 3d4e 6f6e 652c 2066 7261 633d 4e6f 6e65  =None, frac=None
-0000f7f0: 2c20 7265 706c 6163 653d 4661 6c73 652c  , replace=False,
-0000f800: 2072 616e 646f 6d5f 7374 6174 653d 4e6f   random_state=No
-0000f810: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
-0000f820: 5261 6e64 6f6d 2073 616d 706c 6520 6f66  Random sample of
-0000f830: 2069 7465 6d73 0a0a 2020 2020 2020 2020   items..        
-0000f840: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-0000f850: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-0000f860: 2020 2020 2020 6e20 3a20 696e 742c 206f        n : int, o
-0000f870: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-0000f880: 2020 2020 4e75 6d62 6572 206f 6620 6974      Number of it
-0000f890: 656d 7320 746f 2072 6574 7572 6e20 6973  ems to return is
-0000f8a0: 206e 6f74 2073 7570 706f 7274 6564 2062   not supported b
-0000f8b0: 7920 6461 736b 2e20 5573 6520 6672 6163  y dask. Use frac
-0000f8c0: 0a20 2020 2020 2020 2020 2020 2069 6e73  .            ins
-0000f8d0: 7465 6164 2e0a 2020 2020 2020 2020 6672  tead..        fr
-0000f8e0: 6163 203a 2066 6c6f 6174 2c20 6f70 7469  ac : float, opti
-0000f8f0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-0000f900: 2041 7070 726f 7869 6d61 7465 2066 7261   Approximate fra
-0000f910: 6374 696f 6e20 6f66 2069 7465 6d73 2074  ction of items t
-0000f920: 6f20 7265 7475 726e 2e20 5468 6973 2073  o return. This s
-0000f930: 616d 706c 696e 6720 6672 6163 7469 6f6e  ampling fraction
-0000f940: 2069 730a 2020 2020 2020 2020 2020 2020   is.            
-0000f950: 6170 706c 6965 6420 746f 2061 6c6c 2070  applied to all p
-0000f960: 6172 7469 7469 6f6e 7320 6571 7561 6c6c  artitions equall
-0000f970: 792e 204e 6f74 6520 7468 6174 2074 6869  y. Note that thi
-0000f980: 7320 6973 2061 6e0a 2020 2020 2020 2020  s is an.        
-0000f990: 2020 2020 2a2a 6170 7072 6f78 696d 6174      **approximat
-0000f9a0: 6520 6672 6163 7469 6f6e 2a2a 2e20 596f  e fraction**. Yo
-0000f9b0: 7520 7368 6f75 6c64 206e 6f74 2065 7870  u should not exp
-0000f9c0: 6563 7420 6578 6163 746c 7920 6060 6c65  ect exactly ``le
-0000f9d0: 6e28 6466 2920 2a20 6672 6163 6060 0a20  n(df) * frac``. 
-0000f9e0: 2020 2020 2020 2020 2020 2069 7465 6d73             items
-0000f9f0: 2074 6f20 6265 2072 6574 7572 6e65 642c   to be returned,
-0000fa00: 2061 7320 7468 6520 6578 6163 7420 6e75   as the exact nu
-0000fa10: 6d62 6572 206f 6620 656c 656d 656e 7473  mber of elements
-0000fa20: 2073 656c 6563 7465 6420 7769 6c6c 0a20   selected will. 
-0000fa30: 2020 2020 2020 2020 2020 2064 6570 656e             depen
-0000fa40: 6420 6f6e 2068 6f77 2079 6f75 7220 6461  d on how your da
-0000fa50: 7461 2069 7320 7061 7274 6974 696f 6e65  ta is partitione
-0000fa60: 6420 2862 7574 2073 686f 756c 6420 6265  d (but should be
-0000fa70: 2070 7265 7474 7920 636c 6f73 650a 2020   pretty close.  
-0000fa80: 2020 2020 2020 2020 2020 696e 2070 7261            in pra
-0000fa90: 6374 6963 6529 2e0a 2020 2020 2020 2020  ctice)..        
-0000faa0: 7265 706c 6163 6520 3a20 626f 6f6c 6561  replace : boolea
-0000fab0: 6e2c 206f 7074 696f 6e61 6c0a 2020 2020  n, optional.    
-0000fac0: 2020 2020 2020 2020 5361 6d70 6c65 2077          Sample w
-0000fad0: 6974 6820 6f72 2077 6974 686f 7574 2072  ith or without r
-0000fae0: 6570 6c61 6365 6d65 6e74 2e20 4465 6661  eplacement. Defa
-0000faf0: 756c 7420 3d20 4661 6c73 652e 0a20 2020  ult = False..   
-0000fb00: 2020 2020 2072 616e 646f 6d5f 7374 6174       random_stat
-0000fb10: 6520 3a20 696e 7420 6f72 2060 606e 702e  e : int or ``np.
-0000fb20: 7261 6e64 6f6d 2e52 616e 646f 6d53 7461  random.RandomSta
-0000fb30: 7465 6060 0a20 2020 2020 2020 2020 2020  te``.           
-0000fb40: 2049 6620 616e 2069 6e74 2c20 7765 2063   If an int, we c
-0000fb50: 7265 6174 6520 6120 6e65 7720 5261 6e64  reate a new Rand
-0000fb60: 6f6d 5374 6174 6520 7769 7468 2074 6869  omState with thi
-0000fb70: 7320 6173 2074 6865 2073 6565 643b 0a20  s as the seed;. 
-0000fb80: 2020 2020 2020 2020 2020 204f 7468 6572             Other
-0000fb90: 7769 7365 2077 6520 6472 6177 2066 726f  wise we draw fro
-0000fba0: 6d20 7468 6520 7061 7373 6564 2052 616e  m the passed Ran
-0000fbb0: 646f 6d53 7461 7465 2e0a 0a20 2020 2020  domState...     
-0000fbc0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
-0000fbd0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-0000fbe0: 2020 2020 2044 6174 6146 7261 6d65 2e72       DataFrame.r
-0000fbf0: 616e 646f 6d5f 7370 6c69 740a 2020 2020  andom_split.    
-0000fc00: 2020 2020 7061 6e64 6173 2e44 6174 6146      pandas.DataF
-0000fc10: 7261 6d65 2e73 616d 706c 650a 2020 2020  rame.sample.    
-0000fc20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000fc30: 6966 206e 2069 7320 6e6f 7420 4e6f 6e65  if n is not None
-0000fc40: 3a0a 2020 2020 2020 2020 2020 2020 6d73  :.            ms
-0000fc50: 6720 3d20 280a 2020 2020 2020 2020 2020  g = (.          
-0000fc60: 2020 2020 2020 2273 616d 706c 6520 646f        "sample do
-0000fc70: 6573 206e 6f74 2073 7570 706f 7274 2074  es not support t
-0000fc80: 6865 206e 756d 6265 7220 6f66 2073 616d  he number of sam
-0000fc90: 706c 6564 2069 7465 6d73 2022 0a20 2020  pled items ".   
-0000fca0: 2020 2020 2020 2020 2020 2020 2022 7061               "pa
-0000fcb0: 7261 6d65 7465 722c 2027 6e27 2e20 506c  rameter, 'n'. Pl
-0000fcc0: 6561 7365 2075 7365 2074 6865 2027 6672  ease use the 'fr
-0000fcd0: 6163 2720 7061 7261 6d65 7465 7220 696e  ac' parameter in
-0000fce0: 7374 6561 642e 220a 2020 2020 2020 2020  stead.".        
-0000fcf0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0000fd00: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0000fd10: 6e2c 204e 756d 6265 7229 2061 6e64 2030  n, Number) and 0
-0000fd20: 203c 3d20 6e20 3c3d 2031 3a0a 2020 2020   <= n <= 1:.    
-0000fd30: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-0000fd40: 696e 6773 2e77 6172 6e28 6d73 6729 0a20  ings.warn(msg). 
-0000fd50: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000fd60: 7261 6320 3d20 6e0a 2020 2020 2020 2020  rac = n.        
-0000fd70: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000fd80: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000fd90: 5661 6c75 6545 7272 6f72 286d 7367 290a  ValueError(msg).
-0000fda0: 0a20 2020 2020 2020 2069 6620 6672 6163  .        if frac
-0000fdb0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0000fdc0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0000fdd0: 6545 7272 6f72 2822 6672 6163 206d 7573  eError("frac mus
-0000fde0: 7420 6e6f 7420 6265 204e 6f6e 6522 290a  t not be None").
-0000fdf0: 0a20 2020 2020 2020 2069 6620 7261 6e64  .        if rand
-0000fe00: 6f6d 5f73 7461 7465 2069 7320 4e6f 6e65  om_state is None
-0000fe10: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0000fe20: 6e64 6f6d 5f73 7461 7465 203d 206e 702e  ndom_state = np.
-0000fe30: 7261 6e64 6f6d 2e52 616e 646f 6d53 7461  random.RandomSta
-0000fe40: 7465 2829 0a0a 2020 2020 2020 2020 6e61  te()..        na
-0000fe50: 6d65 203d 2022 7361 6d70 6c65 2d22 202b  me = "sample-" +
-0000fe60: 2074 6f6b 656e 697a 6528 7365 6c66 2c20   tokenize(self, 
-0000fe70: 6672 6163 2c20 7265 706c 6163 652c 2072  frac, replace, r
-0000fe80: 616e 646f 6d5f 7374 6174 6529 0a0a 2020  andom_state)..  
-0000fe90: 2020 2020 2020 7374 6174 655f 6461 7461        state_data
-0000fea0: 203d 2072 616e 646f 6d5f 7374 6174 655f   = random_state_
-0000feb0: 6461 7461 2873 656c 662e 6e70 6172 7469  data(self.nparti
-0000fec0: 7469 6f6e 732c 2072 616e 646f 6d5f 7374  tions, random_st
-0000fed0: 6174 6529 0a20 2020 2020 2020 2064 736b  ate).        dsk
-0000fee0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0000fef0: 2028 6e61 6d65 2c20 6929 3a20 286d 6574   (name, i): (met
-0000ff00: 686f 6473 2e73 616d 706c 652c 2028 7365  hods.sample, (se
-0000ff10: 6c66 2e5f 6e61 6d65 2c20 6929 2c20 7374  lf._name, i), st
-0000ff20: 6174 652c 2066 7261 632c 2072 6570 6c61  ate, frac, repla
-0000ff30: 6365 290a 2020 2020 2020 2020 2020 2020  ce).            
-0000ff40: 666f 7220 692c 2073 7461 7465 2069 6e20  for i, state in 
-0000ff50: 656e 756d 6572 6174 6528 7374 6174 655f  enumerate(state_
-0000ff60: 6461 7461 290a 2020 2020 2020 2020 7d0a  data).        }.
-0000ff70: 0a20 2020 2020 2020 2067 7261 7068 203d  .        graph =
-0000ff80: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
-0000ff90: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
-0000ffa0: 286e 616d 652c 2064 736b 2c20 6465 7065  (name, dsk, depe
-0000ffb0: 6e64 656e 6369 6573 3d5b 7365 6c66 5d29  ndencies=[self])
-0000ffc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000ffd0: 6e65 775f 6464 5f6f 626a 6563 7428 6772  new_dd_object(gr
-0000ffe0: 6170 682c 206e 616d 652c 2073 656c 662e  aph, name, self.
-0000fff0: 5f6d 6574 612c 2073 656c 662e 6469 7669  _meta, self.divi
-00010000: 7369 6f6e 7329 0a0a 2020 2020 4064 6572  sions)..    @der
-00010010: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00010020: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00010030: 7265 706c 6163 6528 7365 6c66 2c20 746f  replace(self, to
-00010040: 5f72 6570 6c61 6365 3d4e 6f6e 652c 2076  _replace=None, v
-00010050: 616c 7565 3d4e 6f6e 652c 2072 6567 6578  alue=None, regex
-00010060: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
-00010070: 2023 2049 6e20 5041 4e44 4153 5f47 545f   # In PANDAS_GT_
-00010080: 3134 3020 7061 6e64 6173 2073 7461 7274  140 pandas start
-00010090: 7320 7573 696e 6720 6e6f 5f64 6566 6175  s using no_defau
-000100a0: 6c74 2069 6e73 7465 6164 206f 6620 4e6f  lt instead of No
-000100b0: 6e65 0a20 2020 2020 2020 2076 616c 7565  ne.        value
-000100c0: 5f6b 7761 7267 203d 207b 2276 616c 7565  _kwarg = {"value
-000100d0: 223a 2076 616c 7565 7d20 6966 2076 616c  ": value} if val
-000100e0: 7565 2069 7320 6e6f 7420 4e6f 6e65 2065  ue is not None e
-000100f0: 6c73 6520 7b7d 0a20 2020 2020 2020 2072  lse {}.        r
-00010100: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
-00010110: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-00010120: 2020 2020 2020 204d 2e72 6570 6c61 6365         M.replace
-00010130: 2c0a 2020 2020 2020 2020 2020 2020 746f  ,.            to
-00010140: 5f72 6570 6c61 6365 3d74 6f5f 7265 706c  _replace=to_repl
-00010150: 6163 652c 0a20 2020 2020 2020 2020 2020  ace,.           
-00010160: 202a 2a76 616c 7565 5f6b 7761 7267 2c0a   **value_kwarg,.
-00010170: 2020 2020 2020 2020 2020 2020 7265 6765              rege
-00010180: 783d 7265 6765 782c 0a20 2020 2020 2020  x=regex,.       
-00010190: 2020 2020 2065 6e66 6f72 6365 5f6d 6574       enforce_met
-000101a0: 6164 6174 613d 4661 6c73 652c 0a20 2020  adata=False,.   
-000101b0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-000101c0: 746f 5f64 6173 6b5f 6172 7261 7928 7365  to_dask_array(se
-000101d0: 6c66 2c20 6c65 6e67 7468 733d 4e6f 6e65  lf, lengths=None
-000101e0: 2c20 6d65 7461 3d4e 6f6e 6529 3a0a 2020  , meta=None):.  
-000101f0: 2020 2020 2020 2222 2243 6f6e 7665 7274        """Convert
-00010200: 2061 2064 6173 6b20 4461 7461 4672 616d   a dask DataFram
-00010210: 6520 746f 2061 2064 6173 6b20 6172 7261  e to a dask arra
-00010220: 792e 0a0a 2020 2020 2020 2020 5061 7261  y...        Para
-00010230: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-00010240: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00010250: 2020 6c65 6e67 7468 7320 3a20 626f 6f6c    lengths : bool
-00010260: 206f 7220 5365 7175 656e 6365 206f 6620   or Sequence of 
-00010270: 696e 7473 2c20 6f70 7469 6f6e 616c 0a20  ints, optional. 
-00010280: 2020 2020 2020 2020 2020 2048 6f77 2074             How t
-00010290: 6f20 6465 7465 726d 696e 6520 7468 6520  o determine the 
-000102a0: 6368 756e 6b73 2073 697a 6573 2066 6f72  chunks sizes for
-000102b0: 2074 6865 206f 7574 7075 7420 6172 7261   the output arra
-000102c0: 792e 0a20 2020 2020 2020 2020 2020 2042  y..            B
-000102d0: 7920 6465 6661 756c 742c 2074 6865 206f  y default, the o
-000102e0: 7574 7075 7420 6172 7261 7920 7769 6c6c  utput array will
-000102f0: 2068 6176 6520 756e 6b6e 6f77 6e20 6368   have unknown ch
-00010300: 756e 6b20 6c65 6e67 7468 730a 2020 2020  unk lengths.    
-00010310: 2020 2020 2020 2020 616c 6f6e 6720 7468          along th
-00010320: 6520 6669 7273 7420 6178 6973 2c20 7768  e first axis, wh
-00010330: 6963 6820 6361 6e20 6361 7573 6520 736f  ich can cause so
-00010340: 6d65 206c 6174 6572 206f 7065 7261 7469  me later operati
-00010350: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
-00010360: 746f 2066 6169 6c2e 0a0a 2020 2020 2020  to fail...      
-00010370: 2020 2020 2020 2a20 5472 7565 203a 2069        * True : i
-00010380: 6d6d 6564 6961 7465 6c79 2063 6f6d 7075  mmediately compu
-00010390: 7465 2074 6865 206c 656e 6774 6820 6f66  te the length of
-000103a0: 2065 6163 6820 7061 7274 6974 696f 6e0a   each partition.
-000103b0: 2020 2020 2020 2020 2020 2020 2a20 5365              * Se
-000103c0: 7175 656e 6365 203a 2061 2073 6571 7565  quence : a seque
-000103d0: 6e63 6520 6f66 2069 6e74 6567 6572 7320  nce of integers 
-000103e0: 746f 2075 7365 2066 6f72 2074 6865 2063  to use for the c
-000103f0: 6875 6e6b 2073 697a 6573 0a20 2020 2020  hunk sizes.     
-00010400: 2020 2020 2020 2020 206f 6e20 7468 6520           on the 
-00010410: 6669 7273 7420 6178 6973 2e20 5468 6573  first axis. Thes
-00010420: 6520 7661 6c75 6573 2061 7265 202a 6e6f  e values are *no
-00010430: 742a 2076 616c 6964 6174 6564 2066 6f72  t* validated for
-00010440: 0a20 2020 2020 2020 2020 2020 2020 2063  .              c
-00010450: 6f72 7265 6374 6e65 7373 2c20 6265 796f  orrectness, beyo
-00010460: 6e64 2065 6e73 7572 696e 6720 7468 6174  nd ensuring that
-00010470: 2074 6865 206e 756d 6265 7220 6f66 2069   the number of i
-00010480: 7465 6d73 0a20 2020 2020 2020 2020 2020  tems.           
-00010490: 2020 206d 6174 6368 6573 2074 6865 206e     matches the n
-000104a0: 756d 6265 7220 6f66 2070 6172 7469 7469  umber of partiti
-000104b0: 6f6e 732e 0a20 2020 2020 2020 206d 6574  ons..        met
-000104c0: 6120 3a20 6f62 6a65 6374 2c20 6f70 7469  a : object, opti
-000104d0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-000104e0: 2041 6e20 6f70 7469 6f6e 616c 2060 6d65   An optional `me
-000104f0: 7461 6020 7061 7261 6d65 7465 7220 6361  ta` parameter ca
-00010500: 6e20 6265 2070 6173 7365 6420 666f 7220  n be passed for 
-00010510: 6461 736b 2074 6f20 6f76 6572 7269 6465  dask to override
-00010520: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-00010530: 2064 6566 6175 6c74 206d 6574 6164 6174   default metadat
-00010540: 6120 6f6e 2074 6865 2075 6e64 6572 6c79  a on the underly
-00010550: 696e 6720 6461 736b 2061 7272 6179 2e0a  ing dask array..
-00010560: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00010570: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00010580: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00010590: 2020 2020 2069 6620 6c65 6e67 7468 7320       if lengths 
-000105a0: 6973 2054 7275 653a 0a20 2020 2020 2020  is True:.       
-000105b0: 2020 2020 206c 656e 6774 6873 203d 2074       lengths = t
-000105c0: 7570 6c65 2873 656c 662e 6d61 705f 7061  uple(self.map_pa
-000105d0: 7274 6974 696f 6e73 286c 656e 2c20 656e  rtitions(len, en
-000105e0: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
-000105f0: 616c 7365 292e 636f 6d70 7574 6528 2929  alse).compute())
-00010600: 0a0a 2020 2020 2020 2020 6172 7220 3d20  ..        arr = 
-00010610: 7365 6c66 2e76 616c 7565 730a 0a20 2020  self.values..   
-00010620: 2020 2020 2063 6875 6e6b 7320 3d20 7365       chunks = se
-00010630: 6c66 2e5f 7661 6c69 6461 7465 5f63 6875  lf._validate_chu
-00010640: 6e6b 7328 6172 722c 206c 656e 6774 6873  nks(arr, lengths
-00010650: 290a 2020 2020 2020 2020 6172 722e 5f63  ).        arr._c
-00010660: 6875 6e6b 7320 3d20 6368 756e 6b73 0a0a  hunks = chunks..
-00010670: 2020 2020 2020 2020 6966 206d 6574 6120          if meta 
-00010680: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00010690: 2020 2020 2020 2020 2061 7272 2e5f 6d65           arr._me
-000106a0: 7461 203d 206d 6574 610a 0a20 2020 2020  ta = meta..     
-000106b0: 2020 2072 6574 7572 6e20 6172 720a 0a20     return arr.. 
-000106c0: 2020 2064 6566 2074 6f5f 6864 6628 7365     def to_hdf(se
-000106d0: 6c66 2c20 7061 7468 5f6f 725f 6275 662c  lf, path_or_buf,
-000106e0: 206b 6579 2c20 6d6f 6465 3d22 6122 2c20   key, mode="a", 
-000106f0: 6170 7065 6e64 3d46 616c 7365 2c20 2a2a  append=False, **
-00010700: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
-00010710: 2022 2222 5365 6520 6464 2e74 6f5f 6864   """See dd.to_hd
-00010720: 6620 646f 6373 7472 696e 6720 666f 7220  f docstring for 
-00010730: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
-00010740: 2222 220a 2020 2020 2020 2020 6672 6f6d  """.        from
-00010750: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
-00010760: 696f 2069 6d70 6f72 7420 746f 5f68 6466  io import to_hdf
-00010770: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00010780: 2074 6f5f 6864 6628 7365 6c66 2c20 7061   to_hdf(self, pa
-00010790: 7468 5f6f 725f 6275 662c 206b 6579 2c20  th_or_buf, key, 
-000107a0: 6d6f 6465 2c20 6170 7065 6e64 2c20 2a2a  mode, append, **
-000107b0: 6b77 6172 6773 290a 0a20 2020 2064 6566  kwargs)..    def
-000107c0: 2074 6f5f 6373 7628 7365 6c66 2c20 6669   to_csv(self, fi
-000107d0: 6c65 6e61 6d65 2c20 2a2a 6b77 6172 6773  lename, **kwargs
-000107e0: 293a 0a20 2020 2020 2020 2022 2222 5365  ):.        """Se
-000107f0: 6520 6464 2e74 6f5f 6373 7620 646f 6373  e dd.to_csv docs
-00010800: 7472 696e 6720 666f 7220 6d6f 7265 2069  tring for more i
-00010810: 6e66 6f72 6d61 7469 6f6e 2222 220a 2020  nformation""".  
-00010820: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-00010830: 6461 7461 6672 616d 652e 696f 2069 6d70  dataframe.io imp
-00010840: 6f72 7420 746f 5f63 7376 0a0a 2020 2020  ort to_csv..    
-00010850: 2020 2020 7265 7475 726e 2074 6f5f 6373      return to_cs
-00010860: 7628 7365 6c66 2c20 6669 6c65 6e61 6d65  v(self, filename
-00010870: 2c20 2a2a 6b77 6172 6773 290a 0a20 2020  , **kwargs)..   
-00010880: 2064 6566 2074 6f5f 7371 6c28 0a20 2020   def to_sql(.   
-00010890: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-000108a0: 2020 206e 616d 653a 2073 7472 2c0a 2020     name: str,.  
-000108b0: 2020 2020 2020 7572 693a 2073 7472 2c0a        uri: str,.
-000108c0: 2020 2020 2020 2020 7363 6865 6d61 3d4e          schema=N
-000108d0: 6f6e 652c 0a20 2020 2020 2020 2069 665f  one,.        if_
-000108e0: 6578 6973 7473 3a20 7374 7220 3d20 2266  exists: str = "f
-000108f0: 6169 6c22 2c0a 2020 2020 2020 2020 696e  ail",.        in
-00010900: 6465 783a 2062 6f6f 6c20 3d20 5472 7565  dex: bool = True
-00010910: 2c0a 2020 2020 2020 2020 696e 6465 785f  ,.        index_
-00010920: 6c61 6265 6c3d 4e6f 6e65 2c0a 2020 2020  label=None,.    
-00010930: 2020 2020 6368 756e 6b73 697a 653d 4e6f      chunksize=No
-00010940: 6e65 2c0a 2020 2020 2020 2020 6474 7970  ne,.        dtyp
-00010950: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-00010960: 6d65 7468 6f64 3d4e 6f6e 652c 0a20 2020  method=None,.   
-00010970: 2020 2020 2063 6f6d 7075 7465 3d54 7275       compute=Tru
-00010980: 652c 0a20 2020 2020 2020 2070 6172 616c  e,.        paral
-00010990: 6c65 6c3d 4661 6c73 652c 0a20 2020 2020  lel=False,.     
-000109a0: 2020 2065 6e67 696e 655f 6b77 6172 6773     engine_kwargs
-000109b0: 3d4e 6f6e 652c 0a20 2020 2029 3a0a 2020  =None,.    ):.  
-000109c0: 2020 2020 2020 2222 2253 6565 2064 642e        """See dd.
-000109d0: 746f 5f73 716c 2064 6f63 7374 7269 6e67  to_sql docstring
-000109e0: 2066 6f72 206d 6f72 6520 696e 666f 726d   for more inform
-000109f0: 6174 696f 6e22 2222 0a20 2020 2020 2020  ation""".       
-00010a00: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
-00010a10: 7261 6d65 2e69 6f20 696d 706f 7274 2074  rame.io import t
-00010a20: 6f5f 7371 6c0a 0a20 2020 2020 2020 2072  o_sql..        r
-00010a30: 6574 7572 6e20 746f 5f73 716c 280a 2020  eturn to_sql(.  
-00010a40: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
-00010a50: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00010a60: 3d6e 616d 652c 0a20 2020 2020 2020 2020  =name,.         
-00010a70: 2020 2075 7269 3d75 7269 2c0a 2020 2020     uri=uri,.    
-00010a80: 2020 2020 2020 2020 7363 6865 6d61 3d73          schema=s
-00010a90: 6368 656d 612c 0a20 2020 2020 2020 2020  chema,.         
-00010aa0: 2020 2069 665f 6578 6973 7473 3d69 665f     if_exists=if_
-00010ab0: 6578 6973 7473 2c0a 2020 2020 2020 2020  exists,.        
-00010ac0: 2020 2020 696e 6465 783d 696e 6465 782c      index=index,
-00010ad0: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-00010ae0: 6578 5f6c 6162 656c 3d69 6e64 6578 5f6c  ex_label=index_l
-00010af0: 6162 656c 2c0a 2020 2020 2020 2020 2020  abel,.          
-00010b00: 2020 6368 756e 6b73 697a 653d 6368 756e    chunksize=chun
-00010b10: 6b73 697a 652c 0a20 2020 2020 2020 2020  ksize,.         
-00010b20: 2020 2064 7479 7065 3d64 7479 7065 2c0a     dtype=dtype,.
-00010b30: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-00010b40: 6f64 3d6d 6574 686f 642c 0a20 2020 2020  od=method,.     
-00010b50: 2020 2020 2020 2063 6f6d 7075 7465 3d63         compute=c
-00010b60: 6f6d 7075 7465 2c0a 2020 2020 2020 2020  ompute,.        
-00010b70: 2020 2020 7061 7261 6c6c 656c 3d70 6172      parallel=par
-00010b80: 616c 6c65 6c2c 0a20 2020 2020 2020 2020  allel,.         
-00010b90: 2020 2065 6e67 696e 655f 6b77 6172 6773     engine_kwargs
-00010ba0: 3d65 6e67 696e 655f 6b77 6172 6773 2c0a  =engine_kwargs,.
-00010bb0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00010bc0: 6566 2074 6f5f 6a73 6f6e 2873 656c 662c  ef to_json(self,
-00010bd0: 2066 696c 656e 616d 652c 202a 6172 6773   filename, *args
-00010be0: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00010bf0: 2020 2020 2022 2222 5365 6520 6464 2e74       """See dd.t
-00010c00: 6f5f 6a73 6f6e 2064 6f63 7374 7269 6e67  o_json docstring
-00010c10: 2066 6f72 206d 6f72 6520 696e 666f 726d   for more inform
-00010c20: 6174 696f 6e22 2222 0a20 2020 2020 2020  ation""".       
-00010c30: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
-00010c40: 7261 6d65 2e69 6f20 696d 706f 7274 2074  rame.io import t
-00010c50: 6f5f 6a73 6f6e 0a0a 2020 2020 2020 2020  o_json..        
-00010c60: 7265 7475 726e 2074 6f5f 6a73 6f6e 2873  return to_json(s
-00010c70: 656c 662c 2066 696c 656e 616d 652c 202a  elf, filename, *
-00010c80: 6172 6773 2c20 2a2a 6b77 6172 6773 290a  args, **kwargs).
-00010c90: 0a20 2020 2064 6566 2074 6f5f 6465 6c61  .    def to_dela
-00010ca0: 7965 6428 7365 6c66 2c20 6f70 7469 6d69  yed(self, optimi
-00010cb0: 7a65 5f67 7261 7068 3d54 7275 6529 3a0a  ze_graph=True):.
-00010cc0: 2020 2020 2020 2020 2222 2243 6f6e 7665          """Conve
-00010cd0: 7274 2069 6e74 6f20 6120 6c69 7374 206f  rt into a list o
-00010ce0: 6620 6060 6461 736b 2e64 656c 6179 6564  f ``dask.delayed
-00010cf0: 6060 206f 626a 6563 7473 2c20 6f6e 6520  `` objects, one 
-00010d00: 7065 7220 7061 7274 6974 696f 6e2e 0a0a  per partition...
-00010d10: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00010d20: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00010d30: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6f70  -----.        op
-00010d40: 7469 6d69 7a65 5f67 7261 7068 203a 2062  timize_graph : b
-00010d50: 6f6f 6c2c 206f 7074 696f 6e61 6c0a 2020  ool, optional.  
-00010d60: 2020 2020 2020 2020 2020 4966 2054 7275            If Tru
-00010d70: 6520 5b64 6566 6175 6c74 5d2c 2074 6865  e [default], the
-00010d80: 2067 7261 7068 2069 7320 6f70 7469 6d69   graph is optimi
-00010d90: 7a65 6420 6265 666f 7265 2063 6f6e 7665  zed before conve
-00010da0: 7274 696e 6720 696e 746f 0a20 2020 2020  rting into.     
-00010db0: 2020 2020 2020 2060 6064 6173 6b2e 6465         ``dask.de
-00010dc0: 6c61 7965 6460 6020 6f62 6a65 6374 732e  layed`` objects.
-00010dd0: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-00010de0: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-00010df0: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
-00010e00: 7061 7274 6974 696f 6e73 203d 2064 662e  partitions = df.
-00010e10: 746f 5f64 656c 6179 6564 2829 2020 2320  to_delayed()  # 
-00010e20: 646f 6374 6573 743a 202b 534b 4950 0a0a  doctest: +SKIP..
-00010e30: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
-00010e40: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00010e50: 2d0a 2020 2020 2020 2020 6461 736b 2e64  -.        dask.d
-00010e60: 6174 6166 7261 6d65 2e66 726f 6d5f 6465  ataframe.from_de
-00010e70: 6c61 7965 640a 2020 2020 2020 2020 2222  layed.        ""
-00010e80: 220a 2020 2020 2020 2020 6b65 7973 203d  ".        keys =
-00010e90: 2073 656c 662e 5f5f 6461 736b 5f6b 6579   self.__dask_key
-00010ea0: 735f 5f28 290a 2020 2020 2020 2020 6772  s__().        gr
-00010eb0: 6170 6820 3d20 7365 6c66 2e5f 5f64 6173  aph = self.__das
-00010ec0: 6b5f 6772 6170 685f 5f28 290a 2020 2020  k_graph__().    
-00010ed0: 2020 2020 6c61 7965 7220 3d20 7365 6c66      layer = self
-00010ee0: 2e5f 5f64 6173 6b5f 6c61 7965 7273 5f5f  .__dask_layers__
-00010ef0: 2829 5b30 5d0a 2020 2020 2020 2020 6966  ()[0].        if
-00010f00: 206f 7074 696d 697a 655f 6772 6170 683a   optimize_graph:
-00010f10: 0a20 2020 2020 2020 2020 2020 2067 7261  .            gra
-00010f20: 7068 203d 2073 656c 662e 5f5f 6461 736b  ph = self.__dask
-00010f30: 5f6f 7074 696d 697a 655f 5f28 6772 6170  _optimize__(grap
-00010f40: 682c 2073 656c 662e 5f5f 6461 736b 5f6b  h, self.__dask_k
-00010f50: 6579 735f 5f28 2929 0a20 2020 2020 2020  eys__()).       
-00010f60: 2020 2020 206c 6179 6572 203d 2022 6465       layer = "de
-00010f70: 6c61 7965 642d 2220 2b20 7365 6c66 2e5f  layed-" + self._
-00010f80: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
-00010f90: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
-00010fa0: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
-00010fb0: 6c65 6374 696f 6e73 286c 6179 6572 2c20  lections(layer, 
-00010fc0: 6772 6170 682c 2064 6570 656e 6465 6e63  graph, dependenc
-00010fd0: 6965 733d 2829 290a 2020 2020 2020 2020  ies=()).        
-00010fe0: 7265 7475 726e 205b 4465 6c61 7965 6428  return [Delayed(
-00010ff0: 6b2c 2067 7261 7068 2c20 6c61 7965 723d  k, graph, layer=
-00011000: 6c61 7965 7229 2066 6f72 206b 2069 6e20  layer) for k in 
-00011010: 6b65 7973 5d0a 0a20 2020 2064 6566 2074  keys]..    def t
-00011020: 6f5f 6261 636b 656e 6428 7365 6c66 2c20  o_backend(self, 
-00011030: 6261 636b 656e 643a 2073 7472 207c 204e  backend: str | N
-00011040: 6f6e 6520 3d20 4e6f 6e65 2c20 2a2a 6b77  one = None, **kw
-00011050: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
-00011060: 2222 4d6f 7665 2074 6f20 6120 6e65 7720  ""Move to a new 
-00011070: 4461 7461 4672 616d 6520 6261 636b 656e  DataFrame backen
-00011080: 640a 0a20 2020 2020 2020 2050 6172 616d  d..        Param
-00011090: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-000110a0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-000110b0: 2062 6163 6b65 6e64 203a 2073 7472 2c20   backend : str, 
-000110c0: 4f70 7469 6f6e 616c 0a20 2020 2020 2020  Optional.       
-000110d0: 2020 2020 2054 6865 206e 616d 6520 6f66       The name of
-000110e0: 2074 6865 206e 6577 2062 6163 6b65 6e64   the new backend
-000110f0: 2074 6f20 6d6f 7665 2074 6f2e 2054 6865   to move to. The
-00011100: 2064 6566 6175 6c74 0a20 2020 2020 2020   default.       
-00011110: 2020 2020 2069 7320 7468 6520 6375 7272       is the curr
-00011120: 656e 7420 2264 6174 6166 7261 6d65 2e62  ent "dataframe.b
-00011130: 6163 6b65 6e64 2220 636f 6e66 6967 7572  ackend" configur
-00011140: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
-00011150: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-00011160: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00011170: 4461 7461 4672 616d 652c 2053 6572 6965  DataFrame, Serie
-00011180: 7320 6f72 2049 6e64 6578 0a20 2020 2020  s or Index.     
-00011190: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-000111a0: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-000111b0: 6d65 2e69 6f20 696d 706f 7274 2074 6f5f  me.io import to_
-000111c0: 6261 636b 656e 640a 0a20 2020 2020 2020  backend..       
-000111d0: 2072 6574 7572 6e20 746f 5f62 6163 6b65   return to_backe
-000111e0: 6e64 2873 656c 662c 2062 6163 6b65 6e64  nd(self, backend
-000111f0: 3d62 6163 6b65 6e64 2c20 2a2a 6b77 6172  =backend, **kwar
-00011200: 6773 290a 0a20 2020 2040 636c 6173 736d  gs)..    @classm
-00011210: 6574 686f 640a 2020 2020 6465 6620 5f67  ethod.    def _g
-00011220: 6574 5f75 6e61 7279 5f6f 7065 7261 746f  et_unary_operato
-00011230: 7228 636c 732c 206f 7029 3a0a 2020 2020  r(cls, op):.    
-00011240: 2020 2020 7265 7475 726e 206c 616d 6264      return lambd
-00011250: 6120 7365 6c66 3a20 656c 656d 7769 7365  a self: elemwise
-00011260: 286f 702c 2073 656c 6629 0a0a 2020 2020  (op, self)..    
-00011270: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
-00011280: 2064 6566 205f 6765 745f 6269 6e61 7279   def _get_binary
-00011290: 5f6f 7065 7261 746f 7228 636c 732c 206f  _operator(cls, o
-000112a0: 702c 2069 6e76 3d46 616c 7365 293a 0a20  p, inv=False):. 
-000112b0: 2020 2020 2020 2069 6620 696e 763a 0a20         if inv:. 
-000112c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000112d0: 6e20 6c61 6d62 6461 2073 656c 662c 206f  n lambda self, o
-000112e0: 7468 6572 3a20 656c 656d 7769 7365 286f  ther: elemwise(o
-000112f0: 702c 206f 7468 6572 2c20 7365 6c66 290a  p, other, self).
-00011300: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00011310: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00011320: 206c 616d 6264 6120 7365 6c66 2c20 6f74   lambda self, ot
-00011330: 6865 723a 2065 6c65 6d77 6973 6528 6f70  her: elemwise(op
-00011340: 2c20 7365 6c66 2c20 6f74 6865 7229 0a0a  , self, other)..
-00011350: 2020 2020 6465 6620 726f 6c6c 696e 6728      def rolling(
-00011360: 0a20 2020 2020 2020 2073 656c 662c 2077  .        self, w
-00011370: 696e 646f 772c 206d 696e 5f70 6572 696f  indow, min_perio
-00011380: 6473 3d4e 6f6e 652c 2063 656e 7465 723d  ds=None, center=
-00011390: 4661 6c73 652c 2077 696e 5f74 7970 653d  False, win_type=
-000113a0: 4e6f 6e65 2c20 6178 6973 3d6e 6f5f 6465  None, axis=no_de
-000113b0: 6661 756c 740a 2020 2020 293a 0a20 2020  fault.    ):.   
-000113c0: 2020 2020 2022 2222 5072 6f76 6964 6573       """Provides
-000113d0: 2072 6f6c 6c69 6e67 2074 7261 6e73 666f   rolling transfo
-000113e0: 726d 6174 696f 6e73 2e0a 0a20 2020 2020  rmations...     
-000113f0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00011400: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00011410: 0a20 2020 2020 2020 2077 696e 646f 7720  .        window 
-00011420: 3a20 696e 742c 2073 7472 2c20 6f66 6673  : int, str, offs
-00011430: 6574 0a20 2020 2020 2020 2020 2020 5369  et.           Si
-00011440: 7a65 206f 6620 7468 6520 6d6f 7669 6e67  ze of the moving
-00011450: 2077 696e 646f 772e 2054 6869 7320 6973   window. This is
-00011460: 2074 6865 206e 756d 6265 7220 6f66 206f   the number of o
-00011470: 6273 6572 7661 7469 6f6e 7320 7573 6564  bservations used
-00011480: 0a20 2020 2020 2020 2020 2020 666f 7220  .           for 
-00011490: 6361 6c63 756c 6174 696e 6720 7468 6520  calculating the 
-000114a0: 7374 6174 6973 7469 632e 2057 6865 6e20  statistic. When 
-000114b0: 6e6f 7420 7573 696e 6720 6120 6060 4461  not using a ``Da
-000114c0: 7465 7469 6d65 496e 6465 7860 602c 0a20  tetimeIndex``,. 
-000114d0: 2020 2020 2020 2020 2020 7468 6520 7769            the wi
-000114e0: 6e64 6f77 2073 697a 6520 6d75 7374 206e  ndow size must n
-000114f0: 6f74 2062 6520 736f 206c 6172 6765 2061  ot be so large a
-00011500: 7320 746f 2073 7061 6e20 6d6f 7265 2074  s to span more t
-00011510: 6861 6e20 6f6e 650a 2020 2020 2020 2020  han one.        
-00011520: 2020 2061 646a 6163 656e 7420 7061 7274     adjacent part
-00011530: 6974 696f 6e2e 2049 6620 7573 696e 6720  ition. If using 
-00011540: 616e 206f 6666 7365 7420 6f72 206f 6666  an offset or off
-00011550: 7365 7420 616c 6961 7320 6c69 6b65 2027  set alias like '
-00011560: 3544 272c 0a20 2020 2020 2020 2020 2020  5D',.           
-00011570: 7468 6520 6461 7461 206d 7573 7420 6861  the data must ha
-00011580: 7665 2061 2060 6044 6174 6574 696d 6549  ve a ``DatetimeI
-00011590: 6e64 6578 6060 0a0a 2020 2020 2020 2020  ndex``..        
-000115a0: 2020 202e 2e20 7665 7273 696f 6e63 6861     .. versioncha
-000115b0: 6e67 6564 3a3a 2030 2e31 352e 300a 0a20  nged:: 0.15.0.. 
-000115c0: 2020 2020 2020 2020 2020 2020 204e 6f77               Now
-000115d0: 2061 6363 6570 7473 206f 6666 7365 7473   accepts offsets
-000115e0: 2061 6e64 2073 7472 696e 6720 6f66 6673   and string offs
-000115f0: 6574 2061 6c69 6173 6573 0a0a 2020 2020  et aliases..    
-00011600: 2020 2020 6d69 6e5f 7065 7269 6f64 7320      min_periods 
-00011610: 3a20 696e 742c 2064 6566 6175 6c74 204e  : int, default N
-00011620: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-00011630: 4d69 6e69 6d75 6d20 6e75 6d62 6572 206f  Minimum number o
-00011640: 6620 6f62 7365 7276 6174 696f 6e73 2069  f observations i
-00011650: 6e20 7769 6e64 6f77 2072 6571 7569 7265  n window require
-00011660: 6420 746f 2068 6176 6520 6120 7661 6c75  d to have a valu
-00011670: 650a 2020 2020 2020 2020 2020 2020 286f  e.            (o
-00011680: 7468 6572 7769 7365 2072 6573 756c 7420  therwise result 
-00011690: 6973 204e 4129 2e0a 2020 2020 2020 2020  is NA)..        
-000116a0: 6365 6e74 6572 203a 2062 6f6f 6c65 616e  center : boolean
-000116b0: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
-000116c0: 2020 2020 2020 2020 2020 2020 5365 7420              Set 
-000116d0: 7468 6520 6c61 6265 6c73 2061 7420 7468  the labels at th
-000116e0: 6520 6365 6e74 6572 206f 6620 7468 6520  e center of the 
-000116f0: 7769 6e64 6f77 2e0a 2020 2020 2020 2020  window..        
-00011700: 7769 6e5f 7479 7065 203a 2073 7472 696e  win_type : strin
-00011710: 672c 2064 6566 6175 6c74 204e 6f6e 650a  g, default None.
-00011720: 2020 2020 2020 2020 2020 2020 5072 6f76              Prov
-00011730: 6964 6520 6120 7769 6e64 6f77 2074 7970  ide a window typ
-00011740: 652e 2054 6865 2072 6563 6f67 6e69 7a65  e. The recognize
-00011750: 6420 7769 6e64 6f77 2074 7970 6573 2061  d window types a
-00011760: 7265 2069 6465 6e74 6963 616c 0a20 2020  re identical.   
-00011770: 2020 2020 2020 2020 2074 6f20 7061 6e64           to pand
-00011780: 6173 2e0a 2020 2020 2020 2020 6178 6973  as..        axis
-00011790: 203a 2069 6e74 2c20 7374 722c 204e 6f6e   : int, str, Non
-000117a0: 652c 2064 6566 6175 6c74 2030 0a20 2020  e, default 0.   
-000117b0: 2020 2020 2020 2020 2054 6869 7320 7061           This pa
-000117c0: 7261 6d65 7465 7220 6973 2064 6570 7265  rameter is depre
-000117d0: 6361 7465 6420 7769 7468 2060 6070 616e  cated with ``pan
-000117e0: 6461 733e 3d32 2e31 6060 2e0a 0a20 2020  das>=2.1``...   
-000117f0: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-00011800: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-00011810: 2020 2020 2061 2052 6f6c 6c69 6e67 206f       a Rolling o
-00011820: 626a 6563 7420 6f6e 2077 6869 6368 2074  bject on which t
-00011830: 6f20 6361 6c6c 2061 206d 6574 686f 6420  o call a method 
-00011840: 746f 2063 6f6d 7075 7465 2061 2073 7461  to compute a sta
-00011850: 7469 7374 6963 0a20 2020 2020 2020 2022  tistic.        "
-00011860: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
-00011870: 6461 736b 2e64 6174 6166 7261 6d65 2e72  dask.dataframe.r
-00011880: 6f6c 6c69 6e67 2069 6d70 6f72 7420 526f  olling import Ro
-00011890: 6c6c 696e 670a 0a20 2020 2020 2020 2069  lling..        i
-000118a0: 6620 6973 696e 7374 616e 6365 2877 696e  f isinstance(win
-000118b0: 646f 772c 2049 6e74 6567 7261 6c29 3a0a  dow, Integral):.
-000118c0: 2020 2020 2020 2020 2020 2020 6966 2077              if w
-000118d0: 696e 646f 7720 3c20 303a 0a20 2020 2020  indow < 0:.     
-000118e0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000118f0: 2056 616c 7565 4572 726f 7228 2277 696e   ValueError("win
-00011900: 646f 7720 6d75 7374 2062 6520 3e3d 2030  dow must be >= 0
-00011910: 2229 0a0a 2020 2020 2020 2020 6966 206d  ")..        if m
-00011920: 696e 5f70 6572 696f 6473 2069 7320 6e6f  in_periods is no
-00011930: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00011940: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-00011950: 7461 6e63 6528 6d69 6e5f 7065 7269 6f64  tance(min_period
-00011960: 732c 2049 6e74 6567 7261 6c29 3a0a 2020  s, Integral):.  
-00011970: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00011980: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-00011990: 6d69 6e5f 7065 7269 6f64 7320 6d75 7374  min_periods must
-000119a0: 2062 6520 616e 2069 6e74 6567 6572 2229   be an integer")
-000119b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000119c0: 6d69 6e5f 7065 7269 6f64 7320 3c20 303a  min_periods < 0:
-000119d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000119e0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-000119f0: 7228 226d 696e 5f70 6572 696f 6473 206d  r("min_periods m
-00011a00: 7573 7420 6265 203e 3d20 3022 290a 0a20  ust be >= 0").. 
-00011a10: 2020 2020 2020 2072 6574 7572 6e20 526f         return Ro
-00011a20: 6c6c 696e 6728 0a20 2020 2020 2020 2020  lling(.         
-00011a30: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00011a40: 2020 2020 2077 696e 646f 773d 7769 6e64       window=wind
-00011a50: 6f77 2c0a 2020 2020 2020 2020 2020 2020  ow,.            
-00011a60: 6d69 6e5f 7065 7269 6f64 733d 6d69 6e5f  min_periods=min_
-00011a70: 7065 7269 6f64 732c 0a20 2020 2020 2020  periods,.       
-00011a80: 2020 2020 2063 656e 7465 723d 6365 6e74       center=cent
-00011a90: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
-00011aa0: 7769 6e5f 7479 7065 3d77 696e 5f74 7970  win_type=win_typ
-00011ab0: 652c 0a20 2020 2020 2020 2020 2020 2061  e,.            a
-00011ac0: 7869 733d 6178 6973 2c0a 2020 2020 2020  xis=axis,.      
-00011ad0: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
-00011ae0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-00011af0: 616d 6529 0a20 2020 2064 6566 2064 6966  ame).    def dif
-00011b00: 6628 7365 6c66 2c20 7065 7269 6f64 733d  f(self, periods=
-00011b10: 312c 2061 7869 733d 3029 3a0a 2020 2020  1, axis=0):.    
-00011b20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00011b30: 2e2e 206e 6f74 653a 3a0a 0a20 2020 2020  .. note::..     
-00011b40: 2020 2020 2020 5061 6e64 6173 2063 7572        Pandas cur
-00011b50: 7265 6e74 6c79 2075 7365 7320 616e 2060  rently uses an `
-00011b60: 606f 626a 6563 7460 602d 6474 7970 6520  `object``-dtype 
-00011b70: 636f 6c75 6d6e 2074 6f20 7265 7072 6573  column to repres
-00011b80: 656e 740a 2020 2020 2020 2020 2020 2062  ent.           b
-00011b90: 6f6f 6c65 616e 2064 6174 6120 7769 7468  oolean data with
-00011ba0: 206d 6973 7369 6e67 2076 616c 7565 732e   missing values.
-00011bb0: 2054 6869 7320 6361 6e20 6361 7573 6520   This can cause 
-00011bc0: 6973 7375 6573 2066 6f72 0a20 2020 2020  issues for.     
-00011bd0: 2020 2020 2020 626f 6f6c 6561 6e2d 7370        boolean-sp
-00011be0: 6563 6966 6963 206f 7065 7261 7469 6f6e  ecific operation
-00011bf0: 732c 206c 696b 6520 6060 7c60 602e 2054  s, like ``|``. T
-00011c00: 6f20 656e 6162 6c65 2062 6f6f 6c65 616e  o enable boolean
-00011c10: 2d0a 2020 2020 2020 2020 2020 2073 7065  -.           spe
-00011c20: 6369 6669 6320 6f70 6572 6174 696f 6e73  cific operations
-00011c30: 2c20 6174 2074 6865 2063 6f73 7420 6f66  , at the cost of
-00011c40: 206d 6574 6164 6174 6120 7468 6174 2064   metadata that d
-00011c50: 6f65 736e 2774 206d 6174 6368 0a20 2020  oesn't match.   
-00011c60: 2020 2020 2020 2020 7061 6e64 6173 2c20          pandas, 
-00011c70: 7573 6520 6060 2e61 7374 7970 6528 626f  use ``.astype(bo
-00011c80: 6f6c 2960 6020 6166 7465 7220 7468 6520  ol)`` after the 
-00011c90: 6060 7368 6966 7460 602e 0a20 2020 2020  ``shift``..     
-00011ca0: 2020 2022 2222 0a20 2020 2020 2020 2061     """.        a
-00011cb0: 7869 7320 3d20 7365 6c66 2e5f 7661 6c69  xis = self._vali
-00011cc0: 6461 7465 5f61 7869 7328 6178 6973 290a  date_axis(axis).
-00011cd0: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-00011ce0: 7369 6e73 7461 6e63 6528 7065 7269 6f64  sinstance(period
-00011cf0: 732c 2049 6e74 6567 7261 6c29 3a0a 2020  s, Integral):.  
-00011d00: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00011d10: 5479 7065 4572 726f 7228 2270 6572 696f  TypeError("perio
-00011d20: 6473 206d 7573 7420 6265 2061 6e20 696e  ds must be an in
-00011d30: 7465 6765 7222 290a 0a20 2020 2020 2020  teger")..       
-00011d40: 2069 6620 6178 6973 203d 3d20 313a 0a20   if axis == 1:. 
-00011d50: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00011d60: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
-00011d70: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
-00011d80: 2020 2020 2020 204d 2e64 6966 662c 2074         M.diff, t
-00011d90: 6f6b 656e 3d22 6469 6666 222c 2070 6572  oken="diff", per
-00011da0: 696f 6473 3d70 6572 696f 6473 2c20 6178  iods=periods, ax
-00011db0: 6973 3d31 2c20 656e 666f 7263 655f 6d65  is=1, enforce_me
-00011dc0: 7461 6461 7461 3d46 616c 7365 0a20 2020  tadata=False.   
-00011dd0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00011de0: 2020 2020 6265 666f 7265 2c20 6166 7465      before, afte
-00011df0: 7220 3d20 2870 6572 696f 6473 2c20 3029  r = (periods, 0)
-00011e00: 2069 6620 7065 7269 6f64 7320 3e20 3020   if periods > 0 
-00011e10: 656c 7365 2028 302c 202d 7065 7269 6f64  else (0, -period
-00011e20: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
-00011e30: 6e20 7365 6c66 2e6d 6170 5f6f 7665 726c  n self.map_overl
-00011e40: 6170 284d 2e64 6966 662c 2062 6566 6f72  ap(M.diff, befor
-00011e50: 652c 2061 6674 6572 2c20 746f 6b65 6e3d  e, after, token=
-00011e60: 2264 6966 6622 2c20 7065 7269 6f64 733d  "diff", periods=
-00011e70: 7065 7269 6f64 7329 0a0a 2020 2020 4064  periods)..    @d
-00011e80: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-00011e90: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-00011ea0: 6620 7368 6966 7428 7365 6c66 2c20 7065  f shift(self, pe
-00011eb0: 7269 6f64 733d 312c 2066 7265 713d 4e6f  riods=1, freq=No
-00011ec0: 6e65 2c20 6178 6973 3d30 293a 0a20 2020  ne, axis=0):.   
-00011ed0: 2020 2020 2061 7869 7320 3d20 7365 6c66       axis = self
-00011ee0: 2e5f 7661 6c69 6461 7465 5f61 7869 7328  ._validate_axis(
-00011ef0: 6178 6973 290a 2020 2020 2020 2020 6966  axis).        if
-00011f00: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-00011f10: 7065 7269 6f64 732c 2049 6e74 6567 7261  periods, Integra
-00011f20: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
-00011f30: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-00011f40: 2270 6572 696f 6473 206d 7573 7420 6265  "periods must be
-00011f50: 2061 6e20 696e 7465 6765 7222 290a 0a20   an integer").. 
-00011f60: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
-00011f70: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-00011f80: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-00011f90: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-00011fa0: 2020 2020 2020 2020 2020 2020 204d 2e73               M.s
-00011fb0: 6869 6674 2c0a 2020 2020 2020 2020 2020  hift,.          
-00011fc0: 2020 2020 2020 746f 6b65 6e3d 2273 6869        token="shi
-00011fd0: 6674 222c 0a20 2020 2020 2020 2020 2020  ft",.           
-00011fe0: 2020 2020 2070 6572 696f 6473 3d70 6572       periods=per
-00011ff0: 696f 6473 2c0a 2020 2020 2020 2020 2020  iods,.          
-00012000: 2020 2020 2020 6672 6571 3d66 7265 712c        freq=freq,
-00012010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012020: 2061 7869 733d 312c 0a20 2020 2020 2020   axis=1,.       
-00012030: 2020 2020 2020 2020 2065 6e66 6f72 6365           enforce
-00012040: 5f6d 6574 6164 6174 613d 4661 6c73 652c  _metadata=False,
-00012050: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00012060: 2020 2020 2020 2020 6966 2066 7265 7120          if freq 
-00012070: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00012080: 2020 2020 2062 6566 6f72 652c 2061 6674       before, aft
-00012090: 6572 203d 2028 7065 7269 6f64 732c 2030  er = (periods, 0
-000120a0: 2920 6966 2070 6572 696f 6473 203e 2030  ) if periods > 0
-000120b0: 2065 6c73 6520 2830 2c20 2d70 6572 696f   else (0, -perio
-000120c0: 6473 290a 2020 2020 2020 2020 2020 2020  ds).            
-000120d0: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
-000120e0: 6f76 6572 6c61 7028 0a20 2020 2020 2020  overlap(.       
-000120f0: 2020 2020 2020 2020 204d 2e73 6869 6674           M.shift
-00012100: 2c20 6265 666f 7265 2c20 6166 7465 722c  , before, after,
-00012110: 2074 6f6b 656e 3d22 7368 6966 7422 2c20   token="shift", 
-00012120: 7065 7269 6f64 733d 7065 7269 6f64 730a  periods=periods.
-00012130: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00012140: 2020 2020 2020 2023 204c 6574 2070 616e         # Let pan
-00012150: 6461 7320 6572 726f 7220 6f6e 2069 6e76  das error on inv
-00012160: 616c 6964 2061 7267 756d 656e 7473 0a20  alid arguments. 
-00012170: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
-00012180: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
-00012190: 792e 7368 6966 7428 7065 7269 6f64 732c  y.shift(periods,
-000121a0: 2066 7265 713d 6672 6571 290a 2020 2020   freq=freq).    
-000121b0: 2020 2020 6f75 7420 3d20 7365 6c66 2e6d      out = self.m
-000121c0: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
-000121d0: 2020 2020 2020 2020 2020 204d 2e73 6869             M.shi
-000121e0: 6674 2c0a 2020 2020 2020 2020 2020 2020  ft,.            
-000121f0: 746f 6b65 6e3d 2273 6869 6674 222c 0a20  token="shift",. 
-00012200: 2020 2020 2020 2020 2020 2070 6572 696f             perio
-00012210: 6473 3d70 6572 696f 6473 2c0a 2020 2020  ds=periods,.    
-00012220: 2020 2020 2020 2020 6672 6571 3d66 7265          freq=fre
-00012230: 712c 0a20 2020 2020 2020 2020 2020 206d  q,.            m
-00012240: 6574 613d 6d65 7461 2c0a 2020 2020 2020  eta=meta,.      
-00012250: 2020 2020 2020 656e 666f 7263 655f 6d65        enforce_me
-00012260: 7461 6461 7461 3d46 616c 7365 2c0a 2020  tadata=False,.  
-00012270: 2020 2020 2020 2020 2020 7472 616e 7366            transf
-00012280: 6f72 6d5f 6469 7669 7369 6f6e 733d 4661  orm_divisions=Fa
-00012290: 6c73 652c 0a20 2020 2020 2020 2029 0a20  lse,.        ). 
-000122a0: 2020 2020 2020 2072 6574 7572 6e20 6d61         return ma
-000122b0: 7962 655f 7368 6966 745f 6469 7669 7369  ybe_shift_divisi
-000122c0: 6f6e 7328 6f75 742c 2070 6572 696f 6473  ons(out, periods
-000122d0: 2c20 6672 6571 3d66 7265 7129 0a0a 2020  , freq=freq)..  
-000122e0: 2020 6465 6620 5f72 6564 7563 7469 6f6e    def _reduction
-000122f0: 5f61 6767 280a 2020 2020 2020 2020 7365  _agg(.        se
-00012300: 6c66 2c0a 2020 2020 2020 2020 6e61 6d65  lf,.        name
-00012310: 2c0a 2020 2020 2020 2020 6178 6973 3d4e  ,.        axis=N
-00012320: 6f6e 652c 0a20 2020 2020 2020 2073 6b69  one,.        ski
-00012330: 706e 613d 5472 7565 2c0a 2020 2020 2020  pna=True,.      
-00012340: 2020 7370 6c69 745f 6576 6572 793d 4661    split_every=Fa
-00012350: 6c73 652c 0a20 2020 2020 2020 206f 7574  lse,.        out
-00012360: 3d4e 6f6e 652c 0a20 2020 2020 2020 206e  =None,.        n
-00012370: 756d 6572 6963 5f6f 6e6c 793d 4e6f 6e65  umeric_only=None
-00012380: 2c0a 2020 2020 2020 2020 6e6f 6e65 5f69  ,.        none_i
-00012390: 735f 7a65 726f 3d54 7275 652c 0a20 2020  s_zero=True,.   
-000123a0: 2029 3a0a 2020 2020 2020 2020 6178 6973   ):.        axis
-000123b0: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
-000123c0: 655f 6178 6973 2861 7869 732c 206e 6f6e  e_axis(axis, non
-000123d0: 655f 6973 5f7a 6572 6f3d 6e6f 6e65 5f69  e_is_zero=none_i
-000123e0: 735f 7a65 726f 290a 0a20 2020 2020 2020  s_zero)..       
-000123f0: 2069 6620 6861 735f 6b65 7977 6f72 6428   if has_keyword(
-00012400: 6765 7461 7474 7228 7365 6c66 2e5f 6d65  getattr(self._me
-00012410: 7461 5f6e 6f6e 656d 7074 792c 206e 616d  ta_nonempty, nam
-00012420: 6529 2c20 226e 756d 6572 6963 5f6f 6e6c  e), "numeric_onl
-00012430: 7922 293a 0a20 2020 2020 2020 2020 2020  y"):.           
-00012440: 206e 756d 6572 6963 5f6f 6e6c 795f 6b77   numeric_only_kw
-00012450: 6172 6773 203d 207b 226e 756d 6572 6963  args = {"numeric
-00012460: 5f6f 6e6c 7922 3a20 6e75 6d65 7269 635f  _only": numeric_
-00012470: 6f6e 6c79 7d0a 2020 2020 2020 2020 656c  only}.        el
-00012480: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00012490: 6e75 6d65 7269 635f 6f6e 6c79 5f6b 7761  numeric_only_kwa
-000124a0: 7267 7320 3d20 7b7d 0a0a 2020 2020 2020  rgs = {}..      
-000124b0: 2020 7769 7468 2063 6865 636b 5f6e 756d    with check_num
-000124c0: 6572 6963 5f6f 6e6c 795f 6465 7072 6563  eric_only_deprec
-000124d0: 6174 696f 6e28 6e61 6d65 2c20 5472 7565  ation(name, True
-000124e0: 293a 0a20 2020 2020 2020 2020 2020 206d  ):.            m
-000124f0: 6574 6120 3d20 6765 7461 7474 7228 7365  eta = getattr(se
-00012500: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
-00012510: 792c 206e 616d 6529 280a 2020 2020 2020  y, name)(.      
-00012520: 2020 2020 2020 2020 2020 6178 6973 3d61            axis=a
-00012530: 7869 732c 2073 6b69 706e 613d 736b 6970  xis, skipna=skip
-00012540: 6e61 2c20 2a2a 6e75 6d65 7269 635f 6f6e  na, **numeric_on
-00012550: 6c79 5f6b 7761 7267 730a 2020 2020 2020  ly_kwargs.      
-00012560: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00012570: 2074 6f6b 656e 203d 2073 656c 662e 5f74   token = self._t
-00012580: 6f6b 656e 5f70 7265 6669 7820 2b20 6e61  oken_prefix + na
-00012590: 6d65 0a20 2020 2020 2020 2069 6620 6178  me.        if ax
-000125a0: 6973 203d 3d20 313a 0a20 2020 2020 2020  is == 1:.       
-000125b0: 2020 2020 2072 6573 756c 7420 3d20 7365       result = se
-000125c0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-000125d0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-000125e0: 2020 205f 6765 7461 7474 725f 6e75 6d65     _getattr_nume
-000125f0: 7269 635f 6f6e 6c79 2c0a 2020 2020 2020  ric_only,.      
-00012600: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
-00012610: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
-00012620: 2020 2020 2074 6f6b 656e 3d74 6f6b 656e       token=token
-00012630: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00012640: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
-00012650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012660: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
-00012670: 2020 2020 2020 2020 2020 2020 5f64 6173              _das
-00012680: 6b5f 6d65 7468 6f64 5f6e 616d 653d 6e61  k_method_name=na
-00012690: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-000126a0: 2020 2020 2a2a 6e75 6d65 7269 635f 6f6e      **numeric_on
-000126b0: 6c79 5f6b 7761 7267 732c 0a20 2020 2020  ly_kwargs,.     
-000126c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000126d0: 2020 2020 2072 6574 7572 6e20 6861 6e64       return hand
-000126e0: 6c65 5f6f 7574 286f 7574 2c20 7265 7375  le_out(out, resu
-000126f0: 6c74 290a 2020 2020 2020 2020 656c 7365  lt).        else
-00012700: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00012710: 7375 6c74 203d 2073 656c 662e 7265 6475  sult = self.redu
-00012720: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
-00012730: 2020 2020 2020 205f 6765 7461 7474 725f         _getattr_
-00012740: 6e75 6d65 7269 635f 6f6e 6c79 2c0a 2020  numeric_only,.  
-00012750: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-00012760: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
-00012770: 2020 2020 2020 2020 2074 6f6b 656e 3d74           token=t
-00012780: 6f6b 656e 2c0a 2020 2020 2020 2020 2020  oken,.          
-00012790: 2020 2020 2020 736b 6970 6e61 3d73 6b69        skipna=ski
-000127a0: 706e 612c 0a20 2020 2020 2020 2020 2020  pna,.           
-000127b0: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
-000127c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000127d0: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-000127e0: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
-000127f0: 2020 2020 2020 2020 205f 6461 736b 5f6d           _dask_m
-00012800: 6574 686f 645f 6e61 6d65 3d6e 616d 652c  ethod_name=name,
-00012810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012820: 202a 2a6e 756d 6572 6963 5f6f 6e6c 795f   **numeric_only_
-00012830: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
-00012840: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00012850: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00012860: 7365 6c66 2c20 4461 7461 4672 616d 6529  self, DataFrame)
-00012870: 2061 6e64 2069 7369 6e73 7461 6e63 6528   and isinstance(
-00012880: 7265 7375 6c74 2c20 5365 7269 6573 293a  result, Series):
-00012890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000128a0: 2072 6573 756c 742e 6469 7669 7369 6f6e   result.division
-000128b0: 7320 3d20 2873 656c 662e 636f 6c75 6d6e  s = (self.column
-000128c0: 732e 6d69 6e28 292c 2073 656c 662e 636f  s.min(), self.co
-000128d0: 6c75 6d6e 732e 6d61 7828 2929 0a20 2020  lumns.max()).   
-000128e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000128f0: 6861 6e64 6c65 5f6f 7574 286f 7574 2c20  handle_out(out, 
-00012900: 7265 7375 6c74 290a 0a20 2020 2040 6465  result)..    @de
-00012910: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-00012920: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-00012930: 2061 6464 5f70 7265 6669 7828 7365 6c66   add_prefix(self
-00012940: 2c20 7072 6566 6978 293a 0a20 2020 2020  , prefix):.     
-00012950: 2020 2072 6573 203d 2073 656c 662e 6d61     res = self.ma
-00012960: 705f 7061 7274 6974 696f 6e73 284d 2e61  p_partitions(M.a
-00012970: 6464 5f70 7265 6669 782c 2070 7265 6669  dd_prefix, prefi
-00012980: 7829 0a20 2020 2020 2020 2069 6620 7365  x).        if se
-00012990: 6c66 2e6b 6e6f 776e 5f64 6976 6973 696f  lf.known_divisio
-000129a0: 6e73 2061 6e64 2069 735f 7365 7269 6573  ns and is_series
-000129b0: 5f6c 696b 6528 7365 6c66 293a 0a20 2020  _like(self):.   
-000129c0: 2020 2020 2020 2020 2072 6573 2e64 6976           res.div
-000129d0: 6973 696f 6e73 203d 2074 7570 6c65 2870  isions = tuple(p
-000129e0: 7265 6669 7820 2b20 7374 7228 6469 7669  refix + str(divi
-000129f0: 7369 6f6e 2920 666f 7220 6469 7669 7369  sion) for divisi
-00012a00: 6f6e 2069 6e20 7365 6c66 2e64 6976 6973  on in self.divis
-00012a10: 696f 6e73 290a 2020 2020 2020 2020 7265  ions).        re
-00012a20: 7475 726e 2072 6573 0a0a 2020 2020 4064  turn res..    @d
-00012a30: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-00012a40: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-00012a50: 6620 6164 645f 7375 6666 6978 2873 656c  f add_suffix(sel
-00012a60: 662c 2073 7566 6669 7829 3a0a 2020 2020  f, suffix):.    
-00012a70: 2020 2020 7265 7320 3d20 7365 6c66 2e6d      res = self.m
-00012a80: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
-00012a90: 6164 645f 7375 6666 6978 2c20 7375 6666  add_suffix, suff
-00012aa0: 6978 290a 2020 2020 2020 2020 6966 2073  ix).        if s
-00012ab0: 656c 662e 6b6e 6f77 6e5f 6469 7669 7369  elf.known_divisi
-00012ac0: 6f6e 7320 616e 6420 6973 5f73 6572 6965  ons and is_serie
-00012ad0: 735f 6c69 6b65 2873 656c 6629 3a0a 2020  s_like(self):.  
-00012ae0: 2020 2020 2020 2020 2020 7265 732e 6469            res.di
-00012af0: 7669 7369 6f6e 7320 3d20 7475 706c 6528  visions = tuple(
-00012b00: 7374 7228 6469 7669 7369 6f6e 2920 2b20  str(division) + 
-00012b10: 7375 6666 6978 2066 6f72 2064 6976 6973  suffix for divis
-00012b20: 696f 6e20 696e 2073 656c 662e 6469 7669  ion in self.divi
-00012b30: 7369 6f6e 7329 0a20 2020 2020 2020 2072  sions).        r
-00012b40: 6574 7572 6e20 7265 730a 0a20 2020 2040  eturn res..    @
-00012b50: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00012b60: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-00012b70: 6566 2061 6273 2873 656c 6629 3a0a 2020  ef abs(self):.  
-00012b80: 2020 2020 2020 5f72 6169 7365 5f69 665f        _raise_if_
-00012b90: 6f62 6a65 6374 5f73 6572 6965 7328 7365  object_series(se
-00012ba0: 6c66 2c20 2261 6273 2229 0a20 2020 2020  lf, "abs").     
-00012bb0: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
-00012bc0: 6d65 7461 5f6e 6f6e 656d 7074 792e 6162  meta_nonempty.ab
-00012bd0: 7328 290a 2020 2020 2020 2020 7265 7475  s().        retu
-00012be0: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-00012bf0: 6974 696f 6e73 284d 2e61 6273 2c20 6d65  itions(M.abs, me
-00012c00: 7461 3d6d 6574 612c 2065 6e66 6f72 6365  ta=meta, enforce
-00012c10: 5f6d 6574 6164 6174 613d 4661 6c73 6529  _metadata=False)
-00012c20: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-00012c30: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-00012c40: 290a 2020 2020 6465 6620 616c 6c28 7365  ).    def all(se
-00012c50: 6c66 2c20 6178 6973 3d4e 6f6e 652c 2073  lf, axis=None, s
-00012c60: 6b69 706e 613d 5472 7565 2c20 7370 6c69  kipna=True, spli
-00012c70: 745f 6576 6572 793d 4661 6c73 652c 206f  t_every=False, o
-00012c80: 7574 3d4e 6f6e 6529 3a0a 2020 2020 2020  ut=None):.      
-00012c90: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
-00012ca0: 6564 7563 7469 6f6e 5f61 6767 280a 2020  eduction_agg(.  
-00012cb0: 2020 2020 2020 2020 2020 2261 6c6c 222c            "all",
-00012cc0: 2061 7869 733d 6178 6973 2c20 736b 6970   axis=axis, skip
-00012cd0: 6e61 3d73 6b69 706e 612c 2073 706c 6974  na=skipna, split
-00012ce0: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-00012cf0: 7279 2c20 6f75 743d 6f75 740a 2020 2020  ry, out=out.    
-00012d00: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
-00012d10: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-00012d20: 4672 616d 6529 0a20 2020 2064 6566 2061  Frame).    def a
-00012d30: 6e79 2873 656c 662c 2061 7869 733d 4e6f  ny(self, axis=No
-00012d40: 6e65 2c20 736b 6970 6e61 3d54 7275 652c  ne, skipna=True,
-00012d50: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-00012d60: 7365 2c20 6f75 743d 4e6f 6e65 293a 0a20  se, out=None):. 
-00012d70: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00012d80: 6c66 2e5f 7265 6475 6374 696f 6e5f 6167  lf._reduction_ag
-00012d90: 6728 0a20 2020 2020 2020 2020 2020 2022  g(.            "
-00012da0: 616e 7922 2c20 6178 6973 3d61 7869 732c  any", axis=axis,
-00012db0: 2073 6b69 706e 613d 736b 6970 6e61 2c20   skipna=skipna, 
-00012dc0: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-00012dd0: 745f 6576 6572 792c 206f 7574 3d6f 7574  t_every, out=out
-00012de0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00012df0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-00012e00: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-00012e10: 6465 6620 7375 6d28 0a20 2020 2020 2020  def sum(.       
-00012e20: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
-00012e30: 7869 733d 4e6f 6e65 2c0a 2020 2020 2020  xis=None,.      
-00012e40: 2020 736b 6970 6e61 3d54 7275 652c 0a20    skipna=True,. 
-00012e50: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-00012e60: 7279 3d46 616c 7365 2c0a 2020 2020 2020  ry=False,.      
-00012e70: 2020 6474 7970 653d 4e6f 6e65 2c0a 2020    dtype=None,.  
-00012e80: 2020 2020 2020 6f75 743d 4e6f 6e65 2c0a        out=None,.
-00012e90: 2020 2020 2020 2020 6d69 6e5f 636f 756e          min_coun
-00012ea0: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
-00012eb0: 6e75 6d65 7269 635f 6f6e 6c79 3d4e 6f6e  numeric_only=Non
-00012ec0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00012ed0: 2020 7265 7375 6c74 203d 2073 656c 662e    result = self.
-00012ee0: 5f72 6564 7563 7469 6f6e 5f61 6767 280a  _reduction_agg(.
-00012ef0: 2020 2020 2020 2020 2020 2020 2273 756d              "sum
-00012f00: 222c 0a20 2020 2020 2020 2020 2020 2061  ",.            a
-00012f10: 7869 733d 6178 6973 2c0a 2020 2020 2020  xis=axis,.      
-00012f20: 2020 2020 2020 736b 6970 6e61 3d73 6b69        skipna=ski
-00012f30: 706e 612c 0a20 2020 2020 2020 2020 2020  pna,.           
-00012f40: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
-00012f50: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
-00012f60: 2020 2020 2020 6f75 743d 6f75 742c 0a20        out=out,. 
-00012f70: 2020 2020 2020 2020 2020 206e 756d 6572             numer
-00012f80: 6963 5f6f 6e6c 793d 6e75 6d65 7269 635f  ic_only=numeric_
-00012f90: 6f6e 6c79 2c0a 2020 2020 2020 2020 290a  only,.        ).
-00012fa0: 2020 2020 2020 2020 6966 206d 696e 5f63          if min_c
-00012fb0: 6f75 6e74 3a0a 2020 2020 2020 2020 2020  ount:.          
-00012fc0: 2020 636f 6e64 203d 2073 656c 662e 6e6f    cond = self.no
-00012fd0: 746e 756c 6c28 292e 7375 6d28 6178 6973  tnull().sum(axis
-00012fe0: 3d61 7869 7329 203e 3d20 6d69 6e5f 636f  =axis) >= min_co
-00012ff0: 756e 740a 2020 2020 2020 2020 2020 2020  unt.            
-00013000: 6966 2069 735f 7365 7269 6573 5f6c 696b  if is_series_lik
-00013010: 6528 636f 6e64 293a 0a20 2020 2020 2020  e(cond):.       
-00013020: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00013030: 7265 7375 6c74 2e77 6865 7265 2863 6f6e  result.where(con
-00013040: 642c 206f 7468 6572 3d6e 702e 4e61 4e29  d, other=np.NaN)
-00013050: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00013060: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00013070: 2020 2072 6574 7572 6e20 5f73 6361 6c61     return _scala
-00013080: 725f 6269 6e61 7279 280a 2020 2020 2020  r_binary(.      
-00013090: 2020 2020 2020 2020 2020 2020 2020 6c61                la
-000130a0: 6d62 6461 2078 2c20 793a 2072 6573 756c  mbda x, y: resul
-000130b0: 7420 6966 2078 2069 7320 7920 656c 7365  t if x is y else
-000130c0: 206e 702e 4e61 4e2c 2063 6f6e 642c 2054   np.NaN, cond, T
-000130d0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
-000130e0: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
-000130f0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00013100: 7265 7475 726e 2072 6573 756c 740a 0a20  return result.. 
-00013110: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00013120: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-00013130: 2020 2064 6566 2070 726f 6428 0a20 2020     def prod(.   
-00013140: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00013150: 2020 2061 7869 733d 4e6f 6e65 2c0a 2020     axis=None,.  
-00013160: 2020 2020 2020 736b 6970 6e61 3d54 7275        skipna=Tru
-00013170: 652c 0a20 2020 2020 2020 2073 706c 6974  e,.        split
-00013180: 5f65 7665 7279 3d46 616c 7365 2c0a 2020  _every=False,.  
-00013190: 2020 2020 2020 6474 7970 653d 4e6f 6e65        dtype=None
-000131a0: 2c0a 2020 2020 2020 2020 6f75 743d 4e6f  ,.        out=No
-000131b0: 6e65 2c0a 2020 2020 2020 2020 6d69 6e5f  ne,.        min_
-000131c0: 636f 756e 743d 4e6f 6e65 2c0a 2020 2020  count=None,.    
-000131d0: 2020 2020 6e75 6d65 7269 635f 6f6e 6c79      numeric_only
-000131e0: 3d4e 6f6e 652c 0a20 2020 2029 3a0a 2020  =None,.    ):.  
-000131f0: 2020 2020 2020 7265 7375 6c74 203d 2073        result = s
-00013200: 656c 662e 5f72 6564 7563 7469 6f6e 5f61  elf._reduction_a
-00013210: 6767 280a 2020 2020 2020 2020 2020 2020  gg(.            
-00013220: 2270 726f 6422 2c0a 2020 2020 2020 2020  "prod",.        
-00013230: 2020 2020 6178 6973 3d61 7869 732c 0a20      axis=axis,. 
-00013240: 2020 2020 2020 2020 2020 2073 6b69 706e             skipn
-00013250: 613d 736b 6970 6e61 2c0a 2020 2020 2020  a=skipna,.      
-00013260: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
-00013270: 793d 7370 6c69 745f 6576 6572 792c 0a20  y=split_every,. 
-00013280: 2020 2020 2020 2020 2020 206f 7574 3d6f             out=o
-00013290: 7574 2c0a 2020 2020 2020 2020 2020 2020  ut,.            
-000132a0: 6e75 6d65 7269 635f 6f6e 6c79 3d6e 756d  numeric_only=num
-000132b0: 6572 6963 5f6f 6e6c 792c 0a20 2020 2020  eric_only,.     
-000132c0: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
-000132d0: 6d69 6e5f 636f 756e 743a 0a20 2020 2020  min_count:.     
-000132e0: 2020 2020 2020 2063 6f6e 6420 3d20 7365         cond = se
-000132f0: 6c66 2e6e 6f74 6e75 6c6c 2829 2e73 756d  lf.notnull().sum
-00013300: 2861 7869 733d 6178 6973 2920 3e3d 206d  (axis=axis) >= m
-00013310: 696e 5f63 6f75 6e74 0a20 2020 2020 2020  in_count.       
-00013320: 2020 2020 2069 6620 6973 5f73 6572 6965       if is_serie
-00013330: 735f 6c69 6b65 2863 6f6e 6429 3a0a 2020  s_like(cond):.  
-00013340: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00013350: 7475 726e 2072 6573 756c 742e 7768 6572  turn result.wher
-00013360: 6528 636f 6e64 2c20 6f74 6865 723d 6e70  e(cond, other=np
-00013370: 2e4e 614e 290a 2020 2020 2020 2020 2020  .NaN).          
-00013380: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00013390: 2020 2020 2020 2020 7265 7475 726e 205f          return _
-000133a0: 7363 616c 6172 5f62 696e 6172 7928 0a20  scalar_binary(. 
-000133b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133c0: 2020 206c 616d 6264 6120 782c 2079 3a20     lambda x, y: 
-000133d0: 7265 7375 6c74 2069 6620 7820 6973 2079  result if x is y
-000133e0: 2065 6c73 6520 6e70 2e4e 614e 2c20 636f   else np.NaN, co
-000133f0: 6e64 2c20 5472 7565 0a20 2020 2020 2020  nd, True.       
-00013400: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00013410: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00013420: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
-00013430: 6c74 0a0a 2020 2020 7072 6f64 7563 7420  lt..    product 
-00013440: 3d20 7072 6f64 2020 2320 616c 6961 7365  = prod  # aliase
-00013450: 6420 6464 2e70 726f 6475 6374 0a0a 2020  d dd.product..  
-00013460: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00013470: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-00013480: 2020 6465 6620 6d61 7828 7365 6c66 2c20    def max(self, 
-00013490: 6178 6973 3d30 2c20 736b 6970 6e61 3d54  axis=0, skipna=T
-000134a0: 7275 652c 2073 706c 6974 5f65 7665 7279  rue, split_every
-000134b0: 3d46 616c 7365 2c20 6f75 743d 4e6f 6e65  =False, out=None
-000134c0: 2c20 6e75 6d65 7269 635f 6f6e 6c79 3d4e  , numeric_only=N
-000134d0: 6f6e 6529 3a0a 2020 2020 2020 2020 6966  one):.        if
-000134e0: 2028 0a20 2020 2020 2020 2020 2020 2050   (.            P
-000134f0: 414e 4441 535f 4754 5f31 3430 0a20 2020  ANDAS_GT_140.   
-00013500: 2020 2020 2020 2020 2061 6e64 206e 6f74           and not
-00013510: 2050 414e 4441 535f 4754 5f32 3030 0a20   PANDAS_GT_200. 
-00013520: 2020 2020 2020 2020 2020 2061 6e64 2061             and a
-00013530: 7869 7320 6973 204e 6f6e 650a 2020 2020  xis is None.    
-00013540: 2020 2020 2020 2020 616e 6420 6973 696e          and isin
-00013550: 7374 616e 6365 2873 656c 662c 2044 6174  stance(self, Dat
-00013560: 6146 7261 6d65 290a 2020 2020 2020 2020  aFrame).        
-00013570: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
-00013580: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
-00013590: 2020 2020 2020 2020 2020 2020 2020 2249                "I
-000135a0: 6e20 6120 6675 7475 7265 2076 6572 7369  n a future versi
-000135b0: 6f6e 2c20 4461 7461 4672 616d 652e 6d61  on, DataFrame.ma
-000135c0: 7828 6178 6973 3d4e 6f6e 6529 2077 696c  x(axis=None) wil
-000135d0: 6c20 7265 7475 726e 2061 2073 6361 6c61  l return a scala
-000135e0: 7220 6d61 7820 6f76 6572 2074 6865 2065  r max over the e
-000135f0: 6e74 6972 6520 4461 7461 4672 616d 652e  ntire DataFrame.
-00013600: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-00013610: 2020 2022 546f 2072 6574 6169 6e20 7468     "To retain th
-00013620: 6520 6f6c 6420 6265 6861 7669 6f72 2c20  e old behavior, 
-00013630: 7573 6520 2766 7261 6d65 2e6d 6178 2861  use 'frame.max(a
-00013640: 7869 733d 3029 2720 6f72 206a 7573 7420  xis=0)' or just 
-00013650: 2766 7261 6d65 2e6d 6178 2829 2722 2c0a  'frame.max()'",.
-00013660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013670: 4675 7475 7265 5761 726e 696e 672c 0a20  FutureWarning,. 
-00013680: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00013690: 2020 2020 2020 2020 2061 7869 7320 3d20           axis = 
-000136a0: 300a 0a20 2020 2020 2020 2072 6574 7572  0..        retur
-000136b0: 6e20 7365 6c66 2e5f 7265 6475 6374 696f  n self._reductio
-000136c0: 6e5f 6167 6728 0a20 2020 2020 2020 2020  n_agg(.         
-000136d0: 2020 2022 6d61 7822 2c0a 2020 2020 2020     "max",.      
-000136e0: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
-000136f0: 0a20 2020 2020 2020 2020 2020 2073 6b69  .            ski
-00013700: 706e 613d 736b 6970 6e61 2c0a 2020 2020  pna=skipna,.    
-00013710: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-00013720: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
-00013730: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
-00013740: 3d6f 7574 2c0a 2020 2020 2020 2020 2020  =out,.          
-00013750: 2020 2320 5374 6172 7469 6e67 2069 6e20    # Starting in 
-00013760: 7061 6e64 6173 2032 2e30 2c20 6061 7869  pandas 2.0, `axi
-00013770: 733d 4e6f 6e65 6020 646f 6573 2061 2066  s=None` does a f
-00013780: 756c 6c20 6167 6772 6567 6174 696f 6e20  ull aggregation 
-00013790: 6163 726f 7373 2062 6f74 6820 6178 6573  across both axes
-000137a0: 0a20 2020 2020 2020 2020 2020 206e 6f6e  .            non
-000137b0: 655f 6973 5f7a 6572 6f3d 6e6f 7420 5041  e_is_zero=not PA
-000137c0: 4e44 4153 5f47 545f 3230 302c 0a20 2020  NDAS_GT_200,.   
-000137d0: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
-000137e0: 5f6f 6e6c 793d 6e75 6d65 7269 635f 6f6e  _only=numeric_on
-000137f0: 6c79 2c0a 2020 2020 2020 2020 290a 0a20  ly,.        ).. 
-00013800: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00013810: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-00013820: 2020 2064 6566 206d 696e 2873 656c 662c     def min(self,
-00013830: 2061 7869 733d 302c 2073 6b69 706e 613d   axis=0, skipna=
-00013840: 5472 7565 2c20 7370 6c69 745f 6576 6572  True, split_ever
-00013850: 793d 4661 6c73 652c 206f 7574 3d4e 6f6e  y=False, out=Non
-00013860: 652c 206e 756d 6572 6963 5f6f 6e6c 793d  e, numeric_only=
-00013870: 4e6f 6e65 293a 0a20 2020 2020 2020 2069  None):.        i
-00013880: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
-00013890: 5041 4e44 4153 5f47 545f 3134 300a 2020  PANDAS_GT_140.  
-000138a0: 2020 2020 2020 2020 2020 616e 6420 6e6f            and no
-000138b0: 7420 5041 4e44 4153 5f47 545f 3230 300a  t PANDAS_GT_200.
-000138c0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-000138d0: 6178 6973 2069 7320 4e6f 6e65 0a20 2020  axis is None.   
-000138e0: 2020 2020 2020 2020 2061 6e64 2069 7369           and isi
-000138f0: 6e73 7461 6e63 6528 7365 6c66 2c20 4461  nstance(self, Da
-00013900: 7461 4672 616d 6529 0a20 2020 2020 2020  taFrame).       
-00013910: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-00013920: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
-00013930: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00013940: 496e 2061 2066 7574 7572 6520 7665 7273  In a future vers
-00013950: 696f 6e2c 2044 6174 6146 7261 6d65 2e6d  ion, DataFrame.m
-00013960: 696e 2861 7869 733d 4e6f 6e65 2920 7769  in(axis=None) wi
-00013970: 6c6c 2072 6574 7572 6e20 6120 7363 616c  ll return a scal
-00013980: 6172 206d 696e 206f 7665 7220 7468 6520  ar min over the 
-00013990: 656e 7469 7265 2044 6174 6146 7261 6d65  entire DataFrame
-000139a0: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-000139b0: 2020 2020 2254 6f20 7265 7461 696e 2074      "To retain t
-000139c0: 6865 206f 6c64 2062 6568 6176 696f 722c  he old behavior,
-000139d0: 2075 7365 2027 6672 616d 652e 6d69 6e28   use 'frame.min(
-000139e0: 6178 6973 3d30 2927 206f 7220 6a75 7374  axis=0)' or just
-000139f0: 2027 6672 616d 652e 6d69 6e28 2927 222c   'frame.min()'",
-00013a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013a10: 2046 7574 7572 6557 6172 6e69 6e67 2c0a   FutureWarning,.
-00013a20: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00013a30: 2020 2020 2020 2020 2020 6178 6973 203d            axis =
-00013a40: 2030 0a0a 2020 2020 2020 2020 7265 7475   0..        retu
-00013a50: 726e 2073 656c 662e 5f72 6564 7563 7469  rn self._reducti
-00013a60: 6f6e 5f61 6767 280a 2020 2020 2020 2020  on_agg(.        
-00013a70: 2020 2020 226d 696e 222c 0a20 2020 2020      "min",.     
-00013a80: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
-00013a90: 2c0a 2020 2020 2020 2020 2020 2020 736b  ,.            sk
-00013aa0: 6970 6e61 3d73 6b69 706e 612c 0a20 2020  ipna=skipna,.   
-00013ab0: 2020 2020 2020 2020 2073 706c 6974 5f65           split_e
-00013ac0: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
-00013ad0: 2c0a 2020 2020 2020 2020 2020 2020 6f75  ,.            ou
-00013ae0: 743d 6f75 742c 0a20 2020 2020 2020 2020  t=out,.         
-00013af0: 2020 2023 2053 7461 7274 696e 6720 696e     # Starting in
-00013b00: 2070 616e 6461 7320 322e 302c 2060 6178   pandas 2.0, `ax
-00013b10: 6973 3d4e 6f6e 6560 2064 6f65 7320 6120  is=None` does a 
-00013b20: 6675 6c6c 2061 6767 7265 6761 7469 6f6e  full aggregation
-00013b30: 2061 6372 6f73 7320 626f 7468 2061 7865   across both axe
-00013b40: 730a 2020 2020 2020 2020 2020 2020 6e6f  s.            no
-00013b50: 6e65 5f69 735f 7a65 726f 3d6e 6f74 2050  ne_is_zero=not P
-00013b60: 414e 4441 535f 4754 5f32 3030 2c0a 2020  ANDAS_GT_200,.  
-00013b70: 2020 2020 2020 2020 2020 6e75 6d65 7269            numeri
-00013b80: 635f 6f6e 6c79 3d6e 756d 6572 6963 5f6f  c_only=numeric_o
-00013b90: 6e6c 792c 0a20 2020 2020 2020 2029 0a0a  nly,.        )..
-00013ba0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00013bb0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-00013bc0: 2020 2020 6465 6620 6964 786d 6178 280a      def idxmax(.
-00013bd0: 2020 2020 2020 2020 7365 6c66 2c20 6178          self, ax
-00013be0: 6973 3d4e 6f6e 652c 2073 6b69 706e 613d  is=None, skipna=
-00013bf0: 5472 7565 2c20 7370 6c69 745f 6576 6572  True, split_ever
-00013c00: 793d 4661 6c73 652c 206e 756d 6572 6963  y=False, numeric
-00013c10: 5f6f 6e6c 793d 6e6f 5f64 6566 6175 6c74  _only=no_default
-00013c20: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-00013c30: 666e 203d 2022 6964 786d 6178 220a 2020  fn = "idxmax".  
-00013c40: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
-00013c50: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
-00013c60: 2861 7869 7329 0a20 2020 2020 2020 206e  (axis).        n
-00013c70: 756d 6572 6963 5f6f 6e6c 795f 6b77 6172  umeric_only_kwar
-00013c80: 6773 203d 2063 6865 636b 5f6e 756d 6572  gs = check_numer
-00013c90: 6963 5f6f 6e6c 795f 7661 6c69 6428 6e75  ic_only_valid(nu
-00013ca0: 6d65 7269 635f 6f6e 6c79 2c20 2269 6478  meric_only, "idx
-00013cb0: 6d61 7822 290a 2020 2020 2020 2020 6d65  max").        me
-00013cc0: 7461 203d 2073 656c 662e 5f6d 6574 615f  ta = self._meta_
-00013cd0: 6e6f 6e65 6d70 7479 2e69 6478 6d61 7828  nonempty.idxmax(
-00013ce0: 0a20 2020 2020 2020 2020 2020 2061 7869  .            axi
-00013cf0: 733d 6178 6973 2c20 736b 6970 6e61 3d73  s=axis, skipna=s
-00013d00: 6b69 706e 612c 202a 2a6e 756d 6572 6963  kipna, **numeric
-00013d10: 5f6f 6e6c 795f 6b77 6172 6773 0a20 2020  _only_kwargs.   
-00013d20: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
-00013d30: 6620 6178 6973 203d 3d20 313a 0a20 2020  f axis == 1:.   
-00013d40: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00013d50: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
-00013d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013d70: 4d2e 6964 786d 6178 2c0a 2020 2020 2020  M.idxmax,.      
-00013d80: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
-00013d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013da0: 6d65 7461 3d6d 6574 612c 0a20 2020 2020  meta=meta,.     
-00013db0: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
-00013dc0: 3d73 656c 662e 5f74 6f6b 656e 5f70 7265  =self._token_pre
-00013dd0: 6669 7820 2b20 666e 2c0a 2020 2020 2020  fix + fn,.      
-00013de0: 2020 2020 2020 2020 2020 736b 6970 6e61            skipna
-00013df0: 3d73 6b69 706e 612c 0a20 2020 2020 2020  =skipna,.       
-00013e00: 2020 2020 2020 2020 2061 7869 733d 6178           axis=ax
-00013e10: 6973 2c0a 2020 2020 2020 2020 2020 2020  is,.            
-00013e20: 2020 2020 656e 666f 7263 655f 6d65 7461      enforce_meta
-00013e30: 6461 7461 3d46 616c 7365 2c0a 2020 2020  data=False,.    
-00013e40: 2020 2020 2020 2020 2020 2020 2a2a 6e75              **nu
-00013e50: 6d65 7269 635f 6f6e 6c79 5f6b 7761 7267  meric_only_kwarg
-00013e60: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
-00013e70: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00013e80: 2020 2020 2020 2020 2020 2073 6361 6c61             scala
-00013e90: 7220 3d20 6e6f 7420 6973 5f73 6572 6965  r = not is_serie
-00013ea0: 735f 6c69 6b65 286d 6574 6129 0a20 2020  s_like(meta).   
-00013eb0: 2020 2020 2020 2020 2072 6573 756c 7420           result 
-00013ec0: 3d20 6163 6128 0a20 2020 2020 2020 2020  = aca(.         
-00013ed0: 2020 2020 2020 205b 7365 6c66 5d2c 0a20         [self],. 
-00013ee0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00013ef0: 6875 6e6b 3d69 6478 6d61 786d 696e 5f63  hunk=idxmaxmin_c
-00013f00: 6875 6e6b 2c0a 2020 2020 2020 2020 2020  hunk,.          
-00013f10: 2020 2020 2020 6167 6772 6567 6174 653d        aggregate=
-00013f20: 6964 786d 6178 6d69 6e5f 6167 672c 0a20  idxmaxmin_agg,. 
-00013f30: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00013f40: 6f6d 6269 6e65 3d69 6478 6d61 786d 696e  ombine=idxmaxmin
-00013f50: 5f63 6f6d 6269 6e65 2c0a 2020 2020 2020  _combine,.      
-00013f60: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
-00013f70: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
-00013f80: 2020 2020 2061 6767 7265 6761 7465 5f6b       aggregate_k
-00013f90: 7761 7267 733d 7b22 7363 616c 6172 223a  wargs={"scalar":
-00013fa0: 2073 6361 6c61 727d 2c0a 2020 2020 2020   scalar},.      
-00013fb0: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
-00013fc0: 7365 6c66 2e5f 746f 6b65 6e5f 7072 6566  self._token_pref
-00013fd0: 6978 202b 2066 6e2c 0a20 2020 2020 2020  ix + fn,.       
-00013fe0: 2020 2020 2020 2020 2073 706c 6974 5f65           split_e
-00013ff0: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
-00014000: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00014010: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
+0000a530: 2074 6f20 6f70 6572 6174 6520 6f6e 2065   to operate on e
+0000a540: 6163 6820 7061 7274 6974 696f 6e2e 2053  ach partition. S
+0000a550: 686f 756c 6420 7265 7475 726e 2061 0a20  hould return a. 
+0000a560: 2020 2020 2020 2020 2020 2060 6070 616e             ``pan
+0000a570: 6461 732e 4461 7461 4672 616d 6560 602c  das.DataFrame``,
+0000a580: 2060 6070 616e 6461 732e 5365 7269 6573   ``pandas.Series
+0000a590: 6060 2c20 6f72 2061 2073 6361 6c61 722e  ``, or a scalar.
+0000a5a0: 0a20 2020 2020 2020 2061 6767 7265 6761  .        aggrega
+0000a5b0: 7465 203a 2063 616c 6c61 626c 652c 206f  te : callable, o
+0000a5c0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+0000a5d0: 2020 2020 4675 6e63 7469 6f6e 2074 6f20      Function to 
+0000a5e0: 6f70 6572 6174 6520 6f6e 2074 6865 2063  operate on the c
+0000a5f0: 6f6e 6361 7465 6e61 7465 6420 7265 7375  oncatenated resu
+0000a600: 6c74 206f 6620 6060 6368 756e 6b60 602e  lt of ``chunk``.
+0000a610: 2049 6620 6e6f 740a 2020 2020 2020 2020   If not.        
+0000a620: 2020 2020 7370 6563 6966 6965 642c 2064      specified, d
+0000a630: 6566 6175 6c74 7320 746f 2060 6063 6875  efaults to ``chu
+0000a640: 6e6b 6060 2e20 5573 6564 2074 6f20 646f  nk``. Used to do
+0000a650: 2074 6865 2066 696e 616c 2061 6767 7265   the final aggre
+0000a660: 6761 7469 6f6e 0a20 2020 2020 2020 2020  gation.         
+0000a670: 2020 2069 6e20 6120 7472 6565 2072 6564     in a tree red
+0000a680: 7563 7469 6f6e 2e0a 0a20 2020 2020 2020  uction...       
+0000a690: 2020 2020 2054 6865 2069 6e70 7574 2074       The input t
+0000a6a0: 6f20 6060 6167 6772 6567 6174 6560 6020  o ``aggregate`` 
+0000a6b0: 6465 7065 6e64 7320 6f6e 2074 6865 206f  depends on the o
+0000a6c0: 7574 7075 7420 6f66 2060 6063 6875 6e6b  utput of ``chunk
+0000a6d0: 6060 2e0a 2020 2020 2020 2020 2020 2020  ``..            
+0000a6e0: 4966 2074 6865 206f 7574 7075 7420 6f66  If the output of
+0000a6f0: 2060 6063 6875 6e6b 6060 2069 7320 613a   ``chunk`` is a:
+0000a700: 0a0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+0000a710: 7363 616c 6172 3a20 496e 7075 7420 6973  scalar: Input is
+0000a720: 2061 2053 6572 6965 732c 2077 6974 6820   a Series, with 
+0000a730: 6f6e 6520 726f 7720 7065 7220 7061 7274  one row per part
+0000a740: 6974 696f 6e2e 0a20 2020 2020 2020 2020  ition..         
+0000a750: 2020 202d 2053 6572 6965 733a 2049 6e70     - Series: Inp
+0000a760: 7574 2069 7320 6120 4461 7461 4672 616d  ut is a DataFram
+0000a770: 652c 2077 6974 6820 6f6e 6520 726f 7720  e, with one row 
+0000a780: 7065 7220 7061 7274 6974 696f 6e2e 2043  per partition. C
+0000a790: 6f6c 756d 6e73 0a20 2020 2020 2020 2020  olumns.         
+0000a7a0: 2020 2020 2061 7265 2074 6865 2072 6f77       are the row
+0000a7b0: 7320 696e 2074 6865 206f 7574 7075 7420  s in the output 
+0000a7c0: 7365 7269 6573 2e0a 2020 2020 2020 2020  series..        
+0000a7d0: 2020 2020 2d20 4461 7461 4672 616d 653a      - DataFrame:
+0000a7e0: 2049 6e70 7574 2069 7320 6120 4461 7461   Input is a Data
+0000a7f0: 4672 616d 652c 2077 6974 6820 6f6e 6520  Frame, with one 
+0000a800: 726f 7720 7065 7220 7061 7274 6974 696f  row per partitio
+0000a810: 6e2e 0a20 2020 2020 2020 2020 2020 2020  n..             
+0000a820: 2043 6f6c 756d 6e73 2061 7265 2074 6865   Columns are the
+0000a830: 2063 6f6c 756d 6e73 2069 6e20 7468 6520   columns in the 
+0000a840: 6f75 7470 7574 2064 6174 6166 7261 6d65  output dataframe
+0000a850: 732e 0a0a 2020 2020 2020 2020 2020 2020  s...            
+0000a860: 5368 6f75 6c64 2072 6574 7572 6e20 6120  Should return a 
+0000a870: 6060 7061 6e64 6173 2e44 6174 6146 7261  ``pandas.DataFra
+0000a880: 6d65 6060 2c20 6060 7061 6e64 6173 2e53  me``, ``pandas.S
+0000a890: 6572 6965 7360 602c 206f 7220 610a 2020  eries``, or a.  
+0000a8a0: 2020 2020 2020 2020 2020 7363 616c 6172            scalar
+0000a8b0: 2e0a 2020 2020 2020 2020 636f 6d62 696e  ..        combin
+0000a8c0: 6520 3a20 6361 6c6c 6162 6c65 2c20 6f70  e : callable, op
+0000a8d0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+0000a8e0: 2020 2046 756e 6374 696f 6e20 746f 206f     Function to o
+0000a8f0: 7065 7261 7465 206f 6e20 696e 7465 726d  perate on interm
+0000a900: 6564 6961 7465 2063 6f6e 6361 7465 6e61  ediate concatena
+0000a910: 7465 6420 7265 7375 6c74 7320 6f66 0a20  ted results of. 
+0000a920: 2020 2020 2020 2020 2020 2060 6063 6875             ``chu
+0000a930: 6e6b 6060 2069 6e20 6120 7472 6565 2d72  nk`` in a tree-r
+0000a940: 6564 7563 7469 6f6e 2e20 4966 206e 6f74  eduction. If not
+0000a950: 2070 726f 7669 6465 642c 2064 6566 6175   provided, defau
+0000a960: 6c74 7320 746f 0a20 2020 2020 2020 2020  lts to.         
+0000a970: 2020 2060 6061 6767 7265 6761 7465 6060     ``aggregate``
+0000a980: 2e20 5468 6520 696e 7075 742f 6f75 7470  . The input/outp
+0000a990: 7574 2072 6571 7569 7265 6d65 6e74 7320  ut requirements 
+0000a9a0: 7368 6f75 6c64 206d 6174 6368 2074 6861  should match tha
+0000a9b0: 7420 6f66 0a20 2020 2020 2020 2020 2020  t of.           
+0000a9c0: 2060 6061 6767 7265 6761 7465 6060 2064   ``aggregate`` d
+0000a9d0: 6573 6372 6962 6564 2061 626f 7665 2e0a  escribed above..
+0000a9e0: 2020 2020 2020 2020 244d 4554 410a 2020          $META.  
+0000a9f0: 2020 2020 2020 746f 6b65 6e20 3a20 7374        token : st
+0000aa00: 722c 206f 7074 696f 6e61 6c0a 2020 2020  r, optional.    
+0000aa10: 2020 2020 2020 2020 5468 6520 6e61 6d65          The name
+0000aa20: 2074 6f20 7573 6520 666f 7220 7468 6520   to use for the 
+0000aa30: 6f75 7470 7574 206b 6579 732e 0a20 2020  output keys..   
+0000aa40: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
+0000aa50: 203a 2069 6e74 2c20 6f70 7469 6f6e 616c   : int, optional
+0000aa60: 0a20 2020 2020 2020 2020 2020 2047 726f  .            Gro
+0000aa70: 7570 2070 6172 7469 7469 6f6e 7320 696e  up partitions in
+0000aa80: 746f 2067 726f 7570 7320 6f66 2074 6869  to groups of thi
+0000aa90: 7320 7369 7a65 2077 6869 6c65 2070 6572  s size while per
+0000aaa0: 666f 726d 696e 6720 610a 2020 2020 2020  forming a.      
+0000aab0: 2020 2020 2020 7472 6565 2d72 6564 7563        tree-reduc
+0000aac0: 7469 6f6e 2e20 4966 2073 6574 2074 6f20  tion. If set to 
+0000aad0: 4661 6c73 652c 206e 6f20 7472 6565 2d72  False, no tree-r
+0000aae0: 6564 7563 7469 6f6e 2077 696c 6c20 6265  eduction will be
+0000aaf0: 2075 7365 642c 0a20 2020 2020 2020 2020   used,.         
+0000ab00: 2020 2061 6e64 2061 6c6c 2069 6e74 6572     and all inter
+0000ab10: 6d65 6469 6174 6573 2077 696c 6c20 6265  mediates will be
+0000ab20: 2063 6f6e 6361 7465 6e61 7465 6420 616e   concatenated an
+0000ab30: 6420 7061 7373 6564 2074 6f0a 2020 2020  d passed to.    
+0000ab40: 2020 2020 2020 2020 6060 6167 6772 6567          ``aggreg
+0000ab50: 6174 6560 602e 2044 6566 6175 6c74 2069  ate``. Default i
+0000ab60: 7320 382e 0a20 2020 2020 2020 2063 6875  s 8..        chu
+0000ab70: 6e6b 5f6b 7761 7267 7320 3a20 6469 6374  nk_kwargs : dict
+0000ab80: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0000ab90: 2020 2020 2020 204b 6579 776f 7264 2061         Keyword a
+0000aba0: 7267 756d 656e 7473 2074 6f20 7061 7373  rguments to pass
+0000abb0: 206f 6e20 746f 2060 6063 6875 6e6b 6060   on to ``chunk``
+0000abc0: 206f 6e6c 792e 0a20 2020 2020 2020 2061   only..        a
+0000abd0: 6767 7265 6761 7465 5f6b 7761 7267 7320  ggregate_kwargs 
+0000abe0: 3a20 6469 6374 2c20 6f70 7469 6f6e 616c  : dict, optional
+0000abf0: 0a20 2020 2020 2020 2020 2020 204b 6579  .            Key
+0000ac00: 776f 7264 2061 7267 756d 656e 7473 2074  word arguments t
+0000ac10: 6f20 7061 7373 206f 6e20 746f 2060 6061  o pass on to ``a
+0000ac20: 6767 7265 6761 7465 6060 206f 6e6c 792e  ggregate`` only.
+0000ac30: 0a20 2020 2020 2020 2063 6f6d 6269 6e65  .        combine
+0000ac40: 5f6b 7761 7267 7320 3a20 6469 6374 2c20  _kwargs : dict, 
+0000ac50: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+0000ac60: 2020 2020 204b 6579 776f 7264 2061 7267       Keyword arg
+0000ac70: 756d 656e 7473 2074 6f20 7061 7373 206f  uments to pass o
+0000ac80: 6e20 746f 2060 6063 6f6d 6269 6e65 6060  n to ``combine``
+0000ac90: 206f 6e6c 792e 0a20 2020 2020 2020 206b   only..        k
+0000aca0: 7761 7267 7320 3a0a 2020 2020 2020 2020  wargs :.        
+0000acb0: 2020 2020 416c 6c20 7265 6d61 696e 696e      All remainin
+0000acc0: 6720 6b65 7977 6f72 6473 2077 696c 6c20  g keywords will 
+0000acd0: 6265 2070 6173 7365 6420 746f 2060 6063  be passed to ``c
+0000ace0: 6875 6e6b 6060 2c20 6060 636f 6d62 696e  hunk``, ``combin
+0000acf0: 6560 602c 0a20 2020 2020 2020 2020 2020  e``,.           
+0000ad00: 2061 6e64 2060 6061 6767 7265 6761 7465   and ``aggregate
+0000ad10: 6060 2e0a 0a20 2020 2020 2020 2045 7861  ``...        Exa
+0000ad20: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
+0000ad30: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
+0000ad40: 3e3e 2069 6d70 6f72 7420 7061 6e64 6173  >> import pandas
+0000ad50: 2061 7320 7064 0a20 2020 2020 2020 203e   as pd.        >
+0000ad60: 3e3e 2069 6d70 6f72 7420 6461 736b 2e64  >> import dask.d
+0000ad70: 6174 6166 7261 6d65 2061 7320 6464 0a20  ataframe as dd. 
+0000ad80: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+0000ad90: 7064 2e44 6174 6146 7261 6d65 287b 2778  pd.DataFrame({'x
+0000ada0: 273a 2072 616e 6765 2835 3029 2c20 2779  ': range(50), 'y
+0000adb0: 273a 2072 616e 6765 2835 302c 2031 3030  ': range(50, 100
+0000adc0: 297d 290a 2020 2020 2020 2020 3e3e 3e20  )}).        >>> 
+0000add0: 6464 6620 3d20 6464 2e66 726f 6d5f 7061  ddf = dd.from_pa
+0000ade0: 6e64 6173 2864 662c 206e 7061 7274 6974  ndas(df, npartit
+0000adf0: 696f 6e73 3d34 290a 0a20 2020 2020 2020  ions=4)..       
+0000ae00: 2043 6f75 6e74 2074 6865 206e 756d 6265   Count the numbe
+0000ae10: 7220 6f66 2072 6f77 7320 696e 2061 2044  r of rows in a D
+0000ae20: 6174 6146 7261 6d65 2e20 546f 2064 6f20  ataFrame. To do 
+0000ae30: 7468 6973 2c20 636f 756e 7420 7468 6520  this, count the 
+0000ae40: 6e75 6d62 6572 0a20 2020 2020 2020 206f  number.        o
+0000ae50: 6620 726f 7773 2069 6e20 6561 6368 2070  f rows in each p
+0000ae60: 6172 7469 7469 6f6e 2c20 7468 656e 2073  artition, then s
+0000ae70: 756d 2074 6865 2072 6573 756c 7473 3a0a  um the results:.
+0000ae80: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
+0000ae90: 203d 2064 6466 2e72 6564 7563 7469 6f6e   = ddf.reduction
+0000aea0: 286c 616d 6264 6120 783a 2078 2e63 6f75  (lambda x: x.cou
+0000aeb0: 6e74 2829 2c0a 2020 2020 2020 2020 2e2e  nt(),.        ..
+0000aec0: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
+0000aed0: 2020 2020 2020 6167 6772 6567 6174 653d        aggregate=
+0000aee0: 6c61 6d62 6461 2078 3a20 782e 7375 6d28  lambda x: x.sum(
+0000aef0: 2929 0a20 2020 2020 2020 203e 3e3e 2072  )).        >>> r
+0000af00: 6573 2e63 6f6d 7075 7465 2829 0a20 2020  es.compute().   
+0000af10: 2020 2020 2078 2020 2020 3530 0a20 2020       x    50.   
+0000af20: 2020 2020 2079 2020 2020 3530 0a20 2020       y    50.   
+0000af30: 2020 2020 2064 7479 7065 3a20 696e 7436       dtype: int6
+0000af40: 340a 0a20 2020 2020 2020 2043 6f75 6e74  4..        Count
+0000af50: 2074 6865 206e 756d 6265 7220 6f66 2072   the number of r
+0000af60: 6f77 7320 696e 2061 2053 6572 6965 7320  ows in a Series 
+0000af70: 7769 7468 2065 6c65 6d65 6e74 7320 6772  with elements gr
+0000af80: 6561 7465 7220 7468 616e 206f 720a 2020  eater than or.  
+0000af90: 2020 2020 2020 6571 7561 6c20 746f 2061        equal to a
+0000afa0: 2076 616c 7565 2028 7072 6f76 6964 6564   value (provided
+0000afb0: 2076 6961 2061 206b 6579 776f 7264 292e   via a keyword).
+0000afc0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6465  ..        >>> de
+0000afd0: 6620 636f 756e 745f 6772 6561 7465 7228  f count_greater(
+0000afe0: 782c 2076 616c 7565 3d30 293a 0a20 2020  x, value=0):.   
+0000aff0: 2020 2020 202e 2e2e 2020 2020 2072 6574       ...     ret
+0000b000: 7572 6e20 2878 203e 3d20 7661 6c75 6529  urn (x >= value)
+0000b010: 2e73 756d 2829 0a20 2020 2020 2020 203e  .sum().        >
+0000b020: 3e3e 2072 6573 203d 2064 6466 2e78 2e72  >> res = ddf.x.r
+0000b030: 6564 7563 7469 6f6e 2863 6f75 6e74 5f67  eduction(count_g
+0000b040: 7265 6174 6572 2c20 6167 6772 6567 6174  reater, aggregat
+0000b050: 653d 6c61 6d62 6461 2078 3a20 782e 7375  e=lambda x: x.su
+0000b060: 6d28 292c 0a20 2020 2020 2020 202e 2e2e  m(),.        ...
+0000b070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b080: 2020 2020 2020 2063 6875 6e6b 5f6b 7761         chunk_kwa
+0000b090: 7267 733d 7b27 7661 6c75 6527 3a20 3235  rgs={'value': 25
+0000b0a0: 7d29 0a20 2020 2020 2020 203e 3e3e 2072  }).        >>> r
+0000b0b0: 6573 2e63 6f6d 7075 7465 2829 0a20 2020  es.compute().   
+0000b0c0: 2020 2020 2032 350a 0a20 2020 2020 2020       25..       
+0000b0d0: 2041 6767 7265 6761 7465 2062 6f74 6820   Aggregate both 
+0000b0e0: 7468 6520 7375 6d20 616e 6420 636f 756e  the sum and coun
+0000b0f0: 7420 6f66 2061 2053 6572 6965 7320 6174  t of a Series at
+0000b100: 2074 6865 2073 616d 6520 7469 6d65 3a0a   the same time:.
+0000b110: 0a20 2020 2020 2020 203e 3e3e 2064 6566  .        >>> def
+0000b120: 2073 756d 5f61 6e64 5f63 6f75 6e74 2878   sum_and_count(x
+0000b130: 293a 0a20 2020 2020 2020 202e 2e2e 2020  ):.        ...  
+0000b140: 2020 2072 6574 7572 6e20 7064 2e53 6572     return pd.Ser
+0000b150: 6965 7328 7b27 636f 756e 7427 3a20 782e  ies({'count': x.
+0000b160: 636f 756e 7428 292c 2027 7375 6d27 3a20  count(), 'sum': 
+0000b170: 782e 7375 6d28 297d 2c0a 2020 2020 2020  x.sum()},.      
+0000b180: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
+0000b190: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+0000b1a0: 3d5b 2763 6f75 6e74 272c 2027 7375 6d27  =['count', 'sum'
+0000b1b0: 5d29 0a20 2020 2020 2020 203e 3e3e 2072  ]).        >>> r
+0000b1c0: 6573 203d 2064 6466 2e78 2e72 6564 7563  es = ddf.x.reduc
+0000b1d0: 7469 6f6e 2873 756d 5f61 6e64 5f63 6f75  tion(sum_and_cou
+0000b1e0: 6e74 2c20 6167 6772 6567 6174 653d 6c61  nt, aggregate=la
+0000b1f0: 6d62 6461 2078 3a20 782e 7375 6d28 2929  mbda x: x.sum())
+0000b200: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
+0000b210: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
+0000b220: 2020 2063 6f75 6e74 2020 2020 2020 3530     count      50
+0000b230: 0a20 2020 2020 2020 2073 756d 2020 2020  .        sum    
+0000b240: 2020 3132 3235 0a20 2020 2020 2020 2064    1225.        d
+0000b250: 7479 7065 3a20 696e 7436 340a 0a20 2020  type: int64..   
+0000b260: 2020 2020 2044 6f69 6e67 2074 6865 2073       Doing the s
+0000b270: 616d 652c 2062 7574 2066 6f72 2061 2044  ame, but for a D
+0000b280: 6174 6146 7261 6d65 2e20 4865 7265 2060  ataFrame. Here `
+0000b290: 6063 6875 6e6b 6060 2072 6574 7572 6e73  `chunk`` returns
+0000b2a0: 2061 0a20 2020 2020 2020 2044 6174 6146   a.        DataF
+0000b2b0: 7261 6d65 2c20 6d65 616e 696e 6720 7468  rame, meaning th
+0000b2c0: 6520 696e 7075 7420 746f 2060 6061 6767  e input to ``agg
+0000b2d0: 7265 6761 7465 6060 2069 7320 6120 4461  regate`` is a Da
+0000b2e0: 7461 4672 616d 6520 7769 7468 2061 6e0a  taFrame with an.
+0000b2f0: 2020 2020 2020 2020 696e 6465 7820 7769          index wi
+0000b300: 7468 206e 6f6e 2d75 6e69 7175 6520 656e  th non-unique en
+0000b310: 7472 6965 7320 666f 7220 626f 7468 2027  tries for both '
+0000b320: 7827 2061 6e64 2027 7927 2e20 5765 2067  x' and 'y'. We g
+0000b330: 726f 7570 6279 2074 6865 0a20 2020 2020  roupby the.     
+0000b340: 2020 2069 6e64 6578 2c20 616e 6420 7375     index, and su
+0000b350: 6d20 6561 6368 2067 726f 7570 2074 6f20  m each group to 
+0000b360: 6765 7420 7468 6520 6669 6e61 6c20 7265  get the final re
+0000b370: 7375 6c74 2e0a 0a20 2020 2020 2020 203e  sult...        >
+0000b380: 3e3e 2064 6566 2073 756d 5f61 6e64 5f63  >> def sum_and_c
+0000b390: 6f75 6e74 2878 293a 0a20 2020 2020 2020  ount(x):.       
+0000b3a0: 202e 2e2e 2020 2020 2072 6574 7572 6e20   ...     return 
+0000b3b0: 7064 2e44 6174 6146 7261 6d65 287b 2763  pd.DataFrame({'c
+0000b3c0: 6f75 6e74 273a 2078 2e63 6f75 6e74 2829  ount': x.count()
+0000b3d0: 2c20 2773 756d 273a 2078 2e73 756d 2829  , 'sum': x.sum()
+0000b3e0: 7d2c 0a20 2020 2020 2020 202e 2e2e 2020  },.        ...  
+0000b3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b400: 2020 2020 2020 2063 6f6c 756d 6e73 3d5b         columns=[
+0000b410: 2763 6f75 6e74 272c 2027 7375 6d27 5d29  'count', 'sum'])
+0000b420: 0a20 2020 2020 2020 203e 3e3e 2072 6573  .        >>> res
+0000b430: 203d 2064 6466 2e72 6564 7563 7469 6f6e   = ddf.reduction
+0000b440: 2873 756d 5f61 6e64 5f63 6f75 6e74 2c0a  (sum_and_count,.
+0000b450: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0000b460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b470: 6167 6772 6567 6174 653d 6c61 6d62 6461  aggregate=lambda
+0000b480: 2078 3a20 782e 6772 6f75 7062 7928 6c65   x: x.groupby(le
+0000b490: 7665 6c3d 3029 2e73 756d 2829 290a 2020  vel=0).sum()).  
+0000b4a0: 2020 2020 2020 3e3e 3e20 7265 732e 636f        >>> res.co
+0000b4b0: 6d70 7574 6528 290a 2020 2020 2020 2020  mpute().        
+0000b4c0: 2020 2063 6f75 6e74 2020 2073 756d 0a20     count   sum. 
+0000b4d0: 2020 2020 2020 2078 2020 2020 2035 3020         x     50 
+0000b4e0: 2031 3232 350a 2020 2020 2020 2020 7920   1225.        y 
+0000b4f0: 2020 2020 3530 2020 3337 3235 0a20 2020      50  3725.   
+0000b500: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000b510: 2069 6620 6167 6772 6567 6174 6520 6973   if aggregate is
+0000b520: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0000b530: 2020 2061 6767 7265 6761 7465 203d 2063     aggregate = c
+0000b540: 6875 6e6b 0a0a 2020 2020 2020 2020 6966  hunk..        if
+0000b550: 2063 6f6d 6269 6e65 2069 7320 4e6f 6e65   combine is None
+0000b560: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0000b570: 2063 6f6d 6269 6e65 5f6b 7761 7267 733a   combine_kwargs:
+0000b580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b590: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0000b5a0: 7228 2260 636f 6d62 696e 655f 6b77 6172  r("`combine_kwar
+0000b5b0: 6773 6020 7072 6f76 6964 6564 2077 6974  gs` provided wit
+0000b5c0: 6820 6e6f 2060 636f 6d62 696e 6560 2229  h no `combine`")
+0000b5d0: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
+0000b5e0: 6269 6e65 203d 2061 6767 7265 6761 7465  bine = aggregate
+0000b5f0: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
+0000b600: 6269 6e65 5f6b 7761 7267 7320 3d20 6167  bine_kwargs = ag
+0000b610: 6772 6567 6174 655f 6b77 6172 6773 0a0a  gregate_kwargs..
+0000b620: 2020 2020 2020 2020 6368 756e 6b5f 6b77          chunk_kw
+0000b630: 6172 6773 203d 2063 6875 6e6b 5f6b 7761  args = chunk_kwa
+0000b640: 7267 732e 636f 7079 2829 2069 6620 6368  rgs.copy() if ch
+0000b650: 756e 6b5f 6b77 6172 6773 2065 6c73 6520  unk_kwargs else 
+0000b660: 7b7d 0a20 2020 2020 2020 2063 6875 6e6b  {}.        chunk
+0000b670: 5f6b 7761 7267 735b 2261 6361 5f63 6875  _kwargs["aca_chu
+0000b680: 6e6b 225d 203d 2063 6875 6e6b 0a0a 2020  nk"] = chunk..  
+0000b690: 2020 2020 2020 636f 6d62 696e 655f 6b77        combine_kw
+0000b6a0: 6172 6773 203d 2063 6f6d 6269 6e65 5f6b  args = combine_k
+0000b6b0: 7761 7267 732e 636f 7079 2829 2069 6620  wargs.copy() if 
+0000b6c0: 636f 6d62 696e 655f 6b77 6172 6773 2065  combine_kwargs e
+0000b6d0: 6c73 6520 7b7d 0a20 2020 2020 2020 2063  lse {}.        c
+0000b6e0: 6f6d 6269 6e65 5f6b 7761 7267 735b 2261  ombine_kwargs["a
+0000b6f0: 6361 5f63 6f6d 6269 6e65 225d 203d 2063  ca_combine"] = c
+0000b700: 6f6d 6269 6e65 0a0a 2020 2020 2020 2020  ombine..        
+0000b710: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
+0000b720: 203d 2061 6767 7265 6761 7465 5f6b 7761   = aggregate_kwa
+0000b730: 7267 732e 636f 7079 2829 2069 6620 6167  rgs.copy() if ag
+0000b740: 6772 6567 6174 655f 6b77 6172 6773 2065  gregate_kwargs e
+0000b750: 6c73 6520 7b7d 0a20 2020 2020 2020 2061  lse {}.        a
+0000b760: 6767 7265 6761 7465 5f6b 7761 7267 735b  ggregate_kwargs[
+0000b770: 2261 6361 5f61 6767 7265 6761 7465 225d  "aca_aggregate"]
+0000b780: 203d 2061 6767 7265 6761 7465 0a0a 2020   = aggregate..  
+0000b790: 2020 2020 2020 7265 7475 726e 2061 6361        return aca
+0000b7a0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+0000b7b0: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+0000b7c0: 6368 756e 6b3d 5f72 6564 7563 7469 6f6e  chunk=_reduction
+0000b7d0: 5f63 6875 6e6b 2c0a 2020 2020 2020 2020  _chunk,.        
+0000b7e0: 2020 2020 6167 6772 6567 6174 653d 5f72      aggregate=_r
+0000b7f0: 6564 7563 7469 6f6e 5f61 6767 7265 6761  eduction_aggrega
+0000b800: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+0000b810: 636f 6d62 696e 653d 5f72 6564 7563 7469  combine=_reducti
+0000b820: 6f6e 5f63 6f6d 6269 6e65 2c0a 2020 2020  on_combine,.    
+0000b830: 2020 2020 2020 2020 6d65 7461 3d6d 6574          meta=met
+0000b840: 612c 0a20 2020 2020 2020 2020 2020 2074  a,.            t
+0000b850: 6f6b 656e 3d74 6f6b 656e 2c0a 2020 2020  oken=token,.    
+0000b860: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
+0000b870: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
+0000b880: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
+0000b890: 6e6b 5f6b 7761 7267 733d 6368 756e 6b5f  nk_kwargs=chunk_
+0000b8a0: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+0000b8b0: 2020 2020 6167 6772 6567 6174 655f 6b77      aggregate_kw
+0000b8c0: 6172 6773 3d61 6767 7265 6761 7465 5f6b  args=aggregate_k
+0000b8d0: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
+0000b8e0: 2020 2063 6f6d 6269 6e65 5f6b 7761 7267     combine_kwarg
+0000b8f0: 733d 636f 6d62 696e 655f 6b77 6172 6773  s=combine_kwargs
+0000b900: 2c0a 2020 2020 2020 2020 2020 2020 2a2a  ,.            **
+0000b910: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+0000b920: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+0000b930: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+0000b940: 6529 0a20 2020 2064 6566 2070 6970 6528  e).    def pipe(
+0000b950: 7365 6c66 2c20 6675 6e63 2c20 2a61 7267  self, func, *arg
+0000b960: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
+0000b970: 2020 2020 2020 2320 5461 6b65 6e20 6672        # Taken fr
+0000b980: 6f6d 2070 616e 6461 733a 0a20 2020 2020  om pandas:.     
+0000b990: 2020 2023 2068 7474 7073 3a2f 2f67 6974     # https://git
+0000b9a0: 6875 622e 636f 6d2f 7079 6461 7461 2f70  hub.com/pydata/p
+0000b9b0: 616e 6461 732f 626c 6f62 2f6d 6173 7465  andas/blob/maste
+0000b9c0: 722f 7061 6e64 6173 2f63 6f72 652f 6765  r/pandas/core/ge
+0000b9d0: 6e65 7269 632e 7079 234c 3236 3938 2d4c  neric.py#L2698-L
+0000b9e0: 3237 3037 0a20 2020 2020 2020 2069 6620  2707.        if 
+0000b9f0: 6973 696e 7374 616e 6365 2866 756e 632c  isinstance(func,
+0000ba00: 2074 7570 6c65 293a 0a20 2020 2020 2020   tuple):.       
+0000ba10: 2020 2020 2066 756e 632c 2074 6172 6765       func, targe
+0000ba20: 7420 3d20 6675 6e63 0a20 2020 2020 2020  t = func.       
+0000ba30: 2020 2020 2069 6620 7461 7267 6574 2069       if target i
+0000ba40: 6e20 6b77 6172 6773 3a0a 2020 2020 2020  n kwargs:.      
+0000ba50: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000ba60: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+0000ba70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ba80: 2225 7320 6973 2062 6f74 6820 7468 6520  "%s is both the 
+0000ba90: 7069 7065 2074 6172 6765 7420 616e 6420  pipe target and 
+0000baa0: 6120 6b65 7977 6f72 6420 6172 6775 6d65  a keyword argume
+0000bab0: 6e74 2220 2520 7461 7267 6574 0a20 2020  nt" % target.   
+0000bac0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+0000bad0: 2020 2020 2020 2020 2020 206b 7761 7267             kwarg
+0000bae0: 735b 7461 7267 6574 5d20 3d20 7365 6c66  s[target] = self
+0000baf0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000bb00: 7572 6e20 6675 6e63 282a 6172 6773 2c20  urn func(*args, 
+0000bb10: 2a2a 6b77 6172 6773 290a 2020 2020 2020  **kwargs).      
+0000bb20: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000bb30: 2020 2020 7265 7475 726e 2066 756e 6328      return func(
+0000bb40: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+0000bb50: 7761 7267 7329 0a0a 2020 2020 6465 6620  wargs)..    def 
+0000bb60: 7261 6e64 6f6d 5f73 706c 6974 2873 656c  random_split(sel
+0000bb70: 662c 2066 7261 632c 2072 616e 646f 6d5f  f, frac, random_
+0000bb80: 7374 6174 653d 4e6f 6e65 2c20 7368 7566  state=None, shuf
+0000bb90: 666c 653d 4661 6c73 6529 3a0a 2020 2020  fle=False):.    
+0000bba0: 2020 2020 2222 2250 7365 7564 6f72 616e      """Pseudoran
+0000bbb0: 646f 6d6c 7920 7370 6c69 7420 6461 7461  domly split data
+0000bbc0: 6672 616d 6520 696e 746f 2064 6966 6665  frame into diffe
+0000bbd0: 7265 6e74 2070 6965 6365 7320 726f 772d  rent pieces row-
+0000bbe0: 7769 7365 0a0a 2020 2020 2020 2020 5061  wise..        Pa
+0000bbf0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+0000bc00: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+0000bc10: 2020 2020 6672 6163 203a 206c 6973 740a      frac : list.
+0000bc20: 2020 2020 2020 2020 2020 2020 4c69 7374              List
+0000bc30: 206f 6620 666c 6f61 7473 2074 6861 7420   of floats that 
+0000bc40: 7368 6f75 6c64 2073 756d 2074 6f20 6f6e  should sum to on
+0000bc50: 652e 0a20 2020 2020 2020 2072 616e 646f  e..        rando
+0000bc60: 6d5f 7374 6174 6520 3a20 696e 7420 6f72  m_state : int or
+0000bc70: 206e 702e 7261 6e64 6f6d 2e52 616e 646f   np.random.Rando
+0000bc80: 6d53 7461 7465 0a20 2020 2020 2020 2020  mState.         
+0000bc90: 2020 2049 6620 696e 7420 6372 6561 7465     If int create
+0000bca0: 2061 206e 6577 2052 616e 646f 6d53 7461   a new RandomSta
+0000bcb0: 7465 2077 6974 6820 7468 6973 2061 7320  te with this as 
+0000bcc0: 7468 6520 7365 6564 2e0a 2020 2020 2020  the seed..      
+0000bcd0: 2020 2020 2020 4f74 6865 7277 6973 6520        Otherwise 
+0000bce0: 6472 6177 2066 726f 6d20 7468 6520 7061  draw from the pa
+0000bcf0: 7373 6564 2052 616e 646f 6d53 7461 7465  ssed RandomState
+0000bd00: 2e0a 2020 2020 2020 2020 7368 7566 666c  ..        shuffl
+0000bd10: 6520 3a20 626f 6f6c 2c20 6465 6661 756c  e : bool, defaul
+0000bd20: 7420 4661 6c73 650a 2020 2020 2020 2020  t False.        
+0000bd30: 2020 2020 4966 2073 6574 2074 6f20 5472      If set to Tr
+0000bd40: 7565 2c20 7468 6520 6461 7461 6672 616d  ue, the datafram
+0000bd50: 6520 6973 2073 6875 6666 6c65 6420 2877  e is shuffled (w
+0000bd60: 6974 6869 6e20 7061 7274 6974 696f 6e29  ithin partition)
+0000bd70: 0a20 2020 2020 2020 2020 2020 2062 6566  .            bef
+0000bd80: 6f72 6520 7468 6520 7370 6c69 742e 0a0a  ore the split...
+0000bd90: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+0000bda0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000bdb0: 2d0a 0a20 2020 2020 2020 2035 302f 3530  -..        50/50
+0000bdc0: 2073 706c 6974 0a0a 2020 2020 2020 2020   split..        
+0000bdd0: 3e3e 3e20 612c 2062 203d 2064 662e 7261  >>> a, b = df.ra
+0000bde0: 6e64 6f6d 5f73 706c 6974 285b 302e 352c  ndom_split([0.5,
+0000bdf0: 2030 2e35 5d29 2020 2320 646f 6374 6573   0.5])  # doctes
+0000be00: 743a 202b 534b 4950 0a0a 2020 2020 2020  t: +SKIP..      
+0000be10: 2020 3830 2f31 302f 3130 2073 706c 6974    80/10/10 split
+0000be20: 2c20 636f 6e73 6973 7465 6e74 2072 616e  , consistent ran
+0000be30: 646f 6d5f 7374 6174 650a 0a20 2020 2020  dom_state..     
+0000be40: 2020 203e 3e3e 2061 2c20 622c 2063 203d     >>> a, b, c =
+0000be50: 2064 662e 7261 6e64 6f6d 5f73 706c 6974   df.random_split
+0000be60: 285b 302e 382c 2030 2e31 2c20 302e 315d  ([0.8, 0.1, 0.1]
+0000be70: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d31  , random_state=1
+0000be80: 3233 2920 2023 2064 6f63 7465 7374 3a20  23)  # doctest: 
+0000be90: 2b53 4b49 500a 0a20 2020 2020 2020 2053  +SKIP..        S
+0000bea0: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
+0000beb0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0000bec0: 2064 6173 6b2e 4461 7461 4672 616d 652e   dask.DataFrame.
+0000bed0: 7361 6d70 6c65 0a20 2020 2020 2020 2022  sample.        "
+0000bee0: 2222 0a20 2020 2020 2020 2069 6620 6e6f  "".        if no
+0000bef0: 7420 6e70 2e61 6c6c 636c 6f73 6528 7375  t np.allclose(su
+0000bf00: 6d28 6672 6163 292c 2031 293a 0a20 2020  m(frac), 1):.   
+0000bf10: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0000bf20: 616c 7565 4572 726f 7228 2266 7261 6320  alueError("frac 
+0000bf30: 7368 6f75 6c64 2073 756d 2074 6f20 3122  should sum to 1"
+0000bf40: 290a 2020 2020 2020 2020 7374 6174 655f  ).        state_
+0000bf50: 6461 7461 203d 2072 616e 646f 6d5f 7374  data = random_st
+0000bf60: 6174 655f 6461 7461 2873 656c 662e 6e70  ate_data(self.np
+0000bf70: 6172 7469 7469 6f6e 732c 2072 616e 646f  artitions, rando
+0000bf80: 6d5f 7374 6174 6529 0a20 2020 2020 2020  m_state).       
+0000bf90: 2074 6f6b 656e 203d 2074 6f6b 656e 697a   token = tokeniz
+0000bfa0: 6528 7365 6c66 2c20 6672 6163 2c20 7261  e(self, frac, ra
+0000bfb0: 6e64 6f6d 5f73 7461 7465 290a 2020 2020  ndom_state).    
+0000bfc0: 2020 2020 6e61 6d65 203d 2022 7370 6c69      name = "spli
+0000bfd0: 742d 2220 2b20 746f 6b65 6e0a 2020 2020  t-" + token.    
+0000bfe0: 2020 2020 6c61 7965 7220 3d20 7b0a 2020      layer = {.  
+0000bff0: 2020 2020 2020 2020 2020 286e 616d 652c            (name,
+0000c000: 2069 293a 2028 7064 5f73 706c 6974 2c20   i): (pd_split, 
+0000c010: 2873 656c 662e 5f6e 616d 652c 2069 292c  (self._name, i),
+0000c020: 2066 7261 632c 2073 7461 7465 2c20 7368   frac, state, sh
+0000c030: 7566 666c 6529 0a20 2020 2020 2020 2020  uffle).         
+0000c040: 2020 2066 6f72 2069 2c20 7374 6174 6520     for i, state 
+0000c050: 696e 2065 6e75 6d65 7261 7465 2873 7461  in enumerate(sta
+0000c060: 7465 5f64 6174 6129 0a20 2020 2020 2020  te_data).       
+0000c070: 207d 0a0a 2020 2020 2020 2020 6f75 7420   }..        out 
+0000c080: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
+0000c090: 2069 2069 6e20 7261 6e67 6528 6c65 6e28   i in range(len(
+0000c0a0: 6672 6163 2929 3a0a 2020 2020 2020 2020  frac)):.        
+0000c0b0: 2020 2020 6e61 6d65 3220 3d20 2273 706c      name2 = "spl
+0000c0c0: 6974 2d25 642d 2573 2220 2520 2869 2c20  it-%d-%s" % (i, 
+0000c0d0: 746f 6b65 6e29 0a20 2020 2020 2020 2020  token).         
+0000c0e0: 2020 2064 736b 3220 3d20 7b0a 2020 2020     dsk2 = {.    
+0000c0f0: 2020 2020 2020 2020 2020 2020 286e 616d              (nam
+0000c100: 6532 2c20 6a29 3a20 2867 6574 6974 656d  e2, j): (getitem
+0000c110: 2c20 286e 616d 652c 206a 292c 2069 2920  , (name, j), i) 
+0000c120: 666f 7220 6a20 696e 2072 616e 6765 2873  for j in range(s
+0000c130: 656c 662e 6e70 6172 7469 7469 6f6e 7329  elf.npartitions)
+0000c140: 0a20 2020 2020 2020 2020 2020 207d 0a20  .            }. 
+0000c150: 2020 2020 2020 2020 2020 2067 7261 7068             graph
+0000c160: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+0000c170: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+0000c180: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
+0000c190: 2020 2020 6e61 6d65 322c 206d 6572 6765      name2, merge
+0000c1a0: 2864 736b 322c 206c 6179 6572 292c 2064  (dsk2, layer), d
+0000c1b0: 6570 656e 6465 6e63 6965 733d 5b73 656c  ependencies=[sel
+0000c1c0: 665d 0a20 2020 2020 2020 2020 2020 2029  f].            )
+0000c1d0: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
+0000c1e0: 5f64 6620 3d20 7479 7065 2873 656c 6629  _df = type(self)
+0000c1f0: 2867 7261 7068 2c20 6e61 6d65 322c 2073  (graph, name2, s
+0000c200: 656c 662e 5f6d 6574 612c 2073 656c 662e  elf._meta, self.
+0000c210: 6469 7669 7369 6f6e 7329 0a20 2020 2020  divisions).     
+0000c220: 2020 2020 2020 206f 7574 2e61 7070 656e         out.appen
+0000c230: 6428 6f75 745f 6466 290a 2020 2020 2020  d(out_df).      
+0000c240: 2020 7265 7475 726e 206f 7574 0a0a 2020    return out..  
+0000c250: 2020 6465 6620 6865 6164 2873 656c 662c    def head(self,
+0000c260: 206e 3d35 2c20 6e70 6172 7469 7469 6f6e   n=5, npartition
+0000c270: 733d 312c 2063 6f6d 7075 7465 3d54 7275  s=1, compute=Tru
+0000c280: 6529 3a0a 2020 2020 2020 2020 2222 2246  e):.        """F
+0000c290: 6972 7374 206e 2072 6f77 7320 6f66 2074  irst n rows of t
+0000c2a0: 6865 2064 6174 6173 6574 0a0a 2020 2020  he dataset..    
+0000c2b0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+0000c2c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000c2d0: 2d0a 2020 2020 2020 2020 6e20 3a20 696e  -.        n : in
+0000c2e0: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
+0000c2f0: 2020 2020 2020 2020 5468 6520 6e75 6d62          The numb
+0000c300: 6572 206f 6620 726f 7773 2074 6f20 7265  er of rows to re
+0000c310: 7475 726e 2e20 4465 6661 756c 7420 6973  turn. Default is
+0000c320: 2035 2e0a 2020 2020 2020 2020 6e70 6172   5..        npar
+0000c330: 7469 7469 6f6e 7320 3a20 696e 742c 206f  titions : int, o
+0000c340: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+0000c350: 2020 2020 456c 656d 656e 7473 2061 7265      Elements are
+0000c360: 206f 6e6c 7920 7461 6b65 6e20 6672 6f6d   only taken from
+0000c370: 2074 6865 2066 6972 7374 2060 606e 7061   the first ``npa
+0000c380: 7274 6974 696f 6e73 6060 2c20 7769 7468  rtitions``, with
+0000c390: 2061 0a20 2020 2020 2020 2020 2020 2064   a.            d
+0000c3a0: 6566 6175 6c74 206f 6620 312e 2049 6620  efault of 1. If 
+0000c3b0: 7468 6572 6520 6172 6520 6665 7765 7220  there are fewer 
+0000c3c0: 7468 616e 2060 606e 6060 2072 6f77 7320  than ``n`` rows 
+0000c3d0: 696e 2074 6865 2066 6972 7374 0a20 2020  in the first.   
+0000c3e0: 2020 2020 2020 2020 2060 606e 7061 7274           ``npart
+0000c3f0: 6974 696f 6e73 6060 2061 2077 6172 6e69  itions`` a warni
+0000c400: 6e67 2077 696c 6c20 6265 2072 6169 7365  ng will be raise
+0000c410: 6420 616e 6420 616e 7920 666f 756e 6420  d and any found 
+0000c420: 726f 7773 0a20 2020 2020 2020 2020 2020  rows.           
+0000c430: 2072 6574 7572 6e65 642e 2050 6173 7320   returned. Pass 
+0000c440: 2d31 2074 6f20 7573 6520 616c 6c20 7061  -1 to use all pa
+0000c450: 7274 6974 696f 6e73 2e0a 2020 2020 2020  rtitions..      
+0000c460: 2020 636f 6d70 7574 6520 3a20 626f 6f6c    compute : bool
+0000c470: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0000c480: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
+0000c490: 6f20 636f 6d70 7574 6520 7468 6520 7265  o compute the re
+0000c4a0: 7375 6c74 2c20 6465 6661 756c 7420 6973  sult, default is
+0000c4b0: 2054 7275 652e 0a20 2020 2020 2020 2022   True..        "
+0000c4c0: 2222 0a20 2020 2020 2020 2069 6620 6e70  "".        if np
+0000c4d0: 6172 7469 7469 6f6e 7320 3c3d 202d 313a  artitions <= -1:
+0000c4e0: 0a20 2020 2020 2020 2020 2020 206e 7061  .            npa
+0000c4f0: 7274 6974 696f 6e73 203d 2073 656c 662e  rtitions = self.
+0000c500: 6e70 6172 7469 7469 6f6e 730a 2020 2020  npartitions.    
+0000c510: 2020 2020 2320 4e6f 206e 6565 6420 746f      # No need to
+0000c520: 2077 6172 6e20 6966 2077 6527 7265 2061   warn if we're a
+0000c530: 6c72 6561 6479 206c 6f6f 6b69 6e67 2061  lready looking a
+0000c540: 7420 616c 6c20 7061 7274 6974 696f 6e73  t all partitions
+0000c550: 0a20 2020 2020 2020 2073 6166 6520 3d20  .        safe = 
+0000c560: 6e70 6172 7469 7469 6f6e 7320 213d 2073  npartitions != s
+0000c570: 656c 662e 6e70 6172 7469 7469 6f6e 730a  elf.npartitions.
+0000c580: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000c590: 656c 662e 5f68 6561 6428 6e3d 6e2c 206e  elf._head(n=n, n
+0000c5a0: 7061 7274 6974 696f 6e73 3d6e 7061 7274  partitions=npart
+0000c5b0: 6974 696f 6e73 2c20 636f 6d70 7574 653d  itions, compute=
+0000c5c0: 636f 6d70 7574 652c 2073 6166 653d 7361  compute, safe=sa
+0000c5d0: 6665 290a 0a20 2020 2064 6566 205f 6865  fe)..    def _he
+0000c5e0: 6164 2873 656c 662c 206e 2c20 6e70 6172  ad(self, n, npar
+0000c5f0: 7469 7469 6f6e 732c 2063 6f6d 7075 7465  titions, compute
+0000c600: 2c20 7361 6665 293a 0a20 2020 2020 2020  , safe):.       
+0000c610: 2069 6620 6e70 6172 7469 7469 6f6e 7320   if npartitions 
+0000c620: 3c3d 202d 313a 0a20 2020 2020 2020 2020  <= -1:.         
+0000c630: 2020 206e 7061 7274 6974 696f 6e73 203d     npartitions =
+0000c640: 2073 656c 662e 6e70 6172 7469 7469 6f6e   self.npartition
+0000c650: 730a 2020 2020 2020 2020 6966 206e 7061  s.        if npa
+0000c660: 7274 6974 696f 6e73 203e 2073 656c 662e  rtitions > self.
+0000c670: 6e70 6172 7469 7469 6f6e 733a 0a20 2020  npartitions:.   
+0000c680: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0000c690: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+0000c6a0: 2020 2020 2020 2020 2020 2066 226f 6e6c             f"onl
+0000c6b0: 7920 7b73 656c 662e 6e70 6172 7469 7469  y {self.npartiti
+0000c6c0: 6f6e 737d 2070 6172 7469 7469 6f6e 732c  ons} partitions,
+0000c6d0: 2068 6561 6420 7265 6365 6976 6564 207b   head received {
+0000c6e0: 6e70 6172 7469 7469 6f6e 737d 220a 2020  npartitions}".  
+0000c6f0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0000c700: 2020 2020 206e 616d 6520 3d20 6622 6865       name = f"he
+0000c710: 6164 2d7b 6e70 6172 7469 7469 6f6e 737d  ad-{npartitions}
+0000c720: 2d7b 6e7d 2d7b 7365 6c66 2e5f 6e61 6d65  -{n}-{self._name
+0000c730: 7d22 0a20 2020 2020 2020 2069 6620 7361  }".        if sa
+0000c740: 6665 3a0a 2020 2020 2020 2020 2020 2020  fe:.            
+0000c750: 6865 6164 203d 2073 6166 655f 6865 6164  head = safe_head
+0000c760: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0000c770: 2020 2020 2020 2020 2020 2068 6561 6420             head 
+0000c780: 3d20 4d2e 6865 6164 0a0a 2020 2020 2020  = M.head..      
+0000c790: 2020 6966 206e 7061 7274 6974 696f 6e73    if npartitions
+0000c7a0: 203e 2031 3a0a 2020 2020 2020 2020 2020   > 1:.          
+0000c7b0: 2020 6e61 6d65 5f70 203d 2066 2268 6561    name_p = f"hea
+0000c7c0: 642d 7061 7274 6961 6c2d 7b6e 7d2d 7b73  d-partial-{n}-{s
+0000c7d0: 656c 662e 5f6e 616d 657d 220a 0a20 2020  elf._name}"..   
+0000c7e0: 2020 2020 2020 2020 2064 736b 203d 207b           dsk = {
+0000c7f0: 7d0a 2020 2020 2020 2020 2020 2020 666f  }.            fo
+0000c800: 7220 6920 696e 2072 616e 6765 286e 7061  r i in range(npa
+0000c810: 7274 6974 696f 6e73 293a 0a20 2020 2020  rtitions):.     
+0000c820: 2020 2020 2020 2020 2020 2064 736b 5b28             dsk[(
+0000c830: 6e61 6d65 5f70 2c20 6929 5d20 3d20 284d  name_p, i)] = (M
+0000c840: 2e68 6561 642c 2028 7365 6c66 2e5f 6e61  .head, (self._na
+0000c850: 6d65 2c20 6929 2c20 6e29 0a0a 2020 2020  me, i), n)..    
+0000c860: 2020 2020 2020 2020 636f 6e63 6174 203d          concat =
+0000c870: 2028 5f63 6f6e 6361 742c 205b 286e 616d   (_concat, [(nam
+0000c880: 655f 702c 2069 2920 666f 7220 6920 696e  e_p, i) for i in
+0000c890: 2072 616e 6765 286e 7061 7274 6974 696f   range(npartitio
+0000c8a0: 6e73 295d 290a 2020 2020 2020 2020 2020  ns)]).          
+0000c8b0: 2020 6473 6b5b 286e 616d 652c 2030 295d    dsk[(name, 0)]
+0000c8c0: 203d 2028 6865 6164 2c20 636f 6e63 6174   = (head, concat
+0000c8d0: 2c20 6e29 0a20 2020 2020 2020 2065 6c73  , n).        els
+0000c8e0: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
+0000c8f0: 736b 203d 207b 286e 616d 652c 2030 293a  sk = {(name, 0):
+0000c900: 2028 6865 6164 2c20 2873 656c 662e 5f6e   (head, (self._n
+0000c910: 616d 652c 2030 292c 206e 297d 0a0a 2020  ame, 0), n)}..  
+0000c920: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
+0000c930: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
+0000c940: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6e61  m_collections(na
+0000c950: 6d65 2c20 6473 6b2c 2064 6570 656e 6465  me, dsk, depende
+0000c960: 6e63 6965 733d 5b73 656c 665d 290a 2020  ncies=[self]).  
+0000c970: 2020 2020 2020 7265 7375 6c74 203d 206e        result = n
+0000c980: 6577 5f64 645f 6f62 6a65 6374 280a 2020  ew_dd_object(.  
+0000c990: 2020 2020 2020 2020 2020 6772 6170 682c            graph,
+0000c9a0: 206e 616d 652c 2073 656c 662e 5f6d 6574   name, self._met
+0000c9b0: 612c 205b 7365 6c66 2e64 6976 6973 696f  a, [self.divisio
+0000c9c0: 6e73 5b30 5d2c 2073 656c 662e 6469 7669  ns[0], self.divi
+0000c9d0: 7369 6f6e 735b 6e70 6172 7469 7469 6f6e  sions[npartition
+0000c9e0: 735d 5d0a 2020 2020 2020 2020 290a 0a20  s]].        ).. 
+0000c9f0: 2020 2020 2020 2069 6620 636f 6d70 7574         if comput
+0000ca00: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0000ca10: 6573 756c 7420 3d20 7265 7375 6c74 2e63  esult = result.c
+0000ca20: 6f6d 7075 7465 2829 0a20 2020 2020 2020  ompute().       
+0000ca30: 2072 6574 7572 6e20 7265 7375 6c74 0a0a   return result..
+0000ca40: 2020 2020 6465 6620 7461 696c 2873 656c      def tail(sel
+0000ca50: 662c 206e 3d35 2c20 636f 6d70 7574 653d  f, n=5, compute=
+0000ca60: 5472 7565 293a 0a20 2020 2020 2020 2022  True):.        "
+0000ca70: 2222 4c61 7374 206e 2072 6f77 7320 6f66  ""Last n rows of
+0000ca80: 2074 6865 2064 6174 6173 6574 0a0a 2020   the dataset..  
+0000ca90: 2020 2020 2020 4361 7665 6174 2c20 7468        Caveat, th
+0000caa0: 6520 6f6e 6c79 2063 6865 636b 7320 7468  e only checks th
+0000cab0: 6520 6c61 7374 206e 2072 6f77 7320 6f66  e last n rows of
+0000cac0: 2074 6865 206c 6173 7420 7061 7274 6974   the last partit
+0000cad0: 696f 6e2e 0a20 2020 2020 2020 2022 2222  ion..        """
+0000cae0: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
+0000caf0: 2274 6169 6c2d 2564 2d25 7322 2025 2028  "tail-%d-%s" % (
+0000cb00: 6e2c 2073 656c 662e 5f6e 616d 6529 0a20  n, self._name). 
+0000cb10: 2020 2020 2020 2064 736b 203d 207b 286e         dsk = {(n
+0000cb20: 616d 652c 2030 293a 2028 4d2e 7461 696c  ame, 0): (M.tail
+0000cb30: 2c20 2873 656c 662e 5f6e 616d 652c 2073  , (self._name, s
+0000cb40: 656c 662e 6e70 6172 7469 7469 6f6e 7320  elf.npartitions 
+0000cb50: 2d20 3129 2c20 6e29 7d0a 0a20 2020 2020  - 1), n)}..     
+0000cb60: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+0000cb70: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+0000cb80: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
+0000cb90: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
+0000cba0: 6573 3d5b 7365 6c66 5d29 0a20 2020 2020  es=[self]).     
+0000cbb0: 2020 2072 6573 756c 7420 3d20 6e65 775f     result = new_
+0000cbc0: 6464 5f6f 626a 6563 7428 6772 6170 682c  dd_object(graph,
+0000cbd0: 206e 616d 652c 2073 656c 662e 5f6d 6574   name, self._met
+0000cbe0: 612c 2073 656c 662e 6469 7669 7369 6f6e  a, self.division
+0000cbf0: 735b 2d32 3a5d 290a 0a20 2020 2020 2020  s[-2:])..       
+0000cc00: 2069 6620 636f 6d70 7574 653a 0a20 2020   if compute:.   
+0000cc10: 2020 2020 2020 2020 2072 6573 756c 7420           result 
+0000cc20: 3d20 7265 7375 6c74 2e63 6f6d 7075 7465  = result.compute
+0000cc30: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
+0000cc40: 6e20 7265 7375 6c74 0a0a 2020 2020 4070  n result..    @p
+0000cc50: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000cc60: 6c6f 6328 7365 6c66 293a 0a20 2020 2020  loc(self):.     
+0000cc70: 2020 2022 2222 5075 7265 6c79 206c 6162     """Purely lab
+0000cc80: 656c 2d6c 6f63 6174 696f 6e20 6261 7365  el-location base
+0000cc90: 6420 696e 6465 7865 7220 666f 7220 7365  d indexer for se
+0000cca0: 6c65 6374 696f 6e20 6279 206c 6162 656c  lection by label
+0000ccb0: 2e0a 0a20 2020 2020 2020 203e 3e3e 2064  ...        >>> d
+0000ccc0: 662e 6c6f 635b 2262 225d 2020 2320 646f  f.loc["b"]  # do
+0000ccd0: 6374 6573 743a 202b 534b 4950 0a20 2020  ctest: +SKIP.   
+0000cce0: 2020 2020 203e 3e3e 2064 662e 6c6f 635b       >>> df.loc[
+0000ccf0: 2262 223a 2264 225d 2020 2320 646f 6374  "b":"d"]  # doct
+0000cd00: 6573 743a 202b 534b 4950 0a20 2020 2020  est: +SKIP.     
+0000cd10: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+0000cd20: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
+0000cd30: 6d65 2e69 6e64 6578 696e 6720 696d 706f  me.indexing impo
+0000cd40: 7274 205f 4c6f 6349 6e64 6578 6572 0a0a  rt _LocIndexer..
+0000cd50: 2020 2020 2020 2020 7265 7475 726e 205f          return _
+0000cd60: 4c6f 6349 6e64 6578 6572 2873 656c 6629  LocIndexer(self)
+0000cd70: 0a0a 2020 2020 6465 6620 5f70 6172 7469  ..    def _parti
+0000cd80: 7469 6f6e 7328 7365 6c66 2c20 696e 6465  tions(self, inde
+0000cd90: 7829 3a0a 2020 2020 2020 2020 6966 206e  x):.        if n
+0000cda0: 6f74 2069 7369 6e73 7461 6e63 6528 696e  ot isinstance(in
+0000cdb0: 6465 782c 2074 7570 6c65 293a 0a20 2020  dex, tuple):.   
+0000cdc0: 2020 2020 2020 2020 2069 6e64 6578 203d           index =
+0000cdd0: 2028 696e 6465 782c 290a 2020 2020 2020   (index,).      
+0000cde0: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
+0000cdf0: 792e 736c 6963 696e 6720 696d 706f 7274  y.slicing import
+0000ce00: 206e 6f72 6d61 6c69 7a65 5f69 6e64 6578   normalize_index
+0000ce10: 0a0a 2020 2020 2020 2020 696e 6465 7820  ..        index 
+0000ce20: 3d20 6e6f 726d 616c 697a 655f 696e 6465  = normalize_inde
+0000ce30: 7828 696e 6465 782c 2028 7365 6c66 2e6e  x(index, (self.n
+0000ce40: 7061 7274 6974 696f 6e73 2c29 290a 2020  partitions,)).  
+0000ce50: 2020 2020 2020 696e 6465 7820 3d20 7475        index = tu
+0000ce60: 706c 6528 736c 6963 6528 6b2c 206b 202b  ple(slice(k, k +
+0000ce70: 2031 2920 6966 2069 7369 6e73 7461 6e63   1) if isinstanc
+0000ce80: 6528 6b2c 204e 756d 6265 7229 2065 6c73  e(k, Number) els
+0000ce90: 6520 6b20 666f 7220 6b20 696e 2069 6e64  e k for k in ind
+0000cea0: 6578 290a 2020 2020 2020 2020 6e61 6d65  ex).        name
+0000ceb0: 203d 2022 626c 6f63 6b73 2d22 202b 2074   = "blocks-" + t
+0000cec0: 6f6b 656e 697a 6528 7365 6c66 2c20 696e  okenize(self, in
+0000ced0: 6465 7829 0a20 2020 2020 2020 206e 6577  dex).        new
+0000cee0: 5f6b 6579 7320 3d20 6e70 2e61 7272 6179  _keys = np.array
+0000cef0: 2873 656c 662e 5f5f 6461 736b 5f6b 6579  (self.__dask_key
+0000cf00: 735f 5f28 292c 2064 7479 7065 3d6f 626a  s__(), dtype=obj
+0000cf10: 6563 7429 5b69 6e64 6578 5d2e 746f 6c69  ect)[index].toli
+0000cf20: 7374 2829 0a0a 2020 2020 2020 2020 6469  st()..        di
+0000cf30: 7669 7369 6f6e 7320 3d20 5b73 656c 662e  visions = [self.
+0000cf40: 6469 7669 7369 6f6e 735b 695d 2066 6f72  divisions[i] for
+0000cf50: 205f 2c20 6920 696e 206e 6577 5f6b 6579   _, i in new_key
+0000cf60: 735d 202b 205b 0a20 2020 2020 2020 2020  s] + [.         
+0000cf70: 2020 2073 656c 662e 6469 7669 7369 6f6e     self.division
+0000cf80: 735b 6e65 775f 6b65 7973 5b2d 315d 5b31  s[new_keys[-1][1
+0000cf90: 5d20 2b20 315d 0a20 2020 2020 2020 205d  ] + 1].        ]
+0000cfa0: 0a20 2020 2020 2020 2064 736b 203d 207b  .        dsk = {
+0000cfb0: 286e 616d 652c 2069 293a 2074 7570 6c65  (name, i): tuple
+0000cfc0: 286b 6579 2920 666f 7220 692c 206b 6579  (key) for i, key
+0000cfd0: 2069 6e20 656e 756d 6572 6174 6528 6e65   in enumerate(ne
+0000cfe0: 775f 6b65 7973 297d 0a0a 2020 2020 2020  w_keys)}..      
+0000cff0: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
+0000d000: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
+0000d010: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
+0000d020: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
+0000d030: 733d 5b73 656c 665d 290a 2020 2020 2020  s=[self]).      
+0000d040: 2020 7265 7475 726e 206e 6577 5f64 645f    return new_dd_
+0000d050: 6f62 6a65 6374 2867 7261 7068 2c20 6e61  object(graph, na
+0000d060: 6d65 2c20 7365 6c66 2e5f 6d65 7461 2c20  me, self._meta, 
+0000d070: 6469 7669 7369 6f6e 7329 0a0a 2020 2020  divisions)..    
+0000d080: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000d090: 6620 7061 7274 6974 696f 6e73 2873 656c  f partitions(sel
+0000d0a0: 6629 3a0a 2020 2020 2020 2020 2222 2253  f):.        """S
+0000d0b0: 6c69 6365 2064 6174 6166 7261 6d65 2062  lice dataframe b
+0000d0c0: 7920 7061 7274 6974 696f 6e73 0a0a 2020  y partitions..  
+0000d0d0: 2020 2020 2020 5468 6973 2061 6c6c 6f77        This allow
+0000d0e0: 7320 7061 7274 6974 696f 6e77 6973 6520  s partitionwise 
+0000d0f0: 736c 6963 696e 6720 6f66 2061 2044 6173  slicing of a Das
+0000d100: 6b20 4461 7461 6672 616d 652e 2020 596f  k Dataframe.  Yo
+0000d110: 7520 6361 6e20 7065 7266 6f72 6d20 6e6f  u can perform no
+0000d120: 726d 616c 0a20 2020 2020 2020 204e 756d  rmal.        Num
+0000d130: 7079 2d73 7479 6c65 2073 6c69 6369 6e67  py-style slicing
+0000d140: 2c20 6275 7420 6e6f 7720 7261 7468 6572  , but now rather
+0000d150: 2074 6861 6e20 736c 6963 6520 656c 656d   than slice elem
+0000d160: 656e 7473 206f 6620 7468 6520 6172 7261  ents of the arra
+0000d170: 7920 796f 750a 2020 2020 2020 2020 736c  y you.        sl
+0000d180: 6963 6520 616c 6f6e 6720 7061 7274 6974  ice along partit
+0000d190: 696f 6e73 2073 6f2c 2066 6f72 2065 7861  ions so, for exa
+0000d1a0: 6d70 6c65 2c20 6060 6466 2e70 6172 7469  mple, ``df.parti
+0000d1b0: 7469 6f6e 735b 3a35 5d60 6020 7072 6f64  tions[:5]`` prod
+0000d1c0: 7563 6573 2061 206e 6577 0a20 2020 2020  uces a new.     
+0000d1d0: 2020 2044 6173 6b20 4461 7461 6672 616d     Dask Datafram
+0000d1e0: 6520 6f66 2074 6865 2066 6972 7374 2066  e of the first f
+0000d1f0: 6976 6520 7061 7274 6974 696f 6e73 2e20  ive partitions. 
+0000d200: 5661 6c69 6420 696e 6465 7865 7273 2061  Valid indexers a
+0000d210: 7265 2069 6e74 6567 6572 732c 2073 6571  re integers, seq
+0000d220: 7565 6e63 6573 0a20 2020 2020 2020 206f  uences.        o
+0000d230: 6620 696e 7465 6765 7273 2c20 736c 6963  f integers, slic
+0000d240: 6573 2c20 6f72 2062 6f6f 6c65 616e 206d  es, or boolean m
+0000d250: 6173 6b73 2e0a 0a20 2020 2020 2020 2045  asks...        E
+0000d260: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
+0000d270: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0000d280: 203e 3e3e 2064 662e 7061 7274 6974 696f   >>> df.partitio
+0000d290: 6e73 5b30 5d20 2023 2064 6f63 7465 7374  ns[0]  # doctest
+0000d2a0: 3a20 2b53 4b49 500a 2020 2020 2020 2020  : +SKIP.        
+0000d2b0: 3e3e 3e20 6466 2e70 6172 7469 7469 6f6e  >>> df.partition
+0000d2c0: 735b 3a33 5d20 2023 2064 6f63 7465 7374  s[:3]  # doctest
+0000d2d0: 3a20 2b53 4b49 500a 2020 2020 2020 2020  : +SKIP.        
+0000d2e0: 3e3e 3e20 6466 2e70 6172 7469 7469 6f6e  >>> df.partition
+0000d2f0: 735b 3a3a 3130 5d20 2023 2064 6f63 7465  s[::10]  # docte
+0000d300: 7374 3a20 2b53 4b49 500a 0a20 2020 2020  st: +SKIP..     
+0000d310: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
+0000d320: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+0000d330: 2020 2041 2044 6173 6b20 4461 7461 4672     A Dask DataFr
+0000d340: 616d 650a 2020 2020 2020 2020 2222 220a  ame.        """.
+0000d350: 2020 2020 2020 2020 7265 7475 726e 2049          return I
+0000d360: 6e64 6578 4361 6c6c 6162 6c65 2873 656c  ndexCallable(sel
+0000d370: 662e 5f70 6172 7469 7469 6f6e 7329 0a0a  f._partitions)..
+0000d380: 2020 2020 2320 4e6f 7465 3a20 696c 6f63      # Note: iloc
+0000d390: 2069 7320 696d 706c 656d 656e 7465 6420   is implemented 
+0000d3a0: 6f6e 6c79 206f 6e20 4461 7461 4672 616d  only on DataFram
+0000d3b0: 650a 0a20 2020 2064 6566 2072 6570 6172  e..    def repar
+0000d3c0: 7469 7469 6f6e 280a 2020 2020 2020 2020  tition(.        
+0000d3d0: 7365 6c66 2c0a 2020 2020 2020 2020 6469  self,.        di
+0000d3e0: 7669 7369 6f6e 733d 4e6f 6e65 2c0a 2020  visions=None,.  
+0000d3f0: 2020 2020 2020 6e70 6172 7469 7469 6f6e        npartition
+0000d400: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
+0000d410: 7061 7274 6974 696f 6e5f 7369 7a65 3d4e  partition_size=N
+0000d420: 6f6e 652c 0a20 2020 2020 2020 2066 7265  one,.        fre
+0000d430: 713d 4e6f 6e65 2c0a 2020 2020 2020 2020  q=None,.        
+0000d440: 666f 7263 653d 4661 6c73 652c 0a20 2020  force=False,.   
+0000d450: 2029 3a0a 2020 2020 2020 2020 2222 2252   ):.        """R
+0000d460: 6570 6172 7469 7469 6f6e 2064 6174 6166  epartition dataf
+0000d470: 7261 6d65 2061 6c6f 6e67 206e 6577 2064  rame along new d
+0000d480: 6976 6973 696f 6e73 0a0a 2020 2020 2020  ivisions..      
+0000d490: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0000d4a0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+0000d4b0: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
+0000d4c0: 7320 3a20 6c69 7374 2c20 6f70 7469 6f6e  s : list, option
+0000d4d0: 616c 0a20 2020 2020 2020 2020 2020 2054  al.            T
+0000d4e0: 6865 2022 6469 7669 6469 6e67 206c 696e  he "dividing lin
+0000d4f0: 6573 2220 7573 6564 2074 6f20 7370 6c69  es" used to spli
+0000d500: 7420 7468 6520 6461 7461 6672 616d 6520  t the dataframe 
+0000d510: 696e 746f 2070 6172 7469 7469 6f6e 732e  into partitions.
+0000d520: 0a20 2020 2020 2020 2020 2020 2046 6f72  .            For
+0000d530: 2060 6064 6976 6973 696f 6e73 3d5b 302c   ``divisions=[0,
+0000d540: 2031 302c 2035 302c 2031 3030 5d60 602c   10, 50, 100]``,
+0000d550: 2074 6865 7265 2077 6f75 6c64 2062 6520   there would be 
+0000d560: 7468 7265 6520 6f75 7470 7574 2070 6172  three output par
+0000d570: 7469 7469 6f6e 732c 0a20 2020 2020 2020  titions,.       
+0000d580: 2020 2020 2077 6865 7265 2074 6865 206e       where the n
+0000d590: 6577 2069 6e64 6578 2063 6f6e 7461 696e  ew index contain
+0000d5a0: 6564 205b 302c 2031 3029 2c20 5b31 302c  ed [0, 10), [10,
+0000d5b0: 2035 3029 2c20 616e 6420 5b35 302c 2031   50), and [50, 1
+0000d5c0: 3030 292c 2072 6573 7065 6374 6976 656c  00), respectivel
+0000d5d0: 792e 0a20 2020 2020 2020 2020 2020 2053  y..            S
+0000d5e0: 6565 2068 7474 7073 3a2f 2f64 6f63 732e  ee https://docs.
+0000d5f0: 6461 736b 2e6f 7267 2f65 6e2f 6c61 7465  dask.org/en/late
+0000d600: 7374 2f64 6174 6166 7261 6d65 2d64 6573  st/dataframe-des
+0000d610: 6967 6e2e 6874 6d6c 2370 6172 7469 7469  ign.html#partiti
+0000d620: 6f6e 732e 0a20 2020 2020 2020 2020 2020  ons..           
+0000d630: 204f 6e6c 7920 7573 6564 2069 6620 6e70   Only used if np
+0000d640: 6172 7469 7469 6f6e 7320 616e 6420 7061  artitions and pa
+0000d650: 7274 6974 696f 6e5f 7369 7a65 2069 736e  rtition_size isn
+0000d660: 2774 2073 7065 6369 6669 6564 2e0a 2020  't specified..  
+0000d670: 2020 2020 2020 2020 2020 466f 7220 636f            For co
+0000d680: 6e76 656e 6965 6e63 6520 6966 2067 6976  nvenience if giv
+0000d690: 656e 2061 6e20 696e 7465 6765 7220 7468  en an integer th
+0000d6a0: 6973 2077 696c 6c20 6465 6665 7220 746f  is will defer to
+0000d6b0: 206e 7061 7274 6974 696f 6e73 0a20 2020   npartitions.   
+0000d6c0: 2020 2020 2020 2020 2061 6e64 2069 6620           and if 
+0000d6d0: 6769 7665 6e20 6120 7374 7269 6e67 2069  given a string i
+0000d6e0: 7420 7769 6c6c 2064 6566 6572 2074 6f20  t will defer to 
+0000d6f0: 7061 7274 6974 696f 6e5f 7369 7a65 2028  partition_size (
+0000d700: 7365 6520 6265 6c6f 7729 0a20 2020 2020  see below).     
+0000d710: 2020 206e 7061 7274 6974 696f 6e73 203a     npartitions :
+0000d720: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
+0000d730: 2020 2020 2020 2020 2020 2041 7070 726f             Appro
+0000d740: 7869 6d61 7465 206e 756d 6265 7220 6f66  ximate number of
+0000d750: 2070 6172 7469 7469 6f6e 7320 6f66 206f   partitions of o
+0000d760: 7574 7075 742e 204f 6e6c 7920 7573 6564  utput. Only used
+0000d770: 2069 6620 7061 7274 6974 696f 6e5f 7369   if partition_si
+0000d780: 7a65 0a20 2020 2020 2020 2020 2020 2069  ze.            i
+0000d790: 736e 2774 2073 7065 6369 6669 6564 2e20  sn't specified. 
+0000d7a0: 5468 6520 6e75 6d62 6572 206f 6620 7061  The number of pa
+0000d7b0: 7274 6974 696f 6e73 2075 7365 6420 6d61  rtitions used ma
+0000d7c0: 7920 6265 2073 6c69 6768 746c 790a 2020  y be slightly.  
+0000d7d0: 2020 2020 2020 2020 2020 6c6f 7765 7220            lower 
+0000d7e0: 7468 616e 206e 7061 7274 6974 696f 6e73  than npartitions
+0000d7f0: 2064 6570 656e 6469 6e67 206f 6e20 6461   depending on da
+0000d800: 7461 2064 6973 7472 6962 7574 696f 6e2c  ta distribution,
+0000d810: 2062 7574 2077 696c 6c20 6e65 7665 7220   but will never 
+0000d820: 6265 0a20 2020 2020 2020 2020 2020 2068  be.            h
+0000d830: 6967 6865 722e 0a20 2020 2020 2020 2070  igher..        p
+0000d840: 6172 7469 7469 6f6e 5f73 697a 653a 2069  artition_size: i
+0000d850: 6e74 206f 7220 7374 7269 6e67 2c20 6f70  nt or string, op
+0000d860: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+0000d870: 2020 204d 6178 206e 756d 6265 7220 6f66     Max number of
+0000d880: 2062 7974 6573 206f 6620 6d65 6d6f 7279   bytes of memory
+0000d890: 2066 6f72 2065 6163 6820 7061 7274 6974   for each partit
+0000d8a0: 696f 6e2e 2055 7365 206e 756d 6265 7273  ion. Use numbers
+0000d8b0: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
+0000d8c0: 7374 7269 6e67 7320 6c69 6b65 2035 4d42  strings like 5MB
+0000d8d0: 2e20 4966 2073 7065 6369 6669 6564 206e  . If specified n
+0000d8e0: 7061 7274 6974 696f 6e73 2061 6e64 2064  partitions and d
+0000d8f0: 6976 6973 696f 6e73 2077 696c 6c20 6265  ivisions will be
+0000d900: 0a20 2020 2020 2020 2020 2020 2069 676e  .            ign
+0000d910: 6f72 6564 2e20 4e6f 7465 2074 6861 7420  ored. Note that 
+0000d920: 7468 6520 7369 7a65 2072 6566 6c65 6374  the size reflect
+0000d930: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
+0000d940: 6279 7465 7320 7573 6564 2061 730a 2020  bytes used as.  
+0000d950: 2020 2020 2020 2020 2020 636f 6d70 7574            comput
+0000d960: 6564 2062 7920 6060 7061 6e64 6173 2e44  ed by ``pandas.D
+0000d970: 6174 6146 7261 6d65 2e6d 656d 6f72 795f  ataFrame.memory_
+0000d980: 7573 6167 6560 602c 2077 6869 6368 2077  usage``, which w
+0000d990: 696c 6c20 6e6f 740a 2020 2020 2020 2020  ill not.        
+0000d9a0: 2020 2020 6e65 6365 7373 6172 696c 7920      necessarily 
+0000d9b0: 6d61 7463 6820 7468 6520 7369 7a65 2077  match the size w
+0000d9c0: 6865 6e20 7374 6f72 696e 6720 746f 2064  hen storing to d
+0000d9d0: 6973 6b2e 0a0a 2020 2020 2020 2020 2020  isk...          
+0000d9e0: 2020 2e2e 2077 6172 6e69 6e67 3a3a 0a0a    .. warning::..
+0000d9f0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+0000da00: 6869 7320 6b65 7977 6f72 6420 6172 6775  his keyword argu
+0000da10: 6d65 6e74 2074 7269 6767 6572 7320 636f  ment triggers co
+0000da20: 6d70 7574 6174 696f 6e20 746f 2064 6574  mputation to det
+0000da30: 6572 6d69 6e65 0a20 2020 2020 2020 2020  ermine.         
+0000da40: 2020 2020 2020 7468 6520 6d65 6d6f 7279        the memory
+0000da50: 2073 697a 6520 6f66 2065 6163 6820 7061   size of each pa
+0000da60: 7274 6974 696f 6e2c 2077 6869 6368 206d  rtition, which m
+0000da70: 6179 2062 6520 6578 7065 6e73 6976 652e  ay be expensive.
+0000da80: 0a0a 2020 2020 2020 2020 6672 6571 203a  ..        freq :
+0000da90: 2073 7472 2c20 7064 2e54 696d 6564 656c   str, pd.Timedel
+0000daa0: 7461 0a20 2020 2020 2020 2020 2020 2041  ta.            A
+0000dab0: 2070 6572 696f 6420 6f6e 2077 6869 6368   period on which
+0000dac0: 2074 6f20 7061 7274 6974 696f 6e20 7469   to partition ti
+0000dad0: 6d65 7365 7269 6573 2064 6174 6120 6c69  meseries data li
+0000dae0: 6b65 2060 6027 3744 2760 6020 6f72 0a20  ke ``'7D'`` or. 
+0000daf0: 2020 2020 2020 2020 2020 2060 6027 3132             ``'12
+0000db00: 6827 6060 206f 7220 6060 7064 2e54 696d  h'`` or ``pd.Tim
+0000db10: 6564 656c 7461 2868 6f75 7273 3d31 3229  edelta(hours=12)
+0000db20: 6060 2e20 2041 7373 756d 6573 2061 2064  ``.  Assumes a d
+0000db30: 6174 6574 696d 6520 696e 6465 782e 0a20  atetime index.. 
+0000db40: 2020 2020 2020 2066 6f72 6365 203a 2062         force : b
+0000db50: 6f6f 6c2c 2064 6566 6175 6c74 2046 616c  ool, default Fal
+0000db60: 7365 0a20 2020 2020 2020 2020 2020 2041  se.            A
+0000db70: 6c6c 6f77 7320 7468 6520 6578 7061 6e73  llows the expans
+0000db80: 696f 6e20 6f66 2074 6865 2065 7869 7374  ion of the exist
+0000db90: 696e 6720 6469 7669 7369 6f6e 732e 0a20  ing divisions.. 
+0000dba0: 2020 2020 2020 2020 2020 2049 6620 4661             If Fa
+0000dbb0: 6c73 6520 7468 656e 2074 6865 206e 6577  lse then the new
+0000dbc0: 2064 6976 6973 696f 6e73 2720 6c6f 7765   divisions' lowe
+0000dbd0: 7220 616e 6420 7570 7065 7220 626f 756e  r and upper boun
+0000dbe0: 6473 206d 7573 7420 6265 0a20 2020 2020  ds must be.     
+0000dbf0: 2020 2020 2020 2074 6865 2073 616d 6520         the same 
+0000dc00: 6173 2074 6865 206f 6c64 2064 6976 6973  as the old divis
+0000dc10: 696f 6e73 272e 0a0a 2020 2020 2020 2020  ions'...        
+0000dc20: 4e6f 7465 730a 2020 2020 2020 2020 2d2d  Notes.        --
+0000dc30: 2d2d 2d0a 2020 2020 2020 2020 4578 6163  ---.        Exac
+0000dc40: 746c 7920 6f6e 6520 6f66 2060 6469 7669  tly one of `divi
+0000dc50: 7369 6f6e 7360 2c20 606e 7061 7274 6974  sions`, `npartit
+0000dc60: 696f 6e73 602c 2060 7061 7274 6974 696f  ions`, `partitio
+0000dc70: 6e5f 7369 7a65 602c 206f 7220 6066 7265  n_size`, or `fre
+0000dc80: 7160 0a20 2020 2020 2020 2073 686f 756c  q`.        shoul
+0000dc90: 6420 6265 2073 7065 6369 6669 6564 2e20  d be specified. 
+0000dca0: 4120 6060 5661 6c75 6545 7272 6f72 6060  A ``ValueError``
+0000dcb0: 2077 696c 6c20 6265 2072 6169 7365 6420   will be raised 
+0000dcc0: 7768 656e 2074 6861 7420 6973 0a20 2020  when that is.   
+0000dcd0: 2020 2020 206e 6f74 2074 6865 2063 6173       not the cas
+0000dce0: 652e 0a0a 2020 2020 2020 2020 416c 736f  e...        Also
+0000dcf0: 206e 6f74 6520 7468 6174 2060 606c 656e   note that ``len
+0000dd00: 2864 6976 6973 6f6e 7329 6060 2069 7320  (divisons)`` is 
+0000dd10: 6571 7561 6c20 746f 2060 606e 7061 7274  equal to ``npart
+0000dd20: 6974 696f 6e73 202b 2031 6060 2e20 5468  itions + 1``. Th
+0000dd30: 6973 2069 7320 6265 6361 7573 6520 6060  is is because ``
+0000dd40: 6469 7669 7369 6f6e 7360 600a 2020 2020  divisions``.    
+0000dd50: 2020 2020 7265 7072 6573 656e 7473 2074      represents t
+0000dd60: 6865 2075 7070 6572 2061 6e64 206c 6f77  he upper and low
+0000dd70: 6572 2062 6f75 6e64 7320 6f66 2065 6163  er bounds of eac
+0000dd80: 6820 7061 7274 6974 696f 6e2e 2054 6865  h partition. The
+0000dd90: 2066 6972 7374 2069 7465 6d20 6973 2074   first item is t
+0000dda0: 6865 0a20 2020 2020 2020 206c 6f77 6572  he.        lower
+0000ddb0: 2062 6f75 6e64 206f 6620 7468 6520 6669   bound of the fi
+0000ddc0: 7273 7420 7061 7274 6974 696f 6e2c 2074  rst partition, t
+0000ddd0: 6865 2073 6563 6f6e 6420 6974 656d 2069  he second item i
+0000dde0: 7320 7468 6520 6c6f 7765 7220 626f 756e  s the lower boun
+0000ddf0: 6420 6f66 2074 6865 0a20 2020 2020 2020  d of the.       
+0000de00: 2073 6563 6f6e 6420 7061 7274 6974 696f   second partitio
+0000de10: 6e20 616e 6420 7468 6520 7570 7065 7220  n and the upper 
+0000de20: 626f 756e 6420 6f66 2074 6865 2066 6972  bound of the fir
+0000de30: 7374 2070 6172 7469 7469 6f6e 2c20 616e  st partition, an
+0000de40: 6420 736f 206f 6e2e 0a20 2020 2020 2020  d so on..       
+0000de50: 2054 6865 2073 6563 6f6e 642d 746f 2d6c   The second-to-l
+0000de60: 6173 7420 6974 656d 2069 7320 7468 6520  ast item is the 
+0000de70: 6c6f 7765 7220 626f 756e 6420 6f66 2074  lower bound of t
+0000de80: 6865 206c 6173 7420 7061 7274 6974 696f  he last partitio
+0000de90: 6e2c 2061 6e64 2074 6865 206c 6173 740a  n, and the last.
+0000dea0: 2020 2020 2020 2020 2865 7874 7261 2920          (extra) 
+0000deb0: 6974 656d 2069 7320 7468 6520 7570 7065  item is the uppe
+0000dec0: 7220 626f 756e 6420 6f66 2074 6865 206c  r bound of the l
+0000ded0: 6173 7420 7061 7274 6974 696f 6e2e 0a0a  ast partition...
+0000dee0: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+0000def0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000df00: 2d0a 2020 2020 2020 2020 3e3e 3e20 6466  -.        >>> df
+0000df10: 203d 2064 662e 7265 7061 7274 6974 696f   = df.repartitio
+0000df20: 6e28 6e70 6172 7469 7469 6f6e 733d 3130  n(npartitions=10
+0000df30: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
+0000df40: 4b49 500a 2020 2020 2020 2020 3e3e 3e20  KIP.        >>> 
+0000df50: 6466 203d 2064 662e 7265 7061 7274 6974  df = df.repartit
+0000df60: 696f 6e28 6469 7669 7369 6f6e 733d 5b30  ion(divisions=[0
+0000df70: 2c20 352c 2031 302c 2032 305d 2920 2023  , 5, 10, 20])  #
+0000df80: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
+0000df90: 2020 2020 2020 2020 3e3e 3e20 6466 203d          >>> df =
+0000dfa0: 2064 662e 7265 7061 7274 6974 696f 6e28   df.repartition(
+0000dfb0: 6672 6571 3d27 3764 2729 2020 2320 646f  freq='7d')  # do
+0000dfc0: 6374 6573 743a 202b 534b 4950 0a0a 2020  ctest: +SKIP..  
+0000dfd0: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
+0000dfe0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
+0000dff0: 2020 2020 2020 2020 4461 7461 4672 616d          DataFram
+0000e000: 652e 6d65 6d6f 7279 5f75 7361 6765 5f70  e.memory_usage_p
+0000e010: 6572 5f70 6172 7469 7469 6f6e 0a20 2020  er_partition.   
+0000e020: 2020 2020 2070 616e 6461 732e 4461 7461       pandas.Data
+0000e030: 4672 616d 652e 6d65 6d6f 7279 5f75 7361  Frame.memory_usa
+0000e040: 6765 0a20 2020 2020 2020 2022 2222 0a20  ge.        """. 
+0000e050: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0000e060: 616e 6365 2864 6976 6973 696f 6e73 2c20  ance(divisions, 
+0000e070: 696e 7429 3a0a 2020 2020 2020 2020 2020  int):.          
+0000e080: 2020 6e70 6172 7469 7469 6f6e 7320 3d20    npartitions = 
+0000e090: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
+0000e0a0: 2020 2020 2020 6469 7669 7369 6f6e 7320        divisions 
+0000e0b0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2069  = None.        i
+0000e0c0: 6620 6973 696e 7374 616e 6365 2864 6976  f isinstance(div
+0000e0d0: 6973 696f 6e73 2c20 7374 7229 3a0a 2020  isions, str):.  
+0000e0e0: 2020 2020 2020 2020 2020 7061 7274 6974            partit
+0000e0f0: 696f 6e5f 7369 7a65 203d 2064 6976 6973  ion_size = divis
+0000e100: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
+0000e110: 2064 6976 6973 696f 6e73 203d 204e 6f6e   divisions = Non
+0000e120: 650a 2020 2020 2020 2020 6966 2028 0a20  e.        if (. 
+0000e130: 2020 2020 2020 2020 2020 2073 756d 280a             sum(.
+0000e140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e150: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+0000e160: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
+0000e170: 7369 7a65 2069 7320 6e6f 7420 4e6f 6e65  size is not None
+0000e180: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000e190: 2020 2020 2020 6469 7669 7369 6f6e 7320        divisions 
+0000e1a0: 6973 206e 6f74 204e 6f6e 652c 0a20 2020  is not None,.   
+0000e1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e1c0: 206e 7061 7274 6974 696f 6e73 2069 7320   npartitions is 
+0000e1d0: 6e6f 7420 4e6f 6e65 2c0a 2020 2020 2020  not None,.      
+0000e1e0: 2020 2020 2020 2020 2020 2020 2020 6672                fr
+0000e1f0: 6571 2069 7320 6e6f 7420 4e6f 6e65 2c0a  eq is not None,.
+0000e200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e210: 5d0a 2020 2020 2020 2020 2020 2020 290a  ].            ).
+0000e220: 2020 2020 2020 2020 2020 2020 213d 2031              != 1
+0000e230: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
+0000e240: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0000e250: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+0000e260: 2020 2020 2020 2020 2020 2250 6c65 6173            "Pleas
+0000e270: 6520 7072 6f76 6964 6520 6578 6163 746c  e provide exactl
+0000e280: 7920 6f6e 6520 6f66 2060 606e 7061 7274  y one of ``npart
+0000e290: 6974 696f 6e73 3d60 602c 2060 6066 7265  itions=``, ``fre
+0000e2a0: 713d 6060 2c20 220a 2020 2020 2020 2020  q=``, ".        
+0000e2b0: 2020 2020 2020 2020 2260 6064 6976 6973          "``divis
+0000e2c0: 696f 6e73 3d60 602c 2060 6070 6172 7469  ions=``, ``parti
+0000e2d0: 7469 6f6e 5f73 697a 653d 6060 206b 6579  tion_size=`` key
+0000e2e0: 776f 7264 2061 7267 756d 656e 7473 220a  word arguments".
+0000e2f0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0000e300: 2020 2020 2020 2069 6620 7061 7274 6974         if partit
+0000e310: 696f 6e5f 7369 7a65 2069 7320 6e6f 7420  ion_size is not 
+0000e320: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000e330: 2020 7265 7475 726e 2072 6570 6172 7469    return reparti
+0000e340: 7469 6f6e 5f73 697a 6528 7365 6c66 2c20  tion_size(self, 
+0000e350: 7061 7274 6974 696f 6e5f 7369 7a65 290a  partition_size).
+0000e360: 2020 2020 2020 2020 656c 6966 206e 7061          elif npa
+0000e370: 7274 6974 696f 6e73 2069 7320 6e6f 7420  rtitions is not 
+0000e380: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000e390: 2020 7265 7475 726e 2072 6570 6172 7469    return reparti
+0000e3a0: 7469 6f6e 5f6e 7061 7274 6974 696f 6e73  tion_npartitions
+0000e3b0: 2873 656c 662c 206e 7061 7274 6974 696f  (self, npartitio
+0000e3c0: 6e73 290a 2020 2020 2020 2020 656c 6966  ns).        elif
+0000e3d0: 2064 6976 6973 696f 6e73 2069 7320 6e6f   divisions is no
+0000e3e0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0000e3f0: 2020 2020 7265 7475 726e 2072 6570 6172      return repar
+0000e400: 7469 7469 6f6e 2873 656c 662c 2064 6976  tition(self, div
+0000e410: 6973 696f 6e73 2c20 666f 7263 653d 666f  isions, force=fo
+0000e420: 7263 6529 0a20 2020 2020 2020 2065 6c69  rce).        eli
+0000e430: 6620 6672 6571 2069 7320 6e6f 7420 4e6f  f freq is not No
+0000e440: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000e450: 7265 7475 726e 2072 6570 6172 7469 7469  return repartiti
+0000e460: 6f6e 5f66 7265 7128 7365 6c66 2c20 6672  on_freq(self, fr
+0000e470: 6571 3d66 7265 7129 0a0a 2020 2020 6465  eq=freq)..    de
+0000e480: 6620 7368 7566 666c 6528 0a20 2020 2020  f shuffle(.     
+0000e490: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0000e4a0: 206f 6e2c 0a20 2020 2020 2020 206e 7061   on,.        npa
+0000e4b0: 7274 6974 696f 6e73 3d4e 6f6e 652c 0a20  rtitions=None,. 
+0000e4c0: 2020 2020 2020 206d 6178 5f62 7261 6e63         max_branc
+0000e4d0: 683d 4e6f 6e65 2c0a 2020 2020 2020 2020  h=None,.        
+0000e4e0: 7368 7566 666c 653d 4e6f 6e65 2c0a 2020  shuffle=None,.  
+0000e4f0: 2020 2020 2020 6967 6e6f 7265 5f69 6e64        ignore_ind
+0000e500: 6578 3d46 616c 7365 2c0a 2020 2020 2020  ex=False,.      
+0000e510: 2020 636f 6d70 7574 653d 4e6f 6e65 2c0a    compute=None,.
+0000e520: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+0000e530: 2222 5265 6172 7261 6e67 6520 4461 7461  ""Rearrange Data
+0000e540: 4672 616d 6520 696e 746f 206e 6577 2070  Frame into new p
+0000e550: 6172 7469 7469 6f6e 730a 0a20 2020 2020  artitions..     
+0000e560: 2020 2055 7365 7320 6861 7368 696e 6720     Uses hashing 
+0000e570: 6f66 2060 6f6e 6020 746f 206d 6170 2072  of `on` to map r
+0000e580: 6f77 7320 746f 206f 7574 7075 7420 7061  ows to output pa
+0000e590: 7274 6974 696f 6e73 2e20 4166 7465 7220  rtitions. After 
+0000e5a0: 7468 6973 0a20 2020 2020 2020 206f 7065  this.        ope
+0000e5b0: 7261 7469 6f6e 2c20 726f 7773 2077 6974  ration, rows wit
+0000e5c0: 6820 7468 6520 7361 6d65 2076 616c 7565  h the same value
+0000e5d0: 206f 6620 606f 6e60 2077 696c 6c20 6265   of `on` will be
+0000e5e0: 2069 6e20 7468 6520 7361 6d65 0a20 2020   in the same.   
+0000e5f0: 2020 2020 2070 6172 7469 7469 6f6e 2e0a       partition..
+0000e600: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0000e610: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+0000e620: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206f  ------.        o
+0000e630: 6e20 3a20 7374 722c 206c 6973 7420 6f66  n : str, list of
+0000e640: 2073 7472 2c20 6f72 2053 6572 6965 732c   str, or Series,
+0000e650: 2049 6e64 6578 2c20 6f72 2044 6174 6146   Index, or DataF
+0000e660: 7261 6d65 0a20 2020 2020 2020 2020 2020  rame.           
+0000e670: 2043 6f6c 756d 6e28 7329 206f 7220 696e   Column(s) or in
+0000e680: 6465 7820 746f 2062 6520 7573 6564 2074  dex to be used t
+0000e690: 6f20 6d61 7020 726f 7773 2074 6f20 6f75  o map rows to ou
+0000e6a0: 7470 7574 2070 6172 7469 7469 6f6e 730a  tput partitions.
+0000e6b0: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
+0000e6c0: 6f6e 7320 3a20 696e 742c 206f 7074 696f  ons : int, optio
+0000e6d0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+0000e6e0: 4e75 6d62 6572 206f 6620 7061 7274 6974  Number of partit
+0000e6f0: 696f 6e73 206f 6620 6f75 7470 7574 2e20  ions of output. 
+0000e700: 5061 7274 6974 696f 6e20 636f 756e 7420  Partition count 
+0000e710: 7769 6c6c 206e 6f74 2062 650a 2020 2020  will not be.    
+0000e720: 2020 2020 2020 2020 6368 616e 6765 6420          changed 
+0000e730: 6279 2064 6566 6175 6c74 2e0a 2020 2020  by default..    
+0000e740: 2020 2020 6d61 785f 6272 616e 6368 3a20      max_branch: 
+0000e750: 696e 742c 206f 7074 696f 6e61 6c0a 2020  int, optional.  
+0000e760: 2020 2020 2020 2020 2020 5468 6520 6d61            The ma
+0000e770: 7869 6d75 6d20 6e75 6d62 6572 206f 6620  ximum number of 
+0000e780: 7370 6c69 7473 2070 6572 2069 6e70 7574  splits per input
+0000e790: 2070 6172 7469 7469 6f6e 2e20 5573 6564   partition. Used
+0000e7a0: 2077 6974 6869 6e0a 2020 2020 2020 2020   within.        
+0000e7b0: 2020 2020 7468 6520 7374 6167 6564 2073      the staged s
+0000e7c0: 6875 6666 6c69 6e67 2061 6c67 6f72 6974  huffling algorit
+0000e7d0: 686d 2e0a 2020 2020 2020 2020 7368 7566  hm..        shuf
+0000e7e0: 666c 653a 207b 2764 6973 6b27 2c20 2774  fle: {'disk', 't
+0000e7f0: 6173 6b73 277d 2c20 6f70 7469 6f6e 616c  asks'}, optional
+0000e800: 0a20 2020 2020 2020 2020 2020 2045 6974  .            Eit
+0000e810: 6865 7220 6060 2764 6973 6b27 6060 2066  her ``'disk'`` f
+0000e820: 6f72 2073 696e 676c 652d 6e6f 6465 206f  or single-node o
+0000e830: 7065 7261 7469 6f6e 206f 7220 6060 2774  peration or ``'t
+0000e840: 6173 6b73 2760 6020 666f 720a 2020 2020  asks'`` for.    
+0000e850: 2020 2020 2020 2020 6469 7374 7269 6275          distribu
+0000e860: 7465 6420 6f70 6572 6174 696f 6e2e 2020  ted operation.  
+0000e870: 5769 6c6c 2062 6520 696e 6665 7272 6564  Will be inferred
+0000e880: 2062 7920 796f 7572 2063 7572 7265 6e74   by your current
+0000e890: 2073 6368 6564 756c 6572 2e0a 2020 2020   scheduler..    
+0000e8a0: 2020 2020 6967 6e6f 7265 5f69 6e64 6578      ignore_index
+0000e8b0: 3a20 626f 6f6c 2c20 6465 6661 756c 7420  : bool, default 
+0000e8c0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+0000e8d0: 2020 4967 6e6f 7265 2069 6e64 6578 2064    Ignore index d
+0000e8e0: 7572 696e 6720 7368 7566 666c 652e 2020  uring shuffle.  
+0000e8f0: 4966 2060 6054 7275 6560 602c 2070 6572  If ``True``, per
+0000e900: 666f 726d 616e 6365 206d 6179 2069 6d70  formance may imp
+0000e910: 726f 7665 2c0a 2020 2020 2020 2020 2020  rove,.          
+0000e920: 2020 6275 7420 696e 6465 7820 7661 6c75    but index valu
+0000e930: 6573 2077 696c 6c20 6e6f 7420 6265 2070  es will not be p
+0000e940: 7265 7365 7276 6564 2e0a 2020 2020 2020  reserved..      
+0000e950: 2020 636f 6d70 7574 653a 2062 6f6f 6c0a    compute: bool.
+0000e960: 2020 2020 2020 2020 2020 2020 5768 6574              Whet
+0000e970: 6865 7220 6f72 206e 6f74 2074 6f20 7472  her or not to tr
+0000e980: 6967 6765 7220 616e 2069 6d6d 6564 6961  igger an immedia
+0000e990: 7465 2063 6f6d 7075 7461 7469 6f6e 2e20  te computation. 
+0000e9a0: 4465 6661 756c 7473 2074 6f20 4661 6c73  Defaults to Fals
+0000e9b0: 652e 0a0a 2020 2020 2020 2020 4e6f 7465  e...        Note
+0000e9c0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d0a  s.        -----.
+0000e9d0: 2020 2020 2020 2020 5468 6973 2064 6f65          This doe
+0000e9e0: 7320 6e6f 7420 7072 6573 6572 7665 2061  s not preserve a
+0000e9f0: 206d 6561 6e69 6e67 6675 6c20 696e 6465   meaningful inde
+0000ea00: 782f 7061 7274 6974 696f 6e69 6e67 2073  x/partitioning s
+0000ea10: 6368 656d 652e 2054 6869 730a 2020 2020  cheme. This.    
+0000ea20: 2020 2020 6973 206e 6f74 2064 6574 6572      is not deter
+0000ea30: 6d69 6e69 7374 6963 2069 6620 646f 6e65  ministic if done
+0000ea40: 2069 6e20 7061 7261 6c6c 656c 2e0a 0a20   in parallel... 
+0000ea50: 2020 2020 2020 2045 7861 6d70 6c65 730a         Examples.
+0000ea60: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000ea70: 0a20 2020 2020 2020 203e 3e3e 2064 6620  .        >>> df 
+0000ea80: 3d20 6466 2e73 6875 6666 6c65 2864 662e  = df.shuffle(df.
+0000ea90: 636f 6c75 6d6e 735b 305d 2920 2023 2064  columns[0])  # d
+0000eaa0: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
+0000eab0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000eac0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
+0000ead0: 6672 616d 652e 7368 7566 666c 6520 696d  frame.shuffle im
+0000eae0: 706f 7274 2073 6875 6666 6c65 2061 7320  port shuffle as 
+0000eaf0: 6464 5f73 6875 6666 6c65 0a0a 2020 2020  dd_shuffle..    
+0000eb00: 2020 2020 7265 7475 726e 2064 645f 7368      return dd_sh
+0000eb10: 7566 666c 6528 0a20 2020 2020 2020 2020  uffle(.         
+0000eb20: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0000eb30: 2020 2020 206f 6e2c 0a20 2020 2020 2020       on,.       
+0000eb40: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
+0000eb50: 3d6e 7061 7274 6974 696f 6e73 2c0a 2020  =npartitions,.  
+0000eb60: 2020 2020 2020 2020 2020 6d61 785f 6272            max_br
+0000eb70: 616e 6368 3d6d 6178 5f62 7261 6e63 682c  anch=max_branch,
+0000eb80: 0a20 2020 2020 2020 2020 2020 2073 6875  .            shu
+0000eb90: 6666 6c65 3d73 6875 6666 6c65 2c0a 2020  ffle=shuffle,.  
+0000eba0: 2020 2020 2020 2020 2020 6967 6e6f 7265            ignore
+0000ebb0: 5f69 6e64 6578 3d69 676e 6f72 655f 696e  _index=ignore_in
+0000ebc0: 6465 782c 0a20 2020 2020 2020 2020 2020  dex,.           
+0000ebd0: 2063 6f6d 7075 7465 3d63 6f6d 7075 7465   compute=compute
+0000ebe0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0000ebf0: 2064 6566 205f 6c69 6d69 745f 6669 6c6c   def _limit_fill
+0000ec00: 6e61 2873 656c 662c 206d 6574 686f 643d  na(self, method=
+0000ec10: 4e6f 6e65 2c20 2a2c 206c 696d 6974 3d4e  None, *, limit=N
+0000ec20: 6f6e 652c 2073 6b69 705f 6368 6563 6b3d  one, skip_check=
+0000ec30: 4e6f 6e65 2c20 6d65 7461 3d4e 6f6e 6529  None, meta=None)
+0000ec40: 3a0a 2020 2020 2020 2020 6966 206c 696d  :.        if lim
+0000ec50: 6974 2069 7320 4e6f 6e65 3a0a 2020 2020  it is None:.    
+0000ec60: 2020 2020 2020 2020 6e61 6d65 203d 2022          name = "
+0000ec70: 6669 6c6c 6e61 2d63 6875 6e6b 2d22 202b  fillna-chunk-" +
+0000ec80: 2074 6f6b 656e 697a 6528 7365 6c66 2c20   tokenize(self, 
+0000ec90: 6d65 7468 6f64 290a 2020 2020 2020 2020  method).        
+0000eca0: 2020 2020 6473 6b20 3d20 7b0a 2020 2020      dsk = {.    
+0000ecb0: 2020 2020 2020 2020 2020 2020 286e 616d              (nam
+0000ecc0: 652c 2069 293a 2028 0a20 2020 2020 2020  e, i): (.       
+0000ecd0: 2020 2020 2020 2020 2020 2020 206d 6574               met
+0000ece0: 686f 6473 2e66 696c 6c6e 615f 6368 6563  hods.fillna_chec
+0000ecf0: 6b2c 0a20 2020 2020 2020 2020 2020 2020  k,.             
+0000ed00: 2020 2020 2020 2028 7365 6c66 2e5f 6e61         (self._na
+0000ed10: 6d65 2c20 6929 2c0a 2020 2020 2020 2020  me, i),.        
+0000ed20: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
+0000ed30: 6f64 2c0a 2020 2020 2020 2020 2020 2020  od,.            
+0000ed40: 2020 2020 2020 2020 6920 213d 2073 6b69          i != ski
+0000ed50: 705f 6368 6563 6b2c 0a20 2020 2020 2020  p_check,.       
+0000ed60: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0000ed70: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+0000ed80: 2069 6e20 7261 6e67 6528 7365 6c66 2e6e   in range(self.n
+0000ed90: 7061 7274 6974 696f 6e73 290a 2020 2020  partitions).    
+0000eda0: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+0000edb0: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
+0000edc0: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
+0000edd0: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6e61  m_collections(na
+0000ede0: 6d65 2c20 6473 6b2c 2064 6570 656e 6465  me, dsk, depende
+0000edf0: 6e63 6965 733d 5b73 656c 665d 290a 2020  ncies=[self]).  
+0000ee00: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000ee10: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
+0000ee20: 7261 7068 2c20 6e61 6d65 2c20 6d65 7461  raph, name, meta
+0000ee30: 2c20 7365 6c66 2e64 6976 6973 696f 6e73  , self.divisions
+0000ee40: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+0000ee50: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000ee60: 726e 2073 656c 660a 0a20 2020 2040 6465  rn self..    @de
+0000ee70: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+0000ee80: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+0000ee90: 2066 696c 6c6e 6128 7365 6c66 2c20 7661   fillna(self, va
+0000eea0: 6c75 653d 4e6f 6e65 2c20 6d65 7468 6f64  lue=None, method
+0000eeb0: 3d4e 6f6e 652c 206c 696d 6974 3d4e 6f6e  =None, limit=Non
+0000eec0: 652c 2061 7869 733d 4e6f 6e65 293a 0a20  e, axis=None):. 
+0000eed0: 2020 2020 2020 2069 6620 6d65 7468 6f64         if method
+0000eee0: 2069 7320 4e6f 6e65 2061 6e64 206c 696d   is None and lim
+0000eef0: 6974 2069 7320 6e6f 7420 4e6f 6e65 3a0a  it is not None:.
+0000ef00: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000ef10: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+0000ef20: 4572 726f 7228 2266 696c 6c6e 6120 7769  Error("fillna wi
+0000ef30: 7468 2073 6574 206c 696d 6974 2061 6e64  th set limit and
+0000ef40: 206d 6574 686f 643d 4e6f 6e65 2229 0a0a   method=None")..
+0000ef50: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
+0000ef60: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+0000ef70: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
+0000ef80: 2074 6573 745f 7661 6c75 6520 3d20 280a   test_value = (.
+0000ef90: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+0000efa0: 652e 5f6d 6574 615f 6e6f 6e65 6d70 7479  e._meta_nonempty
+0000efb0: 2069 6620 6973 696e 7374 616e 6365 2876   if isinstance(v
+0000efc0: 616c 7565 2c20 285f 4672 616d 652c 2053  alue, (_Frame, S
+0000efd0: 6361 6c61 7229 2920 656c 7365 2076 616c  calar)) else val
+0000efe0: 7565 0a20 2020 2020 2020 2029 0a0a 2020  ue.        )..  
+0000eff0: 2020 2020 2020 2320 6c65 7420 6974 2072        # let it r
+0000f000: 6169 7365 2061 2046 7574 7572 6557 6172  aise a FutureWar
+0000f010: 6e69 6e67 2069 6620 606d 6574 686f 6460  ning if `method`
+0000f020: 2069 7320 6e6f 7420 4e6f 6e65 0a20 2020   is not None.   
+0000f030: 2020 2020 206d 6574 6120 3d20 7365 6c66       meta = self
+0000f040: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
+0000f050: 6669 6c6c 6e61 280a 2020 2020 2020 2020  fillna(.        
+0000f060: 2020 2020 7661 6c75 653d 7465 7374 5f76      value=test_v
+0000f070: 616c 7565 2c20 6d65 7468 6f64 3d6d 6574  alue, method=met
+0000f080: 686f 642c 206c 696d 6974 3d6c 696d 6974  hod, limit=limit
+0000f090: 2c20 6178 6973 3d61 7869 730a 2020 2020  , axis=axis.    
+0000f0a0: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
+0000f0b0: 6620 6d65 7468 6f64 2069 7320 4e6f 6e65  f method is None
+0000f0c0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+0000f0d0: 436f 6e74 726f 6c20 7768 6574 6865 7220  Control whether 
+0000f0e0: 6f72 206e 6f74 2064 6173 6b27 7320 7061  or not dask's pa
+0000f0f0: 7274 6974 696f 6e20 616c 6967 6e6d 656e  rtition alignmen
+0000f100: 7420 6861 7070 656e 732e 0a20 2020 2020  t happens..     
+0000f110: 2020 2020 2020 2023 2057 6520 646f 6e27         # We don'
+0000f120: 7420 7761 6e74 2066 6f72 2061 2070 616e  t want for a pan
+0000f130: 6461 7320 5365 7269 6573 2e0a 2020 2020  das Series..    
+0000f140: 2020 2020 2020 2020 2320 5765 2064 6f20          # We do 
+0000f150: 7761 6e74 2069 7420 666f 7220 6120 6461  want it for a da
+0000f160: 736b 2053 6572 6965 730a 2020 2020 2020  sk Series.      
+0000f170: 2020 2020 2020 6966 2069 735f 7365 7269        if is_seri
+0000f180: 6573 5f6c 696b 6528 7661 6c75 6529 2061  es_like(value) a
+0000f190: 6e64 206e 6f74 2069 735f 6461 736b 5f63  nd not is_dask_c
+0000f1a0: 6f6c 6c65 6374 696f 6e28 7661 6c75 6529  ollection(value)
+0000f1b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000f1c0: 2020 6172 6773 203d 2028 290a 2020 2020    args = ().    
+0000f1d0: 2020 2020 2020 2020 2020 2020 6b77 6172              kwar
+0000f1e0: 6773 203d 207b 2276 616c 7565 223a 2076  gs = {"value": v
+0000f1f0: 616c 7565 7d0a 2020 2020 2020 2020 2020  alue}.          
+0000f200: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000f210: 2020 2020 2020 2020 6172 6773 203d 2028          args = (
+0000f220: 7661 6c75 652c 290a 2020 2020 2020 2020  value,).        
+0000f230: 2020 2020 2020 2020 6b77 6172 6773 203d          kwargs =
+0000f240: 207b 7d0a 0a20 2020 2020 2020 2020 2020   {}..           
+0000f250: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
+0000f260: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
+0000f270: 2020 2020 2020 2020 2020 2020 204d 2e66               M.f
+0000f280: 696c 6c6e 612c 0a20 2020 2020 2020 2020  illna,.         
+0000f290: 2020 2020 2020 202a 6172 6773 2c0a 2020         *args,.  
+0000f2a0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+0000f2b0: 6d69 743d 6c69 6d69 742c 0a20 2020 2020  mit=limit,.     
+0000f2c0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+0000f2d0: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
+0000f2e0: 2020 2020 2020 6d65 7461 3d6d 6574 612c        meta=meta,
+0000f2f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f300: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+0000f310: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
+0000f320: 2020 2020 2020 2020 202a 2a6b 7761 7267           **kwarg
+0000f330: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
+0000f340: 0a20 2020 2020 2020 2065 6c69 6620 6d65  .        elif me
+0000f350: 7468 6f64 2069 6e20 2822 7061 6422 2c20  thod in ("pad", 
+0000f360: 2266 6669 6c6c 2229 3a0a 2020 2020 2020  "ffill"):.      
+0000f370: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000f380: 662e 6666 696c 6c28 6c69 6d69 743d 6c69  f.ffill(limit=li
+0000f390: 6d69 742c 2061 7869 733d 6178 6973 290a  mit, axis=axis).
+0000f3a0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000f3b0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000f3c0: 2073 656c 662e 6266 696c 6c28 6c69 6d69   self.bfill(limi
+0000f3d0: 743d 6c69 6d69 742c 2061 7869 733d 6178  t=limit, axis=ax
+0000f3e0: 6973 290a 0a20 2020 2040 6465 7269 7665  is)..    @derive
+0000f3f0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+0000f400: 616d 6529 0a20 2020 2064 6566 2066 6669  ame).    def ffi
+0000f410: 6c6c 2873 656c 662c 2061 7869 733d 4e6f  ll(self, axis=No
+0000f420: 6e65 2c20 6c69 6d69 743d 4e6f 6e65 293a  ne, limit=None):
+0000f430: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
+0000f440: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
+0000f450: 7869 7328 6178 6973 290a 2020 2020 2020  xis(axis).      
+0000f460: 2020 6d65 7461 203d 2073 656c 662e 5f6d    meta = self._m
+0000f470: 6574 615f 6e6f 6e65 6d70 7479 2e66 6669  eta_nonempty.ffi
+0000f480: 6c6c 286c 696d 6974 3d6c 696d 6974 2c20  ll(limit=limit, 
+0000f490: 6178 6973 3d61 7869 7329 0a0a 2020 2020  axis=axis)..    
+0000f4a0: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
+0000f4b0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0000f4c0: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
+0000f4d0: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+0000f4e0: 2020 2020 2020 2020 2020 4d2e 6666 696c            M.ffil
+0000f4f0: 6c2c 206c 696d 6974 3d6c 696d 6974 2c20  l, limit=limit, 
+0000f500: 6178 6973 3d61 7869 732c 206d 6574 613d  axis=axis, meta=
+0000f510: 6d65 7461 2c20 656e 666f 7263 655f 6d65  meta, enforce_me
+0000f520: 7461 6461 7461 3d46 616c 7365 0a20 2020  tadata=False.   
+0000f530: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0000f540: 2020 2020 6265 666f 7265 2c20 6166 7465      before, afte
+0000f550: 7220 3d20 3120 6966 206c 696d 6974 2069  r = 1 if limit i
+0000f560: 7320 4e6f 6e65 2065 6c73 6520 6c69 6d69  s None else limi
+0000f570: 742c 2030 0a20 2020 2020 2020 2070 6172  t, 0.        par
+0000f580: 7473 203d 2073 656c 662e 5f6c 696d 6974  ts = self._limit
+0000f590: 5f66 696c 6c6e 6128 2266 6669 6c6c 222c  _fillna("ffill",
+0000f5a0: 206c 696d 6974 3d6c 696d 6974 2c20 736b   limit=limit, sk
+0000f5b0: 6970 5f63 6865 636b 3d30 2c20 6d65 7461  ip_check=0, meta
+0000f5c0: 3d6d 6574 6129 0a20 2020 2020 2020 2072  =meta).        r
+0000f5d0: 6574 7572 6e20 7061 7274 732e 6d61 705f  eturn parts.map_
+0000f5e0: 6f76 6572 6c61 7028 4d2e 6666 696c 6c2c  overlap(M.ffill,
+0000f5f0: 2062 6566 6f72 652c 2061 6674 6572 2c20   before, after, 
+0000f600: 6c69 6d69 743d 6c69 6d69 742c 206d 6574  limit=limit, met
+0000f610: 613d 6d65 7461 290a 0a20 2020 2040 6465  a=meta)..    @de
+0000f620: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
+0000f630: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
+0000f640: 2062 6669 6c6c 2873 656c 662c 2061 7869   bfill(self, axi
+0000f650: 733d 4e6f 6e65 2c20 6c69 6d69 743d 4e6f  s=None, limit=No
+0000f660: 6e65 293a 0a20 2020 2020 2020 2061 7869  ne):.        axi
+0000f670: 7320 3d20 7365 6c66 2e5f 7661 6c69 6461  s = self._valida
+0000f680: 7465 5f61 7869 7328 6178 6973 290a 2020  te_axis(axis).  
+0000f690: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
+0000f6a0: 662e 5f6d 6574 615f 6e6f 6e65 6d70 7479  f._meta_nonempty
+0000f6b0: 2e62 6669 6c6c 286c 696d 6974 3d6c 696d  .bfill(limit=lim
+0000f6c0: 6974 2c20 6178 6973 3d61 7869 7329 0a0a  it, axis=axis)..
+0000f6d0: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
+0000f6e0: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+0000f6f0: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
+0000f700: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
+0000f710: 2020 2020 2020 2020 2020 2020 2020 4d2e                M.
+0000f720: 6266 696c 6c2c 206c 696d 6974 3d6c 696d  bfill, limit=lim
+0000f730: 6974 2c20 6178 6973 3d61 7869 732c 206d  it, axis=axis, m
+0000f740: 6574 613d 6d65 7461 2c20 656e 666f 7263  eta=meta, enforc
+0000f750: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
+0000f760: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0000f770: 2020 2020 2020 2020 6265 666f 7265 2c20          before, 
+0000f780: 6166 7465 7220 3d20 302c 2031 2069 6620  after = 0, 1 if 
+0000f790: 6c69 6d69 7420 6973 204e 6f6e 6520 656c  limit is None el
+0000f7a0: 7365 206c 696d 6974 0a20 2020 2020 2020  se limit.       
+0000f7b0: 2070 6172 7473 203d 2073 656c 662e 5f6c   parts = self._l
+0000f7c0: 696d 6974 5f66 696c 6c6e 6128 0a20 2020  imit_fillna(.   
+0000f7d0: 2020 2020 2020 2020 2022 6266 696c 6c22           "bfill"
+0000f7e0: 2c20 6c69 6d69 743d 6c69 6d69 742c 2073  , limit=limit, s
+0000f7f0: 6b69 705f 6368 6563 6b3d 7365 6c66 2e6e  kip_check=self.n
+0000f800: 7061 7274 6974 696f 6e73 202d 2031 2c20  partitions - 1, 
+0000f810: 6d65 7461 3d6d 6574 610a 2020 2020 2020  meta=meta.      
+0000f820: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
+0000f830: 726e 2070 6172 7473 2e6d 6170 5f6f 7665  rn parts.map_ove
+0000f840: 726c 6170 284d 2e62 6669 6c6c 2c20 6265  rlap(M.bfill, be
+0000f850: 666f 7265 2c20 6166 7465 722c 206c 696d  fore, after, lim
+0000f860: 6974 3d6c 696d 6974 2c20 6d65 7461 3d6d  it=limit, meta=m
+0000f870: 6574 6129 0a0a 2020 2020 6465 6620 7361  eta)..    def sa
+0000f880: 6d70 6c65 2873 656c 662c 206e 3d4e 6f6e  mple(self, n=Non
+0000f890: 652c 2066 7261 633d 4e6f 6e65 2c20 7265  e, frac=None, re
+0000f8a0: 706c 6163 653d 4661 6c73 652c 2072 616e  place=False, ran
+0000f8b0: 646f 6d5f 7374 6174 653d 4e6f 6e65 293a  dom_state=None):
+0000f8c0: 0a20 2020 2020 2020 2022 2222 5261 6e64  .        """Rand
+0000f8d0: 6f6d 2073 616d 706c 6520 6f66 2069 7465  om sample of ite
+0000f8e0: 6d73 0a0a 2020 2020 2020 2020 5061 7261  ms..        Para
+0000f8f0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+0000f900: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0000f910: 2020 6e20 3a20 696e 742c 206f 7074 696f    n : int, optio
+0000f920: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+0000f930: 4e75 6d62 6572 206f 6620 6974 656d 7320  Number of items 
+0000f940: 746f 2072 6574 7572 6e20 6973 206e 6f74  to return is not
+0000f950: 2073 7570 706f 7274 6564 2062 7920 6461   supported by da
+0000f960: 736b 2e20 5573 6520 6672 6163 0a20 2020  sk. Use frac.   
+0000f970: 2020 2020 2020 2020 2069 6e73 7465 6164           instead
+0000f980: 2e0a 2020 2020 2020 2020 6672 6163 203a  ..        frac :
+0000f990: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
+0000f9a0: 0a20 2020 2020 2020 2020 2020 2041 7070  .            App
+0000f9b0: 726f 7869 6d61 7465 2066 7261 6374 696f  roximate fractio
+0000f9c0: 6e20 6f66 2069 7465 6d73 2074 6f20 7265  n of items to re
+0000f9d0: 7475 726e 2e20 5468 6973 2073 616d 706c  turn. This sampl
+0000f9e0: 696e 6720 6672 6163 7469 6f6e 2069 730a  ing fraction is.
+0000f9f0: 2020 2020 2020 2020 2020 2020 6170 706c              appl
+0000fa00: 6965 6420 746f 2061 6c6c 2070 6172 7469  ied to all parti
+0000fa10: 7469 6f6e 7320 6571 7561 6c6c 792e 204e  tions equally. N
+0000fa20: 6f74 6520 7468 6174 2074 6869 7320 6973  ote that this is
+0000fa30: 2061 6e0a 2020 2020 2020 2020 2020 2020   an.            
+0000fa40: 2a2a 6170 7072 6f78 696d 6174 6520 6672  **approximate fr
+0000fa50: 6163 7469 6f6e 2a2a 2e20 596f 7520 7368  action**. You sh
+0000fa60: 6f75 6c64 206e 6f74 2065 7870 6563 7420  ould not expect 
+0000fa70: 6578 6163 746c 7920 6060 6c65 6e28 6466  exactly ``len(df
+0000fa80: 2920 2a20 6672 6163 6060 0a20 2020 2020  ) * frac``.     
+0000fa90: 2020 2020 2020 2069 7465 6d73 2074 6f20         items to 
+0000faa0: 6265 2072 6574 7572 6e65 642c 2061 7320  be returned, as 
+0000fab0: 7468 6520 6578 6163 7420 6e75 6d62 6572  the exact number
+0000fac0: 206f 6620 656c 656d 656e 7473 2073 656c   of elements sel
+0000fad0: 6563 7465 6420 7769 6c6c 0a20 2020 2020  ected will.     
+0000fae0: 2020 2020 2020 2064 6570 656e 6420 6f6e         depend on
+0000faf0: 2068 6f77 2079 6f75 7220 6461 7461 2069   how your data i
+0000fb00: 7320 7061 7274 6974 696f 6e65 6420 2862  s partitioned (b
+0000fb10: 7574 2073 686f 756c 6420 6265 2070 7265  ut should be pre
+0000fb20: 7474 7920 636c 6f73 650a 2020 2020 2020  tty close.      
+0000fb30: 2020 2020 2020 696e 2070 7261 6374 6963        in practic
+0000fb40: 6529 2e0a 2020 2020 2020 2020 7265 706c  e)..        repl
+0000fb50: 6163 6520 3a20 626f 6f6c 6561 6e2c 206f  ace : boolean, o
+0000fb60: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+0000fb70: 2020 2020 5361 6d70 6c65 2077 6974 6820      Sample with 
+0000fb80: 6f72 2077 6974 686f 7574 2072 6570 6c61  or without repla
+0000fb90: 6365 6d65 6e74 2e20 4465 6661 756c 7420  cement. Default 
+0000fba0: 3d20 4661 6c73 652e 0a20 2020 2020 2020  = False..       
+0000fbb0: 2072 616e 646f 6d5f 7374 6174 6520 3a20   random_state : 
+0000fbc0: 696e 7420 6f72 2060 606e 702e 7261 6e64  int or ``np.rand
+0000fbd0: 6f6d 2e52 616e 646f 6d53 7461 7465 6060  om.RandomState``
+0000fbe0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+0000fbf0: 616e 2069 6e74 2c20 7765 2063 7265 6174  an int, we creat
+0000fc00: 6520 6120 6e65 7720 5261 6e64 6f6d 5374  e a new RandomSt
+0000fc10: 6174 6520 7769 7468 2074 6869 7320 6173  ate with this as
+0000fc20: 2074 6865 2073 6565 643b 0a20 2020 2020   the seed;.     
+0000fc30: 2020 2020 2020 204f 7468 6572 7769 7365         Otherwise
+0000fc40: 2077 6520 6472 6177 2066 726f 6d20 7468   we draw from th
+0000fc50: 6520 7061 7373 6564 2052 616e 646f 6d53  e passed RandomS
+0000fc60: 7461 7465 2e0a 0a20 2020 2020 2020 2053  tate...        S
+0000fc70: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
+0000fc80: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+0000fc90: 2044 6174 6146 7261 6d65 2e72 616e 646f   DataFrame.rando
+0000fca0: 6d5f 7370 6c69 740a 2020 2020 2020 2020  m_split.        
+0000fcb0: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
+0000fcc0: 2e73 616d 706c 650a 2020 2020 2020 2020  .sample.        
+0000fcd0: 2222 220a 2020 2020 2020 2020 6966 206e  """.        if n
+0000fce0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0000fcf0: 2020 2020 2020 2020 2020 6d73 6720 3d20            msg = 
+0000fd00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000fd10: 2020 2273 616d 706c 6520 646f 6573 206e    "sample does n
+0000fd20: 6f74 2073 7570 706f 7274 2074 6865 206e  ot support the n
+0000fd30: 756d 6265 7220 6f66 2073 616d 706c 6564  umber of sampled
+0000fd40: 2069 7465 6d73 2022 0a20 2020 2020 2020   items ".       
+0000fd50: 2020 2020 2020 2020 2022 7061 7261 6d65           "parame
+0000fd60: 7465 722c 2027 6e27 2e20 506c 6561 7365  ter, 'n'. Please
+0000fd70: 2075 7365 2074 6865 2027 6672 6163 2720   use the 'frac' 
+0000fd80: 7061 7261 6d65 7465 7220 696e 7374 6561  parameter instea
+0000fd90: 642e 220a 2020 2020 2020 2020 2020 2020  d.".            
+0000fda0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+0000fdb0: 2069 7369 6e73 7461 6e63 6528 6e2c 204e   isinstance(n, N
+0000fdc0: 756d 6265 7229 2061 6e64 2030 203c 3d20  umber) and 0 <= 
+0000fdd0: 6e20 3c3d 2031 3a0a 2020 2020 2020 2020  n <= 1:.        
+0000fde0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+0000fdf0: 2e77 6172 6e28 6d73 6729 0a20 2020 2020  .warn(msg).     
+0000fe00: 2020 2020 2020 2020 2020 2066 7261 6320             frac 
+0000fe10: 3d20 6e0a 2020 2020 2020 2020 2020 2020  = n.            
+0000fe20: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000fe30: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0000fe40: 6545 7272 6f72 286d 7367 290a 0a20 2020  eError(msg)..   
+0000fe50: 2020 2020 2069 6620 6672 6163 2069 7320       if frac is 
+0000fe60: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000fe70: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0000fe80: 6f72 2822 6672 6163 206d 7573 7420 6e6f  or("frac must no
+0000fe90: 7420 6265 204e 6f6e 6522 290a 0a20 2020  t be None")..   
+0000fea0: 2020 2020 2069 6620 7261 6e64 6f6d 5f73       if random_s
+0000feb0: 7461 7465 2069 7320 4e6f 6e65 3a0a 2020  tate is None:.  
+0000fec0: 2020 2020 2020 2020 2020 7261 6e64 6f6d            random
+0000fed0: 5f73 7461 7465 203d 206e 702e 7261 6e64  _state = np.rand
+0000fee0: 6f6d 2e52 616e 646f 6d53 7461 7465 2829  om.RandomState()
+0000fef0: 0a0a 2020 2020 2020 2020 6e61 6d65 203d  ..        name =
+0000ff00: 2022 7361 6d70 6c65 2d22 202b 2074 6f6b   "sample-" + tok
+0000ff10: 656e 697a 6528 7365 6c66 2c20 6672 6163  enize(self, frac
+0000ff20: 2c20 7265 706c 6163 652c 2072 616e 646f  , replace, rando
+0000ff30: 6d5f 7374 6174 6529 0a0a 2020 2020 2020  m_state)..      
+0000ff40: 2020 7374 6174 655f 6461 7461 203d 2072    state_data = r
+0000ff50: 616e 646f 6d5f 7374 6174 655f 6461 7461  andom_state_data
+0000ff60: 2873 656c 662e 6e70 6172 7469 7469 6f6e  (self.npartition
+0000ff70: 732c 2072 616e 646f 6d5f 7374 6174 6529  s, random_state)
+0000ff80: 0a20 2020 2020 2020 2064 736b 203d 207b  .        dsk = {
+0000ff90: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
+0000ffa0: 6d65 2c20 6929 3a20 286d 6574 686f 6473  me, i): (methods
+0000ffb0: 2e73 616d 706c 652c 2028 7365 6c66 2e5f  .sample, (self._
+0000ffc0: 6e61 6d65 2c20 6929 2c20 7374 6174 652c  name, i), state,
+0000ffd0: 2066 7261 632c 2072 6570 6c61 6365 290a   frac, replace).
+0000ffe0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0000fff0: 692c 2073 7461 7465 2069 6e20 656e 756d  i, state in enum
+00010000: 6572 6174 6528 7374 6174 655f 6461 7461  erate(state_data
+00010010: 290a 2020 2020 2020 2020 7d0a 0a20 2020  ).        }..   
+00010020: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
+00010030: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+00010040: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
+00010050: 652c 2064 736b 2c20 6465 7065 6e64 656e  e, dsk, dependen
+00010060: 6369 6573 3d5b 7365 6c66 5d29 0a20 2020  cies=[self]).   
+00010070: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+00010080: 6464 5f6f 626a 6563 7428 6772 6170 682c  dd_object(graph,
+00010090: 206e 616d 652c 2073 656c 662e 5f6d 6574   name, self._met
+000100a0: 612c 2073 656c 662e 6469 7669 7369 6f6e  a, self.division
+000100b0: 7329 0a0a 2020 2020 4064 6572 6976 6564  s)..    @derived
+000100c0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+000100d0: 6d65 290a 2020 2020 6465 6620 7265 706c  me).    def repl
+000100e0: 6163 6528 7365 6c66 2c20 746f 5f72 6570  ace(self, to_rep
+000100f0: 6c61 6365 3d4e 6f6e 652c 2076 616c 7565  lace=None, value
+00010100: 3d4e 6f6e 652c 2072 6567 6578 3d46 616c  =None, regex=Fal
+00010110: 7365 293a 0a20 2020 2020 2020 2023 2049  se):.        # I
+00010120: 6e20 5041 4e44 4153 5f47 545f 3134 3020  n PANDAS_GT_140 
+00010130: 7061 6e64 6173 2073 7461 7274 7320 7573  pandas starts us
+00010140: 696e 6720 6e6f 5f64 6566 6175 6c74 2069  ing no_default i
+00010150: 6e73 7465 6164 206f 6620 4e6f 6e65 0a20  nstead of None. 
+00010160: 2020 2020 2020 2076 616c 7565 5f6b 7761         value_kwa
+00010170: 7267 203d 207b 2276 616c 7565 223a 2076  rg = {"value": v
+00010180: 616c 7565 7d20 6966 2076 616c 7565 2069  alue} if value i
+00010190: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
+000101a0: 7b7d 0a20 2020 2020 2020 2072 6574 7572  {}.        retur
+000101b0: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
+000101c0: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
+000101d0: 2020 204d 2e72 6570 6c61 6365 2c0a 2020     M.replace,.  
+000101e0: 2020 2020 2020 2020 2020 746f 5f72 6570            to_rep
+000101f0: 6c61 6365 3d74 6f5f 7265 706c 6163 652c  lace=to_replace,
+00010200: 0a20 2020 2020 2020 2020 2020 202a 2a76  .            **v
+00010210: 616c 7565 5f6b 7761 7267 2c0a 2020 2020  alue_kwarg,.    
+00010220: 2020 2020 2020 2020 7265 6765 783d 7265          regex=re
+00010230: 6765 782c 0a20 2020 2020 2020 2020 2020  gex,.           
+00010240: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+00010250: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
+00010260: 2029 0a0a 2020 2020 6465 6620 746f 5f64   )..    def to_d
+00010270: 6173 6b5f 6172 7261 7928 7365 6c66 2c20  ask_array(self, 
+00010280: 6c65 6e67 7468 733d 4e6f 6e65 2c20 6d65  lengths=None, me
+00010290: 7461 3d4e 6f6e 6529 3a0a 2020 2020 2020  ta=None):.      
+000102a0: 2020 2222 2243 6f6e 7665 7274 2061 2064    """Convert a d
+000102b0: 6173 6b20 4461 7461 4672 616d 6520 746f  ask DataFrame to
+000102c0: 2061 2064 6173 6b20 6172 7261 792e 0a0a   a dask array...
+000102d0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+000102e0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+000102f0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6c65  -----.        le
+00010300: 6e67 7468 7320 3a20 626f 6f6c 206f 7220  ngths : bool or 
+00010310: 5365 7175 656e 6365 206f 6620 696e 7473  Sequence of ints
+00010320: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00010330: 2020 2020 2020 2048 6f77 2074 6f20 6465         How to de
+00010340: 7465 726d 696e 6520 7468 6520 6368 756e  termine the chun
+00010350: 6b73 2073 697a 6573 2066 6f72 2074 6865  ks sizes for the
+00010360: 206f 7574 7075 7420 6172 7261 792e 0a20   output array.. 
+00010370: 2020 2020 2020 2020 2020 2042 7920 6465             By de
+00010380: 6661 756c 742c 2074 6865 206f 7574 7075  fault, the outpu
+00010390: 7420 6172 7261 7920 7769 6c6c 2068 6176  t array will hav
+000103a0: 6520 756e 6b6e 6f77 6e20 6368 756e 6b20  e unknown chunk 
+000103b0: 6c65 6e67 7468 730a 2020 2020 2020 2020  lengths.        
+000103c0: 2020 2020 616c 6f6e 6720 7468 6520 6669      along the fi
+000103d0: 7273 7420 6178 6973 2c20 7768 6963 6820  rst axis, which 
+000103e0: 6361 6e20 6361 7573 6520 736f 6d65 206c  can cause some l
+000103f0: 6174 6572 206f 7065 7261 7469 6f6e 730a  ater operations.
+00010400: 2020 2020 2020 2020 2020 2020 746f 2066              to f
+00010410: 6169 6c2e 0a0a 2020 2020 2020 2020 2020  ail...          
+00010420: 2020 2a20 5472 7565 203a 2069 6d6d 6564    * True : immed
+00010430: 6961 7465 6c79 2063 6f6d 7075 7465 2074  iately compute t
+00010440: 6865 206c 656e 6774 6820 6f66 2065 6163  he length of eac
+00010450: 6820 7061 7274 6974 696f 6e0a 2020 2020  h partition.    
+00010460: 2020 2020 2020 2020 2a20 5365 7175 656e          * Sequen
+00010470: 6365 203a 2061 2073 6571 7565 6e63 6520  ce : a sequence 
+00010480: 6f66 2069 6e74 6567 6572 7320 746f 2075  of integers to u
+00010490: 7365 2066 6f72 2074 6865 2063 6875 6e6b  se for the chunk
+000104a0: 2073 697a 6573 0a20 2020 2020 2020 2020   sizes.         
+000104b0: 2020 2020 206f 6e20 7468 6520 6669 7273       on the firs
+000104c0: 7420 6178 6973 2e20 5468 6573 6520 7661  t axis. These va
+000104d0: 6c75 6573 2061 7265 202a 6e6f 742a 2076  lues are *not* v
+000104e0: 616c 6964 6174 6564 2066 6f72 0a20 2020  alidated for.   
+000104f0: 2020 2020 2020 2020 2020 2063 6f72 7265             corre
+00010500: 6374 6e65 7373 2c20 6265 796f 6e64 2065  ctness, beyond e
+00010510: 6e73 7572 696e 6720 7468 6174 2074 6865  nsuring that the
+00010520: 206e 756d 6265 7220 6f66 2069 7465 6d73   number of items
+00010530: 0a20 2020 2020 2020 2020 2020 2020 206d  .              m
+00010540: 6174 6368 6573 2074 6865 206e 756d 6265  atches the numbe
+00010550: 7220 6f66 2070 6172 7469 7469 6f6e 732e  r of partitions.
+00010560: 0a20 2020 2020 2020 206d 6574 6120 3a20  .        meta : 
+00010570: 6f62 6a65 6374 2c20 6f70 7469 6f6e 616c  object, optional
+00010580: 0a20 2020 2020 2020 2020 2020 2041 6e20  .            An 
+00010590: 6f70 7469 6f6e 616c 2060 6d65 7461 6020  optional `meta` 
+000105a0: 7061 7261 6d65 7465 7220 6361 6e20 6265  parameter can be
+000105b0: 2070 6173 7365 6420 666f 7220 6461 736b   passed for dask
+000105c0: 2074 6f20 6f76 6572 7269 6465 2074 6865   to override the
+000105d0: 0a20 2020 2020 2020 2020 2020 2064 6566  .            def
+000105e0: 6175 6c74 206d 6574 6164 6174 6120 6f6e  ault metadata on
+000105f0: 2074 6865 2075 6e64 6572 6c79 696e 6720   the underlying 
+00010600: 6461 736b 2061 7272 6179 2e0a 0a20 2020  dask array...   
+00010610: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+00010620: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+00010630: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00010640: 2069 6620 6c65 6e67 7468 7320 6973 2054   if lengths is T
+00010650: 7275 653a 0a20 2020 2020 2020 2020 2020  rue:.           
+00010660: 206c 656e 6774 6873 203d 2074 7570 6c65   lengths = tuple
+00010670: 2873 656c 662e 6d61 705f 7061 7274 6974  (self.map_partit
+00010680: 696f 6e73 286c 656e 2c20 656e 666f 7263  ions(len, enforc
+00010690: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
+000106a0: 292e 636f 6d70 7574 6528 2929 0a0a 2020  ).compute())..  
+000106b0: 2020 2020 2020 6172 7220 3d20 7365 6c66        arr = self
+000106c0: 2e76 616c 7565 730a 0a20 2020 2020 2020  .values..       
+000106d0: 2063 6875 6e6b 7320 3d20 7365 6c66 2e5f   chunks = self._
+000106e0: 7661 6c69 6461 7465 5f63 6875 6e6b 7328  validate_chunks(
+000106f0: 6172 722c 206c 656e 6774 6873 290a 2020  arr, lengths).  
+00010700: 2020 2020 2020 6172 722e 5f63 6875 6e6b        arr._chunk
+00010710: 7320 3d20 6368 756e 6b73 0a0a 2020 2020  s = chunks..    
+00010720: 2020 2020 6966 206d 6574 6120 6973 206e      if meta is n
+00010730: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00010740: 2020 2020 2061 7272 2e5f 6d65 7461 203d       arr._meta =
+00010750: 206d 6574 610a 0a20 2020 2020 2020 2072   meta..        r
+00010760: 6574 7572 6e20 6172 720a 0a20 2020 2064  eturn arr..    d
+00010770: 6566 2074 6f5f 6864 6628 7365 6c66 2c20  ef to_hdf(self, 
+00010780: 7061 7468 5f6f 725f 6275 662c 206b 6579  path_or_buf, key
+00010790: 2c20 6d6f 6465 3d22 6122 2c20 6170 7065  , mode="a", appe
+000107a0: 6e64 3d46 616c 7365 2c20 2a2a 6b77 6172  nd=False, **kwar
+000107b0: 6773 293a 0a20 2020 2020 2020 2022 2222  gs):.        """
+000107c0: 5365 6520 6464 2e74 6f5f 6864 6620 646f  See dd.to_hdf do
+000107d0: 6373 7472 696e 6720 666f 7220 6d6f 7265  cstring for more
+000107e0: 2069 6e66 6f72 6d61 7469 6f6e 2222 220a   information""".
+000107f0: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
+00010800: 6b2e 6461 7461 6672 616d 652e 696f 2069  k.dataframe.io i
+00010810: 6d70 6f72 7420 746f 5f68 6466 0a0a 2020  mport to_hdf..  
+00010820: 2020 2020 2020 7265 7475 726e 2074 6f5f        return to_
+00010830: 6864 6628 7365 6c66 2c20 7061 7468 5f6f  hdf(self, path_o
+00010840: 725f 6275 662c 206b 6579 2c20 6d6f 6465  r_buf, key, mode
+00010850: 2c20 6170 7065 6e64 2c20 2a2a 6b77 6172  , append, **kwar
+00010860: 6773 290a 0a20 2020 2064 6566 2074 6f5f  gs)..    def to_
+00010870: 6373 7628 7365 6c66 2c20 6669 6c65 6e61  csv(self, filena
+00010880: 6d65 2c20 2a2a 6b77 6172 6773 293a 0a20  me, **kwargs):. 
+00010890: 2020 2020 2020 2022 2222 5365 6520 6464         """See dd
+000108a0: 2e74 6f5f 6373 7620 646f 6373 7472 696e  .to_csv docstrin
+000108b0: 6720 666f 7220 6d6f 7265 2069 6e66 6f72  g for more infor
+000108c0: 6d61 7469 6f6e 2222 220a 2020 2020 2020  mation""".      
+000108d0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
+000108e0: 6672 616d 652e 696f 2069 6d70 6f72 7420  frame.io import 
+000108f0: 746f 5f63 7376 0a0a 2020 2020 2020 2020  to_csv..        
+00010900: 7265 7475 726e 2074 6f5f 6373 7628 7365  return to_csv(se
+00010910: 6c66 2c20 6669 6c65 6e61 6d65 2c20 2a2a  lf, filename, **
+00010920: 6b77 6172 6773 290a 0a20 2020 2064 6566  kwargs)..    def
+00010930: 2074 6f5f 7371 6c28 0a20 2020 2020 2020   to_sql(.       
+00010940: 2073 656c 662c 0a20 2020 2020 2020 206e   self,.        n
+00010950: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
+00010960: 2020 7572 693a 2073 7472 2c0a 2020 2020    uri: str,.    
+00010970: 2020 2020 7363 6865 6d61 3d4e 6f6e 652c      schema=None,
+00010980: 0a20 2020 2020 2020 2069 665f 6578 6973  .        if_exis
+00010990: 7473 3a20 7374 7220 3d20 2266 6169 6c22  ts: str = "fail"
+000109a0: 2c0a 2020 2020 2020 2020 696e 6465 783a  ,.        index:
+000109b0: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
+000109c0: 2020 2020 2020 696e 6465 785f 6c61 6265        index_labe
+000109d0: 6c3d 4e6f 6e65 2c0a 2020 2020 2020 2020  l=None,.        
+000109e0: 6368 756e 6b73 697a 653d 4e6f 6e65 2c0a  chunksize=None,.
+000109f0: 2020 2020 2020 2020 6474 7970 653d 4e6f          dtype=No
+00010a00: 6e65 2c0a 2020 2020 2020 2020 6d65 7468  ne,.        meth
+00010a10: 6f64 3d4e 6f6e 652c 0a20 2020 2020 2020  od=None,.       
+00010a20: 2063 6f6d 7075 7465 3d54 7275 652c 0a20   compute=True,. 
+00010a30: 2020 2020 2020 2070 6172 616c 6c65 6c3d         parallel=
+00010a40: 4661 6c73 652c 0a20 2020 2020 2020 2065  False,.        e
+00010a50: 6e67 696e 655f 6b77 6172 6773 3d4e 6f6e  ngine_kwargs=Non
+00010a60: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+00010a70: 2020 2222 2253 6565 2064 642e 746f 5f73    """See dd.to_s
+00010a80: 716c 2064 6f63 7374 7269 6e67 2066 6f72  ql docstring for
+00010a90: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
+00010aa0: 6e22 2222 0a20 2020 2020 2020 2066 726f  n""".        fro
+00010ab0: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
+00010ac0: 2e69 6f20 696d 706f 7274 2074 6f5f 7371  .io import to_sq
+00010ad0: 6c0a 0a20 2020 2020 2020 2072 6574 7572  l..        retur
+00010ae0: 6e20 746f 5f73 716c 280a 2020 2020 2020  n to_sql(.      
+00010af0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00010b00: 2020 2020 2020 2020 6e61 6d65 3d6e 616d          name=nam
+00010b10: 652c 0a20 2020 2020 2020 2020 2020 2075  e,.            u
+00010b20: 7269 3d75 7269 2c0a 2020 2020 2020 2020  ri=uri,.        
+00010b30: 2020 2020 7363 6865 6d61 3d73 6368 656d      schema=schem
+00010b40: 612c 0a20 2020 2020 2020 2020 2020 2069  a,.            i
+00010b50: 665f 6578 6973 7473 3d69 665f 6578 6973  f_exists=if_exis
+00010b60: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
+00010b70: 696e 6465 783d 696e 6465 782c 0a20 2020  index=index,.   
+00010b80: 2020 2020 2020 2020 2069 6e64 6578 5f6c           index_l
+00010b90: 6162 656c 3d69 6e64 6578 5f6c 6162 656c  abel=index_label
+00010ba0: 2c0a 2020 2020 2020 2020 2020 2020 6368  ,.            ch
+00010bb0: 756e 6b73 697a 653d 6368 756e 6b73 697a  unksize=chunksiz
+00010bc0: 652c 0a20 2020 2020 2020 2020 2020 2064  e,.            d
+00010bd0: 7479 7065 3d64 7479 7065 2c0a 2020 2020  type=dtype,.    
+00010be0: 2020 2020 2020 2020 6d65 7468 6f64 3d6d          method=m
+00010bf0: 6574 686f 642c 0a20 2020 2020 2020 2020  ethod,.         
+00010c00: 2020 2063 6f6d 7075 7465 3d63 6f6d 7075     compute=compu
+00010c10: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+00010c20: 7061 7261 6c6c 656c 3d70 6172 616c 6c65  parallel=paralle
+00010c30: 6c2c 0a20 2020 2020 2020 2020 2020 2065  l,.            e
+00010c40: 6e67 696e 655f 6b77 6172 6773 3d65 6e67  ngine_kwargs=eng
+00010c50: 696e 655f 6b77 6172 6773 2c0a 2020 2020  ine_kwargs,.    
+00010c60: 2020 2020 290a 0a20 2020 2064 6566 2074      )..    def t
+00010c70: 6f5f 6a73 6f6e 2873 656c 662c 2066 696c  o_json(self, fil
+00010c80: 656e 616d 652c 202a 6172 6773 2c20 2a2a  ename, *args, **
+00010c90: 6b77 6172 6773 293a 0a20 2020 2020 2020  kwargs):.       
+00010ca0: 2022 2222 5365 6520 6464 2e74 6f5f 6a73   """See dd.to_js
+00010cb0: 6f6e 2064 6f63 7374 7269 6e67 2066 6f72  on docstring for
+00010cc0: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
+00010cd0: 6e22 2222 0a20 2020 2020 2020 2066 726f  n""".        fro
+00010ce0: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
+00010cf0: 2e69 6f20 696d 706f 7274 2074 6f5f 6a73  .io import to_js
+00010d00: 6f6e 0a0a 2020 2020 2020 2020 7265 7475  on..        retu
+00010d10: 726e 2074 6f5f 6a73 6f6e 2873 656c 662c  rn to_json(self,
+00010d20: 2066 696c 656e 616d 652c 202a 6172 6773   filename, *args
+00010d30: 2c20 2a2a 6b77 6172 6773 290a 0a20 2020  , **kwargs)..   
+00010d40: 2064 6566 2074 6f5f 6465 6c61 7965 6428   def to_delayed(
+00010d50: 7365 6c66 2c20 6f70 7469 6d69 7a65 5f67  self, optimize_g
+00010d60: 7261 7068 3d54 7275 6529 3a0a 2020 2020  raph=True):.    
+00010d70: 2020 2020 2222 2243 6f6e 7665 7274 2069      """Convert i
+00010d80: 6e74 6f20 6120 6c69 7374 206f 6620 6060  nto a list of ``
+00010d90: 6461 736b 2e64 656c 6179 6564 6060 206f  dask.delayed`` o
+00010da0: 626a 6563 7473 2c20 6f6e 6520 7065 7220  bjects, one per 
+00010db0: 7061 7274 6974 696f 6e2e 0a0a 2020 2020  partition...    
+00010dc0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00010dd0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00010de0: 2d0a 2020 2020 2020 2020 6f70 7469 6d69  -.        optimi
+00010df0: 7a65 5f67 7261 7068 203a 2062 6f6f 6c2c  ze_graph : bool,
+00010e00: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00010e10: 2020 2020 2020 4966 2054 7275 6520 5b64        If True [d
+00010e20: 6566 6175 6c74 5d2c 2074 6865 2067 7261  efault], the gra
+00010e30: 7068 2069 7320 6f70 7469 6d69 7a65 6420  ph is optimized 
+00010e40: 6265 666f 7265 2063 6f6e 7665 7274 696e  before convertin
+00010e50: 6720 696e 746f 0a20 2020 2020 2020 2020  g into.         
+00010e60: 2020 2060 6064 6173 6b2e 6465 6c61 7965     ``dask.delaye
+00010e70: 6460 6020 6f62 6a65 6374 732e 0a0a 2020  d`` objects...  
+00010e80: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
+00010e90: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
+00010ea0: 2020 2020 2020 2020 3e3e 3e20 7061 7274          >>> part
+00010eb0: 6974 696f 6e73 203d 2064 662e 746f 5f64  itions = df.to_d
+00010ec0: 656c 6179 6564 2829 2020 2320 646f 6374  elayed()  # doct
+00010ed0: 6573 743a 202b 534b 4950 0a0a 2020 2020  est: +SKIP..    
+00010ee0: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+00010ef0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00010f00: 2020 2020 2020 6461 736b 2e64 6174 6166        dask.dataf
+00010f10: 7261 6d65 2e66 726f 6d5f 6465 6c61 7965  rame.from_delaye
+00010f20: 640a 2020 2020 2020 2020 2222 220a 2020  d.        """.  
+00010f30: 2020 2020 2020 6b65 7973 203d 2073 656c        keys = sel
+00010f40: 662e 5f5f 6461 736b 5f6b 6579 735f 5f28  f.__dask_keys__(
+00010f50: 290a 2020 2020 2020 2020 6772 6170 6820  ).        graph 
+00010f60: 3d20 7365 6c66 2e5f 5f64 6173 6b5f 6772  = self.__dask_gr
+00010f70: 6170 685f 5f28 290a 2020 2020 2020 2020  aph__().        
+00010f80: 6c61 7965 7220 3d20 7365 6c66 2e5f 5f64  layer = self.__d
+00010f90: 6173 6b5f 6c61 7965 7273 5f5f 2829 5b30  ask_layers__()[0
+00010fa0: 5d0a 2020 2020 2020 2020 6966 206f 7074  ].        if opt
+00010fb0: 696d 697a 655f 6772 6170 683a 0a20 2020  imize_graph:.   
+00010fc0: 2020 2020 2020 2020 2067 7261 7068 203d           graph =
+00010fd0: 2073 656c 662e 5f5f 6461 736b 5f6f 7074   self.__dask_opt
+00010fe0: 696d 697a 655f 5f28 6772 6170 682c 2073  imize__(graph, s
+00010ff0: 656c 662e 5f5f 6461 736b 5f6b 6579 735f  elf.__dask_keys_
+00011000: 5f28 2929 0a20 2020 2020 2020 2020 2020  _()).           
+00011010: 206c 6179 6572 203d 2022 6465 6c61 7965   layer = "delaye
+00011020: 642d 2220 2b20 7365 6c66 2e5f 6e61 6d65  d-" + self._name
+00011030: 0a20 2020 2020 2020 2020 2020 2067 7261  .            gra
+00011040: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
+00011050: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
+00011060: 696f 6e73 286c 6179 6572 2c20 6772 6170  ions(layer, grap
+00011070: 682c 2064 6570 656e 6465 6e63 6965 733d  h, dependencies=
+00011080: 2829 290a 2020 2020 2020 2020 7265 7475  ()).        retu
+00011090: 726e 205b 4465 6c61 7965 6428 6b2c 2067  rn [Delayed(k, g
+000110a0: 7261 7068 2c20 6c61 7965 723d 6c61 7965  raph, layer=laye
+000110b0: 7229 2066 6f72 206b 2069 6e20 6b65 7973  r) for k in keys
+000110c0: 5d0a 0a20 2020 2064 6566 2074 6f5f 6261  ]..    def to_ba
+000110d0: 636b 656e 6428 7365 6c66 2c20 6261 636b  ckend(self, back
+000110e0: 656e 643a 2073 7472 207c 204e 6f6e 6520  end: str | None 
+000110f0: 3d20 4e6f 6e65 2c20 2a2a 6b77 6172 6773  = None, **kwargs
+00011100: 293a 0a20 2020 2020 2020 2022 2222 4d6f  ):.        """Mo
+00011110: 7665 2074 6f20 6120 6e65 7720 4461 7461  ve to a new Data
+00011120: 4672 616d 6520 6261 636b 656e 640a 0a20  Frame backend.. 
+00011130: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00011140: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00011150: 2d2d 2d2d 0a20 2020 2020 2020 2062 6163  ----.        bac
+00011160: 6b65 6e64 203a 2073 7472 2c20 4f70 7469  kend : str, Opti
+00011170: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+00011180: 2054 6865 206e 616d 6520 6f66 2074 6865   The name of the
+00011190: 206e 6577 2062 6163 6b65 6e64 2074 6f20   new backend to 
+000111a0: 6d6f 7665 2074 6f2e 2054 6865 2064 6566  move to. The def
+000111b0: 6175 6c74 0a20 2020 2020 2020 2020 2020  ault.           
+000111c0: 2069 7320 7468 6520 6375 7272 656e 7420   is the current 
+000111d0: 2264 6174 6166 7261 6d65 2e62 6163 6b65  "dataframe.backe
+000111e0: 6e64 2220 636f 6e66 6967 7572 6174 696f  nd" configuratio
+000111f0: 6e2e 0a0a 2020 2020 2020 2020 5265 7475  n...        Retu
+00011200: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
+00011210: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
+00011220: 4672 616d 652c 2053 6572 6965 7320 6f72  Frame, Series or
+00011230: 2049 6e64 6578 0a20 2020 2020 2020 2022   Index.        "
+00011240: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
+00011250: 6461 736b 2e64 6174 6166 7261 6d65 2e69  dask.dataframe.i
+00011260: 6f20 696d 706f 7274 2074 6f5f 6261 636b  o import to_back
+00011270: 656e 640a 0a20 2020 2020 2020 2072 6574  end..        ret
+00011280: 7572 6e20 746f 5f62 6163 6b65 6e64 2873  urn to_backend(s
+00011290: 656c 662c 2062 6163 6b65 6e64 3d62 6163  elf, backend=bac
+000112a0: 6b65 6e64 2c20 2a2a 6b77 6172 6773 290a  kend, **kwargs).
+000112b0: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
+000112c0: 640a 2020 2020 6465 6620 5f67 6574 5f75  d.    def _get_u
+000112d0: 6e61 7279 5f6f 7065 7261 746f 7228 636c  nary_operator(cl
+000112e0: 732c 206f 7029 3a0a 2020 2020 2020 2020  s, op):.        
+000112f0: 7265 7475 726e 206c 616d 6264 6120 7365  return lambda se
+00011300: 6c66 3a20 656c 656d 7769 7365 286f 702c  lf: elemwise(op,
+00011310: 2073 656c 6629 0a0a 2020 2020 4063 6c61   self)..    @cla
+00011320: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
+00011330: 205f 6765 745f 6269 6e61 7279 5f6f 7065   _get_binary_ope
+00011340: 7261 746f 7228 636c 732c 206f 702c 2069  rator(cls, op, i
+00011350: 6e76 3d46 616c 7365 293a 0a20 2020 2020  nv=False):.     
+00011360: 2020 2069 6620 696e 763a 0a20 2020 2020     if inv:.     
+00011370: 2020 2020 2020 2072 6574 7572 6e20 6c61         return la
+00011380: 6d62 6461 2073 656c 662c 206f 7468 6572  mbda self, other
+00011390: 3a20 656c 656d 7769 7365 286f 702c 206f  : elemwise(op, o
+000113a0: 7468 6572 2c20 7365 6c66 290a 2020 2020  ther, self).    
+000113b0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000113c0: 2020 2020 2020 7265 7475 726e 206c 616d        return lam
+000113d0: 6264 6120 7365 6c66 2c20 6f74 6865 723a  bda self, other:
+000113e0: 2065 6c65 6d77 6973 6528 6f70 2c20 7365   elemwise(op, se
+000113f0: 6c66 2c20 6f74 6865 7229 0a0a 2020 2020  lf, other)..    
+00011400: 6465 6620 726f 6c6c 696e 6728 0a20 2020  def rolling(.   
+00011410: 2020 2020 2073 656c 662c 2077 696e 646f       self, windo
+00011420: 772c 206d 696e 5f70 6572 696f 6473 3d4e  w, min_periods=N
+00011430: 6f6e 652c 2063 656e 7465 723d 4661 6c73  one, center=Fals
+00011440: 652c 2077 696e 5f74 7970 653d 4e6f 6e65  e, win_type=None
+00011450: 2c20 6178 6973 3d6e 6f5f 6465 6661 756c  , axis=no_defaul
+00011460: 740a 2020 2020 293a 0a20 2020 2020 2020  t.    ):.       
+00011470: 2022 2222 5072 6f76 6964 6573 2072 6f6c   """Provides rol
+00011480: 6c69 6e67 2074 7261 6e73 666f 726d 6174  ling transformat
+00011490: 696f 6e73 2e0a 0a20 2020 2020 2020 2050  ions...        P
+000114a0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+000114b0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+000114c0: 2020 2020 2077 696e 646f 7720 3a20 696e       window : in
+000114d0: 742c 2073 7472 2c20 6f66 6673 6574 0a20  t, str, offset. 
+000114e0: 2020 2020 2020 2020 2020 5369 7a65 206f            Size o
+000114f0: 6620 7468 6520 6d6f 7669 6e67 2077 696e  f the moving win
+00011500: 646f 772e 2054 6869 7320 6973 2074 6865  dow. This is the
+00011510: 206e 756d 6265 7220 6f66 206f 6273 6572   number of obser
+00011520: 7661 7469 6f6e 7320 7573 6564 0a20 2020  vations used.   
+00011530: 2020 2020 2020 2020 666f 7220 6361 6c63          for calc
+00011540: 756c 6174 696e 6720 7468 6520 7374 6174  ulating the stat
+00011550: 6973 7469 632e 2057 6865 6e20 6e6f 7420  istic. When not 
+00011560: 7573 696e 6720 6120 6060 4461 7465 7469  using a ``Dateti
+00011570: 6d65 496e 6465 7860 602c 0a20 2020 2020  meIndex``,.     
+00011580: 2020 2020 2020 7468 6520 7769 6e64 6f77        the window
+00011590: 2073 697a 6520 6d75 7374 206e 6f74 2062   size must not b
+000115a0: 6520 736f 206c 6172 6765 2061 7320 746f  e so large as to
+000115b0: 2073 7061 6e20 6d6f 7265 2074 6861 6e20   span more than 
+000115c0: 6f6e 650a 2020 2020 2020 2020 2020 2061  one.           a
+000115d0: 646a 6163 656e 7420 7061 7274 6974 696f  djacent partitio
+000115e0: 6e2e 2049 6620 7573 696e 6720 616e 206f  n. If using an o
+000115f0: 6666 7365 7420 6f72 206f 6666 7365 7420  ffset or offset 
+00011600: 616c 6961 7320 6c69 6b65 2027 3544 272c  alias like '5D',
+00011610: 0a20 2020 2020 2020 2020 2020 7468 6520  .           the 
+00011620: 6461 7461 206d 7573 7420 6861 7665 2061  data must have a
+00011630: 2060 6044 6174 6574 696d 6549 6e64 6578   ``DatetimeIndex
+00011640: 6060 0a0a 2020 2020 2020 2020 2020 202e  ``..           .
+00011650: 2e20 7665 7273 696f 6e63 6861 6e67 6564  . versionchanged
+00011660: 3a3a 2030 2e31 352e 300a 0a20 2020 2020  :: 0.15.0..     
+00011670: 2020 2020 2020 2020 204e 6f77 2061 6363           Now acc
+00011680: 6570 7473 206f 6666 7365 7473 2061 6e64  epts offsets and
+00011690: 2073 7472 696e 6720 6f66 6673 6574 2061   string offset a
+000116a0: 6c69 6173 6573 0a0a 2020 2020 2020 2020  liases..        
+000116b0: 6d69 6e5f 7065 7269 6f64 7320 3a20 696e  min_periods : in
+000116c0: 742c 2064 6566 6175 6c74 204e 6f6e 650a  t, default None.
+000116d0: 2020 2020 2020 2020 2020 2020 4d69 6e69              Mini
+000116e0: 6d75 6d20 6e75 6d62 6572 206f 6620 6f62  mum number of ob
+000116f0: 7365 7276 6174 696f 6e73 2069 6e20 7769  servations in wi
+00011700: 6e64 6f77 2072 6571 7569 7265 6420 746f  ndow required to
+00011710: 2068 6176 6520 6120 7661 6c75 650a 2020   have a value.  
+00011720: 2020 2020 2020 2020 2020 286f 7468 6572            (other
+00011730: 7769 7365 2072 6573 756c 7420 6973 204e  wise result is N
+00011740: 4129 2e0a 2020 2020 2020 2020 6365 6e74  A)..        cent
+00011750: 6572 203a 2062 6f6f 6c65 616e 2c20 6465  er : boolean, de
+00011760: 6661 756c 7420 4661 6c73 650a 2020 2020  fault False.    
+00011770: 2020 2020 2020 2020 5365 7420 7468 6520          Set the 
+00011780: 6c61 6265 6c73 2061 7420 7468 6520 6365  labels at the ce
+00011790: 6e74 6572 206f 6620 7468 6520 7769 6e64  nter of the wind
+000117a0: 6f77 2e0a 2020 2020 2020 2020 7769 6e5f  ow..        win_
+000117b0: 7479 7065 203a 2073 7472 696e 672c 2064  type : string, d
+000117c0: 6566 6175 6c74 204e 6f6e 650a 2020 2020  efault None.    
+000117d0: 2020 2020 2020 2020 5072 6f76 6964 6520          Provide 
+000117e0: 6120 7769 6e64 6f77 2074 7970 652e 2054  a window type. T
+000117f0: 6865 2072 6563 6f67 6e69 7a65 6420 7769  he recognized wi
+00011800: 6e64 6f77 2074 7970 6573 2061 7265 2069  ndow types are i
+00011810: 6465 6e74 6963 616c 0a20 2020 2020 2020  dentical.       
+00011820: 2020 2020 2074 6f20 7061 6e64 6173 2e0a       to pandas..
+00011830: 2020 2020 2020 2020 6178 6973 203a 2069          axis : i
+00011840: 6e74 2c20 7374 722c 204e 6f6e 652c 2064  nt, str, None, d
+00011850: 6566 6175 6c74 2030 0a20 2020 2020 2020  efault 0.       
+00011860: 2020 2020 2054 6869 7320 7061 7261 6d65       This parame
+00011870: 7465 7220 6973 2064 6570 7265 6361 7465  ter is deprecate
+00011880: 6420 7769 7468 2060 6070 616e 6461 733e  d with ``pandas>
+00011890: 3d32 2e31 6060 2e0a 0a20 2020 2020 2020  =2.1``...       
+000118a0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+000118b0: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+000118c0: 2061 2052 6f6c 6c69 6e67 206f 626a 6563   a Rolling objec
+000118d0: 7420 6f6e 2077 6869 6368 2074 6f20 6361  t on which to ca
+000118e0: 6c6c 2061 206d 6574 686f 6420 746f 2063  ll a method to c
+000118f0: 6f6d 7075 7465 2061 2073 7461 7469 7374  ompute a statist
+00011900: 6963 0a20 2020 2020 2020 2022 2222 0a20  ic.        """. 
+00011910: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+00011920: 2e64 6174 6166 7261 6d65 2e72 6f6c 6c69  .dataframe.rolli
+00011930: 6e67 2069 6d70 6f72 7420 526f 6c6c 696e  ng import Rollin
+00011940: 670a 0a20 2020 2020 2020 2069 6620 6973  g..        if is
+00011950: 696e 7374 616e 6365 2877 696e 646f 772c  instance(window,
+00011960: 2049 6e74 6567 7261 6c29 3a0a 2020 2020   Integral):.    
+00011970: 2020 2020 2020 2020 6966 2077 696e 646f          if windo
+00011980: 7720 3c20 303a 0a20 2020 2020 2020 2020  w < 0:.         
+00011990: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+000119a0: 7565 4572 726f 7228 2277 696e 646f 7720  ueError("window 
+000119b0: 6d75 7374 2062 6520 3e3d 2030 2229 0a0a  must be >= 0")..
+000119c0: 2020 2020 2020 2020 6966 206d 696e 5f70          if min_p
+000119d0: 6572 696f 6473 2069 7320 6e6f 7420 4e6f  eriods is not No
+000119e0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+000119f0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00011a00: 6528 6d69 6e5f 7065 7269 6f64 732c 2049  e(min_periods, I
+00011a10: 6e74 6567 7261 6c29 3a0a 2020 2020 2020  ntegral):.      
+00011a20: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00011a30: 5661 6c75 6545 7272 6f72 2822 6d69 6e5f  ValueError("min_
+00011a40: 7065 7269 6f64 7320 6d75 7374 2062 6520  periods must be 
+00011a50: 616e 2069 6e74 6567 6572 2229 0a20 2020  an integer").   
+00011a60: 2020 2020 2020 2020 2069 6620 6d69 6e5f           if min_
+00011a70: 7065 7269 6f64 7320 3c20 303a 0a20 2020  periods < 0:.   
+00011a80: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00011a90: 7365 2056 616c 7565 4572 726f 7228 226d  se ValueError("m
+00011aa0: 696e 5f70 6572 696f 6473 206d 7573 7420  in_periods must 
+00011ab0: 6265 203e 3d20 3022 290a 0a20 2020 2020  be >= 0")..     
+00011ac0: 2020 2072 6574 7572 6e20 526f 6c6c 696e     return Rollin
+00011ad0: 6728 0a20 2020 2020 2020 2020 2020 2073  g(.            s
+00011ae0: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
+00011af0: 2077 696e 646f 773d 7769 6e64 6f77 2c0a   window=window,.
+00011b00: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
+00011b10: 7065 7269 6f64 733d 6d69 6e5f 7065 7269  periods=min_peri
+00011b20: 6f64 732c 0a20 2020 2020 2020 2020 2020  ods,.           
+00011b30: 2063 656e 7465 723d 6365 6e74 6572 2c0a   center=center,.
+00011b40: 2020 2020 2020 2020 2020 2020 7769 6e5f              win_
+00011b50: 7479 7065 3d77 696e 5f74 7970 652c 0a20  type=win_type,. 
+00011b60: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+00011b70: 6178 6973 2c0a 2020 2020 2020 2020 290a  axis,.        ).
+00011b80: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00011b90: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+00011ba0: 0a20 2020 2064 6566 2064 6966 6628 7365  .    def diff(se
+00011bb0: 6c66 2c20 7065 7269 6f64 733d 312c 2061  lf, periods=1, a
+00011bc0: 7869 733d 3029 3a0a 2020 2020 2020 2020  xis=0):.        
+00011bd0: 2222 220a 2020 2020 2020 2020 2e2e 206e  """.        .. n
+00011be0: 6f74 653a 3a0a 0a20 2020 2020 2020 2020  ote::..         
+00011bf0: 2020 5061 6e64 6173 2063 7572 7265 6e74    Pandas current
+00011c00: 6c79 2075 7365 7320 616e 2060 606f 626a  ly uses an ``obj
+00011c10: 6563 7460 602d 6474 7970 6520 636f 6c75  ect``-dtype colu
+00011c20: 6d6e 2074 6f20 7265 7072 6573 656e 740a  mn to represent.
+00011c30: 2020 2020 2020 2020 2020 2062 6f6f 6c65             boole
+00011c40: 616e 2064 6174 6120 7769 7468 206d 6973  an data with mis
+00011c50: 7369 6e67 2076 616c 7565 732e 2054 6869  sing values. Thi
+00011c60: 7320 6361 6e20 6361 7573 6520 6973 7375  s can cause issu
+00011c70: 6573 2066 6f72 0a20 2020 2020 2020 2020  es for.         
+00011c80: 2020 626f 6f6c 6561 6e2d 7370 6563 6966    boolean-specif
+00011c90: 6963 206f 7065 7261 7469 6f6e 732c 206c  ic operations, l
+00011ca0: 696b 6520 6060 7c60 602e 2054 6f20 656e  ike ``|``. To en
+00011cb0: 6162 6c65 2062 6f6f 6c65 616e 2d0a 2020  able boolean-.  
+00011cc0: 2020 2020 2020 2020 2073 7065 6369 6669           specifi
+00011cd0: 6320 6f70 6572 6174 696f 6e73 2c20 6174  c operations, at
+00011ce0: 2074 6865 2063 6f73 7420 6f66 206d 6574   the cost of met
+00011cf0: 6164 6174 6120 7468 6174 2064 6f65 736e  adata that doesn
+00011d00: 2774 206d 6174 6368 0a20 2020 2020 2020  't match.       
+00011d10: 2020 2020 7061 6e64 6173 2c20 7573 6520      pandas, use 
+00011d20: 6060 2e61 7374 7970 6528 626f 6f6c 2960  ``.astype(bool)`
+00011d30: 6020 6166 7465 7220 7468 6520 6060 7368  ` after the ``sh
+00011d40: 6966 7460 602e 0a20 2020 2020 2020 2022  ift``..        "
+00011d50: 2222 0a20 2020 2020 2020 2061 7869 7320  "".        axis 
+00011d60: 3d20 7365 6c66 2e5f 7661 6c69 6461 7465  = self._validate
+00011d70: 5f61 7869 7328 6178 6973 290a 2020 2020  _axis(axis).    
+00011d80: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00011d90: 7461 6e63 6528 7065 7269 6f64 732c 2049  tance(periods, I
+00011da0: 6e74 6567 7261 6c29 3a0a 2020 2020 2020  ntegral):.      
+00011db0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+00011dc0: 4572 726f 7228 2270 6572 696f 6473 206d  Error("periods m
+00011dd0: 7573 7420 6265 2061 6e20 696e 7465 6765  ust be an intege
+00011de0: 7222 290a 0a20 2020 2020 2020 2069 6620  r")..        if 
+00011df0: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
+00011e00: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00011e10: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+00011e20: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00011e30: 2020 204d 2e64 6966 662c 2074 6f6b 656e     M.diff, token
+00011e40: 3d22 6469 6666 222c 2070 6572 696f 6473  ="diff", periods
+00011e50: 3d70 6572 696f 6473 2c20 6178 6973 3d31  =periods, axis=1
+00011e60: 2c20 656e 666f 7263 655f 6d65 7461 6461  , enforce_metada
+00011e70: 7461 3d46 616c 7365 0a20 2020 2020 2020  ta=False.       
+00011e80: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00011e90: 6265 666f 7265 2c20 6166 7465 7220 3d20  before, after = 
+00011ea0: 2870 6572 696f 6473 2c20 3029 2069 6620  (periods, 0) if 
+00011eb0: 7065 7269 6f64 7320 3e20 3020 656c 7365  periods > 0 else
+00011ec0: 2028 302c 202d 7065 7269 6f64 7329 0a20   (0, -periods). 
+00011ed0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00011ee0: 6c66 2e6d 6170 5f6f 7665 726c 6170 284d  lf.map_overlap(M
+00011ef0: 2e64 6966 662c 2062 6566 6f72 652c 2061  .diff, before, a
+00011f00: 6674 6572 2c20 746f 6b65 6e3d 2264 6966  fter, token="dif
+00011f10: 6622 2c20 7065 7269 6f64 733d 7065 7269  f", periods=peri
+00011f20: 6f64 7329 0a0a 2020 2020 4064 6572 6976  ods)..    @deriv
+00011f30: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+00011f40: 7261 6d65 290a 2020 2020 6465 6620 7368  rame).    def sh
+00011f50: 6966 7428 7365 6c66 2c20 7065 7269 6f64  ift(self, period
+00011f60: 733d 312c 2066 7265 713d 4e6f 6e65 2c20  s=1, freq=None, 
+00011f70: 6178 6973 3d30 293a 0a20 2020 2020 2020  axis=0):.       
+00011f80: 2061 7869 7320 3d20 7365 6c66 2e5f 7661   axis = self._va
+00011f90: 6c69 6461 7465 5f61 7869 7328 6178 6973  lidate_axis(axis
+00011fa0: 290a 2020 2020 2020 2020 6966 206e 6f74  ).        if not
+00011fb0: 2069 7369 6e73 7461 6e63 6528 7065 7269   isinstance(peri
+00011fc0: 6f64 732c 2049 6e74 6567 7261 6c29 3a0a  ods, Integral):.
+00011fd0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00011fe0: 6520 5479 7065 4572 726f 7228 2270 6572  e TypeError("per
+00011ff0: 696f 6473 206d 7573 7420 6265 2061 6e20  iods must be an 
+00012000: 696e 7465 6765 7222 290a 0a20 2020 2020  integer")..     
+00012010: 2020 2069 6620 6178 6973 203d 3d20 313a     if axis == 1:
+00012020: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00012030: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
+00012040: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
+00012050: 2020 2020 2020 2020 204d 2e73 6869 6674           M.shift
+00012060: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00012070: 2020 746f 6b65 6e3d 2273 6869 6674 222c    token="shift",
+00012080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012090: 2070 6572 696f 6473 3d70 6572 696f 6473   periods=periods
+000120a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000120b0: 2020 6672 6571 3d66 7265 712c 0a20 2020    freq=freq,.   
+000120c0: 2020 2020 2020 2020 2020 2020 2061 7869               axi
+000120d0: 733d 312c 0a20 2020 2020 2020 2020 2020  s=1,.           
+000120e0: 2020 2020 2065 6e66 6f72 6365 5f6d 6574       enforce_met
+000120f0: 6164 6174 613d 4661 6c73 652c 0a20 2020  adata=False,.   
+00012100: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00012110: 2020 2020 6966 2066 7265 7120 6973 204e      if freq is N
+00012120: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00012130: 2062 6566 6f72 652c 2061 6674 6572 203d   before, after =
+00012140: 2028 7065 7269 6f64 732c 2030 2920 6966   (periods, 0) if
+00012150: 2070 6572 696f 6473 203e 2030 2065 6c73   periods > 0 els
+00012160: 6520 2830 2c20 2d70 6572 696f 6473 290a  e (0, -periods).
+00012170: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00012180: 726e 2073 656c 662e 6d61 705f 6f76 6572  rn self.map_over
+00012190: 6c61 7028 0a20 2020 2020 2020 2020 2020  lap(.           
+000121a0: 2020 2020 204d 2e73 6869 6674 2c20 6265       M.shift, be
+000121b0: 666f 7265 2c20 6166 7465 722c 2074 6f6b  fore, after, tok
+000121c0: 656e 3d22 7368 6966 7422 2c20 7065 7269  en="shift", peri
+000121d0: 6f64 733d 7065 7269 6f64 730a 2020 2020  ods=periods.    
+000121e0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+000121f0: 2020 2023 204c 6574 2070 616e 6461 7320     # Let pandas 
+00012200: 6572 726f 7220 6f6e 2069 6e76 616c 6964  error on invalid
+00012210: 2061 7267 756d 656e 7473 0a20 2020 2020   arguments.     
+00012220: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
+00012230: 6d65 7461 5f6e 6f6e 656d 7074 792e 7368  meta_nonempty.sh
+00012240: 6966 7428 7065 7269 6f64 732c 2066 7265  ift(periods, fre
+00012250: 713d 6672 6571 290a 2020 2020 2020 2020  q=freq).        
+00012260: 6f75 7420 3d20 7365 6c66 2e6d 6170 5f70  out = self.map_p
+00012270: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+00012280: 2020 2020 2020 204d 2e73 6869 6674 2c0a         M.shift,.
+00012290: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
+000122a0: 6e3d 2273 6869 6674 222c 0a20 2020 2020  n="shift",.     
+000122b0: 2020 2020 2020 2070 6572 696f 6473 3d70         periods=p
+000122c0: 6572 696f 6473 2c0a 2020 2020 2020 2020  eriods,.        
+000122d0: 2020 2020 6672 6571 3d66 7265 712c 0a20      freq=freq,. 
+000122e0: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
+000122f0: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
+00012300: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
+00012310: 7461 3d46 616c 7365 2c0a 2020 2020 2020  ta=False,.      
+00012320: 2020 2020 2020 7472 616e 7366 6f72 6d5f        transform_
+00012330: 6469 7669 7369 6f6e 733d 4661 6c73 652c  divisions=False,
+00012340: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00012350: 2020 2072 6574 7572 6e20 6d61 7962 655f     return maybe_
+00012360: 7368 6966 745f 6469 7669 7369 6f6e 7328  shift_divisions(
+00012370: 6f75 742c 2070 6572 696f 6473 2c20 6672  out, periods, fr
+00012380: 6571 3d66 7265 7129 0a0a 2020 2020 6465  eq=freq)..    de
+00012390: 6620 5f72 6564 7563 7469 6f6e 5f61 6767  f _reduction_agg
+000123a0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+000123b0: 2020 2020 2020 2020 6e61 6d65 2c0a 2020          name,.  
+000123c0: 2020 2020 2020 6178 6973 3d4e 6f6e 652c        axis=None,
+000123d0: 0a20 2020 2020 2020 2073 6b69 706e 613d  .        skipna=
+000123e0: 5472 7565 2c0a 2020 2020 2020 2020 7370  True,.        sp
+000123f0: 6c69 745f 6576 6572 793d 4661 6c73 652c  lit_every=False,
+00012400: 0a20 2020 2020 2020 206f 7574 3d4e 6f6e  .        out=Non
+00012410: 652c 0a20 2020 2020 2020 206e 756d 6572  e,.        numer
+00012420: 6963 5f6f 6e6c 793d 4e6f 6e65 2c0a 2020  ic_only=None,.  
+00012430: 2020 2020 2020 6e6f 6e65 5f69 735f 7a65        none_is_ze
+00012440: 726f 3d54 7275 652c 0a20 2020 2029 3a0a  ro=True,.    ):.
+00012450: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
+00012460: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+00012470: 6973 2861 7869 732c 206e 6f6e 655f 6973  is(axis, none_is
+00012480: 5f7a 6572 6f3d 6e6f 6e65 5f69 735f 7a65  _zero=none_is_ze
+00012490: 726f 290a 0a20 2020 2020 2020 2069 6620  ro)..        if 
+000124a0: 6861 735f 6b65 7977 6f72 6428 6765 7461  has_keyword(geta
+000124b0: 7474 7228 7365 6c66 2e5f 6d65 7461 5f6e  ttr(self._meta_n
+000124c0: 6f6e 656d 7074 792c 206e 616d 6529 2c20  onempty, name), 
+000124d0: 226e 756d 6572 6963 5f6f 6e6c 7922 293a  "numeric_only"):
+000124e0: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+000124f0: 6572 6963 5f6f 6e6c 795f 6b77 6172 6773  eric_only_kwargs
+00012500: 203d 207b 226e 756d 6572 6963 5f6f 6e6c   = {"numeric_onl
+00012510: 7922 3a20 6e75 6d65 7269 635f 6f6e 6c79  y": numeric_only
+00012520: 7d0a 2020 2020 2020 2020 656c 7365 3a0a  }.        else:.
+00012530: 2020 2020 2020 2020 2020 2020 6e75 6d65              nume
+00012540: 7269 635f 6f6e 6c79 5f6b 7761 7267 7320  ric_only_kwargs 
+00012550: 3d20 7b7d 0a0a 2020 2020 2020 2020 7769  = {}..        wi
+00012560: 7468 2063 6865 636b 5f6e 756d 6572 6963  th check_numeric
+00012570: 5f6f 6e6c 795f 6465 7072 6563 6174 696f  _only_deprecatio
+00012580: 6e28 6e61 6d65 2c20 5472 7565 293a 0a20  n(name, True):. 
+00012590: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
+000125a0: 3d20 6765 7461 7474 7228 7365 6c66 2e5f  = getattr(self._
+000125b0: 6d65 7461 5f6e 6f6e 656d 7074 792c 206e  meta_nonempty, n
+000125c0: 616d 6529 280a 2020 2020 2020 2020 2020  ame)(.          
+000125d0: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
+000125e0: 2073 6b69 706e 613d 736b 6970 6e61 2c20   skipna=skipna, 
+000125f0: 2a2a 6e75 6d65 7269 635f 6f6e 6c79 5f6b  **numeric_only_k
+00012600: 7761 7267 730a 2020 2020 2020 2020 2020  wargs.          
+00012610: 2020 290a 0a20 2020 2020 2020 2074 6f6b    )..        tok
+00012620: 656e 203d 2073 656c 662e 5f74 6f6b 656e  en = self._token
+00012630: 5f70 7265 6669 7820 2b20 6e61 6d65 0a20  _prefix + name. 
+00012640: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
+00012650: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+00012660: 2072 6573 756c 7420 3d20 7365 6c66 2e6d   result = self.m
+00012670: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
+00012680: 2020 2020 2020 2020 2020 2020 2020 205f                 _
+00012690: 6765 7461 7474 725f 6e75 6d65 7269 635f  getattr_numeric_
+000126a0: 6f6e 6c79 2c0a 2020 2020 2020 2020 2020  only,.          
+000126b0: 2020 2020 2020 6d65 7461 3d6d 6574 612c        meta=meta,
+000126c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000126d0: 2074 6f6b 656e 3d74 6f6b 656e 2c0a 2020   token=token,.  
+000126e0: 2020 2020 2020 2020 2020 2020 2020 736b                sk
+000126f0: 6970 6e61 3d73 6b69 706e 612c 0a20 2020  ipna=skipna,.   
+00012700: 2020 2020 2020 2020 2020 2020 2061 7869               axi
+00012710: 733d 6178 6973 2c0a 2020 2020 2020 2020  s=axis,.        
+00012720: 2020 2020 2020 2020 5f64 6173 6b5f 6d65          _dask_me
+00012730: 7468 6f64 5f6e 616d 653d 6e61 6d65 2c0a  thod_name=name,.
+00012740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012750: 2a2a 6e75 6d65 7269 635f 6f6e 6c79 5f6b  **numeric_only_k
+00012760: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
+00012770: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00012780: 2072 6574 7572 6e20 6861 6e64 6c65 5f6f   return handle_o
+00012790: 7574 286f 7574 2c20 7265 7375 6c74 290a  ut(out, result).
+000127a0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000127b0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+000127c0: 203d 2073 656c 662e 7265 6475 6374 696f   = self.reductio
+000127d0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+000127e0: 2020 205f 6765 7461 7474 725f 6e75 6d65     _getattr_nume
+000127f0: 7269 635f 6f6e 6c79 2c0a 2020 2020 2020  ric_only,.      
+00012800: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
+00012810: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
+00012820: 2020 2020 2074 6f6b 656e 3d74 6f6b 656e       token=token
+00012830: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00012840: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
+00012850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012860: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
+00012870: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
+00012880: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+00012890: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
+000128a0: 2020 2020 205f 6461 736b 5f6d 6574 686f       _dask_metho
+000128b0: 645f 6e61 6d65 3d6e 616d 652c 0a20 2020  d_name=name,.   
+000128c0: 2020 2020 2020 2020 2020 2020 202a 2a6e               **n
+000128d0: 756d 6572 6963 5f6f 6e6c 795f 6b77 6172  umeric_only_kwar
+000128e0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+000128f0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00012900: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+00012910: 2c20 4461 7461 4672 616d 6529 2061 6e64  , DataFrame) and
+00012920: 2069 7369 6e73 7461 6e63 6528 7265 7375   isinstance(resu
+00012930: 6c74 2c20 5365 7269 6573 293a 0a20 2020  lt, Series):.   
+00012940: 2020 2020 2020 2020 2020 2020 2072 6573               res
+00012950: 756c 742e 6469 7669 7369 6f6e 7320 3d20  ult.divisions = 
+00012960: 2873 656c 662e 636f 6c75 6d6e 732e 6d69  (self.columns.mi
+00012970: 6e28 292c 2073 656c 662e 636f 6c75 6d6e  n(), self.column
+00012980: 732e 6d61 7828 2929 0a20 2020 2020 2020  s.max()).       
+00012990: 2020 2020 2072 6574 7572 6e20 6861 6e64       return hand
+000129a0: 6c65 5f6f 7574 286f 7574 2c20 7265 7375  le_out(out, resu
+000129b0: 6c74 290a 0a20 2020 2040 6465 7269 7665  lt)..    @derive
+000129c0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+000129d0: 616d 6529 0a20 2020 2064 6566 2061 6464  ame).    def add
+000129e0: 5f70 7265 6669 7828 7365 6c66 2c20 7072  _prefix(self, pr
+000129f0: 6566 6978 293a 0a20 2020 2020 2020 2072  efix):.        r
+00012a00: 6573 203d 2073 656c 662e 6d61 705f 7061  es = self.map_pa
+00012a10: 7274 6974 696f 6e73 284d 2e61 6464 5f70  rtitions(M.add_p
+00012a20: 7265 6669 782c 2070 7265 6669 7829 0a20  refix, prefix). 
+00012a30: 2020 2020 2020 2069 6620 7365 6c66 2e6b         if self.k
+00012a40: 6e6f 776e 5f64 6976 6973 696f 6e73 2061  nown_divisions a
+00012a50: 6e64 2069 735f 7365 7269 6573 5f6c 696b  nd is_series_lik
+00012a60: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+00012a70: 2020 2020 2072 6573 2e64 6976 6973 696f       res.divisio
+00012a80: 6e73 203d 2074 7570 6c65 2870 7265 6669  ns = tuple(prefi
+00012a90: 7820 2b20 7374 7228 6469 7669 7369 6f6e  x + str(division
+00012aa0: 2920 666f 7220 6469 7669 7369 6f6e 2069  ) for division i
+00012ab0: 6e20 7365 6c66 2e64 6976 6973 696f 6e73  n self.divisions
+00012ac0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00012ad0: 2072 6573 0a0a 2020 2020 4064 6572 6976   res..    @deriv
+00012ae0: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+00012af0: 7261 6d65 290a 2020 2020 6465 6620 6164  rame).    def ad
+00012b00: 645f 7375 6666 6978 2873 656c 662c 2073  d_suffix(self, s
+00012b10: 7566 6669 7829 3a0a 2020 2020 2020 2020  uffix):.        
+00012b20: 7265 7320 3d20 7365 6c66 2e6d 6170 5f70  res = self.map_p
+00012b30: 6172 7469 7469 6f6e 7328 4d2e 6164 645f  artitions(M.add_
+00012b40: 7375 6666 6978 2c20 7375 6666 6978 290a  suffix, suffix).
+00012b50: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00012b60: 6b6e 6f77 6e5f 6469 7669 7369 6f6e 7320  known_divisions 
+00012b70: 616e 6420 6973 5f73 6572 6965 735f 6c69  and is_series_li
+00012b80: 6b65 2873 656c 6629 3a0a 2020 2020 2020  ke(self):.      
+00012b90: 2020 2020 2020 7265 732e 6469 7669 7369        res.divisi
+00012ba0: 6f6e 7320 3d20 7475 706c 6528 7374 7228  ons = tuple(str(
+00012bb0: 6469 7669 7369 6f6e 2920 2b20 7375 6666  division) + suff
+00012bc0: 6978 2066 6f72 2064 6976 6973 696f 6e20  ix for division 
+00012bd0: 696e 2073 656c 662e 6469 7669 7369 6f6e  in self.division
+00012be0: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
+00012bf0: 6e20 7265 730a 0a20 2020 2040 6465 7269  n res..    @deri
+00012c00: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+00012c10: 4672 616d 6529 0a20 2020 2064 6566 2061  Frame).    def a
+00012c20: 6273 2873 656c 6629 3a0a 2020 2020 2020  bs(self):.      
+00012c30: 2020 5f72 6169 7365 5f69 665f 6f62 6a65    _raise_if_obje
+00012c40: 6374 5f73 6572 6965 7328 7365 6c66 2c20  ct_series(self, 
+00012c50: 2261 6273 2229 0a20 2020 2020 2020 206d  "abs").        m
+00012c60: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
+00012c70: 5f6e 6f6e 656d 7074 792e 6162 7328 290a  _nonempty.abs().
+00012c80: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00012c90: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+00012ca0: 6e73 284d 2e61 6273 2c20 6d65 7461 3d6d  ns(M.abs, meta=m
+00012cb0: 6574 612c 2065 6e66 6f72 6365 5f6d 6574  eta, enforce_met
+00012cc0: 6164 6174 613d 4661 6c73 6529 0a0a 2020  adata=False)..  
+00012cd0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00012ce0: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+00012cf0: 2020 6465 6620 616c 6c28 7365 6c66 2c20    def all(self, 
+00012d00: 6178 6973 3d4e 6f6e 652c 2073 6b69 706e  axis=None, skipn
+00012d10: 613d 5472 7565 2c20 7370 6c69 745f 6576  a=True, split_ev
+00012d20: 6572 793d 4661 6c73 652c 206f 7574 3d4e  ery=False, out=N
+00012d30: 6f6e 6529 3a0a 2020 2020 2020 2020 7265  one):.        re
+00012d40: 7475 726e 2073 656c 662e 5f72 6564 7563  turn self._reduc
+00012d50: 7469 6f6e 5f61 6767 280a 2020 2020 2020  tion_agg(.      
+00012d60: 2020 2020 2020 2261 6c6c 222c 2061 7869        "all", axi
+00012d70: 733d 6178 6973 2c20 736b 6970 6e61 3d73  s=axis, skipna=s
+00012d80: 6b69 706e 612c 2073 706c 6974 5f65 7665  kipna, split_eve
+00012d90: 7279 3d73 706c 6974 5f65 7665 7279 2c20  ry=split_every, 
+00012da0: 6f75 743d 6f75 740a 2020 2020 2020 2020  out=out.        
+00012db0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00012dc0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+00012dd0: 6529 0a20 2020 2064 6566 2061 6e79 2873  e).    def any(s
+00012de0: 656c 662c 2061 7869 733d 4e6f 6e65 2c20  elf, axis=None, 
+00012df0: 736b 6970 6e61 3d54 7275 652c 2073 706c  skipna=True, spl
+00012e00: 6974 5f65 7665 7279 3d46 616c 7365 2c20  it_every=False, 
+00012e10: 6f75 743d 4e6f 6e65 293a 0a20 2020 2020  out=None):.     
+00012e20: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00012e30: 7265 6475 6374 696f 6e5f 6167 6728 0a20  reduction_agg(. 
+00012e40: 2020 2020 2020 2020 2020 2022 616e 7922             "any"
+00012e50: 2c20 6178 6973 3d61 7869 732c 2073 6b69  , axis=axis, ski
+00012e60: 706e 613d 736b 6970 6e61 2c20 7370 6c69  pna=skipna, spli
+00012e70: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+00012e80: 6572 792c 206f 7574 3d6f 7574 0a20 2020  ery, out=out.   
+00012e90: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
+00012ea0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+00012eb0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+00012ec0: 7375 6d28 0a20 2020 2020 2020 2073 656c  sum(.        sel
+00012ed0: 662c 0a20 2020 2020 2020 2061 7869 733d  f,.        axis=
+00012ee0: 4e6f 6e65 2c0a 2020 2020 2020 2020 736b  None,.        sk
+00012ef0: 6970 6e61 3d54 7275 652c 0a20 2020 2020  ipna=True,.     
+00012f00: 2020 2073 706c 6974 5f65 7665 7279 3d46     split_every=F
+00012f10: 616c 7365 2c0a 2020 2020 2020 2020 6474  alse,.        dt
+00012f20: 7970 653d 4e6f 6e65 2c0a 2020 2020 2020  ype=None,.      
+00012f30: 2020 6f75 743d 4e6f 6e65 2c0a 2020 2020    out=None,.    
+00012f40: 2020 2020 6d69 6e5f 636f 756e 743d 4e6f      min_count=No
+00012f50: 6e65 2c0a 2020 2020 2020 2020 6e75 6d65  ne,.        nume
+00012f60: 7269 635f 6f6e 6c79 3d4e 6f6e 652c 0a20  ric_only=None,. 
+00012f70: 2020 2029 3a0a 2020 2020 2020 2020 7265     ):.        re
+00012f80: 7375 6c74 203d 2073 656c 662e 5f72 6564  sult = self._red
+00012f90: 7563 7469 6f6e 5f61 6767 280a 2020 2020  uction_agg(.    
+00012fa0: 2020 2020 2020 2020 2273 756d 222c 0a20          "sum",. 
+00012fb0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+00012fc0: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
+00012fd0: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
+00012fe0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+00012ff0: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+00013000: 7665 7279 2c0a 2020 2020 2020 2020 2020  very,.          
+00013010: 2020 6f75 743d 6f75 742c 0a20 2020 2020    out=out,.     
+00013020: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
+00013030: 6e6c 793d 6e75 6d65 7269 635f 6f6e 6c79  nly=numeric_only
+00013040: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00013050: 2020 2020 6966 206d 696e 5f63 6f75 6e74      if min_count
+00013060: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+00013070: 6e64 203d 2073 656c 662e 6e6f 746e 756c  nd = self.notnul
+00013080: 6c28 292e 7375 6d28 6178 6973 3d61 7869  l().sum(axis=axi
+00013090: 7329 203e 3d20 6d69 6e5f 636f 756e 740a  s) >= min_count.
+000130a0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+000130b0: 735f 7365 7269 6573 5f6c 696b 6528 636f  s_series_like(co
+000130c0: 6e64 293a 0a20 2020 2020 2020 2020 2020  nd):.           
+000130d0: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
+000130e0: 6c74 2e77 6865 7265 2863 6f6e 642c 206f  lt.where(cond, o
+000130f0: 7468 6572 3d6e 702e 4e61 4e29 0a20 2020  ther=np.NaN).   
+00013100: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00013110: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00013120: 6574 7572 6e20 5f73 6361 6c61 725f 6269  eturn _scalar_bi
+00013130: 6e61 7279 280a 2020 2020 2020 2020 2020  nary(.          
+00013140: 2020 2020 2020 2020 2020 6c61 6d62 6461            lambda
+00013150: 2078 2c20 793a 2072 6573 756c 7420 6966   x, y: result if
+00013160: 2078 2069 7320 7920 656c 7365 206e 702e   x is y else np.
+00013170: 4e61 4e2c 2063 6f6e 642c 2054 7275 650a  NaN, cond, True.
+00013180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013190: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+000131a0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000131b0: 726e 2072 6573 756c 740a 0a20 2020 2040  rn result..    @
+000131c0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+000131d0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+000131e0: 6566 2070 726f 6428 0a20 2020 2020 2020  ef prod(.       
+000131f0: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
+00013200: 7869 733d 4e6f 6e65 2c0a 2020 2020 2020  xis=None,.      
+00013210: 2020 736b 6970 6e61 3d54 7275 652c 0a20    skipna=True,. 
+00013220: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
+00013230: 7279 3d46 616c 7365 2c0a 2020 2020 2020  ry=False,.      
+00013240: 2020 6474 7970 653d 4e6f 6e65 2c0a 2020    dtype=None,.  
+00013250: 2020 2020 2020 6f75 743d 4e6f 6e65 2c0a        out=None,.
+00013260: 2020 2020 2020 2020 6d69 6e5f 636f 756e          min_coun
+00013270: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
+00013280: 6e75 6d65 7269 635f 6f6e 6c79 3d4e 6f6e  numeric_only=Non
+00013290: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+000132a0: 2020 7265 7375 6c74 203d 2073 656c 662e    result = self.
+000132b0: 5f72 6564 7563 7469 6f6e 5f61 6767 280a  _reduction_agg(.
+000132c0: 2020 2020 2020 2020 2020 2020 2270 726f              "pro
+000132d0: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
+000132e0: 6178 6973 3d61 7869 732c 0a20 2020 2020  axis=axis,.     
+000132f0: 2020 2020 2020 2073 6b69 706e 613d 736b         skipna=sk
+00013300: 6970 6e61 2c0a 2020 2020 2020 2020 2020  ipna,.          
+00013310: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
+00013320: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
+00013330: 2020 2020 2020 206f 7574 3d6f 7574 2c0a         out=out,.
+00013340: 2020 2020 2020 2020 2020 2020 6e75 6d65              nume
+00013350: 7269 635f 6f6e 6c79 3d6e 756d 6572 6963  ric_only=numeric
+00013360: 5f6f 6e6c 792c 0a20 2020 2020 2020 2029  _only,.        )
+00013370: 0a20 2020 2020 2020 2069 6620 6d69 6e5f  .        if min_
+00013380: 636f 756e 743a 0a20 2020 2020 2020 2020  count:.         
+00013390: 2020 2063 6f6e 6420 3d20 7365 6c66 2e6e     cond = self.n
+000133a0: 6f74 6e75 6c6c 2829 2e73 756d 2861 7869  otnull().sum(axi
+000133b0: 733d 6178 6973 2920 3e3d 206d 696e 5f63  s=axis) >= min_c
+000133c0: 6f75 6e74 0a20 2020 2020 2020 2020 2020  ount.           
+000133d0: 2069 6620 6973 5f73 6572 6965 735f 6c69   if is_series_li
+000133e0: 6b65 2863 6f6e 6429 3a0a 2020 2020 2020  ke(cond):.      
+000133f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00013400: 2072 6573 756c 742e 7768 6572 6528 636f   result.where(co
+00013410: 6e64 2c20 6f74 6865 723d 6e70 2e4e 614e  nd, other=np.NaN
+00013420: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00013430: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00013440: 2020 2020 7265 7475 726e 205f 7363 616c      return _scal
+00013450: 6172 5f62 696e 6172 7928 0a20 2020 2020  ar_binary(.     
+00013460: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00013470: 616d 6264 6120 782c 2079 3a20 7265 7375  ambda x, y: resu
+00013480: 6c74 2069 6620 7820 6973 2079 2065 6c73  lt if x is y els
+00013490: 6520 6e70 2e4e 614e 2c20 636f 6e64 2c20  e np.NaN, cond, 
+000134a0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+000134b0: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+000134c0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000134d0: 2072 6574 7572 6e20 7265 7375 6c74 0a0a   return result..
+000134e0: 2020 2020 7072 6f64 7563 7420 3d20 7072      product = pr
+000134f0: 6f64 2020 2320 616c 6961 7365 6420 6464  od  # aliased dd
+00013500: 2e70 726f 6475 6374 0a0a 2020 2020 4064  .product..    @d
+00013510: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+00013520: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+00013530: 6620 6d61 7828 7365 6c66 2c20 6178 6973  f max(self, axis
+00013540: 3d30 2c20 736b 6970 6e61 3d54 7275 652c  =0, skipna=True,
+00013550: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
+00013560: 7365 2c20 6f75 743d 4e6f 6e65 2c20 6e75  se, out=None, nu
+00013570: 6d65 7269 635f 6f6e 6c79 3d4e 6f6e 6529  meric_only=None)
+00013580: 3a0a 2020 2020 2020 2020 6966 2028 0a20  :.        if (. 
+00013590: 2020 2020 2020 2020 2020 2050 414e 4441             PANDA
+000135a0: 535f 4754 5f31 3430 0a20 2020 2020 2020  S_GT_140.       
+000135b0: 2020 2020 2061 6e64 206e 6f74 2050 414e       and not PAN
+000135c0: 4441 535f 4754 5f32 3030 0a20 2020 2020  DAS_GT_200.     
+000135d0: 2020 2020 2020 2061 6e64 2061 7869 7320         and axis 
+000135e0: 6973 204e 6f6e 650a 2020 2020 2020 2020  is None.        
+000135f0: 2020 2020 616e 6420 6973 696e 7374 616e      and isinstan
+00013600: 6365 2873 656c 662c 2044 6174 6146 7261  ce(self, DataFra
+00013610: 6d65 290a 2020 2020 2020 2020 293a 0a20  me).        ):. 
+00013620: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
+00013630: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
+00013640: 2020 2020 2020 2020 2020 2249 6e20 6120            "In a 
+00013650: 6675 7475 7265 2076 6572 7369 6f6e 2c20  future version, 
+00013660: 4461 7461 4672 616d 652e 6d61 7828 6178  DataFrame.max(ax
+00013670: 6973 3d4e 6f6e 6529 2077 696c 6c20 7265  is=None) will re
+00013680: 7475 726e 2061 2073 6361 6c61 7220 6d61  turn a scalar ma
+00013690: 7820 6f76 6572 2074 6865 2065 6e74 6972  x over the entir
+000136a0: 6520 4461 7461 4672 616d 652e 2022 0a20  e DataFrame. ". 
+000136b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000136c0: 546f 2072 6574 6169 6e20 7468 6520 6f6c  To retain the ol
+000136d0: 6420 6265 6861 7669 6f72 2c20 7573 6520  d behavior, use 
+000136e0: 2766 7261 6d65 2e6d 6178 2861 7869 733d  'frame.max(axis=
+000136f0: 3029 2720 6f72 206a 7573 7420 2766 7261  0)' or just 'fra
+00013700: 6d65 2e6d 6178 2829 2722 2c0a 2020 2020  me.max()'",.    
+00013710: 2020 2020 2020 2020 2020 2020 4675 7475              Futu
+00013720: 7265 5761 726e 696e 672c 0a20 2020 2020  reWarning,.     
+00013730: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00013740: 2020 2020 2061 7869 7320 3d20 300a 0a20       axis = 0.. 
+00013750: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00013760: 6c66 2e5f 7265 6475 6374 696f 6e5f 6167  lf._reduction_ag
+00013770: 6728 0a20 2020 2020 2020 2020 2020 2022  g(.            "
+00013780: 6d61 7822 2c0a 2020 2020 2020 2020 2020  max",.          
+00013790: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
+000137a0: 2020 2020 2020 2020 2073 6b69 706e 613d           skipna=
+000137b0: 736b 6970 6e61 2c0a 2020 2020 2020 2020  skipna,.        
+000137c0: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
+000137d0: 7370 6c69 745f 6576 6572 792c 0a20 2020  split_every,.   
+000137e0: 2020 2020 2020 2020 206f 7574 3d6f 7574           out=out
+000137f0: 2c0a 2020 2020 2020 2020 2020 2020 2320  ,.            # 
+00013800: 5374 6172 7469 6e67 2069 6e20 7061 6e64  Starting in pand
+00013810: 6173 2032 2e30 2c20 6061 7869 733d 4e6f  as 2.0, `axis=No
+00013820: 6e65 6020 646f 6573 2061 2066 756c 6c20  ne` does a full 
+00013830: 6167 6772 6567 6174 696f 6e20 6163 726f  aggregation acro
+00013840: 7373 2062 6f74 6820 6178 6573 0a20 2020  ss both axes.   
+00013850: 2020 2020 2020 2020 206e 6f6e 655f 6973           none_is
+00013860: 5f7a 6572 6f3d 6e6f 7420 5041 4e44 4153  _zero=not PANDAS
+00013870: 5f47 545f 3230 302c 0a20 2020 2020 2020  _GT_200,.       
+00013880: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
+00013890: 793d 6e75 6d65 7269 635f 6f6e 6c79 2c0a  y=numeric_only,.
+000138a0: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
+000138b0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+000138c0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+000138d0: 6566 206d 696e 2873 656c 662c 2061 7869  ef min(self, axi
+000138e0: 733d 302c 2073 6b69 706e 613d 5472 7565  s=0, skipna=True
+000138f0: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
+00013900: 6c73 652c 206f 7574 3d4e 6f6e 652c 206e  lse, out=None, n
+00013910: 756d 6572 6963 5f6f 6e6c 793d 4e6f 6e65  umeric_only=None
+00013920: 293a 0a20 2020 2020 2020 2069 6620 280a  ):.        if (.
+00013930: 2020 2020 2020 2020 2020 2020 5041 4e44              PAND
+00013940: 4153 5f47 545f 3134 300a 2020 2020 2020  AS_GT_140.      
+00013950: 2020 2020 2020 616e 6420 6e6f 7420 5041        and not PA
+00013960: 4e44 4153 5f47 545f 3230 300a 2020 2020  NDAS_GT_200.    
+00013970: 2020 2020 2020 2020 616e 6420 6178 6973          and axis
+00013980: 2069 7320 4e6f 6e65 0a20 2020 2020 2020   is None.       
+00013990: 2020 2020 2061 6e64 2069 7369 6e73 7461       and isinsta
+000139a0: 6e63 6528 7365 6c66 2c20 4461 7461 4672  nce(self, DataFr
+000139b0: 616d 6529 0a20 2020 2020 2020 2029 3a0a  ame).        ):.
+000139c0: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+000139d0: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
+000139e0: 2020 2020 2020 2020 2020 2022 496e 2061             "In a
+000139f0: 2066 7574 7572 6520 7665 7273 696f 6e2c   future version,
+00013a00: 2044 6174 6146 7261 6d65 2e6d 696e 2861   DataFrame.min(a
+00013a10: 7869 733d 4e6f 6e65 2920 7769 6c6c 2072  xis=None) will r
+00013a20: 6574 7572 6e20 6120 7363 616c 6172 206d  eturn a scalar m
+00013a30: 696e 206f 7665 7220 7468 6520 656e 7469  in over the enti
+00013a40: 7265 2044 6174 6146 7261 6d65 2e20 220a  re DataFrame. ".
+00013a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013a60: 2254 6f20 7265 7461 696e 2074 6865 206f  "To retain the o
+00013a70: 6c64 2062 6568 6176 696f 722c 2075 7365  ld behavior, use
+00013a80: 2027 6672 616d 652e 6d69 6e28 6178 6973   'frame.min(axis
+00013a90: 3d30 2927 206f 7220 6a75 7374 2027 6672  =0)' or just 'fr
+00013aa0: 616d 652e 6d69 6e28 2927 222c 0a20 2020  ame.min()'",.   
+00013ab0: 2020 2020 2020 2020 2020 2020 2046 7574               Fut
+00013ac0: 7572 6557 6172 6e69 6e67 2c0a 2020 2020  ureWarning,.    
+00013ad0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00013ae0: 2020 2020 2020 6178 6973 203d 2030 0a0a        axis = 0..
+00013af0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00013b00: 656c 662e 5f72 6564 7563 7469 6f6e 5f61  elf._reduction_a
+00013b10: 6767 280a 2020 2020 2020 2020 2020 2020  gg(.            
+00013b20: 226d 696e 222c 0a20 2020 2020 2020 2020  "min",.         
+00013b30: 2020 2061 7869 733d 6178 6973 2c0a 2020     axis=axis,.  
+00013b40: 2020 2020 2020 2020 2020 736b 6970 6e61            skipna
+00013b50: 3d73 6b69 706e 612c 0a20 2020 2020 2020  =skipna,.       
+00013b60: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
+00013b70: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
+00013b80: 2020 2020 2020 2020 2020 6f75 743d 6f75            out=ou
+00013b90: 742c 0a20 2020 2020 2020 2020 2020 2023  t,.            #
+00013ba0: 2053 7461 7274 696e 6720 696e 2070 616e   Starting in pan
+00013bb0: 6461 7320 322e 302c 2060 6178 6973 3d4e  das 2.0, `axis=N
+00013bc0: 6f6e 6560 2064 6f65 7320 6120 6675 6c6c  one` does a full
+00013bd0: 2061 6767 7265 6761 7469 6f6e 2061 6372   aggregation acr
+00013be0: 6f73 7320 626f 7468 2061 7865 730a 2020  oss both axes.  
+00013bf0: 2020 2020 2020 2020 2020 6e6f 6e65 5f69            none_i
+00013c00: 735f 7a65 726f 3d6e 6f74 2050 414e 4441  s_zero=not PANDA
+00013c10: 535f 4754 5f32 3030 2c0a 2020 2020 2020  S_GT_200,.      
+00013c20: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
+00013c30: 6c79 3d6e 756d 6572 6963 5f6f 6e6c 792c  ly=numeric_only,
+00013c40: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00013c50: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00013c60: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+00013c70: 6465 6620 6964 786d 6178 280a 2020 2020  def idxmax(.    
+00013c80: 2020 2020 7365 6c66 2c20 6178 6973 3d4e      self, axis=N
+00013c90: 6f6e 652c 2073 6b69 706e 613d 5472 7565  one, skipna=True
+00013ca0: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
+00013cb0: 6c73 652c 206e 756d 6572 6963 5f6f 6e6c  lse, numeric_onl
+00013cc0: 793d 6e6f 5f64 6566 6175 6c74 0a20 2020  y=no_default.   
+00013cd0: 2029 3a0a 2020 2020 2020 2020 666e 203d   ):.        fn =
+00013ce0: 2022 6964 786d 6178 220a 2020 2020 2020   "idxmax".      
+00013cf0: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
+00013d00: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
+00013d10: 7329 0a20 2020 2020 2020 206e 756d 6572  s).        numer
+00013d20: 6963 5f6f 6e6c 795f 6b77 6172 6773 203d  ic_only_kwargs =
+00013d30: 2063 6865 636b 5f6e 756d 6572 6963 5f6f   check_numeric_o
+00013d40: 6e6c 795f 7661 6c69 6428 6e75 6d65 7269  nly_valid(numeri
+00013d50: 635f 6f6e 6c79 2c20 2269 6478 6d61 7822  c_only, "idxmax"
+00013d60: 290a 2020 2020 2020 2020 6d65 7461 203d  ).        meta =
+00013d70: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
+00013d80: 6d70 7479 2e69 6478 6d61 7828 0a20 2020  mpty.idxmax(.   
+00013d90: 2020 2020 2020 2020 2061 7869 733d 6178           axis=ax
+00013da0: 6973 2c20 736b 6970 6e61 3d73 6b69 706e  is, skipna=skipn
+00013db0: 612c 202a 2a6e 756d 6572 6963 5f6f 6e6c  a, **numeric_onl
+00013dc0: 795f 6b77 6172 6773 0a20 2020 2020 2020  y_kwargs.       
+00013dd0: 2029 0a20 2020 2020 2020 2069 6620 6178   ).        if ax
+00013de0: 6973 203d 3d20 313a 0a20 2020 2020 2020  is == 1:.       
+00013df0: 2020 2020 2072 6574 7572 6e20 6d61 705f       return map_
+00013e00: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+00013e10: 2020 2020 2020 2020 2020 2020 4d2e 6964              M.id
+00013e20: 786d 6178 2c0a 2020 2020 2020 2020 2020  xmax,.          
+00013e30: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00013e40: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+00013e50: 3d6d 6574 612c 0a20 2020 2020 2020 2020  =meta,.         
+00013e60: 2020 2020 2020 2074 6f6b 656e 3d73 656c         token=sel
+00013e70: 662e 5f74 6f6b 656e 5f70 7265 6669 7820  f._token_prefix 
+00013e80: 2b20 666e 2c0a 2020 2020 2020 2020 2020  + fn,.          
+00013e90: 2020 2020 2020 736b 6970 6e61 3d73 6b69        skipna=ski
+00013ea0: 706e 612c 0a20 2020 2020 2020 2020 2020  pna,.           
+00013eb0: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
+00013ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ed0: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+00013ee0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00013ef0: 2020 2020 2020 2020 2a2a 6e75 6d65 7269          **numeri
+00013f00: 635f 6f6e 6c79 5f6b 7761 7267 732c 0a20  c_only_kwargs,. 
+00013f10: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00013f20: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00013f30: 2020 2020 2020 2073 6361 6c61 7220 3d20         scalar = 
+00013f40: 6e6f 7420 6973 5f73 6572 6965 735f 6c69  not is_series_li
+00013f50: 6b65 286d 6574 6129 0a20 2020 2020 2020  ke(meta).       
+00013f60: 2020 2020 2072 6573 756c 7420 3d20 6163       result = ac
+00013f70: 6128 0a20 2020 2020 2020 2020 2020 2020  a(.             
+00013f80: 2020 205b 7365 6c66 5d2c 0a20 2020 2020     [self],.     
+00013f90: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
+00013fa0: 3d69 6478 6d61 786d 696e 5f63 6875 6e6b  =idxmaxmin_chunk
+00013fb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00013fc0: 2020 6167 6772 6567 6174 653d 6964 786d    aggregate=idxm
+00013fd0: 6178 6d69 6e5f 6167 672c 0a20 2020 2020  axmin_agg,.     
+00013fe0: 2020 2020 2020 2020 2020 2063 6f6d 6269             combi
+00013ff0: 6e65 3d69 6478 6d61 786d 696e 5f63 6f6d  ne=idxmaxmin_com
+00014000: 6269 6e65 2c0a 2020 2020 2020 2020 2020  bine,.          
+00014010: 2020 2020 2020 6d65 7461 3d6d 6574 612c        meta=meta,
 00014020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014030: 2066 6e3d 666e 2c0a 2020 2020 2020 2020   fn=fn,.        
-00014040: 2020 2020 2020 2020 2a2a 6e75 6d65 7269          **numeri
-00014050: 635f 6f6e 6c79 5f6b 7761 7267 732c 0a20  c_only_kwargs,. 
-00014060: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00014070: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-00014080: 7374 616e 6365 2873 656c 662c 2044 6174  stance(self, Dat
-00014090: 6146 7261 6d65 293a 0a20 2020 2020 2020  aFrame):.       
-000140a0: 2020 2020 2020 2020 2072 6573 756c 742e           result.
-000140b0: 6469 7669 7369 6f6e 7320 3d20 286d 696e  divisions = (min
-000140c0: 2873 656c 662e 636f 6c75 6d6e 7329 2c20  (self.columns), 
-000140d0: 6d61 7828 7365 6c66 2e63 6f6c 756d 6e73  max(self.columns
-000140e0: 2929 0a20 2020 2020 2020 2020 2020 2072  )).            r
-000140f0: 6574 7572 6e20 7265 7375 6c74 0a0a 2020  eturn result..  
-00014100: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00014110: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-00014120: 2020 6465 6620 6964 786d 696e 280a 2020    def idxmin(.  
-00014130: 2020 2020 2020 7365 6c66 2c20 6178 6973        self, axis
-00014140: 3d4e 6f6e 652c 2073 6b69 706e 613d 5472  =None, skipna=Tr
-00014150: 7565 2c20 7370 6c69 745f 6576 6572 793d  ue, split_every=
-00014160: 4661 6c73 652c 206e 756d 6572 6963 5f6f  False, numeric_o
-00014170: 6e6c 793d 6e6f 5f64 6566 6175 6c74 0a20  nly=no_default. 
-00014180: 2020 2029 3a0a 2020 2020 2020 2020 666e     ):.        fn
-00014190: 203d 2022 6964 786d 696e 220a 2020 2020   = "idxmin".    
-000141a0: 2020 2020 6178 6973 203d 2073 656c 662e      axis = self.
-000141b0: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
-000141c0: 7869 7329 0a20 2020 2020 2020 206e 756d  xis).        num
-000141d0: 6572 6963 5f6f 6e6c 795f 6b77 6172 6773  eric_only_kwargs
-000141e0: 203d 2063 6865 636b 5f6e 756d 6572 6963   = check_numeric
-000141f0: 5f6f 6e6c 795f 7661 6c69 6428 6e75 6d65  _only_valid(nume
-00014200: 7269 635f 6f6e 6c79 2c20 2269 6478 6d61  ric_only, "idxma
-00014210: 7822 290a 2020 2020 2020 2020 6d65 7461  x").        meta
-00014220: 203d 2073 656c 662e 5f6d 6574 615f 6e6f   = self._meta_no
-00014230: 6e65 6d70 7479 2e69 6478 6d61 7828 0a20  nempty.idxmax(. 
-00014240: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-00014250: 6178 6973 2c20 736b 6970 6e61 3d73 6b69  axis, skipna=ski
-00014260: 706e 612c 202a 2a6e 756d 6572 6963 5f6f  pna, **numeric_o
-00014270: 6e6c 795f 6b77 6172 6773 0a20 2020 2020  nly_kwargs.     
-00014280: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
-00014290: 6178 6973 203d 3d20 313a 0a20 2020 2020  axis == 1:.     
-000142a0: 2020 2020 2020 2072 6574 7572 6e20 6d61         return ma
-000142b0: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
-000142c0: 2020 2020 2020 2020 2020 2020 2020 4d2e                M.
-000142d0: 6964 786d 696e 2c0a 2020 2020 2020 2020  idxmin,.        
-000142e0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000142f0: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-00014300: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
-00014310: 2020 2020 2020 2020 2074 6f6b 656e 3d73           token=s
-00014320: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
-00014330: 7820 2b20 666e 2c0a 2020 2020 2020 2020  x + fn,.        
-00014340: 2020 2020 2020 2020 736b 6970 6e61 3d73          skipna=s
-00014350: 6b69 706e 612c 0a20 2020 2020 2020 2020  kipna,.         
-00014360: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
-00014370: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00014380: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
-00014390: 7461 3d46 616c 7365 2c0a 2020 2020 2020  ta=False,.      
-000143a0: 2020 2020 2020 2020 2020 2a2a 6e75 6d65            **nume
-000143b0: 7269 635f 6f6e 6c79 5f6b 7761 7267 732c  ric_only_kwargs,
-000143c0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-000143d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000143e0: 2020 2020 2020 2020 2073 6361 6c61 7220           scalar 
-000143f0: 3d20 6e6f 7420 6973 5f73 6572 6965 735f  = not is_series_
-00014400: 6c69 6b65 286d 6574 6129 0a20 2020 2020  like(meta).     
-00014410: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-00014420: 6163 6128 0a20 2020 2020 2020 2020 2020  aca(.           
-00014430: 2020 2020 205b 7365 6c66 5d2c 0a20 2020       [self],.   
-00014440: 2020 2020 2020 2020 2020 2020 2063 6875               chu
-00014450: 6e6b 3d69 6478 6d61 786d 696e 5f63 6875  nk=idxmaxmin_chu
-00014460: 6e6b 2c0a 2020 2020 2020 2020 2020 2020  nk,.            
-00014470: 2020 2020 6167 6772 6567 6174 653d 6964      aggregate=id
-00014480: 786d 6178 6d69 6e5f 6167 672c 0a20 2020  xmaxmin_agg,.   
-00014490: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-000144a0: 6269 6e65 3d69 6478 6d61 786d 696e 5f63  bine=idxmaxmin_c
-000144b0: 6f6d 6269 6e65 2c0a 2020 2020 2020 2020  ombine,.        
-000144c0: 2020 2020 2020 2020 6d65 7461 3d6d 6574          meta=met
-000144d0: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
-000144e0: 2020 2061 6767 7265 6761 7465 5f6b 7761     aggregate_kwa
-000144f0: 7267 733d 7b22 7363 616c 6172 223a 2073  rgs={"scalar": s
-00014500: 6361 6c61 727d 2c0a 2020 2020 2020 2020  calar},.        
-00014510: 2020 2020 2020 2020 746f 6b65 6e3d 7365          token=se
-00014520: 6c66 2e5f 746f 6b65 6e5f 7072 6566 6978  lf._token_prefix
-00014530: 202b 2066 6e2c 0a20 2020 2020 2020 2020   + fn,.         
-00014540: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-00014550: 7279 3d73 706c 6974 5f65 7665 7279 2c0a  ry=split_every,.
-00014560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014570: 736b 6970 6e61 3d73 6b69 706e 612c 0a20  skipna=skipna,. 
-00014580: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00014590: 6e3d 666e 2c0a 2020 2020 2020 2020 2020  n=fn,.          
-000145a0: 2020 2020 2020 2a2a 6e75 6d65 7269 635f        **numeric_
-000145b0: 6f6e 6c79 5f6b 7761 7267 732c 0a20 2020  only_kwargs,.   
-000145c0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-000145d0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-000145e0: 616e 6365 2873 656c 662c 2044 6174 6146  ance(self, DataF
-000145f0: 7261 6d65 293a 0a20 2020 2020 2020 2020  rame):.         
-00014600: 2020 2020 2020 2072 6573 756c 742e 6469         result.di
-00014610: 7669 7369 6f6e 7320 3d20 286d 696e 2873  visions = (min(s
-00014620: 656c 662e 636f 6c75 6d6e 7329 2c20 6d61  elf.columns), ma
-00014630: 7828 7365 6c66 2e63 6f6c 756d 6e73 2929  x(self.columns))
-00014640: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00014650: 7572 6e20 7265 7375 6c74 0a0a 2020 2020  urn result..    
-00014660: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-00014670: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
-00014680: 6465 6620 636f 756e 7428 7365 6c66 2c20  def count(self, 
-00014690: 6178 6973 3d4e 6f6e 652c 2073 706c 6974  axis=None, split
-000146a0: 5f65 7665 7279 3d46 616c 7365 2c20 6e75  _every=False, nu
-000146b0: 6d65 7269 635f 6f6e 6c79 3d46 616c 7365  meric_only=False
-000146c0: 293a 0a20 2020 2020 2020 2023 2054 6869  ):.        # Thi
-000146d0: 7320 6d65 7468 6f64 2069 7320 7368 6172  s method is shar
-000146e0: 6564 2062 7920 4461 7461 4672 616d 6520  ed by DataFrame 
-000146f0: 2f20 5365 7269 6573 2c20 6275 7420 6f6e  / Series, but on
-00014700: 6c79 2044 6174 6146 7261 6d65 0a20 2020  ly DataFrame.   
-00014710: 2020 2020 2023 2073 7570 706f 7274 7320       # supports 
-00014720: 606e 756d 6572 6963 5f6f 6e6c 793d 602e  `numeric_only=`.
-00014730: 2048 616e 646c 6520 6163 636f 7264 696e   Handle accordin
-00014740: 676c 7920 6865 7265 2e0a 2020 2020 2020  gly here..      
-00014750: 2020 6e75 6d65 7269 635f 6f6e 6c79 5f6b    numeric_only_k
-00014760: 7761 7267 7320 3d20 7b7d 0a20 2020 2020  wargs = {}.     
-00014770: 2020 2069 6620 6973 5f64 6174 6166 7261     if is_datafra
-00014780: 6d65 5f6c 696b 6528 7365 6c66 293a 0a20  me_like(self):. 
-00014790: 2020 2020 2020 2020 2020 206e 756d 6572             numer
-000147a0: 6963 5f6f 6e6c 795f 6b77 6172 6773 203d  ic_only_kwargs =
-000147b0: 2067 6574 5f6e 756d 6572 6963 5f6f 6e6c   get_numeric_onl
-000147c0: 795f 6b77 6172 6773 286e 756d 6572 6963  y_kwargs(numeric
-000147d0: 5f6f 6e6c 7929 0a20 2020 2020 2020 2061  _only).        a
-000147e0: 7869 7320 3d20 7365 6c66 2e5f 7661 6c69  xis = self._vali
-000147f0: 6461 7465 5f61 7869 7328 6178 6973 290a  date_axis(axis).
-00014800: 2020 2020 2020 2020 746f 6b65 6e20 3d20          token = 
-00014810: 7365 6c66 2e5f 746f 6b65 6e5f 7072 6566  self._token_pref
-00014820: 6978 202b 2022 636f 756e 7422 0a20 2020  ix + "count".   
-00014830: 2020 2020 2069 6620 6178 6973 203d 3d20       if axis == 
-00014840: 313a 0a20 2020 2020 2020 2020 2020 206d  1:.            m
-00014850: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
-00014860: 5f6e 6f6e 656d 7074 792e 636f 756e 7428  _nonempty.count(
-00014870: 6178 6973 3d61 7869 732c 202a 2a6e 756d  axis=axis, **num
-00014880: 6572 6963 5f6f 6e6c 795f 6b77 6172 6773  eric_only_kwargs
-00014890: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-000148a0: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
-000148b0: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-000148c0: 2020 2020 2020 2020 2020 4d2e 636f 756e            M.coun
-000148d0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-000148e0: 2020 206d 6574 613d 6d65 7461 2c0a 2020     meta=meta,.  
-000148f0: 2020 2020 2020 2020 2020 2020 2020 746f                to
-00014900: 6b65 6e3d 746f 6b65 6e2c 0a20 2020 2020  ken=token,.     
-00014910: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-00014920: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
-00014930: 2020 2020 2020 656e 666f 7263 655f 6d65        enforce_me
-00014940: 7461 6461 7461 3d46 616c 7365 2c0a 2020  tadata=False,.  
-00014950: 2020 2020 2020 2020 2020 2020 2020 2a2a                **
-00014960: 6e75 6d65 7269 635f 6f6e 6c79 5f6b 7761  numeric_only_kwa
-00014970: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
-00014980: 2029 0a20 2020 2020 2020 2065 6c73 653a   ).        else:
-00014990: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-000149a0: 6120 3d20 7365 6c66 2e5f 6d65 7461 5f6e  a = self._meta_n
-000149b0: 6f6e 656d 7074 792e 636f 756e 7428 290a  onempty.count().
-000149c0: 0a20 2020 2020 2020 2020 2020 2023 204e  .            # N
-000149d0: 6565 6420 7468 6520 6173 7479 7065 2869  eed the astype(i
-000149e0: 6e74 2920 666f 7220 656d 7074 7920 6461  nt) for empty da
-000149f0: 7461 6672 616d 6573 2c20 7768 6963 6820  taframes, which 
-00014a00: 7375 6d20 746f 2066 6c6f 6174 2064 7479  sum to float dty
-00014a10: 7065 0a20 2020 2020 2020 2020 2020 2072  pe.            r
-00014a20: 6573 756c 7420 3d20 7365 6c66 2e72 6564  esult = self.red
-00014a30: 7563 7469 6f6e 280a 2020 2020 2020 2020  uction(.        
-00014a40: 2020 2020 2020 2020 4d2e 636f 756e 742c          M.count,
-00014a50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014a60: 2061 6767 7265 6761 7465 3d5f 636f 756e   aggregate=_coun
-00014a70: 745f 6167 6772 6567 6174 652c 0a20 2020  t_aggregate,.   
-00014a80: 2020 2020 2020 2020 2020 2020 206d 6574               met
-00014a90: 613d 6d65 7461 2c0a 2020 2020 2020 2020  a=meta,.        
-00014aa0: 2020 2020 2020 2020 746f 6b65 6e3d 746f          token=to
-00014ab0: 6b65 6e2c 0a20 2020 2020 2020 2020 2020  ken,.           
-00014ac0: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
-00014ad0: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
-00014ae0: 2020 2020 2020 2020 2020 2020 2020 6368                ch
-00014af0: 756e 6b5f 6b77 6172 6773 3d6e 756d 6572  unk_kwargs=numer
-00014b00: 6963 5f6f 6e6c 795f 6b77 6172 6773 2c0a  ic_only_kwargs,.
-00014b10: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00014b20: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-00014b30: 6e73 7461 6e63 6528 7365 6c66 2c20 4461  nstance(self, Da
-00014b40: 7461 4672 616d 6529 3a0a 2020 2020 2020  taFrame):.      
-00014b50: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00014b60: 2e64 6976 6973 696f 6e73 203d 2028 7365  .divisions = (se
-00014b70: 6c66 2e63 6f6c 756d 6e73 2e6d 696e 2829  lf.columns.min()
-00014b80: 2c20 7365 6c66 2e63 6f6c 756d 6e73 2e6d  , self.columns.m
-00014b90: 6178 2829 290a 2020 2020 2020 2020 2020  ax()).          
-00014ba0: 2020 7265 7475 726e 2072 6573 756c 740a    return result.
-00014bb0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00014bc0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-00014bd0: 0a20 2020 2064 6566 206d 6f64 6528 7365  .    def mode(se
-00014be0: 6c66 2c20 6472 6f70 6e61 3d54 7275 652c  lf, dropna=True,
-00014bf0: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-00014c00: 7365 293a 0a20 2020 2020 2020 206d 6f64  se):.        mod
-00014c10: 655f 7365 7269 6573 203d 2073 656c 662e  e_series = self.
-00014c20: 7265 6475 6374 696f 6e28 0a20 2020 2020  reduction(.     
-00014c30: 2020 2020 2020 2063 6875 6e6b 3d4d 2e76         chunk=M.v
-00014c40: 616c 7565 5f63 6f75 6e74 732c 0a20 2020  alue_counts,.   
-00014c50: 2020 2020 2020 2020 2063 6f6d 6269 6e65           combine
-00014c60: 3d4d 2e73 756d 2c0a 2020 2020 2020 2020  =M.sum,.        
-00014c70: 2020 2020 6167 6772 6567 6174 653d 5f6d      aggregate=_m
-00014c80: 6f64 655f 6167 6772 6567 6174 652c 0a20  ode_aggregate,. 
-00014c90: 2020 2020 2020 2020 2020 2073 706c 6974             split
-00014ca0: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-00014cb0: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
-00014cc0: 6368 756e 6b5f 6b77 6172 6773 3d7b 2264  chunk_kwargs={"d
-00014cd0: 726f 706e 6122 3a20 6472 6f70 6e61 7d2c  ropna": dropna},
-00014ce0: 0a20 2020 2020 2020 2020 2020 2061 6767  .            agg
-00014cf0: 7265 6761 7465 5f6b 7761 7267 733d 7b22  regate_kwargs={"
-00014d00: 6472 6f70 6e61 223a 2064 726f 706e 617d  dropna": dropna}
-00014d10: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00014d20: 2020 2020 6d6f 6465 5f73 6572 6965 732e      mode_series.
-00014d30: 6e61 6d65 203d 2073 656c 662e 6e61 6d65  name = self.name
-00014d40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00014d50: 6d6f 6465 5f73 6572 6965 730a 0a20 2020  mode_series..   
-00014d60: 2040 5f6e 756d 6572 6963 5f6f 6e6c 790a   @_numeric_only.
-00014d70: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00014d80: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-00014d90: 2020 2020 6465 6620 6d65 616e 280a 2020      def mean(.  
-00014da0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00014db0: 2020 2020 6178 6973 3d30 2c0a 2020 2020      axis=0,.    
-00014dc0: 2020 2020 736b 6970 6e61 3d54 7275 652c      skipna=True,
-00014dd0: 0a20 2020 2020 2020 2073 706c 6974 5f65  .        split_e
-00014de0: 7665 7279 3d46 616c 7365 2c0a 2020 2020  very=False,.    
-00014df0: 2020 2020 6474 7970 653d 4e6f 6e65 2c0a      dtype=None,.
-00014e00: 2020 2020 2020 2020 6f75 743d 4e6f 6e65          out=None
-00014e10: 2c0a 2020 2020 2020 2020 6e75 6d65 7269  ,.        numeri
-00014e20: 635f 6f6e 6c79 3d4e 6f6e 652c 0a20 2020  c_only=None,.   
-00014e30: 2029 3a0a 2020 2020 2020 2020 6966 2028   ):.        if (
-00014e40: 0a20 2020 2020 2020 2020 2020 2050 414e  .            PAN
-00014e50: 4441 535f 4754 5f31 3430 0a20 2020 2020  DAS_GT_140.     
-00014e60: 2020 2020 2020 2061 6e64 206e 6f74 2050         and not P
-00014e70: 414e 4441 535f 4754 5f32 3030 0a20 2020  ANDAS_GT_200.   
-00014e80: 2020 2020 2020 2020 2061 6e64 2061 7869           and axi
-00014e90: 7320 6973 204e 6f6e 650a 2020 2020 2020  s is None.      
-00014ea0: 2020 2020 2020 616e 6420 6973 696e 7374        and isinst
-00014eb0: 616e 6365 2873 656c 662c 2044 6174 6146  ance(self, DataF
-00014ec0: 7261 6d65 290a 2020 2020 2020 2020 293a  rame).        ):
-00014ed0: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
-00014ee0: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
-00014ef0: 2020 2020 2020 2020 2020 2020 2249 6e20              "In 
-00014f00: 6120 6675 7475 7265 2076 6572 7369 6f6e  a future version
-00014f10: 2c20 4461 7461 4672 616d 652e 6d65 616e  , DataFrame.mean
-00014f20: 2861 7869 733d 4e6f 6e65 2920 7769 6c6c  (axis=None) will
-00014f30: 2072 6574 7572 6e20 6120 7363 616c 6172   return a scalar
-00014f40: 206d 6561 6e20 6f76 6572 2074 6865 2065   mean over the e
-00014f50: 6e74 6972 6520 4461 7461 4672 616d 652e  ntire DataFrame.
-00014f60: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-00014f70: 2020 2022 546f 2072 6574 6169 6e20 7468     "To retain th
-00014f80: 6520 6f6c 6420 6265 6861 7669 6f72 2c20  e old behavior, 
-00014f90: 7573 6520 2766 7261 6d65 2e6d 6561 6e28  use 'frame.mean(
-00014fa0: 6178 6973 3d30 2927 206f 7220 6a75 7374  axis=0)' or just
-00014fb0: 2027 6672 616d 652e 6d65 616e 2829 2722   'frame.mean()'"
-00014fc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00014fd0: 2020 4675 7475 7265 5761 726e 696e 672c    FutureWarning,
-00014fe0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00014ff0: 2020 2020 2020 2061 7869 7320 3d20 7365         axis = se
-00015000: 6c66 2e5f 7661 6c69 6461 7465 5f61 7869  lf._validate_axi
-00015010: 7328 6178 6973 2c20 6e6f 6e65 5f69 735f  s(axis, none_is_
-00015020: 7a65 726f 3d6e 6f74 2050 414e 4441 535f  zero=not PANDAS_
-00015030: 4754 5f32 3030 290a 2020 2020 2020 2020  GT_200).        
-00015040: 5f72 6169 7365 5f69 665f 6f62 6a65 6374  _raise_if_object
-00015050: 5f73 6572 6965 7328 7365 6c66 2c20 226d  _series(self, "m
-00015060: 6561 6e22 290a 2020 2020 2020 2020 2320  ean").        # 
-00015070: 4e4f 5445 3a20 446f 2077 6520 7761 6e74  NOTE: Do we want
-00015080: 2074 6f20 7761 726e 2068 6572 653f 0a20   to warn here?. 
-00015090: 2020 2020 2020 2077 6974 6820 6368 6563         with chec
-000150a0: 6b5f 6e75 6d65 7269 635f 6f6e 6c79 5f64  k_numeric_only_d
-000150b0: 6570 7265 6361 7469 6f6e 2829 2c20 6368  eprecation(), ch
-000150c0: 6563 6b5f 6e75 6973 616e 6365 5f63 6f6c  eck_nuisance_col
-000150d0: 756d 6e73 5f77 6172 6e69 6e67 2829 3a0a  umns_warning():.
-000150e0: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-000150f0: 203d 2073 656c 662e 5f6d 6574 615f 6e6f   = self._meta_no
-00015100: 6e65 6d70 7479 2e6d 6561 6e28 0a20 2020  nempty.mean(.   
-00015110: 2020 2020 2020 2020 2020 2020 2061 7869               axi
-00015120: 733d 6178 6973 2c20 736b 6970 6e61 3d73  s=axis, skipna=s
-00015130: 6b69 706e 612c 206e 756d 6572 6963 5f6f  kipna, numeric_o
-00015140: 6e6c 793d 6e75 6d65 7269 635f 6f6e 6c79  nly=numeric_only
-00015150: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00015160: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
-00015170: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-00015180: 2072 6573 756c 7420 3d20 6d61 705f 7061   result = map_pa
-00015190: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
-000151a0: 2020 2020 2020 2020 2020 4d2e 6d65 616e            M.mean
-000151b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000151c0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-000151d0: 2020 2020 2020 2020 6d65 7461 3d6d 6574          meta=met
-000151e0: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
-000151f0: 2020 2074 6f6b 656e 3d73 656c 662e 5f74     token=self._t
-00015200: 6f6b 656e 5f70 7265 6669 7820 2b20 226d  oken_prefix + "m
-00015210: 6561 6e22 2c0a 2020 2020 2020 2020 2020  ean",.          
-00015220: 2020 2020 2020 6178 6973 3d61 7869 732c        axis=axis,
-00015230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015240: 2073 6b69 706e 613d 736b 6970 6e61 2c0a   skipna=skipna,.
-00015250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015260: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
-00015270: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00015280: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
-00015290: 6f6e 6c79 3d6e 756d 6572 6963 5f6f 6e6c  only=numeric_onl
-000152a0: 792c 0a20 2020 2020 2020 2020 2020 2029  y,.            )
-000152b0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000152c0: 7572 6e20 6861 6e64 6c65 5f6f 7574 286f  urn handle_out(o
-000152d0: 7574 2c20 7265 7375 6c74 290a 2020 2020  ut, result).    
-000152e0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000152f0: 2020 2020 2020 6e75 6d20 3d20 7365 6c66        num = self
-00015300: 2e5f 6765 745f 6e75 6d65 7269 635f 6461  ._get_numeric_da
-00015310: 7461 2829 0a20 2020 2020 2020 2020 2020  ta().           
-00015320: 2073 203d 206e 756d 2e73 756d 2873 6b69   s = num.sum(ski
-00015330: 706e 613d 736b 6970 6e61 2c20 7370 6c69  pna=skipna, spli
-00015340: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
-00015350: 6572 7929 0a20 2020 2020 2020 2020 2020  ery).           
-00015360: 206e 203d 206e 756d 2e63 6f75 6e74 2873   n = num.count(s
-00015370: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-00015380: 5f65 7665 7279 290a 2020 2020 2020 2020  _every).        
-00015390: 2020 2020 2320 5374 6172 7469 6e67 2069      # Starting i
-000153a0: 6e20 7061 6e64 6173 2032 2e30 2c20 6061  n pandas 2.0, `a
-000153b0: 7869 733d 4e6f 6e65 6020 646f 6573 2061  xis=None` does a
-000153c0: 2066 756c 6c20 6167 6772 6567 6174 696f   full aggregatio
-000153d0: 6e20 6163 726f 7373 2062 6f74 6820 6178  n across both ax
-000153e0: 6573 0a20 2020 2020 2020 2020 2020 2069  es.            i
-000153f0: 6620 5041 4e44 4153 5f47 545f 3230 3020  f PANDAS_GT_200 
-00015400: 616e 6420 6178 6973 2069 7320 4e6f 6e65  and axis is None
-00015410: 2061 6e64 2069 7369 6e73 7461 6e63 6528   and isinstance(
-00015420: 7365 6c66 2c20 4461 7461 4672 616d 6529  self, DataFrame)
-00015430: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00015440: 2020 7265 7375 6c74 203d 2073 2e73 756d    result = s.sum
-00015450: 2829 202f 206e 2e73 756d 2829 0a20 2020  () / n.sum().   
-00015460: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00015470: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00015480: 616d 6520 3d20 7365 6c66 2e5f 746f 6b65  ame = self._toke
-00015490: 6e5f 7072 6566 6978 202b 2022 6d65 616e  n_prefix + "mean
-000154a0: 2d25 7322 2025 2074 6f6b 656e 697a 6528  -%s" % tokenize(
-000154b0: 7365 6c66 2c20 6178 6973 2c20 736b 6970  self, axis, skip
-000154c0: 6e61 290a 2020 2020 2020 2020 2020 2020  na).            
-000154d0: 2020 2020 7265 7375 6c74 203d 206d 6170      result = map
-000154e0: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
-000154f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015500: 206d 6574 686f 6473 2e6d 6561 6e5f 6167   methods.mean_ag
-00015510: 6772 6567 6174 652c 0a20 2020 2020 2020  gregate,.       
-00015520: 2020 2020 2020 2020 2020 2020 2073 2c0a               s,.
-00015530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015540: 2020 2020 6e2c 0a20 2020 2020 2020 2020      n,.         
-00015550: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
-00015560: 3d6e 616d 652c 0a20 2020 2020 2020 2020  =name,.         
-00015570: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
-00015580: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
-00015590: 2020 2020 2020 2020 2020 656e 666f 7263            enforc
-000155a0: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
-000155b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000155c0: 2020 2020 2020 7061 7265 6e74 5f6d 6574        parent_met
-000155d0: 613d 7365 6c66 2e5f 6d65 7461 2c0a 2020  a=self._meta,.  
-000155e0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-000155f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015600: 6966 2069 7369 6e73 7461 6e63 6528 7365  if isinstance(se
-00015610: 6c66 2c20 4461 7461 4672 616d 6529 3a0a  lf, DataFrame):.
-00015620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015630: 2020 2020 7265 7375 6c74 2e64 6976 6973      result.divis
-00015640: 696f 6e73 203d 2028 7365 6c66 2e63 6f6c  ions = (self.col
-00015650: 756d 6e73 2e6d 696e 2829 2c20 7365 6c66  umns.min(), self
-00015660: 2e63 6f6c 756d 6e73 2e6d 6178 2829 290a  .columns.max()).
-00015670: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00015680: 726e 2068 616e 646c 655f 6f75 7428 6f75  rn handle_out(ou
-00015690: 742c 2072 6573 756c 7429 0a0a 2020 2020  t, result)..    
-000156a0: 6465 6620 6d65 6469 616e 5f61 7070 726f  def median_appro
-000156b0: 7869 6d61 7465 280a 2020 2020 2020 2020  ximate(.        
-000156c0: 7365 6c66 2c0a 2020 2020 2020 2020 6178  self,.        ax
-000156d0: 6973 3d4e 6f6e 652c 0a20 2020 2020 2020  is=None,.       
-000156e0: 206d 6574 686f 643d 2264 6566 6175 6c74   method="default
-000156f0: 222c 0a20 2020 2029 3a0a 2020 2020 2020  ",.    ):.      
-00015700: 2020 2222 2252 6574 7572 6e20 7468 6520    """Return the 
-00015710: 6170 7072 6f78 696d 6174 6520 6d65 6469  approximate medi
-00015720: 616e 206f 6620 7468 6520 7661 6c75 6573  an of the values
-00015730: 206f 7665 7220 7468 6520 7265 7175 6573   over the reques
-00015740: 7465 6420 6178 6973 2e0a 0a20 2020 2020  ted axis...     
-00015750: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00015760: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00015770: 0a20 2020 2020 2020 2061 7869 7320 3a20  .        axis : 
-00015780: 7b30 2c20 312c 2022 696e 6465 7822 2c20  {0, 1, "index", 
-00015790: 2263 6f6c 756d 6e73 227d 2028 6465 6661  "columns"} (defa
-000157a0: 756c 7420 3029 0a20 2020 2020 2020 2020  ult 0).         
-000157b0: 2020 2030 206f 7220 6060 2269 6e64 6578     0 or ``"index
-000157c0: 2260 6020 666f 7220 726f 772d 7769 7365  "`` for row-wise
-000157d0: 2c20 3120 6f72 2060 6022 636f 6c75 6d6e  , 1 or ``"column
-000157e0: 7322 6060 2066 6f72 2063 6f6c 756d 6e2d  s"`` for column-
-000157f0: 7769 7365 0a20 2020 2020 2020 206d 6574  wise.        met
-00015800: 686f 6420 3a20 7b27 6465 6661 756c 7427  hod : {'default'
-00015810: 2c20 2774 6469 6765 7374 272c 2027 6461  , 'tdigest', 'da
-00015820: 736b 277d 2c20 6f70 7469 6f6e 616c 0a20  sk'}, optional. 
-00015830: 2020 2020 2020 2020 2020 2057 6861 7420             What 
-00015840: 6d65 7468 6f64 2074 6f20 7573 652e 2042  method to use. B
-00015850: 7920 6465 6661 756c 7420 7769 6c6c 2075  y default will u
-00015860: 7365 2044 6173 6b27 7320 696e 7465 726e  se Dask's intern
-00015870: 616c 2063 7573 746f 6d0a 2020 2020 2020  al custom.      
-00015880: 2020 2020 2020 616c 676f 7269 7468 6d20        algorithm 
-00015890: 2860 6022 6461 736b 2260 6029 2e20 2049  (``"dask"``).  I
-000158a0: 6620 7365 7420 746f 2060 6022 7464 6967  f set to ``"tdig
-000158b0: 6573 7422 6060 2077 696c 6c20 7573 6520  est"`` will use 
-000158c0: 7464 6967 6573 740a 2020 2020 2020 2020  tdigest.        
-000158d0: 2020 2020 666f 7220 666c 6f61 7473 2061      for floats a
-000158e0: 6e64 2069 6e74 7320 616e 6420 6661 6c6c  nd ints and fall
-000158f0: 6261 636b 2074 6f20 7468 6520 6060 2264  back to the ``"d
-00015900: 6173 6b22 6060 206f 7468 6572 7769 7365  ask"`` otherwise
-00015910: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00015920: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00015930: 662e 7175 616e 7469 6c65 2871 3d30 2e35  f.quantile(q=0.5
-00015940: 2c20 6178 6973 3d61 7869 732c 206d 6574  , axis=axis, met
-00015950: 686f 643d 6d65 7468 6f64 292e 7265 6e61  hod=method).rena
-00015960: 6d65 284e 6f6e 6529 0a0a 2020 2020 4064  me(None)..    @d
-00015970: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-00015980: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-00015990: 6620 6d65 6469 616e 2873 656c 662c 2061  f median(self, a
-000159a0: 7869 733d 4e6f 6e65 2c20 6d65 7468 6f64  xis=None, method
-000159b0: 3d22 6465 6661 756c 7422 293a 0a20 2020  ="default"):.   
-000159c0: 2020 2020 2069 6620 6178 6973 2069 6e20       if axis in 
-000159d0: 2831 2c20 2263 6f6c 756d 6e73 2229 206f  (1, "columns") o
-000159e0: 7220 7365 6c66 2e6e 7061 7274 6974 696f  r self.npartitio
-000159f0: 6e73 203d 3d20 313a 0a20 2020 2020 2020  ns == 1:.       
-00015a00: 2020 2020 2023 2043 616e 2070 726f 7669       # Can provi
-00015a10: 6465 2061 6e20 6578 6163 7420 6d65 6469  de an exact medi
-00015a20: 616e 2069 6e20 7468 6573 6520 6361 7365  an in these case
-00015a30: 730a 2020 2020 2020 2020 2020 2020 7265  s.            re
-00015a40: 7475 726e 2073 656c 662e 6d65 6469 616e  turn self.median
-00015a50: 5f61 7070 726f 7869 6d61 7465 2861 7869  _approximate(axi
-00015a60: 733d 6178 6973 2c20 6d65 7468 6f64 3d6d  s=axis, method=m
-00015a70: 6574 686f 6429 0a20 2020 2020 2020 2072  ethod).        r
-00015a80: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
-00015a90: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
-00015aa0: 2020 2020 2020 2244 6173 6b20 646f 6573        "Dask does
-00015ab0: 6e27 7420 696d 706c 656d 656e 7420 616e  n't implement an
-00015ac0: 2065 7861 6374 206d 6564 6961 6e20 696e   exact median in
-00015ad0: 2061 6c6c 2063 6173 6573 2061 7320 7468   all cases as th
-00015ae0: 6973 2069 7320 6861 7264 2074 6f20 646f  is is hard to do
-00015af0: 2069 6e20 7061 7261 6c6c 656c 2e20 220a   in parallel. ".
-00015b00: 2020 2020 2020 2020 2020 2020 2253 6565              "See
-00015b10: 2074 6865 2060 6d65 6469 616e 5f61 7070   the `median_app
-00015b20: 726f 7869 6d61 7465 6020 6d65 7468 6f64  roximate` method
-00015b30: 2069 6e73 7465 6164 2c20 7768 6963 6820   instead, which 
-00015b40: 7573 6573 2061 6e20 6170 7072 6f78 696d  uses an approxim
-00015b50: 6174 6520 616c 676f 7269 7468 6d2e 220a  ate algorithm.".
-00015b60: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-00015b70: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00015b80: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-00015b90: 6566 2076 6172 280a 2020 2020 2020 2020  ef var(.        
-00015ba0: 7365 6c66 2c0a 2020 2020 2020 2020 6178  self,.        ax
-00015bb0: 6973 3d4e 6f6e 652c 0a20 2020 2020 2020  is=None,.       
-00015bc0: 2073 6b69 706e 613d 5472 7565 2c0a 2020   skipna=True,.  
-00015bd0: 2020 2020 2020 6464 6f66 3d31 2c0a 2020        ddof=1,.  
-00015be0: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
-00015bf0: 793d 4661 6c73 652c 0a20 2020 2020 2020  y=False,.       
-00015c00: 2064 7479 7065 3d4e 6f6e 652c 0a20 2020   dtype=None,.   
-00015c10: 2020 2020 206f 7574 3d4e 6f6e 652c 0a20       out=None,. 
-00015c20: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
-00015c30: 6e6c 793d 6e6f 5f64 6566 6175 6c74 2c0a  nly=no_default,.
-00015c40: 2020 2020 293a 0a20 2020 2020 2020 2061      ):.        a
-00015c50: 7869 7320 3d20 7365 6c66 2e5f 7661 6c69  xis = self._vali
-00015c60: 6461 7465 5f61 7869 7328 6178 6973 290a  date_axis(axis).
-00015c70: 2020 2020 2020 2020 5f72 6169 7365 5f69          _raise_i
-00015c80: 665f 6f62 6a65 6374 5f73 6572 6965 7328  f_object_series(
-00015c90: 7365 6c66 2c20 2276 6172 2229 0a20 2020  self, "var").   
-00015ca0: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
-00015cb0: 795f 6b77 6172 6773 203d 2067 6574 5f6e  y_kwargs = get_n
-00015cc0: 756d 6572 6963 5f6f 6e6c 795f 6b77 6172  umeric_only_kwar
-00015cd0: 6773 286e 756d 6572 6963 5f6f 6e6c 7929  gs(numeric_only)
-00015ce0: 0a20 2020 2020 2020 2077 6974 6820 6368  .        with ch
-00015cf0: 6563 6b5f 6e75 6d65 7269 635f 6f6e 6c79  eck_numeric_only
-00015d00: 5f64 6570 7265 6361 7469 6f6e 280a 2020  _deprecation(.  
-00015d10: 2020 2020 2020 2020 2020 2276 6172 222c            "var",
-00015d20: 2054 7275 650a 2020 2020 2020 2020 292c   True.        ),
-00015d30: 2063 6865 636b 5f72 6564 7563 7469 6f6e   check_reduction
-00015d40: 735f 7275 6e74 696d 655f 7761 726e 696e  s_runtime_warnin
-00015d50: 6728 293a 0a20 2020 2020 2020 2020 2020  g():.           
-00015d60: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
-00015d70: 7461 5f6e 6f6e 656d 7074 792e 7661 7228  ta_nonempty.var(
-00015d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015d90: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
-00015da0: 2020 2020 2020 2020 2020 2020 736b 6970              skip
-00015db0: 6e61 3d73 6b69 706e 612c 0a20 2020 2020  na=skipna,.     
-00015dc0: 2020 2020 2020 2020 2020 202a 2a6e 756d             **num
-00015dd0: 6572 6963 5f6f 6e6c 795f 6b77 6172 6773  eric_only_kwargs
-00015de0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00015df0: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
-00015e00: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-00015e10: 2020 7265 7375 6c74 203d 206d 6170 5f70    result = map_p
-00015e20: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-00015e30: 2020 2020 2020 2020 2020 204d 2e76 6172             M.var
-00015e40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00015e50: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00015e60: 2020 2020 2020 2020 6d65 7461 3d6d 6574          meta=met
-00015e70: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
-00015e80: 2020 2074 6f6b 656e 3d73 656c 662e 5f74     token=self._t
-00015e90: 6f6b 656e 5f70 7265 6669 7820 2b20 2276  oken_prefix + "v
-00015ea0: 6172 222c 0a20 2020 2020 2020 2020 2020  ar",.           
-00015eb0: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
-00015ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015ed0: 736b 6970 6e61 3d73 6b69 706e 612c 0a20  skipna=skipna,. 
-00015ee0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00015ef0: 646f 663d 6464 6f66 2c0a 2020 2020 2020  dof=ddof,.      
-00015f00: 2020 2020 2020 2020 2020 656e 666f 7263            enforc
-00015f10: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
-00015f20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00015f30: 2020 2a2a 6e75 6d65 7269 635f 6f6e 6c79    **numeric_only
-00015f40: 5f6b 7761 7267 732c 0a20 2020 2020 2020  _kwargs,.       
-00015f50: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00015f60: 2020 2072 6574 7572 6e20 6861 6e64 6c65     return handle
-00015f70: 5f6f 7574 286f 7574 2c20 7265 7375 6c74  _out(out, result
-00015f80: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00015f90: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00015fa0: 656c 662e 6e64 696d 203d 3d20 313a 0a20  elf.ndim == 1:. 
-00015fb0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00015fc0: 6573 756c 7420 3d20 7365 6c66 2e5f 7661  esult = self._va
-00015fd0: 725f 3164 2873 656c 662c 2073 6b69 706e  r_1d(self, skipn
-00015fe0: 612c 2064 646f 662c 2073 706c 6974 5f65  a, ddof, split_e
-00015ff0: 7665 7279 290a 2020 2020 2020 2020 2020  very).          
-00016000: 2020 2020 2020 7265 7475 726e 2068 616e        return han
-00016010: 646c 655f 6f75 7428 6f75 742c 2072 6573  dle_out(out, res
-00016020: 756c 7429 0a0a 2020 2020 2020 2020 2020  ult)..          
-00016030: 2020 2320 7061 6e64 6173 2031 2e30 2b20    # pandas 1.0+ 
-00016040: 646f 6573 206e 6f74 2069 6d70 6c65 6d65  does not impleme
-00016050: 6e74 2076 6172 206f 6e20 7469 6d65 6465  nt var on timede
-00016060: 6c74 610a 2020 2020 2020 2020 2020 2020  lta.            
-00016070: 7265 7375 6c74 203d 2073 656c 662e 5f76  result = self._v
-00016080: 6172 5f6e 756d 6572 6963 2873 6b69 706e  ar_numeric(skipn
-00016090: 612c 2064 646f 662c 2073 706c 6974 5f65  a, ddof, split_e
-000160a0: 7665 7279 290a 0a20 2020 2020 2020 2020  very)..         
-000160b0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-000160c0: 2873 656c 662c 2044 6174 6146 7261 6d65  (self, DataFrame
-000160d0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000160e0: 2020 2072 6573 756c 742e 6469 7669 7369     result.divisi
-000160f0: 6f6e 7320 3d20 2873 656c 662e 636f 6c75  ons = (self.colu
-00016100: 6d6e 732e 6d69 6e28 292c 2073 656c 662e  mns.min(), self.
-00016110: 636f 6c75 6d6e 732e 6d61 7828 2929 0a20  columns.max()). 
-00016120: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00016130: 6e20 6861 6e64 6c65 5f6f 7574 286f 7574  n handle_out(out
-00016140: 2c20 7265 7375 6c74 290a 0a20 2020 2064  , result)..    d
-00016150: 6566 205f 7661 725f 6e75 6d65 7269 6328  ef _var_numeric(
-00016160: 7365 6c66 2c20 736b 6970 6e61 3d54 7275  self, skipna=Tru
-00016170: 652c 2064 646f 663d 312c 2073 706c 6974  e, ddof=1, split
-00016180: 5f65 7665 7279 3d46 616c 7365 293a 0a20  _every=False):. 
-00016190: 2020 2020 2020 206e 756d 203d 2073 656c         num = sel
-000161a0: 662e 7365 6c65 6374 5f64 7479 7065 7328  f.select_dtypes(
-000161b0: 696e 636c 7564 653d 5b22 6e75 6d62 6572  include=["number
-000161c0: 222c 2022 626f 6f6c 225d 2c20 6578 636c  ", "bool"], excl
-000161d0: 7564 653d 5b6e 702e 7469 6d65 6465 6c74  ude=[np.timedelt
-000161e0: 6136 345d 290a 0a20 2020 2020 2020 2076  a64])..        v
-000161f0: 616c 7565 735f 6474 7970 6520 3d20 6e75  alues_dtype = nu
-00016200: 6d2e 7661 6c75 6573 2e64 7479 7065 0a20  m.values.dtype. 
-00016210: 2020 2020 2020 2061 7272 6179 5f76 616c         array_val
-00016220: 7565 7320 3d20 6e75 6d2e 7661 6c75 6573  ues = num.values
-00016230: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-00016240: 206e 702e 6973 7375 6264 7479 7065 2876   np.issubdtype(v
-00016250: 616c 7565 735f 6474 7970 652c 206e 702e  alues_dtype, np.
-00016260: 6e75 6d62 6572 293a 0a20 2020 2020 2020  number):.       
-00016270: 2020 2020 2061 7272 6179 5f76 616c 7565       array_value
-00016280: 7320 3d20 6e75 6d2e 7661 6c75 6573 2e61  s = num.values.a
-00016290: 7374 7970 6528 2266 3822 290a 0a20 2020  stype("f8")..   
-000162a0: 2020 2020 2076 6172 203d 2064 612e 6e61       var = da.na
-000162b0: 6e76 6172 2069 6620 736b 6970 6e61 206f  nvar if skipna o
-000162c0: 7220 736b 6970 6e61 2069 7320 4e6f 6e65  r skipna is None
-000162d0: 2065 6c73 6520 6461 2e76 6172 0a20 2020   else da.var.   
-000162e0: 2020 2020 2061 7272 6179 5f76 6172 203d       array_var =
-000162f0: 2076 6172 2861 7272 6179 5f76 616c 7565   var(array_value
-00016300: 732c 2061 7869 733d 302c 2064 646f 663d  s, axis=0, ddof=
-00016310: 6464 6f66 2c20 7370 6c69 745f 6576 6572  ddof, split_ever
-00016320: 793d 7370 6c69 745f 6576 6572 7929 0a0a  y=split_every)..
-00016330: 2020 2020 2020 2020 6e61 6d65 203d 2073          name = s
-00016340: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
-00016350: 7820 2b20 2276 6172 2d6e 756d 6572 6963  x + "var-numeric
-00016360: 2220 2b20 746f 6b65 6e69 7a65 286e 756d  " + tokenize(num
-00016370: 2c20 7370 6c69 745f 6576 6572 7929 0a20  , split_every). 
-00016380: 2020 2020 2020 2063 6f6c 7320 3d20 6e75         cols = nu
-00016390: 6d2e 5f6d 6574 612e 636f 6c75 6d6e 7320  m._meta.columns 
-000163a0: 6966 2069 735f 6461 7461 6672 616d 655f  if is_dataframe_
-000163b0: 6c69 6b65 286e 756d 2920 656c 7365 204e  like(num) else N
-000163c0: 6f6e 650a 0a20 2020 2020 2020 2077 6974  one..        wit
-000163d0: 6820 6368 6563 6b5f 7265 6475 6374 696f  h check_reductio
-000163e0: 6e73 5f72 756e 7469 6d65 5f77 6172 6e69  ns_runtime_warni
-000163f0: 6e67 2829 3a0a 2020 2020 2020 2020 2020  ng():.          
-00016400: 2020 6d65 7461 5f63 6f6d 7075 7461 7469    meta_computati
-00016410: 6f6e 203d 206e 756d 2e5f 6d65 7461 5f6e  on = num._meta_n
-00016420: 6f6e 656d 7074 792e 7661 7228 6178 6973  onempty.var(axis
-00016430: 3d30 290a 2020 2020 2020 2020 7661 725f  =0).        var_
-00016440: 7368 6170 6520 3d20 6d65 7461 5f63 6f6d  shape = meta_com
-00016450: 7075 7461 7469 6f6e 2e73 6861 7065 0a20  putation.shape. 
-00016460: 2020 2020 2020 2061 7272 6179 5f76 6172         array_var
-00016470: 5f6e 616d 6520 3d20 2861 7272 6179 5f76  _name = (array_v
-00016480: 6172 2e5f 6e61 6d65 2c29 202b 2028 302c  ar._name,) + (0,
-00016490: 2920 2a20 6c65 6e28 7661 725f 7368 6170  ) * len(var_shap
-000164a0: 6529 0a0a 2020 2020 2020 2020 6c61 7965  e)..        laye
-000164b0: 7220 3d20 7b28 6e61 6d65 2c20 3029 3a20  r = {(name, 0): 
-000164c0: 286d 6574 686f 6473 2e77 7261 705f 7661  (methods.wrap_va
-000164d0: 725f 7265 6475 6374 696f 6e2c 2061 7272  r_reduction, arr
-000164e0: 6179 5f76 6172 5f6e 616d 652c 2063 6f6c  ay_var_name, col
-000164f0: 7329 7d0a 2020 2020 2020 2020 6772 6170  s)}.        grap
-00016500: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
-00016510: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
-00016520: 6f6e 7328 6e61 6d65 2c20 6c61 7965 722c  ons(name, layer,
-00016530: 2064 6570 656e 6465 6e63 6965 733d 5b61   dependencies=[a
-00016540: 7272 6179 5f76 6172 5d29 0a0a 2020 2020  rray_var])..    
-00016550: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
-00016560: 645f 6f62 6a65 6374 2867 7261 7068 2c20  d_object(graph, 
-00016570: 6e61 6d65 2c20 6d65 7461 5f63 6f6d 7075  name, meta_compu
-00016580: 7461 7469 6f6e 2c20 6469 7669 7369 6f6e  tation, division
-00016590: 733d 5b4e 6f6e 652c 204e 6f6e 655d 290a  s=[None, None]).
-000165a0: 0a20 2020 2064 6566 205f 7661 725f 3164  .    def _var_1d
-000165b0: 2873 656c 662c 2063 6f6c 756d 6e2c 2073  (self, column, s
-000165c0: 6b69 706e 613d 5472 7565 2c20 6464 6f66  kipna=True, ddof
-000165d0: 3d31 2c20 7370 6c69 745f 6576 6572 793d  =1, split_every=
-000165e0: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
-000165f0: 6973 5f74 696d 6564 656c 7461 203d 2069  is_timedelta = i
-00016600: 735f 7469 6d65 6465 6c74 6136 345f 6474  s_timedelta64_dt
-00016610: 7970 6528 636f 6c75 6d6e 2e5f 6d65 7461  ype(column._meta
-00016620: 290a 0a20 2020 2020 2020 2069 6620 6973  )..        if is
-00016630: 5f74 696d 6564 656c 7461 3a0a 2020 2020  _timedelta:.    
-00016640: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-00016650: 6b69 706e 613a 0a20 2020 2020 2020 2020  kipna:.         
-00016660: 2020 2020 2020 2069 735f 6e61 6e20 3d20         is_nan = 
-00016670: 636f 6c75 6d6e 2e69 736e 6128 290a 2020  column.isna().  
-00016680: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00016690: 6c75 6d6e 203d 2063 6f6c 756d 6e2e 6173  lumn = column.as
-000166a0: 7479 7065 2822 6938 2229 0a20 2020 2020  type("i8").     
-000166b0: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-000166c0: 6e20 3d20 636f 6c75 6d6e 2e6d 6173 6b28  n = column.mask(
-000166d0: 6973 5f6e 616e 290a 2020 2020 2020 2020  is_nan).        
-000166e0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000166f0: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-00016700: 203d 2063 6f6c 756d 6e2e 6472 6f70 6e61   = column.dropna
-00016710: 2829 2e61 7374 7970 6528 2269 3822 290a  ().astype("i8").
-00016720: 0a20 2020 2020 2020 2069 6620 7064 2e61  .        if pd.a
-00016730: 7069 2e74 7970 6573 2e69 735f 6578 7465  pi.types.is_exte
-00016740: 6e73 696f 6e5f 6172 7261 795f 6474 7970  nsion_array_dtyp
-00016750: 6528 636f 6c75 6d6e 2e5f 6d65 7461 5f6e  e(column._meta_n
-00016760: 6f6e 656d 7074 7929 3a0a 2020 2020 2020  onempty):.      
-00016770: 2020 2020 2020 2320 446f 6e27 7420 6861        # Don't ha
-00016780: 7665 2074 6f20 776f 7272 7920 6162 6f75  ve to worry abou
-00016790: 7420 6e6f 6e2d 6e75 6d65 7269 632c 2074  t non-numeric, t
-000167a0: 6869 7320 7261 6973 6573 2065 6172 6c69  his raises earli
-000167b0: 6572 0a20 2020 2020 2020 2020 2020 2063  er.            c
-000167c0: 6f6c 756d 6e20 3d20 636f 6c75 6d6e 2e61  olumn = column.a
-000167d0: 7374 7970 6528 2266 3822 290a 0a20 2020  stype("f8")..   
-000167e0: 2020 2020 2065 6c69 6620 6e6f 7420 6e70       elif not np
-000167f0: 2e69 7373 7562 6474 7970 6528 636f 6c75  .issubdtype(colu
-00016800: 6d6e 2e64 7479 7065 2c20 6e70 2e6e 756d  mn.dtype, np.num
-00016810: 6265 7229 3a0a 2020 2020 2020 2020 2020  ber):.          
-00016820: 2020 636f 6c75 6d6e 203d 2063 6f6c 756d    column = colum
-00016830: 6e2e 6173 7479 7065 2822 6638 2229 0a0a  n.astype("f8")..
-00016840: 2020 2020 2020 2020 6e61 6d65 203d 2073          name = s
-00016850: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
-00016860: 7820 2b20 2276 6172 2d31 642d 2220 2b20  x + "var-1d-" + 
-00016870: 746f 6b65 6e69 7a65 2863 6f6c 756d 6e2c  tokenize(column,
-00016880: 2073 706c 6974 5f65 7665 7279 290a 0a20   split_every).. 
-00016890: 2020 2020 2020 2076 6172 203d 2064 612e         var = da.
-000168a0: 6e61 6e76 6172 2069 6620 736b 6970 6e61  nanvar if skipna
-000168b0: 206f 7220 736b 6970 6e61 2069 7320 4e6f   or skipna is No
-000168c0: 6e65 2065 6c73 6520 6461 2e76 6172 0a20  ne else da.var. 
-000168d0: 2020 2020 2020 2061 7272 6179 5f76 6172         array_var
-000168e0: 203d 2076 6172 2863 6f6c 756d 6e2e 7661   = var(column.va
-000168f0: 6c75 6573 2c20 6178 6973 3d30 2c20 6464  lues, axis=0, dd
-00016900: 6f66 3d64 646f 662c 2073 706c 6974 5f65  of=ddof, split_e
-00016910: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
-00016920: 290a 0a20 2020 2020 2020 206c 6179 6572  )..        layer
-00016930: 203d 207b 286e 616d 652c 2030 293a 2028   = {(name, 0): (
-00016940: 6d65 7468 6f64 732e 7772 6170 5f76 6172  methods.wrap_var
-00016950: 5f72 6564 7563 7469 6f6e 2c20 2861 7272  _reduction, (arr
-00016960: 6179 5f76 6172 2e5f 6e61 6d65 2c29 2c20  ay_var._name,), 
-00016970: 4e6f 6e65 297d 0a20 2020 2020 2020 2067  None)}.        g
-00016980: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
-00016990: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-000169a0: 6374 696f 6e73 286e 616d 652c 206c 6179  ctions(name, lay
-000169b0: 6572 2c20 6465 7065 6e64 656e 6369 6573  er, dependencies
-000169c0: 3d5b 6172 7261 795f 7661 725d 290a 0a20  =[array_var]).. 
-000169d0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-000169e0: 775f 6464 5f6f 626a 6563 7428 0a20 2020  w_dd_object(.   
-000169f0: 2020 2020 2020 2020 2067 7261 7068 2c20           graph, 
-00016a00: 6e61 6d65 2c20 636f 6c75 6d6e 2e5f 6d65  name, column._me
-00016a10: 7461 5f6e 6f6e 656d 7074 792e 7661 7228  ta_nonempty.var(
-00016a20: 292c 2064 6976 6973 696f 6e73 3d5b 4e6f  ), divisions=[No
-00016a30: 6e65 2c20 4e6f 6e65 5d0a 2020 2020 2020  ne, None].      
-00016a40: 2020 290a 0a20 2020 2040 5f6e 756d 6572    )..    @_numer
-00016a50: 6963 5f64 6174 610a 2020 2020 4064 6572  ic_data.    @der
-00016a60: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00016a70: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00016a80: 7374 6428 0a20 2020 2020 2020 2073 656c  std(.        sel
-00016a90: 662c 0a20 2020 2020 2020 2061 7869 733d  f,.        axis=
-00016aa0: 4e6f 6e65 2c0a 2020 2020 2020 2020 736b  None,.        sk
-00016ab0: 6970 6e61 3d54 7275 652c 0a20 2020 2020  ipna=True,.     
-00016ac0: 2020 2064 646f 663d 312c 0a20 2020 2020     ddof=1,.     
-00016ad0: 2020 2073 706c 6974 5f65 7665 7279 3d46     split_every=F
-00016ae0: 616c 7365 2c0a 2020 2020 2020 2020 6474  alse,.        dt
-00016af0: 7970 653d 4e6f 6e65 2c0a 2020 2020 2020  ype=None,.      
-00016b00: 2020 6f75 743d 4e6f 6e65 2c0a 2020 2020    out=None,.    
-00016b10: 2020 2020 6e75 6d65 7269 635f 6f6e 6c79      numeric_only
-00016b20: 3d6e 6f5f 6465 6661 756c 742c 0a20 2020  =no_default,.   
-00016b30: 2029 3a0a 2020 2020 2020 2020 6178 6973   ):.        axis
-00016b40: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
-00016b50: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
-00016b60: 2020 2020 205f 7261 6973 655f 6966 5f6f       _raise_if_o
-00016b70: 626a 6563 745f 7365 7269 6573 2873 656c  bject_series(sel
-00016b80: 662c 2022 7374 6422 290a 2020 2020 2020  f, "std").      
-00016b90: 2020 5f72 6169 7365 5f69 665f 6e6f 745f    _raise_if_not_
-00016ba0: 7365 7269 6573 5f6f 725f 6461 7461 6672  series_or_datafr
-00016bb0: 616d 6528 7365 6c66 2c20 2273 7464 2229  ame(self, "std")
-00016bc0: 0a20 2020 2020 2020 206e 756d 6572 6963  .        numeric
-00016bd0: 5f6b 7761 7267 7320 3d20 6765 745f 6e75  _kwargs = get_nu
-00016be0: 6d65 7269 635f 6f6e 6c79 5f6b 7761 7267  meric_only_kwarg
-00016bf0: 7328 6e75 6d65 7269 635f 6f6e 6c79 290a  s(numeric_only).
-00016c00: 0a20 2020 2020 2020 2077 6974 6820 6368  .        with ch
-00016c10: 6563 6b5f 6e75 6d65 7269 635f 6f6e 6c79  eck_numeric_only
-00016c20: 5f64 6570 7265 6361 7469 6f6e 280a 2020  _deprecation(.  
-00016c30: 2020 2020 2020 2020 2020 2273 7464 222c            "std",
-00016c40: 2054 7275 650a 2020 2020 2020 2020 292c   True.        ),
-00016c50: 2063 6865 636b 5f72 6564 7563 7469 6f6e   check_reduction
-00016c60: 735f 7275 6e74 696d 655f 7761 726e 696e  s_runtime_warnin
-00016c70: 6728 293a 0a20 2020 2020 2020 2020 2020  g():.           
-00016c80: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
-00016c90: 7461 5f6e 6f6e 656d 7074 792e 7374 6428  ta_nonempty.std(
-00016ca0: 6178 6973 3d61 7869 732c 2073 6b69 706e  axis=axis, skipn
-00016cb0: 613d 736b 6970 6e61 2c20 2a2a 6e75 6d65  a=skipna, **nume
-00016cc0: 7269 635f 6b77 6172 6773 290a 2020 2020  ric_kwargs).    
-00016cd0: 2020 2020 6973 5f64 665f 6c69 6b65 203d      is_df_like =
-00016ce0: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
-00016cf0: 6b65 2873 656c 662e 5f6d 6574 6129 0a20  ke(self._meta). 
-00016d00: 2020 2020 2020 206e 6565 6473 5f74 696d         needs_tim
-00016d10: 655f 636f 6e76 6572 7369 6f6e 203d 2046  e_conversion = F
-00016d20: 616c 7365 0a20 2020 2020 2020 206e 756d  alse.        num
-00016d30: 6572 6963 5f64 6420 3d20 7365 6c66 0a0a  eric_dd = self..
-00016d40: 2020 2020 2020 2020 6966 2069 735f 6466          if is_df
-00016d50: 5f6c 696b 653a 0a20 2020 2020 2020 2020  _like:.         
-00016d60: 2020 2074 696d 655f 636f 6c73 203d 2073     time_cols = s
-00016d70: 656c 662e 5f6d 6574 612e 7365 6c65 6374  elf._meta.select
-00016d80: 5f64 7479 7065 7328 0a20 2020 2020 2020  _dtypes(.       
-00016d90: 2020 2020 2020 2020 2069 6e63 6c75 6465           include
-00016da0: 3d5b 2264 6174 6574 696d 6522 2c20 2274  =["datetime", "t
-00016db0: 696d 6564 656c 7461 225d 0a20 2020 2020  imedelta"].     
-00016dc0: 2020 2020 2020 2029 2e63 6f6c 756d 6e73         ).columns
-00016dd0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00016de0: 6c65 6e28 7469 6d65 5f63 6f6c 7329 203e  len(time_cols) >
-00016df0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-00016e00: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
-00016e10: 2020 2020 2020 2020 2020 6e75 6d65 7269            numeri
-00016e20: 635f 6464 2c0a 2020 2020 2020 2020 2020  c_dd,.          
-00016e30: 2020 2020 2020 2020 2020 6e65 6564 735f            needs_
-00016e40: 7469 6d65 5f63 6f6e 7665 7273 696f 6e2c  time_conversion,
-00016e50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016e60: 2029 203d 2073 656c 662e 5f63 6f6e 7665   ) = self._conve
-00016e70: 7274 5f74 696d 655f 636f 6c73 5f74 6f5f  rt_time_cols_to_
-00016e80: 6e75 6d65 7269 6328 7469 6d65 5f63 6f6c  numeric(time_col
-00016e90: 732c 2061 7869 732c 206d 6574 612c 2073  s, axis, meta, s
-00016ea0: 6b69 706e 6129 0a20 2020 2020 2020 2065  kipna).        e
-00016eb0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00016ec0: 206e 6565 6473 5f74 696d 655f 636f 6e76   needs_time_conv
-00016ed0: 6572 7369 6f6e 203d 2069 735f 6461 7465  ersion = is_date
-00016ee0: 7469 6d65 3634 5f61 6e79 5f64 7479 7065  time64_any_dtype
-00016ef0: 2873 656c 662e 5f6d 6574 6129 0a20 2020  (self._meta).   
-00016f00: 2020 2020 2020 2020 2069 6620 6e65 6564           if need
-00016f10: 735f 7469 6d65 5f63 6f6e 7665 7273 696f  s_time_conversio
-00016f20: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
-00016f30: 2020 206e 756d 6572 6963 5f64 6420 3d20     numeric_dd = 
-00016f40: 5f63 6f6e 7665 7274 5f74 6f5f 6e75 6d65  _convert_to_nume
-00016f50: 7269 6328 7365 6c66 2c20 736b 6970 6e61  ric(self, skipna
-00016f60: 290a 0a20 2020 2020 2020 2069 6620 6178  )..        if ax
-00016f70: 6973 203d 3d20 313a 0a20 2020 2020 2020  is == 1:.       
-00016f80: 2020 2020 2072 6573 756c 7420 3d20 6d61       result = ma
-00016f90: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
-00016fa0: 2020 2020 2020 2020 2020 2020 2020 4d2e                M.
-00016fb0: 7374 6420 6966 206e 6f74 206e 6565 6473  std if not needs
-00016fc0: 5f74 696d 655f 636f 6e76 6572 7369 6f6e  _time_conversion
-00016fd0: 2065 6c73 6520 5f73 7172 745f 616e 645f   else _sqrt_and_
-00016fe0: 636f 6e76 6572 745f 746f 5f74 696d 6564  convert_to_timed
-00016ff0: 656c 7461 2c0a 2020 2020 2020 2020 2020  elta,.          
-00017000: 2020 2020 2020 6e75 6d65 7269 635f 6464        numeric_dd
-00017010: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00017020: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
-00017030: 2020 2020 2020 2020 2020 2020 2074 6f6b               tok
-00017040: 656e 3d73 656c 662e 5f74 6f6b 656e 5f70  en=self._token_p
-00017050: 7265 6669 7820 2b20 2273 7464 222c 0a20  refix + "std",. 
-00017060: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00017070: 7869 733d 6178 6973 2c0a 2020 2020 2020  xis=axis,.      
-00017080: 2020 2020 2020 2020 2020 736b 6970 6e61            skipna
-00017090: 3d73 6b69 706e 612c 0a20 2020 2020 2020  =skipna,.       
-000170a0: 2020 2020 2020 2020 2064 646f 663d 6464           ddof=dd
-000170b0: 6f66 2c0a 2020 2020 2020 2020 2020 2020  of,.            
-000170c0: 2020 2020 656e 666f 7263 655f 6d65 7461      enforce_meta
-000170d0: 6461 7461 3d46 616c 7365 2c0a 2020 2020  data=False,.    
-000170e0: 2020 2020 2020 2020 2020 2020 2a2a 6e75              **nu
-000170f0: 6d65 7269 635f 6b77 6172 6773 2c0a 2020  meric_kwargs,.  
-00017100: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00017110: 7265 6e74 5f6d 6574 613d 7365 6c66 2e5f  rent_meta=self._
-00017120: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
-00017130: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00017140: 7265 7475 726e 2068 616e 646c 655f 6f75  return handle_ou
-00017150: 7428 6f75 742c 2072 6573 756c 7429 0a0a  t(out, result)..
-00017160: 2020 2020 2020 2020 2320 4361 7365 2077          # Case w
-00017170: 6865 7265 2061 7869 733d 3020 6f72 2061  here axis=0 or a
-00017180: 7869 733d 4e6f 6e65 0a20 2020 2020 2020  xis=None.       
-00017190: 2076 203d 206e 756d 6572 6963 5f64 642e   v = numeric_dd.
-000171a0: 7661 7228 736b 6970 6e61 3d73 6b69 706e  var(skipna=skipn
-000171b0: 612c 2064 646f 663d 6464 6f66 2c20 7370  a, ddof=ddof, sp
-000171c0: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
-000171d0: 6576 6572 7929 0a20 2020 2020 2020 206e  every).        n
-000171e0: 616d 6520 3d20 7365 6c66 2e5f 746f 6b65  ame = self._toke
-000171f0: 6e5f 7072 6566 6978 202b 2022 7374 6422  n_prefix + "std"
-00017200: 0a0a 2020 2020 2020 2020 6966 206e 6565  ..        if nee
-00017210: 6473 5f74 696d 655f 636f 6e76 6572 7369  ds_time_conversi
-00017220: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-00017230: 7371 7274 5f66 756e 635f 6b77 6172 6773  sqrt_func_kwargs
-00017240: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-00017250: 2020 2020 2022 6973 5f64 665f 6c69 6b65       "is_df_like
-00017260: 223a 2069 735f 6466 5f6c 696b 652c 0a20  ": is_df_like,. 
-00017270: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00017280: 7469 6d65 5f63 6f6c 7322 3a20 7469 6d65  time_cols": time
-00017290: 5f63 6f6c 7320 6966 2069 735f 6466 5f6c  _cols if is_df_l
-000172a0: 696b 6520 656c 7365 204e 6f6e 652c 0a20  ike else None,. 
-000172b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000172c0: 6178 6973 223a 2061 7869 732c 0a20 2020  axis": axis,.   
-000172d0: 2020 2020 2020 2020 2020 2020 2022 6474               "dt
-000172e0: 7970 6522 3a20 6765 7461 7474 7228 6d65  ype": getattr(me
-000172f0: 7461 2c20 2264 7479 7065 222c 204e 6f6e  ta, "dtype", Non
-00017300: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
-00017310: 7d0a 2020 2020 2020 2020 2020 2020 7371  }.            sq
-00017320: 7274 5f66 756e 6320 3d20 5f73 7172 745f  rt_func = _sqrt_
-00017330: 616e 645f 636f 6e76 6572 745f 746f 5f74  and_convert_to_t
-00017340: 696d 6564 656c 7461 0a20 2020 2020 2020  imedelta.       
-00017350: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00017360: 2020 2073 7172 745f 6675 6e63 5f6b 7761     sqrt_func_kwa
-00017370: 7267 7320 3d20 7b7d 0a20 2020 2020 2020  rgs = {}.       
-00017380: 2020 2020 2073 7172 745f 6675 6e63 203d       sqrt_func =
-00017390: 206e 702e 7371 7274 0a0a 2020 2020 2020   np.sqrt..      
-000173a0: 2020 7265 7375 6c74 203d 206d 6170 5f70    result = map_p
-000173b0: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
-000173c0: 2020 2020 2020 2073 7172 745f 6675 6e63         sqrt_func
-000173d0: 2c0a 2020 2020 2020 2020 2020 2020 762c  ,.            v,
-000173e0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-000173f0: 613d 6d65 7461 2c0a 2020 2020 2020 2020  a=meta,.        
-00017400: 2020 2020 746f 6b65 6e3d 6e61 6d65 2c0a      token=name,.
-00017410: 2020 2020 2020 2020 2020 2020 656e 666f              enfo
-00017420: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
-00017430: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00017440: 7061 7265 6e74 5f6d 6574 613d 7365 6c66  parent_meta=self
-00017450: 2e5f 6d65 7461 2c0a 2020 2020 2020 2020  ._meta,.        
-00017460: 2020 2020 2a2a 7371 7274 5f66 756e 635f      **sqrt_func_
-00017470: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
-00017480: 290a 0a20 2020 2020 2020 2023 2054 7279  )..        # Try
-00017490: 2074 6f20 6d61 7463 6820 7468 6520 5061   to match the Pa
-000174a0: 6e64 6173 2072 6573 756c 7420 6474 7970  ndas result dtyp
-000174b0: 650a 2020 2020 2020 2020 6966 2069 735f  e.        if is_
-000174c0: 6466 5f6c 696b 6520 616e 6420 6861 7361  df_like and hasa
-000174d0: 7474 7228 6d65 7461 2c20 2264 7479 7065  ttr(meta, "dtype
-000174e0: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
-000174f0: 7265 7375 6c74 203d 2072 6573 756c 742e  result = result.
-00017500: 6173 7479 7065 286d 6574 612e 6474 7970  astype(meta.dtyp
-00017510: 6529 0a0a 2020 2020 2020 2020 7265 7475  e)..        retu
-00017520: 726e 2068 616e 646c 655f 6f75 7428 6f75  rn handle_out(ou
-00017530: 742c 2072 6573 756c 7429 0a0a 2020 2020  t, result)..    
-00017540: 6465 6620 5f63 6f6e 7665 7274 5f74 696d  def _convert_tim
-00017550: 655f 636f 6c73 5f74 6f5f 6e75 6d65 7269  e_cols_to_numeri
-00017560: 6328 7365 6c66 2c20 7469 6d65 5f63 6f6c  c(self, time_col
-00017570: 732c 2061 7869 732c 206d 6574 612c 2073  s, axis, meta, s
-00017580: 6b69 706e 6129 3a0a 2020 2020 2020 2020  kipna):.        
-00017590: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
-000175a0: 616d 652e 696f 2069 6d70 6f72 7420 6672  ame.io import fr
-000175b0: 6f6d 5f70 616e 6461 730a 0a20 2020 2020  om_pandas..     
-000175c0: 2020 206e 6565 6473 5f74 696d 655f 636f     needs_time_co
-000175d0: 6e76 6572 7369 6f6e 203d 2054 7275 650a  nversion = True.
-000175e0: 0a20 2020 2020 2020 2023 2045 6e73 7572  .        # Ensur
-000175f0: 6520 616c 6c20 636f 6c75 6d6e 7320 6172  e all columns ar
-00017600: 6520 636f 7272 6563 7420 7479 7065 2e20  e correct type. 
-00017610: 4e65 6564 2074 6f20 7368 616c 6c6f 7720  Need to shallow 
-00017620: 636f 7079 2073 696e 6365 2063 6f6c 7320  copy since cols 
-00017630: 7769 6c6c 2062 6520 6d6f 6469 6669 6564  will be modified
-00017640: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
-00017650: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-00017660: 2020 206e 756d 6572 6963 5f64 6420 3d20     numeric_dd = 
-00017670: 7365 6c66 5b6d 6574 612e 696e 6465 785d  self[meta.index]
-00017680: 2e63 6f70 7928 290a 2020 2020 2020 2020  .copy().        
-00017690: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000176a0: 2020 6e75 6d65 7269 635f 6464 203d 2073    numeric_dd = s
-000176b0: 656c 662e 636f 7079 2829 0a0a 2020 2020  elf.copy()..    
-000176c0: 2020 2020 2320 4d69 7820 6f66 2064 6174      # Mix of dat
-000176d0: 6574 696d 6573 2077 6974 6820 6f74 6865  etimes with othe
-000176e0: 7220 6e75 6d65 7269 6320 7479 7065 7320  r numeric types 
-000176f0: 7072 6f64 7563 6573 204e 614e 7320 666f  produces NaNs fo
-00017700: 7220 6561 6368 2076 616c 7565 2069 6e20  r each value in 
-00017710: 7374 6428 2920 7365 7269 6573 0a20 2020  std() series.   
-00017720: 2020 2020 2069 6620 6178 6973 203d 3d20       if axis == 
-00017730: 3120 616e 6420 6c65 6e28 7469 6d65 5f63  1 and len(time_c
-00017740: 6f6c 7329 2021 3d20 6c65 6e28 7365 6c66  ols) != len(self
-00017750: 2e63 6f6c 756d 6e73 293a 0a20 2020 2020  .columns):.     
-00017760: 2020 2020 2020 2023 2054 6869 7320 6973         # This is
-00017770: 2066 6173 7465 7220 7468 616e 2063 6f6e   faster than con
-00017780: 7665 7274 696e 6720 6561 6368 2063 6f6c  verting each col
-00017790: 756d 6e20 746f 206e 756d 6572 6963 2077  umn to numeric w
-000177a0: 6865 6e20 6974 2773 206e 6f74 206e 6563  hen it's not nec
-000177b0: 6573 7361 7279 0a20 2020 2020 2020 2020  essary.         
-000177c0: 2020 2023 2073 696e 6365 2065 6163 6820     # since each 
-000177d0: 7374 616e 6461 7264 2064 6576 6961 7469  standard deviati
-000177e0: 6f6e 2077 696c 6c20 6a75 7374 2062 6520  on will just be 
-000177f0: 4e61 4e0a 2020 2020 2020 2020 2020 2020  NaN.            
-00017800: 6e65 6564 735f 7469 6d65 5f63 6f6e 7665  needs_time_conve
-00017810: 7273 696f 6e20 3d20 4661 6c73 650a 2020  rsion = False.  
-00017820: 2020 2020 2020 2020 2020 6e75 6d65 7269            numeri
-00017830: 635f 6464 203d 2066 726f 6d5f 7061 6e64  c_dd = from_pand
-00017840: 6173 280a 2020 2020 2020 2020 2020 2020  as(.            
-00017850: 2020 2020 6d65 7461 5f66 7261 6d65 5f63      meta_frame_c
-00017860: 6f6e 7374 7275 6374 6f72 2873 656c 6629  onstructor(self)
-00017870: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00017880: 2020 2020 2020 7b22 5f22 3a20 6d65 7461        {"_": meta
-00017890: 5f73 6572 6965 735f 636f 6e73 7472 7563  _series_construc
-000178a0: 746f 7228 7365 6c66 2928 5b6e 702e 6e61  tor(self)([np.na
-000178b0: 6e5d 297d 2c0a 2020 2020 2020 2020 2020  n])},.          
-000178c0: 2020 2020 2020 2020 2020 696e 6465 783d            index=
-000178d0: 7365 6c66 2e69 6e64 6578 2c0a 2020 2020  self.index,.    
-000178e0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-000178f0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00017900: 7061 7274 6974 696f 6e73 3d73 656c 662e  partitions=self.
-00017910: 6e70 6172 7469 7469 6f6e 732c 0a20 2020  npartitions,.   
-00017920: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00017930: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00017940: 2020 2020 2023 2043 6f6e 7665 7274 2074       # Convert t
-00017950: 696d 6564 656c 7461 2061 6e64 2064 6174  imedelta and dat
-00017960: 6574 696d 6520 636f 6c75 6d6e 7320 746f  etime columns to
-00017970: 2069 6e74 6567 6572 2074 7970 6573 2073   integer types s
-00017980: 6f20 7765 2063 616e 2075 7365 2076 6172  o we can use var
-00017990: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-000179a0: 2063 6f6c 2069 6e20 7469 6d65 5f63 6f6c   col in time_col
-000179b0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-000179c0: 2020 206e 756d 6572 6963 5f64 645b 636f     numeric_dd[co
-000179d0: 6c5d 203d 205f 636f 6e76 6572 745f 746f  l] = _convert_to
-000179e0: 5f6e 756d 6572 6963 286e 756d 6572 6963  _numeric(numeric
-000179f0: 5f64 645b 636f 6c5d 2c20 736b 6970 6e61  _dd[col], skipna
-00017a00: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00017a10: 6e20 6e75 6d65 7269 635f 6464 2c20 6e65  n numeric_dd, ne
-00017a20: 6564 735f 7469 6d65 5f63 6f6e 7665 7273  eds_time_convers
-00017a30: 696f 6e0a 0a20 2020 2040 6465 7269 7665  ion..    @derive
-00017a40: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
-00017a50: 616d 6529 0a20 2020 2064 6566 2073 6b65  ame).    def ske
-00017a60: 7728 0a20 2020 2020 2020 2073 656c 662c  w(.        self,
-00017a70: 0a20 2020 2020 2020 2061 7869 733d 302c  .        axis=0,
-00017a80: 0a20 2020 2020 2020 2062 6961 733d 5472  .        bias=Tr
-00017a90: 7565 2c0a 2020 2020 2020 2020 6e61 6e5f  ue,.        nan_
-00017aa0: 706f 6c69 6379 3d22 7072 6f70 6167 6174  policy="propagat
-00017ab0: 6522 2c0a 2020 2020 2020 2020 6f75 743d  e",.        out=
-00017ac0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6e75  None,.        nu
-00017ad0: 6d65 7269 635f 6f6e 6c79 3d6e 6f5f 6465  meric_only=no_de
-00017ae0: 6661 756c 742c 0a20 2020 2029 3a0a 2020  fault,.    ):.  
-00017af0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00017b00: 2020 2e2e 206e 6f74 653a 3a0a 0a20 2020    .. note::..   
-00017b10: 2020 2020 2020 2020 5468 6973 2069 6d70          This imp
-00017b20: 6c65 6d65 6e74 6174 696f 6e20 666f 6c6c  lementation foll
-00017b30: 6f77 7320 7468 6520 6461 736b 2e61 7272  ows the dask.arr
-00017b40: 6179 2e73 7461 7473 2069 6d70 6c65 6d65  ay.stats impleme
-00017b50: 6e74 6174 696f 6e0a 2020 2020 2020 2020  ntation.        
-00017b60: 2020 206f 6620 736b 6577 6e65 7373 2061     of skewness a
-00017b70: 6e64 2063 616c 6375 6c61 7465 7320 736b  nd calculates sk
-00017b80: 6577 6e65 7373 2077 6974 686f 7574 2074  ewness without t
-00017b90: 616b 696e 6720 696e 746f 2061 6363 6f75  aking into accou
-00017ba0: 6e74 0a20 2020 2020 2020 2020 2020 6120  nt.           a 
-00017bb0: 6269 6173 2074 6572 6d20 666f 7220 6669  bias term for fi
-00017bc0: 6e69 7465 2073 616d 706c 6520 7369 7a65  nite sample size
-00017bd0: 2c20 7768 6963 6820 636f 7272 6573 706f  , which correspo
-00017be0: 6e64 7320 746f 2074 6865 0a20 2020 2020  nds to the.     
-00017bf0: 2020 2020 2020 6465 6661 756c 7420 7365        default se
-00017c00: 7474 696e 6773 206f 6620 7468 6520 7363  ttings of the sc
-00017c10: 6970 792e 7374 6174 7320 736b 6577 6e65  ipy.stats skewne
-00017c20: 7373 2063 616c 6375 6c61 7469 6f6e 2e20  ss calculation. 
-00017c30: 486f 7765 7665 722c 0a20 2020 2020 2020  However,.       
-00017c40: 2020 2020 5061 6e64 6173 2063 6f72 7265      Pandas corre
-00017c50: 6374 7320 666f 7220 7468 6973 2c20 736f  cts for this, so
-00017c60: 2074 6865 2076 616c 7565 7320 6469 6666   the values diff
-00017c70: 6572 2062 7920 6120 6661 6374 6f72 206f  er by a factor o
-00017c80: 660a 2020 2020 2020 2020 2020 2028 6e20  f.           (n 
-00017c90: 2a20 286e 202d 2031 2929 202a 2a20 302e  * (n - 1)) ** 0.
-00017ca0: 3520 2f20 286e 202d 2032 292c 2077 6865  5 / (n - 2), whe
-00017cb0: 7265 206e 2069 7320 7468 6520 6e75 6d62  re n is the numb
-00017cc0: 6572 206f 6620 7361 6d70 6c65 732e 0a0a  er of samples...
-00017cd0: 2020 2020 2020 2020 2020 2046 7572 7468             Furth
-00017ce0: 6572 2c20 7468 6973 206d 6574 686f 6420  er, this method 
-00017cf0: 6375 7272 656e 746c 7920 646f 6573 206e  currently does n
-00017d00: 6f74 2073 7570 706f 7274 2066 696c 7465  ot support filte
-00017d10: 7269 6e67 206f 7574 204e 614e 0a20 2020  ring out NaN.   
-00017d20: 2020 2020 2020 2020 7661 6c75 6573 2c20          values, 
-00017d30: 7768 6963 6820 6973 2061 6761 696e 2061  which is again a
-00017d40: 2064 6966 6665 7265 6e63 6520 746f 2050   difference to P
-00017d50: 616e 6461 732e 0a20 2020 2020 2020 2022  andas..        "
-00017d60: 2222 0a20 2020 2020 2020 2069 6620 5041  "".        if PA
-00017d70: 4e44 4153 5f47 545f 3230 3020 616e 6420  NDAS_GT_200 and 
-00017d80: 6178 6973 2069 7320 4e6f 6e65 3a0a 2020  axis is None:.  
-00017d90: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00017da0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-00017db0: 2020 2020 2020 2020 2020 2020 2260 6178              "`ax
-00017dc0: 6973 3d4e 6f6e 6560 2069 736e 2774 2063  is=None` isn't c
-00017dd0: 7572 7265 6e74 6c79 2073 7570 706f 7274  urrently support
-00017de0: 6564 2066 6f72 2060 736b 6577 6020 7768  ed for `skew` wh
-00017df0: 656e 2075 7369 6e67 2060 7061 6e64 6173  en using `pandas
-00017e00: 203e 3d32 6020 220a 2020 2020 2020 2020   >=2` ".        
-00017e10: 2020 2020 2020 2020 6622 2870 616e 6461          f"(panda
-00017e20: 733d 7b73 7472 2850 414e 4441 535f 5645  s={str(PANDAS_VE
-00017e30: 5253 494f 4e29 7d20 6973 2069 6e73 7461  RSION)} is insta
-00017e40: 6c6c 6564 292e 220a 2020 2020 2020 2020  lled).".        
-00017e50: 2020 2020 290a 2020 2020 2020 2020 6178      ).        ax
-00017e60: 6973 203d 2073 656c 662e 5f76 616c 6964  is = self._valid
-00017e70: 6174 655f 6178 6973 2861 7869 7329 0a20  ate_axis(axis). 
-00017e80: 2020 2020 2020 205f 7261 6973 655f 6966         _raise_if
-00017e90: 5f6f 626a 6563 745f 7365 7269 6573 2873  _object_series(s
-00017ea0: 656c 662c 2022 736b 6577 2229 0a20 2020  elf, "skew").   
-00017eb0: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
-00017ec0: 795f 6b77 6172 6773 203d 2067 6574 5f6e  y_kwargs = get_n
-00017ed0: 756d 6572 6963 5f6f 6e6c 795f 6b77 6172  umeric_only_kwar
-00017ee0: 6773 286e 756d 6572 6963 5f6f 6e6c 7929  gs(numeric_only)
-00017ef0: 0a0a 2020 2020 2020 2020 6966 2069 735f  ..        if is_
-00017f00: 6461 7461 6672 616d 655f 6c69 6b65 2873  dataframe_like(s
-00017f10: 656c 6629 3a0a 2020 2020 2020 2020 2020  elf):.          
-00017f20: 2020 2320 4c65 7420 7061 6e64 6173 2072    # Let pandas r
-00017f30: 6169 7365 2065 7272 6f72 7320 6966 206e  aise errors if n
-00017f40: 6563 6573 7361 7279 0a20 2020 2020 2020  ecessary.       
-00017f50: 2020 2020 206d 6574 6120 3d20 7365 6c66       meta = self
-00017f60: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
-00017f70: 736b 6577 2861 7869 733d 6178 6973 2c20  skew(axis=axis, 
-00017f80: 2a2a 6e75 6d65 7269 635f 6f6e 6c79 5f6b  **numeric_only_k
-00017f90: 7761 7267 7329 0a20 2020 2020 2020 2065  wargs).        e
-00017fa0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00017fb0: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
-00017fc0: 7461 5f6e 6f6e 656d 7074 792e 736b 6577  ta_nonempty.skew
-00017fd0: 2829 0a0a 2020 2020 2020 2020 6966 2061  ()..        if a
-00017fe0: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
-00017ff0: 2020 2020 2020 7265 7375 6c74 203d 206d        result = m
-00018000: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
-00018010: 2020 2020 2020 2020 2020 2020 2020 204d                 M
-00018020: 2e73 6b65 772c 0a20 2020 2020 2020 2020  .skew,.         
-00018030: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00018040: 2020 2020 2020 2020 2020 2020 206d 6574               met
-00018050: 613d 6d65 7461 2c0a 2020 2020 2020 2020  a=meta,.        
-00018060: 2020 2020 2020 2020 746f 6b65 6e3d 7365          token=se
-00018070: 6c66 2e5f 746f 6b65 6e5f 7072 6566 6978  lf._token_prefix
-00018080: 202b 2022 736b 6577 222c 0a20 2020 2020   + "skew",.     
-00018090: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-000180a0: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
-000180b0: 2020 2020 2020 656e 666f 7263 655f 6d65        enforce_me
-000180c0: 7461 6461 7461 3d46 616c 7365 2c0a 2020  tadata=False,.  
-000180d0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000180e0: 2020 2020 2020 2020 7265 7475 726e 2068          return h
-000180f0: 616e 646c 655f 6f75 7428 6f75 742c 2072  andle_out(out, r
-00018100: 6573 756c 7429 0a20 2020 2020 2020 2065  esult).        e
-00018110: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00018120: 2069 6620 7365 6c66 2e6e 6469 6d20 3d3d   if self.ndim ==
-00018130: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00018140: 2020 2020 7265 7375 6c74 203d 2073 656c      result = sel
-00018150: 662e 5f73 6b65 775f 3164 2873 656c 662c  f._skew_1d(self,
-00018160: 2062 6961 733d 6269 6173 2c20 6e61 6e5f   bias=bias, nan_
-00018170: 706f 6c69 6379 3d6e 616e 5f70 6f6c 6963  policy=nan_polic
-00018180: 7929 0a20 2020 2020 2020 2020 2020 2020  y).             
-00018190: 2020 2072 6574 7572 6e20 6861 6e64 6c65     return handle
-000181a0: 5f6f 7574 286f 7574 2c20 7265 7375 6c74  _out(out, result
-000181b0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-000181c0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000181d0: 2020 2020 7265 7375 6c74 203d 2073 656c      result = sel
-000181e0: 662e 5f73 6b65 775f 6e75 6d65 7269 6328  f._skew_numeric(
-000181f0: 6269 6173 3d62 6961 732c 206e 616e 5f70  bias=bias, nan_p
-00018200: 6f6c 6963 793d 6e61 6e5f 706f 6c69 6379  olicy=nan_policy
-00018210: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
-00018220: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
-00018230: 662c 2044 6174 6146 7261 6d65 293a 0a20  f, DataFrame):. 
-00018240: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00018250: 6573 756c 742e 6469 7669 7369 6f6e 7320  esult.divisions 
-00018260: 3d20 2873 656c 662e 636f 6c75 6d6e 732e  = (self.columns.
-00018270: 6d69 6e28 292c 2073 656c 662e 636f 6c75  min(), self.colu
-00018280: 6d6e 732e 6d61 7828 2929 0a0a 2020 2020  mns.max())..    
-00018290: 2020 2020 2020 2020 7265 7475 726e 2068          return h
-000182a0: 616e 646c 655f 6f75 7428 6f75 742c 2072  andle_out(out, r
-000182b0: 6573 756c 7429 0a0a 2020 2020 6465 6620  esult)..    def 
-000182c0: 5f73 6b65 775f 3164 2873 656c 662c 2063  _skew_1d(self, c
-000182d0: 6f6c 756d 6e2c 2062 6961 733d 5472 7565  olumn, bias=True
-000182e0: 2c20 6e61 6e5f 706f 6c69 6379 3d22 7072  , nan_policy="pr
-000182f0: 6f70 6167 6174 6522 293a 0a20 2020 2020  opagate"):.     
-00018300: 2020 2022 2222 3144 2076 6572 7369 6f6e     """1D version
-00018310: 206f 6620 7468 6520 736b 6577 2063 616c   of the skew cal
-00018320: 6375 6c61 7469 6f6e 2e0a 0a20 2020 2020  culation...     
-00018330: 2020 2055 7365 7320 7468 6520 6172 7261     Uses the arra
-00018340: 7920 7665 7273 696f 6e20 6672 6f6d 2064  y version from d
-00018350: 612e 7374 6174 7320 696e 2063 6173 6520  a.stats in case 
-00018360: 7765 2061 7265 2070 6173 7369 6e67 2069  we are passing i
-00018370: 6e20 6120 7369 6e67 6c65 2073 6572 6965  n a single serie
-00018380: 730a 2020 2020 2020 2020 2222 220a 2020  s.        """.  
-00018390: 2020 2020 2020 2320 696d 706f 7274 2064        # import d
-000183a0: 6570 656e 6473 206f 6e20 7363 6970 792c  epends on scipy,
-000183b0: 206e 6f74 2069 6e73 7461 6c6c 6564 2062   not installed b
-000183c0: 7920 6465 6661 756c 740a 2020 2020 2020  y default.      
-000183d0: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
-000183e0: 7920 696d 706f 7274 2073 7461 7473 2061  y import stats a
-000183f0: 7320 6461 5f73 7461 7473 0a0a 2020 2020  s da_stats..    
-00018400: 2020 2020 6966 2070 642e 6170 692e 7479      if pd.api.ty
-00018410: 7065 732e 6973 5f65 7874 656e 7369 6f6e  pes.is_extension
-00018420: 5f61 7272 6179 5f64 7479 7065 2863 6f6c  _array_dtype(col
-00018430: 756d 6e2e 5f6d 6574 615f 6e6f 6e65 6d70  umn._meta_nonemp
-00018440: 7479 293a 0a20 2020 2020 2020 2020 2020  ty):.           
-00018450: 2063 6f6c 756d 6e20 3d20 636f 6c75 6d6e   column = column
-00018460: 2e61 7374 7970 6528 2266 3822 290a 0a20  .astype("f8").. 
-00018470: 2020 2020 2020 2065 6c69 6620 6e6f 7420         elif not 
-00018480: 6e70 2e69 7373 7562 6474 7970 6528 636f  np.issubdtype(co
-00018490: 6c75 6d6e 2e64 7479 7065 2c20 6e70 2e6e  lumn.dtype, np.n
-000184a0: 756d 6265 7229 3a0a 2020 2020 2020 2020  umber):.        
-000184b0: 2020 2020 636f 6c75 6d6e 203d 2063 6f6c      column = col
-000184c0: 756d 6e2e 6173 7479 7065 2822 6638 2229  umn.astype("f8")
-000184d0: 0a0a 2020 2020 2020 2020 6e61 6d65 203d  ..        name =
-000184e0: 2073 656c 662e 5f74 6f6b 656e 5f70 7265   self._token_pre
-000184f0: 6669 7820 2b20 2273 6b65 772d 3164 2d22  fix + "skew-1d-"
-00018500: 202b 2074 6f6b 656e 697a 6528 636f 6c75   + tokenize(colu
-00018510: 6d6e 290a 0a20 2020 2020 2020 2061 7272  mn)..        arr
-00018520: 6179 5f73 6b65 7720 3d20 6461 5f73 7461  ay_skew = da_sta
-00018530: 7473 2e73 6b65 7728 0a20 2020 2020 2020  ts.skew(.       
-00018540: 2020 2020 2063 6f6c 756d 6e2e 7661 6c75       column.valu
-00018550: 6573 2c20 6178 6973 3d30 2c20 6269 6173  es, axis=0, bias
-00018560: 3d62 6961 732c 206e 616e 5f70 6f6c 6963  =bias, nan_polic
-00018570: 793d 6e61 6e5f 706f 6c69 6379 0a20 2020  y=nan_policy.   
-00018580: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00018590: 6c61 7965 7220 3d20 7b28 6e61 6d65 2c20  layer = {(name, 
-000185a0: 3029 3a20 286d 6574 686f 6473 2e77 7261  0): (methods.wra
-000185b0: 705f 736b 6577 5f72 6564 7563 7469 6f6e  p_skew_reduction
-000185c0: 2c20 2861 7272 6179 5f73 6b65 772e 5f6e  , (array_skew._n
-000185d0: 616d 652c 292c 204e 6f6e 6529 7d0a 2020  ame,), None)}.  
-000185e0: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
-000185f0: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-00018600: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6e61  m_collections(na
-00018610: 6d65 2c20 6c61 7965 722c 2064 6570 656e  me, layer, depen
-00018620: 6465 6e63 6965 733d 5b61 7272 6179 5f73  dencies=[array_s
-00018630: 6b65 775d 290a 0a20 2020 2020 2020 2072  kew])..        r
-00018640: 6574 7572 6e20 6e65 775f 6464 5f6f 626a  eturn new_dd_obj
-00018650: 6563 7428 0a20 2020 2020 2020 2020 2020  ect(.           
-00018660: 2067 7261 7068 2c20 6e61 6d65 2c20 636f   graph, name, co
-00018670: 6c75 6d6e 2e5f 6d65 7461 5f6e 6f6e 656d  lumn._meta_nonem
-00018680: 7074 792e 736b 6577 2829 2c20 6469 7669  pty.skew(), divi
-00018690: 7369 6f6e 733d 5b4e 6f6e 652c 204e 6f6e  sions=[None, Non
-000186a0: 655d 0a20 2020 2020 2020 2029 0a0a 2020  e].        )..  
-000186b0: 2020 6465 6620 5f73 6b65 775f 6e75 6d65    def _skew_nume
-000186c0: 7269 6328 7365 6c66 2c20 6269 6173 3d54  ric(self, bias=T
-000186d0: 7275 652c 206e 616e 5f70 6f6c 6963 793d  rue, nan_policy=
-000186e0: 2270 726f 7061 6761 7465 2229 3a0a 2020  "propagate"):.  
-000186f0: 2020 2020 2020 2222 224d 6574 686f 6420        """Method 
-00018700: 666f 7220 6461 7461 6672 616d 6573 2077  for dataframes w
-00018710: 6974 6820 6e75 6d65 7269 6320 636f 6c75  ith numeric colu
-00018720: 6d6e 732e 0a0a 2020 2020 2020 2020 4d61  mns...        Ma
-00018730: 7073 2074 6865 2061 7272 6179 2076 6572  ps the array ver
-00018740: 7369 6f6e 2066 726f 6d20 6461 2e73 7461  sion from da.sta
-00018750: 7473 206f 6e74 6f20 7468 6520 6e75 6d65  ts onto the nume
-00018760: 7269 6320 6172 7261 7920 6f66 2063 6f6c  ric array of col
-00018770: 756d 6e73 2e0a 2020 2020 2020 2020 2222  umns..        ""
-00018780: 220a 2020 2020 2020 2020 2320 696d 706f  ".        # impo
-00018790: 7274 2064 6570 656e 6473 206f 6e20 7363  rt depends on sc
-000187a0: 6970 792c 206e 6f74 2069 6e73 7461 6c6c  ipy, not install
-000187b0: 6564 2062 7920 6465 6661 756c 740a 2020  ed by default.  
-000187c0: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-000187d0: 6172 7261 7920 696d 706f 7274 2073 7461  array import sta
-000187e0: 7473 2061 7320 6461 5f73 7461 7473 0a0a  ts as da_stats..
-000187f0: 2020 2020 2020 2020 6e75 6d20 3d20 7365          num = se
-00018800: 6c66 2e73 656c 6563 745f 6474 7970 6573  lf.select_dtypes
-00018810: 2869 6e63 6c75 6465 3d5b 226e 756d 6265  (include=["numbe
-00018820: 7222 2c20 2262 6f6f 6c22 5d2c 2065 7863  r", "bool"], exc
-00018830: 6c75 6465 3d5b 6e70 2e74 696d 6564 656c  lude=[np.timedel
-00018840: 7461 3634 5d29 0a0a 2020 2020 2020 2020  ta64])..        
-00018850: 7661 6c75 6573 5f64 7479 7065 203d 206e  values_dtype = n
-00018860: 756d 2e76 616c 7565 732e 6474 7970 650a  um.values.dtype.
-00018870: 2020 2020 2020 2020 6172 7261 795f 7661          array_va
-00018880: 6c75 6573 203d 206e 756d 2e76 616c 7565  lues = num.value
-00018890: 730a 0a20 2020 2020 2020 2069 6620 6e6f  s..        if no
-000188a0: 7420 6e70 2e69 7373 7562 6474 7970 6528  t np.issubdtype(
-000188b0: 7661 6c75 6573 5f64 7479 7065 2c20 6e70  values_dtype, np
-000188c0: 2e6e 756d 6265 7229 3a0a 2020 2020 2020  .number):.      
-000188d0: 2020 2020 2020 6172 7261 795f 7661 6c75        array_valu
-000188e0: 6573 203d 206e 756d 2e76 616c 7565 732e  es = num.values.
-000188f0: 6173 7479 7065 2822 6638 2229 0a0a 2020  astype("f8")..  
-00018900: 2020 2020 2020 6172 7261 795f 736b 6577        array_skew
-00018910: 203d 2064 615f 7374 6174 732e 736b 6577   = da_stats.skew
-00018920: 280a 2020 2020 2020 2020 2020 2020 6172  (.            ar
-00018930: 7261 795f 7661 6c75 6573 2c20 6178 6973  ray_values, axis
-00018940: 3d30 2c20 6269 6173 3d62 6961 732c 206e  =0, bias=bias, n
-00018950: 616e 5f70 6f6c 6963 793d 6e61 6e5f 706f  an_policy=nan_po
-00018960: 6c69 6379 0a20 2020 2020 2020 2029 0a0a  licy.        )..
-00018970: 2020 2020 2020 2020 6e61 6d65 203d 2073          name = s
-00018980: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
-00018990: 7820 2b20 2276 6172 2d6e 756d 6572 6963  x + "var-numeric
-000189a0: 2220 2b20 746f 6b65 6e69 7a65 286e 756d  " + tokenize(num
-000189b0: 290a 2020 2020 2020 2020 636f 6c73 203d  ).        cols =
-000189c0: 206e 756d 2e5f 6d65 7461 2e63 6f6c 756d   num._meta.colum
-000189d0: 6e73 2069 6620 6973 5f64 6174 6166 7261  ns if is_datafra
-000189e0: 6d65 5f6c 696b 6528 6e75 6d29 2065 6c73  me_like(num) els
-000189f0: 6520 4e6f 6e65 0a0a 2020 2020 2020 2020  e None..        
-00018a00: 7769 7468 2063 6865 636b 5f72 6564 7563  with check_reduc
-00018a10: 7469 6f6e 735f 7275 6e74 696d 655f 7761  tions_runtime_wa
-00018a20: 726e 696e 6728 293a 0a20 2020 2020 2020  rning():.       
-00018a30: 2020 2020 2073 6b65 775f 7368 6170 6520       skew_shape 
-00018a40: 3d20 6e75 6d2e 5f6d 6574 615f 6e6f 6e65  = num._meta_none
-00018a50: 6d70 7479 2e76 6172 2861 7869 733d 3029  mpty.var(axis=0)
-00018a60: 2e73 6861 7065 0a20 2020 2020 2020 2061  .shape.        a
-00018a70: 7272 6179 5f73 6b65 775f 6e61 6d65 203d  rray_skew_name =
-00018a80: 2028 6172 7261 795f 736b 6577 2e5f 6e61   (array_skew._na
-00018a90: 6d65 2c29 202b 2028 302c 2920 2a20 6c65  me,) + (0,) * le
-00018aa0: 6e28 736b 6577 5f73 6861 7065 290a 0a20  n(skew_shape).. 
-00018ab0: 2020 2020 2020 206c 6179 6572 203d 207b         layer = {
-00018ac0: 286e 616d 652c 2030 293a 2028 6d65 7468  (name, 0): (meth
-00018ad0: 6f64 732e 7772 6170 5f73 6b65 775f 7265  ods.wrap_skew_re
-00018ae0: 6475 6374 696f 6e2c 2061 7272 6179 5f73  duction, array_s
-00018af0: 6b65 775f 6e61 6d65 2c20 636f 6c73 297d  kew_name, cols)}
-00018b00: 0a20 2020 2020 2020 2067 7261 7068 203d  .        graph =
-00018b10: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
-00018b20: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
-00018b30: 286e 616d 652c 206c 6179 6572 2c20 6465  (name, layer, de
-00018b40: 7065 6e64 656e 6369 6573 3d5b 6172 7261  pendencies=[arra
-00018b50: 795f 736b 6577 5d29 0a0a 2020 2020 2020  y_skew])..      
-00018b60: 2020 7265 7475 726e 206e 6577 5f64 645f    return new_dd_
-00018b70: 6f62 6a65 6374 280a 2020 2020 2020 2020  object(.        
-00018b80: 2020 2020 6772 6170 682c 206e 616d 652c      graph, name,
-00018b90: 206e 756d 2e5f 6d65 7461 5f6e 6f6e 656d   num._meta_nonem
-00018ba0: 7074 792e 736b 6577 2829 2c20 6469 7669  pty.skew(), divi
-00018bb0: 7369 6f6e 733d 5b4e 6f6e 652c 204e 6f6e  sions=[None, Non
-00018bc0: 655d 0a20 2020 2020 2020 2029 0a0a 2020  e].        )..  
-00018bd0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00018be0: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-00018bf0: 2020 6465 6620 6b75 7274 6f73 6973 280a    def kurtosis(.
-00018c00: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00018c10: 2020 2020 2020 6178 6973 3d30 2c0a 2020        axis=0,.  
-00018c20: 2020 2020 2020 6669 7368 6572 3d54 7275        fisher=Tru
-00018c30: 652c 0a20 2020 2020 2020 2062 6961 733d  e,.        bias=
-00018c40: 5472 7565 2c0a 2020 2020 2020 2020 6e61  True,.        na
-00018c50: 6e5f 706f 6c69 6379 3d22 7072 6f70 6167  n_policy="propag
-00018c60: 6174 6522 2c0a 2020 2020 2020 2020 6f75  ate",.        ou
-00018c70: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
-00018c80: 6e75 6d65 7269 635f 6f6e 6c79 3d6e 6f5f  numeric_only=no_
-00018c90: 6465 6661 756c 742c 0a20 2020 2029 3a0a  default,.    ):.
-00018ca0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00018cb0: 2020 2020 2e2e 206e 6f74 653a 3a0a 0a20      .. note::.. 
-00018cc0: 2020 2020 2020 2020 2020 5468 6973 2069            This i
-00018cd0: 6d70 6c65 6d65 6e74 6174 696f 6e20 666f  mplementation fo
-00018ce0: 6c6c 6f77 7320 7468 6520 6461 736b 2e61  llows the dask.a
-00018cf0: 7272 6179 2e73 7461 7473 2069 6d70 6c65  rray.stats imple
-00018d00: 6d65 6e74 6174 696f 6e0a 2020 2020 2020  mentation.      
-00018d10: 2020 2020 206f 6620 6b75 7274 6f73 6973       of kurtosis
-00018d20: 2061 6e64 2063 616c 6375 6c61 7465 7320   and calculates 
-00018d30: 6b75 7274 6f73 6973 2077 6974 686f 7574  kurtosis without
-00018d40: 2074 616b 696e 6720 696e 746f 2061 6363   taking into acc
-00018d50: 6f75 6e74 0a20 2020 2020 2020 2020 2020  ount.           
-00018d60: 6120 6269 6173 2074 6572 6d20 666f 7220  a bias term for 
-00018d70: 6669 6e69 7465 2073 616d 706c 6520 7369  finite sample si
-00018d80: 7a65 2c20 7768 6963 6820 636f 7272 6573  ze, which corres
-00018d90: 706f 6e64 7320 746f 2074 6865 0a20 2020  ponds to the.   
-00018da0: 2020 2020 2020 2020 6465 6661 756c 7420          default 
-00018db0: 7365 7474 696e 6773 206f 6620 7468 6520  settings of the 
-00018dc0: 7363 6970 792e 7374 6174 7320 6b75 7274  scipy.stats kurt
-00018dd0: 6f73 6973 2063 616c 6375 6c61 7469 6f6e  osis calculation
-00018de0: 2e20 5468 6973 2064 6966 6665 7273 0a20  . This differs. 
-00018df0: 2020 2020 2020 2020 2020 6672 6f6d 2070            from p
-00018e00: 616e 6461 732e 0a0a 2020 2020 2020 2020  andas...        
-00018e10: 2020 2046 7572 7468 6572 2c20 7468 6973     Further, this
-00018e20: 206d 6574 686f 6420 6375 7272 656e 746c   method currentl
-00018e30: 7920 646f 6573 206e 6f74 2073 7570 706f  y does not suppo
-00018e40: 7274 2066 696c 7465 7269 6e67 206f 7574  rt filtering out
-00018e50: 204e 614e 0a20 2020 2020 2020 2020 2020   NaN.           
-00018e60: 7661 6c75 6573 2c20 7768 6963 6820 6973  values, which is
-00018e70: 2061 6761 696e 2061 2064 6966 6665 7265   again a differe
-00018e80: 6e63 6520 746f 2050 616e 6461 732e 0a20  nce to Pandas.. 
-00018e90: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00018ea0: 2020 2069 6620 5041 4e44 4153 5f47 545f     if PANDAS_GT_
-00018eb0: 3230 3020 616e 6420 6178 6973 2069 7320  200 and axis is 
-00018ec0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00018ed0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00018ee0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00018ef0: 2020 2020 2260 6178 6973 3d4e 6f6e 6560      "`axis=None`
-00018f00: 2069 736e 2774 2063 7572 7265 6e74 6c79   isn't currently
-00018f10: 2073 7570 706f 7274 6564 2066 6f72 2060   supported for `
-00018f20: 6b75 7274 6f73 6973 6020 7768 656e 2075  kurtosis` when u
-00018f30: 7369 6e67 2060 7061 6e64 6173 203e 3d32  sing `pandas >=2
-00018f40: 6020 220a 2020 2020 2020 2020 2020 2020  ` ".            
-00018f50: 2020 2020 6622 2870 616e 6461 733d 7b73      f"(pandas={s
-00018f60: 7472 2850 414e 4441 535f 5645 5253 494f  tr(PANDAS_VERSIO
-00018f70: 4e29 7d20 6973 2069 6e73 7461 6c6c 6564  N)} is installed
-00018f80: 292e 220a 2020 2020 2020 2020 2020 2020  ).".            
-00018f90: 290a 2020 2020 2020 2020 6178 6973 203d  ).        axis =
-00018fa0: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
-00018fb0: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
-00018fc0: 2020 205f 7261 6973 655f 6966 5f6f 626a     _raise_if_obj
-00018fd0: 6563 745f 7365 7269 6573 2873 656c 662c  ect_series(self,
-00018fe0: 2022 6b75 7274 6f73 6973 2229 0a20 2020   "kurtosis").   
-00018ff0: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
-00019000: 795f 6b77 6172 6773 203d 2067 6574 5f6e  y_kwargs = get_n
-00019010: 756d 6572 6963 5f6f 6e6c 795f 6b77 6172  umeric_only_kwar
-00019020: 6773 286e 756d 6572 6963 5f6f 6e6c 7929  gs(numeric_only)
-00019030: 0a0a 2020 2020 2020 2020 6966 2069 735f  ..        if is_
-00019040: 6461 7461 6672 616d 655f 6c69 6b65 2873  dataframe_like(s
-00019050: 656c 6629 3a0a 2020 2020 2020 2020 2020  elf):.          
-00019060: 2020 2320 4c65 7420 7061 6e64 6173 2072    # Let pandas r
-00019070: 6169 7365 2065 7272 6f72 7320 6966 206e  aise errors if n
-00019080: 6563 6573 7361 7279 0a20 2020 2020 2020  ecessary.       
-00019090: 2020 2020 206d 6574 6120 3d20 7365 6c66       meta = self
-000190a0: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
-000190b0: 6b75 7274 6f73 6973 2861 7869 733d 6178  kurtosis(axis=ax
-000190c0: 6973 2c20 2a2a 6e75 6d65 7269 635f 6f6e  is, **numeric_on
-000190d0: 6c79 5f6b 7761 7267 7329 0a20 2020 2020  ly_kwargs).     
-000190e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000190f0: 2020 2020 206d 6574 6120 3d20 7365 6c66       meta = self
-00019100: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
-00019110: 6b75 7274 6f73 6973 2829 0a0a 2020 2020  kurtosis()..    
-00019120: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
-00019130: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00019140: 7375 6c74 203d 206d 6170 5f70 6172 7469  sult = map_parti
-00019150: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
-00019160: 2020 2020 2020 204d 2e6b 7572 746f 7369         M.kurtosi
-00019170: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00019180: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00019190: 2020 2020 2020 2020 206d 6574 613d 6d65           meta=me
-000191a0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-000191b0: 2020 2020 746f 6b65 6e3d 7365 6c66 2e5f      token=self._
-000191c0: 746f 6b65 6e5f 7072 6566 6978 202b 2022  token_prefix + "
-000191d0: 6b75 7274 6f73 6973 222c 0a20 2020 2020  kurtosis",.     
-000191e0: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-000191f0: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
-00019200: 2020 2020 2020 656e 666f 7263 655f 6d65        enforce_me
-00019210: 7461 6461 7461 3d46 616c 7365 2c0a 2020  tadata=False,.  
-00019220: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00019230: 2020 2020 2020 2020 7265 7475 726e 2068          return h
-00019240: 616e 646c 655f 6f75 7428 6f75 742c 2072  andle_out(out, r
-00019250: 6573 756c 7429 0a20 2020 2020 2020 2065  esult).        e
-00019260: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00019270: 2069 6620 7365 6c66 2e6e 6469 6d20 3d3d   if self.ndim ==
-00019280: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00019290: 2020 2020 7265 7375 6c74 203d 2073 656c      result = sel
-000192a0: 662e 5f6b 7572 746f 7369 735f 3164 280a  f._kurtosis_1d(.
-000192b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000192c0: 2020 2020 7365 6c66 2c20 6669 7368 6572      self, fisher
-000192d0: 3d66 6973 6865 722c 2062 6961 733d 6269  =fisher, bias=bi
-000192e0: 6173 2c20 6e61 6e5f 706f 6c69 6379 3d6e  as, nan_policy=n
-000192f0: 616e 5f70 6f6c 6963 790a 2020 2020 2020  an_policy.      
-00019300: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00019310: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00019320: 726e 2068 616e 646c 655f 6f75 7428 6f75  rn handle_out(ou
-00019330: 742c 2072 6573 756c 7429 0a20 2020 2020  t, result).     
-00019340: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00019350: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00019360: 756c 7420 3d20 7365 6c66 2e5f 6b75 7274  ult = self._kurt
-00019370: 6f73 6973 5f6e 756d 6572 6963 280a 2020  osis_numeric(.  
-00019380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019390: 2020 6669 7368 6572 3d66 6973 6865 722c    fisher=fisher,
-000193a0: 2062 6961 733d 6269 6173 2c20 6e61 6e5f   bias=bias, nan_
-000193b0: 706f 6c69 6379 3d6e 616e 5f70 6f6c 6963  policy=nan_polic
-000193c0: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
-000193d0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-000193e0: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
-000193f0: 656c 662c 2044 6174 6146 7261 6d65 293a  elf, DataFrame):
-00019400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019410: 2072 6573 756c 742e 6469 7669 7369 6f6e   result.division
-00019420: 7320 3d20 2873 656c 662e 636f 6c75 6d6e  s = (self.column
-00019430: 732e 6d69 6e28 292c 2073 656c 662e 636f  s.min(), self.co
-00019440: 6c75 6d6e 732e 6d61 7828 2929 0a0a 2020  lumns.max())..  
-00019450: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00019460: 2068 616e 646c 655f 6f75 7428 6f75 742c   handle_out(out,
-00019470: 2072 6573 756c 7429 0a0a 2020 2020 6465   result)..    de
-00019480: 6620 5f6b 7572 746f 7369 735f 3164 2873  f _kurtosis_1d(s
-00019490: 656c 662c 2063 6f6c 756d 6e2c 2066 6973  elf, column, fis
-000194a0: 6865 723d 5472 7565 2c20 6269 6173 3d54  her=True, bias=T
-000194b0: 7275 652c 206e 616e 5f70 6f6c 6963 793d  rue, nan_policy=
-000194c0: 2270 726f 7061 6761 7465 2229 3a0a 2020  "propagate"):.  
-000194d0: 2020 2020 2020 2222 2231 4420 7665 7273        """1D vers
-000194e0: 696f 6e20 6f66 2074 6865 206b 7572 746f  ion of the kurto
-000194f0: 7369 7320 6361 6c63 756c 6174 696f 6e2e  sis calculation.
-00019500: 0a0a 2020 2020 2020 2020 5573 6573 2074  ..        Uses t
-00019510: 6865 2061 7272 6179 2076 6572 7369 6f6e  he array version
-00019520: 2066 726f 6d20 6461 2e73 7461 7473 2069   from da.stats i
-00019530: 6e20 6361 7365 2077 6520 6172 6520 7061  n case we are pa
-00019540: 7373 696e 6720 696e 2061 2073 696e 676c  ssing in a singl
-00019550: 6520 7365 7269 6573 0a20 2020 2020 2020  e series.       
-00019560: 2022 2222 0a20 2020 2020 2020 2023 2069   """.        # i
-00019570: 6d70 6f72 7420 6465 7065 6e64 7320 6f6e  mport depends on
-00019580: 2073 6369 7079 2c20 6e6f 7420 696e 7374   scipy, not inst
-00019590: 616c 6c65 6420 6279 2064 6566 6175 6c74  alled by default
-000195a0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
-000195b0: 736b 2e61 7272 6179 2069 6d70 6f72 7420  sk.array import 
-000195c0: 7374 6174 7320 6173 2064 615f 7374 6174  stats as da_stat
-000195d0: 730a 0a20 2020 2020 2020 2069 6620 7064  s..        if pd
-000195e0: 2e61 7069 2e74 7970 6573 2e69 735f 6578  .api.types.is_ex
-000195f0: 7465 6e73 696f 6e5f 6172 7261 795f 6474  tension_array_dt
-00019600: 7970 6528 636f 6c75 6d6e 2e5f 6d65 7461  ype(column._meta
-00019610: 5f6e 6f6e 656d 7074 7929 3a0a 2020 2020  _nonempty):.    
-00019620: 2020 2020 2020 2020 636f 6c75 6d6e 203d          column =
-00019630: 2063 6f6c 756d 6e2e 6173 7479 7065 2822   column.astype("
-00019640: 6638 2229 0a0a 2020 2020 2020 2020 656c  f8")..        el
-00019650: 6966 206e 6f74 206e 702e 6973 7375 6264  if not np.issubd
-00019660: 7479 7065 2863 6f6c 756d 6e2e 6474 7970  type(column.dtyp
-00019670: 652c 206e 702e 6e75 6d62 6572 293a 0a20  e, np.number):. 
-00019680: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-00019690: 6e20 3d20 636f 6c75 6d6e 2e61 7374 7970  n = column.astyp
-000196a0: 6528 2266 3822 290a 0a20 2020 2020 2020  e("f8")..       
-000196b0: 206e 616d 6520 3d20 7365 6c66 2e5f 746f   name = self._to
-000196c0: 6b65 6e5f 7072 6566 6978 202b 2022 6b75  ken_prefix + "ku
-000196d0: 7274 6f73 6973 2d31 642d 2220 2b20 746f  rtosis-1d-" + to
-000196e0: 6b65 6e69 7a65 2863 6f6c 756d 6e29 0a0a  kenize(column)..
-000196f0: 2020 2020 2020 2020 6172 7261 795f 6b75          array_ku
-00019700: 7274 6f73 6973 203d 2064 615f 7374 6174  rtosis = da_stat
-00019710: 732e 6b75 7274 6f73 6973 280a 2020 2020  s.kurtosis(.    
-00019720: 2020 2020 2020 2020 636f 6c75 6d6e 2e76          column.v
-00019730: 616c 7565 732c 2061 7869 733d 302c 2066  alues, axis=0, f
-00019740: 6973 6865 723d 6669 7368 6572 2c20 6269  isher=fisher, bi
-00019750: 6173 3d62 6961 732c 206e 616e 5f70 6f6c  as=bias, nan_pol
-00019760: 6963 793d 6e61 6e5f 706f 6c69 6379 0a20  icy=nan_policy. 
-00019770: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00019780: 2020 6c61 7965 7220 3d20 7b0a 2020 2020    layer = {.    
-00019790: 2020 2020 2020 2020 286e 616d 652c 2030          (name, 0
-000197a0: 293a 2028 6d65 7468 6f64 732e 7772 6170  ): (methods.wrap
-000197b0: 5f6b 7572 746f 7369 735f 7265 6475 6374  _kurtosis_reduct
-000197c0: 696f 6e2c 2028 6172 7261 795f 6b75 7274  ion, (array_kurt
-000197d0: 6f73 6973 2e5f 6e61 6d65 2c29 2c20 4e6f  osis._name,), No
-000197e0: 6e65 290a 2020 2020 2020 2020 7d0a 2020  ne).        }.  
-000197f0: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
-00019800: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-00019810: 6d5f 636f 6c6c 6563 7469 6f6e 7328 0a20  m_collections(. 
-00019820: 2020 2020 2020 2020 2020 206e 616d 652c             name,
-00019830: 206c 6179 6572 2c20 6465 7065 6e64 656e   layer, dependen
-00019840: 6369 6573 3d5b 6172 7261 795f 6b75 7274  cies=[array_kurt
-00019850: 6f73 6973 5d0a 2020 2020 2020 2020 290a  osis].        ).
-00019860: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00019870: 6e65 775f 6464 5f6f 626a 6563 7428 0a20  new_dd_object(. 
-00019880: 2020 2020 2020 2020 2020 2067 7261 7068             graph
-00019890: 2c20 6e61 6d65 2c20 636f 6c75 6d6e 2e5f  , name, column._
-000198a0: 6d65 7461 5f6e 6f6e 656d 7074 792e 6b75  meta_nonempty.ku
-000198b0: 7274 6f73 6973 2829 2c20 6469 7669 7369  rtosis(), divisi
-000198c0: 6f6e 733d 5b4e 6f6e 652c 204e 6f6e 655d  ons=[None, None]
-000198d0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000198e0: 6465 6620 5f6b 7572 746f 7369 735f 6e75  def _kurtosis_nu
-000198f0: 6d65 7269 6328 7365 6c66 2c20 6669 7368  meric(self, fish
-00019900: 6572 3d54 7275 652c 2062 6961 733d 5472  er=True, bias=Tr
-00019910: 7565 2c20 6e61 6e5f 706f 6c69 6379 3d22  ue, nan_policy="
-00019920: 7072 6f70 6167 6174 6522 293a 0a20 2020  propagate"):.   
-00019930: 2020 2020 2022 2222 4d65 7468 6f64 2066       """Method f
-00019940: 6f72 2064 6174 6166 7261 6d65 7320 7769  or dataframes wi
-00019950: 7468 206e 756d 6572 6963 2063 6f6c 756d  th numeric colum
-00019960: 6e73 2e0a 0a20 2020 2020 2020 204d 6170  ns...        Map
-00019970: 7320 7468 6520 6172 7261 7920 7665 7273  s the array vers
-00019980: 696f 6e20 6672 6f6d 2064 612e 7374 6174  ion from da.stat
-00019990: 7320 6f6e 746f 2074 6865 206e 756d 6572  s onto the numer
-000199a0: 6963 2061 7272 6179 206f 6620 636f 6c75  ic array of colu
-000199b0: 6d6e 732e 0a20 2020 2020 2020 2022 2222  mns..        """
-000199c0: 0a20 2020 2020 2020 2023 2069 6d70 6f72  .        # impor
-000199d0: 7420 6465 7065 6e64 7320 6f6e 2073 6369  t depends on sci
-000199e0: 7079 2c20 6e6f 7420 696e 7374 616c 6c65  py, not installe
-000199f0: 6420 6279 2064 6566 6175 6c74 0a20 2020  d by default.   
-00019a00: 2020 2020 2066 726f 6d20 6461 736b 2e61       from dask.a
-00019a10: 7272 6179 2069 6d70 6f72 7420 7374 6174  rray import stat
-00019a20: 7320 6173 2064 615f 7374 6174 730a 0a20  s as da_stats.. 
-00019a30: 2020 2020 2020 206e 756d 203d 2073 656c         num = sel
-00019a40: 662e 7365 6c65 6374 5f64 7479 7065 7328  f.select_dtypes(
-00019a50: 696e 636c 7564 653d 5b22 6e75 6d62 6572  include=["number
-00019a60: 222c 2022 626f 6f6c 225d 2c20 6578 636c  ", "bool"], excl
-00019a70: 7564 653d 5b6e 702e 7469 6d65 6465 6c74  ude=[np.timedelt
-00019a80: 6136 345d 290a 0a20 2020 2020 2020 2076  a64])..        v
-00019a90: 616c 7565 735f 6474 7970 6520 3d20 6e75  alues_dtype = nu
-00019aa0: 6d2e 7661 6c75 6573 2e64 7479 7065 0a20  m.values.dtype. 
-00019ab0: 2020 2020 2020 2061 7272 6179 5f76 616c         array_val
-00019ac0: 7565 7320 3d20 6e75 6d2e 7661 6c75 6573  ues = num.values
-00019ad0: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-00019ae0: 206e 702e 6973 7375 6264 7479 7065 2876   np.issubdtype(v
-00019af0: 616c 7565 735f 6474 7970 652c 206e 702e  alues_dtype, np.
-00019b00: 6e75 6d62 6572 293a 0a20 2020 2020 2020  number):.       
-00019b10: 2020 2020 2061 7272 6179 5f76 616c 7565       array_value
-00019b20: 7320 3d20 6e75 6d2e 7661 6c75 6573 2e61  s = num.values.a
-00019b30: 7374 7970 6528 2266 3822 290a 0a20 2020  stype("f8")..   
-00019b40: 2020 2020 2061 7272 6179 5f6b 7572 746f       array_kurto
-00019b50: 7369 7320 3d20 6461 5f73 7461 7473 2e6b  sis = da_stats.k
-00019b60: 7572 746f 7369 7328 0a20 2020 2020 2020  urtosis(.       
-00019b70: 2020 2020 2061 7272 6179 5f76 616c 7565       array_value
-00019b80: 732c 2061 7869 733d 302c 2066 6973 6865  s, axis=0, fishe
-00019b90: 723d 6669 7368 6572 2c20 6269 6173 3d62  r=fisher, bias=b
-00019ba0: 6961 732c 206e 616e 5f70 6f6c 6963 793d  ias, nan_policy=
-00019bb0: 6e61 6e5f 706f 6c69 6379 0a20 2020 2020  nan_policy.     
-00019bc0: 2020 2029 0a0a 2020 2020 2020 2020 6e61     )..        na
-00019bd0: 6d65 203d 2073 656c 662e 5f74 6f6b 656e  me = self._token
-00019be0: 5f70 7265 6669 7820 2b20 226b 7572 746f  _prefix + "kurto
-00019bf0: 7369 732d 6e75 6d65 7269 6322 202b 2074  sis-numeric" + t
-00019c00: 6f6b 656e 697a 6528 6e75 6d29 0a20 2020  okenize(num).   
-00019c10: 2020 2020 2063 6f6c 7320 3d20 6e75 6d2e       cols = num.
-00019c20: 5f6d 6574 612e 636f 6c75 6d6e 7320 6966  _meta.columns if
-00019c30: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
-00019c40: 6b65 286e 756d 2920 656c 7365 204e 6f6e  ke(num) else Non
-00019c50: 650a 0a20 2020 2020 2020 2077 6974 6820  e..        with 
-00019c60: 6368 6563 6b5f 7265 6475 6374 696f 6e73  check_reductions
-00019c70: 5f72 756e 7469 6d65 5f77 6172 6e69 6e67  _runtime_warning
-00019c80: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00019c90: 6b75 7274 6f73 6973 5f73 6861 7065 203d  kurtosis_shape =
-00019ca0: 206e 756d 2e5f 6d65 7461 5f6e 6f6e 656d   num._meta_nonem
-00019cb0: 7074 792e 7661 7228 6178 6973 3d30 292e  pty.var(axis=0).
-00019cc0: 7368 6170 650a 2020 2020 2020 2020 6172  shape.        ar
-00019cd0: 7261 795f 6b75 7274 6f73 6973 5f6e 616d  ray_kurtosis_nam
-00019ce0: 6520 3d20 2861 7272 6179 5f6b 7572 746f  e = (array_kurto
-00019cf0: 7369 732e 5f6e 616d 652c 2920 2b20 2830  sis._name,) + (0
-00019d00: 2c29 202a 206c 656e 286b 7572 746f 7369  ,) * len(kurtosi
-00019d10: 735f 7368 6170 6529 0a0a 2020 2020 2020  s_shape)..      
-00019d20: 2020 6c61 7965 7220 3d20 7b0a 2020 2020    layer = {.    
-00019d30: 2020 2020 2020 2020 286e 616d 652c 2030          (name, 0
-00019d40: 293a 2028 6d65 7468 6f64 732e 7772 6170  ): (methods.wrap
-00019d50: 5f6b 7572 746f 7369 735f 7265 6475 6374  _kurtosis_reduct
-00019d60: 696f 6e2c 2061 7272 6179 5f6b 7572 746f  ion, array_kurto
-00019d70: 7369 735f 6e61 6d65 2c20 636f 6c73 290a  sis_name, cols).
-00019d80: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00019d90: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-00019da0: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-00019db0: 6c6c 6563 7469 6f6e 7328 0a20 2020 2020  llections(.     
-00019dc0: 2020 2020 2020 206e 616d 652c 206c 6179         name, lay
-00019dd0: 6572 2c20 6465 7065 6e64 656e 6369 6573  er, dependencies
-00019de0: 3d5b 6172 7261 795f 6b75 7274 6f73 6973  =[array_kurtosis
-00019df0: 5d0a 2020 2020 2020 2020 290a 0a20 2020  ].        )..   
-00019e00: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
-00019e10: 6464 5f6f 626a 6563 7428 0a20 2020 2020  dd_object(.     
-00019e20: 2020 2020 2020 2067 7261 7068 2c20 6e61         graph, na
-00019e30: 6d65 2c20 6e75 6d2e 5f6d 6574 615f 6e6f  me, num._meta_no
-00019e40: 6e65 6d70 7479 2e6b 7572 746f 7369 7328  nempty.kurtosis(
-00019e50: 292c 2064 6976 6973 696f 6e73 3d5b 4e6f  ), divisions=[No
-00019e60: 6e65 2c20 4e6f 6e65 5d0a 2020 2020 2020  ne, None].      
-00019e70: 2020 290a 0a20 2020 2040 5f6e 756d 6572    )..    @_numer
-00019e80: 6963 5f6f 6e6c 790a 2020 2020 4064 6572  ic_only.    @der
-00019e90: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00019ea0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00019eb0: 7365 6d28 7365 6c66 2c20 6178 6973 3d4e  sem(self, axis=N
-00019ec0: 6f6e 652c 2073 6b69 706e 613d 5472 7565  one, skipna=True
-00019ed0: 2c20 6464 6f66 3d31 2c20 7370 6c69 745f  , ddof=1, split_
-00019ee0: 6576 6572 793d 4661 6c73 652c 206e 756d  every=False, num
-00019ef0: 6572 6963 5f6f 6e6c 793d 4e6f 6e65 293a  eric_only=None):
-00019f00: 0a20 2020 2020 2020 2061 7869 7320 3d20  .        axis = 
-00019f10: 7365 6c66 2e5f 7661 6c69 6461 7465 5f61  self._validate_a
-00019f20: 7869 7328 6178 6973 290a 2020 2020 2020  xis(axis).      
-00019f30: 2020 5f72 6169 7365 5f69 665f 6f62 6a65    _raise_if_obje
-00019f40: 6374 5f73 6572 6965 7328 7365 6c66 2c20  ct_series(self, 
-00019f50: 2273 656d 2229 0a20 2020 2020 2020 2077  "sem").        w
-00019f60: 6974 6820 6368 6563 6b5f 6e75 6d65 7269  ith check_numeri
-00019f70: 635f 6f6e 6c79 5f64 6570 7265 6361 7469  c_only_deprecati
-00019f80: 6f6e 2829 3a0a 2020 2020 2020 2020 2020  on():.          
-00019f90: 2020 6d65 7461 203d 2073 656c 662e 5f6d    meta = self._m
-00019fa0: 6574 615f 6e6f 6e65 6d70 7479 2e73 656d  eta_nonempty.sem
-00019fb0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00019fc0: 2020 6178 6973 3d61 7869 732c 2073 6b69    axis=axis, ski
-00019fd0: 706e 613d 736b 6970 6e61 2c20 6464 6f66  pna=skipna, ddof
-00019fe0: 3d64 646f 662c 206e 756d 6572 6963 5f6f  =ddof, numeric_o
-00019ff0: 6e6c 793d 6e75 6d65 7269 635f 6f6e 6c79  nly=numeric_only
-0001a000: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0001a010: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
-0001a020: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-0001a030: 2072 6574 7572 6e20 6d61 705f 7061 7274   return map_part
-0001a040: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
-0001a050: 2020 2020 2020 2020 4d2e 7365 6d2c 0a20          M.sem,. 
-0001a060: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001a070: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-0001a080: 2020 2020 206d 6574 613d 6d65 7461 2c0a       meta=meta,.
-0001a090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a0a0: 746f 6b65 6e3d 7365 6c66 2e5f 746f 6b65  token=self._toke
-0001a0b0: 6e5f 7072 6566 6978 202b 2022 7365 6d22  n_prefix + "sem"
-0001a0c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001a0d0: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
-0001a0e0: 2020 2020 2020 2020 2020 2020 2073 6b69               ski
-0001a0f0: 706e 613d 736b 6970 6e61 2c0a 2020 2020  pna=skipna,.    
-0001a100: 2020 2020 2020 2020 2020 2020 6464 6f66              ddof
-0001a110: 3d64 646f 662c 0a20 2020 2020 2020 2020  =ddof,.         
-0001a120: 2020 2020 2020 2070 6172 656e 745f 6d65         parent_me
-0001a130: 7461 3d73 656c 662e 5f6d 6574 612c 0a20  ta=self._meta,. 
-0001a140: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0001a150: 756d 6572 6963 5f6f 6e6c 793d 6e75 6d65  umeric_only=nume
-0001a160: 7269 635f 6f6e 6c79 2c0a 2020 2020 2020  ric_only,.      
-0001a170: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001a180: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001a190: 2020 6e75 6d20 3d20 7365 6c66 2e5f 6765    num = self._ge
-0001a1a0: 745f 6e75 6d65 7269 635f 6461 7461 2829  t_numeric_data()
-0001a1b0: 0a20 2020 2020 2020 2020 2020 2076 203d  .            v =
-0001a1c0: 206e 756d 2e76 6172 2873 6b69 706e 613d   num.var(skipna=
-0001a1d0: 736b 6970 6e61 2c20 6464 6f66 3d64 646f  skipna, ddof=ddo
-0001a1e0: 662c 2073 706c 6974 5f65 7665 7279 3d73  f, split_every=s
-0001a1f0: 706c 6974 5f65 7665 7279 290a 2020 2020  plit_every).    
-0001a200: 2020 2020 2020 2020 6e20 3d20 6e75 6d2e          n = num.
-0001a210: 636f 756e 7428 7370 6c69 745f 6576 6572  count(split_ever
-0001a220: 793d 7370 6c69 745f 6576 6572 7929 0a20  y=split_every). 
-0001a230: 2020 2020 2020 2020 2020 206e 616d 6520             name 
-0001a240: 3d20 7365 6c66 2e5f 746f 6b65 6e5f 7072  = self._token_pr
-0001a250: 6566 6978 202b 2022 7365 6d22 0a20 2020  efix + "sem".   
-0001a260: 2020 2020 2020 2020 2072 6573 756c 7420           result 
-0001a270: 3d20 6d61 705f 7061 7274 6974 696f 6e73  = map_partitions
-0001a280: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001a290: 2020 6e70 2e73 7172 742c 0a20 2020 2020    np.sqrt,.     
-0001a2a0: 2020 2020 2020 2020 2020 2076 202f 206e             v / n
-0001a2b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001a2c0: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
-0001a2d0: 2020 2020 2020 2020 2020 2020 2074 6f6b               tok
-0001a2e0: 656e 3d6e 616d 652c 0a20 2020 2020 2020  en=name,.       
-0001a2f0: 2020 2020 2020 2020 2065 6e66 6f72 6365           enforce
-0001a300: 5f6d 6574 6164 6174 613d 4661 6c73 652c  _metadata=False,
-0001a310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a320: 2070 6172 656e 745f 6d65 7461 3d73 656c   parent_meta=sel
-0001a330: 662e 5f6d 6574 612c 0a20 2020 2020 2020  f._meta,.       
-0001a340: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0001a350: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0001a360: 6528 7365 6c66 2c20 4461 7461 4672 616d  e(self, DataFram
-0001a370: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-0001a380: 2020 2020 7265 7375 6c74 2e64 6976 6973      result.divis
-0001a390: 696f 6e73 203d 2028 7365 6c66 2e63 6f6c  ions = (self.col
-0001a3a0: 756d 6e73 2e6d 696e 2829 2c20 7365 6c66  umns.min(), self
-0001a3b0: 2e63 6f6c 756d 6e73 2e6d 6178 2829 290a  .columns.max()).
-0001a3c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001a3d0: 726e 2072 6573 756c 740a 0a20 2020 2064  rn result..    d
-0001a3e0: 6566 2071 7561 6e74 696c 6528 7365 6c66  ef quantile(self
-0001a3f0: 2c20 713d 302e 352c 2061 7869 733d 302c  , q=0.5, axis=0,
-0001a400: 206e 756d 6572 6963 5f6f 6e6c 793d 6e6f   numeric_only=no
-0001a410: 5f64 6566 6175 6c74 2c20 6d65 7468 6f64  _default, method
-0001a420: 3d22 6465 6661 756c 7422 293a 0a20 2020  ="default"):.   
-0001a430: 2020 2020 2022 2222 4170 7072 6f78 696d       """Approxim
-0001a440: 6174 6520 726f 772d 7769 7365 2061 6e64  ate row-wise and
-0001a450: 2070 7265 6369 7365 2063 6f6c 756d 6e2d   precise column-
-0001a460: 7769 7365 2071 7561 6e74 696c 6573 206f  wise quantiles o
-0001a470: 6620 4461 7461 4672 616d 650a 0a20 2020  f DataFrame..   
-0001a480: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-0001a490: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0001a4a0: 2d2d 0a20 2020 2020 2020 2071 203a 206c  --.        q : l
-0001a4b0: 6973 742f 6172 7261 7920 6f66 2066 6c6f  ist/array of flo
-0001a4c0: 6174 732c 2064 6566 6175 6c74 2030 2e35  ats, default 0.5
-0001a4d0: 2028 3530 2529 0a20 2020 2020 2020 2020   (50%).         
-0001a4e0: 2020 2049 7465 7261 626c 6520 6f66 206e     Iterable of n
-0001a4f0: 756d 6265 7273 2072 616e 6769 6e67 2066  umbers ranging f
-0001a500: 726f 6d20 3020 746f 2031 2066 6f72 2074  rom 0 to 1 for t
-0001a510: 6865 2064 6573 6972 6564 2071 7561 6e74  he desired quant
-0001a520: 696c 6573 0a20 2020 2020 2020 2061 7869  iles.        axi
-0001a530: 7320 3a20 7b30 2c20 312c 2027 696e 6465  s : {0, 1, 'inde
-0001a540: 7827 2c20 2763 6f6c 756d 6e73 277d 2028  x', 'columns'} (
-0001a550: 6465 6661 756c 7420 3029 0a20 2020 2020  default 0).     
-0001a560: 2020 2020 2020 2030 206f 7220 2769 6e64         0 or 'ind
-0001a570: 6578 2720 666f 7220 726f 772d 7769 7365  ex' for row-wise
-0001a580: 2c20 3120 6f72 2027 636f 6c75 6d6e 7327  , 1 or 'columns'
-0001a590: 2066 6f72 2063 6f6c 756d 6e2d 7769 7365   for column-wise
-0001a5a0: 0a20 2020 2020 2020 206d 6574 686f 6420  .        method 
-0001a5b0: 3a20 7b27 6465 6661 756c 7427 2c20 2774  : {'default', 't
-0001a5c0: 6469 6765 7374 272c 2027 6461 736b 277d  digest', 'dask'}
-0001a5d0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-0001a5e0: 2020 2020 2020 2057 6861 7420 6d65 7468         What meth
-0001a5f0: 6f64 2074 6f20 7573 652e 2042 7920 6465  od to use. By de
-0001a600: 6661 756c 7420 7769 6c6c 2075 7365 2064  fault will use d
-0001a610: 6173 6b27 7320 696e 7465 726e 616c 2063  ask's internal c
-0001a620: 7573 746f 6d0a 2020 2020 2020 2020 2020  ustom.          
-0001a630: 2020 616c 676f 7269 7468 6d20 2860 6027    algorithm (``'
-0001a640: 6461 736b 2760 6029 2e20 2049 6620 7365  dask'``).  If se
-0001a650: 7420 746f 2060 6027 7464 6967 6573 7427  t to ``'tdigest'
-0001a660: 6060 2077 696c 6c20 7573 6520 7464 6967  `` will use tdig
-0001a670: 6573 740a 2020 2020 2020 2020 2020 2020  est.            
-0001a680: 666f 7220 666c 6f61 7473 2061 6e64 2069  for floats and i
-0001a690: 6e74 7320 616e 6420 6661 6c6c 6261 636b  nts and fallback
-0001a6a0: 2074 6f20 7468 6520 6060 2764 6173 6b27   to the ``'dask'
-0001a6b0: 6060 206f 7468 6572 7769 7365 2e0a 2020  `` otherwise..  
-0001a6c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001a6d0: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
-0001a6e0: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
-0001a6f0: 7329 0a20 2020 2020 2020 206b 6579 6e61  s).        keyna
-0001a700: 6d65 203d 2022 7175 616e 7469 6c65 732d  me = "quantiles-
-0001a710: 636f 6e63 6174 2d2d 2220 2b20 746f 6b65  concat--" + toke
-0001a720: 6e69 7a65 2873 656c 662c 2071 2c20 6178  nize(self, q, ax
-0001a730: 6973 290a 2020 2020 2020 2020 6e75 6d65  is).        nume
-0001a740: 7269 635f 6b77 6172 6773 203d 2067 6574  ric_kwargs = get
-0001a750: 5f6e 756d 6572 6963 5f6f 6e6c 795f 6b77  _numeric_only_kw
-0001a760: 6172 6773 286e 756d 6572 6963 5f6f 6e6c  args(numeric_onl
-0001a770: 7929 0a0a 2020 2020 2020 2020 7769 7468  y)..        with
-0001a780: 2063 6865 636b 5f6e 756d 6572 6963 5f6f   check_numeric_o
-0001a790: 6e6c 795f 6465 7072 6563 6174 696f 6e28  nly_deprecation(
-0001a7a0: 2271 7561 6e74 696c 6522 2c20 5472 7565  "quantile", True
-0001a7b0: 293a 0a20 2020 2020 2020 2020 2020 206d  ):.            m
-0001a7c0: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
-0001a7d0: 2e71 7561 6e74 696c 6528 712c 2061 7869  .quantile(q, axi
-0001a7e0: 733d 6178 6973 2c20 2a2a 6e75 6d65 7269  s=axis, **numeri
-0001a7f0: 635f 6b77 6172 6773 290a 0a20 2020 2020  c_kwargs)..     
-0001a800: 2020 2069 6620 6178 6973 203d 3d20 313a     if axis == 1:
-0001a810: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001a820: 6973 696e 7374 616e 6365 2871 2c20 6c69  isinstance(q, li
-0001a830: 7374 293a 0a20 2020 2020 2020 2020 2020  st):.           
-0001a840: 2020 2020 2023 204e 6f74 2073 7570 706f       # Not suppo
-0001a850: 7274 6564 2c20 7468 6520 7265 7375 6c74  rted, the result
-0001a860: 2077 696c 6c20 6861 7665 2063 7572 7265   will have curre
-0001a870: 6e74 2069 6e64 6578 2061 7320 636f 6c75  nt index as colu
-0001a880: 6d6e 730a 2020 2020 2020 2020 2020 2020  mns.            
-0001a890: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0001a8a0: 7272 6f72 2822 2771 2720 6d75 7374 2062  rror("'q' must b
-0001a8b0: 6520 7363 616c 6172 2077 6865 6e20 6178  e scalar when ax
-0001a8c0: 6973 3d31 2069 7320 7370 6563 6966 6965  is=1 is specifie
-0001a8d0: 6422 290a 0a20 2020 2020 2020 2020 2020  d")..           
-0001a8e0: 2072 6574 7572 6e20 6d61 705f 7061 7274   return map_part
-0001a8f0: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
-0001a900: 2020 2020 2020 2020 5f67 6574 6174 7472          _getattr
-0001a910: 5f6e 756d 6572 6963 5f6f 6e6c 792c 0a20  _numeric_only,. 
-0001a920: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001a930: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-0001a940: 2020 2020 2071 2c0a 2020 2020 2020 2020       q,.        
-0001a950: 2020 2020 2020 2020 6178 6973 2c0a 2020          axis,.  
-0001a960: 2020 2020 2020 2020 2020 2020 2020 746f                to
-0001a970: 6b65 6e3d 6b65 796e 616d 652c 0a20 2020  ken=keyname,.   
-0001a980: 2020 2020 2020 2020 2020 2020 2065 6e66               enf
-0001a990: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
-0001a9a0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-0001a9b0: 2020 2020 202a 2a6e 756d 6572 6963 5f6b       **numeric_k
-0001a9c0: 7761 7267 732c 0a20 2020 2020 2020 2020  wargs,.         
-0001a9d0: 2020 2020 2020 206d 6574 613d 2871 2c20         meta=(q, 
-0001a9e0: 2266 3822 292c 0a20 2020 2020 2020 2020  "f8"),.         
-0001a9f0: 2020 2020 2020 2070 6172 656e 745f 6d65         parent_me
-0001aa00: 7461 3d73 656c 662e 5f6d 6574 612c 0a20  ta=self._meta,. 
-0001aa10: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-0001aa20: 6461 736b 5f6d 6574 686f 645f 6e61 6d65  dask_method_name
-0001aa30: 3d22 7175 616e 7469 6c65 222c 0a20 2020  ="quantile",.   
-0001aa40: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001aa50: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001aa60: 2020 2020 205f 7261 6973 655f 6966 5f6f       _raise_if_o
-0001aa70: 626a 6563 745f 7365 7269 6573 2873 656c  bject_series(sel
-0001aa80: 662c 2022 7175 616e 7469 6c65 2229 0a20  f, "quantile"). 
-0001aa90: 2020 2020 2020 2020 2020 206e 756d 203d             num =
-0001aaa0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-0001aab0: 2020 2073 656c 662e 5f67 6574 5f6e 756d     self._get_num
-0001aac0: 6572 6963 5f64 6174 6128 290a 2020 2020  eric_data().    
-0001aad0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0001aae0: 756d 6572 6963 5f6f 6e6c 7920 6973 2054  umeric_only is T
-0001aaf0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
-0001ab00: 2020 2020 6f72 2028 6e6f 7420 5041 4e44      or (not PAND
-0001ab10: 4153 5f47 545f 3230 3020 616e 6420 6e75  AS_GT_200 and nu
-0001ab20: 6d65 7269 635f 6f6e 6c79 2069 7320 6e6f  meric_only is no
-0001ab30: 5f64 6566 6175 6c74 290a 2020 2020 2020  _default).      
-0001ab40: 2020 2020 2020 2020 2020 656c 7365 2073            else s
-0001ab50: 656c 660a 2020 2020 2020 2020 2020 2020  elf.            
-0001ab60: 290a 2020 2020 2020 2020 2020 2020 7175  ).            qu
-0001ab70: 616e 7469 6c65 7320 3d20 7475 706c 6528  antiles = tuple(
-0001ab80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ab90: 2071 7561 6e74 696c 6528 6e75 6d2e 696c   quantile(num.il
-0001aba0: 6f63 5b3a 2c20 695d 2c20 712c 206d 6574  oc[:, i], q, met
-0001abb0: 686f 6429 2066 6f72 2069 2069 6e20 7261  hod) for i in ra
-0001abc0: 6e67 6528 6c65 6e28 6e75 6d2e 636f 6c75  nge(len(num.colu
-0001abd0: 6d6e 7329 290a 2020 2020 2020 2020 2020  mns)).          
-0001abe0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-0001abf0: 2071 6e61 6d65 7320 3d20 5b28 5f71 2e5f   qnames = [(_q._
-0001ac00: 6e61 6d65 2c20 3029 2066 6f72 205f 7120  name, 0) for _q 
-0001ac10: 696e 2071 7561 6e74 696c 6573 5d0a 0a20  in quantiles].. 
-0001ac20: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-0001ac30: 696e 7374 616e 6365 2871 7561 6e74 696c  instance(quantil
-0001ac40: 6573 5b30 5d2c 2053 6361 6c61 7229 3a0a  es[0], Scalar):.
-0001ac50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ac60: 6c61 7965 7220 3d20 7b0a 2020 2020 2020  layer = {.      
-0001ac70: 2020 2020 2020 2020 2020 2020 2020 286b                (k
-0001ac80: 6579 6e61 6d65 2c20 3029 3a20 2874 7970  eyname, 0): (typ
-0001ac90: 6528 6d65 7461 292c 2071 6e61 6d65 732c  e(meta), qnames,
-0001aca0: 206e 756d 2e63 6f6c 756d 6e73 2c20 4e6f   num.columns, No
-0001acb0: 6e65 2c20 6d65 7461 2e6e 616d 6529 0a20  ne, meta.name). 
-0001acc0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-0001acd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ace0: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
-0001acf0: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
-0001ad00: 6c65 6374 696f 6e73 280a 2020 2020 2020  lections(.      
-0001ad10: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
-0001ad20: 796e 616d 652c 206c 6179 6572 2c20 6465  yname, layer, de
-0001ad30: 7065 6e64 656e 6369 6573 3d71 7561 6e74  pendencies=quant
-0001ad40: 696c 6573 0a20 2020 2020 2020 2020 2020  iles.           
-0001ad50: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0001ad60: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
-0001ad70: 203d 2028 6d69 6e28 6e75 6d2e 636f 6c75   = (min(num.colu
-0001ad80: 6d6e 7329 2c20 6d61 7828 6e75 6d2e 636f  mns), max(num.co
-0001ad90: 6c75 6d6e 7329 290a 2020 2020 2020 2020  lumns)).        
-0001ada0: 2020 2020 2020 2020 7265 7475 726e 2053          return S
-0001adb0: 6572 6965 7328 6772 6170 682c 206b 6579  eries(graph, key
-0001adc0: 6e61 6d65 2c20 6d65 7461 2c20 6469 7669  name, meta, divi
-0001add0: 7369 6f6e 7329 0a20 2020 2020 2020 2020  sions).         
-0001ade0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001adf0: 2020 2020 2020 2020 206c 6179 6572 203d           layer =
-0001ae00: 207b 286b 6579 6e61 6d65 2c20 3029 3a20   {(keyname, 0): 
-0001ae10: 286d 6574 686f 6473 2e63 6f6e 6361 742c  (methods.concat,
-0001ae20: 2071 6e61 6d65 732c 2031 297d 0a20 2020   qnames, 1)}.   
-0001ae30: 2020 2020 2020 2020 2020 2020 2067 7261               gra
-0001ae40: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
-0001ae50: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
-0001ae60: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
-0001ae70: 2020 2020 2020 2020 2020 6b65 796e 616d            keynam
-0001ae80: 652c 206c 6179 6572 2c20 6465 7065 6e64  e, layer, depend
-0001ae90: 656e 6369 6573 3d71 7561 6e74 696c 6573  encies=quantiles
-0001aea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001aeb0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-0001aec0: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
-0001aed0: 5f6f 626a 6563 7428 6772 6170 682c 206b  _object(graph, k
-0001aee0: 6579 6e61 6d65 2c20 6d65 7461 2c20 7175  eyname, meta, qu
-0001aef0: 616e 7469 6c65 735b 305d 2e64 6976 6973  antiles[0].divis
-0001af00: 696f 6e73 290a 0a20 2020 2040 6465 7269  ions)..    @deri
-0001af10: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-0001af20: 4672 616d 6529 0a20 2020 2064 6566 2064  Frame).    def d
-0001af30: 6573 6372 6962 6528 0a20 2020 2020 2020  escribe(.       
-0001af40: 2073 656c 662c 0a20 2020 2020 2020 2073   self,.        s
-0001af50: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
-0001af60: 2c0a 2020 2020 2020 2020 7065 7263 656e  ,.        percen
-0001af70: 7469 6c65 733d 4e6f 6e65 2c0a 2020 2020  tiles=None,.    
-0001af80: 2020 2020 7065 7263 656e 7469 6c65 735f      percentiles_
-0001af90: 6d65 7468 6f64 3d22 6465 6661 756c 7422  method="default"
-0001afa0: 2c0a 2020 2020 2020 2020 696e 636c 7564  ,.        includ
-0001afb0: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-0001afc0: 6578 636c 7564 653d 4e6f 6e65 2c0a 2020  exclude=None,.  
-0001afd0: 2020 2020 2020 6461 7465 7469 6d65 5f69        datetime_i
-0001afe0: 735f 6e75 6d65 7269 633d 6e6f 5f64 6566  s_numeric=no_def
-0001aff0: 6175 6c74 2c0a 2020 2020 293a 0a20 2020  ault,.    ):.   
-0001b000: 2020 2020 2069 6620 5041 4e44 4153 5f47       if PANDAS_G
-0001b010: 545f 3230 303a 0a20 2020 2020 2020 2020  T_200:.         
-0001b020: 2020 2069 6620 6461 7465 7469 6d65 5f69     if datetime_i
-0001b030: 735f 6e75 6d65 7269 6320 6973 206e 6f5f  s_numeric is no_
-0001b040: 6465 6661 756c 743a 0a20 2020 2020 2020  default:.       
-0001b050: 2020 2020 2020 2020 2064 6174 6574 696d           datetim
-0001b060: 655f 6973 5f6e 756d 6572 6963 203d 2054  e_is_numeric = T
-0001b070: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
-0001b080: 2020 2020 6461 7465 7469 6d65 5f69 735f      datetime_is_
-0001b090: 6e75 6d65 7269 635f 6b77 6172 6720 3d20  numeric_kwarg = 
-0001b0a0: 7b7d 0a20 2020 2020 2020 2020 2020 2065  {}.            e
-0001b0b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001b0c0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-0001b0d0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0001b0e0: 2020 2020 2020 2020 2020 2264 6174 6574            "datet
-0001b0f0: 696d 655f 6973 5f6e 756d 6572 6963 2069  ime_is_numeric i
-0001b100: 7320 7265 6d6f 7665 6420 696e 2070 616e  s removed in pan
-0001b110: 6461 733e 3d32 2e30 2e30 2c20 6461 7465  das>=2.0.0, date
-0001b120: 7469 6d65 2064 6174 6120 7769 6c6c 2061  time data will a
-0001b130: 6c77 6179 7320 6265 2022 0a20 2020 2020  lways be ".     
-0001b140: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001b150: 7375 6d6d 6172 697a 6564 2061 7320 6e75  summarized as nu
-0001b160: 6d65 7269 6322 0a20 2020 2020 2020 2020  meric".         
-0001b170: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001b180: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001b190: 2020 2064 6174 6574 696d 655f 6973 5f6e     datetime_is_n
-0001b1a0: 756d 6572 6963 203d 2028 0a20 2020 2020  umeric = (.     
-0001b1b0: 2020 2020 2020 2020 2020 2046 616c 7365             False
-0001b1c0: 2069 6620 6461 7465 7469 6d65 5f69 735f   if datetime_is_
-0001b1d0: 6e75 6d65 7269 6320 6973 206e 6f5f 6465  numeric is no_de
-0001b1e0: 6661 756c 7420 656c 7365 2064 6174 6574  fault else datet
-0001b1f0: 696d 655f 6973 5f6e 756d 6572 6963 0a20  ime_is_numeric. 
-0001b200: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001b210: 2020 2020 2020 2020 2064 6174 6574 696d           datetim
-0001b220: 655f 6973 5f6e 756d 6572 6963 5f6b 7761  e_is_numeric_kwa
-0001b230: 7267 203d 207b 2264 6174 6574 696d 655f  rg = {"datetime_
-0001b240: 6973 5f6e 756d 6572 6963 223a 2064 6174  is_numeric": dat
-0001b250: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
-0001b260: 7d0a 0a20 2020 2020 2020 2069 6620 7365  }..        if se
-0001b270: 6c66 2e5f 6d65 7461 2e6e 6469 6d20 3d3d  lf._meta.ndim ==
-0001b280: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-0001b290: 6d65 7461 203d 2073 656c 662e 5f6d 6574  meta = self._met
-0001b2a0: 615f 6e6f 6e65 6d70 7479 2e64 6573 6372  a_nonempty.descr
-0001b2b0: 6962 6528 0a20 2020 2020 2020 2020 2020  ibe(.           
-0001b2c0: 2020 2020 2070 6572 6365 6e74 696c 6573       percentiles
-0001b2d0: 3d70 6572 6365 6e74 696c 6573 2c0a 2020  =percentiles,.  
-0001b2e0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-0001b2f0: 636c 7564 653d 696e 636c 7564 652c 0a20  clude=include,. 
-0001b300: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0001b310: 7863 6c75 6465 3d65 7863 6c75 6465 2c0a  xclude=exclude,.
-0001b320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b330: 2a2a 6461 7465 7469 6d65 5f69 735f 6e75  **datetime_is_nu
-0001b340: 6d65 7269 635f 6b77 6172 672c 0a20 2020  meric_kwarg,.   
-0001b350: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001b360: 2020 2020 2020 206f 7574 7075 7420 3d20         output = 
-0001b370: 7365 6c66 2e5f 6465 7363 7269 6265 5f31  self._describe_1
-0001b380: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
-0001b390: 2020 2073 656c 662c 2073 706c 6974 5f65     self, split_e
-0001b3a0: 7665 7279 2c20 7065 7263 656e 7469 6c65  very, percentile
-0001b3b0: 732c 2070 6572 6365 6e74 696c 6573 5f6d  s, percentiles_m
-0001b3c0: 6574 686f 642c 2064 6174 6574 696d 655f  ethod, datetime_
-0001b3d0: 6973 5f6e 756d 6572 6963 0a20 2020 2020  is_numeric.     
-0001b3e0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001b3f0: 2020 2020 206f 7574 7075 742e 5f6d 6574       output._met
-0001b400: 6120 3d20 6d65 7461 0a20 2020 2020 2020  a = meta.       
-0001b410: 2020 2020 2072 6574 7572 6e20 6f75 7470       return outp
-0001b420: 7574 0a20 2020 2020 2020 2065 6c69 6620  ut.        elif 
-0001b430: 2869 6e63 6c75 6465 2069 7320 4e6f 6e65  (include is None
-0001b440: 2920 616e 6420 2865 7863 6c75 6465 2069  ) and (exclude i
-0001b450: 7320 4e6f 6e65 293a 0a20 2020 2020 2020  s None):.       
-0001b460: 2020 2020 205f 696e 636c 7564 6520 3d20       _include = 
-0001b470: 5b6e 702e 6e75 6d62 6572 2c20 6e70 2e74  [np.number, np.t
-0001b480: 696d 6564 656c 7461 3634 5d0a 2020 2020  imedelta64].    
-0001b490: 2020 2020 2020 2020 6966 2064 6174 6574          if datet
-0001b4a0: 696d 655f 6973 5f6e 756d 6572 6963 3a0a  ime_is_numeric:.
-0001b4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b4c0: 5f69 6e63 6c75 6465 2e61 7070 656e 6428  _include.append(
-0001b4d0: 6e70 2e64 6174 6574 696d 6536 3429 0a20  np.datetime64). 
-0001b4e0: 2020 2020 2020 2020 2020 2064 6174 6120             data 
-0001b4f0: 3d20 7365 6c66 2e5f 6d65 7461 2e73 656c  = self._meta.sel
-0001b500: 6563 745f 6474 7970 6573 2869 6e63 6c75  ect_dtypes(inclu
-0001b510: 6465 3d5f 696e 636c 7564 6529 0a0a 2020  de=_include)..  
-0001b520: 2020 2020 2020 2020 2020 2320 7768 656e            # when
-0001b530: 2073 6f6d 6520 6e75 6d65 7269 6373 2f74   some numerics/t
-0001b540: 696d 6564 656c 7461 7320 6172 6520 666f  imedeltas are fo
-0001b550: 756e 642c 2062 7920 6465 6661 756c 7420  und, by default 
-0001b560: 6b65 6570 2074 6865 6d0a 2020 2020 2020  keep them.      
-0001b570: 2020 2020 2020 6966 206c 656e 2864 6174        if len(dat
-0001b580: 612e 636f 6c75 6d6e 7329 203d 3d20 303a  a.columns) == 0:
-0001b590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b5a0: 2063 686f 7365 6e5f 636f 6c75 6d6e 735f   chosen_columns_
-0001b5b0: 696e 6465 7865 7320 3d20 6c69 7374 2872  indexes = list(r
-0001b5c0: 616e 6765 286c 656e 2873 656c 662e 5f6d  ange(len(self._m
-0001b5d0: 6574 612e 636f 6c75 6d6e 7329 2929 0a20  eta.columns))). 
-0001b5e0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0001b5f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b600: 2023 2063 6865 636b 2069 6620 7468 6572   # check if ther
-0001b610: 6520 6172 6520 7469 6d65 6465 6c74 612c  e are timedelta,
-0001b620: 2062 6f6f 6c65 616e 2c20 6f72 2064 6174   boolean, or dat
-0001b630: 6574 696d 6520 636f 6c75 6d6e 730a 2020  etime columns.  
-0001b640: 2020 2020 2020 2020 2020 2020 2020 5f69                _i
-0001b650: 6e63 6c75 6465 203d 205b 6e70 2e74 696d  nclude = [np.tim
-0001b660: 6564 656c 7461 3634 2c20 626f 6f6c 5d0a  edelta64, bool].
-0001b670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b680: 6966 2064 6174 6574 696d 655f 6973 5f6e  if datetime_is_n
-0001b690: 756d 6572 6963 3a0a 2020 2020 2020 2020  umeric:.        
-0001b6a0: 2020 2020 2020 2020 2020 2020 5f69 6e63              _inc
-0001b6b0: 6c75 6465 2e61 7070 656e 6428 6e70 2e64  lude.append(np.d
-0001b6c0: 6174 6574 696d 6536 3429 0a20 2020 2020  atetime64).     
-0001b6d0: 2020 2020 2020 2020 2020 2062 6f6f 6c73             bools
-0001b6e0: 5f61 6e64 5f74 696d 6573 203d 2073 656c  _and_times = sel
-0001b6f0: 662e 5f6d 6574 612e 7365 6c65 6374 5f64  f._meta.select_d
-0001b700: 7479 7065 7328 696e 636c 7564 653d 5f69  types(include=_i
-0001b710: 6e63 6c75 6465 290a 2020 2020 2020 2020  nclude).        
-0001b720: 2020 2020 2020 2020 6966 206c 656e 2862          if len(b
-0001b730: 6f6f 6c73 5f61 6e64 5f74 696d 6573 2e63  ools_and_times.c
-0001b740: 6f6c 756d 6e73 2920 3d3d 2030 3a0a 2020  olumns) == 0:.  
-0001b750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b760: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
-0001b770: 6573 6372 6962 655f 6e75 6d65 7269 6328  escribe_numeric(
-0001b780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b790: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-0001b7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b7b0: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-0001b7c0: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
-0001b7d0: 2020 2020 2020 2020 2020 2020 7065 7263              perc
-0001b7e0: 656e 7469 6c65 732c 0a20 2020 2020 2020  entiles,.       
-0001b7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b800: 2070 6572 6365 6e74 696c 6573 5f6d 6574   percentiles_met
-0001b810: 686f 642c 0a20 2020 2020 2020 2020 2020  hod,.           
-0001b820: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001b830: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0001b840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b850: 2020 2020 2063 686f 7365 6e5f 636f 6c75       chosen_colu
-0001b860: 6d6e 735f 696e 6465 7865 7320 3d20 7365  mns_indexes = se
-0001b870: 6c66 2e5f 6765 745f 636f 6c75 6d6e 735f  lf._get_columns_
-0001b880: 696e 6465 7865 735f 6261 7365 645f 6f6e  indexes_based_on
-0001b890: 5f64 7479 7065 7328 0a20 2020 2020 2020  _dtypes(.       
-0001b8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b8b0: 2064 6174 610a 2020 2020 2020 2020 2020   data.          
-0001b8c0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0001b8d0: 2020 2020 656c 6966 2069 6e63 6c75 6465      elif include
-0001b8e0: 203d 3d20 2261 6c6c 223a 0a20 2020 2020   == "all":.     
-0001b8f0: 2020 2020 2020 2069 6620 6578 636c 7564         if exclud
-0001b900: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
-0001b910: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0001b920: 7367 203d 2022 6578 636c 7564 6520 6d75  sg = "exclude mu
-0001b930: 7374 2062 6520 4e6f 6e65 2077 6865 6e20  st be None when 
-0001b940: 696e 636c 7564 6520 6973 2027 616c 6c27  include is 'all'
-0001b950: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0001b960: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0001b970: 6f72 286d 7367 290a 2020 2020 2020 2020  or(msg).        
-0001b980: 2020 2020 6368 6f73 656e 5f63 6f6c 756d      chosen_colum
-0001b990: 6e73 5f69 6e64 6578 6573 203d 206c 6973  ns_indexes = lis
-0001b9a0: 7428 7261 6e67 6528 6c65 6e28 7365 6c66  t(range(len(self
-0001b9b0: 2e5f 6d65 7461 2e63 6f6c 756d 6e73 2929  ._meta.columns))
-0001b9c0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-0001b9d0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0001b9e0: 203d 2073 656c 662e 5f6d 6574 612e 7365   = self._meta.se
-0001b9f0: 6c65 6374 5f64 7479 7065 7328 696e 636c  lect_dtypes(incl
-0001ba00: 7564 653d 696e 636c 7564 652c 2065 7863  ude=include, exc
-0001ba10: 6c75 6465 3d65 7863 6c75 6465 290a 2020  lude=exclude).  
-0001ba20: 2020 2020 2020 2020 2020 6368 6f73 656e            chosen
-0001ba30: 5f63 6f6c 756d 6e73 5f69 6e64 6578 6573  _columns_indexes
-0001ba40: 203d 2073 656c 662e 5f67 6574 5f63 6f6c   = self._get_col
-0001ba50: 756d 6e73 5f69 6e64 6578 6573 5f62 6173  umns_indexes_bas
-0001ba60: 6564 5f6f 6e5f 6474 7970 6573 2864 6174  ed_on_dtypes(dat
-0001ba70: 6129 0a0a 2020 2020 2020 2020 7374 6174  a)..        stat
-0001ba80: 7320 3d20 5b0a 2020 2020 2020 2020 2020  s = [.          
-0001ba90: 2020 7365 6c66 2e5f 6465 7363 7269 6265    self._describe
-0001baa0: 5f31 6428 0a20 2020 2020 2020 2020 2020  _1d(.           
-0001bab0: 2020 2020 2073 656c 662e 696c 6f63 5b3a       self.iloc[:
-0001bac0: 2c20 636f 6c5f 6964 785d 2c0a 2020 2020  , col_idx],.    
-0001bad0: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
-0001bae0: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
-0001baf0: 2020 2020 2020 2020 2070 6572 6365 6e74           percent
-0001bb00: 696c 6573 2c0a 2020 2020 2020 2020 2020  iles,.          
-0001bb10: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
-0001bb20: 735f 6d65 7468 6f64 2c0a 2020 2020 2020  s_method,.      
-0001bb30: 2020 2020 2020 2020 2020 6461 7465 7469            dateti
-0001bb40: 6d65 5f69 735f 6e75 6d65 7269 632c 0a20  me_is_numeric,. 
-0001bb50: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001bb60: 2020 2020 2020 2020 2066 6f72 2063 6f6c           for col
-0001bb70: 5f69 6478 2069 6e20 6368 6f73 656e 5f63  _idx in chosen_c
-0001bb80: 6f6c 756d 6e73 5f69 6e64 6578 6573 0a20  olumns_indexes. 
-0001bb90: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-0001bba0: 2073 7461 7473 5f6e 616d 6573 203d 205b   stats_names = [
-0001bbb0: 2873 2e5f 6e61 6d65 2c20 3029 2066 6f72  (s._name, 0) for
-0001bbc0: 2073 2069 6e20 7374 6174 735d 0a0a 2020   s in stats]..  
-0001bbd0: 2020 2020 2020 6e61 6d65 203d 2022 6465        name = "de
-0001bbe0: 7363 7269 6265 2d2d 2220 2b20 746f 6b65  scribe--" + toke
-0001bbf0: 6e69 7a65 2873 656c 662c 2073 706c 6974  nize(self, split
-0001bc00: 5f65 7665 7279 290a 2020 2020 2020 2020  _every).        
-0001bc10: 6c61 7965 7220 3d20 7b28 6e61 6d65 2c20  layer = {(name, 
-0001bc20: 3029 3a20 286d 6574 686f 6473 2e64 6573  0): (methods.des
-0001bc30: 6372 6962 655f 6167 6772 6567 6174 652c  cribe_aggregate,
-0001bc40: 2073 7461 7473 5f6e 616d 6573 297d 0a20   stats_names)}. 
-0001bc50: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
-0001bc60: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
-0001bc70: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
-0001bc80: 616d 652c 206c 6179 6572 2c20 6465 7065  ame, layer, depe
-0001bc90: 6e64 656e 6369 6573 3d73 7461 7473 290a  ndencies=stats).
-0001bca0: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
-0001bcb0: 656c 662e 5f6d 6574 615f 6e6f 6e65 6d70  elf._meta_nonemp
-0001bcc0: 7479 2e64 6573 6372 6962 6528 0a20 2020  ty.describe(.   
-0001bcd0: 2020 2020 2020 2020 2069 6e63 6c75 6465           include
-0001bce0: 3d69 6e63 6c75 6465 2c20 6578 636c 7564  =include, exclud
-0001bcf0: 653d 6578 636c 7564 652c 202a 2a64 6174  e=exclude, **dat
-0001bd00: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
-0001bd10: 5f6b 7761 7267 0a20 2020 2020 2020 2029  _kwarg.        )
-0001bd20: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001bd30: 6e65 775f 6464 5f6f 626a 6563 7428 6772  new_dd_object(gr
-0001bd40: 6170 682c 206e 616d 652c 206d 6574 612c  aph, name, meta,
-0001bd50: 2064 6976 6973 696f 6e73 3d5b 4e6f 6e65   divisions=[None
-0001bd60: 2c20 4e6f 6e65 5d29 0a0a 2020 2020 6465  , None])..    de
-0001bd70: 6620 5f67 6574 5f63 6f6c 756d 6e73 5f69  f _get_columns_i
-0001bd80: 6e64 6578 6573 5f62 6173 6564 5f6f 6e5f  ndexes_based_on_
-0001bd90: 6474 7970 6573 2873 656c 662c 2073 7562  dtypes(self, sub
-0001bda0: 7365 7429 3a0a 2020 2020 2020 2020 6d65  set):.        me
-0001bdb0: 7461 203d 2073 656c 662e 5f6d 6574 612e  ta = self._meta.
-0001bdc0: 6474 7970 6573 2e72 6573 6574 5f69 6e64  dtypes.reset_ind
-0001bdd0: 6578 2829 0a20 2020 2020 2020 206d 6574  ex().        met
-0001bde0: 612e 696e 6465 782e 6e61 6d65 203d 2022  a.index.name = "
-0001bdf0: 696e 6465 7865 7222 0a20 2020 2020 2020  indexer".       
-0001be00: 2072 6574 7572 6e20 280a 2020 2020 2020   return (.      
-0001be10: 2020 2020 2020 6d65 7461 2e72 6573 6574        meta.reset
-0001be20: 5f69 6e64 6578 2829 0a20 2020 2020 2020  _index().       
-0001be30: 2020 2020 202e 6d65 7267 6528 7375 6273       .merge(subs
-0001be40: 6574 2e64 7479 7065 732e 7265 7365 745f  et.dtypes.reset_
-0001be50: 696e 6465 7828 292c 2068 6f77 3d22 696e  index(), how="in
-0001be60: 6e65 7222 295b 2269 6e64 6578 6572 225d  ner")["indexer"]
-0001be70: 0a20 2020 2020 2020 2020 2020 202e 7661  .            .va
-0001be80: 6c75 6573 0a20 2020 2020 2020 2029 0a0a  lues.        )..
-0001be90: 2020 2020 6465 6620 5f64 6573 6372 6962      def _describ
-0001bea0: 655f 3164 280a 2020 2020 2020 2020 7365  e_1d(.        se
-0001beb0: 6c66 2c0a 2020 2020 2020 2020 6461 7461  lf,.        data
-0001bec0: 2c0a 2020 2020 2020 2020 7370 6c69 745f  ,.        split_
-0001bed0: 6576 6572 793d 4661 6c73 652c 0a20 2020  every=False,.   
-0001bee0: 2020 2020 2070 6572 6365 6e74 696c 6573       percentiles
-0001bef0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2070  =None,.        p
-0001bf00: 6572 6365 6e74 696c 6573 5f6d 6574 686f  ercentiles_metho
-0001bf10: 643d 2264 6566 6175 6c74 222c 0a20 2020  d="default",.   
-0001bf20: 2020 2020 2064 6174 6574 696d 655f 6973       datetime_is
-0001bf30: 5f6e 756d 6572 6963 3d46 616c 7365 2c0a  _numeric=False,.
-0001bf40: 2020 2020 293a 0a20 2020 2020 2020 2069      ):.        i
-0001bf50: 6620 6973 5f62 6f6f 6c5f 6474 7970 6528  f is_bool_dtype(
-0001bf60: 6461 7461 2e5f 6d65 7461 293a 0a20 2020  data._meta):.   
-0001bf70: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001bf80: 7365 6c66 2e5f 6465 7363 7269 6265 5f6e  self._describe_n
-0001bf90: 6f6e 6e75 6d65 7269 635f 3164 280a 2020  onnumeric_1d(.  
-0001bfa0: 2020 2020 2020 2020 2020 2020 2020 6461                da
-0001bfb0: 7461 2c20 7370 6c69 745f 6576 6572 793d  ta, split_every=
-0001bfc0: 7370 6c69 745f 6576 6572 792c 2064 6174  split_every, dat
-0001bfd0: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
-0001bfe0: 3d64 6174 6574 696d 655f 6973 5f6e 756d  =datetime_is_num
-0001bff0: 6572 6963 0a20 2020 2020 2020 2020 2020  eric.           
-0001c000: 2029 0a20 2020 2020 2020 2065 6c69 6620   ).        elif 
-0001c010: 6973 5f6e 756d 6572 6963 5f64 7479 7065  is_numeric_dtype
-0001c020: 2864 6174 612e 5f6d 6574 6129 3a0a 2020  (data._meta):.  
-0001c030: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001c040: 2073 656c 662e 5f64 6573 6372 6962 655f   self._describe_
-0001c050: 6e75 6d65 7269 6328 0a20 2020 2020 2020  numeric(.       
-0001c060: 2020 2020 2020 2020 2064 6174 612c 0a20           data,. 
-0001c070: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001c080: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-0001c090: 5f65 7665 7279 2c0a 2020 2020 2020 2020  _every,.        
-0001c0a0: 2020 2020 2020 2020 7065 7263 656e 7469          percenti
-0001c0b0: 6c65 733d 7065 7263 656e 7469 6c65 732c  les=percentiles,
-0001c0c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c0d0: 2070 6572 6365 6e74 696c 6573 5f6d 6574   percentiles_met
-0001c0e0: 686f 643d 7065 7263 656e 7469 6c65 735f  hod=percentiles_
-0001c0f0: 6d65 7468 6f64 2c0a 2020 2020 2020 2020  method,.        
-0001c100: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
-0001c110: 6966 2069 735f 7469 6d65 6465 6c74 6136  if is_timedelta6
-0001c120: 345f 6474 7970 6528 6461 7461 2e5f 6d65  4_dtype(data._me
-0001c130: 7461 293a 0a20 2020 2020 2020 2020 2020  ta):.           
-0001c140: 2072 6574 7572 6e20 7365 6c66 2e5f 6465   return self._de
-0001c150: 7363 7269 6265 5f6e 756d 6572 6963 280a  scribe_numeric(.
-0001c160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c170: 6461 7461 2e64 726f 706e 6128 292c 0a20  data.dropna(),. 
-0001c180: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001c190: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-0001c1a0: 5f65 7665 7279 2c0a 2020 2020 2020 2020  _every,.        
-0001c1b0: 2020 2020 2020 2020 7065 7263 656e 7469          percenti
-0001c1c0: 6c65 733d 7065 7263 656e 7469 6c65 732c  les=percentiles,
-0001c1d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c1e0: 2070 6572 6365 6e74 696c 6573 5f6d 6574   percentiles_met
-0001c1f0: 686f 643d 7065 7263 656e 7469 6c65 735f  hod=percentiles_
-0001c200: 6d65 7468 6f64 2c0a 2020 2020 2020 2020  method,.        
-0001c210: 2020 2020 2020 2020 6973 5f74 696d 6564          is_timed
-0001c220: 656c 7461 5f63 6f6c 756d 6e3d 5472 7565  elta_column=True
-0001c230: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-0001c240: 2020 2020 2020 2020 656c 6966 2069 735f          elif is_
-0001c250: 6461 7465 7469 6d65 3634 5f61 6e79 5f64  datetime64_any_d
-0001c260: 7479 7065 2864 6174 612e 5f6d 6574 6129  type(data._meta)
-0001c270: 2061 6e64 2064 6174 6574 696d 655f 6973   and datetime_is
-0001c280: 5f6e 756d 6572 6963 3a0a 2020 2020 2020  _numeric:.      
-0001c290: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0001c2a0: 662e 5f64 6573 6372 6962 655f 6e75 6d65  f._describe_nume
-0001c2b0: 7269 6328 0a20 2020 2020 2020 2020 2020  ric(.           
-0001c2c0: 2020 2020 2064 6174 612e 6472 6f70 6e61       data.dropna
-0001c2d0: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
-0001c2e0: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
-0001c2f0: 7370 6c69 745f 6576 6572 792c 0a20 2020  split_every,.   
-0001c300: 2020 2020 2020 2020 2020 2020 2070 6572               per
-0001c310: 6365 6e74 696c 6573 3d70 6572 6365 6e74  centiles=percent
-0001c320: 696c 6573 2c0a 2020 2020 2020 2020 2020  iles,.          
-0001c330: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
-0001c340: 735f 6d65 7468 6f64 3d70 6572 6365 6e74  s_method=percent
-0001c350: 696c 6573 5f6d 6574 686f 642c 0a20 2020  iles_method,.   
-0001c360: 2020 2020 2020 2020 2020 2020 2069 735f               is_
-0001c370: 6461 7465 7469 6d65 5f63 6f6c 756d 6e3d  datetime_column=
-0001c380: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
-0001c390: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
-0001c3a0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0001c3b0: 7475 726e 2073 656c 662e 5f64 6573 6372  turn self._descr
-0001c3c0: 6962 655f 6e6f 6e6e 756d 6572 6963 5f31  ibe_nonnumeric_1
-0001c3d0: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
-0001c3e0: 2020 2064 6174 612c 2073 706c 6974 5f65     data, split_e
-0001c3f0: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
-0001c400: 2c20 6461 7465 7469 6d65 5f69 735f 6e75  , datetime_is_nu
-0001c410: 6d65 7269 633d 6461 7465 7469 6d65 5f69  meric=datetime_i
-0001c420: 735f 6e75 6d65 7269 630a 2020 2020 2020  s_numeric.      
-0001c430: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-0001c440: 205f 6465 7363 7269 6265 5f6e 756d 6572   _describe_numer
-0001c450: 6963 280a 2020 2020 2020 2020 7365 6c66  ic(.        self
-0001c460: 2c0a 2020 2020 2020 2020 6461 7461 2c0a  ,.        data,.
-0001c470: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-0001c480: 6572 793d 4661 6c73 652c 0a20 2020 2020  ery=False,.     
-0001c490: 2020 2070 6572 6365 6e74 696c 6573 3d4e     percentiles=N
-0001c4a0: 6f6e 652c 0a20 2020 2020 2020 2070 6572  one,.        per
-0001c4b0: 6365 6e74 696c 6573 5f6d 6574 686f 643d  centiles_method=
-0001c4c0: 2264 6566 6175 6c74 222c 0a20 2020 2020  "default",.     
-0001c4d0: 2020 2069 735f 7469 6d65 6465 6c74 615f     is_timedelta_
-0001c4e0: 636f 6c75 6d6e 3d46 616c 7365 2c0a 2020  column=False,.  
-0001c4f0: 2020 2020 2020 6973 5f64 6174 6574 696d        is_datetim
-0001c500: 655f 636f 6c75 6d6e 3d46 616c 7365 2c0a  e_column=False,.
-0001c510: 2020 2020 293a 0a20 2020 2020 2020 2066      ):.        f
-0001c520: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-0001c530: 6d65 2e6e 756d 6572 6963 2069 6d70 6f72  me.numeric impor
-0001c540: 7420 746f 5f6e 756d 6572 6963 0a0a 2020  t to_numeric..  
-0001c550: 2020 2020 2020 6966 2069 735f 7469 6d65        if is_time
-0001c560: 6465 6c74 615f 636f 6c75 6d6e 206f 7220  delta_column or 
-0001c570: 6973 5f64 6174 6574 696d 655f 636f 6c75  is_datetime_colu
-0001c580: 6d6e 3a0a 2020 2020 2020 2020 2020 2020  mn:.            
-0001c590: 6e75 6d20 3d20 746f 5f6e 756d 6572 6963  num = to_numeric
-0001c5a0: 2864 6174 6129 0a20 2020 2020 2020 2065  (data).        e
-0001c5b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001c5c0: 206e 756d 203d 2064 6174 612e 5f67 6574   num = data._get
-0001c5d0: 5f6e 756d 6572 6963 5f64 6174 6128 290a  _numeric_data().
-0001c5e0: 0a20 2020 2020 2020 2069 6620 6461 7461  .        if data
-0001c5f0: 2e6e 6469 6d20 3d3d 2032 2061 6e64 206c  .ndim == 2 and l
-0001c600: 656e 286e 756d 2e63 6f6c 756d 6e73 2920  en(num.columns) 
-0001c610: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-0001c620: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0001c630: 6f72 2822 4461 7461 4672 616d 6520 636f  or("DataFrame co
-0001c640: 6e74 6169 6e73 206f 6e6c 7920 6e6f 6e2d  ntains only non-
-0001c650: 6e75 6d65 7269 6320 6461 7461 2e22 290a  numeric data.").
-0001c660: 2020 2020 2020 2020 656c 6966 2064 6174          elif dat
-0001c670: 612e 6e64 696d 203d 3d20 3120 616e 6420  a.ndim == 1 and 
-0001c680: 6461 7461 2e64 7479 7065 203d 3d20 226f  data.dtype == "o
-0001c690: 626a 6563 7422 3a0a 2020 2020 2020 2020  bject":.        
-0001c6a0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0001c6b0: 7272 6f72 2822 4361 6e6e 6f74 2063 6f6d  rror("Cannot com
-0001c6c0: 7075 7465 2060 6064 6573 6372 6962 6560  pute ``describe`
-0001c6d0: 6020 6f6e 206f 626a 6563 7420 6474 7970  ` on object dtyp
-0001c6e0: 652e 2229 0a20 2020 2020 2020 2069 6620  e.").        if 
-0001c6f0: 7065 7263 656e 7469 6c65 7320 6973 204e  percentiles is N
-0001c700: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0001c710: 2070 6572 6365 6e74 696c 6573 203d 205b   percentiles = [
-0001c720: 302e 3235 2c20 302e 352c 2030 2e37 355d  0.25, 0.5, 0.75]
-0001c730: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0001c740: 2020 2020 2020 2020 2020 2023 2061 6c77             # alw
-0001c750: 6179 7320 696e 636c 7564 6520 7468 6520  ays include the 
-0001c760: 7468 6520 3530 2574 6c65 2074 6f20 6361  the 50%tle to ca
-0001c770: 6c63 756c 6174 6520 7468 6520 6d65 6469  lculate the medi
-0001c780: 616e 0a20 2020 2020 2020 2020 2020 2023  an.            #
-0001c790: 2075 6e69 7175 6520 7265 6d6f 7665 7320   unique removes 
-0001c7a0: 6475 706c 6963 6174 6573 2061 6e64 2073  duplicates and s
-0001c7b0: 6f72 7473 2071 7561 6e74 696c 6573 0a20  orts quantiles. 
-0001c7c0: 2020 2020 2020 2020 2020 2070 6572 6365             perce
-0001c7d0: 6e74 696c 6573 203d 206e 702e 6172 7261  ntiles = np.arra
-0001c7e0: 7928 7065 7263 656e 7469 6c65 7329 0a20  y(percentiles). 
-0001c7f0: 2020 2020 2020 2020 2020 2070 6572 6365             perce
-0001c800: 6e74 696c 6573 203d 206e 702e 6170 7065  ntiles = np.appe
-0001c810: 6e64 2870 6572 6365 6e74 696c 6573 2c20  nd(percentiles, 
-0001c820: 302e 3529 0a20 2020 2020 2020 2020 2020  0.5).           
-0001c830: 2070 6572 6365 6e74 696c 6573 203d 206e   percentiles = n
-0001c840: 702e 756e 6971 7565 2870 6572 6365 6e74  p.unique(percent
-0001c850: 696c 6573 290a 2020 2020 2020 2020 2020  iles).          
-0001c860: 2020 7065 7263 656e 7469 6c65 7320 3d20    percentiles = 
-0001c870: 6c69 7374 2870 6572 6365 6e74 696c 6573  list(percentiles
-0001c880: 290a 2020 2020 2020 2020 7374 6174 7320  ).        stats 
-0001c890: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
-0001c8a0: 6e75 6d2e 636f 756e 7428 7370 6c69 745f  num.count(split_
-0001c8b0: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-0001c8c0: 7929 2c0a 2020 2020 2020 2020 2020 2020  y),.            
-0001c8d0: 6e75 6d2e 6d65 616e 2873 706c 6974 5f65  num.mean(split_e
-0001c8e0: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
-0001c8f0: 292c 0a20 2020 2020 2020 2020 2020 206e  ),.            n
-0001c900: 756d 2e73 7464 2873 706c 6974 5f65 7665  um.std(split_eve
-0001c910: 7279 3d73 706c 6974 5f65 7665 7279 292c  ry=split_every),
-0001c920: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
-0001c930: 2e6d 696e 2873 706c 6974 5f65 7665 7279  .min(split_every
-0001c940: 3d73 706c 6974 5f65 7665 7279 292c 0a20  =split_every),. 
-0001c950: 2020 2020 2020 2020 2020 206e 756d 2e71             num.q
-0001c960: 7561 6e74 696c 6528 7065 7263 656e 7469  uantile(percenti
-0001c970: 6c65 732c 206d 6574 686f 643d 7065 7263  les, method=perc
-0001c980: 656e 7469 6c65 735f 6d65 7468 6f64 292c  entiles_method),
-0001c990: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
-0001c9a0: 2e6d 6178 2873 706c 6974 5f65 7665 7279  .max(split_every
-0001c9b0: 3d73 706c 6974 5f65 7665 7279 292c 0a20  =split_every),. 
-0001c9c0: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-0001c9d0: 2073 7461 7473 5f6e 616d 6573 203d 205b   stats_names = [
-0001c9e0: 2873 2e5f 6e61 6d65 2c20 3029 2066 6f72  (s._name, 0) for
-0001c9f0: 2073 2069 6e20 7374 6174 735d 0a0a 2020   s in stats]..  
-0001ca00: 2020 2020 2020 636f 6c6e 616d 6520 3d20        colname = 
-0001ca10: 6461 7461 2e5f 6d65 7461 2e6e 616d 6520  data._meta.name 
-0001ca20: 6966 2069 735f 7365 7269 6573 5f6c 696b  if is_series_lik
-0001ca30: 6528 6461 7461 2e5f 6d65 7461 2920 656c  e(data._meta) el
-0001ca40: 7365 204e 6f6e 650a 0a20 2020 2020 2020  se None..       
-0001ca50: 206e 616d 6520 3d20 2264 6573 6372 6962   name = "describ
-0001ca60: 652d 6e75 6d65 7269 632d 2d22 202b 2074  e-numeric--" + t
-0001ca70: 6f6b 656e 697a 6528 6e75 6d2c 2073 706c  okenize(num, spl
-0001ca80: 6974 5f65 7665 7279 290a 2020 2020 2020  it_every).      
-0001ca90: 2020 6c61 7965 7220 3d20 7b0a 2020 2020    layer = {.    
-0001caa0: 2020 2020 2020 2020 286e 616d 652c 2030          (name, 0
-0001cab0: 293a 2028 0a20 2020 2020 2020 2020 2020  ): (.           
-0001cac0: 2020 2020 206d 6574 686f 6473 2e64 6573       methods.des
-0001cad0: 6372 6962 655f 6e75 6d65 7269 635f 6167  cribe_numeric_ag
-0001cae0: 6772 6567 6174 652c 0a20 2020 2020 2020  gregate,.       
-0001caf0: 2020 2020 2020 2020 2073 7461 7473 5f6e           stats_n
-0001cb00: 616d 6573 2c0a 2020 2020 2020 2020 2020  ames,.          
-0001cb10: 2020 2020 2020 636f 6c6e 616d 652c 0a20        colname,. 
-0001cb20: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001cb30: 735f 7469 6d65 6465 6c74 615f 636f 6c75  s_timedelta_colu
-0001cb40: 6d6e 2c0a 2020 2020 2020 2020 2020 2020  mn,.            
-0001cb50: 2020 2020 6973 5f64 6174 6574 696d 655f      is_datetime_
-0001cb60: 636f 6c75 6d6e 2c0a 2020 2020 2020 2020  column,.        
-0001cb70: 2020 2020 290a 2020 2020 2020 2020 7d0a      ).        }.
-0001cb80: 2020 2020 2020 2020 6772 6170 6820 3d20          graph = 
-0001cb90: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
-0001cba0: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
-0001cbb0: 6e61 6d65 2c20 6c61 7965 722c 2064 6570  name, layer, dep
-0001cbc0: 656e 6465 6e63 6965 733d 7374 6174 7329  endencies=stats)
-0001cbd0: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
-0001cbe0: 6e75 6d2e 5f6d 6574 615f 6e6f 6e65 6d70  num._meta_nonemp
-0001cbf0: 7479 2e64 6573 6372 6962 6528 290a 2020  ty.describe().  
-0001cc00: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-0001cc10: 5f64 645f 6f62 6a65 6374 2867 7261 7068  _dd_object(graph
-0001cc20: 2c20 6e61 6d65 2c20 6d65 7461 2c20 6469  , name, meta, di
-0001cc30: 7669 7369 6f6e 733d 5b4e 6f6e 652c 204e  visions=[None, N
-0001cc40: 6f6e 655d 290a 0a20 2020 2064 6566 205f  one])..    def _
-0001cc50: 6465 7363 7269 6265 5f6e 6f6e 6e75 6d65  describe_nonnume
-0001cc60: 7269 635f 3164 280a 2020 2020 2020 2020  ric_1d(.        
-0001cc70: 7365 6c66 2c20 6461 7461 2c20 7370 6c69  self, data, spli
-0001cc80: 745f 6576 6572 793d 4661 6c73 652c 2064  t_every=False, d
-0001cc90: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
-0001cca0: 6963 3d46 616c 7365 0a20 2020 2029 3a0a  ic=False.    ):.
-0001ccb0: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-0001ccc0: 6b2e 6461 7461 6672 616d 652e 6e75 6d65  k.dataframe.nume
-0001ccd0: 7269 6320 696d 706f 7274 2074 6f5f 6e75  ric import to_nu
-0001cce0: 6d65 7269 630a 0a20 2020 2020 2020 2076  meric..        v
-0001ccf0: 636f 756e 7473 203d 2064 6174 612e 7661  counts = data.va
-0001cd00: 6c75 655f 636f 756e 7473 2873 706c 6974  lue_counts(split
-0001cd10: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-0001cd20: 7279 290a 2020 2020 2020 2020 636f 756e  ry).        coun
-0001cd30: 745f 6e6f 6e7a 6572 6f20 3d20 7663 6f75  t_nonzero = vcou
-0001cd40: 6e74 735b 7663 6f75 6e74 7320 213d 2030  nts[vcounts != 0
-0001cd50: 5d0a 2020 2020 2020 2020 636f 756e 745f  ].        count_
-0001cd60: 756e 6971 7565 203d 2063 6f75 6e74 5f6e  unique = count_n
-0001cd70: 6f6e 7a65 726f 2e73 697a 650a 0a20 2020  onzero.size..   
-0001cd80: 2020 2020 2073 7461 7473 203d 205b 0a20       stats = [. 
-0001cd90: 2020 2020 2020 2020 2020 2023 206e 756e             # nun
-0001cda0: 6971 7565 0a20 2020 2020 2020 2020 2020  ique.           
-0001cdb0: 2063 6f75 6e74 5f75 6e69 7175 652c 0a20   count_unique,. 
-0001cdc0: 2020 2020 2020 2020 2020 2023 2063 6f75             # cou
-0001cdd0: 6e74 0a20 2020 2020 2020 2020 2020 2064  nt.            d
-0001cde0: 6174 612e 636f 756e 7428 7370 6c69 745f  ata.count(split_
-0001cdf0: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-0001ce00: 7929 2c0a 2020 2020 2020 2020 2020 2020  y),.            
-0001ce10: 2320 6d6f 7374 2063 6f6d 6d6f 6e20 7661  # most common va
-0001ce20: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
-0001ce30: 7663 6f75 6e74 732e 5f68 6561 6428 312c  vcounts._head(1,
-0001ce40: 206e 7061 7274 6974 696f 6e73 3d31 2c20   npartitions=1, 
-0001ce50: 636f 6d70 7574 653d 4661 6c73 652c 2073  compute=False, s
-0001ce60: 6166 653d 4661 6c73 6529 2c0a 2020 2020  afe=False),.    
-0001ce70: 2020 2020 5d0a 0a20 2020 2020 2020 2069      ]..        i
-0001ce80: 6620 6973 5f64 6174 6574 696d 6536 345f  f is_datetime64_
-0001ce90: 616e 795f 6474 7970 6528 6461 7461 2e5f  any_dtype(data._
-0001cea0: 6d65 7461 2920 616e 6420 6e6f 7420 6461  meta) and not da
-0001ceb0: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
-0001cec0: 633a 0a20 2020 2020 2020 2020 2020 206d  c:.            m
-0001ced0: 696e 5f74 7320 3d20 746f 5f6e 756d 6572  in_ts = to_numer
-0001cee0: 6963 2864 6174 612e 6472 6f70 6e61 2829  ic(data.dropna()
-0001cef0: 292e 6d69 6e28 7370 6c69 745f 6576 6572  ).min(split_ever
-0001cf00: 793d 7370 6c69 745f 6576 6572 7929 0a20  y=split_every). 
-0001cf10: 2020 2020 2020 2020 2020 206d 6178 5f74             max_t
-0001cf20: 7320 3d20 746f 5f6e 756d 6572 6963 2864  s = to_numeric(d
-0001cf30: 6174 612e 6472 6f70 6e61 2829 292e 6d61  ata.dropna()).ma
-0001cf40: 7828 7370 6c69 745f 6576 6572 793d 7370  x(split_every=sp
-0001cf50: 6c69 745f 6576 6572 7929 0a20 2020 2020  lit_every).     
-0001cf60: 2020 2020 2020 2073 7461 7473 2e65 7874         stats.ext
-0001cf70: 656e 6428 5b6d 696e 5f74 732c 206d 6178  end([min_ts, max
-0001cf80: 5f74 735d 290a 0a20 2020 2020 2020 2073  _ts])..        s
-0001cf90: 7461 7473 5f6e 616d 6573 203d 205b 2873  tats_names = [(s
-0001cfa0: 2e5f 6e61 6d65 2c20 3029 2066 6f72 2073  ._name, 0) for s
-0001cfb0: 2069 6e20 7374 6174 735d 0a20 2020 2020   in stats].     
-0001cfc0: 2020 2063 6f6c 6e61 6d65 203d 2064 6174     colname = dat
-0001cfd0: 612e 5f6d 6574 612e 6e61 6d65 0a0a 2020  a._meta.name..  
-0001cfe0: 2020 2020 2020 6e61 6d65 203d 2022 6465        name = "de
-0001cff0: 7363 7269 6265 2d6e 6f6e 6e75 6d65 7269  scribe-nonnumeri
-0001d000: 632d 3164 2d2d 2220 2b20 746f 6b65 6e69  c-1d--" + tokeni
-0001d010: 7a65 2864 6174 612c 2073 706c 6974 5f65  ze(data, split_e
-0001d020: 7665 7279 290a 2020 2020 2020 2020 6c61  very).        la
-0001d030: 7965 7220 3d20 7b0a 2020 2020 2020 2020  yer = {.        
-0001d040: 2020 2020 286e 616d 652c 2030 293a 2028      (name, 0): (
-0001d050: 6d65 7468 6f64 732e 6465 7363 7269 6265  methods.describe
-0001d060: 5f6e 6f6e 6e75 6d65 7269 635f 6167 6772  _nonnumeric_aggr
-0001d070: 6567 6174 652c 2073 7461 7473 5f6e 616d  egate, stats_nam
-0001d080: 6573 2c20 636f 6c6e 616d 6529 0a20 2020  es, colname).   
-0001d090: 2020 2020 207d 0a20 2020 2020 2020 2067       }.        g
-0001d0a0: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
-0001d0b0: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-0001d0c0: 6374 696f 6e73 286e 616d 652c 206c 6179  ctions(name, lay
-0001d0d0: 6572 2c20 6465 7065 6e64 656e 6369 6573  er, dependencies
-0001d0e0: 3d73 7461 7473 290a 0a20 2020 2020 2020  =stats)..       
-0001d0f0: 2069 6620 6e6f 7420 5041 4e44 4153 5f47   if not PANDAS_G
-0001d100: 545f 3230 303a 0a20 2020 2020 2020 2020  T_200:.         
-0001d110: 2020 2064 6174 6574 696d 655f 6973 5f6e     datetime_is_n
-0001d120: 756d 6572 6963 5f6b 7761 7267 203d 207b  umeric_kwarg = {
-0001d130: 2264 6174 6574 696d 655f 6973 5f6e 756d  "datetime_is_num
-0001d140: 6572 6963 223a 2064 6174 6574 696d 655f  eric": datetime_
-0001d150: 6973 5f6e 756d 6572 6963 7d0a 2020 2020  is_numeric}.    
-0001d160: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001d170: 2020 2020 2020 6461 7465 7469 6d65 5f69        datetime_i
-0001d180: 735f 6e75 6d65 7269 635f 6b77 6172 6720  s_numeric_kwarg 
-0001d190: 3d20 7b7d 0a20 2020 2020 2020 206d 6574  = {}.        met
-0001d1a0: 6120 3d20 6461 7461 2e5f 6d65 7461 5f6e  a = data._meta_n
-0001d1b0: 6f6e 656d 7074 792e 6465 7363 7269 6265  onempty.describe
-0001d1c0: 282a 2a64 6174 6574 696d 655f 6973 5f6e  (**datetime_is_n
-0001d1d0: 756d 6572 6963 5f6b 7761 7267 290a 2020  umeric_kwarg).  
-0001d1e0: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-0001d1f0: 5f64 645f 6f62 6a65 6374 2867 7261 7068  _dd_object(graph
-0001d200: 2c20 6e61 6d65 2c20 6d65 7461 2c20 6469  , name, meta, di
-0001d210: 7669 7369 6f6e 733d 5b4e 6f6e 652c 204e  visions=[None, N
-0001d220: 6f6e 655d 290a 0a20 2020 2064 6566 205f  one])..    def _
-0001d230: 6375 6d5f 6167 6728 0a20 2020 2020 2020  cum_agg(.       
-0001d240: 2073 656c 662c 206f 705f 6e61 6d65 2c20   self, op_name, 
-0001d250: 6368 756e 6b2c 2061 6767 7265 6761 7465  chunk, aggregate
-0001d260: 2c20 6178 6973 2c20 736b 6970 6e61 3d54  , axis, skipna=T
-0001d270: 7275 652c 2063 6875 6e6b 5f6b 7761 7267  rue, chunk_kwarg
-0001d280: 733d 4e6f 6e65 2c20 6f75 743d 4e6f 6e65  s=None, out=None
-0001d290: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0001d2a0: 2222 2257 7261 7070 6572 2066 6f72 2063  """Wrapper for c
-0001d2b0: 756d 756c 6174 6976 6520 6f70 6572 6174  umulative operat
-0001d2c0: 696f 6e22 2222 0a0a 2020 2020 2020 2020  ion"""..        
-0001d2d0: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
-0001d2e0: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
-0001d2f0: 0a0a 2020 2020 2020 2020 6966 2061 7869  ..        if axi
-0001d300: 7320 3d3d 2031 3a0a 2020 2020 2020 2020  s == 1:.        
-0001d310: 2020 2020 6e61 6d65 203d 2066 227b 7365      name = f"{se
-0001d320: 6c66 2e5f 746f 6b65 6e5f 7072 6566 6978  lf._token_prefix
-0001d330: 7d7b 6f70 5f6e 616d 657d 2861 7869 733d  }{op_name}(axis=
-0001d340: 3129 220a 2020 2020 2020 2020 2020 2020  1)".            
-0001d350: 7265 7375 6c74 203d 2073 656c 662e 6d61  result = self.ma
-0001d360: 705f 7061 7274 6974 696f 6e73 2863 6875  p_partitions(chu
-0001d370: 6e6b 2c20 746f 6b65 6e3d 6e61 6d65 2c20  nk, token=name, 
-0001d380: 2a2a 6368 756e 6b5f 6b77 6172 6773 290a  **chunk_kwargs).
-0001d390: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001d3a0: 726e 2068 616e 646c 655f 6f75 7428 6f75  rn handle_out(ou
-0001d3b0: 742c 2072 6573 756c 7429 0a20 2020 2020  t, result).     
-0001d3c0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001d3d0: 2020 2020 2023 2063 756d 756c 6174 6520       # cumulate 
-0001d3e0: 6561 6368 2070 6172 7469 7469 6f6e 730a  each partitions.
-0001d3f0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-0001d400: 3120 3d20 6622 7b73 656c 662e 5f74 6f6b  1 = f"{self._tok
-0001d410: 656e 5f70 7265 6669 787d 7b6f 705f 6e61  en_prefix}{op_na
-0001d420: 6d65 7d2d 6d61 7022 0a20 2020 2020 2020  me}-map".       
-0001d430: 2020 2020 2063 756d 7061 7274 203d 206d       cumpart = m
-0001d440: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
-0001d450: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0001d460: 6875 6e6b 2c20 7365 6c66 2c20 746f 6b65  hunk, self, toke
-0001d470: 6e3d 6e61 6d65 312c 206d 6574 613d 7365  n=name1, meta=se
-0001d480: 6c66 2c20 2a2a 6368 756e 6b5f 6b77 6172  lf, **chunk_kwar
-0001d490: 6773 0a20 2020 2020 2020 2020 2020 2029  gs.            )
-0001d4a0: 0a0a 2020 2020 2020 2020 2020 2020 6e61  ..            na
-0001d4b0: 6d65 3220 3d20 6622 7b73 656c 662e 5f74  me2 = f"{self._t
-0001d4c0: 6f6b 656e 5f70 7265 6669 787d 7b6f 705f  oken_prefix}{op_
-0001d4d0: 6e61 6d65 7d2d 7461 6b65 2d6c 6173 7422  name}-take-last"
-0001d4e0: 0a20 2020 2020 2020 2020 2020 2063 756d  .            cum
-0001d4f0: 6c61 7374 203d 206d 6170 5f70 6172 7469  last = map_parti
-0001d500: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
-0001d510: 2020 2020 2020 205f 7461 6b65 5f6c 6173         _take_las
-0001d520: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-0001d530: 2020 2063 756d 7061 7274 2c0a 2020 2020     cumpart,.    
-0001d540: 2020 2020 2020 2020 2020 2020 736b 6970              skip
-0001d550: 6e61 2c0a 2020 2020 2020 2020 2020 2020  na,.            
-0001d560: 2020 2020 6d65 7461 3d6d 6574 615f 7365      meta=meta_se
-0001d570: 7269 6573 5f63 6f6e 7374 7275 6374 6f72  ries_constructor
-0001d580: 2873 656c 6629 285b 5d2c 2064 7479 7065  (self)([], dtype
-0001d590: 3d22 666c 6f61 7422 292c 0a20 2020 2020  ="float"),.     
-0001d5a0: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
-0001d5b0: 3d6e 616d 6532 2c0a 2020 2020 2020 2020  =name2,.        
-0001d5c0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-0001d5d0: 2020 2073 7566 6669 7820 3d20 746f 6b65     suffix = toke
-0001d5e0: 6e69 7a65 2873 656c 6629 0a20 2020 2020  nize(self).     
-0001d5f0: 2020 2020 2020 206e 616d 6520 3d20 6622         name = f"
-0001d600: 7b73 656c 662e 5f74 6f6b 656e 5f70 7265  {self._token_pre
-0001d610: 6669 787d 7b6f 705f 6e61 6d65 7d2d 7b73  fix}{op_name}-{s
-0001d620: 7566 6669 787d 220a 2020 2020 2020 2020  uffix}".        
-0001d630: 2020 2020 636e 616d 6520 3d20 6622 7b73      cname = f"{s
-0001d640: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
-0001d650: 787d 7b6f 705f 6e61 6d65 7d2d 6375 6d2d  x}{op_name}-cum-
-0001d660: 6c61 7374 2d7b 7375 6666 6978 7d22 0a0a  last-{suffix}"..
-0001d670: 2020 2020 2020 2020 2020 2020 2320 6167              # ag
-0001d680: 6772 6567 6174 6520 6375 6d75 6c61 7465  gregate cumulate
-0001d690: 6420 7061 7274 6973 696f 6e73 2061 6e64  d partisions and
-0001d6a0: 2069 7473 2070 7265 7669 6f75 7320 6c61   its previous la
-0001d6b0: 7374 2065 6c65 6d65 6e74 0a20 2020 2020  st element.     
-0001d6c0: 2020 2020 2020 206c 6179 6572 203d 207b         layer = {
-0001d6d0: 7d0a 2020 2020 2020 2020 2020 2020 6c61  }.            la
-0001d6e0: 7965 725b 286e 616d 652c 2030 295d 203d  yer[(name, 0)] =
-0001d6f0: 2028 6375 6d70 6172 742e 5f6e 616d 652c   (cumpart._name,
-0001d700: 2030 290a 0a20 2020 2020 2020 2020 2020   0)..           
-0001d710: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0001d720: 312c 2073 656c 662e 6e70 6172 7469 7469  1, self.npartiti
-0001d730: 6f6e 7329 3a0a 2020 2020 2020 2020 2020  ons):.          
-0001d740: 2020 2020 2020 2320 7374 6f72 6520 6561        # store ea
-0001d750: 6368 2063 756d 756c 6174 6976 6520 7374  ch cumulative st
-0001d760: 6570 2074 6f20 6772 6170 6820 746f 2072  ep to graph to r
-0001d770: 6564 7563 6520 636f 6d70 7574 6174 696f  educe computatio
-0001d780: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
-0001d790: 2020 6966 2069 203d 3d20 313a 0a20 2020    if i == 1:.   
-0001d7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d7b0: 206c 6179 6572 5b28 636e 616d 652c 2069   layer[(cname, i
-0001d7c0: 295d 203d 2028 6375 6d6c 6173 742e 5f6e  )] = (cumlast._n
-0001d7d0: 616d 652c 2069 202d 2031 290a 2020 2020  ame, i - 1).    
-0001d7e0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0001d7f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001d800: 2020 2020 2020 2320 6167 6772 6567 6174        # aggregat
-0001d810: 6520 7769 7468 2070 7265 7669 6f75 7320  e with previous 
-0001d820: 6375 6d75 6c61 7469 6f6e 2072 6573 756c  cumulation resul
-0001d830: 7473 0a20 2020 2020 2020 2020 2020 2020  ts.             
-0001d840: 2020 2020 2020 206c 6179 6572 5b28 636e         layer[(cn
-0001d850: 616d 652c 2069 295d 203d 2028 0a20 2020  ame, i)] = (.   
-0001d860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d870: 2020 2020 206d 6574 686f 6473 2e5f 6375       methods._cu
-0001d880: 6d5f 6167 6772 6567 6174 655f 6170 706c  m_aggregate_appl
-0001d890: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-0001d8a0: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
-0001d8b0: 6761 7465 2c0a 2020 2020 2020 2020 2020  gate,.          
-0001d8c0: 2020 2020 2020 2020 2020 2020 2020 2863                (c
-0001d8d0: 6e61 6d65 2c20 6920 2d20 3129 2c0a 2020  name, i - 1),.  
+00014030: 2061 6767 7265 6761 7465 5f6b 7761 7267   aggregate_kwarg
+00014040: 733d 7b22 7363 616c 6172 223a 2073 6361  s={"scalar": sca
+00014050: 6c61 727d 2c0a 2020 2020 2020 2020 2020  lar},.          
+00014060: 2020 2020 2020 746f 6b65 6e3d 7365 6c66        token=self
+00014070: 2e5f 746f 6b65 6e5f 7072 6566 6978 202b  ._token_prefix +
+00014080: 2066 6e2c 0a20 2020 2020 2020 2020 2020   fn,.           
+00014090: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
+000140a0: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
+000140b0: 2020 2020 2020 2020 2020 2020 2020 736b                sk
+000140c0: 6970 6e61 3d73 6b69 706e 612c 0a20 2020  ipna=skipna,.   
+000140d0: 2020 2020 2020 2020 2020 2020 2066 6e3d               fn=
+000140e0: 666e 2c0a 2020 2020 2020 2020 2020 2020  fn,.            
+000140f0: 2020 2020 2a2a 6e75 6d65 7269 635f 6f6e      **numeric_on
+00014100: 6c79 5f6b 7761 7267 732c 0a20 2020 2020  ly_kwargs,.     
+00014110: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00014120: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00014130: 6365 2873 656c 662c 2044 6174 6146 7261  ce(self, DataFra
+00014140: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
+00014150: 2020 2020 2072 6573 756c 742e 6469 7669       result.divi
+00014160: 7369 6f6e 7320 3d20 286d 696e 2873 656c  sions = (min(sel
+00014170: 662e 636f 6c75 6d6e 7329 2c20 6d61 7828  f.columns), max(
+00014180: 7365 6c66 2e63 6f6c 756d 6e73 2929 0a20  self.columns)). 
+00014190: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000141a0: 6e20 7265 7375 6c74 0a0a 2020 2020 4064  n result..    @d
+000141b0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+000141c0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+000141d0: 6620 6964 786d 696e 280a 2020 2020 2020  f idxmin(.      
+000141e0: 2020 7365 6c66 2c20 6178 6973 3d4e 6f6e    self, axis=Non
+000141f0: 652c 2073 6b69 706e 613d 5472 7565 2c20  e, skipna=True, 
+00014200: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
+00014210: 652c 206e 756d 6572 6963 5f6f 6e6c 793d  e, numeric_only=
+00014220: 6e6f 5f64 6566 6175 6c74 0a20 2020 2029  no_default.    )
+00014230: 3a0a 2020 2020 2020 2020 666e 203d 2022  :.        fn = "
+00014240: 6964 786d 696e 220a 2020 2020 2020 2020  idxmin".        
+00014250: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
+00014260: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
+00014270: 0a20 2020 2020 2020 206e 756d 6572 6963  .        numeric
+00014280: 5f6f 6e6c 795f 6b77 6172 6773 203d 2063  _only_kwargs = c
+00014290: 6865 636b 5f6e 756d 6572 6963 5f6f 6e6c  heck_numeric_onl
+000142a0: 795f 7661 6c69 6428 6e75 6d65 7269 635f  y_valid(numeric_
+000142b0: 6f6e 6c79 2c20 2269 6478 6d61 7822 290a  only, "idxmax").
+000142c0: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
+000142d0: 656c 662e 5f6d 6574 615f 6e6f 6e65 6d70  elf._meta_nonemp
+000142e0: 7479 2e69 6478 6d61 7828 0a20 2020 2020  ty.idxmax(.     
+000142f0: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
+00014300: 2c20 736b 6970 6e61 3d73 6b69 706e 612c  , skipna=skipna,
+00014310: 202a 2a6e 756d 6572 6963 5f6f 6e6c 795f   **numeric_only_
+00014320: 6b77 6172 6773 0a20 2020 2020 2020 2029  kwargs.        )
+00014330: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
+00014340: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+00014350: 2020 2072 6574 7572 6e20 6d61 705f 7061     return map_pa
+00014360: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+00014370: 2020 2020 2020 2020 2020 4d2e 6964 786d            M.idxm
+00014380: 696e 2c0a 2020 2020 2020 2020 2020 2020  in,.            
+00014390: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+000143a0: 2020 2020 2020 2020 2020 6d65 7461 3d6d            meta=m
+000143b0: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
+000143c0: 2020 2020 2074 6f6b 656e 3d73 656c 662e       token=self.
+000143d0: 5f74 6f6b 656e 5f70 7265 6669 7820 2b20  _token_prefix + 
+000143e0: 666e 2c0a 2020 2020 2020 2020 2020 2020  fn,.            
+000143f0: 2020 2020 736b 6970 6e61 3d73 6b69 706e      skipna=skipn
+00014400: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
+00014410: 2020 2061 7869 733d 6178 6973 2c0a 2020     axis=axis,.  
+00014420: 2020 2020 2020 2020 2020 2020 2020 656e                en
+00014430: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
+00014440: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+00014450: 2020 2020 2020 2a2a 6e75 6d65 7269 635f        **numeric_
+00014460: 6f6e 6c79 5f6b 7761 7267 732c 0a20 2020  only_kwargs,.   
+00014470: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00014480: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00014490: 2020 2020 2073 6361 6c61 7220 3d20 6e6f       scalar = no
+000144a0: 7420 6973 5f73 6572 6965 735f 6c69 6b65  t is_series_like
+000144b0: 286d 6574 6129 0a20 2020 2020 2020 2020  (meta).         
+000144c0: 2020 2072 6573 756c 7420 3d20 6163 6128     result = aca(
+000144d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000144e0: 205b 7365 6c66 5d2c 0a20 2020 2020 2020   [self],.       
+000144f0: 2020 2020 2020 2020 2063 6875 6e6b 3d69           chunk=i
+00014500: 6478 6d61 786d 696e 5f63 6875 6e6b 2c0a  dxmaxmin_chunk,.
+00014510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014520: 6167 6772 6567 6174 653d 6964 786d 6178  aggregate=idxmax
+00014530: 6d69 6e5f 6167 672c 0a20 2020 2020 2020  min_agg,.       
+00014540: 2020 2020 2020 2020 2063 6f6d 6269 6e65           combine
+00014550: 3d69 6478 6d61 786d 696e 5f63 6f6d 6269  =idxmaxmin_combi
+00014560: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+00014570: 2020 2020 6d65 7461 3d6d 6574 612c 0a20      meta=meta,. 
+00014580: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00014590: 6767 7265 6761 7465 5f6b 7761 7267 733d  ggregate_kwargs=
+000145a0: 7b22 7363 616c 6172 223a 2073 6361 6c61  {"scalar": scala
+000145b0: 727d 2c0a 2020 2020 2020 2020 2020 2020  r},.            
+000145c0: 2020 2020 746f 6b65 6e3d 7365 6c66 2e5f      token=self._
+000145d0: 746f 6b65 6e5f 7072 6566 6978 202b 2066  token_prefix + f
+000145e0: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
+000145f0: 2020 2073 706c 6974 5f65 7665 7279 3d73     split_every=s
+00014600: 706c 6974 5f65 7665 7279 2c0a 2020 2020  plit_every,.    
+00014610: 2020 2020 2020 2020 2020 2020 736b 6970              skip
+00014620: 6e61 3d73 6b69 706e 612c 0a20 2020 2020  na=skipna,.     
+00014630: 2020 2020 2020 2020 2020 2066 6e3d 666e             fn=fn
+00014640: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00014650: 2020 2a2a 6e75 6d65 7269 635f 6f6e 6c79    **numeric_only
+00014660: 5f6b 7761 7267 732c 0a20 2020 2020 2020  _kwargs,.       
+00014670: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00014680: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00014690: 2873 656c 662c 2044 6174 6146 7261 6d65  (self, DataFrame
+000146a0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000146b0: 2020 2072 6573 756c 742e 6469 7669 7369     result.divisi
+000146c0: 6f6e 7320 3d20 286d 696e 2873 656c 662e  ons = (min(self.
+000146d0: 636f 6c75 6d6e 7329 2c20 6d61 7828 7365  columns), max(se
+000146e0: 6c66 2e63 6f6c 756d 6e73 2929 0a20 2020  lf.columns)).   
+000146f0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00014700: 7265 7375 6c74 0a0a 2020 2020 4064 6572  result..    @der
+00014710: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
+00014720: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
+00014730: 636f 756e 7428 7365 6c66 2c20 6178 6973  count(self, axis
+00014740: 3d4e 6f6e 652c 2073 706c 6974 5f65 7665  =None, split_eve
+00014750: 7279 3d46 616c 7365 2c20 6e75 6d65 7269  ry=False, numeri
+00014760: 635f 6f6e 6c79 3d46 616c 7365 293a 0a20  c_only=False):. 
+00014770: 2020 2020 2020 2023 2054 6869 7320 6d65         # This me
+00014780: 7468 6f64 2069 7320 7368 6172 6564 2062  thod is shared b
+00014790: 7920 4461 7461 4672 616d 6520 2f20 5365  y DataFrame / Se
+000147a0: 7269 6573 2c20 6275 7420 6f6e 6c79 2044  ries, but only D
+000147b0: 6174 6146 7261 6d65 0a20 2020 2020 2020  ataFrame.       
+000147c0: 2023 2073 7570 706f 7274 7320 606e 756d   # supports `num
+000147d0: 6572 6963 5f6f 6e6c 793d 602e 2048 616e  eric_only=`. Han
+000147e0: 646c 6520 6163 636f 7264 696e 676c 7920  dle accordingly 
+000147f0: 6865 7265 2e0a 2020 2020 2020 2020 6e75  here..        nu
+00014800: 6d65 7269 635f 6f6e 6c79 5f6b 7761 7267  meric_only_kwarg
+00014810: 7320 3d20 7b7d 0a20 2020 2020 2020 2069  s = {}.        i
+00014820: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
+00014830: 696b 6528 7365 6c66 293a 0a20 2020 2020  ike(self):.     
+00014840: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
+00014850: 6e6c 795f 6b77 6172 6773 203d 2067 6574  nly_kwargs = get
+00014860: 5f6e 756d 6572 6963 5f6f 6e6c 795f 6b77  _numeric_only_kw
+00014870: 6172 6773 286e 756d 6572 6963 5f6f 6e6c  args(numeric_onl
+00014880: 7929 0a20 2020 2020 2020 2061 7869 7320  y).        axis 
+00014890: 3d20 7365 6c66 2e5f 7661 6c69 6461 7465  = self._validate
+000148a0: 5f61 7869 7328 6178 6973 290a 2020 2020  _axis(axis).    
+000148b0: 2020 2020 746f 6b65 6e20 3d20 7365 6c66      token = self
+000148c0: 2e5f 746f 6b65 6e5f 7072 6566 6978 202b  ._token_prefix +
+000148d0: 2022 636f 756e 7422 0a20 2020 2020 2020   "count".       
+000148e0: 2069 6620 6178 6973 203d 3d20 313a 0a20   if axis == 1:. 
+000148f0: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
+00014900: 3d20 7365 6c66 2e5f 6d65 7461 5f6e 6f6e  = self._meta_non
+00014910: 656d 7074 792e 636f 756e 7428 6178 6973  empty.count(axis
+00014920: 3d61 7869 732c 202a 2a6e 756d 6572 6963  =axis, **numeric
+00014930: 5f6f 6e6c 795f 6b77 6172 6773 290a 2020  _only_kwargs).  
+00014940: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00014950: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
+00014960: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
+00014970: 2020 2020 2020 4d2e 636f 756e 742c 0a20        M.count,. 
+00014980: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00014990: 6574 613d 6d65 7461 2c0a 2020 2020 2020  eta=meta,.      
+000149a0: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
+000149b0: 746f 6b65 6e2c 0a20 2020 2020 2020 2020  token,.         
+000149c0: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
+000149d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000149e0: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
+000149f0: 7461 3d46 616c 7365 2c0a 2020 2020 2020  ta=False,.      
+00014a00: 2020 2020 2020 2020 2020 2a2a 6e75 6d65            **nume
+00014a10: 7269 635f 6f6e 6c79 5f6b 7761 7267 732c  ric_only_kwargs,
+00014a20: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00014a30: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00014a40: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
+00014a50: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
+00014a60: 7074 792e 636f 756e 7428 290a 0a20 2020  pty.count()..   
+00014a70: 2020 2020 2020 2020 2023 204e 6565 6420           # Need 
+00014a80: 7468 6520 6173 7479 7065 2869 6e74 2920  the astype(int) 
+00014a90: 666f 7220 656d 7074 7920 6461 7461 6672  for empty datafr
+00014aa0: 616d 6573 2c20 7768 6963 6820 7375 6d20  ames, which sum 
+00014ab0: 746f 2066 6c6f 6174 2064 7479 7065 0a20  to float dtype. 
+00014ac0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00014ad0: 7420 3d20 7365 6c66 2e72 6564 7563 7469  t = self.reducti
+00014ae0: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+00014af0: 2020 2020 4d2e 636f 756e 742c 0a20 2020      M.count,.   
+00014b00: 2020 2020 2020 2020 2020 2020 2061 6767               agg
+00014b10: 7265 6761 7465 3d5f 636f 756e 745f 6167  regate=_count_ag
+00014b20: 6772 6567 6174 652c 0a20 2020 2020 2020  gregate,.       
+00014b30: 2020 2020 2020 2020 206d 6574 613d 6d65           meta=me
+00014b40: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+00014b50: 2020 2020 746f 6b65 6e3d 746f 6b65 6e2c      token=token,
+00014b60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014b70: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
+00014b80: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
+00014b90: 2020 2020 2020 2020 2020 6368 756e 6b5f            chunk_
+00014ba0: 6b77 6172 6773 3d6e 756d 6572 6963 5f6f  kwargs=numeric_o
+00014bb0: 6e6c 795f 6b77 6172 6773 2c0a 2020 2020  nly_kwargs,.    
+00014bc0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00014bd0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00014be0: 6e63 6528 7365 6c66 2c20 4461 7461 4672  nce(self, DataFr
+00014bf0: 616d 6529 3a0a 2020 2020 2020 2020 2020  ame):.          
+00014c00: 2020 2020 2020 7265 7375 6c74 2e64 6976        result.div
+00014c10: 6973 696f 6e73 203d 2028 7365 6c66 2e63  isions = (self.c
+00014c20: 6f6c 756d 6e73 2e6d 696e 2829 2c20 7365  olumns.min(), se
+00014c30: 6c66 2e63 6f6c 756d 6e73 2e6d 6178 2829  lf.columns.max()
+00014c40: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00014c50: 7475 726e 2072 6573 756c 740a 0a20 2020  turn result..   
+00014c60: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00014c70: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+00014c80: 2064 6566 206d 6f64 6528 7365 6c66 2c20   def mode(self, 
+00014c90: 6472 6f70 6e61 3d54 7275 652c 2073 706c  dropna=True, spl
+00014ca0: 6974 5f65 7665 7279 3d46 616c 7365 293a  it_every=False):
+00014cb0: 0a20 2020 2020 2020 206d 6f64 655f 7365  .        mode_se
+00014cc0: 7269 6573 203d 2073 656c 662e 7265 6475  ries = self.redu
+00014cd0: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+00014ce0: 2020 2063 6875 6e6b 3d4d 2e76 616c 7565     chunk=M.value
+00014cf0: 5f63 6f75 6e74 732c 0a20 2020 2020 2020  _counts,.       
+00014d00: 2020 2020 2063 6f6d 6269 6e65 3d4d 2e73       combine=M.s
+00014d10: 756d 2c0a 2020 2020 2020 2020 2020 2020  um,.            
+00014d20: 6167 6772 6567 6174 653d 5f6d 6f64 655f  aggregate=_mode_
+00014d30: 6167 6772 6567 6174 652c 0a20 2020 2020  aggregate,.     
+00014d40: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
+00014d50: 7279 3d73 706c 6974 5f65 7665 7279 2c0a  ry=split_every,.
+00014d60: 2020 2020 2020 2020 2020 2020 6368 756e              chun
+00014d70: 6b5f 6b77 6172 6773 3d7b 2264 726f 706e  k_kwargs={"dropn
+00014d80: 6122 3a20 6472 6f70 6e61 7d2c 0a20 2020  a": dropna},.   
+00014d90: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
+00014da0: 7465 5f6b 7761 7267 733d 7b22 6472 6f70  te_kwargs={"drop
+00014db0: 6e61 223a 2064 726f 706e 617d 2c0a 2020  na": dropna},.  
+00014dc0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00014dd0: 6d6f 6465 5f73 6572 6965 732e 6e61 6d65  mode_series.name
+00014de0: 203d 2073 656c 662e 6e61 6d65 0a20 2020   = self.name.   
+00014df0: 2020 2020 2072 6574 7572 6e20 6d6f 6465       return mode
+00014e00: 5f73 6572 6965 730a 0a20 2020 2040 5f6e  _series..    @_n
+00014e10: 756d 6572 6963 5f6f 6e6c 790a 2020 2020  umeric_only.    
+00014e20: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00014e30: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+00014e40: 6465 6620 6d65 616e 280a 2020 2020 2020  def mean(.      
+00014e50: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00014e60: 6178 6973 3d30 2c0a 2020 2020 2020 2020  axis=0,.        
+00014e70: 736b 6970 6e61 3d54 7275 652c 0a20 2020  skipna=True,.   
+00014e80: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
+00014e90: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00014ea0: 6474 7970 653d 4e6f 6e65 2c0a 2020 2020  dtype=None,.    
+00014eb0: 2020 2020 6f75 743d 4e6f 6e65 2c0a 2020      out=None,.  
+00014ec0: 2020 2020 2020 6e75 6d65 7269 635f 6f6e        numeric_on
+00014ed0: 6c79 3d4e 6f6e 652c 0a20 2020 2029 3a0a  ly=None,.    ):.
+00014ee0: 2020 2020 2020 2020 6966 2028 0a20 2020          if (.   
+00014ef0: 2020 2020 2020 2020 2050 414e 4441 535f           PANDAS_
+00014f00: 4754 5f31 3430 0a20 2020 2020 2020 2020  GT_140.         
+00014f10: 2020 2061 6e64 206e 6f74 2050 414e 4441     and not PANDA
+00014f20: 535f 4754 5f32 3030 0a20 2020 2020 2020  S_GT_200.       
+00014f30: 2020 2020 2061 6e64 2061 7869 7320 6973       and axis is
+00014f40: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+00014f50: 2020 616e 6420 6973 696e 7374 616e 6365    and isinstance
+00014f60: 2873 656c 662c 2044 6174 6146 7261 6d65  (self, DataFrame
+00014f70: 290a 2020 2020 2020 2020 293a 0a20 2020  ).        ):.   
+00014f80: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
+00014f90: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
+00014fa0: 2020 2020 2020 2020 2249 6e20 6120 6675          "In a fu
+00014fb0: 7475 7265 2076 6572 7369 6f6e 2c20 4461  ture version, Da
+00014fc0: 7461 4672 616d 652e 6d65 616e 2861 7869  taFrame.mean(axi
+00014fd0: 733d 4e6f 6e65 2920 7769 6c6c 2072 6574  s=None) will ret
+00014fe0: 7572 6e20 6120 7363 616c 6172 206d 6561  urn a scalar mea
+00014ff0: 6e20 6f76 6572 2074 6865 2065 6e74 6972  n over the entir
+00015000: 6520 4461 7461 4672 616d 652e 2022 0a20  e DataFrame. ". 
+00015010: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00015020: 546f 2072 6574 6169 6e20 7468 6520 6f6c  To retain the ol
+00015030: 6420 6265 6861 7669 6f72 2c20 7573 6520  d behavior, use 
+00015040: 2766 7261 6d65 2e6d 6561 6e28 6178 6973  'frame.mean(axis
+00015050: 3d30 2927 206f 7220 6a75 7374 2027 6672  =0)' or just 'fr
+00015060: 616d 652e 6d65 616e 2829 2722 2c0a 2020  ame.mean()'",.  
+00015070: 2020 2020 2020 2020 2020 2020 2020 4675                Fu
+00015080: 7475 7265 5761 726e 696e 672c 0a20 2020  tureWarning,.   
+00015090: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000150a0: 2020 2061 7869 7320 3d20 7365 6c66 2e5f     axis = self._
+000150b0: 7661 6c69 6461 7465 5f61 7869 7328 6178  validate_axis(ax
+000150c0: 6973 2c20 6e6f 6e65 5f69 735f 7a65 726f  is, none_is_zero
+000150d0: 3d6e 6f74 2050 414e 4441 535f 4754 5f32  =not PANDAS_GT_2
+000150e0: 3030 290a 2020 2020 2020 2020 5f72 6169  00).        _rai
+000150f0: 7365 5f69 665f 6f62 6a65 6374 5f73 6572  se_if_object_ser
+00015100: 6965 7328 7365 6c66 2c20 226d 6561 6e22  ies(self, "mean"
+00015110: 290a 2020 2020 2020 2020 2320 4e4f 5445  ).        # NOTE
+00015120: 3a20 446f 2077 6520 7761 6e74 2074 6f20  : Do we want to 
+00015130: 7761 726e 2068 6572 653f 0a20 2020 2020  warn here?.     
+00015140: 2020 2077 6974 6820 6368 6563 6b5f 6e75     with check_nu
+00015150: 6d65 7269 635f 6f6e 6c79 5f64 6570 7265  meric_only_depre
+00015160: 6361 7469 6f6e 2829 2c20 6368 6563 6b5f  cation(), check_
+00015170: 6e75 6973 616e 6365 5f63 6f6c 756d 6e73  nuisance_columns
+00015180: 5f77 6172 6e69 6e67 2829 3a0a 2020 2020  _warning():.    
+00015190: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
+000151a0: 656c 662e 5f6d 6574 615f 6e6f 6e65 6d70  elf._meta_nonemp
+000151b0: 7479 2e6d 6561 6e28 0a20 2020 2020 2020  ty.mean(.       
+000151c0: 2020 2020 2020 2020 2061 7869 733d 6178           axis=ax
+000151d0: 6973 2c20 736b 6970 6e61 3d73 6b69 706e  is, skipna=skipn
+000151e0: 612c 206e 756d 6572 6963 5f6f 6e6c 793d  a, numeric_only=
+000151f0: 6e75 6d65 7269 635f 6f6e 6c79 0a20 2020  numeric_only.   
+00015200: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00015210: 2020 2069 6620 6178 6973 203d 3d20 313a     if axis == 1:
+00015220: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00015230: 756c 7420 3d20 6d61 705f 7061 7274 6974  ult = map_partit
+00015240: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
+00015250: 2020 2020 2020 4d2e 6d65 616e 2c0a 2020        M.mean,.  
+00015260: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00015270: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+00015280: 2020 2020 6d65 7461 3d6d 6574 612c 0a20      meta=meta,. 
+00015290: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+000152a0: 6f6b 656e 3d73 656c 662e 5f74 6f6b 656e  oken=self._token
+000152b0: 5f70 7265 6669 7820 2b20 226d 6561 6e22  _prefix + "mean"
+000152c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000152d0: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
+000152e0: 2020 2020 2020 2020 2020 2020 2073 6b69               ski
+000152f0: 706e 613d 736b 6970 6e61 2c0a 2020 2020  pna=skipna,.    
+00015300: 2020 2020 2020 2020 2020 2020 656e 666f              enfo
+00015310: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
+00015320: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
+00015330: 2020 2020 6e75 6d65 7269 635f 6f6e 6c79      numeric_only
+00015340: 3d6e 756d 6572 6963 5f6f 6e6c 792c 0a20  =numeric_only,. 
+00015350: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00015360: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00015370: 6861 6e64 6c65 5f6f 7574 286f 7574 2c20  handle_out(out, 
+00015380: 7265 7375 6c74 290a 2020 2020 2020 2020  result).        
+00015390: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000153a0: 2020 6e75 6d20 3d20 7365 6c66 2e5f 6765    num = self._ge
+000153b0: 745f 6e75 6d65 7269 635f 6461 7461 2829  t_numeric_data()
+000153c0: 0a20 2020 2020 2020 2020 2020 2073 203d  .            s =
+000153d0: 206e 756d 2e73 756d 2873 6b69 706e 613d   num.sum(skipna=
+000153e0: 736b 6970 6e61 2c20 7370 6c69 745f 6576  skipna, split_ev
+000153f0: 6572 793d 7370 6c69 745f 6576 6572 7929  ery=split_every)
+00015400: 0a20 2020 2020 2020 2020 2020 206e 203d  .            n =
+00015410: 206e 756d 2e63 6f75 6e74 2873 706c 6974   num.count(split
+00015420: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+00015430: 7279 290a 2020 2020 2020 2020 2020 2020  ry).            
+00015440: 2320 5374 6172 7469 6e67 2069 6e20 7061  # Starting in pa
+00015450: 6e64 6173 2032 2e30 2c20 6061 7869 733d  ndas 2.0, `axis=
+00015460: 4e6f 6e65 6020 646f 6573 2061 2066 756c  None` does a ful
+00015470: 6c20 6167 6772 6567 6174 696f 6e20 6163  l aggregation ac
+00015480: 726f 7373 2062 6f74 6820 6178 6573 0a20  ross both axes. 
+00015490: 2020 2020 2020 2020 2020 2069 6620 5041             if PA
+000154a0: 4e44 4153 5f47 545f 3230 3020 616e 6420  NDAS_GT_200 and 
+000154b0: 6178 6973 2069 7320 4e6f 6e65 2061 6e64  axis is None and
+000154c0: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+000154d0: 2c20 4461 7461 4672 616d 6529 3a0a 2020  , DataFrame):.  
+000154e0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+000154f0: 7375 6c74 203d 2073 2e73 756d 2829 202f  sult = s.sum() /
+00015500: 206e 2e73 756d 2829 0a20 2020 2020 2020   n.sum().       
+00015510: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00015520: 2020 2020 2020 2020 2020 206e 616d 6520             name 
+00015530: 3d20 7365 6c66 2e5f 746f 6b65 6e5f 7072  = self._token_pr
+00015540: 6566 6978 202b 2022 6d65 616e 2d25 7322  efix + "mean-%s"
+00015550: 2025 2074 6f6b 656e 697a 6528 7365 6c66   % tokenize(self
+00015560: 2c20 6178 6973 2c20 736b 6970 6e61 290a  , axis, skipna).
+00015570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015580: 7265 7375 6c74 203d 206d 6170 5f70 6172  result = map_par
+00015590: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
+000155a0: 2020 2020 2020 2020 2020 2020 206d 6574               met
+000155b0: 686f 6473 2e6d 6561 6e5f 6167 6772 6567  hods.mean_aggreg
+000155c0: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+000155d0: 2020 2020 2020 2020 2073 2c0a 2020 2020           s,.    
+000155e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000155f0: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
+00015600: 2020 2020 2020 2074 6f6b 656e 3d6e 616d         token=nam
+00015610: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00015620: 2020 2020 2020 206d 6574 613d 6d65 7461         meta=meta
+00015630: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00015640: 2020 2020 2020 656e 666f 7263 655f 6d65        enforce_me
+00015650: 7461 6461 7461 3d46 616c 7365 2c0a 2020  tadata=False,.  
+00015660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015670: 2020 7061 7265 6e74 5f6d 6574 613d 7365    parent_meta=se
+00015680: 6c66 2e5f 6d65 7461 2c0a 2020 2020 2020  lf._meta,.      
+00015690: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000156a0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+000156b0: 7369 6e73 7461 6e63 6528 7365 6c66 2c20  sinstance(self, 
+000156c0: 4461 7461 4672 616d 6529 3a0a 2020 2020  DataFrame):.    
+000156d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000156e0: 7265 7375 6c74 2e64 6976 6973 696f 6e73  result.divisions
+000156f0: 203d 2028 7365 6c66 2e63 6f6c 756d 6e73   = (self.columns
+00015700: 2e6d 696e 2829 2c20 7365 6c66 2e63 6f6c  .min(), self.col
+00015710: 756d 6e73 2e6d 6178 2829 290a 2020 2020  umns.max()).    
+00015720: 2020 2020 2020 2020 7265 7475 726e 2068          return h
+00015730: 616e 646c 655f 6f75 7428 6f75 742c 2072  andle_out(out, r
+00015740: 6573 756c 7429 0a0a 2020 2020 6465 6620  esult)..    def 
+00015750: 6d65 6469 616e 5f61 7070 726f 7869 6d61  median_approxima
+00015760: 7465 280a 2020 2020 2020 2020 7365 6c66  te(.        self
+00015770: 2c0a 2020 2020 2020 2020 6178 6973 3d4e  ,.        axis=N
+00015780: 6f6e 652c 0a20 2020 2020 2020 206d 6574  one,.        met
+00015790: 686f 643d 2264 6566 6175 6c74 222c 0a20  hod="default",. 
+000157a0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+000157b0: 2252 6574 7572 6e20 7468 6520 6170 7072  "Return the appr
+000157c0: 6f78 696d 6174 6520 6d65 6469 616e 206f  oximate median o
+000157d0: 6620 7468 6520 7661 6c75 6573 206f 7665  f the values ove
+000157e0: 7220 7468 6520 7265 7175 6573 7465 6420  r the requested 
+000157f0: 6178 6973 2e0a 0a20 2020 2020 2020 2050  axis...        P
+00015800: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00015810: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00015820: 2020 2020 2061 7869 7320 3a20 7b30 2c20       axis : {0, 
+00015830: 312c 2022 696e 6465 7822 2c20 2263 6f6c  1, "index", "col
+00015840: 756d 6e73 227d 2028 6465 6661 756c 7420  umns"} (default 
+00015850: 3029 0a20 2020 2020 2020 2020 2020 2030  0).            0
+00015860: 206f 7220 6060 2269 6e64 6578 2260 6020   or ``"index"`` 
+00015870: 666f 7220 726f 772d 7769 7365 2c20 3120  for row-wise, 1 
+00015880: 6f72 2060 6022 636f 6c75 6d6e 7322 6060  or ``"columns"``
+00015890: 2066 6f72 2063 6f6c 756d 6e2d 7769 7365   for column-wise
+000158a0: 0a20 2020 2020 2020 206d 6574 686f 6420  .        method 
+000158b0: 3a20 7b27 6465 6661 756c 7427 2c20 2774  : {'default', 't
+000158c0: 6469 6765 7374 272c 2027 6461 736b 277d  digest', 'dask'}
+000158d0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+000158e0: 2020 2020 2020 2057 6861 7420 6d65 7468         What meth
+000158f0: 6f64 2074 6f20 7573 652e 2042 7920 6465  od to use. By de
+00015900: 6661 756c 7420 7769 6c6c 2075 7365 2044  fault will use D
+00015910: 6173 6b27 7320 696e 7465 726e 616c 2063  ask's internal c
+00015920: 7573 746f 6d0a 2020 2020 2020 2020 2020  ustom.          
+00015930: 2020 616c 676f 7269 7468 6d20 2860 6022    algorithm (``"
+00015940: 6461 736b 2260 6029 2e20 2049 6620 7365  dask"``).  If se
+00015950: 7420 746f 2060 6022 7464 6967 6573 7422  t to ``"tdigest"
+00015960: 6060 2077 696c 6c20 7573 6520 7464 6967  `` will use tdig
+00015970: 6573 740a 2020 2020 2020 2020 2020 2020  est.            
+00015980: 666f 7220 666c 6f61 7473 2061 6e64 2069  for floats and i
+00015990: 6e74 7320 616e 6420 6661 6c6c 6261 636b  nts and fallback
+000159a0: 2074 6f20 7468 6520 6060 2264 6173 6b22   to the ``"dask"
+000159b0: 6060 206f 7468 6572 7769 7365 2e0a 2020  `` otherwise..  
+000159c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000159d0: 2020 7265 7475 726e 2073 656c 662e 7175    return self.qu
+000159e0: 616e 7469 6c65 2871 3d30 2e35 2c20 6178  antile(q=0.5, ax
+000159f0: 6973 3d61 7869 732c 206d 6574 686f 643d  is=axis, method=
+00015a00: 6d65 7468 6f64 292e 7265 6e61 6d65 284e  method).rename(N
+00015a10: 6f6e 6529 0a0a 2020 2020 4064 6572 6976  one)..    @deriv
+00015a20: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+00015a30: 7261 6d65 290a 2020 2020 6465 6620 6d65  rame).    def me
+00015a40: 6469 616e 2873 656c 662c 2061 7869 733d  dian(self, axis=
+00015a50: 4e6f 6e65 2c20 6d65 7468 6f64 3d22 6465  None, method="de
+00015a60: 6661 756c 7422 293a 0a20 2020 2020 2020  fault"):.       
+00015a70: 2069 6620 6178 6973 2069 6e20 2831 2c20   if axis in (1, 
+00015a80: 2263 6f6c 756d 6e73 2229 206f 7220 7365  "columns") or se
+00015a90: 6c66 2e6e 7061 7274 6974 696f 6e73 203d  lf.npartitions =
+00015aa0: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+00015ab0: 2023 2043 616e 2070 726f 7669 6465 2061   # Can provide a
+00015ac0: 6e20 6578 6163 7420 6d65 6469 616e 2069  n exact median i
+00015ad0: 6e20 7468 6573 6520 6361 7365 730a 2020  n these cases.  
+00015ae0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00015af0: 2073 656c 662e 6d65 6469 616e 5f61 7070   self.median_app
+00015b00: 726f 7869 6d61 7465 2861 7869 733d 6178  roximate(axis=ax
+00015b10: 6973 2c20 6d65 7468 6f64 3d6d 6574 686f  is, method=metho
+00015b20: 6429 0a20 2020 2020 2020 2072 6169 7365  d).        raise
+00015b30: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
+00015b40: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00015b50: 2020 2244 6173 6b20 646f 6573 6e27 7420    "Dask doesn't 
+00015b60: 696d 706c 656d 656e 7420 616e 2065 7861  implement an exa
+00015b70: 6374 206d 6564 6961 6e20 696e 2061 6c6c  ct median in all
+00015b80: 2063 6173 6573 2061 7320 7468 6973 2069   cases as this i
+00015b90: 7320 6861 7264 2074 6f20 646f 2069 6e20  s hard to do in 
+00015ba0: 7061 7261 6c6c 656c 2e20 220a 2020 2020  parallel. ".    
+00015bb0: 2020 2020 2020 2020 2253 6565 2074 6865          "See the
+00015bc0: 2060 6d65 6469 616e 5f61 7070 726f 7869   `median_approxi
+00015bd0: 6d61 7465 6020 6d65 7468 6f64 2069 6e73  mate` method ins
+00015be0: 7465 6164 2c20 7768 6963 6820 7573 6573  tead, which uses
+00015bf0: 2061 6e20 6170 7072 6f78 696d 6174 6520   an approximate 
+00015c00: 616c 676f 7269 7468 6d2e 220a 2020 2020  algorithm.".    
+00015c10: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
+00015c20: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+00015c30: 4672 616d 6529 0a20 2020 2064 6566 2076  Frame).    def v
+00015c40: 6172 280a 2020 2020 2020 2020 7365 6c66  ar(.        self
+00015c50: 2c0a 2020 2020 2020 2020 6178 6973 3d4e  ,.        axis=N
+00015c60: 6f6e 652c 0a20 2020 2020 2020 2073 6b69  one,.        ski
+00015c70: 706e 613d 5472 7565 2c0a 2020 2020 2020  pna=True,.      
+00015c80: 2020 6464 6f66 3d31 2c0a 2020 2020 2020    ddof=1,.      
+00015c90: 2020 7370 6c69 745f 6576 6572 793d 4661    split_every=Fa
+00015ca0: 6c73 652c 0a20 2020 2020 2020 2064 7479  lse,.        dty
+00015cb0: 7065 3d4e 6f6e 652c 0a20 2020 2020 2020  pe=None,.       
+00015cc0: 206f 7574 3d4e 6f6e 652c 0a20 2020 2020   out=None,.     
+00015cd0: 2020 206e 756d 6572 6963 5f6f 6e6c 793d     numeric_only=
+00015ce0: 6e6f 5f64 6566 6175 6c74 2c0a 2020 2020  no_default,.    
+00015cf0: 293a 0a20 2020 2020 2020 2061 7869 7320  ):.        axis 
+00015d00: 3d20 7365 6c66 2e5f 7661 6c69 6461 7465  = self._validate
+00015d10: 5f61 7869 7328 6178 6973 290a 2020 2020  _axis(axis).    
+00015d20: 2020 2020 5f72 6169 7365 5f69 665f 6f62      _raise_if_ob
+00015d30: 6a65 6374 5f73 6572 6965 7328 7365 6c66  ject_series(self
+00015d40: 2c20 2276 6172 2229 0a20 2020 2020 2020  , "var").       
+00015d50: 206e 756d 6572 6963 5f6f 6e6c 795f 6b77   numeric_only_kw
+00015d60: 6172 6773 203d 2067 6574 5f6e 756d 6572  args = get_numer
+00015d70: 6963 5f6f 6e6c 795f 6b77 6172 6773 286e  ic_only_kwargs(n
+00015d80: 756d 6572 6963 5f6f 6e6c 7929 0a20 2020  umeric_only).   
+00015d90: 2020 2020 2077 6974 6820 6368 6563 6b5f       with check_
+00015da0: 6e75 6d65 7269 635f 6f6e 6c79 5f64 6570  numeric_only_dep
+00015db0: 7265 6361 7469 6f6e 280a 2020 2020 2020  recation(.      
+00015dc0: 2020 2020 2020 2276 6172 222c 2054 7275        "var", Tru
+00015dd0: 650a 2020 2020 2020 2020 292c 2063 6865  e.        ), che
+00015de0: 636b 5f72 6564 7563 7469 6f6e 735f 7275  ck_reductions_ru
+00015df0: 6e74 696d 655f 7761 726e 696e 6728 293a  ntime_warning():
+00015e00: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+00015e10: 6120 3d20 7365 6c66 2e5f 6d65 7461 5f6e  a = self._meta_n
+00015e20: 6f6e 656d 7074 792e 7661 7228 0a20 2020  onempty.var(.   
+00015e30: 2020 2020 2020 2020 2020 2020 2061 7869               axi
+00015e40: 733d 6178 6973 2c0a 2020 2020 2020 2020  s=axis,.        
+00015e50: 2020 2020 2020 2020 736b 6970 6e61 3d73          skipna=s
+00015e60: 6b69 706e 612c 0a20 2020 2020 2020 2020  kipna,.         
+00015e70: 2020 2020 2020 202a 2a6e 756d 6572 6963         **numeric
+00015e80: 5f6f 6e6c 795f 6b77 6172 6773 2c0a 2020  _only_kwargs,.  
+00015e90: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00015ea0: 2020 2020 6966 2061 7869 7320 3d3d 2031      if axis == 1
+00015eb0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00015ec0: 7375 6c74 203d 206d 6170 5f70 6172 7469  sult = map_parti
+00015ed0: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
+00015ee0: 2020 2020 2020 204d 2e76 6172 2c0a 2020         M.var,.  
+00015ef0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00015f00: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+00015f10: 2020 2020 6d65 7461 3d6d 6574 612c 0a20      meta=meta,. 
+00015f20: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00015f30: 6f6b 656e 3d73 656c 662e 5f74 6f6b 656e  oken=self._token
+00015f40: 5f70 7265 6669 7820 2b20 2276 6172 222c  _prefix + "var",
+00015f50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015f60: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
+00015f70: 2020 2020 2020 2020 2020 2020 736b 6970              skip
+00015f80: 6e61 3d73 6b69 706e 612c 0a20 2020 2020  na=skipna,.     
+00015f90: 2020 2020 2020 2020 2020 2064 646f 663d             ddof=
+00015fa0: 6464 6f66 2c0a 2020 2020 2020 2020 2020  ddof,.          
+00015fb0: 2020 2020 2020 656e 666f 7263 655f 6d65        enforce_me
+00015fc0: 7461 6461 7461 3d46 616c 7365 2c0a 2020  tadata=False,.  
+00015fd0: 2020 2020 2020 2020 2020 2020 2020 2a2a                **
+00015fe0: 6e75 6d65 7269 635f 6f6e 6c79 5f6b 7761  numeric_only_kwa
+00015ff0: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
+00016000: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+00016010: 6574 7572 6e20 6861 6e64 6c65 5f6f 7574  eturn handle_out
+00016020: 286f 7574 2c20 7265 7375 6c74 290a 2020  (out, result).  
+00016030: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00016040: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00016050: 6e64 696d 203d 3d20 313a 0a20 2020 2020  ndim == 1:.     
+00016060: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00016070: 7420 3d20 7365 6c66 2e5f 7661 725f 3164  t = self._var_1d
+00016080: 2873 656c 662c 2073 6b69 706e 612c 2064  (self, skipna, d
+00016090: 646f 662c 2073 706c 6974 5f65 7665 7279  dof, split_every
+000160a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000160b0: 2020 7265 7475 726e 2068 616e 646c 655f    return handle_
+000160c0: 6f75 7428 6f75 742c 2072 6573 756c 7429  out(out, result)
+000160d0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+000160e0: 7061 6e64 6173 2031 2e30 2b20 646f 6573  pandas 1.0+ does
+000160f0: 206e 6f74 2069 6d70 6c65 6d65 6e74 2076   not implement v
+00016100: 6172 206f 6e20 7469 6d65 6465 6c74 610a  ar on timedelta.
+00016110: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00016120: 6c74 203d 2073 656c 662e 5f76 6172 5f6e  lt = self._var_n
+00016130: 756d 6572 6963 2873 6b69 706e 612c 2064  umeric(skipna, d
+00016140: 646f 662c 2073 706c 6974 5f65 7665 7279  dof, split_every
+00016150: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
+00016160: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
+00016170: 662c 2044 6174 6146 7261 6d65 293a 0a20  f, DataFrame):. 
+00016180: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00016190: 6573 756c 742e 6469 7669 7369 6f6e 7320  esult.divisions 
+000161a0: 3d20 2873 656c 662e 636f 6c75 6d6e 732e  = (self.columns.
+000161b0: 6d69 6e28 292c 2073 656c 662e 636f 6c75  min(), self.colu
+000161c0: 6d6e 732e 6d61 7828 2929 0a20 2020 2020  mns.max()).     
+000161d0: 2020 2020 2020 2072 6574 7572 6e20 6861         return ha
+000161e0: 6e64 6c65 5f6f 7574 286f 7574 2c20 7265  ndle_out(out, re
+000161f0: 7375 6c74 290a 0a20 2020 2064 6566 205f  sult)..    def _
+00016200: 7661 725f 6e75 6d65 7269 6328 7365 6c66  var_numeric(self
+00016210: 2c20 736b 6970 6e61 3d54 7275 652c 2064  , skipna=True, d
+00016220: 646f 663d 312c 2073 706c 6974 5f65 7665  dof=1, split_eve
+00016230: 7279 3d46 616c 7365 293a 0a20 2020 2020  ry=False):.     
+00016240: 2020 206e 756d 203d 2073 656c 662e 7365     num = self.se
+00016250: 6c65 6374 5f64 7479 7065 7328 696e 636c  lect_dtypes(incl
+00016260: 7564 653d 5b22 6e75 6d62 6572 222c 2022  ude=["number", "
+00016270: 626f 6f6c 225d 2c20 6578 636c 7564 653d  bool"], exclude=
+00016280: 5b6e 702e 7469 6d65 6465 6c74 6136 345d  [np.timedelta64]
+00016290: 290a 0a20 2020 2020 2020 2076 616c 7565  )..        value
+000162a0: 735f 6474 7970 6520 3d20 6e75 6d2e 7661  s_dtype = num.va
+000162b0: 6c75 6573 2e64 7479 7065 0a20 2020 2020  lues.dtype.     
+000162c0: 2020 2061 7272 6179 5f76 616c 7565 7320     array_values 
+000162d0: 3d20 6e75 6d2e 7661 6c75 6573 0a0a 2020  = num.values..  
+000162e0: 2020 2020 2020 6966 206e 6f74 206e 702e        if not np.
+000162f0: 6973 7375 6264 7479 7065 2876 616c 7565  issubdtype(value
+00016300: 735f 6474 7970 652c 206e 702e 6e75 6d62  s_dtype, np.numb
+00016310: 6572 293a 0a20 2020 2020 2020 2020 2020  er):.           
+00016320: 2061 7272 6179 5f76 616c 7565 7320 3d20   array_values = 
+00016330: 6e75 6d2e 7661 6c75 6573 2e61 7374 7970  num.values.astyp
+00016340: 6528 2266 3822 290a 0a20 2020 2020 2020  e("f8")..       
+00016350: 2076 6172 203d 2064 612e 6e61 6e76 6172   var = da.nanvar
+00016360: 2069 6620 736b 6970 6e61 206f 7220 736b   if skipna or sk
+00016370: 6970 6e61 2069 7320 4e6f 6e65 2065 6c73  ipna is None els
+00016380: 6520 6461 2e76 6172 0a20 2020 2020 2020  e da.var.       
+00016390: 2061 7272 6179 5f76 6172 203d 2076 6172   array_var = var
+000163a0: 2861 7272 6179 5f76 616c 7565 732c 2061  (array_values, a
+000163b0: 7869 733d 302c 2064 646f 663d 6464 6f66  xis=0, ddof=ddof
+000163c0: 2c20 7370 6c69 745f 6576 6572 793d 7370  , split_every=sp
+000163d0: 6c69 745f 6576 6572 7929 0a0a 2020 2020  lit_every)..    
+000163e0: 2020 2020 6e61 6d65 203d 2073 656c 662e      name = self.
+000163f0: 5f74 6f6b 656e 5f70 7265 6669 7820 2b20  _token_prefix + 
+00016400: 2276 6172 2d6e 756d 6572 6963 2220 2b20  "var-numeric" + 
+00016410: 746f 6b65 6e69 7a65 286e 756d 2c20 7370  tokenize(num, sp
+00016420: 6c69 745f 6576 6572 7929 0a20 2020 2020  lit_every).     
+00016430: 2020 2063 6f6c 7320 3d20 6e75 6d2e 5f6d     cols = num._m
+00016440: 6574 612e 636f 6c75 6d6e 7320 6966 2069  eta.columns if i
+00016450: 735f 6461 7461 6672 616d 655f 6c69 6b65  s_dataframe_like
+00016460: 286e 756d 2920 656c 7365 204e 6f6e 650a  (num) else None.
+00016470: 0a20 2020 2020 2020 2077 6974 6820 6368  .        with ch
+00016480: 6563 6b5f 7265 6475 6374 696f 6e73 5f72  eck_reductions_r
+00016490: 756e 7469 6d65 5f77 6172 6e69 6e67 2829  untime_warning()
+000164a0: 3a0a 2020 2020 2020 2020 2020 2020 6d65  :.            me
+000164b0: 7461 5f63 6f6d 7075 7461 7469 6f6e 203d  ta_computation =
+000164c0: 206e 756d 2e5f 6d65 7461 5f6e 6f6e 656d   num._meta_nonem
+000164d0: 7074 792e 7661 7228 6178 6973 3d30 290a  pty.var(axis=0).
+000164e0: 2020 2020 2020 2020 7661 725f 7368 6170          var_shap
+000164f0: 6520 3d20 6d65 7461 5f63 6f6d 7075 7461  e = meta_computa
+00016500: 7469 6f6e 2e73 6861 7065 0a20 2020 2020  tion.shape.     
+00016510: 2020 2061 7272 6179 5f76 6172 5f6e 616d     array_var_nam
+00016520: 6520 3d20 2861 7272 6179 5f76 6172 2e5f  e = (array_var._
+00016530: 6e61 6d65 2c29 202b 2028 302c 2920 2a20  name,) + (0,) * 
+00016540: 6c65 6e28 7661 725f 7368 6170 6529 0a0a  len(var_shape)..
+00016550: 2020 2020 2020 2020 6c61 7965 7220 3d20          layer = 
+00016560: 7b28 6e61 6d65 2c20 3029 3a20 286d 6574  {(name, 0): (met
+00016570: 686f 6473 2e77 7261 705f 7661 725f 7265  hods.wrap_var_re
+00016580: 6475 6374 696f 6e2c 2061 7272 6179 5f76  duction, array_v
+00016590: 6172 5f6e 616d 652c 2063 6f6c 7329 7d0a  ar_name, cols)}.
+000165a0: 2020 2020 2020 2020 6772 6170 6820 3d20          graph = 
+000165b0: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
+000165c0: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
+000165d0: 6e61 6d65 2c20 6c61 7965 722c 2064 6570  name, layer, dep
+000165e0: 656e 6465 6e63 6965 733d 5b61 7272 6179  endencies=[array
+000165f0: 5f76 6172 5d29 0a0a 2020 2020 2020 2020  _var])..        
+00016600: 7265 7475 726e 206e 6577 5f64 645f 6f62  return new_dd_ob
+00016610: 6a65 6374 2867 7261 7068 2c20 6e61 6d65  ject(graph, name
+00016620: 2c20 6d65 7461 5f63 6f6d 7075 7461 7469  , meta_computati
+00016630: 6f6e 2c20 6469 7669 7369 6f6e 733d 5b4e  on, divisions=[N
+00016640: 6f6e 652c 204e 6f6e 655d 290a 0a20 2020  one, None])..   
+00016650: 2064 6566 205f 7661 725f 3164 2873 656c   def _var_1d(sel
+00016660: 662c 2063 6f6c 756d 6e2c 2073 6b69 706e  f, column, skipn
+00016670: 613d 5472 7565 2c20 6464 6f66 3d31 2c20  a=True, ddof=1, 
+00016680: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
+00016690: 6529 3a0a 2020 2020 2020 2020 6973 5f74  e):.        is_t
+000166a0: 696d 6564 656c 7461 203d 2069 735f 7469  imedelta = is_ti
+000166b0: 6d65 6465 6c74 6136 345f 6474 7970 6528  medelta64_dtype(
+000166c0: 636f 6c75 6d6e 2e5f 6d65 7461 290a 0a20  column._meta).. 
+000166d0: 2020 2020 2020 2069 6620 6973 5f74 696d         if is_tim
+000166e0: 6564 656c 7461 3a0a 2020 2020 2020 2020  edelta:.        
+000166f0: 2020 2020 6966 206e 6f74 2073 6b69 706e      if not skipn
+00016700: 613a 0a20 2020 2020 2020 2020 2020 2020  a:.             
+00016710: 2020 2069 735f 6e61 6e20 3d20 636f 6c75     is_nan = colu
+00016720: 6d6e 2e69 736e 6128 290a 2020 2020 2020  mn.isna().      
+00016730: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+00016740: 203d 2063 6f6c 756d 6e2e 6173 7479 7065   = column.astype
+00016750: 2822 6938 2229 0a20 2020 2020 2020 2020  ("i8").         
+00016760: 2020 2020 2020 2063 6f6c 756d 6e20 3d20         column = 
+00016770: 636f 6c75 6d6e 2e6d 6173 6b28 6973 5f6e  column.mask(is_n
+00016780: 616e 290a 2020 2020 2020 2020 2020 2020  an).            
+00016790: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000167a0: 2020 2020 2020 636f 6c75 6d6e 203d 2063        column = c
+000167b0: 6f6c 756d 6e2e 6472 6f70 6e61 2829 2e61  olumn.dropna().a
+000167c0: 7374 7970 6528 2269 3822 290a 0a20 2020  stype("i8")..   
+000167d0: 2020 2020 2069 6620 7064 2e61 7069 2e74       if pd.api.t
+000167e0: 7970 6573 2e69 735f 6578 7465 6e73 696f  ypes.is_extensio
+000167f0: 6e5f 6172 7261 795f 6474 7970 6528 636f  n_array_dtype(co
+00016800: 6c75 6d6e 2e5f 6d65 7461 5f6e 6f6e 656d  lumn._meta_nonem
+00016810: 7074 7929 3a0a 2020 2020 2020 2020 2020  pty):.          
+00016820: 2020 2320 446f 6e27 7420 6861 7665 2074    # Don't have t
+00016830: 6f20 776f 7272 7920 6162 6f75 7420 6e6f  o worry about no
+00016840: 6e2d 6e75 6d65 7269 632c 2074 6869 7320  n-numeric, this 
+00016850: 7261 6973 6573 2065 6172 6c69 6572 0a20  raises earlier. 
+00016860: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+00016870: 6e20 3d20 636f 6c75 6d6e 2e61 7374 7970  n = column.astyp
+00016880: 6528 2266 3822 290a 0a20 2020 2020 2020  e("f8")..       
+00016890: 2065 6c69 6620 6e6f 7420 6e70 2e69 7373   elif not np.iss
+000168a0: 7562 6474 7970 6528 636f 6c75 6d6e 2e64  ubdtype(column.d
+000168b0: 7479 7065 2c20 6e70 2e6e 756d 6265 7229  type, np.number)
+000168c0: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
+000168d0: 6c75 6d6e 203d 2063 6f6c 756d 6e2e 6173  lumn = column.as
+000168e0: 7479 7065 2822 6638 2229 0a0a 2020 2020  type("f8")..    
+000168f0: 2020 2020 6e61 6d65 203d 2073 656c 662e      name = self.
+00016900: 5f74 6f6b 656e 5f70 7265 6669 7820 2b20  _token_prefix + 
+00016910: 2276 6172 2d31 642d 2220 2b20 746f 6b65  "var-1d-" + toke
+00016920: 6e69 7a65 2863 6f6c 756d 6e2c 2073 706c  nize(column, spl
+00016930: 6974 5f65 7665 7279 290a 0a20 2020 2020  it_every)..     
+00016940: 2020 2076 6172 203d 2064 612e 6e61 6e76     var = da.nanv
+00016950: 6172 2069 6620 736b 6970 6e61 206f 7220  ar if skipna or 
+00016960: 736b 6970 6e61 2069 7320 4e6f 6e65 2065  skipna is None e
+00016970: 6c73 6520 6461 2e76 6172 0a20 2020 2020  lse da.var.     
+00016980: 2020 2061 7272 6179 5f76 6172 203d 2076     array_var = v
+00016990: 6172 2863 6f6c 756d 6e2e 7661 6c75 6573  ar(column.values
+000169a0: 2c20 6178 6973 3d30 2c20 6464 6f66 3d64  , axis=0, ddof=d
+000169b0: 646f 662c 2073 706c 6974 5f65 7665 7279  dof, split_every
+000169c0: 3d73 706c 6974 5f65 7665 7279 290a 0a20  =split_every).. 
+000169d0: 2020 2020 2020 206c 6179 6572 203d 207b         layer = {
+000169e0: 286e 616d 652c 2030 293a 2028 6d65 7468  (name, 0): (meth
+000169f0: 6f64 732e 7772 6170 5f76 6172 5f72 6564  ods.wrap_var_red
+00016a00: 7563 7469 6f6e 2c20 2861 7272 6179 5f76  uction, (array_v
+00016a10: 6172 2e5f 6e61 6d65 2c29 2c20 4e6f 6e65  ar._name,), None
+00016a20: 297d 0a20 2020 2020 2020 2067 7261 7068  )}.        graph
+00016a30: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+00016a40: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+00016a50: 6e73 286e 616d 652c 206c 6179 6572 2c20  ns(name, layer, 
+00016a60: 6465 7065 6e64 656e 6369 6573 3d5b 6172  dependencies=[ar
+00016a70: 7261 795f 7661 725d 290a 0a20 2020 2020  ray_var])..     
+00016a80: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
+00016a90: 5f6f 626a 6563 7428 0a20 2020 2020 2020  _object(.       
+00016aa0: 2020 2020 2067 7261 7068 2c20 6e61 6d65       graph, name
+00016ab0: 2c20 636f 6c75 6d6e 2e5f 6d65 7461 5f6e  , column._meta_n
+00016ac0: 6f6e 656d 7074 792e 7661 7228 292c 2064  onempty.var(), d
+00016ad0: 6976 6973 696f 6e73 3d5b 4e6f 6e65 2c20  ivisions=[None, 
+00016ae0: 4e6f 6e65 5d0a 2020 2020 2020 2020 290a  None].        ).
+00016af0: 0a20 2020 2040 5f6e 756d 6572 6963 5f64  .    @_numeric_d
+00016b00: 6174 610a 2020 2020 4064 6572 6976 6564  ata.    @derived
+00016b10: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+00016b20: 6d65 290a 2020 2020 6465 6620 7374 6428  me).    def std(
+00016b30: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00016b40: 2020 2020 2020 2061 7869 733d 4e6f 6e65         axis=None
+00016b50: 2c0a 2020 2020 2020 2020 736b 6970 6e61  ,.        skipna
+00016b60: 3d54 7275 652c 0a20 2020 2020 2020 2064  =True,.        d
+00016b70: 646f 663d 312c 0a20 2020 2020 2020 2073  dof=1,.        s
+00016b80: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
+00016b90: 2c0a 2020 2020 2020 2020 6474 7970 653d  ,.        dtype=
+00016ba0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6f75  None,.        ou
+00016bb0: 743d 4e6f 6e65 2c0a 2020 2020 2020 2020  t=None,.        
+00016bc0: 6e75 6d65 7269 635f 6f6e 6c79 3d6e 6f5f  numeric_only=no_
+00016bd0: 6465 6661 756c 742c 0a20 2020 2029 3a0a  default,.    ):.
+00016be0: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
+00016bf0: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+00016c00: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
+00016c10: 205f 7261 6973 655f 6966 5f6f 626a 6563   _raise_if_objec
+00016c20: 745f 7365 7269 6573 2873 656c 662c 2022  t_series(self, "
+00016c30: 7374 6422 290a 2020 2020 2020 2020 5f72  std").        _r
+00016c40: 6169 7365 5f69 665f 6e6f 745f 7365 7269  aise_if_not_seri
+00016c50: 6573 5f6f 725f 6461 7461 6672 616d 6528  es_or_dataframe(
+00016c60: 7365 6c66 2c20 2273 7464 2229 0a20 2020  self, "std").   
+00016c70: 2020 2020 206e 756d 6572 6963 5f6b 7761       numeric_kwa
+00016c80: 7267 7320 3d20 6765 745f 6e75 6d65 7269  rgs = get_numeri
+00016c90: 635f 6f6e 6c79 5f6b 7761 7267 7328 6e75  c_only_kwargs(nu
+00016ca0: 6d65 7269 635f 6f6e 6c79 290a 0a20 2020  meric_only)..   
+00016cb0: 2020 2020 2077 6974 6820 6368 6563 6b5f       with check_
+00016cc0: 6e75 6d65 7269 635f 6f6e 6c79 5f64 6570  numeric_only_dep
+00016cd0: 7265 6361 7469 6f6e 280a 2020 2020 2020  recation(.      
+00016ce0: 2020 2020 2020 2273 7464 222c 2054 7275        "std", Tru
+00016cf0: 650a 2020 2020 2020 2020 292c 2063 6865  e.        ), che
+00016d00: 636b 5f72 6564 7563 7469 6f6e 735f 7275  ck_reductions_ru
+00016d10: 6e74 696d 655f 7761 726e 696e 6728 293a  ntime_warning():
+00016d20: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+00016d30: 6120 3d20 7365 6c66 2e5f 6d65 7461 5f6e  a = self._meta_n
+00016d40: 6f6e 656d 7074 792e 7374 6428 6178 6973  onempty.std(axis
+00016d50: 3d61 7869 732c 2073 6b69 706e 613d 736b  =axis, skipna=sk
+00016d60: 6970 6e61 2c20 2a2a 6e75 6d65 7269 635f  ipna, **numeric_
+00016d70: 6b77 6172 6773 290a 2020 2020 2020 2020  kwargs).        
+00016d80: 6973 5f64 665f 6c69 6b65 203d 2069 735f  is_df_like = is_
+00016d90: 6461 7461 6672 616d 655f 6c69 6b65 2873  dataframe_like(s
+00016da0: 656c 662e 5f6d 6574 6129 0a20 2020 2020  elf._meta).     
+00016db0: 2020 206e 6565 6473 5f74 696d 655f 636f     needs_time_co
+00016dc0: 6e76 6572 7369 6f6e 203d 2046 616c 7365  nversion = False
+00016dd0: 0a20 2020 2020 2020 206e 756d 6572 6963  .        numeric
+00016de0: 5f64 6420 3d20 7365 6c66 0a0a 2020 2020  _dd = self..    
+00016df0: 2020 2020 6966 2069 735f 6466 5f6c 696b      if is_df_lik
+00016e00: 653a 0a20 2020 2020 2020 2020 2020 2074  e:.            t
+00016e10: 696d 655f 636f 6c73 203d 2073 656c 662e  ime_cols = self.
+00016e20: 5f6d 6574 612e 7365 6c65 6374 5f64 7479  _meta.select_dty
+00016e30: 7065 7328 0a20 2020 2020 2020 2020 2020  pes(.           
+00016e40: 2020 2020 2069 6e63 6c75 6465 3d5b 2264       include=["d
+00016e50: 6174 6574 696d 6522 2c20 2274 696d 6564  atetime", "timed
+00016e60: 656c 7461 225d 0a20 2020 2020 2020 2020  elta"].         
+00016e70: 2020 2029 2e63 6f6c 756d 6e73 0a20 2020     ).columns.   
+00016e80: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00016e90: 7469 6d65 5f63 6f6c 7329 203e 2030 3a0a  time_cols) > 0:.
+00016ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016eb0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00016ec0: 2020 2020 2020 6e75 6d65 7269 635f 6464        numeric_dd
+00016ed0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00016ee0: 2020 2020 2020 6e65 6564 735f 7469 6d65        needs_time
+00016ef0: 5f63 6f6e 7665 7273 696f 6e2c 0a20 2020  _conversion,.   
+00016f00: 2020 2020 2020 2020 2020 2020 2029 203d               ) =
+00016f10: 2073 656c 662e 5f63 6f6e 7665 7274 5f74   self._convert_t
+00016f20: 696d 655f 636f 6c73 5f74 6f5f 6e75 6d65  ime_cols_to_nume
+00016f30: 7269 6328 7469 6d65 5f63 6f6c 732c 2061  ric(time_cols, a
+00016f40: 7869 732c 206d 6574 612c 2073 6b69 706e  xis, meta, skipn
+00016f50: 6129 0a20 2020 2020 2020 2065 6c73 653a  a).        else:
+00016f60: 0a20 2020 2020 2020 2020 2020 206e 6565  .            nee
+00016f70: 6473 5f74 696d 655f 636f 6e76 6572 7369  ds_time_conversi
+00016f80: 6f6e 203d 2069 735f 6461 7465 7469 6d65  on = is_datetime
+00016f90: 3634 5f61 6e79 5f64 7479 7065 2873 656c  64_any_dtype(sel
+00016fa0: 662e 5f6d 6574 6129 0a20 2020 2020 2020  f._meta).       
+00016fb0: 2020 2020 2069 6620 6e65 6564 735f 7469       if needs_ti
+00016fc0: 6d65 5f63 6f6e 7665 7273 696f 6e3a 0a20  me_conversion:. 
+00016fd0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00016fe0: 756d 6572 6963 5f64 6420 3d20 5f63 6f6e  umeric_dd = _con
+00016ff0: 7665 7274 5f74 6f5f 6e75 6d65 7269 6328  vert_to_numeric(
+00017000: 7365 6c66 2c20 736b 6970 6e61 290a 0a20  self, skipna).. 
+00017010: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
+00017020: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+00017030: 2072 6573 756c 7420 3d20 6d61 705f 7061   result = map_pa
+00017040: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+00017050: 2020 2020 2020 2020 2020 4d2e 7374 6420            M.std 
+00017060: 6966 206e 6f74 206e 6565 6473 5f74 696d  if not needs_tim
+00017070: 655f 636f 6e76 6572 7369 6f6e 2065 6c73  e_conversion els
+00017080: 6520 5f73 7172 745f 616e 645f 636f 6e76  e _sqrt_and_conv
+00017090: 6572 745f 746f 5f74 696d 6564 656c 7461  ert_to_timedelta
+000170a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000170b0: 2020 6e75 6d65 7269 635f 6464 2c0a 2020    numeric_dd,.  
+000170c0: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+000170d0: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
+000170e0: 2020 2020 2020 2020 2074 6f6b 656e 3d73           token=s
+000170f0: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
+00017100: 7820 2b20 2273 7464 222c 0a20 2020 2020  x + "std",.     
+00017110: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
+00017120: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
+00017130: 2020 2020 2020 736b 6970 6e61 3d73 6b69        skipna=ski
+00017140: 706e 612c 0a20 2020 2020 2020 2020 2020  pna,.           
+00017150: 2020 2020 2064 646f 663d 6464 6f66 2c0a       ddof=ddof,.
+00017160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017170: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+00017180: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00017190: 2020 2020 2020 2020 2a2a 6e75 6d65 7269          **numeri
+000171a0: 635f 6b77 6172 6773 2c0a 2020 2020 2020  c_kwargs,.      
+000171b0: 2020 2020 2020 2020 2020 7061 7265 6e74            parent
+000171c0: 5f6d 6574 613d 7365 6c66 2e5f 6d65 7461  _meta=self._meta
+000171d0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+000171e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000171f0: 726e 2068 616e 646c 655f 6f75 7428 6f75  rn handle_out(ou
+00017200: 742c 2072 6573 756c 7429 0a0a 2020 2020  t, result)..    
+00017210: 2020 2020 2320 4361 7365 2077 6865 7265      # Case where
+00017220: 2061 7869 733d 3020 6f72 2061 7869 733d   axis=0 or axis=
+00017230: 4e6f 6e65 0a20 2020 2020 2020 2076 203d  None.        v =
+00017240: 206e 756d 6572 6963 5f64 642e 7661 7228   numeric_dd.var(
+00017250: 736b 6970 6e61 3d73 6b69 706e 612c 2064  skipna=skipna, d
+00017260: 646f 663d 6464 6f66 2c20 7370 6c69 745f  dof=ddof, split_
+00017270: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
+00017280: 7929 0a20 2020 2020 2020 206e 616d 6520  y).        name 
+00017290: 3d20 7365 6c66 2e5f 746f 6b65 6e5f 7072  = self._token_pr
+000172a0: 6566 6978 202b 2022 7374 6422 0a0a 2020  efix + "std"..  
+000172b0: 2020 2020 2020 6966 206e 6565 6473 5f74        if needs_t
+000172c0: 696d 655f 636f 6e76 6572 7369 6f6e 3a0a  ime_conversion:.
+000172d0: 2020 2020 2020 2020 2020 2020 7371 7274              sqrt
+000172e0: 5f66 756e 635f 6b77 6172 6773 203d 207b  _func_kwargs = {
+000172f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017300: 2022 6973 5f64 665f 6c69 6b65 223a 2069   "is_df_like": i
+00017310: 735f 6466 5f6c 696b 652c 0a20 2020 2020  s_df_like,.     
+00017320: 2020 2020 2020 2020 2020 2022 7469 6d65             "time
+00017330: 5f63 6f6c 7322 3a20 7469 6d65 5f63 6f6c  _cols": time_col
+00017340: 7320 6966 2069 735f 6466 5f6c 696b 6520  s if is_df_like 
+00017350: 656c 7365 204e 6f6e 652c 0a20 2020 2020  else None,.     
+00017360: 2020 2020 2020 2020 2020 2022 6178 6973             "axis
+00017370: 223a 2061 7869 732c 0a20 2020 2020 2020  ": axis,.       
+00017380: 2020 2020 2020 2020 2022 6474 7970 6522           "dtype"
+00017390: 3a20 6765 7461 7474 7228 6d65 7461 2c20  : getattr(meta, 
+000173a0: 2264 7479 7065 222c 204e 6f6e 6529 2c0a  "dtype", None),.
+000173b0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+000173c0: 2020 2020 2020 2020 2020 7371 7274 5f66            sqrt_f
+000173d0: 756e 6320 3d20 5f73 7172 745f 616e 645f  unc = _sqrt_and_
+000173e0: 636f 6e76 6572 745f 746f 5f74 696d 6564  convert_to_timed
+000173f0: 656c 7461 0a20 2020 2020 2020 2065 6c73  elta.        els
+00017400: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00017410: 7172 745f 6675 6e63 5f6b 7761 7267 7320  qrt_func_kwargs 
+00017420: 3d20 7b7d 0a20 2020 2020 2020 2020 2020  = {}.           
+00017430: 2073 7172 745f 6675 6e63 203d 206e 702e   sqrt_func = np.
+00017440: 7371 7274 0a0a 2020 2020 2020 2020 7265  sqrt..        re
+00017450: 7375 6c74 203d 206d 6170 5f70 6172 7469  sult = map_parti
+00017460: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
+00017470: 2020 2073 7172 745f 6675 6e63 2c0a 2020     sqrt_func,.  
+00017480: 2020 2020 2020 2020 2020 762c 0a20 2020            v,.   
+00017490: 2020 2020 2020 2020 206d 6574 613d 6d65           meta=me
+000174a0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+000174b0: 746f 6b65 6e3d 6e61 6d65 2c0a 2020 2020  token=name,.    
+000174c0: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
+000174d0: 6d65 7461 6461 7461 3d46 616c 7365 2c0a  metadata=False,.
+000174e0: 2020 2020 2020 2020 2020 2020 7061 7265              pare
+000174f0: 6e74 5f6d 6574 613d 7365 6c66 2e5f 6d65  nt_meta=self._me
+00017500: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+00017510: 2a2a 7371 7274 5f66 756e 635f 6b77 6172  **sqrt_func_kwar
+00017520: 6773 2c0a 2020 2020 2020 2020 290a 0a20  gs,.        ).. 
+00017530: 2020 2020 2020 2023 2054 7279 2074 6f20         # Try to 
+00017540: 6d61 7463 6820 7468 6520 5061 6e64 6173  match the Pandas
+00017550: 2072 6573 756c 7420 6474 7970 650a 2020   result dtype.  
+00017560: 2020 2020 2020 6966 2069 735f 6466 5f6c        if is_df_l
+00017570: 696b 6520 616e 6420 6861 7361 7474 7228  ike and hasattr(
+00017580: 6d65 7461 2c20 2264 7479 7065 2229 3a0a  meta, "dtype"):.
+00017590: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+000175a0: 6c74 203d 2072 6573 756c 742e 6173 7479  lt = result.asty
+000175b0: 7065 286d 6574 612e 6474 7970 6529 0a0a  pe(meta.dtype)..
+000175c0: 2020 2020 2020 2020 7265 7475 726e 2068          return h
+000175d0: 616e 646c 655f 6f75 7428 6f75 742c 2072  andle_out(out, r
+000175e0: 6573 756c 7429 0a0a 2020 2020 6465 6620  esult)..    def 
+000175f0: 5f63 6f6e 7665 7274 5f74 696d 655f 636f  _convert_time_co
+00017600: 6c73 5f74 6f5f 6e75 6d65 7269 6328 7365  ls_to_numeric(se
+00017610: 6c66 2c20 7469 6d65 5f63 6f6c 732c 2061  lf, time_cols, a
+00017620: 7869 732c 206d 6574 612c 2073 6b69 706e  xis, meta, skipn
+00017630: 6129 3a0a 2020 2020 2020 2020 6672 6f6d  a):.        from
+00017640: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
+00017650: 696f 2069 6d70 6f72 7420 6672 6f6d 5f70  io import from_p
+00017660: 616e 6461 730a 0a20 2020 2020 2020 206e  andas..        n
+00017670: 6565 6473 5f74 696d 655f 636f 6e76 6572  eeds_time_conver
+00017680: 7369 6f6e 203d 2054 7275 650a 0a20 2020  sion = True..   
+00017690: 2020 2020 2023 2045 6e73 7572 6520 616c       # Ensure al
+000176a0: 6c20 636f 6c75 6d6e 7320 6172 6520 636f  l columns are co
+000176b0: 7272 6563 7420 7479 7065 2e20 4e65 6564  rrect type. Need
+000176c0: 2074 6f20 7368 616c 6c6f 7720 636f 7079   to shallow copy
+000176d0: 2073 696e 6365 2063 6f6c 7320 7769 6c6c   since cols will
+000176e0: 2062 6520 6d6f 6469 6669 6564 0a20 2020   be modified.   
+000176f0: 2020 2020 2069 6620 6178 6973 203d 3d20       if axis == 
+00017700: 303a 0a20 2020 2020 2020 2020 2020 206e  0:.            n
+00017710: 756d 6572 6963 5f64 6420 3d20 7365 6c66  umeric_dd = self
+00017720: 5b6d 6574 612e 696e 6465 785d 2e63 6f70  [meta.index].cop
+00017730: 7928 290a 2020 2020 2020 2020 656c 7365  y().        else
+00017740: 3a0a 2020 2020 2020 2020 2020 2020 6e75  :.            nu
+00017750: 6d65 7269 635f 6464 203d 2073 656c 662e  meric_dd = self.
+00017760: 636f 7079 2829 0a0a 2020 2020 2020 2020  copy()..        
+00017770: 2320 4d69 7820 6f66 2064 6174 6574 696d  # Mix of datetim
+00017780: 6573 2077 6974 6820 6f74 6865 7220 6e75  es with other nu
+00017790: 6d65 7269 6320 7479 7065 7320 7072 6f64  meric types prod
+000177a0: 7563 6573 204e 614e 7320 666f 7220 6561  uces NaNs for ea
+000177b0: 6368 2076 616c 7565 2069 6e20 7374 6428  ch value in std(
+000177c0: 2920 7365 7269 6573 0a20 2020 2020 2020  ) series.       
+000177d0: 2069 6620 6178 6973 203d 3d20 3120 616e   if axis == 1 an
+000177e0: 6420 6c65 6e28 7469 6d65 5f63 6f6c 7329  d len(time_cols)
+000177f0: 2021 3d20 6c65 6e28 7365 6c66 2e63 6f6c   != len(self.col
+00017800: 756d 6e73 293a 0a20 2020 2020 2020 2020  umns):.         
+00017810: 2020 2023 2054 6869 7320 6973 2066 6173     # This is fas
+00017820: 7465 7220 7468 616e 2063 6f6e 7665 7274  ter than convert
+00017830: 696e 6720 6561 6368 2063 6f6c 756d 6e20  ing each column 
+00017840: 746f 206e 756d 6572 6963 2077 6865 6e20  to numeric when 
+00017850: 6974 2773 206e 6f74 206e 6563 6573 7361  it's not necessa
+00017860: 7279 0a20 2020 2020 2020 2020 2020 2023  ry.            #
+00017870: 2073 696e 6365 2065 6163 6820 7374 616e   since each stan
+00017880: 6461 7264 2064 6576 6961 7469 6f6e 2077  dard deviation w
+00017890: 696c 6c20 6a75 7374 2062 6520 4e61 4e0a  ill just be NaN.
+000178a0: 2020 2020 2020 2020 2020 2020 6e65 6564              need
+000178b0: 735f 7469 6d65 5f63 6f6e 7665 7273 696f  s_time_conversio
+000178c0: 6e20 3d20 4661 6c73 650a 2020 2020 2020  n = False.      
+000178d0: 2020 2020 2020 6e75 6d65 7269 635f 6464        numeric_dd
+000178e0: 203d 2066 726f 6d5f 7061 6e64 6173 280a   = from_pandas(.
+000178f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017900: 6d65 7461 5f66 7261 6d65 5f63 6f6e 7374  meta_frame_const
+00017910: 7275 6374 6f72 2873 656c 6629 280a 2020  ructor(self)(.  
+00017920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017930: 2020 7b22 5f22 3a20 6d65 7461 5f73 6572    {"_": meta_ser
+00017940: 6965 735f 636f 6e73 7472 7563 746f 7228  ies_constructor(
+00017950: 7365 6c66 2928 5b6e 702e 6e61 6e5d 297d  self)([np.nan])}
+00017960: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00017970: 2020 2020 2020 696e 6465 783d 7365 6c66        index=self
+00017980: 2e69 6e64 6578 2c0a 2020 2020 2020 2020  .index,.        
+00017990: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
+000179a0: 2020 2020 2020 2020 2020 206e 7061 7274             npart
+000179b0: 6974 696f 6e73 3d73 656c 662e 6e70 6172  itions=self.npar
+000179c0: 7469 7469 6f6e 732c 0a20 2020 2020 2020  titions,.       
+000179d0: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+000179e0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000179f0: 2023 2043 6f6e 7665 7274 2074 696d 6564   # Convert timed
+00017a00: 656c 7461 2061 6e64 2064 6174 6574 696d  elta and datetim
+00017a10: 6520 636f 6c75 6d6e 7320 746f 2069 6e74  e columns to int
+00017a20: 6567 6572 2074 7970 6573 2073 6f20 7765  eger types so we
+00017a30: 2063 616e 2075 7365 2076 6172 0a20 2020   can use var.   
+00017a40: 2020 2020 2020 2020 2066 6f72 2063 6f6c           for col
+00017a50: 2069 6e20 7469 6d65 5f63 6f6c 733a 0a20   in time_cols:. 
+00017a60: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00017a70: 756d 6572 6963 5f64 645b 636f 6c5d 203d  umeric_dd[col] =
+00017a80: 205f 636f 6e76 6572 745f 746f 5f6e 756d   _convert_to_num
+00017a90: 6572 6963 286e 756d 6572 6963 5f64 645b  eric(numeric_dd[
+00017aa0: 636f 6c5d 2c20 736b 6970 6e61 290a 0a20  col], skipna).. 
+00017ab0: 2020 2020 2020 2072 6574 7572 6e20 6e75         return nu
+00017ac0: 6d65 7269 635f 6464 2c20 6e65 6564 735f  meric_dd, needs_
+00017ad0: 7469 6d65 5f63 6f6e 7665 7273 696f 6e0a  time_conversion.
+00017ae0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+00017af0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
+00017b00: 0a20 2020 2064 6566 2073 6b65 7728 0a20  .    def skew(. 
+00017b10: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00017b20: 2020 2020 2061 7869 733d 302c 0a20 2020       axis=0,.   
+00017b30: 2020 2020 2062 6961 733d 5472 7565 2c0a       bias=True,.
+00017b40: 2020 2020 2020 2020 6e61 6e5f 706f 6c69          nan_poli
+00017b50: 6379 3d22 7072 6f70 6167 6174 6522 2c0a  cy="propagate",.
+00017b60: 2020 2020 2020 2020 6f75 743d 4e6f 6e65          out=None
+00017b70: 2c0a 2020 2020 2020 2020 6e75 6d65 7269  ,.        numeri
+00017b80: 635f 6f6e 6c79 3d6e 6f5f 6465 6661 756c  c_only=no_defaul
+00017b90: 742c 0a20 2020 2029 3a0a 2020 2020 2020  t,.    ):.      
+00017ba0: 2020 2222 220a 2020 2020 2020 2020 2e2e    """.        ..
+00017bb0: 206e 6f74 653a 3a0a 0a20 2020 2020 2020   note::..       
+00017bc0: 2020 2020 5468 6973 2069 6d70 6c65 6d65      This impleme
+00017bd0: 6e74 6174 696f 6e20 666f 6c6c 6f77 7320  ntation follows 
+00017be0: 7468 6520 6461 736b 2e61 7272 6179 2e73  the dask.array.s
+00017bf0: 7461 7473 2069 6d70 6c65 6d65 6e74 6174  tats implementat
+00017c00: 696f 6e0a 2020 2020 2020 2020 2020 206f  ion.           o
+00017c10: 6620 736b 6577 6e65 7373 2061 6e64 2063  f skewness and c
+00017c20: 616c 6375 6c61 7465 7320 736b 6577 6e65  alculates skewne
+00017c30: 7373 2077 6974 686f 7574 2074 616b 696e  ss without takin
+00017c40: 6720 696e 746f 2061 6363 6f75 6e74 0a20  g into account. 
+00017c50: 2020 2020 2020 2020 2020 6120 6269 6173            a bias
+00017c60: 2074 6572 6d20 666f 7220 6669 6e69 7465   term for finite
+00017c70: 2073 616d 706c 6520 7369 7a65 2c20 7768   sample size, wh
+00017c80: 6963 6820 636f 7272 6573 706f 6e64 7320  ich corresponds 
+00017c90: 746f 2074 6865 0a20 2020 2020 2020 2020  to the.         
+00017ca0: 2020 6465 6661 756c 7420 7365 7474 696e    default settin
+00017cb0: 6773 206f 6620 7468 6520 7363 6970 792e  gs of the scipy.
+00017cc0: 7374 6174 7320 736b 6577 6e65 7373 2063  stats skewness c
+00017cd0: 616c 6375 6c61 7469 6f6e 2e20 486f 7765  alculation. Howe
+00017ce0: 7665 722c 0a20 2020 2020 2020 2020 2020  ver,.           
+00017cf0: 5061 6e64 6173 2063 6f72 7265 6374 7320  Pandas corrects 
+00017d00: 666f 7220 7468 6973 2c20 736f 2074 6865  for this, so the
+00017d10: 2076 616c 7565 7320 6469 6666 6572 2062   values differ b
+00017d20: 7920 6120 6661 6374 6f72 206f 660a 2020  y a factor of.  
+00017d30: 2020 2020 2020 2020 2028 6e20 2a20 286e           (n * (n
+00017d40: 202d 2031 2929 202a 2a20 302e 3520 2f20   - 1)) ** 0.5 / 
+00017d50: 286e 202d 2032 292c 2077 6865 7265 206e  (n - 2), where n
+00017d60: 2069 7320 7468 6520 6e75 6d62 6572 206f   is the number o
+00017d70: 6620 7361 6d70 6c65 732e 0a0a 2020 2020  f samples...    
+00017d80: 2020 2020 2020 2046 7572 7468 6572 2c20         Further, 
+00017d90: 7468 6973 206d 6574 686f 6420 6375 7272  this method curr
+00017da0: 656e 746c 7920 646f 6573 206e 6f74 2073  ently does not s
+00017db0: 7570 706f 7274 2066 696c 7465 7269 6e67  upport filtering
+00017dc0: 206f 7574 204e 614e 0a20 2020 2020 2020   out NaN.       
+00017dd0: 2020 2020 7661 6c75 6573 2c20 7768 6963      values, whic
+00017de0: 6820 6973 2061 6761 696e 2061 2064 6966  h is again a dif
+00017df0: 6665 7265 6e63 6520 746f 2050 616e 6461  ference to Panda
+00017e00: 732e 0a20 2020 2020 2020 2022 2222 0a20  s..        """. 
+00017e10: 2020 2020 2020 2069 6620 5041 4e44 4153         if PANDAS
+00017e20: 5f47 545f 3230 3020 616e 6420 6178 6973  _GT_200 and axis
+00017e30: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00017e40: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00017e50: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00017e60: 2020 2020 2020 2020 2260 6178 6973 3d4e          "`axis=N
+00017e70: 6f6e 6560 2069 736e 2774 2063 7572 7265  one` isn't curre
+00017e80: 6e74 6c79 2073 7570 706f 7274 6564 2066  ntly supported f
+00017e90: 6f72 2060 736b 6577 6020 7768 656e 2075  or `skew` when u
+00017ea0: 7369 6e67 2060 7061 6e64 6173 203e 3d32  sing `pandas >=2
+00017eb0: 6020 220a 2020 2020 2020 2020 2020 2020  ` ".            
+00017ec0: 2020 2020 6622 2870 616e 6461 733d 7b73      f"(pandas={s
+00017ed0: 7472 2850 414e 4441 535f 5645 5253 494f  tr(PANDAS_VERSIO
+00017ee0: 4e29 7d20 6973 2069 6e73 7461 6c6c 6564  N)} is installed
+00017ef0: 292e 220a 2020 2020 2020 2020 2020 2020  ).".            
+00017f00: 290a 2020 2020 2020 2020 6178 6973 203d  ).        axis =
+00017f10: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
+00017f20: 6178 6973 2861 7869 7329 0a20 2020 2020  axis(axis).     
+00017f30: 2020 205f 7261 6973 655f 6966 5f6f 626a     _raise_if_obj
+00017f40: 6563 745f 7365 7269 6573 2873 656c 662c  ect_series(self,
+00017f50: 2022 736b 6577 2229 0a20 2020 2020 2020   "skew").       
+00017f60: 206e 756d 6572 6963 5f6f 6e6c 795f 6b77   numeric_only_kw
+00017f70: 6172 6773 203d 2067 6574 5f6e 756d 6572  args = get_numer
+00017f80: 6963 5f6f 6e6c 795f 6b77 6172 6773 286e  ic_only_kwargs(n
+00017f90: 756d 6572 6963 5f6f 6e6c 7929 0a0a 2020  umeric_only)..  
+00017fa0: 2020 2020 2020 6966 2069 735f 6461 7461        if is_data
+00017fb0: 6672 616d 655f 6c69 6b65 2873 656c 6629  frame_like(self)
+00017fc0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00017fd0: 4c65 7420 7061 6e64 6173 2072 6169 7365  Let pandas raise
+00017fe0: 2065 7272 6f72 7320 6966 206e 6563 6573   errors if neces
+00017ff0: 7361 7279 0a20 2020 2020 2020 2020 2020  sary.           
+00018000: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
+00018010: 7461 5f6e 6f6e 656d 7074 792e 736b 6577  ta_nonempty.skew
+00018020: 2861 7869 733d 6178 6973 2c20 2a2a 6e75  (axis=axis, **nu
+00018030: 6d65 7269 635f 6f6e 6c79 5f6b 7761 7267  meric_only_kwarg
+00018040: 7329 0a20 2020 2020 2020 2065 6c73 653a  s).        else:
+00018050: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+00018060: 6120 3d20 7365 6c66 2e5f 6d65 7461 5f6e  a = self._meta_n
+00018070: 6f6e 656d 7074 792e 736b 6577 2829 0a0a  onempty.skew()..
+00018080: 2020 2020 2020 2020 6966 2061 7869 7320          if axis 
+00018090: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+000180a0: 2020 7265 7375 6c74 203d 206d 6170 5f70    result = map_p
+000180b0: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+000180c0: 2020 2020 2020 2020 2020 204d 2e73 6b65             M.ske
+000180d0: 772c 0a20 2020 2020 2020 2020 2020 2020  w,.             
+000180e0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000180f0: 2020 2020 2020 2020 206d 6574 613d 6d65           meta=me
+00018100: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+00018110: 2020 2020 746f 6b65 6e3d 7365 6c66 2e5f      token=self._
+00018120: 746f 6b65 6e5f 7072 6566 6978 202b 2022  token_prefix + "
+00018130: 736b 6577 222c 0a20 2020 2020 2020 2020  skew",.         
+00018140: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
+00018150: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00018160: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
+00018170: 7461 3d46 616c 7365 2c0a 2020 2020 2020  ta=False,.      
+00018180: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00018190: 2020 2020 7265 7475 726e 2068 616e 646c      return handl
+000181a0: 655f 6f75 7428 6f75 742c 2072 6573 756c  e_out(out, resul
+000181b0: 7429 0a20 2020 2020 2020 2065 6c73 653a  t).        else:
+000181c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000181d0: 7365 6c66 2e6e 6469 6d20 3d3d 2031 3a0a  self.ndim == 1:.
+000181e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000181f0: 7265 7375 6c74 203d 2073 656c 662e 5f73  result = self._s
+00018200: 6b65 775f 3164 2873 656c 662c 2062 6961  kew_1d(self, bia
+00018210: 733d 6269 6173 2c20 6e61 6e5f 706f 6c69  s=bias, nan_poli
+00018220: 6379 3d6e 616e 5f70 6f6c 6963 7929 0a20  cy=nan_policy). 
+00018230: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00018240: 6574 7572 6e20 6861 6e64 6c65 5f6f 7574  eturn handle_out
+00018250: 286f 7574 2c20 7265 7375 6c74 290a 2020  (out, result).  
+00018260: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00018270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018280: 7265 7375 6c74 203d 2073 656c 662e 5f73  result = self._s
+00018290: 6b65 775f 6e75 6d65 7269 6328 6269 6173  kew_numeric(bias
+000182a0: 3d62 6961 732c 206e 616e 5f70 6f6c 6963  =bias, nan_polic
+000182b0: 793d 6e61 6e5f 706f 6c69 6379 290a 0a20  y=nan_policy).. 
+000182c0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+000182d0: 696e 7374 616e 6365 2873 656c 662c 2044  instance(self, D
+000182e0: 6174 6146 7261 6d65 293a 0a20 2020 2020  ataFrame):.     
+000182f0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+00018300: 742e 6469 7669 7369 6f6e 7320 3d20 2873  t.divisions = (s
+00018310: 656c 662e 636f 6c75 6d6e 732e 6d69 6e28  elf.columns.min(
+00018320: 292c 2073 656c 662e 636f 6c75 6d6e 732e  ), self.columns.
+00018330: 6d61 7828 2929 0a0a 2020 2020 2020 2020  max())..        
+00018340: 2020 2020 7265 7475 726e 2068 616e 646c      return handl
+00018350: 655f 6f75 7428 6f75 742c 2072 6573 756c  e_out(out, resul
+00018360: 7429 0a0a 2020 2020 6465 6620 5f73 6b65  t)..    def _ske
+00018370: 775f 3164 2873 656c 662c 2063 6f6c 756d  w_1d(self, colum
+00018380: 6e2c 2062 6961 733d 5472 7565 2c20 6e61  n, bias=True, na
+00018390: 6e5f 706f 6c69 6379 3d22 7072 6f70 6167  n_policy="propag
+000183a0: 6174 6522 293a 0a20 2020 2020 2020 2022  ate"):.        "
+000183b0: 2222 3144 2076 6572 7369 6f6e 206f 6620  ""1D version of 
+000183c0: 7468 6520 736b 6577 2063 616c 6375 6c61  the skew calcula
+000183d0: 7469 6f6e 2e0a 0a20 2020 2020 2020 2055  tion...        U
+000183e0: 7365 7320 7468 6520 6172 7261 7920 7665  ses the array ve
+000183f0: 7273 696f 6e20 6672 6f6d 2064 612e 7374  rsion from da.st
+00018400: 6174 7320 696e 2063 6173 6520 7765 2061  ats in case we a
+00018410: 7265 2070 6173 7369 6e67 2069 6e20 6120  re passing in a 
+00018420: 7369 6e67 6c65 2073 6572 6965 730a 2020  single series.  
+00018430: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00018440: 2020 2320 696d 706f 7274 2064 6570 656e    # import depen
+00018450: 6473 206f 6e20 7363 6970 792c 206e 6f74  ds on scipy, not
+00018460: 2069 6e73 7461 6c6c 6564 2062 7920 6465   installed by de
+00018470: 6661 756c 740a 2020 2020 2020 2020 6672  fault.        fr
+00018480: 6f6d 2064 6173 6b2e 6172 7261 7920 696d  om dask.array im
+00018490: 706f 7274 2073 7461 7473 2061 7320 6461  port stats as da
+000184a0: 5f73 7461 7473 0a0a 2020 2020 2020 2020  _stats..        
+000184b0: 6966 2070 642e 6170 692e 7479 7065 732e  if pd.api.types.
+000184c0: 6973 5f65 7874 656e 7369 6f6e 5f61 7272  is_extension_arr
+000184d0: 6179 5f64 7479 7065 2863 6f6c 756d 6e2e  ay_dtype(column.
+000184e0: 5f6d 6574 615f 6e6f 6e65 6d70 7479 293a  _meta_nonempty):
+000184f0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00018500: 756d 6e20 3d20 636f 6c75 6d6e 2e61 7374  umn = column.ast
+00018510: 7970 6528 2266 3822 290a 0a20 2020 2020  ype("f8")..     
+00018520: 2020 2065 6c69 6620 6e6f 7420 6e70 2e69     elif not np.i
+00018530: 7373 7562 6474 7970 6528 636f 6c75 6d6e  ssubdtype(column
+00018540: 2e64 7479 7065 2c20 6e70 2e6e 756d 6265  .dtype, np.numbe
+00018550: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+00018560: 636f 6c75 6d6e 203d 2063 6f6c 756d 6e2e  column = column.
+00018570: 6173 7479 7065 2822 6638 2229 0a0a 2020  astype("f8")..  
+00018580: 2020 2020 2020 6e61 6d65 203d 2073 656c        name = sel
+00018590: 662e 5f74 6f6b 656e 5f70 7265 6669 7820  f._token_prefix 
+000185a0: 2b20 2273 6b65 772d 3164 2d22 202b 2074  + "skew-1d-" + t
+000185b0: 6f6b 656e 697a 6528 636f 6c75 6d6e 290a  okenize(column).
+000185c0: 0a20 2020 2020 2020 2061 7272 6179 5f73  .        array_s
+000185d0: 6b65 7720 3d20 6461 5f73 7461 7473 2e73  kew = da_stats.s
+000185e0: 6b65 7728 0a20 2020 2020 2020 2020 2020  kew(.           
+000185f0: 2063 6f6c 756d 6e2e 7661 6c75 6573 2c20   column.values, 
+00018600: 6178 6973 3d30 2c20 6269 6173 3d62 6961  axis=0, bias=bia
+00018610: 732c 206e 616e 5f70 6f6c 6963 793d 6e61  s, nan_policy=na
+00018620: 6e5f 706f 6c69 6379 0a20 2020 2020 2020  n_policy.       
+00018630: 2029 0a0a 2020 2020 2020 2020 6c61 7965   )..        laye
+00018640: 7220 3d20 7b28 6e61 6d65 2c20 3029 3a20  r = {(name, 0): 
+00018650: 286d 6574 686f 6473 2e77 7261 705f 736b  (methods.wrap_sk
+00018660: 6577 5f72 6564 7563 7469 6f6e 2c20 2861  ew_reduction, (a
+00018670: 7272 6179 5f73 6b65 772e 5f6e 616d 652c  rray_skew._name,
+00018680: 292c 204e 6f6e 6529 7d0a 2020 2020 2020  ), None)}.      
+00018690: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
+000186a0: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
+000186b0: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
+000186c0: 6c61 7965 722c 2064 6570 656e 6465 6e63  layer, dependenc
+000186d0: 6965 733d 5b61 7272 6179 5f73 6b65 775d  ies=[array_skew]
+000186e0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+000186f0: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
+00018700: 0a20 2020 2020 2020 2020 2020 2067 7261  .            gra
+00018710: 7068 2c20 6e61 6d65 2c20 636f 6c75 6d6e  ph, name, column
+00018720: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
+00018730: 736b 6577 2829 2c20 6469 7669 7369 6f6e  skew(), division
+00018740: 733d 5b4e 6f6e 652c 204e 6f6e 655d 0a20  s=[None, None]. 
+00018750: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00018760: 6620 5f73 6b65 775f 6e75 6d65 7269 6328  f _skew_numeric(
+00018770: 7365 6c66 2c20 6269 6173 3d54 7275 652c  self, bias=True,
+00018780: 206e 616e 5f70 6f6c 6963 793d 2270 726f   nan_policy="pro
+00018790: 7061 6761 7465 2229 3a0a 2020 2020 2020  pagate"):.      
+000187a0: 2020 2222 224d 6574 686f 6420 666f 7220    """Method for 
+000187b0: 6461 7461 6672 616d 6573 2077 6974 6820  dataframes with 
+000187c0: 6e75 6d65 7269 6320 636f 6c75 6d6e 732e  numeric columns.
+000187d0: 0a0a 2020 2020 2020 2020 4d61 7073 2074  ..        Maps t
+000187e0: 6865 2061 7272 6179 2076 6572 7369 6f6e  he array version
+000187f0: 2066 726f 6d20 6461 2e73 7461 7473 206f   from da.stats o
+00018800: 6e74 6f20 7468 6520 6e75 6d65 7269 6320  nto the numeric 
+00018810: 6172 7261 7920 6f66 2063 6f6c 756d 6e73  array of columns
+00018820: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00018830: 2020 2020 2020 2320 696d 706f 7274 2064        # import d
+00018840: 6570 656e 6473 206f 6e20 7363 6970 792c  epends on scipy,
+00018850: 206e 6f74 2069 6e73 7461 6c6c 6564 2062   not installed b
+00018860: 7920 6465 6661 756c 740a 2020 2020 2020  y default.      
+00018870: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
+00018880: 7920 696d 706f 7274 2073 7461 7473 2061  y import stats a
+00018890: 7320 6461 5f73 7461 7473 0a0a 2020 2020  s da_stats..    
+000188a0: 2020 2020 6e75 6d20 3d20 7365 6c66 2e73      num = self.s
+000188b0: 656c 6563 745f 6474 7970 6573 2869 6e63  elect_dtypes(inc
+000188c0: 6c75 6465 3d5b 226e 756d 6265 7222 2c20  lude=["number", 
+000188d0: 2262 6f6f 6c22 5d2c 2065 7863 6c75 6465  "bool"], exclude
+000188e0: 3d5b 6e70 2e74 696d 6564 656c 7461 3634  =[np.timedelta64
+000188f0: 5d29 0a0a 2020 2020 2020 2020 7661 6c75  ])..        valu
+00018900: 6573 5f64 7479 7065 203d 206e 756d 2e76  es_dtype = num.v
+00018910: 616c 7565 732e 6474 7970 650a 2020 2020  alues.dtype.    
+00018920: 2020 2020 6172 7261 795f 7661 6c75 6573      array_values
+00018930: 203d 206e 756d 2e76 616c 7565 730a 0a20   = num.values.. 
+00018940: 2020 2020 2020 2069 6620 6e6f 7420 6e70         if not np
+00018950: 2e69 7373 7562 6474 7970 6528 7661 6c75  .issubdtype(valu
+00018960: 6573 5f64 7479 7065 2c20 6e70 2e6e 756d  es_dtype, np.num
+00018970: 6265 7229 3a0a 2020 2020 2020 2020 2020  ber):.          
+00018980: 2020 6172 7261 795f 7661 6c75 6573 203d    array_values =
+00018990: 206e 756d 2e76 616c 7565 732e 6173 7479   num.values.asty
+000189a0: 7065 2822 6638 2229 0a0a 2020 2020 2020  pe("f8")..      
+000189b0: 2020 6172 7261 795f 736b 6577 203d 2064    array_skew = d
+000189c0: 615f 7374 6174 732e 736b 6577 280a 2020  a_stats.skew(.  
+000189d0: 2020 2020 2020 2020 2020 6172 7261 795f            array_
+000189e0: 7661 6c75 6573 2c20 6178 6973 3d30 2c20  values, axis=0, 
+000189f0: 6269 6173 3d62 6961 732c 206e 616e 5f70  bias=bias, nan_p
+00018a00: 6f6c 6963 793d 6e61 6e5f 706f 6c69 6379  olicy=nan_policy
+00018a10: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00018a20: 2020 2020 6e61 6d65 203d 2073 656c 662e      name = self.
+00018a30: 5f74 6f6b 656e 5f70 7265 6669 7820 2b20  _token_prefix + 
+00018a40: 2276 6172 2d6e 756d 6572 6963 2220 2b20  "var-numeric" + 
+00018a50: 746f 6b65 6e69 7a65 286e 756d 290a 2020  tokenize(num).  
+00018a60: 2020 2020 2020 636f 6c73 203d 206e 756d        cols = num
+00018a70: 2e5f 6d65 7461 2e63 6f6c 756d 6e73 2069  ._meta.columns i
+00018a80: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
+00018a90: 696b 6528 6e75 6d29 2065 6c73 6520 4e6f  ike(num) else No
+00018aa0: 6e65 0a0a 2020 2020 2020 2020 7769 7468  ne..        with
+00018ab0: 2063 6865 636b 5f72 6564 7563 7469 6f6e   check_reduction
+00018ac0: 735f 7275 6e74 696d 655f 7761 726e 696e  s_runtime_warnin
+00018ad0: 6728 293a 0a20 2020 2020 2020 2020 2020  g():.           
+00018ae0: 2073 6b65 775f 7368 6170 6520 3d20 6e75   skew_shape = nu
+00018af0: 6d2e 5f6d 6574 615f 6e6f 6e65 6d70 7479  m._meta_nonempty
+00018b00: 2e76 6172 2861 7869 733d 3029 2e73 6861  .var(axis=0).sha
+00018b10: 7065 0a20 2020 2020 2020 2061 7272 6179  pe.        array
+00018b20: 5f73 6b65 775f 6e61 6d65 203d 2028 6172  _skew_name = (ar
+00018b30: 7261 795f 736b 6577 2e5f 6e61 6d65 2c29  ray_skew._name,)
+00018b40: 202b 2028 302c 2920 2a20 6c65 6e28 736b   + (0,) * len(sk
+00018b50: 6577 5f73 6861 7065 290a 0a20 2020 2020  ew_shape)..     
+00018b60: 2020 206c 6179 6572 203d 207b 286e 616d     layer = {(nam
+00018b70: 652c 2030 293a 2028 6d65 7468 6f64 732e  e, 0): (methods.
+00018b80: 7772 6170 5f73 6b65 775f 7265 6475 6374  wrap_skew_reduct
+00018b90: 696f 6e2c 2061 7272 6179 5f73 6b65 775f  ion, array_skew_
+00018ba0: 6e61 6d65 2c20 636f 6c73 297d 0a20 2020  name, cols)}.   
+00018bb0: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
+00018bc0: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+00018bd0: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
+00018be0: 652c 206c 6179 6572 2c20 6465 7065 6e64  e, layer, depend
+00018bf0: 656e 6369 6573 3d5b 6172 7261 795f 736b  encies=[array_sk
+00018c00: 6577 5d29 0a0a 2020 2020 2020 2020 7265  ew])..        re
+00018c10: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
+00018c20: 6374 280a 2020 2020 2020 2020 2020 2020  ct(.            
+00018c30: 6772 6170 682c 206e 616d 652c 206e 756d  graph, name, num
+00018c40: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
+00018c50: 736b 6577 2829 2c20 6469 7669 7369 6f6e  skew(), division
+00018c60: 733d 5b4e 6f6e 652c 204e 6f6e 655d 0a20  s=[None, None]. 
+00018c70: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
+00018c80: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+00018c90: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+00018ca0: 6620 6b75 7274 6f73 6973 280a 2020 2020  f kurtosis(.    
+00018cb0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00018cc0: 2020 6178 6973 3d30 2c0a 2020 2020 2020    axis=0,.      
+00018cd0: 2020 6669 7368 6572 3d54 7275 652c 0a20    fisher=True,. 
+00018ce0: 2020 2020 2020 2062 6961 733d 5472 7565         bias=True
+00018cf0: 2c0a 2020 2020 2020 2020 6e61 6e5f 706f  ,.        nan_po
+00018d00: 6c69 6379 3d22 7072 6f70 6167 6174 6522  licy="propagate"
+00018d10: 2c0a 2020 2020 2020 2020 6f75 743d 4e6f  ,.        out=No
+00018d20: 6e65 2c0a 2020 2020 2020 2020 6e75 6d65  ne,.        nume
+00018d30: 7269 635f 6f6e 6c79 3d6e 6f5f 6465 6661  ric_only=no_defa
+00018d40: 756c 742c 0a20 2020 2029 3a0a 2020 2020  ult,.    ):.    
+00018d50: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00018d60: 2e2e 206e 6f74 653a 3a0a 0a20 2020 2020  .. note::..     
+00018d70: 2020 2020 2020 5468 6973 2069 6d70 6c65        This imple
+00018d80: 6d65 6e74 6174 696f 6e20 666f 6c6c 6f77  mentation follow
+00018d90: 7320 7468 6520 6461 736b 2e61 7272 6179  s the dask.array
+00018da0: 2e73 7461 7473 2069 6d70 6c65 6d65 6e74  .stats implement
+00018db0: 6174 696f 6e0a 2020 2020 2020 2020 2020  ation.          
+00018dc0: 206f 6620 6b75 7274 6f73 6973 2061 6e64   of kurtosis and
+00018dd0: 2063 616c 6375 6c61 7465 7320 6b75 7274   calculates kurt
+00018de0: 6f73 6973 2077 6974 686f 7574 2074 616b  osis without tak
+00018df0: 696e 6720 696e 746f 2061 6363 6f75 6e74  ing into account
+00018e00: 0a20 2020 2020 2020 2020 2020 6120 6269  .           a bi
+00018e10: 6173 2074 6572 6d20 666f 7220 6669 6e69  as term for fini
+00018e20: 7465 2073 616d 706c 6520 7369 7a65 2c20  te sample size, 
+00018e30: 7768 6963 6820 636f 7272 6573 706f 6e64  which correspond
+00018e40: 7320 746f 2074 6865 0a20 2020 2020 2020  s to the.       
+00018e50: 2020 2020 6465 6661 756c 7420 7365 7474      default sett
+00018e60: 696e 6773 206f 6620 7468 6520 7363 6970  ings of the scip
+00018e70: 792e 7374 6174 7320 6b75 7274 6f73 6973  y.stats kurtosis
+00018e80: 2063 616c 6375 6c61 7469 6f6e 2e20 5468   calculation. Th
+00018e90: 6973 2064 6966 6665 7273 0a20 2020 2020  is differs.     
+00018ea0: 2020 2020 2020 6672 6f6d 2070 616e 6461        from panda
+00018eb0: 732e 0a0a 2020 2020 2020 2020 2020 2046  s...           F
+00018ec0: 7572 7468 6572 2c20 7468 6973 206d 6574  urther, this met
+00018ed0: 686f 6420 6375 7272 656e 746c 7920 646f  hod currently do
+00018ee0: 6573 206e 6f74 2073 7570 706f 7274 2066  es not support f
+00018ef0: 696c 7465 7269 6e67 206f 7574 204e 614e  iltering out NaN
+00018f00: 0a20 2020 2020 2020 2020 2020 7661 6c75  .           valu
+00018f10: 6573 2c20 7768 6963 6820 6973 2061 6761  es, which is aga
+00018f20: 696e 2061 2064 6966 6665 7265 6e63 6520  in a difference 
+00018f30: 746f 2050 616e 6461 732e 0a20 2020 2020  to Pandas..     
+00018f40: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+00018f50: 6620 5041 4e44 4153 5f47 545f 3230 3020  f PANDAS_GT_200 
+00018f60: 616e 6420 6178 6973 2069 7320 4e6f 6e65  and axis is None
+00018f70: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00018f80: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+00018f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018fa0: 2260 6178 6973 3d4e 6f6e 6560 2069 736e  "`axis=None` isn
+00018fb0: 2774 2063 7572 7265 6e74 6c79 2073 7570  't currently sup
+00018fc0: 706f 7274 6564 2066 6f72 2060 6b75 7274  ported for `kurt
+00018fd0: 6f73 6973 6020 7768 656e 2075 7369 6e67  osis` when using
+00018fe0: 2060 7061 6e64 6173 203e 3d32 6020 220a   `pandas >=2` ".
+00018ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019000: 6622 2870 616e 6461 733d 7b73 7472 2850  f"(pandas={str(P
+00019010: 414e 4441 535f 5645 5253 494f 4e29 7d20  ANDAS_VERSION)} 
+00019020: 6973 2069 6e73 7461 6c6c 6564 292e 220a  is installed).".
+00019030: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00019040: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
+00019050: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
+00019060: 2861 7869 7329 0a20 2020 2020 2020 205f  (axis).        _
+00019070: 7261 6973 655f 6966 5f6f 626a 6563 745f  raise_if_object_
+00019080: 7365 7269 6573 2873 656c 662c 2022 6b75  series(self, "ku
+00019090: 7274 6f73 6973 2229 0a20 2020 2020 2020  rtosis").       
+000190a0: 206e 756d 6572 6963 5f6f 6e6c 795f 6b77   numeric_only_kw
+000190b0: 6172 6773 203d 2067 6574 5f6e 756d 6572  args = get_numer
+000190c0: 6963 5f6f 6e6c 795f 6b77 6172 6773 286e  ic_only_kwargs(n
+000190d0: 756d 6572 6963 5f6f 6e6c 7929 0a0a 2020  umeric_only)..  
+000190e0: 2020 2020 2020 6966 2069 735f 6461 7461        if is_data
+000190f0: 6672 616d 655f 6c69 6b65 2873 656c 6629  frame_like(self)
+00019100: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00019110: 4c65 7420 7061 6e64 6173 2072 6169 7365  Let pandas raise
+00019120: 2065 7272 6f72 7320 6966 206e 6563 6573   errors if neces
+00019130: 7361 7279 0a20 2020 2020 2020 2020 2020  sary.           
+00019140: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
+00019150: 7461 5f6e 6f6e 656d 7074 792e 6b75 7274  ta_nonempty.kurt
+00019160: 6f73 6973 2861 7869 733d 6178 6973 2c20  osis(axis=axis, 
+00019170: 2a2a 6e75 6d65 7269 635f 6f6e 6c79 5f6b  **numeric_only_k
+00019180: 7761 7267 7329 0a20 2020 2020 2020 2065  wargs).        e
+00019190: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000191a0: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
+000191b0: 7461 5f6e 6f6e 656d 7074 792e 6b75 7274  ta_nonempty.kurt
+000191c0: 6f73 6973 2829 0a0a 2020 2020 2020 2020  osis()..        
+000191d0: 6966 2061 7869 7320 3d3d 2031 3a0a 2020  if axis == 1:.  
+000191e0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
+000191f0: 203d 206d 6170 5f70 6172 7469 7469 6f6e   = map_partition
+00019200: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00019210: 2020 204d 2e6b 7572 746f 7369 732c 0a20     M.kurtosis,. 
+00019220: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00019230: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
+00019240: 2020 2020 206d 6574 613d 6d65 7461 2c0a       meta=meta,.
+00019250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019260: 746f 6b65 6e3d 7365 6c66 2e5f 746f 6b65  token=self._toke
+00019270: 6e5f 7072 6566 6978 202b 2022 6b75 7274  n_prefix + "kurt
+00019280: 6f73 6973 222c 0a20 2020 2020 2020 2020  osis",.         
+00019290: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
+000192a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000192b0: 2020 656e 666f 7263 655f 6d65 7461 6461    enforce_metada
+000192c0: 7461 3d46 616c 7365 2c0a 2020 2020 2020  ta=False,.      
+000192d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000192e0: 2020 2020 7265 7475 726e 2068 616e 646c      return handl
+000192f0: 655f 6f75 7428 6f75 742c 2072 6573 756c  e_out(out, resul
+00019300: 7429 0a20 2020 2020 2020 2065 6c73 653a  t).        else:
+00019310: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00019320: 7365 6c66 2e6e 6469 6d20 3d3d 2031 3a0a  self.ndim == 1:.
+00019330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019340: 7265 7375 6c74 203d 2073 656c 662e 5f6b  result = self._k
+00019350: 7572 746f 7369 735f 3164 280a 2020 2020  urtosis_1d(.    
+00019360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019370: 7365 6c66 2c20 6669 7368 6572 3d66 6973  self, fisher=fis
+00019380: 6865 722c 2062 6961 733d 6269 6173 2c20  her, bias=bias, 
+00019390: 6e61 6e5f 706f 6c69 6379 3d6e 616e 5f70  nan_policy=nan_p
+000193a0: 6f6c 6963 790a 2020 2020 2020 2020 2020  olicy.          
+000193b0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000193c0: 2020 2020 2020 2020 7265 7475 726e 2068          return h
+000193d0: 616e 646c 655f 6f75 7428 6f75 742c 2072  andle_out(out, r
+000193e0: 6573 756c 7429 0a20 2020 2020 2020 2020  esult).         
+000193f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00019400: 2020 2020 2020 2020 2072 6573 756c 7420           result 
+00019410: 3d20 7365 6c66 2e5f 6b75 7274 6f73 6973  = self._kurtosis
+00019420: 5f6e 756d 6572 6963 280a 2020 2020 2020  _numeric(.      
+00019430: 2020 2020 2020 2020 2020 2020 2020 6669                fi
+00019440: 7368 6572 3d66 6973 6865 722c 2062 6961  sher=fisher, bia
+00019450: 733d 6269 6173 2c20 6e61 6e5f 706f 6c69  s=bias, nan_poli
+00019460: 6379 3d6e 616e 5f70 6f6c 6963 790a 2020  cy=nan_policy.  
+00019470: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00019480: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00019490: 6973 696e 7374 616e 6365 2873 656c 662c  isinstance(self,
+000194a0: 2044 6174 6146 7261 6d65 293a 0a20 2020   DataFrame):.   
+000194b0: 2020 2020 2020 2020 2020 2020 2072 6573               res
+000194c0: 756c 742e 6469 7669 7369 6f6e 7320 3d20  ult.divisions = 
+000194d0: 2873 656c 662e 636f 6c75 6d6e 732e 6d69  (self.columns.mi
+000194e0: 6e28 292c 2073 656c 662e 636f 6c75 6d6e  n(), self.column
+000194f0: 732e 6d61 7828 2929 0a0a 2020 2020 2020  s.max())..      
+00019500: 2020 2020 2020 7265 7475 726e 2068 616e        return han
+00019510: 646c 655f 6f75 7428 6f75 742c 2072 6573  dle_out(out, res
+00019520: 756c 7429 0a0a 2020 2020 6465 6620 5f6b  ult)..    def _k
+00019530: 7572 746f 7369 735f 3164 2873 656c 662c  urtosis_1d(self,
+00019540: 2063 6f6c 756d 6e2c 2066 6973 6865 723d   column, fisher=
+00019550: 5472 7565 2c20 6269 6173 3d54 7275 652c  True, bias=True,
+00019560: 206e 616e 5f70 6f6c 6963 793d 2270 726f   nan_policy="pro
+00019570: 7061 6761 7465 2229 3a0a 2020 2020 2020  pagate"):.      
+00019580: 2020 2222 2231 4420 7665 7273 696f 6e20    """1D version 
+00019590: 6f66 2074 6865 206b 7572 746f 7369 7320  of the kurtosis 
+000195a0: 6361 6c63 756c 6174 696f 6e2e 0a0a 2020  calculation...  
+000195b0: 2020 2020 2020 5573 6573 2074 6865 2061        Uses the a
+000195c0: 7272 6179 2076 6572 7369 6f6e 2066 726f  rray version fro
+000195d0: 6d20 6461 2e73 7461 7473 2069 6e20 6361  m da.stats in ca
+000195e0: 7365 2077 6520 6172 6520 7061 7373 696e  se we are passin
+000195f0: 6720 696e 2061 2073 696e 676c 6520 7365  g in a single se
+00019600: 7269 6573 0a20 2020 2020 2020 2022 2222  ries.        """
+00019610: 0a20 2020 2020 2020 2023 2069 6d70 6f72  .        # impor
+00019620: 7420 6465 7065 6e64 7320 6f6e 2073 6369  t depends on sci
+00019630: 7079 2c20 6e6f 7420 696e 7374 616c 6c65  py, not installe
+00019640: 6420 6279 2064 6566 6175 6c74 0a20 2020  d by default.   
+00019650: 2020 2020 2066 726f 6d20 6461 736b 2e61       from dask.a
+00019660: 7272 6179 2069 6d70 6f72 7420 7374 6174  rray import stat
+00019670: 7320 6173 2064 615f 7374 6174 730a 0a20  s as da_stats.. 
+00019680: 2020 2020 2020 2069 6620 7064 2e61 7069         if pd.api
+00019690: 2e74 7970 6573 2e69 735f 6578 7465 6e73  .types.is_extens
+000196a0: 696f 6e5f 6172 7261 795f 6474 7970 6528  ion_array_dtype(
+000196b0: 636f 6c75 6d6e 2e5f 6d65 7461 5f6e 6f6e  column._meta_non
+000196c0: 656d 7074 7929 3a0a 2020 2020 2020 2020  empty):.        
+000196d0: 2020 2020 636f 6c75 6d6e 203d 2063 6f6c      column = col
+000196e0: 756d 6e2e 6173 7479 7065 2822 6638 2229  umn.astype("f8")
+000196f0: 0a0a 2020 2020 2020 2020 656c 6966 206e  ..        elif n
+00019700: 6f74 206e 702e 6973 7375 6264 7479 7065  ot np.issubdtype
+00019710: 2863 6f6c 756d 6e2e 6474 7970 652c 206e  (column.dtype, n
+00019720: 702e 6e75 6d62 6572 293a 0a20 2020 2020  p.number):.     
+00019730: 2020 2020 2020 2063 6f6c 756d 6e20 3d20         column = 
+00019740: 636f 6c75 6d6e 2e61 7374 7970 6528 2266  column.astype("f
+00019750: 3822 290a 0a20 2020 2020 2020 206e 616d  8")..        nam
+00019760: 6520 3d20 7365 6c66 2e5f 746f 6b65 6e5f  e = self._token_
+00019770: 7072 6566 6978 202b 2022 6b75 7274 6f73  prefix + "kurtos
+00019780: 6973 2d31 642d 2220 2b20 746f 6b65 6e69  is-1d-" + tokeni
+00019790: 7a65 2863 6f6c 756d 6e29 0a0a 2020 2020  ze(column)..    
+000197a0: 2020 2020 6172 7261 795f 6b75 7274 6f73      array_kurtos
+000197b0: 6973 203d 2064 615f 7374 6174 732e 6b75  is = da_stats.ku
+000197c0: 7274 6f73 6973 280a 2020 2020 2020 2020  rtosis(.        
+000197d0: 2020 2020 636f 6c75 6d6e 2e76 616c 7565      column.value
+000197e0: 732c 2061 7869 733d 302c 2066 6973 6865  s, axis=0, fishe
+000197f0: 723d 6669 7368 6572 2c20 6269 6173 3d62  r=fisher, bias=b
+00019800: 6961 732c 206e 616e 5f70 6f6c 6963 793d  ias, nan_policy=
+00019810: 6e61 6e5f 706f 6c69 6379 0a20 2020 2020  nan_policy.     
+00019820: 2020 2029 0a0a 2020 2020 2020 2020 6c61     )..        la
+00019830: 7965 7220 3d20 7b0a 2020 2020 2020 2020  yer = {.        
+00019840: 2020 2020 286e 616d 652c 2030 293a 2028      (name, 0): (
+00019850: 6d65 7468 6f64 732e 7772 6170 5f6b 7572  methods.wrap_kur
+00019860: 746f 7369 735f 7265 6475 6374 696f 6e2c  tosis_reduction,
+00019870: 2028 6172 7261 795f 6b75 7274 6f73 6973   (array_kurtosis
+00019880: 2e5f 6e61 6d65 2c29 2c20 4e6f 6e65 290a  ._name,), None).
+00019890: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+000198a0: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
+000198b0: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
+000198c0: 6c6c 6563 7469 6f6e 7328 0a20 2020 2020  llections(.     
+000198d0: 2020 2020 2020 206e 616d 652c 206c 6179         name, lay
+000198e0: 6572 2c20 6465 7065 6e64 656e 6369 6573  er, dependencies
+000198f0: 3d5b 6172 7261 795f 6b75 7274 6f73 6973  =[array_kurtosis
+00019900: 5d0a 2020 2020 2020 2020 290a 0a20 2020  ].        )..   
+00019910: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+00019920: 6464 5f6f 626a 6563 7428 0a20 2020 2020  dd_object(.     
+00019930: 2020 2020 2020 2067 7261 7068 2c20 6e61         graph, na
+00019940: 6d65 2c20 636f 6c75 6d6e 2e5f 6d65 7461  me, column._meta
+00019950: 5f6e 6f6e 656d 7074 792e 6b75 7274 6f73  _nonempty.kurtos
+00019960: 6973 2829 2c20 6469 7669 7369 6f6e 733d  is(), divisions=
+00019970: 5b4e 6f6e 652c 204e 6f6e 655d 0a20 2020  [None, None].   
+00019980: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00019990: 5f6b 7572 746f 7369 735f 6e75 6d65 7269  _kurtosis_numeri
+000199a0: 6328 7365 6c66 2c20 6669 7368 6572 3d54  c(self, fisher=T
+000199b0: 7275 652c 2062 6961 733d 5472 7565 2c20  rue, bias=True, 
+000199c0: 6e61 6e5f 706f 6c69 6379 3d22 7072 6f70  nan_policy="prop
+000199d0: 6167 6174 6522 293a 0a20 2020 2020 2020  agate"):.       
+000199e0: 2022 2222 4d65 7468 6f64 2066 6f72 2064   """Method for d
+000199f0: 6174 6166 7261 6d65 7320 7769 7468 206e  ataframes with n
+00019a00: 756d 6572 6963 2063 6f6c 756d 6e73 2e0a  umeric columns..
+00019a10: 0a20 2020 2020 2020 204d 6170 7320 7468  .        Maps th
+00019a20: 6520 6172 7261 7920 7665 7273 696f 6e20  e array version 
+00019a30: 6672 6f6d 2064 612e 7374 6174 7320 6f6e  from da.stats on
+00019a40: 746f 2074 6865 206e 756d 6572 6963 2061  to the numeric a
+00019a50: 7272 6179 206f 6620 636f 6c75 6d6e 732e  rray of columns.
+00019a60: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00019a70: 2020 2020 2023 2069 6d70 6f72 7420 6465       # import de
+00019a80: 7065 6e64 7320 6f6e 2073 6369 7079 2c20  pends on scipy, 
+00019a90: 6e6f 7420 696e 7374 616c 6c65 6420 6279  not installed by
+00019aa0: 2064 6566 6175 6c74 0a20 2020 2020 2020   default.       
+00019ab0: 2066 726f 6d20 6461 736b 2e61 7272 6179   from dask.array
+00019ac0: 2069 6d70 6f72 7420 7374 6174 7320 6173   import stats as
+00019ad0: 2064 615f 7374 6174 730a 0a20 2020 2020   da_stats..     
+00019ae0: 2020 206e 756d 203d 2073 656c 662e 7365     num = self.se
+00019af0: 6c65 6374 5f64 7479 7065 7328 696e 636c  lect_dtypes(incl
+00019b00: 7564 653d 5b22 6e75 6d62 6572 222c 2022  ude=["number", "
+00019b10: 626f 6f6c 225d 2c20 6578 636c 7564 653d  bool"], exclude=
+00019b20: 5b6e 702e 7469 6d65 6465 6c74 6136 345d  [np.timedelta64]
+00019b30: 290a 0a20 2020 2020 2020 2076 616c 7565  )..        value
+00019b40: 735f 6474 7970 6520 3d20 6e75 6d2e 7661  s_dtype = num.va
+00019b50: 6c75 6573 2e64 7479 7065 0a20 2020 2020  lues.dtype.     
+00019b60: 2020 2061 7272 6179 5f76 616c 7565 7320     array_values 
+00019b70: 3d20 6e75 6d2e 7661 6c75 6573 0a0a 2020  = num.values..  
+00019b80: 2020 2020 2020 6966 206e 6f74 206e 702e        if not np.
+00019b90: 6973 7375 6264 7479 7065 2876 616c 7565  issubdtype(value
+00019ba0: 735f 6474 7970 652c 206e 702e 6e75 6d62  s_dtype, np.numb
+00019bb0: 6572 293a 0a20 2020 2020 2020 2020 2020  er):.           
+00019bc0: 2061 7272 6179 5f76 616c 7565 7320 3d20   array_values = 
+00019bd0: 6e75 6d2e 7661 6c75 6573 2e61 7374 7970  num.values.astyp
+00019be0: 6528 2266 3822 290a 0a20 2020 2020 2020  e("f8")..       
+00019bf0: 2061 7272 6179 5f6b 7572 746f 7369 7320   array_kurtosis 
+00019c00: 3d20 6461 5f73 7461 7473 2e6b 7572 746f  = da_stats.kurto
+00019c10: 7369 7328 0a20 2020 2020 2020 2020 2020  sis(.           
+00019c20: 2061 7272 6179 5f76 616c 7565 732c 2061   array_values, a
+00019c30: 7869 733d 302c 2066 6973 6865 723d 6669  xis=0, fisher=fi
+00019c40: 7368 6572 2c20 6269 6173 3d62 6961 732c  sher, bias=bias,
+00019c50: 206e 616e 5f70 6f6c 6963 793d 6e61 6e5f   nan_policy=nan_
+00019c60: 706f 6c69 6379 0a20 2020 2020 2020 2029  policy.        )
+00019c70: 0a0a 2020 2020 2020 2020 6e61 6d65 203d  ..        name =
+00019c80: 2073 656c 662e 5f74 6f6b 656e 5f70 7265   self._token_pre
+00019c90: 6669 7820 2b20 226b 7572 746f 7369 732d  fix + "kurtosis-
+00019ca0: 6e75 6d65 7269 6322 202b 2074 6f6b 656e  numeric" + token
+00019cb0: 697a 6528 6e75 6d29 0a20 2020 2020 2020  ize(num).       
+00019cc0: 2063 6f6c 7320 3d20 6e75 6d2e 5f6d 6574   cols = num._met
+00019cd0: 612e 636f 6c75 6d6e 7320 6966 2069 735f  a.columns if is_
+00019ce0: 6461 7461 6672 616d 655f 6c69 6b65 286e  dataframe_like(n
+00019cf0: 756d 2920 656c 7365 204e 6f6e 650a 0a20  um) else None.. 
+00019d00: 2020 2020 2020 2077 6974 6820 6368 6563         with chec
+00019d10: 6b5f 7265 6475 6374 696f 6e73 5f72 756e  k_reductions_run
+00019d20: 7469 6d65 5f77 6172 6e69 6e67 2829 3a0a  time_warning():.
+00019d30: 2020 2020 2020 2020 2020 2020 6b75 7274              kurt
+00019d40: 6f73 6973 5f73 6861 7065 203d 206e 756d  osis_shape = num
+00019d50: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
+00019d60: 7661 7228 6178 6973 3d30 292e 7368 6170  var(axis=0).shap
+00019d70: 650a 2020 2020 2020 2020 6172 7261 795f  e.        array_
+00019d80: 6b75 7274 6f73 6973 5f6e 616d 6520 3d20  kurtosis_name = 
+00019d90: 2861 7272 6179 5f6b 7572 746f 7369 732e  (array_kurtosis.
+00019da0: 5f6e 616d 652c 2920 2b20 2830 2c29 202a  _name,) + (0,) *
+00019db0: 206c 656e 286b 7572 746f 7369 735f 7368   len(kurtosis_sh
+00019dc0: 6170 6529 0a0a 2020 2020 2020 2020 6c61  ape)..        la
+00019dd0: 7965 7220 3d20 7b0a 2020 2020 2020 2020  yer = {.        
+00019de0: 2020 2020 286e 616d 652c 2030 293a 2028      (name, 0): (
+00019df0: 6d65 7468 6f64 732e 7772 6170 5f6b 7572  methods.wrap_kur
+00019e00: 746f 7369 735f 7265 6475 6374 696f 6e2c  tosis_reduction,
+00019e10: 2061 7272 6179 5f6b 7572 746f 7369 735f   array_kurtosis_
+00019e20: 6e61 6d65 2c20 636f 6c73 290a 2020 2020  name, cols).    
+00019e30: 2020 2020 7d0a 2020 2020 2020 2020 6772      }.        gr
+00019e40: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
+00019e50: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
+00019e60: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
+00019e70: 2020 206e 616d 652c 206c 6179 6572 2c20     name, layer, 
+00019e80: 6465 7065 6e64 656e 6369 6573 3d5b 6172  dependencies=[ar
+00019e90: 7261 795f 6b75 7274 6f73 6973 5d0a 2020  ray_kurtosis].  
+00019ea0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00019eb0: 2072 6574 7572 6e20 6e65 775f 6464 5f6f   return new_dd_o
+00019ec0: 626a 6563 7428 0a20 2020 2020 2020 2020  bject(.         
+00019ed0: 2020 2067 7261 7068 2c20 6e61 6d65 2c20     graph, name, 
+00019ee0: 6e75 6d2e 5f6d 6574 615f 6e6f 6e65 6d70  num._meta_nonemp
+00019ef0: 7479 2e6b 7572 746f 7369 7328 292c 2064  ty.kurtosis(), d
+00019f00: 6976 6973 696f 6e73 3d5b 4e6f 6e65 2c20  ivisions=[None, 
+00019f10: 4e6f 6e65 5d0a 2020 2020 2020 2020 290a  None].        ).
+00019f20: 0a20 2020 2040 5f6e 756d 6572 6963 5f6f  .    @_numeric_o
+00019f30: 6e6c 790a 2020 2020 4064 6572 6976 6564  nly.    @derived
+00019f40: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+00019f50: 6d65 290a 2020 2020 6465 6620 7365 6d28  me).    def sem(
+00019f60: 7365 6c66 2c20 6178 6973 3d4e 6f6e 652c  self, axis=None,
+00019f70: 2073 6b69 706e 613d 5472 7565 2c20 6464   skipna=True, dd
+00019f80: 6f66 3d31 2c20 7370 6c69 745f 6576 6572  of=1, split_ever
+00019f90: 793d 4661 6c73 652c 206e 756d 6572 6963  y=False, numeric
+00019fa0: 5f6f 6e6c 793d 4e6f 6e65 293a 0a20 2020  _only=None):.   
+00019fb0: 2020 2020 2061 7869 7320 3d20 7365 6c66       axis = self
+00019fc0: 2e5f 7661 6c69 6461 7465 5f61 7869 7328  ._validate_axis(
+00019fd0: 6178 6973 290a 2020 2020 2020 2020 5f72  axis).        _r
+00019fe0: 6169 7365 5f69 665f 6f62 6a65 6374 5f73  aise_if_object_s
+00019ff0: 6572 6965 7328 7365 6c66 2c20 2273 656d  eries(self, "sem
+0001a000: 2229 0a20 2020 2020 2020 2077 6974 6820  ").        with 
+0001a010: 6368 6563 6b5f 6e75 6d65 7269 635f 6f6e  check_numeric_on
+0001a020: 6c79 5f64 6570 7265 6361 7469 6f6e 2829  ly_deprecation()
+0001a030: 3a0a 2020 2020 2020 2020 2020 2020 6d65  :.            me
+0001a040: 7461 203d 2073 656c 662e 5f6d 6574 615f  ta = self._meta_
+0001a050: 6e6f 6e65 6d70 7479 2e73 656d 280a 2020  nonempty.sem(.  
+0001a060: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+0001a070: 6973 3d61 7869 732c 2073 6b69 706e 613d  is=axis, skipna=
+0001a080: 736b 6970 6e61 2c20 6464 6f66 3d64 646f  skipna, ddof=ddo
+0001a090: 662c 206e 756d 6572 6963 5f6f 6e6c 793d  f, numeric_only=
+0001a0a0: 6e75 6d65 7269 635f 6f6e 6c79 0a20 2020  numeric_only.   
+0001a0b0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001a0c0: 2020 2069 6620 6178 6973 203d 3d20 313a     if axis == 1:
+0001a0d0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001a0e0: 7572 6e20 6d61 705f 7061 7274 6974 696f  urn map_partitio
+0001a0f0: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
+0001a100: 2020 2020 4d2e 7365 6d2c 0a20 2020 2020      M.sem,.     
+0001a110: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+0001a120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a130: 206d 6574 613d 6d65 7461 2c0a 2020 2020   meta=meta,.    
+0001a140: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
+0001a150: 6e3d 7365 6c66 2e5f 746f 6b65 6e5f 7072  n=self._token_pr
+0001a160: 6566 6978 202b 2022 7365 6d22 2c0a 2020  efix + "sem",.  
+0001a170: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+0001a180: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
+0001a190: 2020 2020 2020 2020 2073 6b69 706e 613d           skipna=
+0001a1a0: 736b 6970 6e61 2c0a 2020 2020 2020 2020  skipna,.        
+0001a1b0: 2020 2020 2020 2020 6464 6f66 3d64 646f          ddof=ddo
+0001a1c0: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
+0001a1d0: 2020 2070 6172 656e 745f 6d65 7461 3d73     parent_meta=s
+0001a1e0: 656c 662e 5f6d 6574 612c 0a20 2020 2020  elf._meta,.     
+0001a1f0: 2020 2020 2020 2020 2020 206e 756d 6572             numer
+0001a200: 6963 5f6f 6e6c 793d 6e75 6d65 7269 635f  ic_only=numeric_
+0001a210: 6f6e 6c79 2c0a 2020 2020 2020 2020 2020  only,.          
+0001a220: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
+0001a230: 3a0a 2020 2020 2020 2020 2020 2020 6e75  :.            nu
+0001a240: 6d20 3d20 7365 6c66 2e5f 6765 745f 6e75  m = self._get_nu
+0001a250: 6d65 7269 635f 6461 7461 2829 0a20 2020  meric_data().   
+0001a260: 2020 2020 2020 2020 2076 203d 206e 756d           v = num
+0001a270: 2e76 6172 2873 6b69 706e 613d 736b 6970  .var(skipna=skip
+0001a280: 6e61 2c20 6464 6f66 3d64 646f 662c 2073  na, ddof=ddof, s
+0001a290: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
+0001a2a0: 5f65 7665 7279 290a 2020 2020 2020 2020  _every).        
+0001a2b0: 2020 2020 6e20 3d20 6e75 6d2e 636f 756e      n = num.coun
+0001a2c0: 7428 7370 6c69 745f 6576 6572 793d 7370  t(split_every=sp
+0001a2d0: 6c69 745f 6576 6572 7929 0a20 2020 2020  lit_every).     
+0001a2e0: 2020 2020 2020 206e 616d 6520 3d20 7365         name = se
+0001a2f0: 6c66 2e5f 746f 6b65 6e5f 7072 6566 6978  lf._token_prefix
+0001a300: 202b 2022 7365 6d22 0a20 2020 2020 2020   + "sem".       
+0001a310: 2020 2020 2072 6573 756c 7420 3d20 6d61       result = ma
+0001a320: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
+0001a330: 2020 2020 2020 2020 2020 2020 2020 6e70                np
+0001a340: 2e73 7172 742c 0a20 2020 2020 2020 2020  .sqrt,.         
+0001a350: 2020 2020 2020 2076 202f 206e 2c0a 2020         v / n,.  
+0001a360: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+0001a370: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
+0001a380: 2020 2020 2020 2020 2074 6f6b 656e 3d6e           token=n
+0001a390: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+0001a3a0: 2020 2020 2065 6e66 6f72 6365 5f6d 6574       enforce_met
+0001a3b0: 6164 6174 613d 4661 6c73 652c 0a20 2020  adata=False,.   
+0001a3c0: 2020 2020 2020 2020 2020 2020 2070 6172               par
+0001a3d0: 656e 745f 6d65 7461 3d73 656c 662e 5f6d  ent_meta=self._m
+0001a3e0: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
+0001a3f0: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
+0001a400: 6966 2069 7369 6e73 7461 6e63 6528 7365  if isinstance(se
+0001a410: 6c66 2c20 4461 7461 4672 616d 6529 3a0a  lf, DataFrame):.
+0001a420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a430: 7265 7375 6c74 2e64 6976 6973 696f 6e73  result.divisions
+0001a440: 203d 2028 7365 6c66 2e63 6f6c 756d 6e73   = (self.columns
+0001a450: 2e6d 696e 2829 2c20 7365 6c66 2e63 6f6c  .min(), self.col
+0001a460: 756d 6e73 2e6d 6178 2829 290a 2020 2020  umns.max()).    
+0001a470: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+0001a480: 6573 756c 740a 0a20 2020 2064 6566 2071  esult..    def q
+0001a490: 7561 6e74 696c 6528 7365 6c66 2c20 713d  uantile(self, q=
+0001a4a0: 302e 352c 2061 7869 733d 302c 206e 756d  0.5, axis=0, num
+0001a4b0: 6572 6963 5f6f 6e6c 793d 6e6f 5f64 6566  eric_only=no_def
+0001a4c0: 6175 6c74 2c20 6d65 7468 6f64 3d22 6465  ault, method="de
+0001a4d0: 6661 756c 7422 293a 0a20 2020 2020 2020  fault"):.       
+0001a4e0: 2022 2222 4170 7072 6f78 696d 6174 6520   """Approximate 
+0001a4f0: 726f 772d 7769 7365 2061 6e64 2070 7265  row-wise and pre
+0001a500: 6369 7365 2063 6f6c 756d 6e2d 7769 7365  cise column-wise
+0001a510: 2071 7561 6e74 696c 6573 206f 6620 4461   quantiles of Da
+0001a520: 7461 4672 616d 650a 0a20 2020 2020 2020  taFrame..       
+0001a530: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+0001a540: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+0001a550: 2020 2020 2020 2071 203a 206c 6973 742f         q : list/
+0001a560: 6172 7261 7920 6f66 2066 6c6f 6174 732c  array of floats,
+0001a570: 2064 6566 6175 6c74 2030 2e35 2028 3530   default 0.5 (50
+0001a580: 2529 0a20 2020 2020 2020 2020 2020 2049  %).            I
+0001a590: 7465 7261 626c 6520 6f66 206e 756d 6265  terable of numbe
+0001a5a0: 7273 2072 616e 6769 6e67 2066 726f 6d20  rs ranging from 
+0001a5b0: 3020 746f 2031 2066 6f72 2074 6865 2064  0 to 1 for the d
+0001a5c0: 6573 6972 6564 2071 7561 6e74 696c 6573  esired quantiles
+0001a5d0: 0a20 2020 2020 2020 2061 7869 7320 3a20  .        axis : 
+0001a5e0: 7b30 2c20 312c 2027 696e 6465 7827 2c20  {0, 1, 'index', 
+0001a5f0: 2763 6f6c 756d 6e73 277d 2028 6465 6661  'columns'} (defa
+0001a600: 756c 7420 3029 0a20 2020 2020 2020 2020  ult 0).         
+0001a610: 2020 2030 206f 7220 2769 6e64 6578 2720     0 or 'index' 
+0001a620: 666f 7220 726f 772d 7769 7365 2c20 3120  for row-wise, 1 
+0001a630: 6f72 2027 636f 6c75 6d6e 7327 2066 6f72  or 'columns' for
+0001a640: 2063 6f6c 756d 6e2d 7769 7365 0a20 2020   column-wise.   
+0001a650: 2020 2020 206d 6574 686f 6420 3a20 7b27       method : {'
+0001a660: 6465 6661 756c 7427 2c20 2774 6469 6765  default', 'tdige
+0001a670: 7374 272c 2027 6461 736b 277d 2c20 6f70  st', 'dask'}, op
+0001a680: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+0001a690: 2020 2057 6861 7420 6d65 7468 6f64 2074     What method t
+0001a6a0: 6f20 7573 652e 2042 7920 6465 6661 756c  o use. By defaul
+0001a6b0: 7420 7769 6c6c 2075 7365 2064 6173 6b27  t will use dask'
+0001a6c0: 7320 696e 7465 726e 616c 2063 7573 746f  s internal custo
+0001a6d0: 6d0a 2020 2020 2020 2020 2020 2020 616c  m.            al
+0001a6e0: 676f 7269 7468 6d20 2860 6027 6461 736b  gorithm (``'dask
+0001a6f0: 2760 6029 2e20 2049 6620 7365 7420 746f  '``).  If set to
+0001a700: 2060 6027 7464 6967 6573 7427 6060 2077   ``'tdigest'`` w
+0001a710: 696c 6c20 7573 6520 7464 6967 6573 740a  ill use tdigest.
+0001a720: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0001a730: 666c 6f61 7473 2061 6e64 2069 6e74 7320  floats and ints 
+0001a740: 616e 6420 6661 6c6c 6261 636b 2074 6f20  and fallback to 
+0001a750: 7468 6520 6060 2764 6173 6b27 6060 206f  the ``'dask'`` o
+0001a760: 7468 6572 7769 7365 2e0a 2020 2020 2020  therwise..      
+0001a770: 2020 2222 220a 2020 2020 2020 2020 6178    """.        ax
+0001a780: 6973 203d 2073 656c 662e 5f76 616c 6964  is = self._valid
+0001a790: 6174 655f 6178 6973 2861 7869 7329 0a20  ate_axis(axis). 
+0001a7a0: 2020 2020 2020 206b 6579 6e61 6d65 203d         keyname =
+0001a7b0: 2022 7175 616e 7469 6c65 732d 636f 6e63   "quantiles-conc
+0001a7c0: 6174 2d2d 2220 2b20 746f 6b65 6e69 7a65  at--" + tokenize
+0001a7d0: 2873 656c 662c 2071 2c20 6178 6973 290a  (self, q, axis).
+0001a7e0: 2020 2020 2020 2020 6e75 6d65 7269 635f          numeric_
+0001a7f0: 6b77 6172 6773 203d 2067 6574 5f6e 756d  kwargs = get_num
+0001a800: 6572 6963 5f6f 6e6c 795f 6b77 6172 6773  eric_only_kwargs
+0001a810: 286e 756d 6572 6963 5f6f 6e6c 7929 0a0a  (numeric_only)..
+0001a820: 2020 2020 2020 2020 7769 7468 2063 6865          with che
+0001a830: 636b 5f6e 756d 6572 6963 5f6f 6e6c 795f  ck_numeric_only_
+0001a840: 6465 7072 6563 6174 696f 6e28 2271 7561  deprecation("qua
+0001a850: 6e74 696c 6522 2c20 5472 7565 293a 0a20  ntile", True):. 
+0001a860: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
+0001a870: 3d20 7365 6c66 2e5f 6d65 7461 2e71 7561  = self._meta.qua
+0001a880: 6e74 696c 6528 712c 2061 7869 733d 6178  ntile(q, axis=ax
+0001a890: 6973 2c20 2a2a 6e75 6d65 7269 635f 6b77  is, **numeric_kw
+0001a8a0: 6172 6773 290a 0a20 2020 2020 2020 2069  args)..        i
+0001a8b0: 6620 6178 6973 203d 3d20 313a 0a20 2020  f axis == 1:.   
+0001a8c0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+0001a8d0: 7374 616e 6365 2871 2c20 6c69 7374 293a  stance(q, list):
+0001a8e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a8f0: 2023 204e 6f74 2073 7570 706f 7274 6564   # Not supported
+0001a900: 2c20 7468 6520 7265 7375 6c74 2077 696c  , the result wil
+0001a910: 6c20 6861 7665 2063 7572 7265 6e74 2069  l have current i
+0001a920: 6e64 6578 2061 7320 636f 6c75 6d6e 730a  ndex as columns.
+0001a930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a940: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0001a950: 2822 2771 2720 6d75 7374 2062 6520 7363  ("'q' must be sc
+0001a960: 616c 6172 2077 6865 6e20 6178 6973 3d31  alar when axis=1
+0001a970: 2069 7320 7370 6563 6966 6965 6422 290a   is specified").
+0001a980: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001a990: 7572 6e20 6d61 705f 7061 7274 6974 696f  urn map_partitio
+0001a9a0: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
+0001a9b0: 2020 2020 5f67 6574 6174 7472 5f6e 756d      _getattr_num
+0001a9c0: 6572 6963 5f6f 6e6c 792c 0a20 2020 2020  eric_only,.     
+0001a9d0: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+0001a9e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a9f0: 2071 2c0a 2020 2020 2020 2020 2020 2020   q,.            
+0001aa00: 2020 2020 6178 6973 2c0a 2020 2020 2020      axis,.      
+0001aa10: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
+0001aa20: 6b65 796e 616d 652c 0a20 2020 2020 2020  keyname,.       
+0001aa30: 2020 2020 2020 2020 2065 6e66 6f72 6365           enforce
+0001aa40: 5f6d 6574 6164 6174 613d 4661 6c73 652c  _metadata=False,
+0001aa50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001aa60: 202a 2a6e 756d 6572 6963 5f6b 7761 7267   **numeric_kwarg
+0001aa70: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0001aa80: 2020 206d 6574 613d 2871 2c20 2266 3822     meta=(q, "f8"
+0001aa90: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0001aaa0: 2020 2070 6172 656e 745f 6d65 7461 3d73     parent_meta=s
+0001aab0: 656c 662e 5f6d 6574 612c 0a20 2020 2020  elf._meta,.     
+0001aac0: 2020 2020 2020 2020 2020 205f 6461 736b             _dask
+0001aad0: 5f6d 6574 686f 645f 6e61 6d65 3d22 7175  _method_name="qu
+0001aae0: 616e 7469 6c65 222c 0a20 2020 2020 2020  antile",.       
+0001aaf0: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+0001ab00: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001ab10: 205f 7261 6973 655f 6966 5f6f 626a 6563   _raise_if_objec
+0001ab20: 745f 7365 7269 6573 2873 656c 662c 2022  t_series(self, "
+0001ab30: 7175 616e 7469 6c65 2229 0a20 2020 2020  quantile").     
+0001ab40: 2020 2020 2020 206e 756d 203d 2028 0a20         num = (. 
+0001ab50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001ab60: 656c 662e 5f67 6574 5f6e 756d 6572 6963  elf._get_numeric
+0001ab70: 5f64 6174 6128 290a 2020 2020 2020 2020  _data().        
+0001ab80: 2020 2020 2020 2020 6966 206e 756d 6572          if numer
+0001ab90: 6963 5f6f 6e6c 7920 6973 2054 7275 650a  ic_only is True.
+0001aba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001abb0: 6f72 2028 6e6f 7420 5041 4e44 4153 5f47  or (not PANDAS_G
+0001abc0: 545f 3230 3020 616e 6420 6e75 6d65 7269  T_200 and numeri
+0001abd0: 635f 6f6e 6c79 2069 7320 6e6f 5f64 6566  c_only is no_def
+0001abe0: 6175 6c74 290a 2020 2020 2020 2020 2020  ault).          
+0001abf0: 2020 2020 2020 656c 7365 2073 656c 660a        else self.
+0001ac00: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001ac10: 2020 2020 2020 2020 2020 7175 616e 7469            quanti
+0001ac20: 6c65 7320 3d20 7475 706c 6528 0a20 2020  les = tuple(.   
+0001ac30: 2020 2020 2020 2020 2020 2020 2071 7561               qua
+0001ac40: 6e74 696c 6528 6e75 6d2e 696c 6f63 5b3a  ntile(num.iloc[:
+0001ac50: 2c20 695d 2c20 712c 206d 6574 686f 6429  , i], q, method)
+0001ac60: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+0001ac70: 6c65 6e28 6e75 6d2e 636f 6c75 6d6e 7329  len(num.columns)
+0001ac80: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+0001ac90: 0a20 2020 2020 2020 2020 2020 2071 6e61  .            qna
+0001aca0: 6d65 7320 3d20 5b28 5f71 2e5f 6e61 6d65  mes = [(_q._name
+0001acb0: 2c20 3029 2066 6f72 205f 7120 696e 2071  , 0) for _q in q
+0001acc0: 7561 6e74 696c 6573 5d0a 0a20 2020 2020  uantiles]..     
+0001acd0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0001ace0: 616e 6365 2871 7561 6e74 696c 6573 5b30  ance(quantiles[0
+0001acf0: 5d2c 2053 6361 6c61 7229 3a0a 2020 2020  ], Scalar):.    
+0001ad00: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
+0001ad10: 7220 3d20 7b0a 2020 2020 2020 2020 2020  r = {.          
+0001ad20: 2020 2020 2020 2020 2020 286b 6579 6e61            (keyna
+0001ad30: 6d65 2c20 3029 3a20 2874 7970 6528 6d65  me, 0): (type(me
+0001ad40: 7461 292c 2071 6e61 6d65 732c 206e 756d  ta), qnames, num
+0001ad50: 2e63 6f6c 756d 6e73 2c20 4e6f 6e65 2c20  .columns, None, 
+0001ad60: 6d65 7461 2e6e 616d 6529 0a20 2020 2020  meta.name).     
+0001ad70: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+0001ad80: 2020 2020 2020 2020 2020 2020 2067 7261               gra
+0001ad90: 7068 203d 2048 6967 684c 6576 656c 4772  ph = HighLevelGr
+0001ada0: 6170 682e 6672 6f6d 5f63 6f6c 6c65 6374  aph.from_collect
+0001adb0: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
+0001adc0: 2020 2020 2020 2020 2020 6b65 796e 616d            keynam
+0001add0: 652c 206c 6179 6572 2c20 6465 7065 6e64  e, layer, depend
+0001ade0: 656e 6369 6573 3d71 7561 6e74 696c 6573  encies=quantiles
+0001adf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ae00: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+0001ae10: 2020 2064 6976 6973 696f 6e73 203d 2028     divisions = (
+0001ae20: 6d69 6e28 6e75 6d2e 636f 6c75 6d6e 7329  min(num.columns)
+0001ae30: 2c20 6d61 7828 6e75 6d2e 636f 6c75 6d6e  , max(num.column
+0001ae40: 7329 290a 2020 2020 2020 2020 2020 2020  s)).            
+0001ae50: 2020 2020 7265 7475 726e 2053 6572 6965      return Serie
+0001ae60: 7328 6772 6170 682c 206b 6579 6e61 6d65  s(graph, keyname
+0001ae70: 2c20 6d65 7461 2c20 6469 7669 7369 6f6e  , meta, division
+0001ae80: 7329 0a20 2020 2020 2020 2020 2020 2065  s).            e
+0001ae90: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001aea0: 2020 2020 206c 6179 6572 203d 207b 286b       layer = {(k
+0001aeb0: 6579 6e61 6d65 2c20 3029 3a20 286d 6574  eyname, 0): (met
+0001aec0: 686f 6473 2e63 6f6e 6361 742c 2071 6e61  hods.concat, qna
+0001aed0: 6d65 732c 2031 297d 0a20 2020 2020 2020  mes, 1)}.       
+0001aee0: 2020 2020 2020 2020 2067 7261 7068 203d           graph =
+0001aef0: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
+0001af00: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
+0001af10: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001af20: 2020 2020 2020 6b65 796e 616d 652c 206c        keyname, l
+0001af30: 6179 6572 2c20 6465 7065 6e64 656e 6369  ayer, dependenci
+0001af40: 6573 3d71 7561 6e74 696c 6573 0a20 2020  es=quantiles.   
+0001af50: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+0001af60: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0001af70: 6574 7572 6e20 6e65 775f 6464 5f6f 626a  eturn new_dd_obj
+0001af80: 6563 7428 6772 6170 682c 206b 6579 6e61  ect(graph, keyna
+0001af90: 6d65 2c20 6d65 7461 2c20 7175 616e 7469  me, meta, quanti
+0001afa0: 6c65 735b 305d 2e64 6976 6973 696f 6e73  les[0].divisions
+0001afb0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+0001afc0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+0001afd0: 6529 0a20 2020 2064 6566 2064 6573 6372  e).    def descr
+0001afe0: 6962 6528 0a20 2020 2020 2020 2073 656c  ibe(.        sel
+0001aff0: 662c 0a20 2020 2020 2020 2073 706c 6974  f,.        split
+0001b000: 5f65 7665 7279 3d46 616c 7365 2c0a 2020  _every=False,.  
+0001b010: 2020 2020 2020 7065 7263 656e 7469 6c65        percentile
+0001b020: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
+0001b030: 7065 7263 656e 7469 6c65 735f 6d65 7468  percentiles_meth
+0001b040: 6f64 3d22 6465 6661 756c 7422 2c0a 2020  od="default",.  
+0001b050: 2020 2020 2020 696e 636c 7564 653d 4e6f        include=No
+0001b060: 6e65 2c0a 2020 2020 2020 2020 6578 636c  ne,.        excl
+0001b070: 7564 653d 4e6f 6e65 2c0a 2020 2020 2020  ude=None,.      
+0001b080: 2020 6461 7465 7469 6d65 5f69 735f 6e75    datetime_is_nu
+0001b090: 6d65 7269 633d 6e6f 5f64 6566 6175 6c74  meric=no_default
+0001b0a0: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0001b0b0: 2069 6620 5041 4e44 4153 5f47 545f 3230   if PANDAS_GT_20
+0001b0c0: 303a 0a20 2020 2020 2020 2020 2020 2069  0:.            i
+0001b0d0: 6620 6461 7465 7469 6d65 5f69 735f 6e75  f datetime_is_nu
+0001b0e0: 6d65 7269 6320 6973 206e 6f5f 6465 6661  meric is no_defa
+0001b0f0: 756c 743a 0a20 2020 2020 2020 2020 2020  ult:.           
+0001b100: 2020 2020 2064 6174 6574 696d 655f 6973       datetime_is
+0001b110: 5f6e 756d 6572 6963 203d 2054 7275 650a  _numeric = True.
+0001b120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b130: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
+0001b140: 7269 635f 6b77 6172 6720 3d20 7b7d 0a20  ric_kwarg = {}. 
+0001b150: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0001b160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b170: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+0001b180: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001b190: 2020 2020 2020 2264 6174 6574 696d 655f        "datetime_
+0001b1a0: 6973 5f6e 756d 6572 6963 2069 7320 7265  is_numeric is re
+0001b1b0: 6d6f 7665 6420 696e 2070 616e 6461 733e  moved in pandas>
+0001b1c0: 3d32 2e30 2e30 2c20 6461 7465 7469 6d65  =2.0.0, datetime
+0001b1d0: 2064 6174 6120 7769 6c6c 2061 6c77 6179   data will alway
+0001b1e0: 7320 6265 2022 0a20 2020 2020 2020 2020  s be ".         
+0001b1f0: 2020 2020 2020 2020 2020 2022 7375 6d6d             "summ
+0001b200: 6172 697a 6564 2061 7320 6e75 6d65 7269  arized as numeri
+0001b210: 6322 0a20 2020 2020 2020 2020 2020 2020  c".             
+0001b220: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
+0001b230: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
+0001b240: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
+0001b250: 6963 203d 2028 0a20 2020 2020 2020 2020  ic = (.         
+0001b260: 2020 2020 2020 2046 616c 7365 2069 6620         False if 
+0001b270: 6461 7465 7469 6d65 5f69 735f 6e75 6d65  datetime_is_nume
+0001b280: 7269 6320 6973 206e 6f5f 6465 6661 756c  ric is no_defaul
+0001b290: 7420 656c 7365 2064 6174 6574 696d 655f  t else datetime_
+0001b2a0: 6973 5f6e 756d 6572 6963 0a20 2020 2020  is_numeric.     
+0001b2b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001b2c0: 2020 2020 2064 6174 6574 696d 655f 6973       datetime_is
+0001b2d0: 5f6e 756d 6572 6963 5f6b 7761 7267 203d  _numeric_kwarg =
+0001b2e0: 207b 2264 6174 6574 696d 655f 6973 5f6e   {"datetime_is_n
+0001b2f0: 756d 6572 6963 223a 2064 6174 6574 696d  umeric": datetim
+0001b300: 655f 6973 5f6e 756d 6572 6963 7d0a 0a20  e_is_numeric}.. 
+0001b310: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+0001b320: 6d65 7461 2e6e 6469 6d20 3d3d 2031 3a0a  meta.ndim == 1:.
+0001b330: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+0001b340: 203d 2073 656c 662e 5f6d 6574 615f 6e6f   = self._meta_no
+0001b350: 6e65 6d70 7479 2e64 6573 6372 6962 6528  nempty.describe(
+0001b360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b370: 2070 6572 6365 6e74 696c 6573 3d70 6572   percentiles=per
+0001b380: 6365 6e74 696c 6573 2c0a 2020 2020 2020  centiles,.      
+0001b390: 2020 2020 2020 2020 2020 696e 636c 7564            includ
+0001b3a0: 653d 696e 636c 7564 652c 0a20 2020 2020  e=include,.     
+0001b3b0: 2020 2020 2020 2020 2020 2065 7863 6c75             exclu
+0001b3c0: 6465 3d65 7863 6c75 6465 2c0a 2020 2020  de=exclude,.    
+0001b3d0: 2020 2020 2020 2020 2020 2020 2a2a 6461              **da
+0001b3e0: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
+0001b3f0: 635f 6b77 6172 672c 0a20 2020 2020 2020  c_kwarg,.       
+0001b400: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0001b410: 2020 206f 7574 7075 7420 3d20 7365 6c66     output = self
+0001b420: 2e5f 6465 7363 7269 6265 5f31 6428 0a20  ._describe_1d(. 
+0001b430: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001b440: 656c 662c 2073 706c 6974 5f65 7665 7279  elf, split_every
+0001b450: 2c20 7065 7263 656e 7469 6c65 732c 2070  , percentiles, p
+0001b460: 6572 6365 6e74 696c 6573 5f6d 6574 686f  ercentiles_metho
+0001b470: 642c 2064 6174 6574 696d 655f 6973 5f6e  d, datetime_is_n
+0001b480: 756d 6572 6963 0a20 2020 2020 2020 2020  umeric.         
+0001b490: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0001b4a0: 206f 7574 7075 742e 5f6d 6574 6120 3d20   output._meta = 
+0001b4b0: 6d65 7461 0a20 2020 2020 2020 2020 2020  meta.           
+0001b4c0: 2072 6574 7572 6e20 6f75 7470 7574 0a20   return output. 
+0001b4d0: 2020 2020 2020 2065 6c69 6620 2869 6e63         elif (inc
+0001b4e0: 6c75 6465 2069 7320 4e6f 6e65 2920 616e  lude is None) an
+0001b4f0: 6420 2865 7863 6c75 6465 2069 7320 4e6f  d (exclude is No
+0001b500: 6e65 293a 0a20 2020 2020 2020 2020 2020  ne):.           
+0001b510: 205f 696e 636c 7564 6520 3d20 5b6e 702e   _include = [np.
+0001b520: 6e75 6d62 6572 2c20 6e70 2e74 696d 6564  number, np.timed
+0001b530: 656c 7461 3634 5d0a 2020 2020 2020 2020  elta64].        
+0001b540: 2020 2020 6966 2064 6174 6574 696d 655f      if datetime_
+0001b550: 6973 5f6e 756d 6572 6963 3a0a 2020 2020  is_numeric:.    
+0001b560: 2020 2020 2020 2020 2020 2020 5f69 6e63              _inc
+0001b570: 6c75 6465 2e61 7070 656e 6428 6e70 2e64  lude.append(np.d
+0001b580: 6174 6574 696d 6536 3429 0a20 2020 2020  atetime64).     
+0001b590: 2020 2020 2020 2064 6174 6120 3d20 7365         data = se
+0001b5a0: 6c66 2e5f 6d65 7461 2e73 656c 6563 745f  lf._meta.select_
+0001b5b0: 6474 7970 6573 2869 6e63 6c75 6465 3d5f  dtypes(include=_
+0001b5c0: 696e 636c 7564 6529 0a0a 2020 2020 2020  include)..      
+0001b5d0: 2020 2020 2020 2320 7768 656e 2073 6f6d        # when som
+0001b5e0: 6520 6e75 6d65 7269 6373 2f74 696d 6564  e numerics/timed
+0001b5f0: 656c 7461 7320 6172 6520 666f 756e 642c  eltas are found,
+0001b600: 2062 7920 6465 6661 756c 7420 6b65 6570   by default keep
+0001b610: 2074 6865 6d0a 2020 2020 2020 2020 2020   them.          
+0001b620: 2020 6966 206c 656e 2864 6174 612e 636f    if len(data.co
+0001b630: 6c75 6d6e 7329 203d 3d20 303a 0a20 2020  lumns) == 0:.   
+0001b640: 2020 2020 2020 2020 2020 2020 2063 686f               cho
+0001b650: 7365 6e5f 636f 6c75 6d6e 735f 696e 6465  sen_columns_inde
+0001b660: 7865 7320 3d20 6c69 7374 2872 616e 6765  xes = list(range
+0001b670: 286c 656e 2873 656c 662e 5f6d 6574 612e  (len(self._meta.
+0001b680: 636f 6c75 6d6e 7329 2929 0a20 2020 2020  columns))).     
+0001b690: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001b6a0: 2020 2020 2020 2020 2020 2020 2023 2063               # c
+0001b6b0: 6865 636b 2069 6620 7468 6572 6520 6172  heck if there ar
+0001b6c0: 6520 7469 6d65 6465 6c74 612c 2062 6f6f  e timedelta, boo
+0001b6d0: 6c65 616e 2c20 6f72 2064 6174 6574 696d  lean, or datetim
+0001b6e0: 6520 636f 6c75 6d6e 730a 2020 2020 2020  e columns.      
+0001b6f0: 2020 2020 2020 2020 2020 5f69 6e63 6c75            _inclu
+0001b700: 6465 203d 205b 6e70 2e74 696d 6564 656c  de = [np.timedel
+0001b710: 7461 3634 2c20 626f 6f6c 5d0a 2020 2020  ta64, bool].    
+0001b720: 2020 2020 2020 2020 2020 2020 6966 2064              if d
+0001b730: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
+0001b740: 6963 3a0a 2020 2020 2020 2020 2020 2020  ic:.            
+0001b750: 2020 2020 2020 2020 5f69 6e63 6c75 6465          _include
+0001b760: 2e61 7070 656e 6428 6e70 2e64 6174 6574  .append(np.datet
+0001b770: 696d 6536 3429 0a20 2020 2020 2020 2020  ime64).         
+0001b780: 2020 2020 2020 2062 6f6f 6c73 5f61 6e64         bools_and
+0001b790: 5f74 696d 6573 203d 2073 656c 662e 5f6d  _times = self._m
+0001b7a0: 6574 612e 7365 6c65 6374 5f64 7479 7065  eta.select_dtype
+0001b7b0: 7328 696e 636c 7564 653d 5f69 6e63 6c75  s(include=_inclu
+0001b7c0: 6465 290a 2020 2020 2020 2020 2020 2020  de).            
+0001b7d0: 2020 2020 6966 206c 656e 2862 6f6f 6c73      if len(bools
+0001b7e0: 5f61 6e64 5f74 696d 6573 2e63 6f6c 756d  _and_times.colum
+0001b7f0: 6e73 2920 3d3d 2030 3a0a 2020 2020 2020  ns) == 0:.      
+0001b800: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0001b810: 7475 726e 2073 656c 662e 5f64 6573 6372  turn self._descr
+0001b820: 6962 655f 6e75 6d65 7269 6328 0a20 2020  ibe_numeric(.   
+0001b830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b840: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0001b850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b860: 2020 2073 706c 6974 5f65 7665 7279 2c0a     split_every,.
+0001b870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b880: 2020 2020 2020 2020 7065 7263 656e 7469          percenti
+0001b890: 6c65 732c 0a20 2020 2020 2020 2020 2020  les,.           
+0001b8a0: 2020 2020 2020 2020 2020 2020 2070 6572               per
+0001b8b0: 6365 6e74 696c 6573 5f6d 6574 686f 642c  centiles_method,
+0001b8c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b8d0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0001b8e0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001b8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b900: 2063 686f 7365 6e5f 636f 6c75 6d6e 735f   chosen_columns_
+0001b910: 696e 6465 7865 7320 3d20 7365 6c66 2e5f  indexes = self._
+0001b920: 6765 745f 636f 6c75 6d6e 735f 696e 6465  get_columns_inde
+0001b930: 7865 735f 6261 7365 645f 6f6e 5f64 7479  xes_based_on_dty
+0001b940: 7065 7328 0a20 2020 2020 2020 2020 2020  pes(.           
+0001b950: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+0001b960: 610a 2020 2020 2020 2020 2020 2020 2020  a.              
+0001b970: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001b980: 656c 6966 2069 6e63 6c75 6465 203d 3d20  elif include == 
+0001b990: 2261 6c6c 223a 0a20 2020 2020 2020 2020  "all":.         
+0001b9a0: 2020 2069 6620 6578 636c 7564 6520 6973     if exclude is
+0001b9b0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0001b9c0: 2020 2020 2020 2020 2020 206d 7367 203d             msg =
+0001b9d0: 2022 6578 636c 7564 6520 6d75 7374 2062   "exclude must b
+0001b9e0: 6520 4e6f 6e65 2077 6865 6e20 696e 636c  e None when incl
+0001b9f0: 7564 6520 6973 2027 616c 6c27 220a 2020  ude is 'all'".  
+0001ba00: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0001ba10: 6973 6520 5661 6c75 6545 7272 6f72 286d  ise ValueError(m
+0001ba20: 7367 290a 2020 2020 2020 2020 2020 2020  sg).            
+0001ba30: 6368 6f73 656e 5f63 6f6c 756d 6e73 5f69  chosen_columns_i
+0001ba40: 6e64 6578 6573 203d 206c 6973 7428 7261  ndexes = list(ra
+0001ba50: 6e67 6528 6c65 6e28 7365 6c66 2e5f 6d65  nge(len(self._me
+0001ba60: 7461 2e63 6f6c 756d 6e73 2929 290a 2020  ta.columns))).  
+0001ba70: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001ba80: 2020 2020 2020 2020 6461 7461 203d 2073          data = s
+0001ba90: 656c 662e 5f6d 6574 612e 7365 6c65 6374  elf._meta.select
+0001baa0: 5f64 7479 7065 7328 696e 636c 7564 653d  _dtypes(include=
+0001bab0: 696e 636c 7564 652c 2065 7863 6c75 6465  include, exclude
+0001bac0: 3d65 7863 6c75 6465 290a 2020 2020 2020  =exclude).      
+0001bad0: 2020 2020 2020 6368 6f73 656e 5f63 6f6c        chosen_col
+0001bae0: 756d 6e73 5f69 6e64 6578 6573 203d 2073  umns_indexes = s
+0001baf0: 656c 662e 5f67 6574 5f63 6f6c 756d 6e73  elf._get_columns
+0001bb00: 5f69 6e64 6578 6573 5f62 6173 6564 5f6f  _indexes_based_o
+0001bb10: 6e5f 6474 7970 6573 2864 6174 6129 0a0a  n_dtypes(data)..
+0001bb20: 2020 2020 2020 2020 7374 6174 7320 3d20          stats = 
+0001bb30: 5b0a 2020 2020 2020 2020 2020 2020 7365  [.            se
+0001bb40: 6c66 2e5f 6465 7363 7269 6265 5f31 6428  lf._describe_1d(
+0001bb50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bb60: 2073 656c 662e 696c 6f63 5b3a 2c20 636f   self.iloc[:, co
+0001bb70: 6c5f 6964 785d 2c0a 2020 2020 2020 2020  l_idx],.        
+0001bb80: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
+0001bb90: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
+0001bba0: 2020 2020 2070 6572 6365 6e74 696c 6573       percentiles
+0001bbb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001bbc0: 2020 7065 7263 656e 7469 6c65 735f 6d65    percentiles_me
+0001bbd0: 7468 6f64 2c0a 2020 2020 2020 2020 2020  thod,.          
+0001bbe0: 2020 2020 2020 6461 7465 7469 6d65 5f69        datetime_i
+0001bbf0: 735f 6e75 6d65 7269 632c 0a20 2020 2020  s_numeric,.     
+0001bc00: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001bc10: 2020 2020 2066 6f72 2063 6f6c 5f69 6478       for col_idx
+0001bc20: 2069 6e20 6368 6f73 656e 5f63 6f6c 756d   in chosen_colum
+0001bc30: 6e73 5f69 6e64 6578 6573 0a20 2020 2020  ns_indexes.     
+0001bc40: 2020 205d 0a20 2020 2020 2020 2073 7461     ].        sta
+0001bc50: 7473 5f6e 616d 6573 203d 205b 2873 2e5f  ts_names = [(s._
+0001bc60: 6e61 6d65 2c20 3029 2066 6f72 2073 2069  name, 0) for s i
+0001bc70: 6e20 7374 6174 735d 0a0a 2020 2020 2020  n stats]..      
+0001bc80: 2020 6e61 6d65 203d 2022 6465 7363 7269    name = "descri
+0001bc90: 6265 2d2d 2220 2b20 746f 6b65 6e69 7a65  be--" + tokenize
+0001bca0: 2873 656c 662c 2073 706c 6974 5f65 7665  (self, split_eve
+0001bcb0: 7279 290a 2020 2020 2020 2020 6c61 7965  ry).        laye
+0001bcc0: 7220 3d20 7b28 6e61 6d65 2c20 3029 3a20  r = {(name, 0): 
+0001bcd0: 286d 6574 686f 6473 2e64 6573 6372 6962  (methods.describ
+0001bce0: 655f 6167 6772 6567 6174 652c 2073 7461  e_aggregate, sta
+0001bcf0: 7473 5f6e 616d 6573 297d 0a20 2020 2020  ts_names)}.     
+0001bd00: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+0001bd10: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+0001bd20: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
+0001bd30: 206c 6179 6572 2c20 6465 7065 6e64 656e   layer, dependen
+0001bd40: 6369 6573 3d73 7461 7473 290a 2020 2020  cies=stats).    
+0001bd50: 2020 2020 6d65 7461 203d 2073 656c 662e      meta = self.
+0001bd60: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e64  _meta_nonempty.d
+0001bd70: 6573 6372 6962 6528 0a20 2020 2020 2020  escribe(.       
+0001bd80: 2020 2020 2069 6e63 6c75 6465 3d69 6e63       include=inc
+0001bd90: 6c75 6465 2c20 6578 636c 7564 653d 6578  lude, exclude=ex
+0001bda0: 636c 7564 652c 202a 2a64 6174 6574 696d  clude, **datetim
+0001bdb0: 655f 6973 5f6e 756d 6572 6963 5f6b 7761  e_is_numeric_kwa
+0001bdc0: 7267 0a20 2020 2020 2020 2029 0a20 2020  rg.        ).   
+0001bdd0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+0001bde0: 6464 5f6f 626a 6563 7428 6772 6170 682c  dd_object(graph,
+0001bdf0: 206e 616d 652c 206d 6574 612c 2064 6976   name, meta, div
+0001be00: 6973 696f 6e73 3d5b 4e6f 6e65 2c20 4e6f  isions=[None, No
+0001be10: 6e65 5d29 0a0a 2020 2020 6465 6620 5f67  ne])..    def _g
+0001be20: 6574 5f63 6f6c 756d 6e73 5f69 6e64 6578  et_columns_index
+0001be30: 6573 5f62 6173 6564 5f6f 6e5f 6474 7970  es_based_on_dtyp
+0001be40: 6573 2873 656c 662c 2073 7562 7365 7429  es(self, subset)
+0001be50: 3a0a 2020 2020 2020 2020 6d65 7461 203d  :.        meta =
+0001be60: 2073 656c 662e 5f6d 6574 612e 6474 7970   self._meta.dtyp
+0001be70: 6573 2e72 6573 6574 5f69 6e64 6578 2829  es.reset_index()
+0001be80: 0a20 2020 2020 2020 206d 6574 612e 696e  .        meta.in
+0001be90: 6465 782e 6e61 6d65 203d 2022 696e 6465  dex.name = "inde
+0001bea0: 7865 7222 0a20 2020 2020 2020 2072 6574  xer".        ret
+0001beb0: 7572 6e20 280a 2020 2020 2020 2020 2020  urn (.          
+0001bec0: 2020 6d65 7461 2e72 6573 6574 5f69 6e64    meta.reset_ind
+0001bed0: 6578 2829 0a20 2020 2020 2020 2020 2020  ex().           
+0001bee0: 202e 6d65 7267 6528 7375 6273 6574 2e64   .merge(subset.d
+0001bef0: 7479 7065 732e 7265 7365 745f 696e 6465  types.reset_inde
+0001bf00: 7828 292c 2068 6f77 3d22 696e 6e65 7222  x(), how="inner"
+0001bf10: 295b 2269 6e64 6578 6572 225d 0a20 2020  )["indexer"].   
+0001bf20: 2020 2020 2020 2020 202e 7661 6c75 6573           .values
+0001bf30: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0001bf40: 6465 6620 5f64 6573 6372 6962 655f 3164  def _describe_1d
+0001bf50: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0001bf60: 2020 2020 2020 2020 6461 7461 2c0a 2020          data,.  
+0001bf70: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
+0001bf80: 793d 4661 6c73 652c 0a20 2020 2020 2020  y=False,.       
+0001bf90: 2070 6572 6365 6e74 696c 6573 3d4e 6f6e   percentiles=Non
+0001bfa0: 652c 0a20 2020 2020 2020 2070 6572 6365  e,.        perce
+0001bfb0: 6e74 696c 6573 5f6d 6574 686f 643d 2264  ntiles_method="d
+0001bfc0: 6566 6175 6c74 222c 0a20 2020 2020 2020  efault",.       
+0001bfd0: 2064 6174 6574 696d 655f 6973 5f6e 756d   datetime_is_num
+0001bfe0: 6572 6963 3d46 616c 7365 2c0a 2020 2020  eric=False,.    
+0001bff0: 293a 0a20 2020 2020 2020 2069 6620 6973  ):.        if is
+0001c000: 5f62 6f6f 6c5f 6474 7970 6528 6461 7461  _bool_dtype(data
+0001c010: 2e5f 6d65 7461 293a 0a20 2020 2020 2020  ._meta):.       
+0001c020: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0001c030: 2e5f 6465 7363 7269 6265 5f6e 6f6e 6e75  ._describe_nonnu
+0001c040: 6d65 7269 635f 3164 280a 2020 2020 2020  meric_1d(.      
+0001c050: 2020 2020 2020 2020 2020 6461 7461 2c20            data, 
+0001c060: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+0001c070: 745f 6576 6572 792c 2064 6174 6574 696d  t_every, datetim
+0001c080: 655f 6973 5f6e 756d 6572 6963 3d64 6174  e_is_numeric=dat
+0001c090: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
+0001c0a0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001c0b0: 2020 2020 2020 2065 6c69 6620 6973 5f6e         elif is_n
+0001c0c0: 756d 6572 6963 5f64 7479 7065 2864 6174  umeric_dtype(dat
+0001c0d0: 612e 5f6d 6574 6129 3a0a 2020 2020 2020  a._meta):.      
+0001c0e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0001c0f0: 662e 5f64 6573 6372 6962 655f 6e75 6d65  f._describe_nume
+0001c100: 7269 6328 0a20 2020 2020 2020 2020 2020  ric(.           
+0001c110: 2020 2020 2064 6174 612c 0a20 2020 2020       data,.     
+0001c120: 2020 2020 2020 2020 2020 2073 706c 6974             split
+0001c130: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+0001c140: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
+0001c150: 2020 2020 7065 7263 656e 7469 6c65 733d      percentiles=
+0001c160: 7065 7263 656e 7469 6c65 732c 0a20 2020  percentiles,.   
+0001c170: 2020 2020 2020 2020 2020 2020 2070 6572               per
+0001c180: 6365 6e74 696c 6573 5f6d 6574 686f 643d  centiles_method=
+0001c190: 7065 7263 656e 7469 6c65 735f 6d65 7468  percentiles_meth
+0001c1a0: 6f64 2c0a 2020 2020 2020 2020 2020 2020  od,.            
+0001c1b0: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
+0001c1c0: 735f 7469 6d65 6465 6c74 6136 345f 6474  s_timedelta64_dt
+0001c1d0: 7970 6528 6461 7461 2e5f 6d65 7461 293a  ype(data._meta):
+0001c1e0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001c1f0: 7572 6e20 7365 6c66 2e5f 6465 7363 7269  urn self._descri
+0001c200: 6265 5f6e 756d 6572 6963 280a 2020 2020  be_numeric(.    
+0001c210: 2020 2020 2020 2020 2020 2020 6461 7461              data
+0001c220: 2e64 726f 706e 6128 292c 0a20 2020 2020  .dropna(),.     
+0001c230: 2020 2020 2020 2020 2020 2073 706c 6974             split
+0001c240: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+0001c250: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
+0001c260: 2020 2020 7065 7263 656e 7469 6c65 733d      percentiles=
+0001c270: 7065 7263 656e 7469 6c65 732c 0a20 2020  percentiles,.   
+0001c280: 2020 2020 2020 2020 2020 2020 2070 6572               per
+0001c290: 6365 6e74 696c 6573 5f6d 6574 686f 643d  centiles_method=
+0001c2a0: 7065 7263 656e 7469 6c65 735f 6d65 7468  percentiles_meth
+0001c2b0: 6f64 2c0a 2020 2020 2020 2020 2020 2020  od,.            
+0001c2c0: 2020 2020 6973 5f74 696d 6564 656c 7461      is_timedelta
+0001c2d0: 5f63 6f6c 756d 6e3d 5472 7565 2c0a 2020  _column=True,.  
+0001c2e0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001c2f0: 2020 2020 656c 6966 2069 735f 6461 7465      elif is_date
+0001c300: 7469 6d65 3634 5f61 6e79 5f64 7479 7065  time64_any_dtype
+0001c310: 2864 6174 612e 5f6d 6574 6129 2061 6e64  (data._meta) and
+0001c320: 2064 6174 6574 696d 655f 6973 5f6e 756d   datetime_is_num
+0001c330: 6572 6963 3a0a 2020 2020 2020 2020 2020  eric:.          
+0001c340: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
+0001c350: 6573 6372 6962 655f 6e75 6d65 7269 6328  escribe_numeric(
+0001c360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c370: 2064 6174 612e 6472 6f70 6e61 2829 2c0a   data.dropna(),.
+0001c380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c390: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+0001c3a0: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
+0001c3b0: 2020 2020 2020 2020 2070 6572 6365 6e74           percent
+0001c3c0: 696c 6573 3d70 6572 6365 6e74 696c 6573  iles=percentiles
+0001c3d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001c3e0: 2020 7065 7263 656e 7469 6c65 735f 6d65    percentiles_me
+0001c3f0: 7468 6f64 3d70 6572 6365 6e74 696c 6573  thod=percentiles
+0001c400: 5f6d 6574 686f 642c 0a20 2020 2020 2020  _method,.       
+0001c410: 2020 2020 2020 2020 2069 735f 6461 7465           is_date
+0001c420: 7469 6d65 5f63 6f6c 756d 6e3d 5472 7565  time_column=True
+0001c430: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0001c440: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001c450: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001c460: 2073 656c 662e 5f64 6573 6372 6962 655f   self._describe_
+0001c470: 6e6f 6e6e 756d 6572 6963 5f31 6428 0a20  nonnumeric_1d(. 
+0001c480: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0001c490: 6174 612c 2073 706c 6974 5f65 7665 7279  ata, split_every
+0001c4a0: 3d73 706c 6974 5f65 7665 7279 2c20 6461  =split_every, da
+0001c4b0: 7465 7469 6d65 5f69 735f 6e75 6d65 7269  tetime_is_numeri
+0001c4c0: 633d 6461 7465 7469 6d65 5f69 735f 6e75  c=datetime_is_nu
+0001c4d0: 6d65 7269 630a 2020 2020 2020 2020 2020  meric.          
+0001c4e0: 2020 290a 0a20 2020 2064 6566 205f 6465    )..    def _de
+0001c4f0: 7363 7269 6265 5f6e 756d 6572 6963 280a  scribe_numeric(.
+0001c500: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0001c510: 2020 2020 2020 6461 7461 2c0a 2020 2020        data,.    
+0001c520: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
+0001c530: 4661 6c73 652c 0a20 2020 2020 2020 2070  False,.        p
+0001c540: 6572 6365 6e74 696c 6573 3d4e 6f6e 652c  ercentiles=None,
+0001c550: 0a20 2020 2020 2020 2070 6572 6365 6e74  .        percent
+0001c560: 696c 6573 5f6d 6574 686f 643d 2264 6566  iles_method="def
+0001c570: 6175 6c74 222c 0a20 2020 2020 2020 2069  ault",.        i
+0001c580: 735f 7469 6d65 6465 6c74 615f 636f 6c75  s_timedelta_colu
+0001c590: 6d6e 3d46 616c 7365 2c0a 2020 2020 2020  mn=False,.      
+0001c5a0: 2020 6973 5f64 6174 6574 696d 655f 636f    is_datetime_co
+0001c5b0: 6c75 6d6e 3d46 616c 7365 2c0a 2020 2020  lumn=False,.    
+0001c5c0: 293a 0a20 2020 2020 2020 2066 726f 6d20  ):.        from 
+0001c5d0: 6461 736b 2e64 6174 6166 7261 6d65 2e6e  dask.dataframe.n
+0001c5e0: 756d 6572 6963 2069 6d70 6f72 7420 746f  umeric import to
+0001c5f0: 5f6e 756d 6572 6963 0a0a 2020 2020 2020  _numeric..      
+0001c600: 2020 6966 2069 735f 7469 6d65 6465 6c74    if is_timedelt
+0001c610: 615f 636f 6c75 6d6e 206f 7220 6973 5f64  a_column or is_d
+0001c620: 6174 6574 696d 655f 636f 6c75 6d6e 3a0a  atetime_column:.
+0001c630: 2020 2020 2020 2020 2020 2020 6e75 6d20              num 
+0001c640: 3d20 746f 5f6e 756d 6572 6963 2864 6174  = to_numeric(dat
+0001c650: 6129 0a20 2020 2020 2020 2065 6c73 653a  a).        else:
+0001c660: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+0001c670: 203d 2064 6174 612e 5f67 6574 5f6e 756d   = data._get_num
+0001c680: 6572 6963 5f64 6174 6128 290a 0a20 2020  eric_data()..   
+0001c690: 2020 2020 2069 6620 6461 7461 2e6e 6469       if data.ndi
+0001c6a0: 6d20 3d3d 2032 2061 6e64 206c 656e 286e  m == 2 and len(n
+0001c6b0: 756d 2e63 6f6c 756d 6e73 2920 3d3d 2030  um.columns) == 0
+0001c6c0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0001c6d0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+0001c6e0: 4461 7461 4672 616d 6520 636f 6e74 6169  DataFrame contai
+0001c6f0: 6e73 206f 6e6c 7920 6e6f 6e2d 6e75 6d65  ns only non-nume
+0001c700: 7269 6320 6461 7461 2e22 290a 2020 2020  ric data.").    
+0001c710: 2020 2020 656c 6966 2064 6174 612e 6e64      elif data.nd
+0001c720: 696d 203d 3d20 3120 616e 6420 6461 7461  im == 1 and data
+0001c730: 2e64 7479 7065 203d 3d20 226f 626a 6563  .dtype == "objec
+0001c740: 7422 3a0a 2020 2020 2020 2020 2020 2020  t":.            
+0001c750: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0001c760: 2822 4361 6e6e 6f74 2063 6f6d 7075 7465  ("Cannot compute
+0001c770: 2060 6064 6573 6372 6962 6560 6020 6f6e   ``describe`` on
+0001c780: 206f 626a 6563 7420 6474 7970 652e 2229   object dtype.")
+0001c790: 0a20 2020 2020 2020 2069 6620 7065 7263  .        if perc
+0001c7a0: 656e 7469 6c65 7320 6973 204e 6f6e 653a  entiles is None:
+0001c7b0: 0a20 2020 2020 2020 2020 2020 2070 6572  .            per
+0001c7c0: 6365 6e74 696c 6573 203d 205b 302e 3235  centiles = [0.25
+0001c7d0: 2c20 302e 352c 2030 2e37 355d 0a20 2020  , 0.5, 0.75].   
+0001c7e0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001c7f0: 2020 2020 2020 2023 2061 6c77 6179 7320         # always 
+0001c800: 696e 636c 7564 6520 7468 6520 7468 6520  include the the 
+0001c810: 3530 2574 6c65 2074 6f20 6361 6c63 756c  50%tle to calcul
+0001c820: 6174 6520 7468 6520 6d65 6469 616e 0a20  ate the median. 
+0001c830: 2020 2020 2020 2020 2020 2023 2075 6e69             # uni
+0001c840: 7175 6520 7265 6d6f 7665 7320 6475 706c  que removes dupl
+0001c850: 6963 6174 6573 2061 6e64 2073 6f72 7473  icates and sorts
+0001c860: 2071 7561 6e74 696c 6573 0a20 2020 2020   quantiles.     
+0001c870: 2020 2020 2020 2070 6572 6365 6e74 696c         percentil
+0001c880: 6573 203d 206e 702e 6172 7261 7928 7065  es = np.array(pe
+0001c890: 7263 656e 7469 6c65 7329 0a20 2020 2020  rcentiles).     
+0001c8a0: 2020 2020 2020 2070 6572 6365 6e74 696c         percentil
+0001c8b0: 6573 203d 206e 702e 6170 7065 6e64 2870  es = np.append(p
+0001c8c0: 6572 6365 6e74 696c 6573 2c20 302e 3529  ercentiles, 0.5)
+0001c8d0: 0a20 2020 2020 2020 2020 2020 2070 6572  .            per
+0001c8e0: 6365 6e74 696c 6573 203d 206e 702e 756e  centiles = np.un
+0001c8f0: 6971 7565 2870 6572 6365 6e74 696c 6573  ique(percentiles
+0001c900: 290a 2020 2020 2020 2020 2020 2020 7065  ).            pe
+0001c910: 7263 656e 7469 6c65 7320 3d20 6c69 7374  rcentiles = list
+0001c920: 2870 6572 6365 6e74 696c 6573 290a 2020  (percentiles).  
+0001c930: 2020 2020 2020 7374 6174 7320 3d20 5b0a        stats = [.
+0001c940: 2020 2020 2020 2020 2020 2020 6e75 6d2e              num.
+0001c950: 636f 756e 7428 7370 6c69 745f 6576 6572  count(split_ever
+0001c960: 793d 7370 6c69 745f 6576 6572 7929 2c0a  y=split_every),.
+0001c970: 2020 2020 2020 2020 2020 2020 6e75 6d2e              num.
+0001c980: 6d65 616e 2873 706c 6974 5f65 7665 7279  mean(split_every
+0001c990: 3d73 706c 6974 5f65 7665 7279 292c 0a20  =split_every),. 
+0001c9a0: 2020 2020 2020 2020 2020 206e 756d 2e73             num.s
+0001c9b0: 7464 2873 706c 6974 5f65 7665 7279 3d73  td(split_every=s
+0001c9c0: 706c 6974 5f65 7665 7279 292c 0a20 2020  plit_every),.   
+0001c9d0: 2020 2020 2020 2020 206e 756d 2e6d 696e           num.min
+0001c9e0: 2873 706c 6974 5f65 7665 7279 3d73 706c  (split_every=spl
+0001c9f0: 6974 5f65 7665 7279 292c 0a20 2020 2020  it_every),.     
+0001ca00: 2020 2020 2020 206e 756d 2e71 7561 6e74         num.quant
+0001ca10: 696c 6528 7065 7263 656e 7469 6c65 732c  ile(percentiles,
+0001ca20: 206d 6574 686f 643d 7065 7263 656e 7469   method=percenti
+0001ca30: 6c65 735f 6d65 7468 6f64 292c 0a20 2020  les_method),.   
+0001ca40: 2020 2020 2020 2020 206e 756d 2e6d 6178           num.max
+0001ca50: 2873 706c 6974 5f65 7665 7279 3d73 706c  (split_every=spl
+0001ca60: 6974 5f65 7665 7279 292c 0a20 2020 2020  it_every),.     
+0001ca70: 2020 205d 0a20 2020 2020 2020 2073 7461     ].        sta
+0001ca80: 7473 5f6e 616d 6573 203d 205b 2873 2e5f  ts_names = [(s._
+0001ca90: 6e61 6d65 2c20 3029 2066 6f72 2073 2069  name, 0) for s i
+0001caa0: 6e20 7374 6174 735d 0a0a 2020 2020 2020  n stats]..      
+0001cab0: 2020 636f 6c6e 616d 6520 3d20 6461 7461    colname = data
+0001cac0: 2e5f 6d65 7461 2e6e 616d 6520 6966 2069  ._meta.name if i
+0001cad0: 735f 7365 7269 6573 5f6c 696b 6528 6461  s_series_like(da
+0001cae0: 7461 2e5f 6d65 7461 2920 656c 7365 204e  ta._meta) else N
+0001caf0: 6f6e 650a 0a20 2020 2020 2020 206e 616d  one..        nam
+0001cb00: 6520 3d20 2264 6573 6372 6962 652d 6e75  e = "describe-nu
+0001cb10: 6d65 7269 632d 2d22 202b 2074 6f6b 656e  meric--" + token
+0001cb20: 697a 6528 6e75 6d2c 2073 706c 6974 5f65  ize(num, split_e
+0001cb30: 7665 7279 290a 2020 2020 2020 2020 6c61  very).        la
+0001cb40: 7965 7220 3d20 7b0a 2020 2020 2020 2020  yer = {.        
+0001cb50: 2020 2020 286e 616d 652c 2030 293a 2028      (name, 0): (
+0001cb60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001cb70: 206d 6574 686f 6473 2e64 6573 6372 6962   methods.describ
+0001cb80: 655f 6e75 6d65 7269 635f 6167 6772 6567  e_numeric_aggreg
+0001cb90: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+0001cba0: 2020 2020 2073 7461 7473 5f6e 616d 6573       stats_names
+0001cbb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001cbc0: 2020 636f 6c6e 616d 652c 0a20 2020 2020    colname,.     
+0001cbd0: 2020 2020 2020 2020 2020 2069 735f 7469             is_ti
+0001cbe0: 6d65 6465 6c74 615f 636f 6c75 6d6e 2c0a  medelta_column,.
+0001cbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cc00: 6973 5f64 6174 6574 696d 655f 636f 6c75  is_datetime_colu
+0001cc10: 6d6e 2c0a 2020 2020 2020 2020 2020 2020  mn,.            
+0001cc20: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
+0001cc30: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
+0001cc40: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
+0001cc50: 636f 6c6c 6563 7469 6f6e 7328 6e61 6d65  collections(name
+0001cc60: 2c20 6c61 7965 722c 2064 6570 656e 6465  , layer, depende
+0001cc70: 6e63 6965 733d 7374 6174 7329 0a20 2020  ncies=stats).   
+0001cc80: 2020 2020 206d 6574 6120 3d20 6e75 6d2e       meta = num.
+0001cc90: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e64  _meta_nonempty.d
+0001cca0: 6573 6372 6962 6528 290a 2020 2020 2020  escribe().      
+0001ccb0: 2020 7265 7475 726e 206e 6577 5f64 645f    return new_dd_
+0001ccc0: 6f62 6a65 6374 2867 7261 7068 2c20 6e61  object(graph, na
+0001ccd0: 6d65 2c20 6d65 7461 2c20 6469 7669 7369  me, meta, divisi
+0001cce0: 6f6e 733d 5b4e 6f6e 652c 204e 6f6e 655d  ons=[None, None]
+0001ccf0: 290a 0a20 2020 2064 6566 205f 6465 7363  )..    def _desc
+0001cd00: 7269 6265 5f6e 6f6e 6e75 6d65 7269 635f  ribe_nonnumeric_
+0001cd10: 3164 280a 2020 2020 2020 2020 7365 6c66  1d(.        self
+0001cd20: 2c20 6461 7461 2c20 7370 6c69 745f 6576  , data, split_ev
+0001cd30: 6572 793d 4661 6c73 652c 2064 6174 6574  ery=False, datet
+0001cd40: 696d 655f 6973 5f6e 756d 6572 6963 3d46  ime_is_numeric=F
+0001cd50: 616c 7365 0a20 2020 2029 3a0a 2020 2020  alse.    ):.    
+0001cd60: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
+0001cd70: 7461 6672 616d 652e 6e75 6d65 7269 6320  taframe.numeric 
+0001cd80: 696d 706f 7274 2074 6f5f 6e75 6d65 7269  import to_numeri
+0001cd90: 630a 0a20 2020 2020 2020 2076 636f 756e  c..        vcoun
+0001cda0: 7473 203d 2064 6174 612e 7661 6c75 655f  ts = data.value_
+0001cdb0: 636f 756e 7473 2873 706c 6974 5f65 7665  counts(split_eve
+0001cdc0: 7279 3d73 706c 6974 5f65 7665 7279 290a  ry=split_every).
+0001cdd0: 2020 2020 2020 2020 636f 756e 745f 6e6f          count_no
+0001cde0: 6e7a 6572 6f20 3d20 7663 6f75 6e74 735b  nzero = vcounts[
+0001cdf0: 7663 6f75 6e74 7320 213d 2030 5d0a 2020  vcounts != 0].  
+0001ce00: 2020 2020 2020 636f 756e 745f 756e 6971        count_uniq
+0001ce10: 7565 203d 2063 6f75 6e74 5f6e 6f6e 7a65  ue = count_nonze
+0001ce20: 726f 2e73 697a 650a 0a20 2020 2020 2020  ro.size..       
+0001ce30: 2073 7461 7473 203d 205b 0a20 2020 2020   stats = [.     
+0001ce40: 2020 2020 2020 2023 206e 756e 6971 7565         # nunique
+0001ce50: 0a20 2020 2020 2020 2020 2020 2063 6f75  .            cou
+0001ce60: 6e74 5f75 6e69 7175 652c 0a20 2020 2020  nt_unique,.     
+0001ce70: 2020 2020 2020 2023 2063 6f75 6e74 0a20         # count. 
+0001ce80: 2020 2020 2020 2020 2020 2064 6174 612e             data.
+0001ce90: 636f 756e 7428 7370 6c69 745f 6576 6572  count(split_ever
+0001cea0: 793d 7370 6c69 745f 6576 6572 7929 2c0a  y=split_every),.
+0001ceb0: 2020 2020 2020 2020 2020 2020 2320 6d6f              # mo
+0001cec0: 7374 2063 6f6d 6d6f 6e20 7661 6c75 650a  st common value.
+0001ced0: 2020 2020 2020 2020 2020 2020 7663 6f75              vcou
+0001cee0: 6e74 732e 5f68 6561 6428 312c 206e 7061  nts._head(1, npa
+0001cef0: 7274 6974 696f 6e73 3d31 2c20 636f 6d70  rtitions=1, comp
+0001cf00: 7574 653d 4661 6c73 652c 2073 6166 653d  ute=False, safe=
+0001cf10: 4661 6c73 6529 2c0a 2020 2020 2020 2020  False),.        
+0001cf20: 5d0a 0a20 2020 2020 2020 2069 6620 6973  ]..        if is
+0001cf30: 5f64 6174 6574 696d 6536 345f 616e 795f  _datetime64_any_
+0001cf40: 6474 7970 6528 6461 7461 2e5f 6d65 7461  dtype(data._meta
+0001cf50: 2920 616e 6420 6e6f 7420 6461 7465 7469  ) and not dateti
+0001cf60: 6d65 5f69 735f 6e75 6d65 7269 633a 0a20  me_is_numeric:. 
+0001cf70: 2020 2020 2020 2020 2020 206d 696e 5f74             min_t
+0001cf80: 7320 3d20 746f 5f6e 756d 6572 6963 2864  s = to_numeric(d
+0001cf90: 6174 612e 6472 6f70 6e61 2829 292e 6d69  ata.dropna()).mi
+0001cfa0: 6e28 7370 6c69 745f 6576 6572 793d 7370  n(split_every=sp
+0001cfb0: 6c69 745f 6576 6572 7929 0a20 2020 2020  lit_every).     
+0001cfc0: 2020 2020 2020 206d 6178 5f74 7320 3d20         max_ts = 
+0001cfd0: 746f 5f6e 756d 6572 6963 2864 6174 612e  to_numeric(data.
+0001cfe0: 6472 6f70 6e61 2829 292e 6d61 7828 7370  dropna()).max(sp
+0001cff0: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+0001d000: 6576 6572 7929 0a20 2020 2020 2020 2020  every).         
+0001d010: 2020 2073 7461 7473 2e65 7874 656e 6428     stats.extend(
+0001d020: 5b6d 696e 5f74 732c 206d 6178 5f74 735d  [min_ts, max_ts]
+0001d030: 290a 0a20 2020 2020 2020 2073 7461 7473  )..        stats
+0001d040: 5f6e 616d 6573 203d 205b 2873 2e5f 6e61  _names = [(s._na
+0001d050: 6d65 2c20 3029 2066 6f72 2073 2069 6e20  me, 0) for s in 
+0001d060: 7374 6174 735d 0a20 2020 2020 2020 2063  stats].        c
+0001d070: 6f6c 6e61 6d65 203d 2064 6174 612e 5f6d  olname = data._m
+0001d080: 6574 612e 6e61 6d65 0a0a 2020 2020 2020  eta.name..      
+0001d090: 2020 6e61 6d65 203d 2022 6465 7363 7269    name = "descri
+0001d0a0: 6265 2d6e 6f6e 6e75 6d65 7269 632d 3164  be-nonnumeric-1d
+0001d0b0: 2d2d 2220 2b20 746f 6b65 6e69 7a65 2864  --" + tokenize(d
+0001d0c0: 6174 612c 2073 706c 6974 5f65 7665 7279  ata, split_every
+0001d0d0: 290a 2020 2020 2020 2020 6c61 7965 7220  ).        layer 
+0001d0e0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+0001d0f0: 286e 616d 652c 2030 293a 2028 6d65 7468  (name, 0): (meth
+0001d100: 6f64 732e 6465 7363 7269 6265 5f6e 6f6e  ods.describe_non
+0001d110: 6e75 6d65 7269 635f 6167 6772 6567 6174  numeric_aggregat
+0001d120: 652c 2073 7461 7473 5f6e 616d 6573 2c20  e, stats_names, 
+0001d130: 636f 6c6e 616d 6529 0a20 2020 2020 2020  colname).       
+0001d140: 207d 0a20 2020 2020 2020 2067 7261 7068   }.        graph
+0001d150: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+0001d160: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+0001d170: 6e73 286e 616d 652c 206c 6179 6572 2c20  ns(name, layer, 
+0001d180: 6465 7065 6e64 656e 6369 6573 3d73 7461  dependencies=sta
+0001d190: 7473 290a 0a20 2020 2020 2020 2069 6620  ts)..        if 
+0001d1a0: 6e6f 7420 5041 4e44 4153 5f47 545f 3230  not PANDAS_GT_20
+0001d1b0: 303a 0a20 2020 2020 2020 2020 2020 2064  0:.            d
+0001d1c0: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
+0001d1d0: 6963 5f6b 7761 7267 203d 207b 2264 6174  ic_kwarg = {"dat
+0001d1e0: 6574 696d 655f 6973 5f6e 756d 6572 6963  etime_is_numeric
+0001d1f0: 223a 2064 6174 6574 696d 655f 6973 5f6e  ": datetime_is_n
+0001d200: 756d 6572 6963 7d0a 2020 2020 2020 2020  umeric}.        
+0001d210: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001d220: 2020 6461 7465 7469 6d65 5f69 735f 6e75    datetime_is_nu
+0001d230: 6d65 7269 635f 6b77 6172 6720 3d20 7b7d  meric_kwarg = {}
+0001d240: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
+0001d250: 6461 7461 2e5f 6d65 7461 5f6e 6f6e 656d  data._meta_nonem
+0001d260: 7074 792e 6465 7363 7269 6265 282a 2a64  pty.describe(**d
+0001d270: 6174 6574 696d 655f 6973 5f6e 756d 6572  atetime_is_numer
+0001d280: 6963 5f6b 7761 7267 290a 2020 2020 2020  ic_kwarg).      
+0001d290: 2020 7265 7475 726e 206e 6577 5f64 645f    return new_dd_
+0001d2a0: 6f62 6a65 6374 2867 7261 7068 2c20 6e61  object(graph, na
+0001d2b0: 6d65 2c20 6d65 7461 2c20 6469 7669 7369  me, meta, divisi
+0001d2c0: 6f6e 733d 5b4e 6f6e 652c 204e 6f6e 655d  ons=[None, None]
+0001d2d0: 290a 0a20 2020 2064 6566 205f 6375 6d5f  )..    def _cum_
+0001d2e0: 6167 6728 0a20 2020 2020 2020 2073 656c  agg(.        sel
+0001d2f0: 662c 206f 705f 6e61 6d65 2c20 6368 756e  f, op_name, chun
+0001d300: 6b2c 2061 6767 7265 6761 7465 2c20 6178  k, aggregate, ax
+0001d310: 6973 2c20 736b 6970 6e61 3d54 7275 652c  is, skipna=True,
+0001d320: 2063 6875 6e6b 5f6b 7761 7267 733d 4e6f   chunk_kwargs=No
+0001d330: 6e65 2c20 6f75 743d 4e6f 6e65 0a20 2020  ne, out=None.   
+0001d340: 2029 3a0a 2020 2020 2020 2020 2222 2257   ):.        """W
+0001d350: 7261 7070 6572 2066 6f72 2063 756d 756c  rapper for cumul
+0001d360: 6174 6976 6520 6f70 6572 6174 696f 6e22  ative operation"
+0001d370: 2222 0a0a 2020 2020 2020 2020 6178 6973  ""..        axis
+0001d380: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
+0001d390: 655f 6178 6973 2861 7869 7329 0a0a 2020  e_axis(axis)..  
+0001d3a0: 2020 2020 2020 6966 2061 7869 7320 3d3d        if axis ==
+0001d3b0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+0001d3c0: 6e61 6d65 203d 2066 227b 7365 6c66 2e5f  name = f"{self._
+0001d3d0: 746f 6b65 6e5f 7072 6566 6978 7d7b 6f70  token_prefix}{op
+0001d3e0: 5f6e 616d 657d 2861 7869 733d 3129 220a  _name}(axis=1)".
+0001d3f0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+0001d400: 6c74 203d 2073 656c 662e 6d61 705f 7061  lt = self.map_pa
+0001d410: 7274 6974 696f 6e73 2863 6875 6e6b 2c20  rtitions(chunk, 
+0001d420: 746f 6b65 6e3d 6e61 6d65 2c20 2a2a 6368  token=name, **ch
+0001d430: 756e 6b5f 6b77 6172 6773 290a 2020 2020  unk_kwargs).    
+0001d440: 2020 2020 2020 2020 7265 7475 726e 2068          return h
+0001d450: 616e 646c 655f 6f75 7428 6f75 742c 2072  andle_out(out, r
+0001d460: 6573 756c 7429 0a20 2020 2020 2020 2065  esult).        e
+0001d470: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001d480: 2023 2063 756d 756c 6174 6520 6561 6368   # cumulate each
+0001d490: 2070 6172 7469 7469 6f6e 730a 2020 2020   partitions.    
+0001d4a0: 2020 2020 2020 2020 6e61 6d65 3120 3d20          name1 = 
+0001d4b0: 6622 7b73 656c 662e 5f74 6f6b 656e 5f70  f"{self._token_p
+0001d4c0: 7265 6669 787d 7b6f 705f 6e61 6d65 7d2d  refix}{op_name}-
+0001d4d0: 6d61 7022 0a20 2020 2020 2020 2020 2020  map".           
+0001d4e0: 2063 756d 7061 7274 203d 206d 6170 5f70   cumpart = map_p
+0001d4f0: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+0001d500: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
+0001d510: 2c20 7365 6c66 2c20 746f 6b65 6e3d 6e61  , self, token=na
+0001d520: 6d65 312c 206d 6574 613d 7365 6c66 2c20  me1, meta=self, 
+0001d530: 2a2a 6368 756e 6b5f 6b77 6172 6773 0a20  **chunk_kwargs. 
+0001d540: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0001d550: 2020 2020 2020 2020 2020 6e61 6d65 3220            name2 
+0001d560: 3d20 6622 7b73 656c 662e 5f74 6f6b 656e  = f"{self._token
+0001d570: 5f70 7265 6669 787d 7b6f 705f 6e61 6d65  _prefix}{op_name
+0001d580: 7d2d 7461 6b65 2d6c 6173 7422 0a20 2020  }-take-last".   
+0001d590: 2020 2020 2020 2020 2063 756d 6c61 7374           cumlast
+0001d5a0: 203d 206d 6170 5f70 6172 7469 7469 6f6e   = map_partition
+0001d5b0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+0001d5c0: 2020 205f 7461 6b65 5f6c 6173 742c 0a20     _take_last,. 
+0001d5d0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0001d5e0: 756d 7061 7274 2c0a 2020 2020 2020 2020  umpart,.        
+0001d5f0: 2020 2020 2020 2020 736b 6970 6e61 2c0a          skipna,.
+0001d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d610: 6d65 7461 3d6d 6574 615f 7365 7269 6573  meta=meta_series
+0001d620: 5f63 6f6e 7374 7275 6374 6f72 2873 656c  _constructor(sel
+0001d630: 6629 285b 5d2c 2064 7479 7065 3d22 666c  f)([], dtype="fl
+0001d640: 6f61 7422 292c 0a20 2020 2020 2020 2020  oat"),.         
+0001d650: 2020 2020 2020 2074 6f6b 656e 3d6e 616d         token=nam
+0001d660: 6532 2c0a 2020 2020 2020 2020 2020 2020  e2,.            
+0001d670: 290a 0a20 2020 2020 2020 2020 2020 2073  )..            s
+0001d680: 7566 6669 7820 3d20 746f 6b65 6e69 7a65  uffix = tokenize
+0001d690: 2873 656c 6629 0a20 2020 2020 2020 2020  (self).         
+0001d6a0: 2020 206e 616d 6520 3d20 6622 7b73 656c     name = f"{sel
+0001d6b0: 662e 5f74 6f6b 656e 5f70 7265 6669 787d  f._token_prefix}
+0001d6c0: 7b6f 705f 6e61 6d65 7d2d 7b73 7566 6669  {op_name}-{suffi
+0001d6d0: 787d 220a 2020 2020 2020 2020 2020 2020  x}".            
+0001d6e0: 636e 616d 6520 3d20 6622 7b73 656c 662e  cname = f"{self.
+0001d6f0: 5f74 6f6b 656e 5f70 7265 6669 787d 7b6f  _token_prefix}{o
+0001d700: 705f 6e61 6d65 7d2d 6375 6d2d 6c61 7374  p_name}-cum-last
+0001d710: 2d7b 7375 6666 6978 7d22 0a0a 2020 2020  -{suffix}"..    
+0001d720: 2020 2020 2020 2020 2320 6167 6772 6567          # aggreg
+0001d730: 6174 6520 6375 6d75 6c61 7465 6420 7061  ate cumulated pa
+0001d740: 7274 6973 696f 6e73 2061 6e64 2069 7473  rtisions and its
+0001d750: 2070 7265 7669 6f75 7320 6c61 7374 2065   previous last e
+0001d760: 6c65 6d65 6e74 0a20 2020 2020 2020 2020  lement.         
+0001d770: 2020 206c 6179 6572 203d 207b 7d0a 2020     layer = {}.  
+0001d780: 2020 2020 2020 2020 2020 6c61 7965 725b            layer[
+0001d790: 286e 616d 652c 2030 295d 203d 2028 6375  (name, 0)] = (cu
+0001d7a0: 6d70 6172 742e 5f6e 616d 652c 2030 290a  mpart._name, 0).
+0001d7b0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0001d7c0: 2069 2069 6e20 7261 6e67 6528 312c 2073   i in range(1, s
+0001d7d0: 656c 662e 6e70 6172 7469 7469 6f6e 7329  elf.npartitions)
+0001d7e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001d7f0: 2020 2320 7374 6f72 6520 6561 6368 2063    # store each c
+0001d800: 756d 756c 6174 6976 6520 7374 6570 2074  umulative step t
+0001d810: 6f20 6772 6170 6820 746f 2072 6564 7563  o graph to reduc
+0001d820: 6520 636f 6d70 7574 6174 696f 6e0a 2020  e computation.  
+0001d830: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001d840: 2069 203d 3d20 313a 0a20 2020 2020 2020   i == 1:.       
+0001d850: 2020 2020 2020 2020 2020 2020 206c 6179               lay
+0001d860: 6572 5b28 636e 616d 652c 2069 295d 203d  er[(cname, i)] =
+0001d870: 2028 6375 6d6c 6173 742e 5f6e 616d 652c   (cumlast._name,
+0001d880: 2069 202d 2031 290a 2020 2020 2020 2020   i - 1).        
+0001d890: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001d8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d8b0: 2020 2320 6167 6772 6567 6174 6520 7769    # aggregate wi
+0001d8c0: 7468 2070 7265 7669 6f75 7320 6375 6d75  th previous cumu
+0001d8d0: 6c61 7469 6f6e 2072 6573 756c 7473 0a20  lation results. 
 0001d8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d8f0: 2020 2020 2020 2863 756d 6c61 7374 2e5f        (cumlast._
-0001d900: 6e61 6d65 2c20 6920 2d20 3129 2c0a 2020  name, i - 1),.  
+0001d8f0: 2020 206c 6179 6572 5b28 636e 616d 652c     layer[(cname,
+0001d900: 2069 295d 203d 2028 0a20 2020 2020 2020   i)] = (.       
 0001d910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d920: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0001d930: 2020 2020 6c61 7965 725b 286e 616d 652c      layer[(name,
-0001d940: 2069 295d 203d 2028 6167 6772 6567 6174   i)] = (aggregat
-0001d950: 652c 2028 6375 6d70 6172 742e 5f6e 616d  e, (cumpart._nam
-0001d960: 652c 2069 292c 2028 636e 616d 652c 2069  e, i), (cname, i
-0001d970: 2929 0a20 2020 2020 2020 2020 2020 2067  )).            g
-0001d980: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
-0001d990: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-0001d9a0: 6374 696f 6e73 280a 2020 2020 2020 2020  ctions(.        
-0001d9b0: 2020 2020 2020 2020 6e61 6d65 2c20 6c61          name, la
-0001d9c0: 7965 722c 2064 6570 656e 6465 6e63 6965  yer, dependencie
-0001d9d0: 733d 5b63 756d 7061 7274 2c20 6375 6d6c  s=[cumpart, cuml
-0001d9e0: 6173 745d 0a20 2020 2020 2020 2020 2020  ast].           
-0001d9f0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
-0001da00: 6573 756c 7420 3d20 6e65 775f 6464 5f6f  esult = new_dd_o
-0001da10: 626a 6563 7428 6772 6170 682c 206e 616d  bject(graph, nam
-0001da20: 652c 2063 6875 6e6b 2873 656c 662e 5f6d  e, chunk(self._m
-0001da30: 6574 6129 2c20 7365 6c66 2e64 6976 6973  eta), self.divis
-0001da40: 696f 6e73 290a 2020 2020 2020 2020 2020  ions).          
-0001da50: 2020 7265 7475 726e 2068 616e 646c 655f    return handle_
-0001da60: 6f75 7428 6f75 742c 2072 6573 756c 7429  out(out, result)
-0001da70: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-0001da80: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-0001da90: 290a 2020 2020 6465 6620 6375 6d73 756d  ).    def cumsum
-0001daa0: 2873 656c 662c 2061 7869 733d 4e6f 6e65  (self, axis=None
-0001dab0: 2c20 736b 6970 6e61 3d54 7275 652c 2064  , skipna=True, d
-0001dac0: 7479 7065 3d4e 6f6e 652c 206f 7574 3d4e  type=None, out=N
-0001dad0: 6f6e 6529 3a0a 2020 2020 2020 2020 7265  one):.        re
-0001dae0: 7475 726e 2073 656c 662e 5f63 756d 5f61  turn self._cum_a
-0001daf0: 6767 280a 2020 2020 2020 2020 2020 2020  gg(.            
-0001db00: 2263 756d 7375 6d22 2c0a 2020 2020 2020  "cumsum",.      
-0001db10: 2020 2020 2020 6368 756e 6b3d 4d2e 6375        chunk=M.cu
-0001db20: 6d73 756d 2c0a 2020 2020 2020 2020 2020  msum,.          
-0001db30: 2020 6167 6772 6567 6174 653d 6d65 7468    aggregate=meth
-0001db40: 6f64 732e 6375 6d73 756d 5f61 6767 7265  ods.cumsum_aggre
-0001db50: 6761 7465 2c0a 2020 2020 2020 2020 2020  gate,.          
-0001db60: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
-0001db70: 2020 2020 2020 2020 2073 6b69 706e 613d           skipna=
-0001db80: 736b 6970 6e61 2c0a 2020 2020 2020 2020  skipna,.        
-0001db90: 2020 2020 6368 756e 6b5f 6b77 6172 6773      chunk_kwargs
-0001dba0: 3d64 6963 7428 6178 6973 3d61 7869 732c  =dict(axis=axis,
-0001dbb0: 2073 6b69 706e 613d 736b 6970 6e61 292c   skipna=skipna),
-0001dbc0: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
-0001dbd0: 3d6f 7574 2c0a 2020 2020 2020 2020 290a  =out,.        ).
-0001dbe0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-0001dbf0: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-0001dc00: 0a20 2020 2064 6566 2063 756d 7072 6f64  .    def cumprod
-0001dc10: 2873 656c 662c 2061 7869 733d 4e6f 6e65  (self, axis=None
-0001dc20: 2c20 736b 6970 6e61 3d54 7275 652c 2064  , skipna=True, d
-0001dc30: 7479 7065 3d4e 6f6e 652c 206f 7574 3d4e  type=None, out=N
-0001dc40: 6f6e 6529 3a0a 2020 2020 2020 2020 7265  one):.        re
-0001dc50: 7475 726e 2073 656c 662e 5f63 756d 5f61  turn self._cum_a
-0001dc60: 6767 280a 2020 2020 2020 2020 2020 2020  gg(.            
-0001dc70: 2263 756d 7072 6f64 222c 0a20 2020 2020  "cumprod",.     
-0001dc80: 2020 2020 2020 2063 6875 6e6b 3d4d 2e63         chunk=M.c
-0001dc90: 756d 7072 6f64 2c0a 2020 2020 2020 2020  umprod,.        
-0001dca0: 2020 2020 6167 6772 6567 6174 653d 6d65      aggregate=me
-0001dcb0: 7468 6f64 732e 6375 6d70 726f 645f 6167  thods.cumprod_ag
-0001dcc0: 6772 6567 6174 652c 0a20 2020 2020 2020  gregate,.       
-0001dcd0: 2020 2020 2061 7869 733d 6178 6973 2c0a       axis=axis,.
-0001dce0: 2020 2020 2020 2020 2020 2020 736b 6970              skip
-0001dcf0: 6e61 3d73 6b69 706e 612c 0a20 2020 2020  na=skipna,.     
-0001dd00: 2020 2020 2020 2063 6875 6e6b 5f6b 7761         chunk_kwa
-0001dd10: 7267 733d 6469 6374 2861 7869 733d 6178  rgs=dict(axis=ax
-0001dd20: 6973 2c20 736b 6970 6e61 3d73 6b69 706e  is, skipna=skipn
-0001dd30: 6129 2c0a 2020 2020 2020 2020 2020 2020  a),.            
-0001dd40: 6f75 743d 6f75 742c 0a20 2020 2020 2020  out=out,.       
-0001dd50: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
-0001dd60: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-0001dd70: 6d65 290a 2020 2020 6465 6620 6375 6d6d  me).    def cumm
-0001dd80: 6178 2873 656c 662c 2061 7869 733d 4e6f  ax(self, axis=No
-0001dd90: 6e65 2c20 736b 6970 6e61 3d54 7275 652c  ne, skipna=True,
-0001dda0: 206f 7574 3d4e 6f6e 6529 3a0a 2020 2020   out=None):.    
-0001ddb0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0001ddc0: 5f63 756d 5f61 6767 280a 2020 2020 2020  _cum_agg(.      
-0001ddd0: 2020 2020 2020 2263 756d 6d61 7822 2c0a        "cummax",.
-0001dde0: 2020 2020 2020 2020 2020 2020 6368 756e              chun
-0001ddf0: 6b3d 4d2e 6375 6d6d 6178 2c0a 2020 2020  k=M.cummax,.    
-0001de00: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
-0001de10: 653d 6d65 7468 6f64 732e 6375 6d6d 6178  e=methods.cummax
-0001de20: 5f61 6767 7265 6761 7465 2c0a 2020 2020  _aggregate,.    
-0001de30: 2020 2020 2020 2020 6178 6973 3d61 7869          axis=axi
-0001de40: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
-0001de50: 6b69 706e 613d 736b 6970 6e61 2c0a 2020  kipna=skipna,.  
-0001de60: 2020 2020 2020 2020 2020 6368 756e 6b5f            chunk_
-0001de70: 6b77 6172 6773 3d64 6963 7428 6178 6973  kwargs=dict(axis
-0001de80: 3d61 7869 732c 2073 6b69 706e 613d 736b  =axis, skipna=sk
-0001de90: 6970 6e61 292c 0a20 2020 2020 2020 2020  ipna),.         
-0001dea0: 2020 206f 7574 3d6f 7574 2c0a 2020 2020     out=out,.    
-0001deb0: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
-0001dec0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-0001ded0: 4672 616d 6529 0a20 2020 2064 6566 2063  Frame).    def c
-0001dee0: 756d 6d69 6e28 7365 6c66 2c20 6178 6973  ummin(self, axis
-0001def0: 3d4e 6f6e 652c 2073 6b69 706e 613d 5472  =None, skipna=Tr
-0001df00: 7565 2c20 6f75 743d 4e6f 6e65 293a 0a20  ue, out=None):. 
-0001df10: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0001df20: 6c66 2e5f 6375 6d5f 6167 6728 0a20 2020  lf._cum_agg(.   
-0001df30: 2020 2020 2020 2020 2022 6375 6d6d 696e           "cummin
-0001df40: 222c 0a20 2020 2020 2020 2020 2020 2063  ",.            c
-0001df50: 6875 6e6b 3d4d 2e63 756d 6d69 6e2c 0a20  hunk=M.cummin,. 
-0001df60: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
-0001df70: 6761 7465 3d6d 6574 686f 6473 2e63 756d  gate=methods.cum
-0001df80: 6d69 6e5f 6167 6772 6567 6174 652c 0a20  min_aggregate,. 
-0001df90: 2020 2020 2020 2020 2020 2061 7869 733d             axis=
-0001dfa0: 6178 6973 2c0a 2020 2020 2020 2020 2020  axis,.          
-0001dfb0: 2020 736b 6970 6e61 3d73 6b69 706e 612c    skipna=skipna,
-0001dfc0: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
-0001dfd0: 6e6b 5f6b 7761 7267 733d 6469 6374 2861  nk_kwargs=dict(a
-0001dfe0: 7869 733d 6178 6973 2c20 736b 6970 6e61  xis=axis, skipna
-0001dff0: 3d73 6b69 706e 6129 2c0a 2020 2020 2020  =skipna),.      
-0001e000: 2020 2020 2020 6f75 743d 6f75 742c 0a20        out=out,. 
-0001e010: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-0001e020: 6620 5f76 616c 6964 6174 655f 636f 6e64  f _validate_cond
-0001e030: 6974 696f 6e28 7365 6c66 2c20 636f 6e64  ition(self, cond
-0001e040: 293a 0a20 2020 2020 2020 2063 6f6e 645f  ):.        cond_
-0001e050: 7265 7320 3d20 636f 6e64 2873 656c 662e  res = cond(self.
-0001e060: 5f6d 6574 6129 2069 6620 6361 6c6c 6162  _meta) if callab
-0001e070: 6c65 2863 6f6e 6429 2065 6c73 6520 636f  le(cond) else co
-0001e080: 6e64 0a20 2020 2020 2020 2069 6620 6e6f  nd.        if no
-0001e090: 7420 280a 2020 2020 2020 2020 2020 2020  t (.            
-0001e0a0: 6973 5f64 6173 6b5f 636f 6c6c 6563 7469  is_dask_collecti
-0001e0b0: 6f6e 2863 6f6e 645f 7265 7329 0a20 2020  on(cond_res).   
-0001e0c0: 2020 2020 2020 2020 206f 7220 6973 5f64           or is_d
-0001e0d0: 6174 6166 7261 6d65 5f6c 696b 6528 636f  ataframe_like(co
-0001e0e0: 6e64 5f72 6573 290a 2020 2020 2020 2020  nd_res).        
-0001e0f0: 2020 2020 6f72 2069 735f 7365 7269 6573      or is_series
-0001e100: 5f6c 696b 6528 636f 6e64 5f72 6573 290a  _like(cond_res).
-0001e110: 2020 2020 2020 2020 2020 2020 6f72 2069              or i
-0001e120: 735f 696e 6465 785f 6c69 6b65 2863 6f6e  s_index_like(con
-0001e130: 645f 7265 7329 0a20 2020 2020 2020 2029  d_res).        )
-0001e140: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0001e150: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-0001e160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e170: 6622 436f 6e64 6974 696f 6e20 7368 6f75  f"Condition shou
-0001e180: 6c64 2062 6520 616e 206f 626a 6563 7420  ld be an object 
-0001e190: 7468 6174 2063 616e 2062 6520 616c 6967  that can be alig
-0001e1a0: 6e65 6420 7769 7468 207b 7365 6c66 2e5f  ned with {self._
-0001e1b0: 5f63 6c61 7373 5f5f 7d2c 2022 0a20 2020  _class__}, ".   
-0001e1c0: 2020 2020 2020 2020 2020 2020 2066 2220               f" 
-0001e1d0: 7768 6963 6820 696e 636c 7564 6573 2044  which includes D
-0001e1e0: 6173 6b20 6f72 2070 616e 6461 7320 636f  ask or pandas co
-0001e1f0: 6c6c 6563 7469 6f6e 732c 2044 6174 6146  llections, DataF
-0001e200: 7261 6d65 7320 6f72 2053 6572 6965 732c  rames or Series,
-0001e210: 206f 7220 6120 4361 6c6c 6162 6c65 2e22   or a Callable."
-0001e220: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-0001e230: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-0001e240: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-0001e250: 2020 2020 6465 6620 7768 6572 6528 7365      def where(se
-0001e260: 6c66 2c20 636f 6e64 2c20 6f74 6865 723d  lf, cond, other=
-0001e270: 6e70 2e6e 616e 293a 0a20 2020 2020 2020  np.nan):.       
-0001e280: 2023 2063 6f6e 6420 616e 6420 6f74 6865   # cond and othe
-0001e290: 7220 6d61 7920 6265 2064 6173 6b20 696e  r may be dask in
-0001e2a0: 7374 616e 6365 2c0a 2020 2020 2020 2020  stance,.        
-0001e2b0: 2320 7061 7373 696e 6720 6d61 705f 7061  # passing map_pa
-0001e2c0: 7274 6974 696f 6e73 2076 6961 206b 6579  rtitions via key
-0001e2d0: 776f 7264 2077 696c 6c20 6e6f 7420 6265  word will not be
-0001e2e0: 2061 6c69 676e 6564 0a20 2020 2020 2020   aligned.       
-0001e2f0: 2073 656c 662e 5f76 616c 6964 6174 655f   self._validate_
-0001e300: 636f 6e64 6974 696f 6e28 636f 6e64 290a  condition(cond).
-0001e310: 2020 2020 2020 2020 7265 7475 726e 206d          return m
-0001e320: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
-0001e330: 7768 6572 652c 2073 656c 662c 2063 6f6e  where, self, con
-0001e340: 642c 206f 7468 6572 2c20 656e 666f 7263  d, other, enforc
-0001e350: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
-0001e360: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-0001e370: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-0001e380: 6529 0a20 2020 2064 6566 206d 6173 6b28  e).    def mask(
-0001e390: 7365 6c66 2c20 636f 6e64 2c20 6f74 6865  self, cond, othe
-0001e3a0: 723d 6e70 2e6e 616e 293a 0a20 2020 2020  r=np.nan):.     
-0001e3b0: 2020 2073 656c 662e 5f76 616c 6964 6174     self._validat
-0001e3c0: 655f 636f 6e64 6974 696f 6e28 636f 6e64  e_condition(cond
-0001e3d0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0001e3e0: 206d 6170 5f70 6172 7469 7469 6f6e 7328   map_partitions(
-0001e3f0: 4d2e 6d61 736b 2c20 7365 6c66 2c20 636f  M.mask, self, co
-0001e400: 6e64 2c20 6f74 6865 722c 2065 6e66 6f72  nd, other, enfor
-0001e410: 6365 5f6d 6574 6164 6174 613d 4661 6c73  ce_metadata=Fals
-0001e420: 6529 0a0a 2020 2020 4064 6572 6976 6564  e)..    @derived
-0001e430: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-0001e440: 6d65 290a 2020 2020 6465 6620 6e6f 746e  me).    def notn
-0001e450: 756c 6c28 7365 6c66 293a 0a20 2020 2020  ull(self):.     
-0001e460: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-0001e470: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
-0001e480: 6e6f 746e 756c 6c2c 2065 6e66 6f72 6365  notnull, enforce
-0001e490: 5f6d 6574 6164 6174 613d 4661 6c73 6529  _metadata=False)
-0001e4a0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-0001e4b0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-0001e4c0: 290a 2020 2020 6465 6620 6973 6e75 6c6c  ).    def isnull
-0001e4d0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0001e4e0: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
-0001e4f0: 7061 7274 6974 696f 6e73 284d 2e69 736e  partitions(M.isn
-0001e500: 756c 6c2c 2065 6e66 6f72 6365 5f6d 6574  ull, enforce_met
-0001e510: 6164 6174 613d 4661 6c73 6529 0a0a 2020  adata=False)..  
-0001e520: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-0001e530: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-0001e540: 2020 6465 6620 6973 6e61 2873 656c 6629    def isna(self)
-0001e550: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0001e560: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-0001e570: 696f 6e73 284d 2e69 736e 612c 2065 6e66  ions(M.isna, enf
-0001e580: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
-0001e590: 6c73 6529 0a0a 2020 2020 4064 6572 6976  lse)..    @deriv
-0001e5a0: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-0001e5b0: 7261 6d65 290a 2020 2020 6465 6620 6973  rame).    def is
-0001e5c0: 696e 2873 656c 662c 2076 616c 7565 7329  in(self, values)
-0001e5d0: 3a0a 2020 2020 2020 2020 6966 2069 735f  :.        if is_
-0001e5e0: 6461 7461 6672 616d 655f 6c69 6b65 2873  dataframe_like(s
-0001e5f0: 656c 662e 5f6d 6574 6129 3a0a 2020 2020  elf._meta):.    
-0001e600: 2020 2020 2020 2020 2320 4461 7461 4672          # DataFr
-0001e610: 616d 652e 6973 696e 2064 6f65 7320 7765  ame.isin does we
-0001e620: 6972 6420 616c 6967 6e6d 656e 7420 7374  ird alignment st
-0001e630: 7566 660a 2020 2020 2020 2020 2020 2020  uff.            
-0001e640: 6261 645f 7479 7065 7320 3d20 285f 4672  bad_types = (_Fr
-0001e650: 616d 652c 2070 642e 5365 7269 6573 2c20  ame, pd.Series, 
-0001e660: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-0001e670: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001e680: 2020 2020 2020 2020 6261 645f 7479 7065          bad_type
-0001e690: 7320 3d20 285f 4672 616d 652c 290a 2020  s = (_Frame,).  
-0001e6a0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0001e6b0: 6e63 6528 7661 6c75 6573 2c20 6261 645f  nce(values, bad_
-0001e6c0: 7479 7065 7329 3a0a 2020 2020 2020 2020  types):.        
-0001e6d0: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-0001e6e0: 6c65 6d65 6e74 6564 4572 726f 7228 2250  lementedError("P
-0001e6f0: 6173 7369 6e67 2061 2025 7220 746f 2060  assing a %r to `
-0001e700: 6973 696e 6022 2025 2074 7970 656e 616d  isin`" % typenam
-0001e710: 6528 7479 7065 2876 616c 7565 7329 2929  e(type(values)))
-0001e720: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
-0001e730: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
-0001e740: 7074 792e 6973 696e 2876 616c 7565 7329  pty.isin(values)
-0001e750: 0a20 2020 2020 2020 2023 2057 6520 7772  .        # We wr
-0001e760: 6170 2076 616c 7565 7320 696e 2061 2064  ap values in a d
-0001e770: 656c 6179 6564 2066 6f72 2074 776f 2072  elayed for two r
-0001e780: 6561 736f 6e73 3a0a 2020 2020 2020 2020  easons:.        
-0001e790: 2320 2d20 6176 6f69 6420 7365 7269 616c  # - avoid serial
-0001e7a0: 697a 696e 6720 6461 7461 2069 6e20 6576  izing data in ev
-0001e7b0: 6572 7920 7461 736b 0a20 2020 2020 2020  ery task.       
-0001e7c0: 2023 202d 2061 766f 6964 2063 6f73 7420   # - avoid cost 
-0001e7d0: 6f66 2074 7261 7665 7273 616c 206f 6620  of traversal of 
-0001e7e0: 6c61 7267 6520 6c69 7374 2069 6e20 6f70  large list in op
-0001e7f0: 7469 6d69 7a61 7469 6f6e 730a 2020 2020  timizations.    
-0001e800: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0001e810: 6528 7661 6c75 6573 2c20 6c69 7374 293a  e(values, list):
-0001e820: 0a20 2020 2020 2020 2020 2020 2023 204d  .            # M
-0001e830: 6f74 6976 6174 6564 2062 7920 6874 7470  otivated by http
-0001e840: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f64  s://github.com/d
-0001e850: 6173 6b2f 6461 736b 2f69 7373 7565 732f  ask/dask/issues/
-0001e860: 3934 3131 2e20 2054 6869 7320 6170 7065  9411.  This appe
-0001e870: 6172 7320 746f 2062 650a 2020 2020 2020  ars to be.      
-0001e880: 2020 2020 2020 2320 6361 7573 6564 2062        # caused b
-0001e890: 7920 6874 7470 733a 2f2f 6769 7468 7562  y https://github
-0001e8a0: 2e63 6f6d 2f64 6173 6b2f 6469 7374 7269  .com/dask/distri
-0001e8b0: 6275 7465 642f 6973 7375 6573 2f36 3336  buted/issues/636
-0001e8c0: 382c 2061 6e64 2066 7572 7468 6572 0a20  8, and further. 
-0001e8d0: 2020 2020 2020 2020 2020 2023 2065 7861             # exa
-0001e8e0: 6365 7262 6174 6564 2062 7920 7468 6520  cerbated by the 
-0001e8f0: 6661 6374 2074 6861 7420 7468 6520 6c69  fact that the li
-0001e900: 7374 2063 6f6e 7461 696e 7320 6475 706c  st contains dupl
-0001e910: 6963 6174 6573 2e20 2054 6869 7320 6973  icates.  This is
-0001e920: 2061 2070 6174 6368 2075 6e74 696c 0a20   a patch until. 
-0001e930: 2020 2020 2020 2020 2020 2023 2077 6520             # we 
-0001e940: 6361 6e20 6372 6561 7465 2061 2062 6574  can create a bet
-0001e950: 7465 7220 6669 7820 666f 7220 5365 7269  ter fix for Seri
-0001e960: 616c 697a 6174 696f 6e2e 0a20 2020 2020  alization..     
-0001e970: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-0001e980: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-0001e990: 6573 203d 206c 6973 7428 7365 7428 7661  es = list(set(va
-0001e9a0: 6c75 6573 2929 0a20 2020 2020 2020 2020  lues)).         
-0001e9b0: 2020 2065 7863 6570 7420 5479 7065 4572     except TypeEr
-0001e9c0: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
-0001e9d0: 2020 2020 2070 6173 730a 2020 2020 2020       pass.      
-0001e9e0: 2020 2020 2020 6966 206e 6f74 2061 6e79        if not any
-0001e9f0: 2869 735f 6461 736b 5f63 6f6c 6c65 6374  (is_dask_collect
-0001ea00: 696f 6e28 7629 2066 6f72 2076 2069 6e20  ion(v) for v in 
-0001ea10: 7661 6c75 6573 293a 0a20 2020 2020 2020  values):.       
-0001ea20: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-0001ea30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ea40: 2020 7661 6c75 6573 203d 206e 702e 6672    values = np.fr
-0001ea50: 6f6d 6974 6572 2876 616c 7565 732c 2064  omiter(values, d
-0001ea60: 7479 7065 3d6f 626a 6563 7429 0a20 2020  type=object).   
-0001ea70: 2020 2020 2020 2020 2020 2020 2065 7863               exc
-0001ea80: 6570 7420 5661 6c75 6545 7272 6f72 3a0a  ept ValueError:.
-0001ea90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eaa0: 2020 2020 2320 4e75 6d70 7920 312e 3233      # Numpy 1.23
-0001eab0: 2073 7570 706f 7274 7320 6372 6561 7469   supports creati
-0001eac0: 6e67 2061 7272 6179 7320 6f66 2069 7465  ng arrays of ite
-0001ead0: 7261 626c 6573 2c20 7768 696c 6520 6c6f  rables, while lo
-0001eae0: 7765 720a 2020 2020 2020 2020 2020 2020  wer.            
-0001eaf0: 2020 2020 2020 2020 2320 7665 7273 696f          # versio
-0001eb00: 6e20 312e 3231 2e78 2061 6e64 2031 2e32  n 1.21.x and 1.2
-0001eb10: 322e 7820 646f 206e 6f74 0a20 2020 2020  2.x do not.     
-0001eb20: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0001eb30: 6173 730a 2020 2020 2020 2020 7265 7475  ass.        retu
-0001eb40: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
-0001eb50: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
-0001eb60: 2020 2020 4d2e 6973 696e 2c20 6465 6c61      M.isin, dela
-0001eb70: 7965 6428 7661 6c75 6573 292c 206d 6574  yed(values), met
-0001eb80: 613d 6d65 7461 2c20 656e 666f 7263 655f  a=meta, enforce_
-0001eb90: 6d65 7461 6461 7461 3d46 616c 7365 0a20  metadata=False. 
-0001eba0: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
-0001ebb0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
-0001ebc0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
-0001ebd0: 6620 6173 7479 7065 2873 656c 662c 2064  f astype(self, d
-0001ebe0: 7479 7065 293a 0a20 2020 2020 2020 206d  type):.        m
-0001ebf0: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
-0001ec00: 2e61 7374 7970 6528 6474 7970 6529 0a20  .astype(dtype). 
-0001ec10: 2020 2020 2020 2069 6620 6861 7361 7474         if hasatt
-0001ec20: 7228 6474 7970 652c 2022 6974 656d 7322  r(dtype, "items"
-0001ec30: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-0001ec40: 6574 5f75 6e6b 6e6f 776e 203d 205b 0a20  et_unknown = [. 
-0001ec50: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-0001ec60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ec70: 2066 6f72 206b 2c20 7620 696e 2064 7479   for k, v in dty
-0001ec80: 7065 2e69 7465 6d73 2829 0a20 2020 2020  pe.items().     
-0001ec90: 2020 2020 2020 2020 2020 2069 6620 2869             if (i
-0001eca0: 7369 6e73 7461 6e63 6528 7064 2e61 7069  sinstance(pd.api
-0001ecb0: 2e74 7970 6573 2e70 616e 6461 735f 6474  .types.pandas_dt
-0001ecc0: 7970 6528 7629 2c20 7064 2e43 6174 6567  ype(v), pd.Categ
-0001ecd0: 6f72 6963 616c 4474 7970 6529 290a 2020  oricalDtype)).  
-0001ece0: 2020 2020 2020 2020 2020 2020 2020 616e                an
-0001ecf0: 6420 6765 7461 7474 7228 762c 2022 6361  d getattr(v, "ca
-0001ed00: 7465 676f 7269 6573 222c 204e 6f6e 6529  tegories", None)
-0001ed10: 2069 7320 4e6f 6e65 0a20 2020 2020 2020   is None.       
-0001ed20: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-0001ed30: 2020 206d 6574 6120 3d20 636c 6561 725f     meta = clear_
-0001ed40: 6b6e 6f77 6e5f 6361 7465 676f 7269 6573  known_categories
-0001ed50: 286d 6574 612c 2063 6f6c 733d 7365 745f  (meta, cols=set_
-0001ed60: 756e 6b6e 6f77 6e29 0a20 2020 2020 2020  unknown).       
-0001ed70: 2065 6c69 6620 280a 2020 2020 2020 2020   elif (.        
-0001ed80: 2020 2020 6973 696e 7374 616e 6365 2870      isinstance(p
-0001ed90: 642e 6170 692e 7479 7065 732e 7061 6e64  d.api.types.pand
-0001eda0: 6173 5f64 7479 7065 2864 7479 7065 292c  as_dtype(dtype),
-0001edb0: 2070 642e 4361 7465 676f 7269 6361 6c44   pd.CategoricalD
-0001edc0: 7479 7065 290a 2020 2020 2020 2020 2920  type).        ) 
-0001edd0: 616e 6420 6765 7461 7474 7228 6474 7970  and getattr(dtyp
-0001ede0: 652c 2022 6361 7465 676f 7269 6573 222c  e, "categories",
-0001edf0: 204e 6f6e 6529 2069 7320 4e6f 6e65 3a0a   None) is None:.
-0001ee00: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-0001ee10: 203d 2063 6c65 6172 5f6b 6e6f 776e 5f63   = clear_known_c
-0001ee20: 6174 6567 6f72 6965 7328 6d65 7461 290a  ategories(meta).
-0001ee30: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0001ee40: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-0001ee50: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
-0001ee60: 4d2e 6173 7479 7065 2c20 6474 7970 653d  M.astype, dtype=
-0001ee70: 6474 7970 652c 206d 6574 613d 6d65 7461  dtype, meta=meta
-0001ee80: 2c20 656e 666f 7263 655f 6d65 7461 6461  , enforce_metada
-0001ee90: 7461 3d46 616c 7365 0a20 2020 2020 2020  ta=False.       
-0001eea0: 2029 0a0a 2020 2020 6966 206e 6f74 2050   )..    if not P
-0001eeb0: 414e 4441 535f 4754 5f32 3030 3a0a 0a20  ANDAS_GT_200:.. 
-0001eec0: 2020 2020 2020 2040 6465 7269 7665 645f         @derived_
-0001eed0: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
-0001eee0: 2020 2020 2020 2020 6465 6620 6170 7065          def appe
-0001eef0: 6e64 2873 656c 662c 206f 7468 6572 2c20  nd(self, other, 
-0001ef00: 696e 7465 726c 6561 7665 5f70 6172 7469  interleave_parti
-0001ef10: 7469 6f6e 733d 4661 6c73 6529 3a0a 2020  tions=False):.  
-0001ef20: 2020 2020 2020 2020 2020 6966 2050 414e            if PAN
-0001ef30: 4441 535f 4754 5f31 3430 3a0a 2020 2020  DAS_GT_140:.    
-0001ef40: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-0001ef50: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
-0001ef60: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001ef70: 5468 6520 6672 616d 652e 6170 7065 6e64  The frame.append
-0001ef80: 206d 6574 686f 6420 6973 2064 6570 7265   method is depre
-0001ef90: 6361 7465 6420 616e 6420 7769 6c6c 2062  cated and will b
-0001efa0: 6520 7265 6d6f 7665 6420 6672 6f6d 220a  e removed from".
-0001efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001efc0: 2020 2020 2264 6173 6b20 696e 2061 2066      "dask in a f
-0001efd0: 7574 7572 6520 7665 7273 696f 6e2e 2055  uture version. U
-0001efe0: 7365 2064 6173 6b2e 6461 7461 6672 616d  se dask.datafram
-0001eff0: 652e 636f 6e63 6174 2069 6e73 7465 6164  e.concat instead
-0001f000: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
-0001f010: 2020 2020 2020 2020 4675 7475 7265 5761          FutureWa
-0001f020: 726e 696e 672c 0a20 2020 2020 2020 2020  rning,.         
-0001f030: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001f040: 2020 2020 2023 2062 6563 6175 7365 2044       # because D
-0001f050: 6174 6146 7261 6d65 2e61 7070 656e 6420  ataFrame.append 
-0001f060: 7769 6c6c 206f 7665 7272 6964 6520 7468  will override th
-0001f070: 6520 6d65 7468 6f64 2c0a 2020 2020 2020  e method,.      
-0001f080: 2020 2020 2020 2320 7772 6170 2062 7920        # wrap by 
-0001f090: 7064 2e53 6572 6965 732e 6170 7065 6e64  pd.Series.append
-0001f0a0: 2064 6f63 7374 7269 6e67 0a20 2020 2020   docstring.     
-0001f0b0: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-0001f0c0: 2e64 6174 6166 7261 6d65 2e6d 756c 7469  .dataframe.multi
-0001f0d0: 2069 6d70 6f72 7420 636f 6e63 6174 0a0a   import concat..
-0001f0e0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0001f0f0: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
-0001f100: 2028 6c69 7374 2c20 6469 6374 2929 3a0a   (list, dict)):.
-0001f110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f120: 6d73 6720 3d20 2261 7070 656e 6420 646f  msg = "append do
-0001f130: 6573 6e27 7420 7375 7070 6f72 7420 6c69  esn't support li
-0001f140: 7374 206f 7220 6469 6374 2069 6e70 7574  st or dict input
-0001f150: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0001f160: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
-0001f170: 6d65 6e74 6564 4572 726f 7228 6d73 6729  mentedError(msg)
-0001f180: 0a0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-0001f190: 7475 726e 2063 6f6e 6361 7428 0a20 2020  turn concat(.   
-0001f1a0: 2020 2020 2020 2020 2020 2020 205b 7365               [se
-0001f1b0: 6c66 2c20 6f74 6865 725d 2c20 6a6f 696e  lf, other], join
-0001f1c0: 3d22 6f75 7465 7222 2c20 696e 7465 726c  ="outer", interl
-0001f1d0: 6561 7665 5f70 6172 7469 7469 6f6e 733d  eave_partitions=
-0001f1e0: 696e 7465 726c 6561 7665 5f70 6172 7469  interleave_parti
-0001f1f0: 7469 6f6e 730a 2020 2020 2020 2020 2020  tions.          
-0001f200: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
-0001f210: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
-0001f220: 290a 2020 2020 6465 6620 646f 7428 7365  ).    def dot(se
-0001f230: 6c66 2c20 6f74 6865 722c 206d 6574 613d  lf, other, meta=
-0001f240: 6e6f 5f64 6566 6175 6c74 293a 0a20 2020  no_default):.   
-0001f250: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-0001f260: 7374 616e 6365 286f 7468 6572 2c20 5f46  stance(other, _F
-0001f270: 7261 6d65 293a 0a20 2020 2020 2020 2020  rame):.         
-0001f280: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-0001f290: 6f72 2822 5468 6520 7365 636f 6e64 206f  or("The second o
-0001f2a0: 7065 7261 6e64 206d 7573 7420 6265 2061  perand must be a
-0001f2b0: 2064 6173 6b20 6172 7261 7920 6f72 2064   dask array or d
-0001f2c0: 6173 6b20 6461 7461 6672 616d 6522 290a  ask dataframe").
-0001f2d0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0001f2e0: 7374 616e 6365 286f 7468 6572 2c20 4461  stance(other, Da
-0001f2f0: 7461 4672 616d 6529 3a0a 2020 2020 2020  taFrame):.      
-0001f300: 2020 2020 2020 7320 3d20 7365 6c66 2e6d        s = self.m
-0001f310: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
-0001f320: 646f 742c 206f 7468 6572 2c20 746f 6b65  dot, other, toke
-0001f330: 6e3d 2264 6f74 222c 206d 6574 613d 6d65  n="dot", meta=me
-0001f340: 7461 290a 2020 2020 2020 2020 2020 2020  ta).            
-0001f350: 7265 7475 726e 2073 2e67 726f 7570 6279  return s.groupby
-0001f360: 2862 793d 732e 696e 6465 7829 2e61 7070  (by=s.index).app
-0001f370: 6c79 280a 2020 2020 2020 2020 2020 2020  ly(.            
-0001f380: 2020 2020 6c61 6d62 6461 2078 3a20 782e      lambda x: x.
-0001f390: 7375 6d28 736b 6970 6e61 3d46 616c 7365  sum(skipna=False
-0001f3a0: 292c 206d 6574 613d 732e 5f6d 6574 615f  ), meta=s._meta_
-0001f3b0: 6e6f 6e65 6d70 7479 0a20 2020 2020 2020  nonempty.       
-0001f3c0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0001f3d0: 6465 6620 5f64 6f74 5f73 6572 6965 7328  def _dot_series(
-0001f3e0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-0001f3f0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-0001f400: 2e73 756d 2829 2069 7320 696e 766f 6b65  .sum() is invoke
-0001f410: 6420 6f6e 2065 6163 6820 7061 7274 6974  d on each partit
-0001f420: 696f 6e20 6265 666f 7265 2062 6569 6e67  ion before being
-0001f430: 2061 7070 6c69 6564 2074 6f20 616c 6c0a   applied to all.
-0001f440: 2020 2020 2020 2020 2020 2020 2320 7061              # pa
-0001f450: 7274 6974 696f 6e73 2e20 5468 6520 7265  rtitions. The re
-0001f460: 7475 726e 2074 7970 6520 6973 2065 7870  turn type is exp
-0001f470: 6563 7465 6420 746f 2062 6520 6120 7365  ected to be a se
-0001f480: 7269 6573 2c20 6e6f 7420 6120 6e75 6d70  ries, not a nump
-0001f490: 7920 6f62 6a65 6374 0a20 2020 2020 2020  y object.       
-0001f4a0: 2020 2020 2072 6574 7572 6e20 6d65 7461       return meta
-0001f4b0: 5f73 6572 6965 735f 636f 6e73 7472 7563  _series_construc
-0001f4c0: 746f 7228 7365 6c66 2928 4d2e 646f 7428  tor(self)(M.dot(
-0001f4d0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-0001f4e0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-0001f4f0: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
-0001f500: 7469 6f6e 7328 5f64 6f74 5f73 6572 6965  tions(_dot_serie
-0001f510: 732c 206f 7468 6572 2c20 746f 6b65 6e3d  s, other, token=
-0001f520: 2264 6f74 222c 206d 6574 613d 6d65 7461  "dot", meta=meta
-0001f530: 292e 7375 6d28 0a20 2020 2020 2020 2020  ).sum(.         
-0001f540: 2020 2073 6b69 706e 613d 4661 6c73 650a     skipna=False.
-0001f550: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-0001f560: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0001f570: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0001f580: 6566 2061 6c69 676e 2873 656c 662c 206f  ef align(self, o
-0001f590: 7468 6572 2c20 6a6f 696e 3d22 6f75 7465  ther, join="oute
-0001f5a0: 7222 2c20 6178 6973 3d4e 6f6e 652c 2066  r", axis=None, f
-0001f5b0: 696c 6c5f 7661 6c75 653d 4e6f 6e65 293a  ill_value=None):
-0001f5c0: 0a20 2020 2020 2020 206d 6574 6131 2c20  .        meta1, 
-0001f5d0: 6d65 7461 3220 3d20 5f65 6d75 6c61 7465  meta2 = _emulate
-0001f5e0: 280a 2020 2020 2020 2020 2020 2020 4d2e  (.            M.
-0001f5f0: 616c 6967 6e2c 2073 656c 662c 206f 7468  align, self, oth
-0001f600: 6572 2c20 6a6f 696e 2c20 6178 6973 3d61  er, join, axis=a
-0001f610: 7869 732c 2066 696c 6c5f 7661 6c75 653d  xis, fill_value=
-0001f620: 6669 6c6c 5f76 616c 7565 0a20 2020 2020  fill_value.     
-0001f630: 2020 2029 0a20 2020 2020 2020 2061 6c69     ).        ali
-0001f640: 676e 6564 203d 2073 656c 662e 6d61 705f  gned = self.map_
-0001f650: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
-0001f660: 2020 2020 2020 2020 4d2e 616c 6967 6e2c          M.align,
-0001f670: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
-0001f680: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
-0001f690: 6a6f 696e 3d6a 6f69 6e2c 0a20 2020 2020  join=join,.     
-0001f6a0: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
-0001f6b0: 2c0a 2020 2020 2020 2020 2020 2020 6669  ,.            fi
-0001f6c0: 6c6c 5f76 616c 7565 3d66 696c 6c5f 7661  ll_value=fill_va
-0001f6d0: 6c75 652c 0a20 2020 2020 2020 2020 2020  lue,.           
-0001f6e0: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
-0001f6f0: 613d 4661 6c73 652c 0a20 2020 2020 2020  a=False,.       
-0001f700: 2029 0a0a 2020 2020 2020 2020 746f 6b65   )..        toke
-0001f710: 6e20 3d20 746f 6b65 6e69 7a65 2873 656c  n = tokenize(sel
-0001f720: 662c 206f 7468 6572 2c20 6a6f 696e 2c20  f, other, join, 
-0001f730: 6178 6973 2c20 6669 6c6c 5f76 616c 7565  axis, fill_value
-0001f740: 290a 0a20 2020 2020 2020 206e 616d 6531  )..        name1
-0001f750: 203d 2022 616c 6967 6e31 2d22 202b 2074   = "align1-" + t
-0001f760: 6f6b 656e 0a20 2020 2020 2020 2064 736b  oken.        dsk
-0001f770: 3120 3d20 7b0a 2020 2020 2020 2020 2020  1 = {.          
-0001f780: 2020 286e 616d 6531 2c20 6929 3a20 2867    (name1, i): (g
-0001f790: 6574 6974 656d 2c20 6b65 792c 2030 290a  etitem, key, 0).
-0001f7a0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0001f7b0: 692c 206b 6579 2069 6e20 656e 756d 6572  i, key in enumer
-0001f7c0: 6174 6528 616c 6967 6e65 642e 5f5f 6461  ate(aligned.__da
-0001f7d0: 736b 5f6b 6579 735f 5f28 2929 0a20 2020  sk_keys__()).   
-0001f7e0: 2020 2020 207d 0a20 2020 2020 2020 2064       }.        d
-0001f7f0: 736b 312e 7570 6461 7465 2861 6c69 676e  sk1.update(align
-0001f800: 6564 2e64 6173 6b29 0a20 2020 2020 2020  ed.dask).       
-0001f810: 2072 6573 756c 7431 203d 206e 6577 5f64   result1 = new_d
-0001f820: 645f 6f62 6a65 6374 2864 736b 312c 206e  d_object(dsk1, n
-0001f830: 616d 6531 2c20 6d65 7461 312c 2061 6c69  ame1, meta1, ali
-0001f840: 676e 6564 2e64 6976 6973 696f 6e73 290a  gned.divisions).
-0001f850: 0a20 2020 2020 2020 206e 616d 6532 203d  .        name2 =
-0001f860: 2022 616c 6967 6e32 2d22 202b 2074 6f6b   "align2-" + tok
-0001f870: 656e 0a20 2020 2020 2020 2064 736b 3220  en.        dsk2 
-0001f880: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-0001f890: 286e 616d 6532 2c20 6929 3a20 2867 6574  (name2, i): (get
-0001f8a0: 6974 656d 2c20 6b65 792c 2031 290a 2020  item, key, 1).  
-0001f8b0: 2020 2020 2020 2020 2020 666f 7220 692c            for i,
-0001f8c0: 206b 6579 2069 6e20 656e 756d 6572 6174   key in enumerat
-0001f8d0: 6528 616c 6967 6e65 642e 5f5f 6461 736b  e(aligned.__dask
-0001f8e0: 5f6b 6579 735f 5f28 2929 0a20 2020 2020  _keys__()).     
-0001f8f0: 2020 207d 0a20 2020 2020 2020 2064 736b     }.        dsk
-0001f900: 322e 7570 6461 7465 2861 6c69 676e 6564  2.update(aligned
-0001f910: 2e64 6173 6b29 0a20 2020 2020 2020 2072  .dask).        r
-0001f920: 6573 756c 7432 203d 206e 6577 5f64 645f  esult2 = new_dd_
-0001f930: 6f62 6a65 6374 2864 736b 322c 206e 616d  object(dsk2, nam
-0001f940: 6532 2c20 6d65 7461 322c 2061 6c69 676e  e2, meta2, align
-0001f950: 6564 2e64 6976 6973 696f 6e73 290a 0a20  ed.divisions).. 
-0001f960: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-0001f970: 7375 6c74 312c 2072 6573 756c 7432 0a0a  sult1, result2..
-0001f980: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-0001f990: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-0001f9a0: 2020 2020 6465 6620 636f 6d62 696e 6528      def combine(
-0001f9b0: 7365 6c66 2c20 6f74 6865 722c 2066 756e  self, other, fun
-0001f9c0: 632c 2066 696c 6c5f 7661 6c75 653d 4e6f  c, fill_value=No
-0001f9d0: 6e65 2c20 6f76 6572 7772 6974 653d 5472  ne, overwrite=Tr
-0001f9e0: 7565 293a 0a20 2020 2020 2020 2072 6574  ue):.        ret
-0001f9f0: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
-0001fa00: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
-0001fa10: 2020 2020 204d 2e63 6f6d 6269 6e65 2c20       M.combine, 
-0001fa20: 6f74 6865 722c 2066 756e 632c 2066 696c  other, func, fil
-0001fa30: 6c5f 7661 6c75 653d 6669 6c6c 5f76 616c  l_value=fill_val
-0001fa40: 7565 2c20 6f76 6572 7772 6974 653d 6f76  ue, overwrite=ov
-0001fa50: 6572 7772 6974 650a 2020 2020 2020 2020  erwrite.        
-0001fa60: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-0001fa70: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-0001fa80: 6529 0a20 2020 2064 6566 2063 6f6d 6269  e).    def combi
-0001fa90: 6e65 5f66 6972 7374 2873 656c 662c 206f  ne_first(self, o
-0001faa0: 7468 6572 293a 0a20 2020 2020 2020 2072  ther):.        r
-0001fab0: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
-0001fac0: 6172 7469 7469 6f6e 7328 4d2e 636f 6d62  artitions(M.comb
-0001fad0: 696e 655f 6669 7273 742c 206f 7468 6572  ine_first, other
-0001fae0: 290a 0a20 2020 2040 636c 6173 736d 6574  )..    @classmet
-0001faf0: 686f 640a 2020 2020 6465 6620 5f62 696e  hod.    def _bin
-0001fb00: 645f 6f70 6572 6174 6f72 5f6d 6574 686f  d_operator_metho
-0001fb10: 6428 636c 732c 206e 616d 652c 206f 702c  d(cls, name, op,
-0001fb20: 206f 7269 6769 6e61 6c3d 7064 2e44 6174   original=pd.Dat
-0001fb30: 6146 7261 6d65 293a 0a20 2020 2020 2020  aFrame):.       
-0001fb40: 2022 2222 6269 6e64 206f 7065 7261 746f   """bind operato
-0001fb50: 7220 6d65 7468 6f64 206c 696b 6520 4461  r method like Da
-0001fb60: 7461 4672 616d 652e 6164 6420 746f 2074  taFrame.add to t
-0001fb70: 6869 7320 636c 6173 7322 2222 0a20 2020  his class""".   
-0001fb80: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
-0001fb90: 706c 656d 656e 7465 6445 7272 6f72 0a0a  plementedError..
-0001fba0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-0001fbb0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-0001fbc0: 2020 2020 6465 6620 7265 7361 6d70 6c65      def resample
-0001fbd0: 2873 656c 662c 2072 756c 652c 2063 6c6f  (self, rule, clo
-0001fbe0: 7365 643d 4e6f 6e65 2c20 6c61 6265 6c3d  sed=None, label=
-0001fbf0: 4e6f 6e65 293a 0a20 2020 2020 2020 2066  None):.        f
-0001fc00: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-0001fc10: 6d65 2e74 7365 7269 6573 2e72 6573 616d  me.tseries.resam
-0001fc20: 706c 6520 696d 706f 7274 2052 6573 616d  ple import Resam
-0001fc30: 706c 6572 0a0a 2020 2020 2020 2020 7265  pler..        re
-0001fc40: 7475 726e 2052 6573 616d 706c 6572 2873  turn Resampler(s
-0001fc50: 656c 662c 2072 756c 652c 2063 6c6f 7365  elf, rule, close
-0001fc60: 643d 636c 6f73 6564 2c20 6c61 6265 6c3d  d=closed, label=
-0001fc70: 6c61 6265 6c29 0a0a 2020 2020 4064 6572  label)..    @der
-0001fc80: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-0001fc90: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-0001fca0: 6669 7273 7428 7365 6c66 2c20 6f66 6673  first(self, offs
-0001fcb0: 6574 293a 0a20 2020 2020 2020 2023 204c  et):.        # L
-0001fcc0: 6574 2070 616e 6461 7320 6572 726f 7220  et pandas error 
-0001fcd0: 6f6e 2062 6164 2061 7267 730a 2020 2020  on bad args.    
-0001fce0: 2020 2020 7365 6c66 2e5f 6d65 7461 5f6e      self._meta_n
-0001fcf0: 6f6e 656d 7074 792e 6669 7273 7428 6f66  onempty.first(of
-0001fd00: 6673 6574 290a 0a20 2020 2020 2020 2069  fset)..        i
-0001fd10: 6620 6e6f 7420 7365 6c66 2e6b 6e6f 776e  f not self.known
-0001fd20: 5f64 6976 6973 696f 6e73 3a0a 2020 2020  _divisions:.    
-0001fd30: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0001fd40: 6c75 6545 7272 6f72 2822 6066 6972 7374  lueError("`first
-0001fd50: 6020 6973 206e 6f74 2069 6d70 6c65 6d65  ` is not impleme
-0001fd60: 6e74 6564 2066 6f72 2075 6e6b 6e6f 776e  nted for unknown
-0001fd70: 2064 6976 6973 696f 6e73 2229 0a0a 2020   divisions")..  
-0001fd80: 2020 2020 2020 6f66 6673 6574 203d 2070        offset = p
-0001fd90: 642e 7473 6572 6965 732e 6672 6571 7565  d.tseries.freque
-0001fda0: 6e63 6965 732e 746f 5f6f 6666 7365 7428  ncies.to_offset(
-0001fdb0: 6f66 6673 6574 290a 2020 2020 2020 2020  offset).        
-0001fdc0: 6461 7465 203d 2073 656c 662e 6469 7669  date = self.divi
-0001fdd0: 7369 6f6e 735b 305d 202b 206f 6666 7365  sions[0] + offse
-0001fde0: 740a 2020 2020 2020 2020 656e 6420 3d20  t.        end = 
-0001fdf0: 7365 6c66 2e6c 6f63 2e5f 6765 745f 7061  self.loc._get_pa
-0001fe00: 7274 6974 696f 6e73 2864 6174 6529 0a0a  rtitions(date)..
-0001fe10: 2020 2020 2020 2020 6973 5f61 6e63 686f          is_ancho
-0001fe20: 7265 6420 3d20 6f66 6673 6574 2e69 735f  red = offset.is_
-0001fe30: 616e 6368 6f72 6564 2829 0a0a 2020 2020  anchored()..    
-0001fe40: 2020 2020 696e 636c 7564 655f 7269 6768      include_righ
-0001fe50: 7420 3d20 6973 5f61 6e63 686f 7265 6420  t = is_anchored 
-0001fe60: 6f72 206e 6f74 2068 6173 6174 7472 286f  or not hasattr(o
-0001fe70: 6666 7365 742c 2022 6465 6c74 6122 290a  ffset, "delta").
-0001fe80: 0a20 2020 2020 2020 2069 6620 656e 6420  .        if end 
-0001fe90: 3d3d 2073 656c 662e 6e70 6172 7469 7469  == self.npartiti
-0001fea0: 6f6e 7320 2d20 313a 0a20 2020 2020 2020  ons - 1:.       
-0001feb0: 2020 2020 2064 6976 7320 3d20 7365 6c66       divs = self
-0001fec0: 2e64 6976 6973 696f 6e73 0a20 2020 2020  .divisions.     
-0001fed0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0001fee0: 2020 2020 2064 6976 7320 3d20 7365 6c66       divs = self
-0001fef0: 2e64 6976 6973 696f 6e73 5b3a 2065 6e64  .divisions[: end
-0001ff00: 202b 2031 5d20 2b20 2864 6174 652c 290a   + 1] + (date,).
-0001ff10: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
-0001ff20: 2266 6972 7374 2d22 202b 2074 6f6b 656e  "first-" + token
-0001ff30: 697a 6528 7365 6c66 2c20 6f66 6673 6574  ize(self, offset
-0001ff40: 290a 2020 2020 2020 2020 6473 6b20 3d20  ).        dsk = 
-0001ff50: 7b28 6e61 6d65 2c20 6929 3a20 2873 656c  {(name, i): (sel
-0001ff60: 662e 5f6e 616d 652c 2069 2920 666f 7220  f._name, i) for 
-0001ff70: 6920 696e 2072 616e 6765 2865 6e64 297d  i in range(end)}
-0001ff80: 0a20 2020 2020 2020 2064 736b 5b28 6e61  .        dsk[(na
-0001ff90: 6d65 2c20 656e 6429 5d20 3d20 280a 2020  me, end)] = (.  
-0001ffa0: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-0001ffb0: 732e 626f 756e 6461 7279 5f73 6c69 6365  s.boundary_slice
-0001ffc0: 2c0a 2020 2020 2020 2020 2020 2020 2873  ,.            (s
-0001ffd0: 656c 662e 5f6e 616d 652c 2065 6e64 292c  elf._name, end),
-0001ffe0: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-0001fff0: 652c 0a20 2020 2020 2020 2020 2020 2064  e,.            d
-00020000: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
-00020010: 2069 6e63 6c75 6465 5f72 6967 6874 2c0a   include_right,.
-00020020: 2020 2020 2020 2020 2020 2020 5472 7565              True
-00020030: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00020040: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
-00020050: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
-00020060: 636f 6c6c 6563 7469 6f6e 7328 6e61 6d65  collections(name
-00020070: 2c20 6473 6b2c 2064 6570 656e 6465 6e63  , dsk, dependenc
-00020080: 6965 733d 5b73 656c 665d 290a 2020 2020  ies=[self]).    
-00020090: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
-000200a0: 645f 6f62 6a65 6374 2867 7261 7068 2c20  d_object(graph, 
-000200b0: 6e61 6d65 2c20 7365 6c66 2c20 6469 7673  name, self, divs
-000200c0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-000200d0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-000200e0: 6529 0a20 2020 2064 6566 206c 6173 7428  e).    def last(
-000200f0: 7365 6c66 2c20 6f66 6673 6574 293a 0a20  self, offset):. 
-00020100: 2020 2020 2020 2023 204c 6574 2070 616e         # Let pan
-00020110: 6461 7320 6572 726f 7220 6f6e 2062 6164  das error on bad
-00020120: 2061 7267 730a 2020 2020 2020 2020 7365   args.        se
-00020130: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
-00020140: 792e 6c61 7374 286f 6666 7365 7429 0a0a  y.last(offset)..
-00020150: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-00020160: 656c 662e 6b6e 6f77 6e5f 6469 7669 7369  elf.known_divisi
-00020170: 6f6e 733a 0a20 2020 2020 2020 2020 2020  ons:.           
-00020180: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00020190: 7228 2260 6c61 7374 6020 6973 206e 6f74  r("`last` is not
-000201a0: 2069 6d70 6c65 6d65 6e74 6564 2066 6f72   implemented for
-000201b0: 2075 6e6b 6e6f 776e 2064 6976 6973 696f   unknown divisio
-000201c0: 6e73 2229 0a0a 2020 2020 2020 2020 6f66  ns")..        of
-000201d0: 6673 6574 203d 2070 642e 7473 6572 6965  fset = pd.tserie
-000201e0: 732e 6672 6571 7565 6e63 6965 732e 746f  s.frequencies.to
-000201f0: 5f6f 6666 7365 7428 6f66 6673 6574 290a  _offset(offset).
-00020200: 2020 2020 2020 2020 6461 7465 203d 2073          date = s
-00020210: 656c 662e 6469 7669 7369 6f6e 735b 2d31  elf.divisions[-1
-00020220: 5d20 2d20 6f66 6673 6574 0a20 2020 2020  ] - offset.     
-00020230: 2020 2073 7461 7274 203d 2073 656c 662e     start = self.
-00020240: 6c6f 632e 5f67 6574 5f70 6172 7469 7469  loc._get_partiti
-00020250: 6f6e 7328 6461 7465 290a 0a20 2020 2020  ons(date)..     
-00020260: 2020 2069 6620 7374 6172 7420 3d3d 2030     if start == 0
-00020270: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-00020280: 7673 203d 2073 656c 662e 6469 7669 7369  vs = self.divisi
-00020290: 6f6e 730a 2020 2020 2020 2020 656c 7365  ons.        else
-000202a0: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-000202b0: 7673 203d 2028 6461 7465 2c29 202b 2073  vs = (date,) + s
-000202c0: 656c 662e 6469 7669 7369 6f6e 735b 7374  elf.divisions[st
-000202d0: 6172 7420 2b20 3120 3a5d 0a0a 2020 2020  art + 1 :]..    
-000202e0: 2020 2020 6e61 6d65 203d 2022 6c61 7374      name = "last
-000202f0: 2d22 202b 2074 6f6b 656e 697a 6528 7365  -" + tokenize(se
-00020300: 6c66 2c20 6f66 6673 6574 290a 2020 2020  lf, offset).    
-00020310: 2020 2020 6473 6b20 3d20 7b0a 2020 2020      dsk = {.    
-00020320: 2020 2020 2020 2020 286e 616d 652c 2069          (name, i
-00020330: 202b 2031 293a 2028 7365 6c66 2e5f 6e61   + 1): (self._na
-00020340: 6d65 2c20 6a20 2b20 3129 0a20 2020 2020  me, j + 1).     
-00020350: 2020 2020 2020 2066 6f72 2069 2c20 6a20         for i, j 
-00020360: 696e 2065 6e75 6d65 7261 7465 2872 616e  in enumerate(ran
-00020370: 6765 2873 7461 7274 2c20 7365 6c66 2e6e  ge(start, self.n
-00020380: 7061 7274 6974 696f 6e73 2929 0a20 2020  partitions)).   
-00020390: 2020 2020 207d 0a20 2020 2020 2020 2064       }.        d
-000203a0: 736b 5b28 6e61 6d65 2c20 3029 5d20 3d20  sk[(name, 0)] = 
-000203b0: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
-000203c0: 7468 6f64 732e 626f 756e 6461 7279 5f73  thods.boundary_s
-000203d0: 6c69 6365 2c0a 2020 2020 2020 2020 2020  lice,.          
-000203e0: 2020 2873 656c 662e 5f6e 616d 652c 2073    (self._name, s
-000203f0: 7461 7274 292c 0a20 2020 2020 2020 2020  tart),.         
-00020400: 2020 2064 6174 652c 0a20 2020 2020 2020     date,.       
-00020410: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
-00020420: 2020 2020 2020 2054 7275 652c 0a20 2020         True,.   
-00020430: 2020 2020 2020 2020 2046 616c 7365 2c0a           False,.
-00020440: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00020450: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-00020460: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-00020470: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
-00020480: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
-00020490: 733d 5b73 656c 665d 290a 2020 2020 2020  s=[self]).      
-000204a0: 2020 7265 7475 726e 206e 6577 5f64 645f    return new_dd_
-000204b0: 6f62 6a65 6374 2867 7261 7068 2c20 6e61  object(graph, na
-000204c0: 6d65 2c20 7365 6c66 2c20 6469 7673 290a  me, self, divs).
-000204d0: 0a20 2020 2064 6566 206e 756e 6971 7565  .    def nunique
-000204e0: 5f61 7070 726f 7828 7365 6c66 2c20 7370  _approx(self, sp
-000204f0: 6c69 745f 6576 6572 793d 4e6f 6e65 293a  lit_every=None):
-00020500: 0a20 2020 2020 2020 2022 2222 4170 7072  .        """Appr
-00020510: 6f78 696d 6174 6520 6e75 6d62 6572 206f  oximate number o
-00020520: 6620 756e 6971 7565 2072 6f77 732e 0a0a  f unique rows...
-00020530: 2020 2020 2020 2020 5468 6973 206d 6574          This met
-00020540: 686f 6420 7573 6573 2074 6865 2048 7970  hod uses the Hyp
-00020550: 6572 4c6f 674c 6f67 2061 6c67 6f72 6974  erLogLog algorit
-00020560: 686d 2066 6f72 2063 6172 6469 6e61 6c69  hm for cardinali
-00020570: 7479 0a20 2020 2020 2020 2065 7374 696d  ty.        estim
-00020580: 6174 696f 6e20 746f 2063 6f6d 7075 7465  ation to compute
-00020590: 2074 6865 2061 7070 726f 7869 6d61 7465   the approximate
-000205a0: 206e 756d 6265 7220 6f66 2075 6e69 7175   number of uniqu
-000205b0: 6520 726f 7773 2e0a 2020 2020 2020 2020  e rows..        
-000205c0: 5468 6520 6170 7072 6f78 696d 6174 6520  The approximate 
-000205d0: 6572 726f 7220 6973 2030 2e34 3036 252e  error is 0.406%.
-000205e0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-000205f0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-00020600: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00020610: 7370 6c69 745f 6576 6572 7920 3a20 696e  split_every : in
-00020620: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-00020630: 2020 2020 2020 2020 4772 6f75 7020 7061          Group pa
-00020640: 7274 6974 696f 6e73 2069 6e74 6f20 6772  rtitions into gr
-00020650: 6f75 7073 206f 6620 7468 6973 2073 697a  oups of this siz
-00020660: 6520 7768 696c 6520 7065 7266 6f72 6d69  e while performi
-00020670: 6e67 2061 0a20 2020 2020 2020 2020 2020  ng a.           
-00020680: 2074 7265 652d 7265 6475 6374 696f 6e2e   tree-reduction.
-00020690: 2049 6620 7365 7420 746f 2046 616c 7365   If set to False
-000206a0: 2c20 6e6f 2074 7265 652d 7265 6475 6374  , no tree-reduct
-000206b0: 696f 6e20 7769 6c6c 2062 6520 7573 6564  ion will be used
-000206c0: 2e0a 2020 2020 2020 2020 2020 2020 4465  ..            De
-000206d0: 6661 756c 7420 6973 2038 2e0a 0a20 2020  fault is 8...   
-000206e0: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-000206f0: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-00020700: 2020 2020 2061 2066 6c6f 6174 2072 6570       a float rep
-00020710: 7265 7365 6e74 696e 6720 7468 6520 6170  resenting the ap
-00020720: 7072 6f78 696d 6174 6520 6e75 6d62 6572  proximate number
-00020730: 206f 6620 656c 656d 656e 7473 0a20 2020   of elements.   
-00020740: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00020750: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
-00020760: 7261 6d65 2069 6d70 6f72 7420 6879 7065  rame import hype
-00020770: 726c 6f67 6c6f 6720 2023 2068 6572 6520  rloglog  # here 
-00020780: 746f 2061 766f 6964 2063 6972 6375 6c61  to avoid circula
-00020790: 7220 696d 706f 7274 2069 7373 7565 730a  r import issues.
-000207a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000207b0: 6163 6128 0a20 2020 2020 2020 2020 2020  aca(.           
-000207c0: 205b 7365 6c66 5d2c 0a20 2020 2020 2020   [self],.       
-000207d0: 2020 2020 2063 6875 6e6b 3d68 7970 6572       chunk=hyper
-000207e0: 6c6f 676c 6f67 2e63 6f6d 7075 7465 5f68  loglog.compute_h
-000207f0: 6c6c 5f61 7272 6179 2c0a 2020 2020 2020  ll_array,.      
-00020800: 2020 2020 2020 636f 6d62 696e 653d 6879        combine=hy
-00020810: 7065 726c 6f67 6c6f 672e 7265 6475 6365  perloglog.reduce
-00020820: 5f73 7461 7465 2c0a 2020 2020 2020 2020  _state,.        
-00020830: 2020 2020 6167 6772 6567 6174 653d 6879      aggregate=hy
-00020840: 7065 726c 6f67 6c6f 672e 6573 7469 6d61  perloglog.estima
-00020850: 7465 5f63 6f75 6e74 2c0a 2020 2020 2020  te_count,.      
-00020860: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
-00020870: 793d 7370 6c69 745f 6576 6572 792c 0a20  y=split_every,. 
-00020880: 2020 2020 2020 2020 2020 2062 3d31 362c             b=16,
-00020890: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-000208a0: 613d 666c 6f61 742c 0a20 2020 2020 2020  a=float,.       
-000208b0: 2029 0a0a 2020 2020 4070 726f 7065 7274   )..    @propert
-000208c0: 790a 2020 2020 6465 6620 7661 6c75 6573  y.    def values
-000208d0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000208e0: 2222 2252 6574 7572 6e20 6120 6461 736b  """Return a dask
-000208f0: 2e61 7272 6179 206f 6620 7468 6520 7661  .array of the va
-00020900: 6c75 6573 206f 6620 7468 6973 2064 6174  lues of this dat
-00020910: 6166 7261 6d65 0a0a 2020 2020 2020 2020  aframe..        
-00020920: 5761 726e 696e 673a 2054 6869 7320 6372  Warning: This cr
-00020930: 6561 7465 7320 6120 6461 736b 2e61 7272  eates a dask.arr
-00020940: 6179 2077 6974 686f 7574 2070 7265 6369  ay without preci
-00020950: 7365 2073 6861 7065 2069 6e66 6f72 6d61  se shape informa
-00020960: 7469 6f6e 2e0a 2020 2020 2020 2020 4f70  tion..        Op
-00020970: 6572 6174 696f 6e73 2074 6861 7420 6465  erations that de
-00020980: 7065 6e64 206f 6e20 7368 6170 6520 696e  pend on shape in
-00020990: 666f 726d 6174 696f 6e2c 206c 696b 6520  formation, like 
-000209a0: 736c 6963 696e 6720 6f72 2072 6573 6861  slicing or resha
-000209b0: 7069 6e67 2c0a 2020 2020 2020 2020 7769  ping,.        wi
-000209c0: 6c6c 206e 6f74 2077 6f72 6b2e 0a20 2020  ll not work..   
-000209d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000209e0: 2069 6620 6973 5f65 7874 656e 7369 6f6e   if is_extension
-000209f0: 5f61 7272 6179 5f64 7479 7065 2873 656c  _array_dtype(sel
-00020a00: 662e 5f6d 6574 612e 7661 6c75 6573 293a  f._meta.values):
-00020a10: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
-00020a20: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
-00020a30: 2020 2020 2020 2020 2020 2020 2244 6173              "Das
-00020a40: 6b20 6375 7272 656e 746c 7920 6861 7320  k currently has 
-00020a50: 6c69 6d69 7465 6420 7375 7070 6f72 7420  limited support 
-00020a60: 666f 7220 636f 6e76 6572 7469 6e67 2070  for converting p
-00020a70: 616e 6461 7320 6578 7465 6e73 696f 6e20  andas extension 
-00020a80: 6474 7970 6573 2022 0a20 2020 2020 2020  dtypes ".       
-00020a90: 2020 2020 2020 2020 2066 2274 6f20 6172           f"to ar
-00020aa0: 7261 7973 2e20 436f 6e76 6572 7469 6e67  rays. Converting
-00020ab0: 207b 7365 6c66 2e5f 6d65 7461 2e76 616c   {self._meta.val
-00020ac0: 7565 732e 6474 7970 657d 2074 6f20 6f62  ues.dtype} to ob
-00020ad0: 6a65 6374 2064 7479 7065 2e22 2c0a 2020  ject dtype.",.  
-00020ae0: 2020 2020 2020 2020 2020 2020 2020 5573                Us
-00020af0: 6572 5761 726e 696e 672c 0a20 2020 2020  erWarning,.     
-00020b00: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00020b10: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-00020b20: 5f70 6172 7469 7469 6f6e 7328 6d65 7468  _partitions(meth
-00020b30: 6f64 732e 7661 6c75 6573 290a 0a20 2020  ods.values)..   
-00020b40: 2064 6566 205f 7661 6c69 6461 7465 5f63   def _validate_c
-00020b50: 6875 6e6b 7328 7365 6c66 2c20 6172 722c  hunks(self, arr,
-00020b60: 206c 656e 6774 6873 293a 0a20 2020 2020   lengths):.     
-00020b70: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
-00020b80: 6179 2e63 6f72 6520 696d 706f 7274 206e  ay.core import n
-00020b90: 6f72 6d61 6c69 7a65 5f63 6875 6e6b 730a  ormalize_chunks.
-00020ba0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-00020bb0: 7374 616e 6365 286c 656e 6774 6873 2c20  stance(lengths, 
-00020bc0: 5365 7175 656e 6365 293a 0a20 2020 2020  Sequence):.     
-00020bd0: 2020 2020 2020 206c 656e 6774 6873 203d         lengths =
-00020be0: 2074 7570 6c65 286c 656e 6774 6873 290a   tuple(lengths).
-00020bf0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00020c00: 6c65 6e28 6c65 6e67 7468 7329 2021 3d20  len(lengths) != 
-00020c10: 7365 6c66 2e6e 7061 7274 6974 696f 6e73  self.npartitions
-00020c20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00020c30: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00020c40: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00020c50: 2020 2020 2020 2020 2254 6865 206e 756d          "The num
-00020c60: 6265 7220 6f66 2069 7465 6d73 2069 6e20  ber of items in 
-00020c70: 276c 656e 6774 6873 2720 646f 6573 206e  'lengths' does n
-00020c80: 6f74 206d 6174 6368 2074 6865 206e 756d  ot match the num
-00020c90: 6265 7220 6f66 2022 0a20 2020 2020 2020  ber of ".       
-00020ca0: 2020 2020 2020 2020 2020 2020 2066 2270               f"p
-00020cb0: 6172 7469 7469 6f6e 732e 207b 6c65 6e28  artitions. {len(
-00020cc0: 6c65 6e67 7468 7329 7d20 213d 207b 7365  lengths)} != {se
-00020cd0: 6c66 2e6e 7061 7274 6974 696f 6e73 7d22  lf.npartitions}"
-00020ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020cf0: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
-00020d00: 6966 2073 656c 662e 6e64 696d 203d 3d20  if self.ndim == 
-00020d10: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-00020d20: 2020 2063 6875 6e6b 7320 3d20 6e6f 726d     chunks = norm
-00020d30: 616c 697a 655f 6368 756e 6b73 2828 6c65  alize_chunks((le
-00020d40: 6e67 7468 732c 2929 0a20 2020 2020 2020  ngths,)).       
-00020d50: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00020d60: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
-00020d70: 7320 3d20 6e6f 726d 616c 697a 655f 6368  s = normalize_ch
-00020d80: 756e 6b73 2828 6c65 6e67 7468 732c 2028  unks((lengths, (
-00020d90: 6c65 6e28 7365 6c66 2e63 6f6c 756d 6e73  len(self.columns
-00020da0: 292c 2929 290a 0a20 2020 2020 2020 2020  ),)))..         
-00020db0: 2020 2072 6574 7572 6e20 6368 756e 6b73     return chunks
-00020dc0: 0a20 2020 2020 2020 2065 6c69 6620 6c65  .        elif le
-00020dd0: 6e67 7468 7320 6973 206e 6f74 204e 6f6e  ngths is not Non
-00020de0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00020df0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00020e00: 6622 556e 6578 7065 6374 6564 2076 616c  f"Unexpected val
-00020e10: 7565 2066 6f72 2027 6c65 6e67 7468 7327  ue for 'lengths'
-00020e20: 3a20 277b 6c65 6e67 7468 737d 2722 290a  : '{lengths}'").
-00020e30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00020e40: 6172 722e 5f63 6875 6e6b 730a 0a20 2020  arr._chunks..   
-00020e50: 2064 6566 205f 6973 5f69 6e64 6578 5f6c   def _is_index_l
-00020e60: 6576 656c 5f72 6566 6572 656e 6365 2873  evel_reference(s
-00020e70: 656c 662c 206b 6579 293a 0a20 2020 2020  elf, key):.     
-00020e80: 2020 2022 2222 0a20 2020 2020 2020 2054     """.        T
-00020e90: 6573 7420 7768 6574 6865 7220 6120 6b65  est whether a ke
-00020ea0: 7920 6973 2061 6e20 696e 6465 7820 6c65  y is an index le
-00020eb0: 7665 6c20 7265 6665 7265 6e63 650a 0a20  vel reference.. 
-00020ec0: 2020 2020 2020 2054 6f20 6265 2063 6f6e         To be con
-00020ed0: 7369 6465 7265 6420 616e 2069 6e64 6578  sidered an index
-00020ee0: 206c 6576 656c 2072 6566 6572 656e 6365   level reference
-00020ef0: 2c20 606b 6579 6020 6d75 7374 206d 6174  , `key` must mat
-00020f00: 6368 2074 6865 2069 6e64 6578 206e 616d  ch the index nam
-00020f10: 650a 2020 2020 2020 2020 616e 6420 6d75  e.        and mu
-00020f20: 7374 204e 4f54 206d 6174 6368 2074 6865  st NOT match the
-00020f30: 206e 616d 6520 6f66 2061 6e79 2063 6f6c   name of any col
-00020f40: 756d 6e20 2869 6620 6120 6461 7461 6672  umn (if a datafr
-00020f50: 616d 6529 2e0a 2020 2020 2020 2020 2222  ame)..        ""
-00020f60: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00020f70: 2028 0a20 2020 2020 2020 2020 2020 2073   (.            s
-00020f80: 656c 662e 696e 6465 782e 6e61 6d65 2069  elf.index.name i
-00020f90: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2020  s not None.     
-00020fa0: 2020 2020 2020 2061 6e64 206e 6f74 2069         and not i
-00020fb0: 735f 6461 736b 5f63 6f6c 6c65 6374 696f  s_dask_collectio
-00020fc0: 6e28 6b65 7929 0a20 2020 2020 2020 2020  n(key).         
-00020fd0: 2020 2061 6e64 2028 6e70 2e69 7373 6361     and (np.issca
-00020fe0: 6c61 7228 6b65 7929 206f 7220 6973 696e  lar(key) or isin
-00020ff0: 7374 616e 6365 286b 6579 2c20 7475 706c  stance(key, tupl
-00021000: 6529 290a 2020 2020 2020 2020 2020 2020  e)).            
-00021010: 616e 6420 6b65 7920 3d3d 2073 656c 662e  and key == self.
-00021020: 696e 6465 782e 6e61 6d65 0a20 2020 2020  index.name.     
-00021030: 2020 2020 2020 2061 6e64 206b 6579 206e         and key n
-00021040: 6f74 2069 6e20 6765 7461 7474 7228 7365  ot in getattr(se
-00021050: 6c66 2c20 2263 6f6c 756d 6e73 222c 2028  lf, "columns", (
-00021060: 2929 0a20 2020 2020 2020 2029 0a0a 2020  )).        )..  
-00021070: 2020 6465 6620 5f63 6f6e 7461 696e 735f    def _contains_
-00021080: 696e 6465 785f 6e61 6d65 2873 656c 662c  index_name(self,
-00021090: 2063 6f6c 756d 6e73 5f6f 725f 696e 6465   columns_or_inde
-000210a0: 7829 3a0a 2020 2020 2020 2020 2222 220a  x):.        """.
-000210b0: 2020 2020 2020 2020 5465 7374 2077 6865          Test whe
-000210c0: 7468 6572 2074 6865 2069 6e70 7574 2063  ther the input c
-000210d0: 6f6e 7461 696e 7320 6120 7265 6665 7265  ontains a refere
-000210e0: 6e63 6520 746f 2074 6865 2069 6e64 6578  nce to the index
-000210f0: 206f 6620 7468 6520 4461 7461 4672 616d   of the DataFram
-00021100: 652f 5365 7269 6573 0a20 2020 2020 2020  e/Series.       
-00021110: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-00021120: 6973 696e 7374 616e 6365 2863 6f6c 756d  isinstance(colum
-00021130: 6e73 5f6f 725f 696e 6465 782c 206c 6973  ns_or_index, lis
-00021140: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-00021150: 7265 7475 726e 2061 6e79 2873 656c 662e  return any(self.
-00021160: 5f69 735f 696e 6465 785f 6c65 7665 6c5f  _is_index_level_
-00021170: 7265 6665 7265 6e63 6528 6e29 2066 6f72  reference(n) for
-00021180: 206e 2069 6e20 636f 6c75 6d6e 735f 6f72   n in columns_or
-00021190: 5f69 6e64 6578 290a 2020 2020 2020 2020  _index).        
-000211a0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000211b0: 2020 7265 7475 726e 2073 656c 662e 5f69    return self._i
-000211c0: 735f 696e 6465 785f 6c65 7665 6c5f 7265  s_index_level_re
-000211d0: 6665 7265 6e63 6528 636f 6c75 6d6e 735f  ference(columns_
-000211e0: 6f72 5f69 6e64 6578 290a 0a0a 6465 6620  or_index)...def 
-000211f0: 5f72 6169 7365 5f69 665f 6f62 6a65 6374  _raise_if_object
-00021200: 5f73 6572 6965 7328 782c 2066 756e 636e  _series(x, funcn
-00021210: 616d 6529 3a0a 2020 2020 2222 220a 2020  ame):.    """.  
-00021220: 2020 5574 696c 6974 7920 6675 6e63 7469    Utility functi
-00021230: 6f6e 2074 6f20 7261 6973 6520 616e 2065  on to raise an e
-00021240: 7272 6f72 2069 6620 616e 206f 626a 6563  rror if an objec
-00021250: 7420 636f 6c75 6d6e 2064 6f65 7320 6e6f  t column does no
-00021260: 7420 7375 7070 6f72 740a 2020 2020 6120  t support.    a 
-00021270: 6365 7274 6169 6e20 6f70 6572 6174 696f  certain operatio
-00021280: 6e20 6c69 6b65 2060 6d65 616e 602e 0a20  n like `mean`.. 
-00021290: 2020 2022 2222 0a20 2020 2069 6620 6973     """.    if is
-000212a0: 696e 7374 616e 6365 2878 2c20 5365 7269  instance(x, Seri
-000212b0: 6573 2920 616e 6420 6861 7361 7474 7228  es) and hasattr(
-000212c0: 782c 2022 6474 7970 6522 293a 0a20 2020  x, "dtype"):.   
-000212d0: 2020 2020 2069 6620 782e 6474 7970 6520       if x.dtype 
-000212e0: 3d3d 206f 626a 6563 743a 0a20 2020 2020  == object:.     
-000212f0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00021300: 7565 4572 726f 7228 2260 2573 6020 6e6f  ueError("`%s` no
-00021310: 7420 7375 7070 6f72 7465 6420 7769 7468  t supported with
-00021320: 206f 626a 6563 7420 7365 7269 6573 2220   object series" 
-00021330: 2520 6675 6e63 6e61 6d65 290a 2020 2020  % funcname).    
-00021340: 2020 2020 656c 6966 2069 735f 7374 7269      elif is_stri
-00021350: 6e67 5f64 7479 7065 2878 293a 0a20 2020  ng_dtype(x):.   
-00021360: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00021370: 616c 7565 4572 726f 7228 2260 2573 6020  alueError("`%s` 
-00021380: 6e6f 7420 7375 7070 6f72 7465 6420 7769  not supported wi
-00021390: 7468 2073 7472 696e 6720 7365 7269 6573  th string series
-000213a0: 2220 2520 6675 6e63 6e61 6d65 290a 0a0a  " % funcname)...
-000213b0: 636c 6173 7320 5365 7269 6573 285f 4672  class Series(_Fr
-000213c0: 616d 6529 3a0a 2020 2020 2222 2250 6172  ame):.    """Par
-000213d0: 616c 6c65 6c20 5061 6e64 6173 2053 6572  allel Pandas Ser
-000213e0: 6965 730a 0a20 2020 2044 6f20 6e6f 7420  ies..    Do not 
-000213f0: 7573 6520 7468 6973 2063 6c61 7373 2064  use this class d
-00021400: 6972 6563 746c 792e 2020 496e 7374 6561  irectly.  Instea
-00021410: 6420 7573 6520 6675 6e63 7469 6f6e 7320  d use functions 
-00021420: 6c69 6b65 0a20 2020 2060 6064 642e 7265  like.    ``dd.re
-00021430: 6164 5f63 7376 6060 2c20 6060 6464 2e72  ad_csv``, ``dd.r
-00021440: 6561 645f 7061 7271 7565 7460 602c 206f  ead_parquet``, o
-00021450: 7220 6060 6464 2e66 726f 6d5f 7061 6e64  r ``dd.from_pand
-00021460: 6173 6060 2e0a 0a20 2020 2050 6172 616d  as``...    Param
-00021470: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
-00021480: 2d2d 2d2d 0a0a 2020 2020 6473 6b3a 2064  ----..    dsk: d
-00021490: 6963 740a 2020 2020 2020 2020 5468 6520  ict.        The 
-000214a0: 6461 736b 2067 7261 7068 2074 6f20 636f  dask graph to co
-000214b0: 6d70 7574 6520 7468 6973 2053 6572 6965  mpute this Serie
-000214c0: 730a 2020 2020 5f6e 616d 653a 2073 7472  s.    _name: str
-000214d0: 0a20 2020 2020 2020 2054 6865 206b 6579  .        The key
-000214e0: 2070 7265 6669 7820 7468 6174 2073 7065   prefix that spe
-000214f0: 6369 6669 6573 2077 6869 6368 206b 6579  cifies which key
-00021500: 7320 696e 2074 6865 2064 6173 6b20 636f  s in the dask co
-00021510: 6d70 7269 7365 2074 6869 730a 2020 2020  mprise this.    
-00021520: 2020 2020 7061 7274 6963 756c 6172 2053      particular S
-00021530: 6572 6965 730a 2020 2020 6d65 7461 3a20  eries.    meta: 
-00021540: 7061 6e64 6173 2e53 6572 6965 730a 2020  pandas.Series.  
-00021550: 2020 2020 2020 416e 2065 6d70 7479 2060        An empty `
-00021560: 6070 616e 6461 732e 5365 7269 6573 6060  `pandas.Series``
-00021570: 2077 6974 6820 6e61 6d65 732c 2064 7479   with names, dty
-00021580: 7065 732c 2061 6e64 2069 6e64 6578 206d  pes, and index m
-00021590: 6174 6368 696e 6720 7468 650a 2020 2020  atching the.    
-000215a0: 2020 2020 6578 7065 6374 6564 206f 7574      expected out
-000215b0: 7075 742e 0a20 2020 2064 6976 6973 696f  put..    divisio
-000215c0: 6e73 3a20 7475 706c 6520 6f66 2069 6e64  ns: tuple of ind
-000215d0: 6578 2076 616c 7565 730a 2020 2020 2020  ex values.      
-000215e0: 2020 5661 6c75 6573 2061 6c6f 6e67 2077    Values along w
-000215f0: 6869 6368 2077 6520 7061 7274 6974 696f  hich we partitio
-00021600: 6e20 6f75 7220 626c 6f63 6b73 206f 6e20  n our blocks on 
-00021610: 7468 6520 696e 6465 780a 0a20 2020 2053  the index..    S
-00021620: 6565 2041 6c73 6f0a 2020 2020 2d2d 2d2d  ee Also.    ----
-00021630: 2d2d 2d2d 0a20 2020 2064 6173 6b2e 6461  ----.    dask.da
-00021640: 7461 6672 616d 652e 4461 7461 4672 616d  taframe.DataFram
-00021650: 650a 2020 2020 2222 220a 0a20 2020 205f  e.    """..    _
-00021660: 7061 7274 6974 696f 6e5f 7479 7065 203d  partition_type =
-00021670: 2070 642e 5365 7269 6573 0a20 2020 205f   pd.Series.    _
-00021680: 6973 5f70 6172 7469 7469 6f6e 5f74 7970  is_partition_typ
-00021690: 6520 3d20 7374 6174 6963 6d65 7468 6f64  e = staticmethod
-000216a0: 2869 735f 7365 7269 6573 5f6c 696b 6529  (is_series_like)
-000216b0: 0a20 2020 205f 746f 6b65 6e5f 7072 6566  .    _token_pref
-000216c0: 6978 203d 2022 7365 7269 6573 2d22 0a20  ix = "series-". 
-000216d0: 2020 205f 6163 6365 7373 6f72 733a 2043     _accessors: C
-000216e0: 6c61 7373 5661 725b 7365 745b 7374 725d  lassVar[set[str]
-000216f0: 5d20 3d20 7365 7428 290a 0a20 2020 2064  ] = set()..    d
-00021700: 6566 205f 5f61 7272 6179 5f77 7261 705f  ef __array_wrap_
-00021710: 5f28 7365 6c66 2c20 6172 7261 792c 2063  _(self, array, c
-00021720: 6f6e 7465 7874 3d4e 6f6e 6529 3a0a 2020  ontext=None):.  
-00021730: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00021740: 6e63 6528 636f 6e74 6578 742c 2074 7570  nce(context, tup
-00021750: 6c65 2920 616e 6420 6c65 6e28 636f 6e74  le) and len(cont
-00021760: 6578 7429 203e 2030 3a0a 2020 2020 2020  ext) > 0:.      
-00021770: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00021780: 6e63 6528 636f 6e74 6578 745b 315d 5b30  nce(context[1][0
-00021790: 5d2c 206e 702e 6e64 6172 7261 7929 2061  ], np.ndarray) a
-000217a0: 6e64 2063 6f6e 7465 7874 5b31 5d5b 305d  nd context[1][0]
-000217b0: 2e73 6861 7065 203d 3d20 2829 3a0a 2020  .shape == ():.  
-000217c0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-000217d0: 6465 7820 3d20 4e6f 6e65 0a20 2020 2020  dex = None.     
-000217e0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000217f0: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
-00021800: 6578 203d 2063 6f6e 7465 7874 5b31 5d5b  ex = context[1][
-00021810: 305d 2e69 6e64 6578 0a20 2020 2020 2020  0].index.       
-00021820: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00021830: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-00021840: 2020 2020 2020 2020 696d 706f 7274 2069          import i
-00021850: 6e73 7065 6374 0a0a 2020 2020 2020 2020  nspect..        
-00021860: 2020 2020 2020 2020 6d65 7468 6f64 5f6e          method_n
-00021870: 616d 6520 3d20 6622 607b 696e 7370 6563  ame = f"`{inspec
-00021880: 742e 7374 6163 6b28 295b 335d 5b33 5d7d  t.stack()[3][3]}
-00021890: 6022 0a20 2020 2020 2020 2020 2020 2065  `".            e
-000218a0: 7863 6570 7420 496e 6465 7845 7272 6f72  xcept IndexError
-000218b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000218c0: 2020 6d65 7468 6f64 5f6e 616d 6520 3d20    method_name = 
-000218d0: 2254 6869 7320 6d65 7468 6f64 220a 2020  "This method".  
-000218e0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000218f0: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-00021900: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00021910: 2020 2020 2066 227b 6d65 7468 6f64 5f6e       f"{method_n
-00021920: 616d 657d 2069 7320 6e6f 7420 696d 706c  ame} is not impl
-00021930: 656d 656e 7465 6420 666f 7220 6064 6173  emented for `das
-00021940: 6b2e 6461 7461 6672 616d 652e 5365 7269  k.dataframe.Seri
-00021950: 6573 602e 220a 2020 2020 2020 2020 2020  es`.".          
-00021960: 2020 290a 0a20 2020 2020 2020 2072 6574    )..        ret
-00021970: 7572 6e20 6d65 7461 5f73 6572 6965 735f  urn meta_series_
-00021980: 636f 6e73 7472 7563 746f 7228 7365 6c66  constructor(self
-00021990: 2928 6172 7261 792c 2069 6e64 6578 3d69  )(array, index=i
-000219a0: 6e64 6578 2c20 6e61 6d65 3d73 656c 662e  ndex, name=self.
-000219b0: 6e61 6d65 290a 0a20 2020 2040 7072 6f70  name)..    @prop
-000219c0: 6572 7479 0a20 2020 2064 6566 2061 7865  erty.    def axe
-000219d0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
-000219e0: 2072 6574 7572 6e20 5b73 656c 662e 696e   return [self.in
-000219f0: 6465 785d 0a0a 2020 2020 4070 726f 7065  dex]..    @prope
-00021a00: 7274 790a 2020 2020 6465 6620 6e61 6d65  rty.    def name
-00021a10: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00021a20: 7265 7475 726e 2073 656c 662e 5f6d 6574  return self._met
-00021a30: 612e 6e61 6d65 0a0a 2020 2020 406e 616d  a.name..    @nam
-00021a40: 652e 7365 7474 6572 0a20 2020 2064 6566  e.setter.    def
-00021a50: 206e 616d 6528 7365 6c66 2c20 6e61 6d65   name(self, name
-00021a60: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-00021a70: 5f6d 6574 612e 6e61 6d65 203d 206e 616d  _meta.name = nam
-00021a80: 650a 2020 2020 2020 2020 7265 6e61 6d65  e.        rename
-00021a90: 6420 3d20 5f72 656e 616d 655f 6461 736b  d = _rename_dask
-00021aa0: 2873 656c 662c 206e 616d 6529 0a20 2020  (self, name).   
-00021ab0: 2020 2020 2023 2075 7064 6174 6520 6d79       # update my
-00021ac0: 7365 6c66 0a20 2020 2020 2020 2073 656c  self.        sel
-00021ad0: 662e 6461 736b 203d 2072 656e 616d 6564  f.dask = renamed
-00021ae0: 2e64 6173 6b0a 2020 2020 2020 2020 7365  .dask.        se
-00021af0: 6c66 2e5f 6e61 6d65 203d 2072 656e 616d  lf._name = renam
-00021b00: 6564 2e5f 6e61 6d65 0a0a 2020 2020 4070  ed._name..    @p
-00021b10: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00021b20: 6e64 696d 2873 656c 6629 3a0a 2020 2020  ndim(self):.    
-00021b30: 2020 2020 2222 2252 6574 7572 6e20 6469      """Return di
-00021b40: 6d65 6e73 696f 6e61 6c69 7479 2222 220a  mensionality""".
-00021b50: 2020 2020 2020 2020 7265 7475 726e 2031          return 1
-00021b60: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00021b70: 2020 2020 6465 6620 7368 6170 6528 7365      def shape(se
-00021b80: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00021b90: 0a20 2020 2020 2020 2052 6574 7572 6e20  .        Return 
-00021ba0: 6120 7475 706c 6520 7265 7072 6573 656e  a tuple represen
-00021bb0: 7469 6e67 2074 6865 2064 696d 656e 7369  ting the dimensi
-00021bc0: 6f6e 616c 6974 7920 6f66 2061 2053 6572  onality of a Ser
-00021bd0: 6965 732e 0a0a 2020 2020 2020 2020 5468  ies...        Th
-00021be0: 6520 7369 6e67 6c65 2065 6c65 6d65 6e74  e single element
-00021bf0: 206f 6620 7468 6520 7475 706c 6520 6973   of the tuple is
-00021c00: 2061 2044 656c 6179 6564 2072 6573 756c   a Delayed resul
-00021c10: 742e 0a0a 2020 2020 2020 2020 4578 616d  t...        Exam
-00021c20: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
-00021c30: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
-00021c40: 3e20 7365 7269 6573 2e73 6861 7065 2020  > series.shape  
-00021c50: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
-00021c60: 0a20 2020 2020 2020 2028 6464 2e53 6361  .        (dd.Sca
-00021c70: 6c61 723c 7369 7a65 2d61 672e 2e2e 2c20  lar<size-ag..., 
-00021c80: 6474 7970 653d 696e 7436 343e 2c29 0a20  dtype=int64>,). 
-00021c90: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00021ca0: 2020 2072 6574 7572 6e20 2873 656c 662e     return (self.
-00021cb0: 7369 7a65 2c29 0a0a 2020 2020 4070 726f  size,)..    @pro
-00021cc0: 7065 7274 790a 2020 2020 6465 6620 6474  perty.    def dt
-00021cd0: 7970 6528 7365 6c66 293a 0a20 2020 2020  ype(self):.     
-00021ce0: 2020 2022 2222 5265 7475 726e 2064 6174     """Return dat
-00021cf0: 6120 7479 7065 2222 220a 2020 2020 2020  a type""".      
-00021d00: 2020 7265 7475 726e 2073 656c 662e 5f6d    return self._m
-00021d10: 6574 612e 6474 7970 650a 0a20 2020 2064  eta.dtype..    d
-00021d20: 7420 3d20 4361 6368 6564 4163 6365 7373  t = CachedAccess
-00021d30: 6f72 2822 6474 222c 2044 6174 6574 696d  or("dt", Datetim
-00021d40: 6541 6363 6573 736f 7229 0a0a 2020 2020  eAccessor)..    
-00021d50: 6361 7420 3d20 4361 6368 6564 4163 6365  cat = CachedAcce
-00021d60: 7373 6f72 2822 6361 7422 2c20 4361 7465  ssor("cat", Cate
-00021d70: 676f 7269 6361 6c41 6363 6573 736f 7229  goricalAccessor)
-00021d80: 0a0a 2020 2020 7374 7220 3d20 4361 6368  ..    str = Cach
-00021d90: 6564 4163 6365 7373 6f72 2822 7374 7222  edAccessor("str"
-00021da0: 2c20 5374 7269 6e67 4163 6365 7373 6f72  , StringAccessor
-00021db0: 290a 0a20 2020 2064 6566 205f 5f64 6972  )..    def __dir
-00021dc0: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-00021dd0: 2020 6f20 3d20 7365 7428 6469 7228 7479    o = set(dir(ty
-00021de0: 7065 2873 656c 6629 2929 0a20 2020 2020  pe(self))).     
-00021df0: 2020 206f 2e75 7064 6174 6528 7365 6c66     o.update(self
-00021e00: 2e5f 5f64 6963 745f 5f29 0a20 2020 2020  .__dict__).     
-00021e10: 2020 2023 2052 656d 6f76 6520 7468 6520     # Remove the 
-00021e20: 6063 6174 6020 616e 6420 6073 7472 6020  `cat` and `str` 
-00021e30: 6163 6365 7373 6f72 7320 6966 206e 6f74  accessors if not
-00021e40: 2061 7661 696c 6162 6c65 2e20 5765 2063   available. We c
-00021e50: 616e 2774 0a20 2020 2020 2020 2023 2064  an't.        # d
-00021e60: 6563 6964 6520 7468 6973 2073 7461 7469  ecide this stati
-00021e70: 6361 6c6c 7920 666f 7220 7468 6520 6064  cally for the `d
-00021e80: 7460 2061 6363 6573 736f 722c 2061 7320  t` accessor, as 
-00021e90: 6974 2077 6f72 6b73 206f 6e0a 2020 2020  it works on.    
-00021ea0: 2020 2020 2320 6461 7465 7469 6d65 2d6c      # datetime-l
-00021eb0: 696b 6520 7468 696e 6773 2061 7320 7765  ike things as we
-00021ec0: 6c6c 2e0a 2020 2020 2020 2020 666f 7220  ll..        for 
-00021ed0: 6163 6365 7373 6f72 2069 6e20 5b22 6361  accessor in ["ca
-00021ee0: 7422 2c20 2273 7472 225d 3a0a 2020 2020  t", "str"]:.    
-00021ef0: 2020 2020 2020 2020 6966 206e 6f74 2068          if not h
-00021f00: 6173 6174 7472 2873 656c 662e 5f6d 6574  asattr(self._met
-00021f10: 612c 2061 6363 6573 736f 7229 3a0a 2020  a, accessor):.  
-00021f20: 2020 2020 2020 2020 2020 2020 2020 6f2e                o.
-00021f30: 7265 6d6f 7665 2861 6363 6573 736f 7229  remove(accessor)
-00021f40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00021f50: 6c69 7374 286f 290a 0a20 2020 2040 7072  list(o)..    @pr
-00021f60: 6f70 6572 7479 0a20 2020 2064 6566 206e  operty.    def n
-00021f70: 6279 7465 7328 7365 6c66 293a 0a20 2020  bytes(self):.   
-00021f80: 2020 2020 2022 2222 4e75 6d62 6572 206f       """Number o
-00021f90: 6620 6279 7465 7322 2222 0a20 2020 2020  f bytes""".     
-00021fa0: 2020 2072 6574 7572 6e20 7365 6c66 2e72     return self.r
-00021fb0: 6564 7563 7469 6f6e 280a 2020 2020 2020  eduction(.      
-00021fc0: 2020 2020 2020 6d65 7468 6f64 732e 6e62        methods.nb
-00021fd0: 7974 6573 2c20 6e70 2e73 756d 2c20 746f  ytes, np.sum, to
-00021fe0: 6b65 6e3d 226e 6279 7465 7322 2c20 6d65  ken="nbytes", me
-00021ff0: 7461 3d69 6e74 2c20 7370 6c69 745f 6576  ta=int, split_ev
-00022000: 6572 793d 4661 6c73 650a 2020 2020 2020  ery=False.      
-00022010: 2020 290a 0a20 2020 2064 6566 205f 7265    )..    def _re
-00022020: 7072 5f64 6174 6128 7365 6c66 293a 0a20  pr_data(self):. 
-00022030: 2020 2020 2020 2072 6574 7572 6e20 5f72         return _r
-00022040: 6570 725f 6461 7461 5f73 6572 6965 7328  epr_data_series(
-00022050: 7365 6c66 2e5f 6d65 7461 2c20 7365 6c66  self._meta, self
-00022060: 2e5f 7265 7072 5f64 6976 6973 696f 6e73  ._repr_divisions
-00022070: 290a 0a20 2020 2064 6566 205f 5f72 6570  )..    def __rep
-00022080: 725f 5f28 7365 6c66 293a 0a20 2020 2020  r__(self):.     
-00022090: 2020 2022 2222 6861 7665 2074 6f20 6f76     """have to ov
-000220a0: 6572 7772 6974 6520 666f 6f74 6572 2222  erwrite footer""
-000220b0: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
-000220c0: 662e 6e61 6d65 2069 7320 6e6f 7420 4e6f  f.name is not No
-000220d0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-000220e0: 666f 6f74 6572 203d 2066 224e 616d 653a  footer = f"Name:
-000220f0: 207b 7365 6c66 2e6e 616d 657d 2c20 6474   {self.name}, dt
-00022100: 7970 653a 207b 7365 6c66 2e64 7479 7065  ype: {self.dtype
-00022110: 7d22 0a20 2020 2020 2020 2065 6c73 653a  }".        else:
-00022120: 0a20 2020 2020 2020 2020 2020 2066 6f6f  .            foo
-00022130: 7465 7220 3d20 6622 6474 7970 653a 207b  ter = f"dtype: {
-00022140: 7365 6c66 2e64 7479 7065 7d22 0a0a 2020  self.dtype}"..  
-00022150: 2020 2020 2020 7265 7475 726e 2022 2222        return """
-00022160: 4461 736b 207b 6b6c 6173 737d 2053 7472  Dask {klass} Str
-00022170: 7563 7475 7265 3a0a 7b64 6174 617d 0a7b  ucture:.{data}.{
-00022180: 666f 6f74 6572 7d0a 4461 736b 204e 616d  footer}.Dask Nam
-00022190: 653a 207b 6e61 6d65 7d2c 207b 6c61 7965  e: {name}, {laye
-000221a0: 7273 7d22 2222 2e66 6f72 6d61 7428 0a20  rs}""".format(. 
-000221b0: 2020 2020 2020 2020 2020 206b 6c61 7373             klass
-000221c0: 3d73 656c 662e 5f5f 636c 6173 735f 5f2e  =self.__class__.
-000221d0: 5f5f 6e61 6d65 5f5f 2c0a 2020 2020 2020  __name__,.      
-000221e0: 2020 2020 2020 6461 7461 3d73 656c 662e        data=self.
-000221f0: 746f 5f73 7472 696e 6728 292c 0a20 2020  to_string(),.   
-00022200: 2020 2020 2020 2020 2066 6f6f 7465 723d           footer=
-00022210: 666f 6f74 6572 2c0a 2020 2020 2020 2020  footer,.        
-00022220: 2020 2020 6e61 6d65 3d6b 6579 5f73 706c      name=key_spl
-00022230: 6974 2873 656c 662e 5f6e 616d 6529 2c0a  it(self._name),.
-00022240: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
-00022250: 7273 3d6d 6179 6265 5f70 6c75 7261 6c69  rs=maybe_plurali
-00022260: 7a65 286c 656e 2873 656c 662e 6461 736b  ze(len(self.dask
-00022270: 2e6c 6179 6572 7329 2c20 2267 7261 7068  .layers), "graph
-00022280: 206c 6179 6572 2229 2c0a 2020 2020 2020   layer"),.      
-00022290: 2020 290a 0a20 2020 2064 6566 2072 656e    )..    def ren
-000222a0: 616d 6528 7365 6c66 2c20 696e 6465 783d  ame(self, index=
-000222b0: 4e6f 6e65 2c20 696e 706c 6163 653d 6e6f  None, inplace=no
-000222c0: 5f64 6566 6175 6c74 2c20 736f 7274 6564  _default, sorted
-000222d0: 5f69 6e64 6578 3d46 616c 7365 293a 0a20  _index=False):. 
-000222e0: 2020 2020 2020 2022 2222 416c 7465 7220         """Alter 
-000222f0: 5365 7269 6573 2069 6e64 6578 206c 6162  Series index lab
-00022300: 656c 7320 6f72 206e 616d 650a 0a20 2020  els or name..   
-00022310: 2020 2020 2046 756e 6374 696f 6e20 2f20       Function / 
-00022320: 6469 6374 2076 616c 7565 7320 6d75 7374  dict values must
-00022330: 2062 6520 756e 6971 7565 2028 312d 746f   be unique (1-to
-00022340: 2d31 292e 204c 6162 656c 7320 6e6f 7420  -1). Labels not 
-00022350: 636f 6e74 6169 6e65 6420 696e 0a20 2020  contained in.   
-00022360: 2020 2020 2061 2064 6963 7420 2f20 5365       a dict / Se
-00022370: 7269 6573 2077 696c 6c20 6265 206c 6566  ries will be lef
-00022380: 7420 6173 2d69 732e 2045 7874 7261 206c  t as-is. Extra l
-00022390: 6162 656c 7320 6c69 7374 6564 2064 6f6e  abels listed don
-000223a0: 2774 2074 6872 6f77 2061 6e0a 2020 2020  't throw an.    
-000223b0: 2020 2020 6572 726f 722e 0a0a 2020 2020      error...    
-000223c0: 2020 2020 416c 7465 726e 6174 6976 656c      Alternativel
-000223d0: 792c 2063 6861 6e67 6520 6060 5365 7269  y, change ``Seri
-000223e0: 6573 2e6e 616d 6560 6020 7769 7468 2061  es.name`` with a
-000223f0: 2073 6361 6c61 7220 7661 6c75 652e 0a0a   scalar value...
-00022400: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00022410: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00022420: 2d2d 2d2d 2d0a 2020 2020 2020 2020 696e  -----.        in
-00022430: 6465 7820 3a20 7363 616c 6172 2c20 6861  dex : scalar, ha
-00022440: 7368 6162 6c65 2073 6571 7565 6e63 652c  shable sequence,
-00022450: 2064 6963 742d 6c69 6b65 206f 7220 6361   dict-like or ca
-00022460: 6c6c 6162 6c65 2c20 6f70 7469 6f6e 616c  llable, optional
-00022470: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00022480: 6469 6374 2d6c 696b 6520 6f72 2063 616c  dict-like or cal
-00022490: 6c61 626c 652c 2074 6865 2074 7261 6e73  lable, the trans
-000224a0: 666f 726d 6174 696f 6e20 6973 2061 7070  formation is app
-000224b0: 6c69 6564 2074 6f20 7468 650a 2020 2020  lied to the.    
-000224c0: 2020 2020 2020 2020 696e 6465 782e 2053          index. S
-000224d0: 6361 6c61 7220 6f72 2068 6173 6861 626c  calar or hashabl
-000224e0: 6520 7365 7175 656e 6365 2d6c 696b 6520  e sequence-like 
-000224f0: 7769 6c6c 2061 6c74 6572 2074 6865 0a20  will alter the. 
-00022500: 2020 2020 2020 2020 2020 2060 6053 6572             ``Ser
-00022510: 6965 732e 6e61 6d65 6060 2061 7474 7269  ies.name`` attri
-00022520: 6275 7465 2e0a 2020 2020 2020 2020 696e  bute..        in
-00022530: 706c 6163 6520 3a20 626f 6f6c 6561 6e2c  place : boolean,
-00022540: 2064 6566 6175 6c74 2046 616c 7365 0a20   default False. 
-00022550: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
-00022560: 6572 2074 6f20 7265 7475 726e 2061 206e  er to return a n
-00022570: 6577 2053 6572 6965 7320 6f72 206d 6f64  ew Series or mod
-00022580: 6966 7920 7468 6973 206f 6e65 2069 6e70  ify this one inp
-00022590: 6c61 6365 2e0a 2020 2020 2020 2020 736f  lace..        so
-000225a0: 7274 6564 5f69 6e64 6578 203a 2062 6f6f  rted_index : boo
-000225b0: 6c2c 2064 6566 6175 6c74 2046 616c 7365  l, default False
-000225c0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-000225d0: 7472 7565 2c20 7468 6520 6f75 7470 7574  true, the output
-000225e0: 2060 6053 6572 6965 7360 6020 7769 6c6c   ``Series`` will
-000225f0: 2068 6176 6520 6b6e 6f77 6e20 6469 7669   have known divi
-00022600: 7369 6f6e 7320 696e 6665 7272 6564 0a20  sions inferred. 
-00022610: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
-00022620: 7468 6520 696e 7075 7420 7365 7269 6573  the input series
-00022630: 2061 6e64 2074 6865 2074 7261 6e73 666f   and the transfo
-00022640: 726d 6174 696f 6e2e 2049 676e 6f72 6564  rmation. Ignored
-00022650: 2066 6f72 0a20 2020 2020 2020 2020 2020   for.           
-00022660: 206e 6f6e 2d63 616c 6c61 626c 652f 6469   non-callable/di
-00022670: 6374 2d6c 696b 6520 6060 696e 6465 7860  ct-like ``index`
-00022680: 6020 6f72 2077 6865 6e20 7468 6520 696e  ` or when the in
-00022690: 7075 7420 7365 7269 6573 2068 6173 0a20  put series has. 
-000226a0: 2020 2020 2020 2020 2020 2075 6e6b 6e6f             unkno
-000226b0: 776e 2064 6976 6973 696f 6e73 2e20 4e6f  wn divisions. No
-000226c0: 7465 2074 6861 7420 7468 6973 206d 6179  te that this may
-000226d0: 206f 6e6c 7920 6265 2073 6574 2074 6f20   only be set to 
-000226e0: 6060 5472 7565 6060 2069 660a 2020 2020  ``True`` if.    
-000226f0: 2020 2020 2020 2020 796f 7520 6b6e 6f77          you know
-00022700: 2074 6861 7420 7468 6520 7472 616e 7366   that the transf
-00022710: 6f72 6d65 6420 696e 6465 7820 6973 206d  ormed index is m
-00022720: 6f6e 6f74 6f6e 6963 616c 6c79 2069 6e63  onotonically inc
-00022730: 7265 6173 696e 672e 2044 6173 6b0a 2020  reasing. Dask.  
-00022740: 2020 2020 2020 2020 2020 7769 6c6c 2063            will c
-00022750: 6865 636b 2074 6861 7420 7472 616e 7366  heck that transf
-00022760: 6f72 6d65 6420 6469 7669 7369 6f6e 7320  ormed divisions 
-00022770: 6172 6520 6d6f 6e6f 746f 6e69 632c 2062  are monotonic, b
-00022780: 7574 2063 616e 6e6f 740a 2020 2020 2020  ut cannot.      
-00022790: 2020 2020 2020 6368 6563 6b20 616c 6c20        check all 
-000227a0: 7468 6520 7661 6c75 6573 2062 6574 7765  the values betwe
-000227b0: 656e 2064 6976 6973 696f 6e73 2c20 736f  en divisions, so
-000227c0: 2069 6e63 6f72 7265 6374 6c79 2073 6574   incorrectly set
-000227d0: 7469 6e67 2074 6869 730a 2020 2020 2020  ting this.      
-000227e0: 2020 2020 2020 6361 6e20 7265 7375 6c74        can result
-000227f0: 2069 6e20 6275 6773 2e0a 0a20 2020 2020   in bugs...     
-00022800: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-00022810: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-00022820: 2020 2072 656e 616d 6564 203a 2053 6572     renamed : Ser
-00022830: 6965 730a 0a20 2020 2020 2020 2053 6565  ies..        See
-00022840: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-00022850: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2070  ------.        p
-00022860: 616e 6461 732e 5365 7269 6573 2e72 656e  andas.Series.ren
-00022870: 616d 650a 2020 2020 2020 2020 2222 220a  ame.        """.
-00022880: 2020 2020 2020 2020 6672 6f6d 2070 616e          from pan
-00022890: 6461 732e 6170 692e 7479 7065 7320 696d  das.api.types im
-000228a0: 706f 7274 2069 735f 6469 6374 5f6c 696b  port is_dict_lik
-000228b0: 652c 2069 735f 6c69 7374 5f6c 696b 652c  e, is_list_like,
-000228c0: 2069 735f 7363 616c 6172 0a0a 2020 2020   is_scalar..    
-000228d0: 2020 2020 696d 706f 7274 2064 6173 6b2e      import dask.
-000228e0: 6461 7461 6672 616d 6520 6173 2064 640a  dataframe as dd.
-000228f0: 0a20 2020 2020 2020 2069 6620 696e 706c  .        if inpl
-00022900: 6163 6520 6973 206e 6f74 206e 6f5f 6465  ace is not no_de
-00022910: 6661 756c 743a 0a20 2020 2020 2020 2020  fault:.         
-00022920: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-00022930: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00022940: 2020 2227 696e 706c 6163 6527 2061 7267    "'inplace' arg
-00022950: 756d 656e 7420 666f 7220 6461 736b 2073  ument for dask s
-00022960: 6572 6965 7320 7769 6c6c 2062 6520 7265  eries will be re
-00022970: 6d6f 7665 6420 696e 2066 7574 7572 6520  moved in future 
-00022980: 7665 7273 696f 6e73 222c 0a20 2020 2020  versions",.     
-00022990: 2020 2020 2020 2020 2020 2046 7574 7572             Futur
-000229a0: 6557 6172 6e69 6e67 2c0a 2020 2020 2020  eWarning,.      
-000229b0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000229c0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000229d0: 2020 696e 706c 6163 6520 3d20 4661 6c73    inplace = Fals
-000229e0: 650a 0a20 2020 2020 2020 2069 6620 6973  e..        if is
-000229f0: 5f73 6361 6c61 7228 696e 6465 7829 206f  _scalar(index) o
-00022a00: 7220 280a 2020 2020 2020 2020 2020 2020  r (.            
-00022a10: 6973 5f6c 6973 745f 6c69 6b65 2869 6e64  is_list_like(ind
-00022a20: 6578 290a 2020 2020 2020 2020 2020 2020  ex).            
-00022a30: 616e 6420 6e6f 7420 6973 5f64 6963 745f  and not is_dict_
-00022a40: 6c69 6b65 2869 6e64 6578 290a 2020 2020  like(index).    
-00022a50: 2020 2020 2020 2020 616e 6420 6e6f 7420          and not 
-00022a60: 6973 696e 7374 616e 6365 2869 6e64 6578  isinstance(index
-00022a70: 2c20 6464 2e53 6572 6965 7329 0a20 2020  , dd.Series).   
-00022a80: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-00022a90: 2020 2020 7265 7320 3d20 7365 6c66 2069      res = self i
-00022aa0: 6620 696e 706c 6163 6520 656c 7365 2073  f inplace else s
-00022ab0: 656c 662e 636f 7079 2829 0a20 2020 2020  elf.copy().     
-00022ac0: 2020 2020 2020 2072 6573 2e6e 616d 6520         res.name 
-00022ad0: 3d20 696e 6465 780a 2020 2020 2020 2020  = index.        
-00022ae0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00022af0: 2020 7265 7320 3d20 7365 6c66 2e6d 6170    res = self.map
-00022b00: 5f70 6172 7469 7469 6f6e 7328 4d2e 7265  _partitions(M.re
-00022b10: 6e61 6d65 2c20 696e 6465 782c 2065 6e66  name, index, enf
-00022b20: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
-00022b30: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
-00022b40: 2069 6620 7365 6c66 2e6b 6e6f 776e 5f64   if self.known_d
-00022b50: 6976 6973 696f 6e73 3a0a 2020 2020 2020  ivisions:.      
-00022b60: 2020 2020 2020 2020 2020 6966 2073 6f72            if sor
-00022b70: 7465 645f 696e 6465 7820 616e 6420 2863  ted_index and (c
-00022b80: 616c 6c61 626c 6528 696e 6465 7829 206f  allable(index) o
-00022b90: 7220 6973 5f64 6963 745f 6c69 6b65 2869  r is_dict_like(i
-00022ba0: 6e64 6578 2929 3a0a 2020 2020 2020 2020  ndex)):.        
-00022bb0: 2020 2020 2020 2020 2020 2020 6f6c 6420              old 
-00022bc0: 3d20 7064 2e53 6572 6965 7328 7261 6e67  = pd.Series(rang
-00022bd0: 6528 7365 6c66 2e6e 7061 7274 6974 696f  e(self.npartitio
-00022be0: 6e73 202b 2031 292c 2069 6e64 6578 3d73  ns + 1), index=s
-00022bf0: 656c 662e 6469 7669 7369 6f6e 7329 0a20  elf.divisions). 
-00022c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022c10: 2020 206e 6577 203d 206f 6c64 2e72 656e     new = old.ren
-00022c20: 616d 6528 696e 6465 7829 2e69 6e64 6578  ame(index).index
-00022c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022c40: 2020 2020 2069 6620 6e6f 7420 6e65 772e       if not new.
-00022c50: 6973 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63  is_monotonic_inc
-00022c60: 7265 6173 696e 673a 0a20 2020 2020 2020  reasing:.       
-00022c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022c80: 206d 7367 203d 2028 0a20 2020 2020 2020   msg = (.       
-00022c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022ca0: 2020 2020 2022 736f 7274 6564 5f69 6e64       "sorted_ind
-00022cb0: 6578 3d54 7275 652c 2062 7574 2074 6865  ex=True, but the
-00022cc0: 2074 7261 6e73 666f 726d 6564 2069 6e64   transformed ind
-00022cd0: 6578 2022 0a20 2020 2020 2020 2020 2020  ex ".           
+0001d920: 206d 6574 686f 6473 2e5f 6375 6d5f 6167   methods._cum_ag
+0001d930: 6772 6567 6174 655f 6170 706c 792c 0a20  gregate_apply,. 
+0001d940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d950: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
+0001d960: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001d970: 2020 2020 2020 2020 2020 2863 6e61 6d65            (cname
+0001d980: 2c20 6920 2d20 3129 2c0a 2020 2020 2020  , i - 1),.      
+0001d990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d9a0: 2020 2863 756d 6c61 7374 2e5f 6e61 6d65    (cumlast._name
+0001d9b0: 2c20 6920 2d20 3129 2c0a 2020 2020 2020  , i - 1),.      
+0001d9c0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0001d9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d9e0: 6c61 7965 725b 286e 616d 652c 2069 295d  layer[(name, i)]
+0001d9f0: 203d 2028 6167 6772 6567 6174 652c 2028   = (aggregate, (
+0001da00: 6375 6d70 6172 742e 5f6e 616d 652c 2069  cumpart._name, i
+0001da10: 292c 2028 636e 616d 652c 2069 2929 0a20  ), (cname, i)). 
+0001da20: 2020 2020 2020 2020 2020 2067 7261 7068             graph
+0001da30: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+0001da40: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+0001da50: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
+0001da60: 2020 2020 6e61 6d65 2c20 6c61 7965 722c      name, layer,
+0001da70: 2064 6570 656e 6465 6e63 6965 733d 5b63   dependencies=[c
+0001da80: 756d 7061 7274 2c20 6375 6d6c 6173 745d  umpart, cumlast]
+0001da90: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001daa0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+0001dab0: 7420 3d20 6e65 775f 6464 5f6f 626a 6563  t = new_dd_objec
+0001dac0: 7428 6772 6170 682c 206e 616d 652c 2063  t(graph, name, c
+0001dad0: 6875 6e6b 2873 656c 662e 5f6d 6574 6129  hunk(self._meta)
+0001dae0: 2c20 7365 6c66 2e64 6976 6973 696f 6e73  , self.divisions
+0001daf0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+0001db00: 7475 726e 2068 616e 646c 655f 6f75 7428  turn handle_out(
+0001db10: 6f75 742c 2072 6573 756c 7429 0a0a 2020  out, result)..  
+0001db20: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+0001db30: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+0001db40: 2020 6465 6620 6375 6d73 756d 2873 656c    def cumsum(sel
+0001db50: 662c 2061 7869 733d 4e6f 6e65 2c20 736b  f, axis=None, sk
+0001db60: 6970 6e61 3d54 7275 652c 2064 7479 7065  ipna=True, dtype
+0001db70: 3d4e 6f6e 652c 206f 7574 3d4e 6f6e 6529  =None, out=None)
+0001db80: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001db90: 2073 656c 662e 5f63 756d 5f61 6767 280a   self._cum_agg(.
+0001dba0: 2020 2020 2020 2020 2020 2020 2263 756d              "cum
+0001dbb0: 7375 6d22 2c0a 2020 2020 2020 2020 2020  sum",.          
+0001dbc0: 2020 6368 756e 6b3d 4d2e 6375 6d73 756d    chunk=M.cumsum
+0001dbd0: 2c0a 2020 2020 2020 2020 2020 2020 6167  ,.            ag
+0001dbe0: 6772 6567 6174 653d 6d65 7468 6f64 732e  gregate=methods.
+0001dbf0: 6375 6d73 756d 5f61 6767 7265 6761 7465  cumsum_aggregate
+0001dc00: 2c0a 2020 2020 2020 2020 2020 2020 6178  ,.            ax
+0001dc10: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
+0001dc20: 2020 2020 2073 6b69 706e 613d 736b 6970       skipna=skip
+0001dc30: 6e61 2c0a 2020 2020 2020 2020 2020 2020  na,.            
+0001dc40: 6368 756e 6b5f 6b77 6172 6773 3d64 6963  chunk_kwargs=dic
+0001dc50: 7428 6178 6973 3d61 7869 732c 2073 6b69  t(axis=axis, ski
+0001dc60: 706e 613d 736b 6970 6e61 292c 0a20 2020  pna=skipna),.   
+0001dc70: 2020 2020 2020 2020 206f 7574 3d6f 7574           out=out
+0001dc80: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0001dc90: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+0001dca0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+0001dcb0: 2064 6566 2063 756d 7072 6f64 2873 656c   def cumprod(sel
+0001dcc0: 662c 2061 7869 733d 4e6f 6e65 2c20 736b  f, axis=None, sk
+0001dcd0: 6970 6e61 3d54 7275 652c 2064 7479 7065  ipna=True, dtype
+0001dce0: 3d4e 6f6e 652c 206f 7574 3d4e 6f6e 6529  =None, out=None)
+0001dcf0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001dd00: 2073 656c 662e 5f63 756d 5f61 6767 280a   self._cum_agg(.
+0001dd10: 2020 2020 2020 2020 2020 2020 2263 756d              "cum
+0001dd20: 7072 6f64 222c 0a20 2020 2020 2020 2020  prod",.         
+0001dd30: 2020 2063 6875 6e6b 3d4d 2e63 756d 7072     chunk=M.cumpr
+0001dd40: 6f64 2c0a 2020 2020 2020 2020 2020 2020  od,.            
+0001dd50: 6167 6772 6567 6174 653d 6d65 7468 6f64  aggregate=method
+0001dd60: 732e 6375 6d70 726f 645f 6167 6772 6567  s.cumprod_aggreg
+0001dd70: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+0001dd80: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
+0001dd90: 2020 2020 2020 2020 736b 6970 6e61 3d73          skipna=s
+0001dda0: 6b69 706e 612c 0a20 2020 2020 2020 2020  kipna,.         
+0001ddb0: 2020 2063 6875 6e6b 5f6b 7761 7267 733d     chunk_kwargs=
+0001ddc0: 6469 6374 2861 7869 733d 6178 6973 2c20  dict(axis=axis, 
+0001ddd0: 736b 6970 6e61 3d73 6b69 706e 6129 2c0a  skipna=skipna),.
+0001dde0: 2020 2020 2020 2020 2020 2020 6f75 743d              out=
+0001ddf0: 6f75 742c 0a20 2020 2020 2020 2029 0a0a  out,.        )..
+0001de00: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+0001de10: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+0001de20: 2020 2020 6465 6620 6375 6d6d 6178 2873      def cummax(s
+0001de30: 656c 662c 2061 7869 733d 4e6f 6e65 2c20  elf, axis=None, 
+0001de40: 736b 6970 6e61 3d54 7275 652c 206f 7574  skipna=True, out
+0001de50: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+0001de60: 7265 7475 726e 2073 656c 662e 5f63 756d  return self._cum
+0001de70: 5f61 6767 280a 2020 2020 2020 2020 2020  _agg(.          
+0001de80: 2020 2263 756d 6d61 7822 2c0a 2020 2020    "cummax",.    
+0001de90: 2020 2020 2020 2020 6368 756e 6b3d 4d2e          chunk=M.
+0001dea0: 6375 6d6d 6178 2c0a 2020 2020 2020 2020  cummax,.        
+0001deb0: 2020 2020 6167 6772 6567 6174 653d 6d65      aggregate=me
+0001dec0: 7468 6f64 732e 6375 6d6d 6178 5f61 6767  thods.cummax_agg
+0001ded0: 7265 6761 7465 2c0a 2020 2020 2020 2020  regate,.        
+0001dee0: 2020 2020 6178 6973 3d61 7869 732c 0a20      axis=axis,. 
+0001def0: 2020 2020 2020 2020 2020 2073 6b69 706e             skipn
+0001df00: 613d 736b 6970 6e61 2c0a 2020 2020 2020  a=skipna,.      
+0001df10: 2020 2020 2020 6368 756e 6b5f 6b77 6172        chunk_kwar
+0001df20: 6773 3d64 6963 7428 6178 6973 3d61 7869  gs=dict(axis=axi
+0001df30: 732c 2073 6b69 706e 613d 736b 6970 6e61  s, skipna=skipna
+0001df40: 292c 0a20 2020 2020 2020 2020 2020 206f  ),.            o
+0001df50: 7574 3d6f 7574 2c0a 2020 2020 2020 2020  ut=out,.        
+0001df60: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+0001df70: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+0001df80: 6529 0a20 2020 2064 6566 2063 756d 6d69  e).    def cummi
+0001df90: 6e28 7365 6c66 2c20 6178 6973 3d4e 6f6e  n(self, axis=Non
+0001dfa0: 652c 2073 6b69 706e 613d 5472 7565 2c20  e, skipna=True, 
+0001dfb0: 6f75 743d 4e6f 6e65 293a 0a20 2020 2020  out=None):.     
+0001dfc0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0001dfd0: 6375 6d5f 6167 6728 0a20 2020 2020 2020  cum_agg(.       
+0001dfe0: 2020 2020 2022 6375 6d6d 696e 222c 0a20       "cummin",. 
+0001dff0: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
+0001e000: 3d4d 2e63 756d 6d69 6e2c 0a20 2020 2020  =M.cummin,.     
+0001e010: 2020 2020 2020 2061 6767 7265 6761 7465         aggregate
+0001e020: 3d6d 6574 686f 6473 2e63 756d 6d69 6e5f  =methods.cummin_
+0001e030: 6167 6772 6567 6174 652c 0a20 2020 2020  aggregate,.     
+0001e040: 2020 2020 2020 2061 7869 733d 6178 6973         axis=axis
+0001e050: 2c0a 2020 2020 2020 2020 2020 2020 736b  ,.            sk
+0001e060: 6970 6e61 3d73 6b69 706e 612c 0a20 2020  ipna=skipna,.   
+0001e070: 2020 2020 2020 2020 2063 6875 6e6b 5f6b           chunk_k
+0001e080: 7761 7267 733d 6469 6374 2861 7869 733d  wargs=dict(axis=
+0001e090: 6178 6973 2c20 736b 6970 6e61 3d73 6b69  axis, skipna=ski
+0001e0a0: 706e 6129 2c0a 2020 2020 2020 2020 2020  pna),.          
+0001e0b0: 2020 6f75 743d 6f75 742c 0a20 2020 2020    out=out,.     
+0001e0c0: 2020 2029 0a0a 2020 2020 6465 6620 5f76     )..    def _v
+0001e0d0: 616c 6964 6174 655f 636f 6e64 6974 696f  alidate_conditio
+0001e0e0: 6e28 7365 6c66 2c20 636f 6e64 293a 0a20  n(self, cond):. 
+0001e0f0: 2020 2020 2020 2063 6f6e 645f 7265 7320         cond_res 
+0001e100: 3d20 636f 6e64 2873 656c 662e 5f6d 6574  = cond(self._met
+0001e110: 6129 2069 6620 6361 6c6c 6162 6c65 2863  a) if callable(c
+0001e120: 6f6e 6429 2065 6c73 6520 636f 6e64 0a20  ond) else cond. 
+0001e130: 2020 2020 2020 2069 6620 6e6f 7420 280a         if not (.
+0001e140: 2020 2020 2020 2020 2020 2020 6973 5f64              is_d
+0001e150: 6173 6b5f 636f 6c6c 6563 7469 6f6e 2863  ask_collection(c
+0001e160: 6f6e 645f 7265 7329 0a20 2020 2020 2020  ond_res).       
+0001e170: 2020 2020 206f 7220 6973 5f64 6174 6166       or is_dataf
+0001e180: 7261 6d65 5f6c 696b 6528 636f 6e64 5f72  rame_like(cond_r
+0001e190: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
+0001e1a0: 6f72 2069 735f 7365 7269 6573 5f6c 696b  or is_series_lik
+0001e1b0: 6528 636f 6e64 5f72 6573 290a 2020 2020  e(cond_res).    
+0001e1c0: 2020 2020 2020 2020 6f72 2069 735f 696e          or is_in
+0001e1d0: 6465 785f 6c69 6b65 2863 6f6e 645f 7265  dex_like(cond_re
+0001e1e0: 7329 0a20 2020 2020 2020 2029 3a0a 2020  s).        ):.  
+0001e1f0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001e200: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+0001e210: 2020 2020 2020 2020 2020 2020 6622 436f              f"Co
+0001e220: 6e64 6974 696f 6e20 7368 6f75 6c64 2062  ndition should b
+0001e230: 6520 616e 206f 626a 6563 7420 7468 6174  e an object that
+0001e240: 2063 616e 2062 6520 616c 6967 6e65 6420   can be aligned 
+0001e250: 7769 7468 207b 7365 6c66 2e5f 5f63 6c61  with {self.__cla
+0001e260: 7373 5f5f 7d2c 2022 0a20 2020 2020 2020  ss__}, ".       
+0001e270: 2020 2020 2020 2020 2066 2220 7768 6963           f" whic
+0001e280: 6820 696e 636c 7564 6573 2044 6173 6b20  h includes Dask 
+0001e290: 6f72 2070 616e 6461 7320 636f 6c6c 6563  or pandas collec
+0001e2a0: 7469 6f6e 732c 2044 6174 6146 7261 6d65  tions, DataFrame
+0001e2b0: 7320 6f72 2053 6572 6965 732c 206f 7220  s or Series, or 
+0001e2c0: 6120 4361 6c6c 6162 6c65 2e22 0a20 2020  a Callable.".   
+0001e2d0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0001e2e0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+0001e2f0: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+0001e300: 6465 6620 7768 6572 6528 7365 6c66 2c20  def where(self, 
+0001e310: 636f 6e64 2c20 6f74 6865 723d 6e70 2e6e  cond, other=np.n
+0001e320: 616e 293a 0a20 2020 2020 2020 2023 2063  an):.        # c
+0001e330: 6f6e 6420 616e 6420 6f74 6865 7220 6d61  ond and other ma
+0001e340: 7920 6265 2064 6173 6b20 696e 7374 616e  y be dask instan
+0001e350: 6365 2c0a 2020 2020 2020 2020 2320 7061  ce,.        # pa
+0001e360: 7373 696e 6720 6d61 705f 7061 7274 6974  ssing map_partit
+0001e370: 696f 6e73 2076 6961 206b 6579 776f 7264  ions via keyword
+0001e380: 2077 696c 6c20 6e6f 7420 6265 2061 6c69   will not be ali
+0001e390: 676e 6564 0a20 2020 2020 2020 2073 656c  gned.        sel
+0001e3a0: 662e 5f76 616c 6964 6174 655f 636f 6e64  f._validate_cond
+0001e3b0: 6974 696f 6e28 636f 6e64 290a 2020 2020  ition(cond).    
+0001e3c0: 2020 2020 7265 7475 726e 206d 6170 5f70      return map_p
+0001e3d0: 6172 7469 7469 6f6e 7328 4d2e 7768 6572  artitions(M.wher
+0001e3e0: 652c 2073 656c 662c 2063 6f6e 642c 206f  e, self, cond, o
+0001e3f0: 7468 6572 2c20 656e 666f 7263 655f 6d65  ther, enforce_me
+0001e400: 7461 6461 7461 3d46 616c 7365 290a 0a20  tadata=False).. 
+0001e410: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0001e420: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+0001e430: 2020 2064 6566 206d 6173 6b28 7365 6c66     def mask(self
+0001e440: 2c20 636f 6e64 2c20 6f74 6865 723d 6e70  , cond, other=np
+0001e450: 2e6e 616e 293a 0a20 2020 2020 2020 2073  .nan):.        s
+0001e460: 656c 662e 5f76 616c 6964 6174 655f 636f  elf._validate_co
+0001e470: 6e64 6974 696f 6e28 636f 6e64 290a 2020  ndition(cond).  
+0001e480: 2020 2020 2020 7265 7475 726e 206d 6170        return map
+0001e490: 5f70 6172 7469 7469 6f6e 7328 4d2e 6d61  _partitions(M.ma
+0001e4a0: 736b 2c20 7365 6c66 2c20 636f 6e64 2c20  sk, self, cond, 
+0001e4b0: 6f74 6865 722c 2065 6e66 6f72 6365 5f6d  other, enforce_m
+0001e4c0: 6574 6164 6174 613d 4661 6c73 6529 0a0a  etadata=False)..
+0001e4d0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+0001e4e0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+0001e4f0: 2020 2020 6465 6620 6e6f 746e 756c 6c28      def notnull(
+0001e500: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+0001e510: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+0001e520: 6172 7469 7469 6f6e 7328 4d2e 6e6f 746e  artitions(M.notn
+0001e530: 756c 6c2c 2065 6e66 6f72 6365 5f6d 6574  ull, enforce_met
+0001e540: 6164 6174 613d 4661 6c73 6529 0a0a 2020  adata=False)..  
+0001e550: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+0001e560: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
+0001e570: 2020 6465 6620 6973 6e75 6c6c 2873 656c    def isnull(sel
+0001e580: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+0001e590: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
+0001e5a0: 6974 696f 6e73 284d 2e69 736e 756c 6c2c  itions(M.isnull,
+0001e5b0: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+0001e5c0: 613d 4661 6c73 6529 0a0a 2020 2020 4064  a=False)..    @d
+0001e5d0: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+0001e5e0: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+0001e5f0: 6620 6973 6e61 2873 656c 6629 3a0a 2020  f isna(self):.  
+0001e600: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0001e610: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+0001e620: 284d 2e69 736e 612c 2065 6e66 6f72 6365  (M.isna, enforce
+0001e630: 5f6d 6574 6164 6174 613d 4661 6c73 6529  _metadata=False)
+0001e640: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+0001e650: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+0001e660: 290a 2020 2020 6465 6620 6973 696e 2873  ).    def isin(s
+0001e670: 656c 662c 2076 616c 7565 7329 3a0a 2020  elf, values):.  
+0001e680: 2020 2020 2020 6966 2069 735f 6461 7461        if is_data
+0001e690: 6672 616d 655f 6c69 6b65 2873 656c 662e  frame_like(self.
+0001e6a0: 5f6d 6574 6129 3a0a 2020 2020 2020 2020  _meta):.        
+0001e6b0: 2020 2020 2320 4461 7461 4672 616d 652e      # DataFrame.
+0001e6c0: 6973 696e 2064 6f65 7320 7765 6972 6420  isin does weird 
+0001e6d0: 616c 6967 6e6d 656e 7420 7374 7566 660a  alignment stuff.
+0001e6e0: 2020 2020 2020 2020 2020 2020 6261 645f              bad_
+0001e6f0: 7479 7065 7320 3d20 285f 4672 616d 652c  types = (_Frame,
+0001e700: 2070 642e 5365 7269 6573 2c20 7064 2e44   pd.Series, pd.D
+0001e710: 6174 6146 7261 6d65 290a 2020 2020 2020  ataFrame).      
+0001e720: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001e730: 2020 2020 6261 645f 7479 7065 7320 3d20      bad_types = 
+0001e740: 285f 4672 616d 652c 290a 2020 2020 2020  (_Frame,).      
+0001e750: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0001e760: 7661 6c75 6573 2c20 6261 645f 7479 7065  values, bad_type
+0001e770: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+0001e780: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+0001e790: 6e74 6564 4572 726f 7228 2250 6173 7369  ntedError("Passi
+0001e7a0: 6e67 2061 2025 7220 746f 2060 6973 696e  ng a %r to `isin
+0001e7b0: 6022 2025 2074 7970 656e 616d 6528 7479  `" % typename(ty
+0001e7c0: 7065 2876 616c 7565 7329 2929 0a20 2020  pe(values))).   
+0001e7d0: 2020 2020 206d 6574 6120 3d20 7365 6c66       meta = self
+0001e7e0: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
+0001e7f0: 6973 696e 2876 616c 7565 7329 0a20 2020  isin(values).   
+0001e800: 2020 2020 2023 2057 6520 7772 6170 2076       # We wrap v
+0001e810: 616c 7565 7320 696e 2061 2064 656c 6179  alues in a delay
+0001e820: 6564 2066 6f72 2074 776f 2072 6561 736f  ed for two reaso
+0001e830: 6e73 3a0a 2020 2020 2020 2020 2320 2d20  ns:.        # - 
+0001e840: 6176 6f69 6420 7365 7269 616c 697a 696e  avoid serializin
+0001e850: 6720 6461 7461 2069 6e20 6576 6572 7920  g data in every 
+0001e860: 7461 736b 0a20 2020 2020 2020 2023 202d  task.        # -
+0001e870: 2061 766f 6964 2063 6f73 7420 6f66 2074   avoid cost of t
+0001e880: 7261 7665 7273 616c 206f 6620 6c61 7267  raversal of larg
+0001e890: 6520 6c69 7374 2069 6e20 6f70 7469 6d69  e list in optimi
+0001e8a0: 7a61 7469 6f6e 730a 2020 2020 2020 2020  zations.        
+0001e8b0: 6966 2069 7369 6e73 7461 6e63 6528 7661  if isinstance(va
+0001e8c0: 6c75 6573 2c20 6c69 7374 293a 0a20 2020  lues, list):.   
+0001e8d0: 2020 2020 2020 2020 2023 204d 6f74 6976           # Motiv
+0001e8e0: 6174 6564 2062 7920 6874 7470 733a 2f2f  ated by https://
+0001e8f0: 6769 7468 7562 2e63 6f6d 2f64 6173 6b2f  github.com/dask/
+0001e900: 6461 736b 2f69 7373 7565 732f 3934 3131  dask/issues/9411
+0001e910: 2e20 2054 6869 7320 6170 7065 6172 7320  .  This appears 
+0001e920: 746f 2062 650a 2020 2020 2020 2020 2020  to be.          
+0001e930: 2020 2320 6361 7573 6564 2062 7920 6874    # caused by ht
+0001e940: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+0001e950: 2f64 6173 6b2f 6469 7374 7269 6275 7465  /dask/distribute
+0001e960: 642f 6973 7375 6573 2f36 3336 382c 2061  d/issues/6368, a
+0001e970: 6e64 2066 7572 7468 6572 0a20 2020 2020  nd further.     
+0001e980: 2020 2020 2020 2023 2065 7861 6365 7262         # exacerb
+0001e990: 6174 6564 2062 7920 7468 6520 6661 6374  ated by the fact
+0001e9a0: 2074 6861 7420 7468 6520 6c69 7374 2063   that the list c
+0001e9b0: 6f6e 7461 696e 7320 6475 706c 6963 6174  ontains duplicat
+0001e9c0: 6573 2e20 2054 6869 7320 6973 2061 2070  es.  This is a p
+0001e9d0: 6174 6368 2075 6e74 696c 0a20 2020 2020  atch until.     
+0001e9e0: 2020 2020 2020 2023 2077 6520 6361 6e20         # we can 
+0001e9f0: 6372 6561 7465 2061 2062 6574 7465 7220  create a better 
+0001ea00: 6669 7820 666f 7220 5365 7269 616c 697a  fix for Serializ
+0001ea10: 6174 696f 6e2e 0a20 2020 2020 2020 2020  ation..         
+0001ea20: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+0001ea30: 2020 2020 2020 2020 7661 6c75 6573 203d          values =
+0001ea40: 206c 6973 7428 7365 7428 7661 6c75 6573   list(set(values
+0001ea50: 2929 0a20 2020 2020 2020 2020 2020 2065  )).            e
+0001ea60: 7863 6570 7420 5479 7065 4572 726f 723a  xcept TypeError:
+0001ea70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ea80: 2070 6173 730a 2020 2020 2020 2020 2020   pass.          
+0001ea90: 2020 6966 206e 6f74 2061 6e79 2869 735f    if not any(is_
+0001eaa0: 6461 736b 5f63 6f6c 6c65 6374 696f 6e28  dask_collection(
+0001eab0: 7629 2066 6f72 2076 2069 6e20 7661 6c75  v) for v in valu
+0001eac0: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
+0001ead0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+0001eae0: 2020 2020 2020 2020 2020 2020 2020 7661                va
+0001eaf0: 6c75 6573 203d 206e 702e 6672 6f6d 6974  lues = np.fromit
+0001eb00: 6572 2876 616c 7565 732c 2064 7479 7065  er(values, dtype
+0001eb10: 3d6f 626a 6563 7429 0a20 2020 2020 2020  =object).       
+0001eb20: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+0001eb30: 5661 6c75 6545 7272 6f72 3a0a 2020 2020  ValueError:.    
+0001eb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eb50: 2320 4e75 6d70 7920 312e 3233 2073 7570  # Numpy 1.23 sup
+0001eb60: 706f 7274 7320 6372 6561 7469 6e67 2061  ports creating a
+0001eb70: 7272 6179 7320 6f66 2069 7465 7261 626c  rrays of iterabl
+0001eb80: 6573 2c20 7768 696c 6520 6c6f 7765 720a  es, while lower.
+0001eb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eba0: 2020 2020 2320 7665 7273 696f 6e20 312e      # version 1.
+0001ebb0: 3231 2e78 2061 6e64 2031 2e32 322e 7820  21.x and 1.22.x 
+0001ebc0: 646f 206e 6f74 0a20 2020 2020 2020 2020  do not.         
+0001ebd0: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
+0001ebe0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001ebf0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
+0001ec00: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
+0001ec10: 4d2e 6973 696e 2c20 6465 6c61 7965 6428  M.isin, delayed(
+0001ec20: 7661 6c75 6573 292c 206d 6574 613d 6d65  values), meta=me
+0001ec30: 7461 2c20 656e 666f 7263 655f 6d65 7461  ta, enforce_meta
+0001ec40: 6461 7461 3d46 616c 7365 0a20 2020 2020  data=False.     
+0001ec50: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
+0001ec60: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
+0001ec70: 7261 6d65 290a 2020 2020 6465 6620 6173  rame).    def as
+0001ec80: 7479 7065 2873 656c 662c 2064 7479 7065  type(self, dtype
+0001ec90: 293a 0a20 2020 2020 2020 206d 6574 6120  ):.        meta 
+0001eca0: 3d20 7365 6c66 2e5f 6d65 7461 2e61 7374  = self._meta.ast
+0001ecb0: 7970 6528 6474 7970 6529 0a20 2020 2020  ype(dtype).     
+0001ecc0: 2020 2069 6620 6861 7361 7474 7228 6474     if hasattr(dt
+0001ecd0: 7970 652c 2022 6974 656d 7322 293a 0a20  ype, "items"):. 
+0001ece0: 2020 2020 2020 2020 2020 2073 6574 5f75             set_u
+0001ecf0: 6e6b 6e6f 776e 203d 205b 0a20 2020 2020  nknown = [.     
+0001ed00: 2020 2020 2020 2020 2020 206b 0a20 2020             k.   
+0001ed10: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0001ed20: 206b 2c20 7620 696e 2064 7479 7065 2e69   k, v in dtype.i
+0001ed30: 7465 6d73 2829 0a20 2020 2020 2020 2020  tems().         
+0001ed40: 2020 2020 2020 2069 6620 2869 7369 6e73         if (isins
+0001ed50: 7461 6e63 6528 7064 2e61 7069 2e74 7970  tance(pd.api.typ
+0001ed60: 6573 2e70 616e 6461 735f 6474 7970 6528  es.pandas_dtype(
+0001ed70: 7629 2c20 7064 2e43 6174 6567 6f72 6963  v), pd.Categoric
+0001ed80: 616c 4474 7970 6529 290a 2020 2020 2020  alDtype)).      
+0001ed90: 2020 2020 2020 2020 2020 616e 6420 6765            and ge
+0001eda0: 7461 7474 7228 762c 2022 6361 7465 676f  tattr(v, "catego
+0001edb0: 7269 6573 222c 204e 6f6e 6529 2069 7320  ries", None) is 
+0001edc0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+0001edd0: 205d 0a20 2020 2020 2020 2020 2020 206d   ].            m
+0001ede0: 6574 6120 3d20 636c 6561 725f 6b6e 6f77  eta = clear_know
+0001edf0: 6e5f 6361 7465 676f 7269 6573 286d 6574  n_categories(met
+0001ee00: 612c 2063 6f6c 733d 7365 745f 756e 6b6e  a, cols=set_unkn
+0001ee10: 6f77 6e29 0a20 2020 2020 2020 2065 6c69  own).        eli
+0001ee20: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
+0001ee30: 6973 696e 7374 616e 6365 2870 642e 6170  isinstance(pd.ap
+0001ee40: 692e 7479 7065 732e 7061 6e64 6173 5f64  i.types.pandas_d
+0001ee50: 7479 7065 2864 7479 7065 292c 2070 642e  type(dtype), pd.
+0001ee60: 4361 7465 676f 7269 6361 6c44 7479 7065  CategoricalDtype
+0001ee70: 290a 2020 2020 2020 2020 2920 616e 6420  ).        ) and 
+0001ee80: 6765 7461 7474 7228 6474 7970 652c 2022  getattr(dtype, "
+0001ee90: 6361 7465 676f 7269 6573 222c 204e 6f6e  categories", Non
+0001eea0: 6529 2069 7320 4e6f 6e65 3a0a 2020 2020  e) is None:.    
+0001eeb0: 2020 2020 2020 2020 6d65 7461 203d 2063          meta = c
+0001eec0: 6c65 6172 5f6b 6e6f 776e 5f63 6174 6567  lear_known_categ
+0001eed0: 6f72 6965 7328 6d65 7461 290a 2020 2020  ories(meta).    
+0001eee0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001eef0: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
+0001ef00: 2020 2020 2020 2020 2020 2020 4d2e 6173              M.as
+0001ef10: 7479 7065 2c20 6474 7970 653d 6474 7970  type, dtype=dtyp
+0001ef20: 652c 206d 6574 613d 6d65 7461 2c20 656e  e, meta=meta, en
+0001ef30: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
+0001ef40: 616c 7365 0a20 2020 2020 2020 2029 0a0a  alse.        )..
+0001ef50: 2020 2020 6966 206e 6f74 2050 414e 4441      if not PANDA
+0001ef60: 535f 4754 5f32 3030 3a0a 0a20 2020 2020  S_GT_200:..     
+0001ef70: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0001ef80: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
+0001ef90: 2020 2020 6465 6620 6170 7065 6e64 2873      def append(s
+0001efa0: 656c 662c 206f 7468 6572 2c20 696e 7465  elf, other, inte
+0001efb0: 726c 6561 7665 5f70 6172 7469 7469 6f6e  rleave_partition
+0001efc0: 733d 4661 6c73 6529 3a0a 2020 2020 2020  s=False):.      
+0001efd0: 2020 2020 2020 6966 2050 414e 4441 535f        if PANDAS_
+0001efe0: 4754 5f31 3430 3a0a 2020 2020 2020 2020  GT_140:.        
+0001eff0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+0001f000: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
+0001f010: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
+0001f020: 6672 616d 652e 6170 7065 6e64 206d 6574  frame.append met
+0001f030: 686f 6420 6973 2064 6570 7265 6361 7465  hod is deprecate
+0001f040: 6420 616e 6420 7769 6c6c 2062 6520 7265  d and will be re
+0001f050: 6d6f 7665 6420 6672 6f6d 220a 2020 2020  moved from".    
+0001f060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f070: 2264 6173 6b20 696e 2061 2066 7574 7572  "dask in a futur
+0001f080: 6520 7665 7273 696f 6e2e 2055 7365 2064  e version. Use d
+0001f090: 6173 6b2e 6461 7461 6672 616d 652e 636f  ask.dataframe.co
+0001f0a0: 6e63 6174 2069 6e73 7465 6164 2e22 2c0a  ncat instead.",.
+0001f0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f0c0: 2020 2020 4675 7475 7265 5761 726e 696e      FutureWarnin
+0001f0d0: 672c 0a20 2020 2020 2020 2020 2020 2020  g,.             
+0001f0e0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0001f0f0: 2023 2062 6563 6175 7365 2044 6174 6146   # because DataF
+0001f100: 7261 6d65 2e61 7070 656e 6420 7769 6c6c  rame.append will
+0001f110: 206f 7665 7272 6964 6520 7468 6520 6d65   override the me
+0001f120: 7468 6f64 2c0a 2020 2020 2020 2020 2020  thod,.          
+0001f130: 2020 2320 7772 6170 2062 7920 7064 2e53    # wrap by pd.S
+0001f140: 6572 6965 732e 6170 7065 6e64 2064 6f63  eries.append doc
+0001f150: 7374 7269 6e67 0a20 2020 2020 2020 2020  string.         
+0001f160: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
+0001f170: 6166 7261 6d65 2e6d 756c 7469 2069 6d70  aframe.multi imp
+0001f180: 6f72 7420 636f 6e63 6174 0a0a 2020 2020  ort concat..    
+0001f190: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0001f1a0: 7461 6e63 6528 6f74 6865 722c 2028 6c69  tance(other, (li
+0001f1b0: 7374 2c20 6469 6374 2929 3a0a 2020 2020  st, dict)):.    
+0001f1c0: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
+0001f1d0: 3d20 2261 7070 656e 6420 646f 6573 6e27  = "append doesn'
+0001f1e0: 7420 7375 7070 6f72 7420 6c69 7374 206f  t support list o
+0001f1f0: 7220 6469 6374 2069 6e70 7574 220a 2020  r dict input".  
+0001f200: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0001f210: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
+0001f220: 6564 4572 726f 7228 6d73 6729 0a0a 2020  edError(msg)..  
+0001f230: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001f240: 2063 6f6e 6361 7428 0a20 2020 2020 2020   concat(.       
+0001f250: 2020 2020 2020 2020 205b 7365 6c66 2c20           [self, 
+0001f260: 6f74 6865 725d 2c20 6a6f 696e 3d22 6f75  other], join="ou
+0001f270: 7465 7222 2c20 696e 7465 726c 6561 7665  ter", interleave
+0001f280: 5f70 6172 7469 7469 6f6e 733d 696e 7465  _partitions=inte
+0001f290: 726c 6561 7665 5f70 6172 7469 7469 6f6e  rleave_partition
+0001f2a0: 730a 2020 2020 2020 2020 2020 2020 290a  s.            ).
+0001f2b0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+0001f2c0: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
+0001f2d0: 2020 6465 6620 646f 7428 7365 6c66 2c20    def dot(self, 
+0001f2e0: 6f74 6865 722c 206d 6574 613d 6e6f 5f64  other, meta=no_d
+0001f2f0: 6566 6175 6c74 293a 0a20 2020 2020 2020  efault):.       
+0001f300: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+0001f310: 6365 286f 7468 6572 2c20 5f46 7261 6d65  ce(other, _Frame
+0001f320: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+0001f330: 6169 7365 2054 7970 6545 7272 6f72 2822  aise TypeError("
+0001f340: 5468 6520 7365 636f 6e64 206f 7065 7261  The second opera
+0001f350: 6e64 206d 7573 7420 6265 2061 2064 6173  nd must be a das
+0001f360: 6b20 6172 7261 7920 6f72 2064 6173 6b20  k array or dask 
+0001f370: 6461 7461 6672 616d 6522 290a 0a20 2020  dataframe")..   
+0001f380: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0001f390: 6365 286f 7468 6572 2c20 4461 7461 4672  ce(other, DataFr
+0001f3a0: 616d 6529 3a0a 2020 2020 2020 2020 2020  ame):.          
+0001f3b0: 2020 7320 3d20 7365 6c66 2e6d 6170 5f70    s = self.map_p
+0001f3c0: 6172 7469 7469 6f6e 7328 4d2e 646f 742c  artitions(M.dot,
+0001f3d0: 206f 7468 6572 2c20 746f 6b65 6e3d 2264   other, token="d
+0001f3e0: 6f74 222c 206d 6574 613d 6d65 7461 290a  ot", meta=meta).
+0001f3f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001f400: 726e 2073 2e67 726f 7570 6279 2862 793d  rn s.groupby(by=
+0001f410: 732e 696e 6465 7829 2e61 7070 6c79 280a  s.index).apply(.
+0001f420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f430: 6c61 6d62 6461 2078 3a20 782e 7375 6d28  lambda x: x.sum(
+0001f440: 736b 6970 6e61 3d46 616c 7365 292c 206d  skipna=False), m
+0001f450: 6574 613d 732e 5f6d 6574 615f 6e6f 6e65  eta=s._meta_none
+0001f460: 6d70 7479 0a20 2020 2020 2020 2020 2020  mpty.           
+0001f470: 2029 0a0a 2020 2020 2020 2020 6465 6620   )..        def 
+0001f480: 5f64 6f74 5f73 6572 6965 7328 2a61 7267  _dot_series(*arg
+0001f490: 732c 202a 2a6b 7761 7267 7329 3a0a 2020  s, **kwargs):.  
+0001f4a0: 2020 2020 2020 2020 2020 2320 2e73 756d            # .sum
+0001f4b0: 2829 2069 7320 696e 766f 6b65 6420 6f6e  () is invoked on
+0001f4c0: 2065 6163 6820 7061 7274 6974 696f 6e20   each partition 
+0001f4d0: 6265 666f 7265 2062 6569 6e67 2061 7070  before being app
+0001f4e0: 6c69 6564 2074 6f20 616c 6c0a 2020 2020  lied to all.    
+0001f4f0: 2020 2020 2020 2020 2320 7061 7274 6974          # partit
+0001f500: 696f 6e73 2e20 5468 6520 7265 7475 726e  ions. The return
+0001f510: 2074 7970 6520 6973 2065 7870 6563 7465   type is expecte
+0001f520: 6420 746f 2062 6520 6120 7365 7269 6573  d to be a series
+0001f530: 2c20 6e6f 7420 6120 6e75 6d70 7920 6f62  , not a numpy ob
+0001f540: 6a65 6374 0a20 2020 2020 2020 2020 2020  ject.           
+0001f550: 2072 6574 7572 6e20 6d65 7461 5f73 6572   return meta_ser
+0001f560: 6965 735f 636f 6e73 7472 7563 746f 7228  ies_constructor(
+0001f570: 7365 6c66 2928 4d2e 646f 7428 2a61 7267  self)(M.dot(*arg
+0001f580: 732c 202a 2a6b 7761 7267 7329 290a 0a20  s, **kwargs)).. 
+0001f590: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001f5a0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+0001f5b0: 7328 5f64 6f74 5f73 6572 6965 732c 206f  s(_dot_series, o
+0001f5c0: 7468 6572 2c20 746f 6b65 6e3d 2264 6f74  ther, token="dot
+0001f5d0: 222c 206d 6574 613d 6d65 7461 292e 7375  ", meta=meta).su
+0001f5e0: 6d28 0a20 2020 2020 2020 2020 2020 2073  m(.            s
+0001f5f0: 6b69 706e 613d 4661 6c73 650a 2020 2020  kipna=False.    
+0001f600: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
+0001f610: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+0001f620: 4672 616d 6529 0a20 2020 2064 6566 2061  Frame).    def a
+0001f630: 6c69 676e 2873 656c 662c 206f 7468 6572  lign(self, other
+0001f640: 2c20 6a6f 696e 3d22 6f75 7465 7222 2c20  , join="outer", 
+0001f650: 6178 6973 3d4e 6f6e 652c 2066 696c 6c5f  axis=None, fill_
+0001f660: 7661 6c75 653d 4e6f 6e65 293a 0a20 2020  value=None):.   
+0001f670: 2020 2020 206d 6574 6131 2c20 6d65 7461       meta1, meta
+0001f680: 3220 3d20 5f65 6d75 6c61 7465 280a 2020  2 = _emulate(.  
+0001f690: 2020 2020 2020 2020 2020 4d2e 616c 6967            M.alig
+0001f6a0: 6e2c 2073 656c 662c 206f 7468 6572 2c20  n, self, other, 
+0001f6b0: 6a6f 696e 2c20 6178 6973 3d61 7869 732c  join, axis=axis,
+0001f6c0: 2066 696c 6c5f 7661 6c75 653d 6669 6c6c   fill_value=fill
+0001f6d0: 5f76 616c 7565 0a20 2020 2020 2020 2029  _value.        )
+0001f6e0: 0a20 2020 2020 2020 2061 6c69 676e 6564  .        aligned
+0001f6f0: 203d 2073 656c 662e 6d61 705f 7061 7274   = self.map_part
+0001f700: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
+0001f710: 2020 2020 4d2e 616c 6967 6e2c 0a20 2020      M.align,.   
+0001f720: 2020 2020 2020 2020 206f 7468 6572 2c0a           other,.
+0001f730: 2020 2020 2020 2020 2020 2020 6a6f 696e              join
+0001f740: 3d6a 6f69 6e2c 0a20 2020 2020 2020 2020  =join,.         
+0001f750: 2020 2061 7869 733d 6178 6973 2c0a 2020     axis=axis,.  
+0001f760: 2020 2020 2020 2020 2020 6669 6c6c 5f76            fill_v
+0001f770: 616c 7565 3d66 696c 6c5f 7661 6c75 652c  alue=fill_value,
+0001f780: 0a20 2020 2020 2020 2020 2020 2065 6e66  .            enf
+0001f790: 6f72 6365 5f6d 6574 6164 6174 613d 4661  orce_metadata=Fa
+0001f7a0: 6c73 652c 0a20 2020 2020 2020 2029 0a0a  lse,.        )..
+0001f7b0: 2020 2020 2020 2020 746f 6b65 6e20 3d20          token = 
+0001f7c0: 746f 6b65 6e69 7a65 2873 656c 662c 206f  tokenize(self, o
+0001f7d0: 7468 6572 2c20 6a6f 696e 2c20 6178 6973  ther, join, axis
+0001f7e0: 2c20 6669 6c6c 5f76 616c 7565 290a 0a20  , fill_value).. 
+0001f7f0: 2020 2020 2020 206e 616d 6531 203d 2022         name1 = "
+0001f800: 616c 6967 6e31 2d22 202b 2074 6f6b 656e  align1-" + token
+0001f810: 0a20 2020 2020 2020 2064 736b 3120 3d20  .        dsk1 = 
+0001f820: 7b0a 2020 2020 2020 2020 2020 2020 286e  {.            (n
+0001f830: 616d 6531 2c20 6929 3a20 2867 6574 6974  ame1, i): (getit
+0001f840: 656d 2c20 6b65 792c 2030 290a 2020 2020  em, key, 0).    
+0001f850: 2020 2020 2020 2020 666f 7220 692c 206b          for i, k
+0001f860: 6579 2069 6e20 656e 756d 6572 6174 6528  ey in enumerate(
+0001f870: 616c 6967 6e65 642e 5f5f 6461 736b 5f6b  aligned.__dask_k
+0001f880: 6579 735f 5f28 2929 0a20 2020 2020 2020  eys__()).       
+0001f890: 207d 0a20 2020 2020 2020 2064 736b 312e   }.        dsk1.
+0001f8a0: 7570 6461 7465 2861 6c69 676e 6564 2e64  update(aligned.d
+0001f8b0: 6173 6b29 0a20 2020 2020 2020 2072 6573  ask).        res
+0001f8c0: 756c 7431 203d 206e 6577 5f64 645f 6f62  ult1 = new_dd_ob
+0001f8d0: 6a65 6374 2864 736b 312c 206e 616d 6531  ject(dsk1, name1
+0001f8e0: 2c20 6d65 7461 312c 2061 6c69 676e 6564  , meta1, aligned
+0001f8f0: 2e64 6976 6973 696f 6e73 290a 0a20 2020  .divisions)..   
+0001f900: 2020 2020 206e 616d 6532 203d 2022 616c       name2 = "al
+0001f910: 6967 6e32 2d22 202b 2074 6f6b 656e 0a20  ign2-" + token. 
+0001f920: 2020 2020 2020 2064 736b 3220 3d20 7b0a         dsk2 = {.
+0001f930: 2020 2020 2020 2020 2020 2020 286e 616d              (nam
+0001f940: 6532 2c20 6929 3a20 2867 6574 6974 656d  e2, i): (getitem
+0001f950: 2c20 6b65 792c 2031 290a 2020 2020 2020  , key, 1).      
+0001f960: 2020 2020 2020 666f 7220 692c 206b 6579        for i, key
+0001f970: 2069 6e20 656e 756d 6572 6174 6528 616c   in enumerate(al
+0001f980: 6967 6e65 642e 5f5f 6461 736b 5f6b 6579  igned.__dask_key
+0001f990: 735f 5f28 2929 0a20 2020 2020 2020 207d  s__()).        }
+0001f9a0: 0a20 2020 2020 2020 2064 736b 322e 7570  .        dsk2.up
+0001f9b0: 6461 7465 2861 6c69 676e 6564 2e64 6173  date(aligned.das
+0001f9c0: 6b29 0a20 2020 2020 2020 2072 6573 756c  k).        resul
+0001f9d0: 7432 203d 206e 6577 5f64 645f 6f62 6a65  t2 = new_dd_obje
+0001f9e0: 6374 2864 736b 322c 206e 616d 6532 2c20  ct(dsk2, name2, 
+0001f9f0: 6d65 7461 322c 2061 6c69 676e 6564 2e64  meta2, aligned.d
+0001fa00: 6976 6973 696f 6e73 290a 0a20 2020 2020  ivisions)..     
+0001fa10: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
+0001fa20: 312c 2072 6573 756c 7432 0a0a 2020 2020  1, result2..    
+0001fa30: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+0001fa40: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+0001fa50: 6465 6620 636f 6d62 696e 6528 7365 6c66  def combine(self
+0001fa60: 2c20 6f74 6865 722c 2066 756e 632c 2066  , other, func, f
+0001fa70: 696c 6c5f 7661 6c75 653d 4e6f 6e65 2c20  ill_value=None, 
+0001fa80: 6f76 6572 7772 6974 653d 5472 7565 293a  overwrite=True):
+0001fa90: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001faa0: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
+0001fab0: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
+0001fac0: 204d 2e63 6f6d 6269 6e65 2c20 6f74 6865   M.combine, othe
+0001fad0: 722c 2066 756e 632c 2066 696c 6c5f 7661  r, func, fill_va
+0001fae0: 6c75 653d 6669 6c6c 5f76 616c 7565 2c20  lue=fill_value, 
+0001faf0: 6f76 6572 7772 6974 653d 6f76 6572 7772  overwrite=overwr
+0001fb00: 6974 650a 2020 2020 2020 2020 290a 0a20  ite.        ).. 
+0001fb10: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+0001fb20: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+0001fb30: 2020 2064 6566 2063 6f6d 6269 6e65 5f66     def combine_f
+0001fb40: 6972 7374 2873 656c 662c 206f 7468 6572  irst(self, other
+0001fb50: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+0001fb60: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
+0001fb70: 7469 6f6e 7328 4d2e 636f 6d62 696e 655f  tions(M.combine_
+0001fb80: 6669 7273 742c 206f 7468 6572 290a 0a20  first, other).. 
+0001fb90: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
+0001fba0: 2020 2020 6465 6620 5f62 696e 645f 6f70      def _bind_op
+0001fbb0: 6572 6174 6f72 5f6d 6574 686f 6428 636c  erator_method(cl
+0001fbc0: 732c 206e 616d 652c 206f 702c 206f 7269  s, name, op, ori
+0001fbd0: 6769 6e61 6c3d 7064 2e44 6174 6146 7261  ginal=pd.DataFra
+0001fbe0: 6d65 293a 0a20 2020 2020 2020 2022 2222  me):.        """
+0001fbf0: 6269 6e64 206f 7065 7261 746f 7220 6d65  bind operator me
+0001fc00: 7468 6f64 206c 696b 6520 4461 7461 4672  thod like DataFr
+0001fc10: 616d 652e 6164 6420 746f 2074 6869 7320  ame.add to this 
+0001fc20: 636c 6173 7322 2222 0a20 2020 2020 2020  class""".       
+0001fc30: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
+0001fc40: 656e 7465 6445 7272 6f72 0a0a 2020 2020  entedError..    
+0001fc50: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+0001fc60: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+0001fc70: 6465 6620 7265 7361 6d70 6c65 2873 656c  def resample(sel
+0001fc80: 662c 2072 756c 652c 2063 6c6f 7365 643d  f, rule, closed=
+0001fc90: 4e6f 6e65 2c20 6c61 6265 6c3d 4e6f 6e65  None, label=None
+0001fca0: 293a 0a20 2020 2020 2020 2066 726f 6d20  ):.        from 
+0001fcb0: 6461 736b 2e64 6174 6166 7261 6d65 2e74  dask.dataframe.t
+0001fcc0: 7365 7269 6573 2e72 6573 616d 706c 6520  series.resample 
+0001fcd0: 696d 706f 7274 2052 6573 616d 706c 6572  import Resampler
+0001fce0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0001fcf0: 2052 6573 616d 706c 6572 2873 656c 662c   Resampler(self,
+0001fd00: 2072 756c 652c 2063 6c6f 7365 643d 636c   rule, closed=cl
+0001fd10: 6f73 6564 2c20 6c61 6265 6c3d 6c61 6265  osed, label=labe
+0001fd20: 6c29 0a0a 2020 2020 4064 6572 6976 6564  l)..    @derived
+0001fd30: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+0001fd40: 6d65 290a 2020 2020 6465 6620 6669 7273  me).    def firs
+0001fd50: 7428 7365 6c66 2c20 6f66 6673 6574 293a  t(self, offset):
+0001fd60: 0a20 2020 2020 2020 2023 204c 6574 2070  .        # Let p
+0001fd70: 616e 6461 7320 6572 726f 7220 6f6e 2062  andas error on b
+0001fd80: 6164 2061 7267 730a 2020 2020 2020 2020  ad args.        
+0001fd90: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
+0001fda0: 7074 792e 6669 7273 7428 6f66 6673 6574  pty.first(offset
+0001fdb0: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
+0001fdc0: 7420 7365 6c66 2e6b 6e6f 776e 5f64 6976  t self.known_div
+0001fdd0: 6973 696f 6e73 3a0a 2020 2020 2020 2020  isions:.        
+0001fde0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0001fdf0: 7272 6f72 2822 6066 6972 7374 6020 6973  rror("`first` is
+0001fe00: 206e 6f74 2069 6d70 6c65 6d65 6e74 6564   not implemented
+0001fe10: 2066 6f72 2075 6e6b 6e6f 776e 2064 6976   for unknown div
+0001fe20: 6973 696f 6e73 2229 0a0a 2020 2020 2020  isions")..      
+0001fe30: 2020 6f66 6673 6574 203d 2070 642e 7473    offset = pd.ts
+0001fe40: 6572 6965 732e 6672 6571 7565 6e63 6965  eries.frequencie
+0001fe50: 732e 746f 5f6f 6666 7365 7428 6f66 6673  s.to_offset(offs
+0001fe60: 6574 290a 2020 2020 2020 2020 6461 7465  et).        date
+0001fe70: 203d 2073 656c 662e 6469 7669 7369 6f6e   = self.division
+0001fe80: 735b 305d 202b 206f 6666 7365 740a 2020  s[0] + offset.  
+0001fe90: 2020 2020 2020 656e 6420 3d20 7365 6c66        end = self
+0001fea0: 2e6c 6f63 2e5f 6765 745f 7061 7274 6974  .loc._get_partit
+0001feb0: 696f 6e73 2864 6174 6529 0a0a 2020 2020  ions(date)..    
+0001fec0: 2020 2020 6973 5f61 6e63 686f 7265 6420      is_anchored 
+0001fed0: 3d20 6f66 6673 6574 2e69 735f 616e 6368  = offset.is_anch
+0001fee0: 6f72 6564 2829 0a0a 2020 2020 2020 2020  ored()..        
+0001fef0: 696e 636c 7564 655f 7269 6768 7420 3d20  include_right = 
+0001ff00: 6973 5f61 6e63 686f 7265 6420 6f72 206e  is_anchored or n
+0001ff10: 6f74 2068 6173 6174 7472 286f 6666 7365  ot hasattr(offse
+0001ff20: 742c 2022 6465 6c74 6122 290a 0a20 2020  t, "delta")..   
+0001ff30: 2020 2020 2069 6620 656e 6420 3d3d 2073       if end == s
+0001ff40: 656c 662e 6e70 6172 7469 7469 6f6e 7320  elf.npartitions 
+0001ff50: 2d20 313a 0a20 2020 2020 2020 2020 2020  - 1:.           
+0001ff60: 2064 6976 7320 3d20 7365 6c66 2e64 6976   divs = self.div
+0001ff70: 6973 696f 6e73 0a20 2020 2020 2020 2065  isions.        e
+0001ff80: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001ff90: 2064 6976 7320 3d20 7365 6c66 2e64 6976   divs = self.div
+0001ffa0: 6973 696f 6e73 5b3a 2065 6e64 202b 2031  isions[: end + 1
+0001ffb0: 5d20 2b20 2864 6174 652c 290a 0a20 2020  ] + (date,)..   
+0001ffc0: 2020 2020 206e 616d 6520 3d20 2266 6972       name = "fir
+0001ffd0: 7374 2d22 202b 2074 6f6b 656e 697a 6528  st-" + tokenize(
+0001ffe0: 7365 6c66 2c20 6f66 6673 6574 290a 2020  self, offset).  
+0001fff0: 2020 2020 2020 6473 6b20 3d20 7b28 6e61        dsk = {(na
+00020000: 6d65 2c20 6929 3a20 2873 656c 662e 5f6e  me, i): (self._n
+00020010: 616d 652c 2069 2920 666f 7220 6920 696e  ame, i) for i in
+00020020: 2072 616e 6765 2865 6e64 297d 0a20 2020   range(end)}.   
+00020030: 2020 2020 2064 736b 5b28 6e61 6d65 2c20       dsk[(name, 
+00020040: 656e 6429 5d20 3d20 280a 2020 2020 2020  end)] = (.      
+00020050: 2020 2020 2020 6d65 7468 6f64 732e 626f        methods.bo
+00020060: 756e 6461 7279 5f73 6c69 6365 2c0a 2020  undary_slice,.  
+00020070: 2020 2020 2020 2020 2020 2873 656c 662e            (self.
+00020080: 5f6e 616d 652c 2065 6e64 292c 0a20 2020  _name, end),.   
+00020090: 2020 2020 2020 2020 204e 6f6e 652c 0a20           None,. 
+000200a0: 2020 2020 2020 2020 2020 2064 6174 652c             date,
+000200b0: 0a20 2020 2020 2020 2020 2020 2069 6e63  .            inc
+000200c0: 6c75 6465 5f72 6967 6874 2c0a 2020 2020  lude_right,.    
+000200d0: 2020 2020 2020 2020 5472 7565 2c0a 2020          True,.  
+000200e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000200f0: 6772 6170 6820 3d20 4869 6768 4c65 7665  graph = HighLeve
+00020100: 6c47 7261 7068 2e66 726f 6d5f 636f 6c6c  lGraph.from_coll
+00020110: 6563 7469 6f6e 7328 6e61 6d65 2c20 6473  ections(name, ds
+00020120: 6b2c 2064 6570 656e 6465 6e63 6965 733d  k, dependencies=
+00020130: 5b73 656c 665d 290a 2020 2020 2020 2020  [self]).        
+00020140: 7265 7475 726e 206e 6577 5f64 645f 6f62  return new_dd_ob
+00020150: 6a65 6374 2867 7261 7068 2c20 6e61 6d65  ject(graph, name
+00020160: 2c20 7365 6c66 2c20 6469 7673 290a 0a20  , self, divs).. 
+00020170: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00020180: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+00020190: 2020 2064 6566 206c 6173 7428 7365 6c66     def last(self
+000201a0: 2c20 6f66 6673 6574 293a 0a20 2020 2020  , offset):.     
+000201b0: 2020 2023 204c 6574 2070 616e 6461 7320     # Let pandas 
+000201c0: 6572 726f 7220 6f6e 2062 6164 2061 7267  error on bad arg
+000201d0: 730a 2020 2020 2020 2020 7365 6c66 2e5f  s.        self._
+000201e0: 6d65 7461 5f6e 6f6e 656d 7074 792e 6c61  meta_nonempty.la
+000201f0: 7374 286f 6666 7365 7429 0a0a 2020 2020  st(offset)..    
+00020200: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+00020210: 6b6e 6f77 6e5f 6469 7669 7369 6f6e 733a  known_divisions:
+00020220: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00020230: 7365 2056 616c 7565 4572 726f 7228 2260  se ValueError("`
+00020240: 6c61 7374 6020 6973 206e 6f74 2069 6d70  last` is not imp
+00020250: 6c65 6d65 6e74 6564 2066 6f72 2075 6e6b  lemented for unk
+00020260: 6e6f 776e 2064 6976 6973 696f 6e73 2229  nown divisions")
+00020270: 0a0a 2020 2020 2020 2020 6f66 6673 6574  ..        offset
+00020280: 203d 2070 642e 7473 6572 6965 732e 6672   = pd.tseries.fr
+00020290: 6571 7565 6e63 6965 732e 746f 5f6f 6666  equencies.to_off
+000202a0: 7365 7428 6f66 6673 6574 290a 2020 2020  set(offset).    
+000202b0: 2020 2020 6461 7465 203d 2073 656c 662e      date = self.
+000202c0: 6469 7669 7369 6f6e 735b 2d31 5d20 2d20  divisions[-1] - 
+000202d0: 6f66 6673 6574 0a20 2020 2020 2020 2073  offset.        s
+000202e0: 7461 7274 203d 2073 656c 662e 6c6f 632e  tart = self.loc.
+000202f0: 5f67 6574 5f70 6172 7469 7469 6f6e 7328  _get_partitions(
+00020300: 6461 7465 290a 0a20 2020 2020 2020 2069  date)..        i
+00020310: 6620 7374 6172 7420 3d3d 2030 3a0a 2020  f start == 0:.  
+00020320: 2020 2020 2020 2020 2020 6469 7673 203d            divs =
+00020330: 2073 656c 662e 6469 7669 7369 6f6e 730a   self.divisions.
+00020340: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00020350: 2020 2020 2020 2020 2020 6469 7673 203d            divs =
+00020360: 2028 6461 7465 2c29 202b 2073 656c 662e   (date,) + self.
+00020370: 6469 7669 7369 6f6e 735b 7374 6172 7420  divisions[start 
+00020380: 2b20 3120 3a5d 0a0a 2020 2020 2020 2020  + 1 :]..        
+00020390: 6e61 6d65 203d 2022 6c61 7374 2d22 202b  name = "last-" +
+000203a0: 2074 6f6b 656e 697a 6528 7365 6c66 2c20   tokenize(self, 
+000203b0: 6f66 6673 6574 290a 2020 2020 2020 2020  offset).        
+000203c0: 6473 6b20 3d20 7b0a 2020 2020 2020 2020  dsk = {.        
+000203d0: 2020 2020 286e 616d 652c 2069 202b 2031      (name, i + 1
+000203e0: 293a 2028 7365 6c66 2e5f 6e61 6d65 2c20  ): (self._name, 
+000203f0: 6a20 2b20 3129 0a20 2020 2020 2020 2020  j + 1).         
+00020400: 2020 2066 6f72 2069 2c20 6a20 696e 2065     for i, j in e
+00020410: 6e75 6d65 7261 7465 2872 616e 6765 2873  numerate(range(s
+00020420: 7461 7274 2c20 7365 6c66 2e6e 7061 7274  tart, self.npart
+00020430: 6974 696f 6e73 2929 0a20 2020 2020 2020  itions)).       
+00020440: 207d 0a20 2020 2020 2020 2064 736b 5b28   }.        dsk[(
+00020450: 6e61 6d65 2c20 3029 5d20 3d20 280a 2020  name, 0)] = (.  
+00020460: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00020470: 732e 626f 756e 6461 7279 5f73 6c69 6365  s.boundary_slice
+00020480: 2c0a 2020 2020 2020 2020 2020 2020 2873  ,.            (s
+00020490: 656c 662e 5f6e 616d 652c 2073 7461 7274  elf._name, start
+000204a0: 292c 0a20 2020 2020 2020 2020 2020 2064  ),.            d
+000204b0: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
+000204c0: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+000204d0: 2020 2054 7275 652c 0a20 2020 2020 2020     True,.       
+000204e0: 2020 2020 2046 616c 7365 2c0a 2020 2020       False,.    
+000204f0: 2020 2020 290a 2020 2020 2020 2020 6772      ).        gr
+00020500: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
+00020510: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
+00020520: 7469 6f6e 7328 6e61 6d65 2c20 6473 6b2c  tions(name, dsk,
+00020530: 2064 6570 656e 6465 6e63 6965 733d 5b73   dependencies=[s
+00020540: 656c 665d 290a 2020 2020 2020 2020 7265  elf]).        re
+00020550: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
+00020560: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
+00020570: 7365 6c66 2c20 6469 7673 290a 0a20 2020  self, divs)..   
+00020580: 2064 6566 206e 756e 6971 7565 5f61 7070   def nunique_app
+00020590: 726f 7828 7365 6c66 2c20 7370 6c69 745f  rox(self, split_
+000205a0: 6576 6572 793d 4e6f 6e65 293a 0a20 2020  every=None):.   
+000205b0: 2020 2020 2022 2222 4170 7072 6f78 696d       """Approxim
+000205c0: 6174 6520 6e75 6d62 6572 206f 6620 756e  ate number of un
+000205d0: 6971 7565 2072 6f77 732e 0a0a 2020 2020  ique rows...    
+000205e0: 2020 2020 5468 6973 206d 6574 686f 6420      This method 
+000205f0: 7573 6573 2074 6865 2048 7970 6572 4c6f  uses the HyperLo
+00020600: 674c 6f67 2061 6c67 6f72 6974 686d 2066  gLog algorithm f
+00020610: 6f72 2063 6172 6469 6e61 6c69 7479 0a20  or cardinality. 
+00020620: 2020 2020 2020 2065 7374 696d 6174 696f         estimatio
+00020630: 6e20 746f 2063 6f6d 7075 7465 2074 6865  n to compute the
+00020640: 2061 7070 726f 7869 6d61 7465 206e 756d   approximate num
+00020650: 6265 7220 6f66 2075 6e69 7175 6520 726f  ber of unique ro
+00020660: 7773 2e0a 2020 2020 2020 2020 5468 6520  ws..        The 
+00020670: 6170 7072 6f78 696d 6174 6520 6572 726f  approximate erro
+00020680: 7220 6973 2030 2e34 3036 252e 0a0a 2020  r is 0.406%...  
+00020690: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+000206a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000206b0: 2d2d 2d0a 2020 2020 2020 2020 7370 6c69  ---.        spli
+000206c0: 745f 6576 6572 7920 3a20 696e 742c 206f  t_every : int, o
+000206d0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+000206e0: 2020 2020 4772 6f75 7020 7061 7274 6974      Group partit
+000206f0: 696f 6e73 2069 6e74 6f20 6772 6f75 7073  ions into groups
+00020700: 206f 6620 7468 6973 2073 697a 6520 7768   of this size wh
+00020710: 696c 6520 7065 7266 6f72 6d69 6e67 2061  ile performing a
+00020720: 0a20 2020 2020 2020 2020 2020 2074 7265  .            tre
+00020730: 652d 7265 6475 6374 696f 6e2e 2049 6620  e-reduction. If 
+00020740: 7365 7420 746f 2046 616c 7365 2c20 6e6f  set to False, no
+00020750: 2074 7265 652d 7265 6475 6374 696f 6e20   tree-reduction 
+00020760: 7769 6c6c 2062 6520 7573 6564 2e0a 2020  will be used..  
+00020770: 2020 2020 2020 2020 2020 4465 6661 756c            Defaul
+00020780: 7420 6973 2038 2e0a 0a20 2020 2020 2020  t is 8...       
+00020790: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+000207a0: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+000207b0: 2061 2066 6c6f 6174 2072 6570 7265 7365   a float represe
+000207c0: 6e74 696e 6720 7468 6520 6170 7072 6f78  nting the approx
+000207d0: 696d 6174 6520 6e75 6d62 6572 206f 6620  imate number of 
+000207e0: 656c 656d 656e 7473 0a20 2020 2020 2020  elements.       
+000207f0: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
+00020800: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
+00020810: 2069 6d70 6f72 7420 6879 7065 726c 6f67   import hyperlog
+00020820: 6c6f 6720 2023 2068 6572 6520 746f 2061  log  # here to a
+00020830: 766f 6964 2063 6972 6375 6c61 7220 696d  void circular im
+00020840: 706f 7274 2069 7373 7565 730a 0a20 2020  port issues..   
+00020850: 2020 2020 2072 6574 7572 6e20 6163 6128       return aca(
+00020860: 0a20 2020 2020 2020 2020 2020 205b 7365  .            [se
+00020870: 6c66 5d2c 0a20 2020 2020 2020 2020 2020  lf],.           
+00020880: 2063 6875 6e6b 3d68 7970 6572 6c6f 676c   chunk=hyperlogl
+00020890: 6f67 2e63 6f6d 7075 7465 5f68 6c6c 5f61  og.compute_hll_a
+000208a0: 7272 6179 2c0a 2020 2020 2020 2020 2020  rray,.          
+000208b0: 2020 636f 6d62 696e 653d 6879 7065 726c    combine=hyperl
+000208c0: 6f67 6c6f 672e 7265 6475 6365 5f73 7461  oglog.reduce_sta
+000208d0: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+000208e0: 6167 6772 6567 6174 653d 6879 7065 726c  aggregate=hyperl
+000208f0: 6f67 6c6f 672e 6573 7469 6d61 7465 5f63  oglog.estimate_c
+00020900: 6f75 6e74 2c0a 2020 2020 2020 2020 2020  ount,.          
+00020910: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
+00020920: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
+00020930: 2020 2020 2020 2062 3d31 362c 0a20 2020         b=16,.   
+00020940: 2020 2020 2020 2020 206d 6574 613d 666c           meta=fl
+00020950: 6f61 742c 0a20 2020 2020 2020 2029 0a0a  oat,.        )..
+00020960: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00020970: 2020 6465 6620 7661 6c75 6573 2873 656c    def values(sel
+00020980: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
+00020990: 6574 7572 6e20 6120 6461 736b 2e61 7272  eturn a dask.arr
+000209a0: 6179 206f 6620 7468 6520 7661 6c75 6573  ay of the values
+000209b0: 206f 6620 7468 6973 2064 6174 6166 7261   of this datafra
+000209c0: 6d65 0a0a 2020 2020 2020 2020 5761 726e  me..        Warn
+000209d0: 696e 673a 2054 6869 7320 6372 6561 7465  ing: This create
+000209e0: 7320 6120 6461 736b 2e61 7272 6179 2077  s a dask.array w
+000209f0: 6974 686f 7574 2070 7265 6369 7365 2073  ithout precise s
+00020a00: 6861 7065 2069 6e66 6f72 6d61 7469 6f6e  hape information
+00020a10: 2e0a 2020 2020 2020 2020 4f70 6572 6174  ..        Operat
+00020a20: 696f 6e73 2074 6861 7420 6465 7065 6e64  ions that depend
+00020a30: 206f 6e20 7368 6170 6520 696e 666f 726d   on shape inform
+00020a40: 6174 696f 6e2c 206c 696b 6520 736c 6963  ation, like slic
+00020a50: 696e 6720 6f72 2072 6573 6861 7069 6e67  ing or reshaping
+00020a60: 2c0a 2020 2020 2020 2020 7769 6c6c 206e  ,.        will n
+00020a70: 6f74 2077 6f72 6b2e 0a20 2020 2020 2020  ot work..       
+00020a80: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
+00020a90: 6973 5f65 7874 656e 7369 6f6e 5f61 7272  is_extension_arr
+00020aa0: 6179 5f64 7479 7065 2873 656c 662e 5f6d  ay_dtype(self._m
+00020ab0: 6574 612e 7661 6c75 6573 293a 0a20 2020  eta.values):.   
+00020ac0: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
+00020ad0: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
+00020ae0: 2020 2020 2020 2020 2244 6173 6b20 6375          "Dask cu
+00020af0: 7272 656e 746c 7920 6861 7320 6c69 6d69  rrently has limi
+00020b00: 7465 6420 7375 7070 6f72 7420 666f 7220  ted support for 
+00020b10: 636f 6e76 6572 7469 6e67 2070 616e 6461  converting panda
+00020b20: 7320 6578 7465 6e73 696f 6e20 6474 7970  s extension dtyp
+00020b30: 6573 2022 0a20 2020 2020 2020 2020 2020  es ".           
+00020b40: 2020 2020 2066 2274 6f20 6172 7261 7973       f"to arrays
+00020b50: 2e20 436f 6e76 6572 7469 6e67 207b 7365  . Converting {se
+00020b60: 6c66 2e5f 6d65 7461 2e76 616c 7565 732e  lf._meta.values.
+00020b70: 6474 7970 657d 2074 6f20 6f62 6a65 6374  dtype} to object
+00020b80: 2064 7479 7065 2e22 2c0a 2020 2020 2020   dtype.",.      
+00020b90: 2020 2020 2020 2020 2020 5573 6572 5761            UserWa
+00020ba0: 726e 696e 672c 0a20 2020 2020 2020 2020  rning,.         
+00020bb0: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+00020bc0: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
+00020bd0: 7469 7469 6f6e 7328 6d65 7468 6f64 732e  titions(methods.
+00020be0: 7661 6c75 6573 290a 0a20 2020 2064 6566  values)..    def
+00020bf0: 205f 7661 6c69 6461 7465 5f63 6875 6e6b   _validate_chunk
+00020c00: 7328 7365 6c66 2c20 6172 722c 206c 656e  s(self, arr, len
+00020c10: 6774 6873 293a 0a20 2020 2020 2020 2066  gths):.        f
+00020c20: 726f 6d20 6461 736b 2e61 7272 6179 2e63  rom dask.array.c
+00020c30: 6f72 6520 696d 706f 7274 206e 6f72 6d61  ore import norma
+00020c40: 6c69 7a65 5f63 6875 6e6b 730a 0a20 2020  lize_chunks..   
+00020c50: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00020c60: 6365 286c 656e 6774 6873 2c20 5365 7175  ce(lengths, Sequ
+00020c70: 656e 6365 293a 0a20 2020 2020 2020 2020  ence):.         
+00020c80: 2020 206c 656e 6774 6873 203d 2074 7570     lengths = tup
+00020c90: 6c65 286c 656e 6774 6873 290a 0a20 2020  le(lengths)..   
+00020ca0: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00020cb0: 6c65 6e67 7468 7329 2021 3d20 7365 6c66  lengths) != self
+00020cc0: 2e6e 7061 7274 6974 696f 6e73 3a0a 2020  .npartitions:.  
+00020cd0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00020ce0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+00020cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020d00: 2020 2020 2254 6865 206e 756d 6265 7220      "The number 
+00020d10: 6f66 2069 7465 6d73 2069 6e20 276c 656e  of items in 'len
+00020d20: 6774 6873 2720 646f 6573 206e 6f74 206d  gths' does not m
+00020d30: 6174 6368 2074 6865 206e 756d 6265 7220  atch the number 
+00020d40: 6f66 2022 0a20 2020 2020 2020 2020 2020  of ".           
+00020d50: 2020 2020 2020 2020 2066 2270 6172 7469           f"parti
+00020d60: 7469 6f6e 732e 207b 6c65 6e28 6c65 6e67  tions. {len(leng
+00020d70: 7468 7329 7d20 213d 207b 7365 6c66 2e6e  ths)} != {self.n
+00020d80: 7061 7274 6974 696f 6e73 7d22 0a20 2020  partitions}".   
+00020d90: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+00020da0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00020db0: 656c 662e 6e64 696d 203d 3d20 313a 0a20  elf.ndim == 1:. 
+00020dc0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00020dd0: 6875 6e6b 7320 3d20 6e6f 726d 616c 697a  hunks = normaliz
+00020de0: 655f 6368 756e 6b73 2828 6c65 6e67 7468  e_chunks((length
+00020df0: 732c 2929 0a20 2020 2020 2020 2020 2020  s,)).           
+00020e00: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00020e10: 2020 2020 2020 2063 6875 6e6b 7320 3d20         chunks = 
+00020e20: 6e6f 726d 616c 697a 655f 6368 756e 6b73  normalize_chunks
+00020e30: 2828 6c65 6e67 7468 732c 2028 6c65 6e28  ((lengths, (len(
+00020e40: 7365 6c66 2e63 6f6c 756d 6e73 292c 2929  self.columns),))
+00020e50: 290a 0a20 2020 2020 2020 2020 2020 2072  )..            r
+00020e60: 6574 7572 6e20 6368 756e 6b73 0a20 2020  eturn chunks.   
+00020e70: 2020 2020 2065 6c69 6620 6c65 6e67 7468       elif length
+00020e80: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
+00020e90: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00020ea0: 2056 616c 7565 4572 726f 7228 6622 556e   ValueError(f"Un
+00020eb0: 6578 7065 6374 6564 2076 616c 7565 2066  expected value f
+00020ec0: 6f72 2027 6c65 6e67 7468 7327 3a20 277b  or 'lengths': '{
+00020ed0: 6c65 6e67 7468 737d 2722 290a 0a20 2020  lengths}'")..   
+00020ee0: 2020 2020 2072 6574 7572 6e20 6172 722e       return arr.
+00020ef0: 5f63 6875 6e6b 730a 0a20 2020 2064 6566  _chunks..    def
+00020f00: 205f 6973 5f69 6e64 6578 5f6c 6576 656c   _is_index_level
+00020f10: 5f72 6566 6572 656e 6365 2873 656c 662c  _reference(self,
+00020f20: 206b 6579 293a 0a20 2020 2020 2020 2022   key):.        "
+00020f30: 2222 0a20 2020 2020 2020 2054 6573 7420  "".        Test 
+00020f40: 7768 6574 6865 7220 6120 6b65 7920 6973  whether a key is
+00020f50: 2061 6e20 696e 6465 7820 6c65 7665 6c20   an index level 
+00020f60: 7265 6665 7265 6e63 650a 0a20 2020 2020  reference..     
+00020f70: 2020 2054 6f20 6265 2063 6f6e 7369 6465     To be conside
+00020f80: 7265 6420 616e 2069 6e64 6578 206c 6576  red an index lev
+00020f90: 656c 2072 6566 6572 656e 6365 2c20 606b  el reference, `k
+00020fa0: 6579 6020 6d75 7374 206d 6174 6368 2074  ey` must match t
+00020fb0: 6865 2069 6e64 6578 206e 616d 650a 2020  he index name.  
+00020fc0: 2020 2020 2020 616e 6420 6d75 7374 204e        and must N
+00020fd0: 4f54 206d 6174 6368 2074 6865 206e 616d  OT match the nam
+00020fe0: 6520 6f66 2061 6e79 2063 6f6c 756d 6e20  e of any column 
+00020ff0: 2869 6620 6120 6461 7461 6672 616d 6529  (if a dataframe)
+00021000: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00021010: 2020 2020 2020 7265 7475 726e 2028 0a20        return (. 
+00021020: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00021030: 696e 6465 782e 6e61 6d65 2069 7320 6e6f  index.name is no
+00021040: 7420 4e6f 6e65 0a20 2020 2020 2020 2020  t None.         
+00021050: 2020 2061 6e64 206e 6f74 2069 735f 6461     and not is_da
+00021060: 736b 5f63 6f6c 6c65 6374 696f 6e28 6b65  sk_collection(ke
+00021070: 7929 0a20 2020 2020 2020 2020 2020 2061  y).            a
+00021080: 6e64 2028 6e70 2e69 7373 6361 6c61 7228  nd (np.isscalar(
+00021090: 6b65 7929 206f 7220 6973 696e 7374 616e  key) or isinstan
+000210a0: 6365 286b 6579 2c20 7475 706c 6529 290a  ce(key, tuple)).
+000210b0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+000210c0: 6b65 7920 3d3d 2073 656c 662e 696e 6465  key == self.inde
+000210d0: 782e 6e61 6d65 0a20 2020 2020 2020 2020  x.name.         
+000210e0: 2020 2061 6e64 206b 6579 206e 6f74 2069     and key not i
+000210f0: 6e20 6765 7461 7474 7228 7365 6c66 2c20  n getattr(self, 
+00021100: 2263 6f6c 756d 6e73 222c 2028 2929 0a20  "columns", ()). 
+00021110: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00021120: 6620 5f63 6f6e 7461 696e 735f 696e 6465  f _contains_inde
+00021130: 785f 6e61 6d65 2873 656c 662c 2063 6f6c  x_name(self, col
+00021140: 756d 6e73 5f6f 725f 696e 6465 7829 3a0a  umns_or_index):.
+00021150: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00021160: 2020 2020 5465 7374 2077 6865 7468 6572      Test whether
+00021170: 2074 6865 2069 6e70 7574 2063 6f6e 7461   the input conta
+00021180: 696e 7320 6120 7265 6665 7265 6e63 6520  ins a reference 
+00021190: 746f 2074 6865 2069 6e64 6578 206f 6620  to the index of 
+000211a0: 7468 6520 4461 7461 4672 616d 652f 5365  the DataFrame/Se
+000211b0: 7269 6573 0a20 2020 2020 2020 2022 2222  ries.        """
+000211c0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+000211d0: 7374 616e 6365 2863 6f6c 756d 6e73 5f6f  stance(columns_o
+000211e0: 725f 696e 6465 782c 206c 6973 7429 3a0a  r_index, list):.
+000211f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00021200: 726e 2061 6e79 2873 656c 662e 5f69 735f  rn any(self._is_
+00021210: 696e 6465 785f 6c65 7665 6c5f 7265 6665  index_level_refe
+00021220: 7265 6e63 6528 6e29 2066 6f72 206e 2069  rence(n) for n i
+00021230: 6e20 636f 6c75 6d6e 735f 6f72 5f69 6e64  n columns_or_ind
+00021240: 6578 290a 2020 2020 2020 2020 656c 7365  ex).        else
+00021250: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00021260: 7475 726e 2073 656c 662e 5f69 735f 696e  turn self._is_in
+00021270: 6465 785f 6c65 7665 6c5f 7265 6665 7265  dex_level_refere
+00021280: 6e63 6528 636f 6c75 6d6e 735f 6f72 5f69  nce(columns_or_i
+00021290: 6e64 6578 290a 0a0a 6465 6620 5f72 6169  ndex)...def _rai
+000212a0: 7365 5f69 665f 6f62 6a65 6374 5f73 6572  se_if_object_ser
+000212b0: 6965 7328 782c 2066 756e 636e 616d 6529  ies(x, funcname)
+000212c0: 3a0a 2020 2020 2222 220a 2020 2020 5574  :.    """.    Ut
+000212d0: 696c 6974 7920 6675 6e63 7469 6f6e 2074  ility function t
+000212e0: 6f20 7261 6973 6520 616e 2065 7272 6f72  o raise an error
+000212f0: 2069 6620 616e 206f 626a 6563 7420 636f   if an object co
+00021300: 6c75 6d6e 2064 6f65 7320 6e6f 7420 7375  lumn does not su
+00021310: 7070 6f72 740a 2020 2020 6120 6365 7274  pport.    a cert
+00021320: 6169 6e20 6f70 6572 6174 696f 6e20 6c69  ain operation li
+00021330: 6b65 2060 6d65 616e 602e 0a20 2020 2022  ke `mean`..    "
+00021340: 2222 0a20 2020 2069 6620 6973 696e 7374  "".    if isinst
+00021350: 616e 6365 2878 2c20 5365 7269 6573 2920  ance(x, Series) 
+00021360: 616e 6420 6861 7361 7474 7228 782c 2022  and hasattr(x, "
+00021370: 6474 7970 6522 293a 0a20 2020 2020 2020  dtype"):.       
+00021380: 2069 6620 782e 6474 7970 6520 3d3d 206f   if x.dtype == o
+00021390: 626a 6563 743a 0a20 2020 2020 2020 2020  bject:.         
+000213a0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+000213b0: 726f 7228 2260 2573 6020 6e6f 7420 7375  ror("`%s` not su
+000213c0: 7070 6f72 7465 6420 7769 7468 206f 626a  pported with obj
+000213d0: 6563 7420 7365 7269 6573 2220 2520 6675  ect series" % fu
+000213e0: 6e63 6e61 6d65 290a 2020 2020 2020 2020  ncname).        
+000213f0: 656c 6966 2069 735f 7374 7269 6e67 5f64  elif is_string_d
+00021400: 7479 7065 2878 293a 0a20 2020 2020 2020  type(x):.       
+00021410: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00021420: 4572 726f 7228 2260 2573 6020 6e6f 7420  Error("`%s` not 
+00021430: 7375 7070 6f72 7465 6420 7769 7468 2073  supported with s
+00021440: 7472 696e 6720 7365 7269 6573 2220 2520  tring series" % 
+00021450: 6675 6e63 6e61 6d65 290a 0a0a 636c 6173  funcname)...clas
+00021460: 7320 5365 7269 6573 285f 4672 616d 6529  s Series(_Frame)
+00021470: 3a0a 2020 2020 2222 2250 6172 616c 6c65  :.    """Paralle
+00021480: 6c20 5061 6e64 6173 2053 6572 6965 730a  l Pandas Series.
+00021490: 0a20 2020 2044 6f20 6e6f 7420 7573 6520  .    Do not use 
+000214a0: 7468 6973 2063 6c61 7373 2064 6972 6563  this class direc
+000214b0: 746c 792e 2020 496e 7374 6561 6420 7573  tly.  Instead us
+000214c0: 6520 6675 6e63 7469 6f6e 7320 6c69 6b65  e functions like
+000214d0: 0a20 2020 2060 6064 642e 7265 6164 5f63  .    ``dd.read_c
+000214e0: 7376 6060 2c20 6060 6464 2e72 6561 645f  sv``, ``dd.read_
+000214f0: 7061 7271 7565 7460 602c 206f 7220 6060  parquet``, or ``
+00021500: 6464 2e66 726f 6d5f 7061 6e64 6173 6060  dd.from_pandas``
+00021510: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+00021520: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+00021530: 0a0a 2020 2020 6473 6b3a 2064 6963 740a  ..    dsk: dict.
+00021540: 2020 2020 2020 2020 5468 6520 6461 736b          The dask
+00021550: 2067 7261 7068 2074 6f20 636f 6d70 7574   graph to comput
+00021560: 6520 7468 6973 2053 6572 6965 730a 2020  e this Series.  
+00021570: 2020 5f6e 616d 653a 2073 7472 0a20 2020    _name: str.   
+00021580: 2020 2020 2054 6865 206b 6579 2070 7265       The key pre
+00021590: 6669 7820 7468 6174 2073 7065 6369 6669  fix that specifi
+000215a0: 6573 2077 6869 6368 206b 6579 7320 696e  es which keys in
+000215b0: 2074 6865 2064 6173 6b20 636f 6d70 7269   the dask compri
+000215c0: 7365 2074 6869 730a 2020 2020 2020 2020  se this.        
+000215d0: 7061 7274 6963 756c 6172 2053 6572 6965  particular Serie
+000215e0: 730a 2020 2020 6d65 7461 3a20 7061 6e64  s.    meta: pand
+000215f0: 6173 2e53 6572 6965 730a 2020 2020 2020  as.Series.      
+00021600: 2020 416e 2065 6d70 7479 2060 6070 616e    An empty ``pan
+00021610: 6461 732e 5365 7269 6573 6060 2077 6974  das.Series`` wit
+00021620: 6820 6e61 6d65 732c 2064 7479 7065 732c  h names, dtypes,
+00021630: 2061 6e64 2069 6e64 6578 206d 6174 6368   and index match
+00021640: 696e 6720 7468 650a 2020 2020 2020 2020  ing the.        
+00021650: 6578 7065 6374 6564 206f 7574 7075 742e  expected output.
+00021660: 0a20 2020 2064 6976 6973 696f 6e73 3a20  .    divisions: 
+00021670: 7475 706c 6520 6f66 2069 6e64 6578 2076  tuple of index v
+00021680: 616c 7565 730a 2020 2020 2020 2020 5661  alues.        Va
+00021690: 6c75 6573 2061 6c6f 6e67 2077 6869 6368  lues along which
+000216a0: 2077 6520 7061 7274 6974 696f 6e20 6f75   we partition ou
+000216b0: 7220 626c 6f63 6b73 206f 6e20 7468 6520  r blocks on the 
+000216c0: 696e 6465 780a 0a20 2020 2053 6565 2041  index..    See A
+000216d0: 6c73 6f0a 2020 2020 2d2d 2d2d 2d2d 2d2d  lso.    --------
+000216e0: 0a20 2020 2064 6173 6b2e 6461 7461 6672  .    dask.datafr
+000216f0: 616d 652e 4461 7461 4672 616d 650a 2020  ame.DataFrame.  
+00021700: 2020 2222 220a 0a20 2020 205f 7061 7274    """..    _part
+00021710: 6974 696f 6e5f 7479 7065 203d 2070 642e  ition_type = pd.
+00021720: 5365 7269 6573 0a20 2020 205f 6973 5f70  Series.    _is_p
+00021730: 6172 7469 7469 6f6e 5f74 7970 6520 3d20  artition_type = 
+00021740: 7374 6174 6963 6d65 7468 6f64 2869 735f  staticmethod(is_
+00021750: 7365 7269 6573 5f6c 696b 6529 0a20 2020  series_like).   
+00021760: 205f 746f 6b65 6e5f 7072 6566 6978 203d   _token_prefix =
+00021770: 2022 7365 7269 6573 2d22 0a20 2020 205f   "series-".    _
+00021780: 6163 6365 7373 6f72 733a 2043 6c61 7373  accessors: Class
+00021790: 5661 725b 7365 745b 7374 725d 5d20 3d20  Var[set[str]] = 
+000217a0: 7365 7428 290a 0a20 2020 2064 6566 205f  set()..    def _
+000217b0: 5f61 7272 6179 5f77 7261 705f 5f28 7365  _array_wrap__(se
+000217c0: 6c66 2c20 6172 7261 792c 2063 6f6e 7465  lf, array, conte
+000217d0: 7874 3d4e 6f6e 6529 3a0a 2020 2020 2020  xt=None):.      
+000217e0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+000217f0: 636f 6e74 6578 742c 2074 7570 6c65 2920  context, tuple) 
+00021800: 616e 6420 6c65 6e28 636f 6e74 6578 7429  and len(context)
+00021810: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
+00021820: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00021830: 636f 6e74 6578 745b 315d 5b30 5d2c 206e  context[1][0], n
+00021840: 702e 6e64 6172 7261 7929 2061 6e64 2063  p.ndarray) and c
+00021850: 6f6e 7465 7874 5b31 5d5b 305d 2e73 6861  ontext[1][0].sha
+00021860: 7065 203d 3d20 2829 3a0a 2020 2020 2020  pe == ():.      
+00021870: 2020 2020 2020 2020 2020 696e 6465 7820            index 
+00021880: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
+00021890: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000218a0: 2020 2020 2020 2020 2069 6e64 6578 203d           index =
+000218b0: 2063 6f6e 7465 7874 5b31 5d5b 305d 2e69   context[1][0].i
+000218c0: 6e64 6578 0a20 2020 2020 2020 2065 6c73  ndex.        els
+000218d0: 653a 0a20 2020 2020 2020 2020 2020 2074  e:.            t
+000218e0: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+000218f0: 2020 2020 696d 706f 7274 2069 6e73 7065      import inspe
+00021900: 6374 0a0a 2020 2020 2020 2020 2020 2020  ct..            
+00021910: 2020 2020 6d65 7468 6f64 5f6e 616d 6520      method_name 
+00021920: 3d20 6622 607b 696e 7370 6563 742e 7374  = f"`{inspect.st
+00021930: 6163 6b28 295b 335d 5b33 5d7d 6022 0a20  ack()[3][3]}`". 
+00021940: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+00021950: 7420 496e 6465 7845 7272 6f72 3a0a 2020  t IndexError:.  
+00021960: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+00021970: 7468 6f64 5f6e 616d 6520 3d20 2254 6869  thod_name = "Thi
+00021980: 7320 6d65 7468 6f64 220a 2020 2020 2020  s method".      
+00021990: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+000219a0: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+000219b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000219c0: 2066 227b 6d65 7468 6f64 5f6e 616d 657d   f"{method_name}
+000219d0: 2069 7320 6e6f 7420 696d 706c 656d 656e   is not implemen
+000219e0: 7465 6420 666f 7220 6064 6173 6b2e 6461  ted for `dask.da
+000219f0: 7461 6672 616d 652e 5365 7269 6573 602e  taframe.Series`.
+00021a00: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+00021a10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00021a20: 6d65 7461 5f73 6572 6965 735f 636f 6e73  meta_series_cons
+00021a30: 7472 7563 746f 7228 7365 6c66 2928 6172  tructor(self)(ar
+00021a40: 7261 792c 2069 6e64 6578 3d69 6e64 6578  ray, index=index
+00021a50: 2c20 6e61 6d65 3d73 656c 662e 6e61 6d65  , name=self.name
+00021a60: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+00021a70: 0a20 2020 2064 6566 2061 7865 7328 7365  .    def axes(se
+00021a80: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
+00021a90: 7572 6e20 5b73 656c 662e 696e 6465 785d  urn [self.index]
+00021aa0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00021ab0: 2020 2020 6465 6620 6e61 6d65 2873 656c      def name(sel
+00021ac0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00021ad0: 726e 2073 656c 662e 5f6d 6574 612e 6e61  rn self._meta.na
+00021ae0: 6d65 0a0a 2020 2020 406e 616d 652e 7365  me..    @name.se
+00021af0: 7474 6572 0a20 2020 2064 6566 206e 616d  tter.    def nam
+00021b00: 6528 7365 6c66 2c20 6e61 6d65 293a 0a20  e(self, name):. 
+00021b10: 2020 2020 2020 2073 656c 662e 5f6d 6574         self._met
+00021b20: 612e 6e61 6d65 203d 206e 616d 650a 2020  a.name = name.  
+00021b30: 2020 2020 2020 7265 6e61 6d65 6420 3d20        renamed = 
+00021b40: 5f72 656e 616d 655f 6461 736b 2873 656c  _rename_dask(sel
+00021b50: 662c 206e 616d 6529 0a20 2020 2020 2020  f, name).       
+00021b60: 2023 2075 7064 6174 6520 6d79 7365 6c66   # update myself
+00021b70: 0a20 2020 2020 2020 2073 656c 662e 6461  .        self.da
+00021b80: 736b 203d 2072 656e 616d 6564 2e64 6173  sk = renamed.das
+00021b90: 6b0a 2020 2020 2020 2020 7365 6c66 2e5f  k.        self._
+00021ba0: 6e61 6d65 203d 2072 656e 616d 6564 2e5f  name = renamed._
+00021bb0: 6e61 6d65 0a0a 2020 2020 4070 726f 7065  name..    @prope
+00021bc0: 7274 790a 2020 2020 6465 6620 6e64 696d  rty.    def ndim
+00021bd0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00021be0: 2222 2252 6574 7572 6e20 6469 6d65 6e73  """Return dimens
+00021bf0: 696f 6e61 6c69 7479 2222 220a 2020 2020  ionality""".    
+00021c00: 2020 2020 7265 7475 726e 2031 0a0a 2020      return 1..  
+00021c10: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00021c20: 6465 6620 7368 6170 6528 7365 6c66 293a  def shape(self):
+00021c30: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00021c40: 2020 2020 2052 6574 7572 6e20 6120 7475       Return a tu
+00021c50: 706c 6520 7265 7072 6573 656e 7469 6e67  ple representing
+00021c60: 2074 6865 2064 696d 656e 7369 6f6e 616c   the dimensional
+00021c70: 6974 7920 6f66 2061 2053 6572 6965 732e  ity of a Series.
+00021c80: 0a0a 2020 2020 2020 2020 5468 6520 7369  ..        The si
+00021c90: 6e67 6c65 2065 6c65 6d65 6e74 206f 6620  ngle element of 
+00021ca0: 7468 6520 7475 706c 6520 6973 2061 2044  the tuple is a D
+00021cb0: 656c 6179 6564 2072 6573 756c 742e 0a0a  elayed result...
+00021cc0: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+00021cd0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00021ce0: 2d0a 2020 2020 2020 2020 3e3e 3e20 7365  -.        >>> se
+00021cf0: 7269 6573 2e73 6861 7065 2020 2320 646f  ries.shape  # do
+00021d00: 6374 6573 743a 202b 534b 4950 0a20 2020  ctest: +SKIP.   
+00021d10: 2020 2020 2028 6464 2e53 6361 6c61 723c       (dd.Scalar<
+00021d20: 7369 7a65 2d61 672e 2e2e 2c20 6474 7970  size-ag..., dtyp
+00021d30: 653d 696e 7436 343e 2c29 0a20 2020 2020  e=int64>,).     
+00021d40: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+00021d50: 6574 7572 6e20 2873 656c 662e 7369 7a65  eturn (self.size
+00021d60: 2c29 0a0a 2020 2020 4070 726f 7065 7274  ,)..    @propert
+00021d70: 790a 2020 2020 6465 6620 6474 7970 6528  y.    def dtype(
+00021d80: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00021d90: 2222 5265 7475 726e 2064 6174 6120 7479  ""Return data ty
+00021da0: 7065 2222 220a 2020 2020 2020 2020 7265  pe""".        re
+00021db0: 7475 726e 2073 656c 662e 5f6d 6574 612e  turn self._meta.
+00021dc0: 6474 7970 650a 0a20 2020 2064 7420 3d20  dtype..    dt = 
+00021dd0: 4361 6368 6564 4163 6365 7373 6f72 2822  CachedAccessor("
+00021de0: 6474 222c 2044 6174 6574 696d 6541 6363  dt", DatetimeAcc
+00021df0: 6573 736f 7229 0a0a 2020 2020 6361 7420  essor)..    cat 
+00021e00: 3d20 4361 6368 6564 4163 6365 7373 6f72  = CachedAccessor
+00021e10: 2822 6361 7422 2c20 4361 7465 676f 7269  ("cat", Categori
+00021e20: 6361 6c41 6363 6573 736f 7229 0a0a 2020  calAccessor)..  
+00021e30: 2020 7374 7220 3d20 4361 6368 6564 4163    str = CachedAc
+00021e40: 6365 7373 6f72 2822 7374 7222 2c20 5374  cessor("str", St
+00021e50: 7269 6e67 4163 6365 7373 6f72 290a 0a20  ringAccessor).. 
+00021e60: 2020 2064 6566 205f 5f64 6972 5f5f 2873     def __dir__(s
+00021e70: 656c 6629 3a0a 2020 2020 2020 2020 6f20  elf):.        o 
+00021e80: 3d20 7365 7428 6469 7228 7479 7065 2873  = set(dir(type(s
+00021e90: 656c 6629 2929 0a20 2020 2020 2020 206f  elf))).        o
+00021ea0: 2e75 7064 6174 6528 7365 6c66 2e5f 5f64  .update(self.__d
+00021eb0: 6963 745f 5f29 0a20 2020 2020 2020 2023  ict__).        #
+00021ec0: 2052 656d 6f76 6520 7468 6520 6063 6174   Remove the `cat
+00021ed0: 6020 616e 6420 6073 7472 6020 6163 6365  ` and `str` acce
+00021ee0: 7373 6f72 7320 6966 206e 6f74 2061 7661  ssors if not ava
+00021ef0: 696c 6162 6c65 2e20 5765 2063 616e 2774  ilable. We can't
+00021f00: 0a20 2020 2020 2020 2023 2064 6563 6964  .        # decid
+00021f10: 6520 7468 6973 2073 7461 7469 6361 6c6c  e this staticall
+00021f20: 7920 666f 7220 7468 6520 6064 7460 2061  y for the `dt` a
+00021f30: 6363 6573 736f 722c 2061 7320 6974 2077  ccessor, as it w
+00021f40: 6f72 6b73 206f 6e0a 2020 2020 2020 2020  orks on.        
+00021f50: 2320 6461 7465 7469 6d65 2d6c 696b 6520  # datetime-like 
+00021f60: 7468 696e 6773 2061 7320 7765 6c6c 2e0a  things as well..
+00021f70: 2020 2020 2020 2020 666f 7220 6163 6365          for acce
+00021f80: 7373 6f72 2069 6e20 5b22 6361 7422 2c20  ssor in ["cat", 
+00021f90: 2273 7472 225d 3a0a 2020 2020 2020 2020  "str"]:.        
+00021fa0: 2020 2020 6966 206e 6f74 2068 6173 6174      if not hasat
+00021fb0: 7472 2873 656c 662e 5f6d 6574 612c 2061  tr(self._meta, a
+00021fc0: 6363 6573 736f 7229 3a0a 2020 2020 2020  ccessor):.      
+00021fd0: 2020 2020 2020 2020 2020 6f2e 7265 6d6f            o.remo
+00021fe0: 7665 2861 6363 6573 736f 7229 0a20 2020  ve(accessor).   
+00021ff0: 2020 2020 2072 6574 7572 6e20 6c69 7374       return list
+00022000: 286f 290a 0a20 2020 2040 7072 6f70 6572  (o)..    @proper
+00022010: 7479 0a20 2020 2064 6566 206e 6279 7465  ty.    def nbyte
+00022020: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+00022030: 2022 2222 4e75 6d62 6572 206f 6620 6279   """Number of by
+00022040: 7465 7322 2222 0a20 2020 2020 2020 2072  tes""".        r
+00022050: 6574 7572 6e20 7365 6c66 2e72 6564 7563  eturn self.reduc
+00022060: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
+00022070: 2020 6d65 7468 6f64 732e 6e62 7974 6573    methods.nbytes
+00022080: 2c20 6e70 2e73 756d 2c20 746f 6b65 6e3d  , np.sum, token=
+00022090: 226e 6279 7465 7322 2c20 6d65 7461 3d69  "nbytes", meta=i
+000220a0: 6e74 2c20 7370 6c69 745f 6576 6572 793d  nt, split_every=
+000220b0: 4661 6c73 650a 2020 2020 2020 2020 290a  False.        ).
+000220c0: 0a20 2020 2064 6566 205f 7265 7072 5f64  .    def _repr_d
+000220d0: 6174 6128 7365 6c66 293a 0a20 2020 2020  ata(self):.     
+000220e0: 2020 2072 6574 7572 6e20 5f72 6570 725f     return _repr_
+000220f0: 6461 7461 5f73 6572 6965 7328 7365 6c66  data_series(self
+00022100: 2e5f 6d65 7461 2c20 7365 6c66 2e5f 7265  ._meta, self._re
+00022110: 7072 5f64 6976 6973 696f 6e73 290a 0a20  pr_divisions).. 
+00022120: 2020 2064 6566 205f 5f72 6570 725f 5f28     def __repr__(
+00022130: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00022140: 2222 6861 7665 2074 6f20 6f76 6572 7772  ""have to overwr
+00022150: 6974 6520 666f 6f74 6572 2222 220a 2020  ite footer""".  
+00022160: 2020 2020 2020 6966 2073 656c 662e 6e61        if self.na
+00022170: 6d65 2069 7320 6e6f 7420 4e6f 6e65 3a0a  me is not None:.
+00022180: 2020 2020 2020 2020 2020 2020 666f 6f74              foot
+00022190: 6572 203d 2066 224e 616d 653a 207b 7365  er = f"Name: {se
+000221a0: 6c66 2e6e 616d 657d 2c20 6474 7970 653a  lf.name}, dtype:
+000221b0: 207b 7365 6c66 2e64 7479 7065 7d22 0a20   {self.dtype}". 
+000221c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000221d0: 2020 2020 2020 2020 2066 6f6f 7465 7220           footer 
+000221e0: 3d20 6622 6474 7970 653a 207b 7365 6c66  = f"dtype: {self
+000221f0: 2e64 7479 7065 7d22 0a0a 2020 2020 2020  .dtype}"..      
+00022200: 2020 7265 7475 726e 2022 2222 4461 736b    return """Dask
+00022210: 207b 6b6c 6173 737d 2053 7472 7563 7475   {klass} Structu
+00022220: 7265 3a0a 7b64 6174 617d 0a7b 666f 6f74  re:.{data}.{foot
+00022230: 6572 7d0a 4461 736b 204e 616d 653a 207b  er}.Dask Name: {
+00022240: 6e61 6d65 7d2c 207b 6c61 7965 7273 7d22  name}, {layers}"
+00022250: 2222 2e66 6f72 6d61 7428 0a20 2020 2020  "".format(.     
+00022260: 2020 2020 2020 206b 6c61 7373 3d73 656c         klass=sel
+00022270: 662e 5f5f 636c 6173 735f 5f2e 5f5f 6e61  f.__class__.__na
+00022280: 6d65 5f5f 2c0a 2020 2020 2020 2020 2020  me__,.          
+00022290: 2020 6461 7461 3d73 656c 662e 746f 5f73    data=self.to_s
+000222a0: 7472 696e 6728 292c 0a20 2020 2020 2020  tring(),.       
+000222b0: 2020 2020 2066 6f6f 7465 723d 666f 6f74       footer=foot
+000222c0: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+000222d0: 6e61 6d65 3d6b 6579 5f73 706c 6974 2873  name=key_split(s
+000222e0: 656c 662e 5f6e 616d 6529 2c0a 2020 2020  elf._name),.    
+000222f0: 2020 2020 2020 2020 6c61 7965 7273 3d6d          layers=m
+00022300: 6179 6265 5f70 6c75 7261 6c69 7a65 286c  aybe_pluralize(l
+00022310: 656e 2873 656c 662e 6461 736b 2e6c 6179  en(self.dask.lay
+00022320: 6572 7329 2c20 2267 7261 7068 206c 6179  ers), "graph lay
+00022330: 6572 2229 2c0a 2020 2020 2020 2020 290a  er"),.        ).
+00022340: 0a20 2020 2064 6566 2072 656e 616d 6528  .    def rename(
+00022350: 7365 6c66 2c20 696e 6465 783d 4e6f 6e65  self, index=None
+00022360: 2c20 696e 706c 6163 653d 6e6f 5f64 6566  , inplace=no_def
+00022370: 6175 6c74 2c20 736f 7274 6564 5f69 6e64  ault, sorted_ind
+00022380: 6578 3d46 616c 7365 293a 0a20 2020 2020  ex=False):.     
+00022390: 2020 2022 2222 416c 7465 7220 5365 7269     """Alter Seri
+000223a0: 6573 2069 6e64 6578 206c 6162 656c 7320  es index labels 
+000223b0: 6f72 206e 616d 650a 0a20 2020 2020 2020  or name..       
+000223c0: 2046 756e 6374 696f 6e20 2f20 6469 6374   Function / dict
+000223d0: 2076 616c 7565 7320 6d75 7374 2062 6520   values must be 
+000223e0: 756e 6971 7565 2028 312d 746f 2d31 292e  unique (1-to-1).
+000223f0: 204c 6162 656c 7320 6e6f 7420 636f 6e74   Labels not cont
+00022400: 6169 6e65 6420 696e 0a20 2020 2020 2020  ained in.       
+00022410: 2061 2064 6963 7420 2f20 5365 7269 6573   a dict / Series
+00022420: 2077 696c 6c20 6265 206c 6566 7420 6173   will be left as
+00022430: 2d69 732e 2045 7874 7261 206c 6162 656c  -is. Extra label
+00022440: 7320 6c69 7374 6564 2064 6f6e 2774 2074  s listed don't t
+00022450: 6872 6f77 2061 6e0a 2020 2020 2020 2020  hrow an.        
+00022460: 6572 726f 722e 0a0a 2020 2020 2020 2020  error...        
+00022470: 416c 7465 726e 6174 6976 656c 792c 2063  Alternatively, c
+00022480: 6861 6e67 6520 6060 5365 7269 6573 2e6e  hange ``Series.n
+00022490: 616d 6560 6020 7769 7468 2061 2073 6361  ame`` with a sca
+000224a0: 6c61 7220 7661 6c75 652e 0a0a 2020 2020  lar value...    
+000224b0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+000224c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+000224d0: 2d0a 2020 2020 2020 2020 696e 6465 7820  -.        index 
+000224e0: 3a20 7363 616c 6172 2c20 6861 7368 6162  : scalar, hashab
+000224f0: 6c65 2073 6571 7565 6e63 652c 2064 6963  le sequence, dic
+00022500: 742d 6c69 6b65 206f 7220 6361 6c6c 6162  t-like or callab
+00022510: 6c65 2c20 6f70 7469 6f6e 616c 0a20 2020  le, optional.   
+00022520: 2020 2020 2020 2020 2049 6620 6469 6374           If dict
+00022530: 2d6c 696b 6520 6f72 2063 616c 6c61 626c  -like or callabl
+00022540: 652c 2074 6865 2074 7261 6e73 666f 726d  e, the transform
+00022550: 6174 696f 6e20 6973 2061 7070 6c69 6564  ation is applied
+00022560: 2074 6f20 7468 650a 2020 2020 2020 2020   to the.        
+00022570: 2020 2020 696e 6465 782e 2053 6361 6c61      index. Scala
+00022580: 7220 6f72 2068 6173 6861 626c 6520 7365  r or hashable se
+00022590: 7175 656e 6365 2d6c 696b 6520 7769 6c6c  quence-like will
+000225a0: 2061 6c74 6572 2074 6865 0a20 2020 2020   alter the.     
+000225b0: 2020 2020 2020 2060 6053 6572 6965 732e         ``Series.
+000225c0: 6e61 6d65 6060 2061 7474 7269 6275 7465  name`` attribute
+000225d0: 2e0a 2020 2020 2020 2020 696e 706c 6163  ..        inplac
+000225e0: 6520 3a20 626f 6f6c 6561 6e2c 2064 6566  e : boolean, def
+000225f0: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
+00022600: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
+00022610: 6f20 7265 7475 726e 2061 206e 6577 2053  o return a new S
+00022620: 6572 6965 7320 6f72 206d 6f64 6966 7920  eries or modify 
+00022630: 7468 6973 206f 6e65 2069 6e70 6c61 6365  this one inplace
+00022640: 2e0a 2020 2020 2020 2020 736f 7274 6564  ..        sorted
+00022650: 5f69 6e64 6578 203a 2062 6f6f 6c2c 2064  _index : bool, d
+00022660: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
+00022670: 2020 2020 2020 2020 2049 6620 7472 7565           If true
+00022680: 2c20 7468 6520 6f75 7470 7574 2060 6053  , the output ``S
+00022690: 6572 6965 7360 6020 7769 6c6c 2068 6176  eries`` will hav
+000226a0: 6520 6b6e 6f77 6e20 6469 7669 7369 6f6e  e known division
+000226b0: 7320 696e 6665 7272 6564 0a20 2020 2020  s inferred.     
+000226c0: 2020 2020 2020 2066 726f 6d20 7468 6520         from the 
+000226d0: 696e 7075 7420 7365 7269 6573 2061 6e64  input series and
+000226e0: 2074 6865 2074 7261 6e73 666f 726d 6174   the transformat
+000226f0: 696f 6e2e 2049 676e 6f72 6564 2066 6f72  ion. Ignored for
+00022700: 0a20 2020 2020 2020 2020 2020 206e 6f6e  .            non
+00022710: 2d63 616c 6c61 626c 652f 6469 6374 2d6c  -callable/dict-l
+00022720: 696b 6520 6060 696e 6465 7860 6020 6f72  ike ``index`` or
+00022730: 2077 6865 6e20 7468 6520 696e 7075 7420   when the input 
+00022740: 7365 7269 6573 2068 6173 0a20 2020 2020  series has.     
+00022750: 2020 2020 2020 2075 6e6b 6e6f 776e 2064         unknown d
+00022760: 6976 6973 696f 6e73 2e20 4e6f 7465 2074  ivisions. Note t
+00022770: 6861 7420 7468 6973 206d 6179 206f 6e6c  hat this may onl
+00022780: 7920 6265 2073 6574 2074 6f20 6060 5472  y be set to ``Tr
+00022790: 7565 6060 2069 660a 2020 2020 2020 2020  ue`` if.        
+000227a0: 2020 2020 796f 7520 6b6e 6f77 2074 6861      you know tha
+000227b0: 7420 7468 6520 7472 616e 7366 6f72 6d65  t the transforme
+000227c0: 6420 696e 6465 7820 6973 206d 6f6e 6f74  d index is monot
+000227d0: 6f6e 6963 616c 6c79 2069 6e63 7265 6173  onically increas
+000227e0: 696e 672e 2044 6173 6b0a 2020 2020 2020  ing. Dask.      
+000227f0: 2020 2020 2020 7769 6c6c 2063 6865 636b        will check
+00022800: 2074 6861 7420 7472 616e 7366 6f72 6d65   that transforme
+00022810: 6420 6469 7669 7369 6f6e 7320 6172 6520  d divisions are 
+00022820: 6d6f 6e6f 746f 6e69 632c 2062 7574 2063  monotonic, but c
+00022830: 616e 6e6f 740a 2020 2020 2020 2020 2020  annot.          
+00022840: 2020 6368 6563 6b20 616c 6c20 7468 6520    check all the 
+00022850: 7661 6c75 6573 2062 6574 7765 656e 2064  values between d
+00022860: 6976 6973 696f 6e73 2c20 736f 2069 6e63  ivisions, so inc
+00022870: 6f72 7265 6374 6c79 2073 6574 7469 6e67  orrectly setting
+00022880: 2074 6869 730a 2020 2020 2020 2020 2020   this.          
+00022890: 2020 6361 6e20 7265 7375 6c74 2069 6e20    can result in 
+000228a0: 6275 6773 2e0a 0a20 2020 2020 2020 2052  bugs...        R
+000228b0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+000228c0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2072  ------.        r
+000228d0: 656e 616d 6564 203a 2053 6572 6965 730a  enamed : Series.
+000228e0: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
+000228f0: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
+00022900: 2d2d 0a20 2020 2020 2020 2070 616e 6461  --.        panda
+00022910: 732e 5365 7269 6573 2e72 656e 616d 650a  s.Series.rename.
+00022920: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00022930: 2020 2020 6672 6f6d 2070 616e 6461 732e      from pandas.
+00022940: 6170 692e 7479 7065 7320 696d 706f 7274  api.types import
+00022950: 2069 735f 6469 6374 5f6c 696b 652c 2069   is_dict_like, i
+00022960: 735f 6c69 7374 5f6c 696b 652c 2069 735f  s_list_like, is_
+00022970: 7363 616c 6172 0a0a 2020 2020 2020 2020  scalar..        
+00022980: 696d 706f 7274 2064 6173 6b2e 6461 7461  import dask.data
+00022990: 6672 616d 6520 6173 2064 640a 0a20 2020  frame as dd..   
+000229a0: 2020 2020 2069 6620 696e 706c 6163 6520       if inplace 
+000229b0: 6973 206e 6f74 206e 6f5f 6465 6661 756c  is not no_defaul
+000229c0: 743a 0a20 2020 2020 2020 2020 2020 2077  t:.            w
+000229d0: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
+000229e0: 2020 2020 2020 2020 2020 2020 2020 2227                "'
+000229f0: 696e 706c 6163 6527 2061 7267 756d 656e  inplace' argumen
+00022a00: 7420 666f 7220 6461 736b 2073 6572 6965  t for dask serie
+00022a10: 7320 7769 6c6c 2062 6520 7265 6d6f 7665  s will be remove
+00022a20: 6420 696e 2066 7574 7572 6520 7665 7273  d in future vers
+00022a30: 696f 6e73 222c 0a20 2020 2020 2020 2020  ions",.         
+00022a40: 2020 2020 2020 2046 7574 7572 6557 6172         FutureWar
+00022a50: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
+00022a60: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
+00022a70: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+00022a80: 706c 6163 6520 3d20 4661 6c73 650a 0a20  place = False.. 
+00022a90: 2020 2020 2020 2069 6620 6973 5f73 6361         if is_sca
+00022aa0: 6c61 7228 696e 6465 7829 206f 7220 280a  lar(index) or (.
+00022ab0: 2020 2020 2020 2020 2020 2020 6973 5f6c              is_l
+00022ac0: 6973 745f 6c69 6b65 2869 6e64 6578 290a  ist_like(index).
+00022ad0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00022ae0: 6e6f 7420 6973 5f64 6963 745f 6c69 6b65  not is_dict_like
+00022af0: 2869 6e64 6578 290a 2020 2020 2020 2020  (index).        
+00022b00: 2020 2020 616e 6420 6e6f 7420 6973 696e      and not isin
+00022b10: 7374 616e 6365 2869 6e64 6578 2c20 6464  stance(index, dd
+00022b20: 2e53 6572 6965 7329 0a20 2020 2020 2020  .Series).       
+00022b30: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+00022b40: 7265 7320 3d20 7365 6c66 2069 6620 696e  res = self if in
+00022b50: 706c 6163 6520 656c 7365 2073 656c 662e  place else self.
+00022b60: 636f 7079 2829 0a20 2020 2020 2020 2020  copy().         
+00022b70: 2020 2072 6573 2e6e 616d 6520 3d20 696e     res.name = in
+00022b80: 6465 780a 2020 2020 2020 2020 656c 7365  dex.        else
+00022b90: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00022ba0: 7320 3d20 7365 6c66 2e6d 6170 5f70 6172  s = self.map_par
+00022bb0: 7469 7469 6f6e 7328 4d2e 7265 6e61 6d65  titions(M.rename
+00022bc0: 2c20 696e 6465 782c 2065 6e66 6f72 6365  , index, enforce
+00022bd0: 5f6d 6574 6164 6174 613d 4661 6c73 6529  _metadata=False)
+00022be0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00022bf0: 7365 6c66 2e6b 6e6f 776e 5f64 6976 6973  self.known_divis
+00022c00: 696f 6e73 3a0a 2020 2020 2020 2020 2020  ions:.          
+00022c10: 2020 2020 2020 6966 2073 6f72 7465 645f        if sorted_
+00022c20: 696e 6465 7820 616e 6420 2863 616c 6c61  index and (calla
+00022c30: 626c 6528 696e 6465 7829 206f 7220 6973  ble(index) or is
+00022c40: 5f64 6963 745f 6c69 6b65 2869 6e64 6578  _dict_like(index
+00022c50: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+00022c60: 2020 2020 2020 2020 6f6c 6420 3d20 7064          old = pd
+00022c70: 2e53 6572 6965 7328 7261 6e67 6528 7365  .Series(range(se
+00022c80: 6c66 2e6e 7061 7274 6974 696f 6e73 202b  lf.npartitions +
+00022c90: 2031 292c 2069 6e64 6578 3d73 656c 662e   1), index=self.
+00022ca0: 6469 7669 7369 6f6e 7329 0a20 2020 2020  divisions).     
+00022cb0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00022cc0: 6577 203d 206f 6c64 2e72 656e 616d 6528  ew = old.rename(
+00022cd0: 696e 6465 7829 2e69 6e64 6578 0a20 2020  index).index.   
 00022ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022cf0: 2022 6973 6e27 7420 6d6f 6e6f 746f 6e69   "isn't monotoni
-00022d00: 635f 696e 6372 6561 7369 6e67 220a 2020  c_increasing".  
-00022d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022d20: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00022d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022d40: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00022d50: 286d 7367 290a 2020 2020 2020 2020 2020  (msg).          
-00022d60: 2020 2020 2020 2020 2020 7265 732e 5f64            res._d
-00022d70: 6976 6973 696f 6e73 203d 2074 7570 6c65  ivisions = tuple
-00022d80: 286d 6574 686f 6473 2e74 6f6c 6973 7428  (methods.tolist(
-00022d90: 6e65 7729 290a 2020 2020 2020 2020 2020  new)).          
-00022da0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00022db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022dc0: 7265 7320 3d20 7265 732e 636c 6561 725f  res = res.clear_
-00022dd0: 6469 7669 7369 6f6e 7328 290a 2020 2020  divisions().    
-00022de0: 2020 2020 2020 2020 6966 2069 6e70 6c61          if inpla
-00022df0: 6365 3a0a 2020 2020 2020 2020 2020 2020  ce:.            
-00022e00: 2020 2020 7365 6c66 2e64 6173 6b20 3d20      self.dask = 
-00022e10: 7265 732e 6461 736b 0a20 2020 2020 2020  res.dask.       
-00022e20: 2020 2020 2020 2020 2073 656c 662e 5f6e           self._n
-00022e30: 616d 6520 3d20 7265 732e 5f6e 616d 650a  ame = res._name.
-00022e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022e50: 7365 6c66 2e5f 6469 7669 7369 6f6e 7320  self._divisions 
-00022e60: 3d20 7265 732e 6469 7669 7369 6f6e 730a  = res.divisions.
-00022e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022e80: 7365 6c66 2e5f 6d65 7461 203d 2072 6573  self._meta = res
-00022e90: 2e5f 6d65 7461 0a20 2020 2020 2020 2020  ._meta.         
-00022ea0: 2020 2020 2020 2072 6573 203d 2073 656c         res = sel
-00022eb0: 660a 2020 2020 2020 2020 7265 7475 726e  f.        return
-00022ec0: 2072 6573 0a0a 2020 2020 4064 6572 6976   res..    @deriv
-00022ed0: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
-00022ee0: 7329 0a20 2020 2064 6566 2072 6f75 6e64  s).    def round
-00022ef0: 2873 656c 662c 2064 6563 696d 616c 733d  (self, decimals=
-00022f00: 3029 3a0a 2020 2020 2020 2020 7265 7475  0):.        retu
-00022f10: 726e 2065 6c65 6d77 6973 6528 4d2e 726f  rn elemwise(M.ro
-00022f20: 756e 642c 2073 656c 662c 2064 6563 696d  und, self, decim
-00022f30: 616c 7329 0a0a 2020 2020 4064 6572 6976  als)..    @deriv
-00022f40: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
-00022f50: 7329 0a20 2020 2064 6566 2074 6f5f 7469  s).    def to_ti
-00022f60: 6d65 7374 616d 7028 7365 6c66 2c20 6672  mestamp(self, fr
-00022f70: 6571 3d4e 6f6e 652c 2068 6f77 3d22 7374  eq=None, how="st
-00022f80: 6172 7422 2c20 6178 6973 3d30 293a 0a20  art", axis=0):. 
-00022f90: 2020 2020 2020 2064 6620 3d20 656c 656d         df = elem
-00022fa0: 7769 7365 284d 2e74 6f5f 7469 6d65 7374  wise(M.to_timest
-00022fb0: 616d 702c 2073 656c 662c 2066 7265 712c  amp, self, freq,
-00022fc0: 2068 6f77 2c20 6178 6973 290a 2020 2020   how, axis).    
-00022fd0: 2020 2020 6466 2e64 6976 6973 696f 6e73      df.divisions
-00022fe0: 203d 2074 7570 6c65 2870 642e 496e 6465   = tuple(pd.Inde
-00022ff0: 7828 7365 6c66 2e64 6976 6973 696f 6e73  x(self.divisions
-00023000: 292e 746f 5f74 696d 6573 7461 6d70 2866  ).to_timestamp(f
-00023010: 7265 713d 6672 6571 2c20 686f 773d 686f  req=freq, how=ho
-00023020: 7729 290a 2020 2020 2020 2020 7265 7475  w)).        retu
-00023030: 726e 2064 660a 0a20 2020 2064 6566 2071  rn df..    def q
-00023040: 7561 6e74 696c 6528 7365 6c66 2c20 713d  uantile(self, q=
-00023050: 302e 352c 206d 6574 686f 643d 2264 6566  0.5, method="def
-00023060: 6175 6c74 2229 3a0a 2020 2020 2020 2020  ault"):.        
-00023070: 2222 2241 7070 726f 7869 6d61 7465 2071  """Approximate q
-00023080: 7561 6e74 696c 6573 206f 6620 5365 7269  uantiles of Seri
-00023090: 6573 0a0a 2020 2020 2020 2020 5061 7261  es..        Para
-000230a0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-000230b0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-000230c0: 2020 7120 3a20 6c69 7374 2f61 7272 6179    q : list/array
-000230d0: 206f 6620 666c 6f61 7473 2c20 6465 6661   of floats, defa
-000230e0: 756c 7420 302e 3520 2835 3025 290a 2020  ult 0.5 (50%).  
-000230f0: 2020 2020 2020 2020 2020 4974 6572 6162            Iterab
-00023100: 6c65 206f 6620 6e75 6d62 6572 7320 7261  le of numbers ra
-00023110: 6e67 696e 6720 6672 6f6d 2030 2074 6f20  nging from 0 to 
-00023120: 3120 666f 7220 7468 6520 6465 7369 7265  1 for the desire
-00023130: 6420 7175 616e 7469 6c65 730a 2020 2020  d quantiles.    
-00023140: 2020 2020 6d65 7468 6f64 203a 207b 2764      method : {'d
-00023150: 6566 6175 6c74 272c 2027 7464 6967 6573  efault', 'tdiges
-00023160: 7427 2c20 2764 6173 6b27 7d2c 206f 7074  t', 'dask'}, opt
-00023170: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-00023180: 2020 5768 6174 206d 6574 686f 6420 746f    What method to
-00023190: 2075 7365 2e20 4279 2064 6566 6175 6c74   use. By default
-000231a0: 2077 696c 6c20 7573 6520 6461 736b 2773   will use dask's
-000231b0: 2069 6e74 6572 6e61 6c20 6375 7374 6f6d   internal custom
-000231c0: 0a20 2020 2020 2020 2020 2020 2061 6c67  .            alg
-000231d0: 6f72 6974 686d 2028 6060 2764 6173 6b27  orithm (``'dask'
-000231e0: 6060 292e 2020 4966 2073 6574 2074 6f20  ``).  If set to 
-000231f0: 6060 2774 6469 6765 7374 2760 6020 7769  ``'tdigest'`` wi
-00023200: 6c6c 2075 7365 2074 6469 6765 7374 0a20  ll use tdigest. 
-00023210: 2020 2020 2020 2020 2020 2066 6f72 2066             for f
-00023220: 6c6f 6174 7320 616e 6420 696e 7473 2061  loats and ints a
-00023230: 6e64 2066 616c 6c62 6163 6b20 746f 2074  nd fallback to t
-00023240: 6865 2060 6027 6461 736b 2760 6020 6f74  he ``'dask'`` ot
-00023250: 6865 7277 6973 652e 0a20 2020 2020 2020  herwise..       
-00023260: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-00023270: 7572 6e20 7175 616e 7469 6c65 2873 656c  urn quantile(sel
-00023280: 662c 2071 2c20 6d65 7468 6f64 3d6d 6574  f, q, method=met
-00023290: 686f 6429 0a0a 2020 2020 6465 6620 6d65  hod)..    def me
-000232a0: 6469 616e 5f61 7070 726f 7869 6d61 7465  dian_approximate
-000232b0: 2873 656c 662c 206d 6574 686f 643d 2264  (self, method="d
-000232c0: 6566 6175 6c74 2229 3a0a 2020 2020 2020  efault"):.      
-000232d0: 2020 2222 2252 6574 7572 6e20 7468 6520    """Return the 
-000232e0: 6170 7072 6f78 696d 6174 6520 6d65 6469  approximate medi
-000232f0: 616e 206f 6620 7468 6520 7661 6c75 6573  an of the values
-00023300: 206f 7665 7220 7468 6520 7265 7175 6573   over the reques
-00023310: 7465 6420 6178 6973 2e0a 0a20 2020 2020  ted axis...     
-00023320: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00023330: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00023340: 0a20 2020 2020 2020 206d 6574 686f 6420  .        method 
-00023350: 3a20 7b27 6465 6661 756c 7427 2c20 2774  : {'default', 't
-00023360: 6469 6765 7374 272c 2027 6461 736b 277d  digest', 'dask'}
-00023370: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00023380: 2020 2020 2020 2057 6861 7420 6d65 7468         What meth
-00023390: 6f64 2074 6f20 7573 652e 2042 7920 6465  od to use. By de
-000233a0: 6661 756c 7420 7769 6c6c 2075 7365 2044  fault will use D
-000233b0: 6173 6b27 7320 696e 7465 726e 616c 2063  ask's internal c
-000233c0: 7573 746f 6d0a 2020 2020 2020 2020 2020  ustom.          
-000233d0: 2020 616c 676f 7269 7468 6d20 2860 6022    algorithm (``"
-000233e0: 6461 736b 2260 6029 2e20 2049 6620 7365  dask"``).  If se
-000233f0: 7420 746f 2060 6022 7464 6967 6573 7422  t to ``"tdigest"
-00023400: 6060 2077 696c 6c20 7573 6520 7464 6967  `` will use tdig
-00023410: 6573 740a 2020 2020 2020 2020 2020 2020  est.            
-00023420: 666f 7220 666c 6f61 7473 2061 6e64 2069  for floats and i
-00023430: 6e74 7320 616e 6420 6661 6c6c 6261 636b  nts and fallback
-00023440: 2074 6f20 7468 6520 6060 2264 6173 6b22   to the ``"dask"
-00023450: 6060 206f 7468 6572 7769 7365 2e0a 2020  `` otherwise..  
-00023460: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00023470: 2020 7265 7475 726e 2073 656c 662e 7175    return self.qu
-00023480: 616e 7469 6c65 2871 3d30 2e35 2c20 6d65  antile(q=0.5, me
-00023490: 7468 6f64 3d6d 6574 686f 6429 0a0a 2020  thod=method)..  
-000234a0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-000234b0: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
-000234c0: 6566 206d 6564 6961 6e28 7365 6c66 2c20  ef median(self, 
-000234d0: 6d65 7468 6f64 3d22 6465 6661 756c 7422  method="default"
-000234e0: 293a 0a20 2020 2020 2020 2069 6620 7365  ):.        if se
-000234f0: 6c66 2e6e 7061 7274 6974 696f 6e73 203d  lf.npartitions =
-00023500: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-00023510: 2023 2043 616e 2070 726f 7669 6465 2061   # Can provide a
-00023520: 6e20 6578 6163 7420 6d65 6469 616e 2069  n exact median i
-00023530: 6e20 7468 6573 6520 6361 7365 730a 2020  n these cases.  
-00023540: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00023550: 2073 656c 662e 6d65 6469 616e 5f61 7070   self.median_app
-00023560: 726f 7869 6d61 7465 286d 6574 686f 643d  roximate(method=
-00023570: 6d65 7468 6f64 290a 2020 2020 2020 2020  method).        
-00023580: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-00023590: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
-000235a0: 2020 2020 2020 2022 4461 736b 2064 6f65         "Dask doe
-000235b0: 736e 2774 2069 6d70 6c65 6d65 6e74 2061  sn't implement a
-000235c0: 6e20 6578 6163 7420 6d65 6469 616e 2069  n exact median i
-000235d0: 6e20 616c 6c20 6361 7365 7320 6173 2074  n all cases as t
-000235e0: 6869 7320 6973 2068 6172 6420 746f 2064  his is hard to d
-000235f0: 6f20 696e 2070 6172 616c 6c65 6c2e 2022  o in parallel. "
-00023600: 0a20 2020 2020 2020 2020 2020 2022 5365  .            "Se
-00023610: 6520 7468 6520 606d 6564 6961 6e5f 6170  e the `median_ap
-00023620: 7072 6f78 696d 6174 6560 206d 6574 686f  proximate` metho
-00023630: 6420 696e 7374 6561 642c 2077 6869 6368  d instead, which
-00023640: 2075 7365 7320 616e 2061 7070 726f 7869   uses an approxi
-00023650: 6d61 7465 2061 6c67 6f72 6974 686d 2e22  mate algorithm."
-00023660: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00023670: 6465 6620 5f72 6570 6172 7469 7469 6f6e  def _repartition
-00023680: 5f71 7561 6e74 696c 6573 2873 656c 662c  _quantiles(self,
-00023690: 206e 7061 7274 6974 696f 6e73 2c20 7570   npartitions, up
-000236a0: 7361 6d70 6c65 3d31 2e30 293a 0a20 2020  sample=1.0):.   
-000236b0: 2020 2020 2022 2222 4170 7072 6f78 696d       """Approxim
-000236c0: 6174 6520 7175 616e 7469 6c65 7320 6f66  ate quantiles of
-000236d0: 2053 6572 6965 7320 7573 6564 2066 6f72   Series used for
-000236e0: 2072 6570 6172 7469 7469 6f6e 696e 6722   repartitioning"
-000236f0: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
-00023700: 6461 736b 2e64 6174 6166 7261 6d65 2e70  dask.dataframe.p
-00023710: 6172 7469 7469 6f6e 7175 616e 7469 6c65  artitionquantile
-00023720: 7320 696d 706f 7274 2070 6172 7469 7469  s import partiti
-00023730: 6f6e 5f71 7561 6e74 696c 6573 0a0a 2020  on_quantiles..  
-00023740: 2020 2020 2020 7265 7475 726e 2070 6172        return par
-00023750: 7469 7469 6f6e 5f71 7561 6e74 696c 6573  tition_quantiles
-00023760: 2873 656c 662c 206e 7061 7274 6974 696f  (self, npartitio
-00023770: 6e73 2c20 7570 7361 6d70 6c65 3d75 7073  ns, upsample=ups
-00023780: 616d 706c 6529 0a0a 2020 2020 6465 6620  ample)..    def 
-00023790: 5f5f 6765 7469 7465 6d5f 5f28 7365 6c66  __getitem__(self
-000237a0: 2c20 6b65 7929 3a0a 2020 2020 2020 2020  , key):.        
-000237b0: 6966 2069 7369 6e73 7461 6e63 6528 6b65  if isinstance(ke
-000237c0: 792c 2053 6572 6965 7329 2061 6e64 2073  y, Series) and s
-000237d0: 656c 662e 6469 7669 7369 6f6e 7320 3d3d  elf.divisions ==
-000237e0: 206b 6579 2e64 6976 6973 696f 6e73 3a0a   key.divisions:.
-000237f0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00023800: 203d 2022 696e 6465 782d 2573 2220 2520   = "index-%s" % 
-00023810: 746f 6b65 6e69 7a65 2873 656c 662c 206b  tokenize(self, k
-00023820: 6579 290a 2020 2020 2020 2020 2020 2020  ey).            
-00023830: 6473 6b20 3d20 7061 7274 6974 696f 6e77  dsk = partitionw
-00023840: 6973 655f 6772 6170 6828 6f70 6572 6174  ise_graph(operat
-00023850: 6f72 2e67 6574 6974 656d 2c20 6e61 6d65  or.getitem, name
-00023860: 2c20 7365 6c66 2c20 6b65 7929 0a20 2020  , self, key).   
-00023870: 2020 2020 2020 2020 2067 7261 7068 203d           graph =
-00023880: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
-00023890: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
-000238a0: 286e 616d 652c 2064 736b 2c20 6465 7065  (name, dsk, depe
-000238b0: 6e64 656e 6369 6573 3d5b 7365 6c66 2c20  ndencies=[self, 
-000238c0: 6b65 795d 290a 2020 2020 2020 2020 2020  key]).          
-000238d0: 2020 7265 7475 726e 2053 6572 6965 7328    return Series(
-000238e0: 6772 6170 682c 206e 616d 652c 2073 656c  graph, name, sel
-000238f0: 662e 5f6d 6574 612c 2073 656c 662e 6469  f._meta, self.di
-00023900: 7669 7369 6f6e 7329 0a20 2020 2020 2020  visions).       
-00023910: 2072 6574 7572 6e20 7365 6c66 2e6c 6f63   return self.loc
-00023920: 5b6b 6579 5d0a 0a20 2020 2040 6465 7269  [key]..    @deri
-00023930: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-00023940: 4672 616d 6529 0a20 2020 2064 6566 205f  Frame).    def _
-00023950: 6765 745f 6e75 6d65 7269 635f 6461 7461  get_numeric_data
-00023960: 2873 656c 662c 2068 6f77 3d22 616e 7922  (self, how="any"
-00023970: 2c20 7375 6273 6574 3d4e 6f6e 6529 3a0a  , subset=None):.
-00023980: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00023990: 656c 660a 0a20 2020 2069 6620 6e6f 7420  elf..    if not 
-000239a0: 5041 4e44 4153 5f47 545f 3230 303a 0a0a  PANDAS_GT_200:..
-000239b0: 2020 2020 2020 2020 4064 6572 6976 6564          @derived
-000239c0: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
-000239d0: 0a20 2020 2020 2020 2064 6566 2069 7465  .        def ite
-000239e0: 7269 7465 6d73 2873 656c 6629 3a0a 2020  ritems(self):.  
-000239f0: 2020 2020 2020 2020 2020 6966 2050 414e            if PAN
-00023a00: 4441 535f 4754 5f31 3530 3a0a 2020 2020  DAS_GT_150:.    
-00023a10: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-00023a20: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
-00023a30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00023a40: 6974 6572 6974 656d 7320 6973 2064 6570  iteritems is dep
-00023a50: 7265 6361 7465 6420 616e 6420 7769 6c6c  recated and will
-00023a60: 2062 6520 7265 6d6f 7665 6420 696e 2061   be removed in a
-00023a70: 2066 7574 7572 6520 7665 7273 696f 6e2e   future version.
-00023a80: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-00023a90: 2020 2020 2020 2022 5573 6520 2e69 7465         "Use .ite
-00023aa0: 6d73 2069 6e73 7465 6164 2e22 2c0a 2020  ms instead.",.  
-00023ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023ac0: 2020 4675 7475 7265 5761 726e 696e 672c    FutureWarning,
-00023ad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023ae0: 2029 0a20 2020 2020 2020 2020 2020 2023   ).            #
-00023af0: 2057 6520 7573 6520 7468 6520 605f 6020   We use the `_` 
-00023b00: 6765 6e65 7261 746f 7220 6265 6c6f 7720  generator below 
-00023b10: 746f 2065 6e73 7572 6520 7468 6520 6465  to ensure the de
-00023b20: 7072 6563 6174 696f 6e20 7761 726e 696e  precation warnin
-00023b30: 6720 6162 6f76 650a 2020 2020 2020 2020  g above.        
-00023b40: 2020 2020 2320 6973 2072 6169 7365 6420      # is raised 
-00023b50: 7768 656e 2060 2e69 7465 7269 7465 6d73  when `.iteritems
-00023b60: 2829 6020 6973 2063 616c 6c65 642c 206e  ()` is called, n
-00023b70: 6f74 2077 6865 6e20 7468 6520 6669 7273  ot when the firs
-00023b80: 7420 606e 6578 7428 3c67 656e 6572 6174  t `next(<generat
-00023b90: 6f72 3e29 600a 2020 2020 2020 2020 2020  or>)`.          
-00023ba0: 2020 2320 6974 6572 6174 696f 6e20 6861    # iteration ha
-00023bb0: 7070 656e 730a 0a20 2020 2020 2020 2020  ppens..         
-00023bc0: 2020 2064 6566 205f 2873 656c 6629 3a0a     def _(self):.
-00023bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023be0: 666f 7220 6920 696e 2072 616e 6765 2873  for i in range(s
-00023bf0: 656c 662e 6e70 6172 7469 7469 6f6e 7329  elf.npartitions)
-00023c00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00023c10: 2020 2020 2020 7320 3d20 7365 6c66 2e67        s = self.g
-00023c20: 6574 5f70 6172 7469 7469 6f6e 2869 292e  et_partition(i).
-00023c30: 636f 6d70 7574 6528 290a 2020 2020 2020  compute().      
-00023c40: 2020 2020 2020 2020 2020 2020 2020 7969                yi
-00023c50: 656c 6420 6672 6f6d 2073 2e69 7465 6d73  eld from s.items
-00023c60: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
-00023c70: 7265 7475 726e 205f 2873 656c 6629 0a0a  return _(self)..
-00023c80: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00023c90: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-00023ca0: 2064 6566 205f 5f69 7465 725f 5f28 7365   def __iter__(se
-00023cb0: 6c66 293a 0a20 2020 2020 2020 2066 6f72  lf):.        for
-00023cc0: 2069 2069 6e20 7261 6e67 6528 7365 6c66   i in range(self
-00023cd0: 2e6e 7061 7274 6974 696f 6e73 293a 0a20  .npartitions):. 
-00023ce0: 2020 2020 2020 2020 2020 2073 203d 2073             s = s
-00023cf0: 656c 662e 6765 745f 7061 7274 6974 696f  elf.get_partitio
-00023d00: 6e28 6929 2e63 6f6d 7075 7465 2829 0a20  n(i).compute(). 
-00023d10: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
-00023d20: 2066 726f 6d20 730a 0a20 2020 2040 5f64   from s..    @_d
-00023d30: 6570 7265 6361 7465 6428 0a20 2020 2020  eprecated(.     
-00023d40: 2020 206d 6573 7361 6765 3d28 0a20 2020     message=(.   
-00023d50: 2020 2020 2020 2020 2022 5573 696e 6720           "Using 
-00023d60: 7468 6520 6060 696e 6060 206f 7065 7261  the ``in`` opera
-00023d70: 746f 7220 746f 2074 6573 7420 666f 7220  tor to test for 
-00023d80: 6d65 6d62 6572 7368 6970 2069 6e20 5365  membership in Se
-00023d90: 7269 6573 2069 7320 220a 2020 2020 2020  ries is ".      
-00023da0: 2020 2020 2020 2264 6570 7265 6361 7465        "deprecate
-00023db0: 642e 2054 6f20 7465 7374 2066 6f72 206d  d. To test for m
-00023dc0: 656d 6265 7273 6869 7020 696e 2074 6865  embership in the
-00023dd0: 2069 6e64 6578 2075 7365 2022 0a20 2020   index use ".   
-00023de0: 2020 2020 2020 2020 2022 6060 2873 2e69           "``(s.i
-00023df0: 6e64 6578 203d 3d20 6b65 7929 2e61 6e79  ndex == key).any
-00023e00: 2829 6060 2e20 5369 6d69 6c61 726c 7920  ()``. Similarly 
-00023e10: 746f 2074 6573 7420 666f 7220 6d65 6d62  to test for memb
-00023e20: 6572 7368 6970 2069 6e20 220a 2020 2020  ership in ".    
-00023e30: 2020 2020 2020 2020 2274 6865 2076 616c          "the val
-00023e40: 7565 7320 7573 6520 6060 2873 203d 3d20  ues use ``(s == 
-00023e50: 6b65 7929 2e61 6e79 2829 6060 220a 2020  key).any()``".  
-00023e60: 2020 2020 2020 290a 2020 2020 290a 2020        ).    ).  
-00023e70: 2020 6465 6620 5f5f 636f 6e74 6169 6e73    def __contains
-00023e80: 5f5f 2873 656c 662c 206b 6579 293a 0a20  __(self, key):. 
-00023e90: 2020 2020 2020 2072 6574 7572 6e20 2873         return (s
-00023ea0: 656c 6620 3d3d 206b 6579 292e 616e 7928  elf == key).any(
-00023eb0: 292e 636f 6d70 7574 6528 290a 0a20 2020  ).compute()..   
-00023ec0: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
-00023ed0: 2020 6465 6620 5f76 616c 6964 6174 655f    def _validate_
-00023ee0: 6178 6973 2863 6c73 2c20 6178 6973 3d30  axis(cls, axis=0
-00023ef0: 2c20 6e6f 6e65 5f69 735f 7a65 726f 3a20  , none_is_zero: 
-00023f00: 626f 6f6c 203d 2054 7275 6529 202d 3e20  bool = True) -> 
-00023f10: 4e6f 6e65 207c 204c 6974 6572 616c 5b30  None | Literal[0
-00023f20: 2c20 315d 3a0a 2020 2020 2020 2020 6966  , 1]:.        if
-00023f30: 2061 7869 7320 6e6f 7420 696e 2028 302c   axis not in (0,
-00023f40: 2022 696e 6465 7822 2c20 4e6f 6e65 293a   "index", None):
-00023f50: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00023f60: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
-00023f70: 4e6f 2061 7869 7320 6e61 6d65 6420 7b61  No axis named {a
-00023f80: 7869 737d 2229 0a20 2020 2020 2020 2023  xis}").        #
-00023f90: 2063 6f6e 7665 7274 2074 6f20 6e75 6d65   convert to nume
-00023fa0: 7269 6320 6178 6973 0a20 2020 2020 2020  ric axis.       
-00023fb0: 206e 756d 6572 6963 5f61 7869 733a 2064   numeric_axis: d
-00023fc0: 6963 745b 7374 7220 7c20 4e6f 6e65 2c20  ict[str | None, 
-00023fd0: 4c69 7465 7261 6c5b 302c 2031 5d5d 203d  Literal[0, 1]] =
-00023fe0: 207b 2269 6e64 6578 223a 2030 7d0a 2020   {"index": 0}.  
-00023ff0: 2020 2020 2020 6966 206e 6f6e 655f 6973        if none_is
-00024000: 5f7a 6572 6f3a 0a20 2020 2020 2020 2020  _zero:.         
-00024010: 2020 206e 756d 6572 6963 5f61 7869 735b     numeric_axis[
-00024020: 4e6f 6e65 5d20 3d20 300a 2020 2020 2020  None] = 0.      
-00024030: 2020 7265 7475 726e 206e 756d 6572 6963    return numeric
-00024040: 5f61 7869 732e 6765 7428 6178 6973 2c20  _axis.get(axis, 
-00024050: 6178 6973 290a 0a20 2020 2040 6465 7269  axis)..    @deri
-00024060: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
-00024070: 6573 290a 2020 2020 6465 6620 6772 6f75  es).    def grou
-00024080: 7062 7928 0a20 2020 2020 2020 2073 656c  pby(.        sel
-00024090: 662c 0a20 2020 2020 2020 2062 793d 4e6f  f,.        by=No
-000240a0: 6e65 2c0a 2020 2020 2020 2020 6772 6f75  ne,.        grou
-000240b0: 705f 6b65 7973 3d47 524f 5550 5f4b 4559  p_keys=GROUP_KEY
-000240c0: 535f 4445 4641 554c 542c 0a20 2020 2020  S_DEFAULT,.     
-000240d0: 2020 2073 6f72 743d 4e6f 6e65 2c0a 2020     sort=None,.  
-000240e0: 2020 2020 2020 6f62 7365 7276 6564 3d4e        observed=N
-000240f0: 6f6e 652c 0a20 2020 2020 2020 2064 726f  one,.        dro
-00024100: 706e 613d 4e6f 6e65 2c0a 2020 2020 2020  pna=None,.      
-00024110: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
-00024120: 293a 0a20 2020 2020 2020 2066 726f 6d20  ):.        from 
-00024130: 6461 736b 2e64 6174 6166 7261 6d65 2e67  dask.dataframe.g
-00024140: 726f 7570 6279 2069 6d70 6f72 7420 5365  roupby import Se
-00024150: 7269 6573 4772 6f75 7042 790a 0a20 2020  riesGroupBy..   
-00024160: 2020 2020 2072 6574 7572 6e20 5365 7269       return Seri
-00024170: 6573 4772 6f75 7042 7928 0a20 2020 2020  esGroupBy(.     
-00024180: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00024190: 2020 2020 2020 2020 2062 793d 6279 2c0a           by=by,.
-000241a0: 2020 2020 2020 2020 2020 2020 6772 6f75              grou
-000241b0: 705f 6b65 7973 3d67 726f 7570 5f6b 6579  p_keys=group_key
-000241c0: 732c 0a20 2020 2020 2020 2020 2020 2073  s,.            s
-000241d0: 6f72 743d 736f 7274 2c0a 2020 2020 2020  ort=sort,.      
-000241e0: 2020 2020 2020 6f62 7365 7276 6564 3d6f        observed=o
-000241f0: 6273 6572 7665 642c 0a20 2020 2020 2020  bserved,.       
-00024200: 2020 2020 2064 726f 706e 613d 6472 6f70       dropna=drop
-00024210: 6e61 2c0a 2020 2020 2020 2020 2020 2020  na,.            
-00024220: 2a2a 6b77 6172 6773 2c0a 2020 2020 2020  **kwargs,.      
-00024230: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
-00024240: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
-00024250: 290a 2020 2020 6465 6620 636f 756e 7428  ).    def count(
-00024260: 7365 6c66 2c20 7370 6c69 745f 6576 6572  self, split_ever
-00024270: 793d 4661 6c73 6529 3a0a 2020 2020 2020  y=False):.      
-00024280: 2020 7265 7475 726e 2073 7570 6572 2829    return super()
-00024290: 2e63 6f75 6e74 2873 706c 6974 5f65 7665  .count(split_eve
-000242a0: 7279 3d73 706c 6974 5f65 7665 7279 290a  ry=split_every).
-000242b0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-000242c0: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
-000242d0: 2020 6465 6620 6d6f 6465 2873 656c 662c    def mode(self,
-000242e0: 2064 726f 706e 613d 5472 7565 2c20 7370   dropna=True, sp
-000242f0: 6c69 745f 6576 6572 793d 4661 6c73 6529  lit_every=False)
-00024300: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00024310: 2073 7570 6572 2829 2e6d 6f64 6528 6472   super().mode(dr
-00024320: 6f70 6e61 3d64 726f 706e 612c 2073 706c  opna=dropna, spl
-00024330: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-00024340: 7665 7279 290a 0a20 2020 2040 6465 7269  very)..    @deri
-00024350: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
-00024360: 6573 290a 2020 2020 6465 6620 6578 706c  es).    def expl
-00024370: 6f64 6528 7365 6c66 293a 0a20 2020 2020  ode(self):.     
-00024380: 2020 206d 6574 6120 3d20 7365 6c66 2e5f     meta = self._
-00024390: 6d65 7461 2e65 7870 6c6f 6465 2829 0a20  meta.explode(). 
-000243a0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000243b0: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
-000243c0: 7328 4d2e 6578 706c 6f64 652c 206d 6574  s(M.explode, met
-000243d0: 613d 6d65 7461 2c20 656e 666f 7263 655f  a=meta, enforce_
-000243e0: 6d65 7461 6461 7461 3d46 616c 7365 290a  metadata=False).
-000243f0: 0a20 2020 2064 6566 2075 6e69 7175 6528  .    def unique(
-00024400: 7365 6c66 2c20 7370 6c69 745f 6576 6572  self, split_ever
-00024410: 793d 4e6f 6e65 2c20 7370 6c69 745f 6f75  y=None, split_ou
-00024420: 743d 3129 3a0a 2020 2020 2020 2020 2222  t=1):.        ""
-00024430: 220a 2020 2020 2020 2020 5265 7475 726e  ".        Return
-00024440: 2053 6572 6965 7320 6f66 2075 6e69 7175   Series of uniqu
-00024450: 6520 7661 6c75 6573 2069 6e20 7468 6520  e values in the 
-00024460: 6f62 6a65 6374 2e20 496e 636c 7564 6573  object. Includes
-00024470: 204e 4120 7661 6c75 6573 2e0a 0a20 2020   NA values...   
-00024480: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-00024490: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-000244a0: 2020 2020 2075 6e69 7175 6573 203a 2053       uniques : S
-000244b0: 6572 6965 730a 2020 2020 2020 2020 2222  eries.        ""
-000244c0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-000244d0: 2061 6361 280a 2020 2020 2020 2020 2020   aca(.          
-000244e0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-000244f0: 2020 2020 6368 756e 6b3d 6d65 7468 6f64      chunk=method
-00024500: 732e 756e 6971 7565 2c0a 2020 2020 2020  s.unique,.      
-00024510: 2020 2020 2020 6167 6772 6567 6174 653d        aggregate=
-00024520: 6d65 7468 6f64 732e 756e 6971 7565 2c0a  methods.unique,.
-00024530: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-00024540: 3d73 656c 662e 5f6d 6574 612c 0a20 2020  =self._meta,.   
-00024550: 2020 2020 2020 2020 2074 6f6b 656e 3d22           token="
-00024560: 756e 6971 7565 222c 0a20 2020 2020 2020  unique",.       
-00024570: 2020 2020 2073 706c 6974 5f65 7665 7279       split_every
-00024580: 3d73 706c 6974 5f65 7665 7279 2c0a 2020  =split_every,.  
-00024590: 2020 2020 2020 2020 2020 7365 7269 6573            series
-000245a0: 5f6e 616d 653d 7365 6c66 2e6e 616d 652c  _name=self.name,
-000245b0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
-000245c0: 6974 5f6f 7574 3d73 706c 6974 5f6f 7574  it_out=split_out
-000245d0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-000245e0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-000245f0: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
-00024600: 6620 6e75 6e69 7175 6528 7365 6c66 2c20  f nunique(self, 
-00024610: 7370 6c69 745f 6576 6572 793d 4e6f 6e65  split_every=None
-00024620: 2c20 6472 6f70 6e61 3d54 7275 6529 3a0a  , dropna=True):.
-00024630: 2020 2020 2020 2020 756e 6971 7320 3d20          uniqs = 
-00024640: 7365 6c66 2e64 726f 705f 6475 706c 6963  self.drop_duplic
-00024650: 6174 6573 2873 706c 6974 5f65 7665 7279  ates(split_every
-00024660: 3d73 706c 6974 5f65 7665 7279 290a 2020  =split_every).  
-00024670: 2020 2020 2020 6966 2064 726f 706e 613a        if dropna:
-00024680: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
-00024690: 6f75 6e74 206d 696d 6963 7320 7061 6e64  ount mimics pand
-000246a0: 6173 2062 6568 6176 696f 7220 616e 6420  as behavior and 
-000246b0: 6578 636c 7564 6573 204e 4120 7661 6c75  excludes NA valu
-000246c0: 6573 0a20 2020 2020 2020 2020 2020 2072  es.            r
-000246d0: 6574 7572 6e20 756e 6971 732e 636f 756e  eturn uniqs.coun
-000246e0: 7428 290a 2020 2020 2020 2020 656c 7365  t().        else
-000246f0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00024700: 7475 726e 2075 6e69 7173 2e73 697a 650a  turn uniqs.size.
-00024710: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00024720: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
-00024730: 2020 6465 6620 7661 6c75 655f 636f 756e    def value_coun
-00024740: 7473 280a 2020 2020 2020 2020 7365 6c66  ts(.        self
-00024750: 2c0a 2020 2020 2020 2020 736f 7274 3d4e  ,.        sort=N
-00024760: 6f6e 652c 0a20 2020 2020 2020 2061 7363  one,.        asc
-00024770: 656e 6469 6e67 3d46 616c 7365 2c0a 2020  ending=False,.  
-00024780: 2020 2020 2020 6472 6f70 6e61 3d54 7275        dropna=Tru
-00024790: 652c 0a20 2020 2020 2020 206e 6f72 6d61  e,.        norma
-000247a0: 6c69 7a65 3d46 616c 7365 2c0a 2020 2020  lize=False,.    
-000247b0: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
-000247c0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7370  None,.        sp
-000247d0: 6c69 745f 6f75 743d 312c 0a20 2020 2029  lit_out=1,.    )
-000247e0: 3a0a 2020 2020 2020 2020 6b77 6172 6773  :.        kwargs
-000247f0: 203d 207b 2273 6f72 7422 3a20 736f 7274   = {"sort": sort
-00024800: 2c20 2261 7363 656e 6469 6e67 223a 2061  , "ascending": a
-00024810: 7363 656e 6469 6e67 2c20 2264 726f 706e  scending, "dropn
-00024820: 6122 3a20 6472 6f70 6e61 7d0a 2020 2020  a": dropna}.    
-00024830: 2020 2020 6167 6772 6567 6174 655f 6b77      aggregate_kw
-00024840: 6172 6773 203d 207b 226e 6f72 6d61 6c69  args = {"normali
-00024850: 7a65 223a 206e 6f72 6d61 6c69 7a65 7d0a  ze": normalize}.
-00024860: 2020 2020 2020 2020 6966 2073 706c 6974          if split
-00024870: 5f6f 7574 203e 2031 3a0a 2020 2020 2020  _out > 1:.      
-00024880: 2020 2020 2020 6167 6772 6567 6174 655f        aggregate_
-00024890: 6b77 6172 6773 5b22 746f 7461 6c5f 6c65  kwargs["total_le
-000248a0: 6e67 7468 225d 203d 2028 0a20 2020 2020  ngth"] = (.     
-000248b0: 2020 2020 2020 2020 2020 206c 656e 2873             len(s
-000248c0: 656c 6629 2069 6620 6472 6f70 6e61 2069  elf) if dropna i
-000248d0: 7320 4661 6c73 6520 656c 7365 206c 656e  s False else len
-000248e0: 2873 656c 662e 6472 6f70 6e61 2829 290a  (self.dropna()).
-000248f0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00024900: 2020 2020 2020 2072 6574 7572 6e20 6163         return ac
-00024910: 6128 0a20 2020 2020 2020 2020 2020 2073  a(.            s
-00024920: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-00024930: 2063 6875 6e6b 3d4d 2e76 616c 7565 5f63   chunk=M.value_c
-00024940: 6f75 6e74 732c 0a20 2020 2020 2020 2020  ounts,.         
-00024950: 2020 2061 6767 7265 6761 7465 3d6d 6574     aggregate=met
-00024960: 686f 6473 2e76 616c 7565 5f63 6f75 6e74  hods.value_count
-00024970: 735f 6167 6772 6567 6174 652c 0a20 2020  s_aggregate,.   
-00024980: 2020 2020 2020 2020 2063 6f6d 6269 6e65           combine
-00024990: 3d6d 6574 686f 6473 2e76 616c 7565 5f63  =methods.value_c
-000249a0: 6f75 6e74 735f 636f 6d62 696e 652c 0a20  ounts_combine,. 
-000249b0: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
-000249c0: 7365 6c66 2e5f 6d65 7461 2e76 616c 7565  self._meta.value
-000249d0: 5f63 6f75 6e74 7328 6e6f 726d 616c 697a  _counts(normaliz
-000249e0: 653d 6e6f 726d 616c 697a 6529 2c0a 2020  e=normalize),.  
-000249f0: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
-00024a00: 2276 616c 7565 2d63 6f75 6e74 7322 2c0a  "value-counts",.
-00024a10: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
-00024a20: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
-00024a30: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
-00024a40: 2073 706c 6974 5f6f 7574 3d73 706c 6974   split_out=split
-00024a50: 5f6f 7574 2c0a 2020 2020 2020 2020 2020  _out,.          
-00024a60: 2020 7370 6c69 745f 6f75 745f 7365 7475    split_out_setu
-00024a70: 703d 7370 6c69 745f 6f75 745f 6f6e 5f69  p=split_out_on_i
-00024a80: 6e64 6578 2c0a 2020 2020 2020 2020 2020  ndex,.          
-00024a90: 2020 6167 6772 6567 6174 655f 6b77 6172    aggregate_kwar
-00024aa0: 6773 3d61 6767 7265 6761 7465 5f6b 7761  gs=aggregate_kwa
-00024ab0: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
-00024ac0: 202a 2a6b 7761 7267 732c 0a20 2020 2020   **kwargs,.     
-00024ad0: 2020 2029 0a0a 2020 2020 4064 6572 6976     )..    @deriv
-00024ae0: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
-00024af0: 7329 0a20 2020 2064 6566 206e 6c61 7267  s).    def nlarg
-00024b00: 6573 7428 7365 6c66 2c20 6e3d 352c 2073  est(self, n=5, s
-00024b10: 706c 6974 5f65 7665 7279 3d4e 6f6e 6529  plit_every=None)
-00024b20: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00024b30: 2061 6361 280a 2020 2020 2020 2020 2020   aca(.          
-00024b40: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00024b50: 2020 2020 6368 756e 6b3d 4d2e 6e6c 6172      chunk=M.nlar
-00024b60: 6765 7374 2c0a 2020 2020 2020 2020 2020  gest,.          
-00024b70: 2020 6167 6772 6567 6174 653d 4d2e 6e6c    aggregate=M.nl
-00024b80: 6172 6765 7374 2c0a 2020 2020 2020 2020  argest,.        
-00024b90: 2020 2020 6d65 7461 3d73 656c 662e 5f6d      meta=self._m
-00024ba0: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
-00024bb0: 2074 6f6b 656e 3d22 7365 7269 6573 2d6e   token="series-n
-00024bc0: 6c61 7267 6573 7422 2c0a 2020 2020 2020  largest",.      
-00024bd0: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
-00024be0: 793d 7370 6c69 745f 6576 6572 792c 0a20  y=split_every,. 
-00024bf0: 2020 2020 2020 2020 2020 206e 3d6e 2c0a             n=n,.
-00024c00: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-00024c10: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00024c20: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
-00024c30: 6e73 6d61 6c6c 6573 7428 7365 6c66 2c20  nsmallest(self, 
-00024c40: 6e3d 352c 2073 706c 6974 5f65 7665 7279  n=5, split_every
-00024c50: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-00024c60: 7265 7475 726e 2061 6361 280a 2020 2020  return aca(.    
-00024c70: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00024c80: 2020 2020 2020 2020 2020 6368 756e 6b3d            chunk=
-00024c90: 4d2e 6e73 6d61 6c6c 6573 742c 0a20 2020  M.nsmallest,.   
-00024ca0: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
-00024cb0: 7465 3d4d 2e6e 736d 616c 6c65 7374 2c0a  te=M.nsmallest,.
-00024cc0: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-00024cd0: 3d73 656c 662e 5f6d 6574 612c 0a20 2020  =self._meta,.   
-00024ce0: 2020 2020 2020 2020 2074 6f6b 656e 3d22           token="
-00024cf0: 7365 7269 6573 2d6e 736d 616c 6c65 7374  series-nsmallest
-00024d00: 222c 0a20 2020 2020 2020 2020 2020 2073  ",.            s
-00024d10: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
-00024d20: 5f65 7665 7279 2c0a 2020 2020 2020 2020  _every,.        
-00024d30: 2020 2020 6e3d 6e2c 0a20 2020 2020 2020      n=n,.       
-00024d40: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
-00024d50: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
-00024d60: 0a20 2020 2064 6566 2069 7369 6e28 7365  .    def isin(se
-00024d70: 6c66 2c20 7661 6c75 6573 293a 0a20 2020  lf, values):.   
-00024d80: 2020 2020 2023 2041 6464 6564 206a 7573       # Added jus
-00024d90: 7420 746f 2067 6574 2074 6865 2064 6966  t to get the dif
-00024da0: 6665 7265 6e74 2064 6f63 7374 7269 6e67  ferent docstring
-00024db0: 2066 6f72 2053 6572 6965 730a 2020 2020   for Series.    
-00024dc0: 2020 2020 7265 7475 726e 2073 7570 6572      return super
-00024dd0: 2829 2e69 7369 6e28 7661 6c75 6573 290a  ().isin(values).
-00024de0: 0a20 2020 2040 696e 7365 7274 5f6d 6574  .    @insert_met
-00024df0: 615f 7061 7261 6d5f 6465 7363 7269 7074  a_param_descript
-00024e00: 696f 6e28 7061 643d 3132 290a 2020 2020  ion(pad=12).    
-00024e10: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-00024e20: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
-00024e30: 206d 6170 2873 656c 662c 2061 7267 2c20   map(self, arg, 
-00024e40: 6e61 5f61 6374 696f 6e3d 4e6f 6e65 2c20  na_action=None, 
-00024e50: 6d65 7461 3d6e 6f5f 6465 6661 756c 7429  meta=no_default)
-00024e60: 3a0a 2020 2020 2020 2020 6966 2069 735f  :.        if is_
-00024e70: 7365 7269 6573 5f6c 696b 6528 6172 6729  series_like(arg)
-00024e80: 2061 6e64 2069 735f 6461 736b 5f63 6f6c   and is_dask_col
-00024e90: 6c65 6374 696f 6e28 6172 6729 3a0a 2020  lection(arg):.  
-00024ea0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00024eb0: 2073 6572 6965 735f 6d61 7028 7365 6c66   series_map(self
-00024ec0: 2c20 6172 6729 0a20 2020 2020 2020 2069  , arg).        i
-00024ed0: 6620 6e6f 7420 280a 2020 2020 2020 2020  f not (.        
-00024ee0: 2020 2020 6973 696e 7374 616e 6365 2861      isinstance(a
-00024ef0: 7267 2c20 6469 6374 290a 2020 2020 2020  rg, dict).      
-00024f00: 2020 2020 2020 6f72 2063 616c 6c61 626c        or callabl
-00024f10: 6528 6172 6729 0a20 2020 2020 2020 2020  e(arg).         
-00024f20: 2020 206f 7220 6973 5f73 6572 6965 735f     or is_series_
-00024f30: 6c69 6b65 2861 7267 290a 2020 2020 2020  like(arg).      
-00024f40: 2020 2020 2020 616e 6420 6e6f 7420 6973        and not is
-00024f50: 5f64 6173 6b5f 636f 6c6c 6563 7469 6f6e  _dask_collection
-00024f60: 2861 7267 290a 2020 2020 2020 2020 293a  (arg).        ):
-00024f70: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00024f80: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
-00024f90: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-00024fa0: 6172 6720 6d75 7374 2062 6520 7061 6e64  arg must be pand
-00024fb0: 6173 2e53 6572 6965 732c 2064 6963 7420  as.Series, dict 
-00024fc0: 6f72 2063 616c 6c61 626c 652e 2047 6f74  or callable. Got
-00024fd0: 207b 7479 7065 2861 7267 297d 220a 2020   {type(arg)}".  
-00024fe0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00024ff0: 2020 2020 6e61 6d65 203d 2022 6d61 702d      name = "map-
-00025000: 2220 2b20 746f 6b65 6e69 7a65 2873 656c  " + tokenize(sel
-00025010: 662c 2061 7267 2c20 6e61 5f61 6374 696f  f, arg, na_actio
-00025020: 6e29 0a20 2020 2020 2020 2064 736b 203d  n).        dsk =
-00025030: 207b 0a20 2020 2020 2020 2020 2020 2028   {.            (
-00025040: 6e61 6d65 2c20 6929 3a20 284d 2e6d 6170  name, i): (M.map
-00025050: 2c20 6b2c 2061 7267 2c20 6e61 5f61 6374  , k, arg, na_act
-00025060: 696f 6e29 0a20 2020 2020 2020 2020 2020  ion).           
-00025070: 2066 6f72 2069 2c20 6b20 696e 2065 6e75   for i, k in enu
-00025080: 6d65 7261 7465 2873 656c 662e 5f5f 6461  merate(self.__da
-00025090: 736b 5f6b 6579 735f 5f28 2929 0a20 2020  sk_keys__()).   
-000250a0: 2020 2020 207d 0a20 2020 2020 2020 2067       }.        g
-000250b0: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
-000250c0: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-000250d0: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
-000250e0: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
-000250f0: 7365 6c66 5d29 0a20 2020 2020 2020 2069  self]).        i
-00025100: 6620 6d65 7461 2069 7320 6e6f 5f64 6566  f meta is no_def
-00025110: 6175 6c74 3a0a 2020 2020 2020 2020 2020  ault:.          
-00025120: 2020 6d65 7461 203d 205f 656d 756c 6174    meta = _emulat
-00025130: 6528 4d2e 6d61 702c 2073 656c 662c 2061  e(M.map, self, a
-00025140: 7267 2c20 6e61 5f61 6374 696f 6e3d 6e61  rg, na_action=na
-00025150: 5f61 6374 696f 6e2c 2075 6466 3d54 7275  _action, udf=Tru
-00025160: 6529 0a20 2020 2020 2020 2065 6c73 653a  e).        else:
-00025170: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-00025180: 6120 3d20 6d61 6b65 5f6d 6574 6128 0a20  a = make_meta(. 
-00025190: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-000251a0: 6574 612c 0a20 2020 2020 2020 2020 2020  eta,.           
-000251b0: 2020 2020 2069 6e64 6578 3d67 6574 6174       index=getat
-000251c0: 7472 286d 616b 655f 6d65 7461 2873 656c  tr(make_meta(sel
-000251d0: 6629 2c20 2269 6e64 6578 222c 204e 6f6e  f), "index", Non
-000251e0: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
-000251f0: 2020 2020 7061 7265 6e74 5f6d 6574 613d      parent_meta=
-00025200: 7365 6c66 2e5f 6d65 7461 2c0a 2020 2020  self._meta,.    
-00025210: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00025220: 2020 2072 6574 7572 6e20 7479 7065 2873     return type(s
-00025230: 656c 6629 2867 7261 7068 2c20 6e61 6d65  elf)(graph, name
-00025240: 2c20 6d65 7461 2c20 7365 6c66 2e64 6976  , meta, self.div
-00025250: 6973 696f 6e73 290a 0a20 2020 2040 6465  isions)..    @de
-00025260: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
-00025270: 7269 6573 290a 2020 2020 6465 6620 6472  ries).    def dr
-00025280: 6f70 6e61 2873 656c 6629 3a0a 2020 2020  opna(self):.    
-00025290: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-000252a0: 6d61 705f 7061 7274 6974 696f 6e73 284d  map_partitions(M
-000252b0: 2e64 726f 706e 612c 2065 6e66 6f72 6365  .dropna, enforce
-000252c0: 5f6d 6574 6164 6174 613d 4661 6c73 6529  _metadata=False)
-000252d0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-000252e0: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-000252f0: 2020 2064 6566 2062 6574 7765 656e 2873     def between(s
-00025300: 656c 662c 206c 6566 742c 2072 6967 6874  elf, left, right
-00025310: 2c20 696e 636c 7573 6976 653d 2262 6f74  , inclusive="bot
-00025320: 6822 293a 0a20 2020 2020 2020 2072 6574  h"):.        ret
-00025330: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
-00025340: 7469 7469 6f6e 7328 0a20 2020 2020 2020  titions(.       
-00025350: 2020 2020 204d 2e62 6574 7765 656e 2c20       M.between, 
-00025360: 6c65 6674 3d6c 6566 742c 2072 6967 6874  left=left, right
-00025370: 3d72 6967 6874 2c20 696e 636c 7573 6976  =right, inclusiv
-00025380: 653d 696e 636c 7573 6976 650a 2020 2020  e=inclusive.    
-00025390: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
-000253a0: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
-000253b0: 6573 290a 2020 2020 6465 6620 636c 6970  es).    def clip
-000253c0: 2873 656c 662c 206c 6f77 6572 3d4e 6f6e  (self, lower=Non
-000253d0: 652c 2075 7070 6572 3d4e 6f6e 652c 206f  e, upper=None, o
-000253e0: 7574 3d4e 6f6e 6529 3a0a 2020 2020 2020  ut=None):.      
-000253f0: 2020 6966 206f 7574 2069 7320 6e6f 7420    if out is not 
-00025400: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00025410: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00025420: 6f72 2822 276f 7574 2720 6d75 7374 2062  or("'out' must b
-00025430: 6520 4e6f 6e65 2229 0a20 2020 2020 2020  e None").       
-00025440: 2023 206e 702e 636c 6970 206d 6179 2070   # np.clip may p
-00025450: 6173 7320 6f75 740a 2020 2020 2020 2020  ass out.        
-00025460: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
-00025470: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
-00025480: 2020 2020 2020 2020 4d2e 636c 6970 2c20          M.clip, 
-00025490: 6c6f 7765 723d 6c6f 7765 722c 2075 7070  lower=lower, upp
-000254a0: 6572 3d75 7070 6572 2c20 656e 666f 7263  er=upper, enforc
-000254b0: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
-000254c0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000254d0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-000254e0: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
-000254f0: 2061 6c69 676e 2873 656c 662c 206f 7468   align(self, oth
-00025500: 6572 2c20 6a6f 696e 3d22 6f75 7465 7222  er, join="outer"
-00025510: 2c20 6178 6973 3d4e 6f6e 652c 2066 696c  , axis=None, fil
-00025520: 6c5f 7661 6c75 653d 4e6f 6e65 293a 0a20  l_value=None):. 
-00025530: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
-00025540: 7065 7228 292e 616c 6967 6e28 6f74 6865  per().align(othe
-00025550: 722c 206a 6f69 6e3d 6a6f 696e 2c20 6178  r, join=join, ax
-00025560: 6973 3d61 7869 732c 2066 696c 6c5f 7661  is=axis, fill_va
-00025570: 6c75 653d 6669 6c6c 5f76 616c 7565 290a  lue=fill_value).
-00025580: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00025590: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
-000255a0: 2020 6465 6620 636f 6d62 696e 6528 7365    def combine(se
-000255b0: 6c66 2c20 6f74 6865 722c 2066 756e 632c  lf, other, func,
-000255c0: 2066 696c 6c5f 7661 6c75 653d 4e6f 6e65   fill_value=None
-000255d0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-000255e0: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
-000255f0: 7469 6f6e 7328 4d2e 636f 6d62 696e 652c  tions(M.combine,
-00025600: 206f 7468 6572 2c20 6675 6e63 2c20 6669   other, func, fi
-00025610: 6c6c 5f76 616c 7565 3d66 696c 6c5f 7661  ll_value=fill_va
-00025620: 6c75 6529 0a0a 2020 2020 4064 6572 6976  lue)..    @deriv
-00025630: 6564 5f66 726f 6d28 7064 2e53 6572 6965  ed_from(pd.Serie
-00025640: 7329 0a20 2020 2064 6566 2073 7175 6565  s).    def squee
-00025650: 7a65 2873 656c 6629 3a0a 2020 2020 2020  ze(self):.      
-00025660: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
-00025670: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00025680: 2870 642e 5365 7269 6573 290a 2020 2020  (pd.Series).    
-00025690: 6465 6620 636f 6d62 696e 655f 6669 7273  def combine_firs
-000256a0: 7428 7365 6c66 2c20 6f74 6865 7229 3a0a  t(self, other):.
-000256b0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000256c0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-000256d0: 6e73 284d 2e63 6f6d 6269 6e65 5f66 6972  ns(M.combine_fir
-000256e0: 7374 2c20 6f74 6865 7229 0a0a 2020 2020  st, other)..    
-000256f0: 6465 6620 746f 5f62 6167 2873 656c 662c  def to_bag(self,
-00025700: 2069 6e64 6578 3d46 616c 7365 2c20 666f   index=False, fo
-00025710: 726d 6174 3d22 7475 706c 6522 293a 0a20  rmat="tuple"):. 
-00025720: 2020 2020 2020 2022 2222 4372 6561 7465         """Create
-00025730: 2061 2044 6173 6b20 4261 6720 6672 6f6d   a Dask Bag from
-00025740: 2061 2053 6572 6965 7322 2222 0a20 2020   a Series""".   
-00025750: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
-00025760: 6174 6166 7261 6d65 2e69 6f20 696d 706f  ataframe.io impo
-00025770: 7274 2074 6f5f 6261 670a 0a20 2020 2020  rt to_bag..     
-00025780: 2020 2072 6574 7572 6e20 746f 5f62 6167     return to_bag
-00025790: 2873 656c 662c 2069 6e64 6578 2c20 666f  (self, index, fo
-000257a0: 726d 6174 3d66 6f72 6d61 7429 0a0a 2020  rmat=format)..  
-000257b0: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-000257c0: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
-000257d0: 6566 2074 6f5f 6672 616d 6528 7365 6c66  ef to_frame(self
-000257e0: 2c20 6e61 6d65 3d4e 6f6e 6529 3a0a 2020  , name=None):.  
-000257f0: 2020 2020 2020 6172 6773 203d 205b 5d20        args = [] 
-00025800: 6966 206e 616d 6520 6973 204e 6f6e 6520  if name is None 
-00025810: 656c 7365 205b 6e61 6d65 5d0a 2020 2020  else [name].    
-00025820: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00025830: 6d61 705f 7061 7274 6974 696f 6e73 284d  map_partitions(M
-00025840: 2e74 6f5f 6672 616d 652c 202a 6172 6773  .to_frame, *args
-00025850: 2c20 6d65 7461 3d73 656c 662e 5f6d 6574  , meta=self._met
-00025860: 612e 746f 5f66 7261 6d65 282a 6172 6773  a.to_frame(*args
-00025870: 2929 0a0a 2020 2020 4064 6572 6976 6564  ))..    @derived
-00025880: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
-00025890: 0a20 2020 2064 6566 2074 6f5f 7374 7269  .    def to_stri
-000258a0: 6e67 2873 656c 662c 206d 6178 5f72 6f77  ng(self, max_row
-000258b0: 733d 3529 3a0a 2020 2020 2020 2020 2320  s=5):.        # 
-000258c0: 6f70 7469 6f6e 5f63 6f6e 7465 7874 2064  option_context d
-000258d0: 6f65 736e 2774 2061 6666 6563 740a 2020  oesn't affect.  
-000258e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000258f0: 662e 5f72 6570 725f 6461 7461 2829 2e74  f._repr_data().t
-00025900: 6f5f 7374 7269 6e67 286d 6178 5f72 6f77  o_string(max_row
-00025910: 733d 6d61 785f 726f 7773 290a 0a20 2020  s=max_rows)..   
-00025920: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
-00025930: 2020 6465 6620 5f62 696e 645f 6f70 6572    def _bind_oper
-00025940: 6174 6f72 5f6d 6574 686f 6428 636c 732c  ator_method(cls,
-00025950: 206e 616d 652c 206f 702c 206f 7269 6769   name, op, origi
-00025960: 6e61 6c3d 7064 2e53 6572 6965 7329 3a0a  nal=pd.Series):.
-00025970: 2020 2020 2020 2020 2222 2262 696e 6420          """bind 
-00025980: 6f70 6572 6174 6f72 206d 6574 686f 6420  operator method 
-00025990: 6c69 6b65 2053 6572 6965 732e 6164 6420  like Series.add 
-000259a0: 746f 2074 6869 7320 636c 6173 7322 2222  to this class"""
-000259b0: 0a0a 2020 2020 2020 2020 6465 6620 6d65  ..        def me
-000259c0: 7468 2873 656c 662c 206f 7468 6572 2c20  th(self, other, 
-000259d0: 6c65 7665 6c3d 4e6f 6e65 2c20 6669 6c6c  level=None, fill
-000259e0: 5f76 616c 7565 3d4e 6f6e 652c 2061 7869  _value=None, axi
-000259f0: 733d 3029 3a0a 2020 2020 2020 2020 2020  s=0):.          
-00025a00: 2020 6966 206c 6576 656c 2069 7320 6e6f    if level is no
-00025a10: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00025a20: 2020 2020 2020 2020 7261 6973 6520 4e6f          raise No
-00025a30: 7449 6d70 6c65 6d65 6e74 6564 4572 726f  tImplementedErro
-00025a40: 7228 226c 6576 656c 206d 7573 7420 6265  r("level must be
-00025a50: 204e 6f6e 6522 290a 2020 2020 2020 2020   None").        
-00025a60: 2020 2020 6178 6973 203d 2073 656c 662e      axis = self.
-00025a70: 5f76 616c 6964 6174 655f 6178 6973 2861  _validate_axis(a
-00025a80: 7869 7329 0a20 2020 2020 2020 2020 2020  xis).           
-00025a90: 206d 6574 6120 3d20 5f65 6d75 6c61 7465   meta = _emulate
-00025aa0: 286f 702c 2073 656c 662c 206f 7468 6572  (op, self, other
-00025ab0: 2c20 6178 6973 3d61 7869 732c 2066 696c  , axis=axis, fil
-00025ac0: 6c5f 7661 6c75 653d 6669 6c6c 5f76 616c  l_value=fill_val
-00025ad0: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
-00025ae0: 7265 7475 726e 206d 6170 5f70 6172 7469  return map_parti
-00025af0: 7469 6f6e 7328 0a20 2020 2020 2020 2020  tions(.         
-00025b00: 2020 2020 2020 206f 702c 2073 656c 662c         op, self,
-00025b10: 206f 7468 6572 2c20 6d65 7461 3d6d 6574   other, meta=met
-00025b20: 612c 2061 7869 733d 6178 6973 2c20 6669  a, axis=axis, fi
-00025b30: 6c6c 5f76 616c 7565 3d66 696c 6c5f 7661  ll_value=fill_va
-00025b40: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
-00025b50: 290a 0a20 2020 2020 2020 206d 6574 682e  )..        meth.
-00025b60: 5f5f 6e61 6d65 5f5f 203d 206e 616d 650a  __name__ = name.
-00025b70: 2020 2020 2020 2020 7365 7461 7474 7228          setattr(
-00025b80: 636c 732c 206e 616d 652c 2064 6572 6976  cls, name, deriv
-00025b90: 6564 5f66 726f 6d28 6f72 6967 696e 616c  ed_from(original
-00025ba0: 2928 6d65 7468 2929 0a0a 2020 2020 4063  )(meth))..    @c
-00025bb0: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
-00025bc0: 6566 205f 6269 6e64 5f63 6f6d 7061 7269  ef _bind_compari
-00025bd0: 736f 6e5f 6d65 7468 6f64 2863 6c73 2c20  son_method(cls, 
-00025be0: 6e61 6d65 2c20 636f 6d70 6172 6973 6f6e  name, comparison
-00025bf0: 2c20 6f72 6967 696e 616c 3d70 642e 5365  , original=pd.Se
-00025c00: 7269 6573 293a 0a20 2020 2020 2020 2022  ries):.        "
-00025c10: 2222 6269 6e64 2063 6f6d 7061 7269 736f  ""bind compariso
-00025c20: 6e20 6d65 7468 6f64 206c 696b 6520 5365  n method like Se
-00025c30: 7269 6573 2e65 7120 746f 2074 6869 7320  ries.eq to this 
-00025c40: 636c 6173 7322 2222 0a0a 2020 2020 2020  class"""..      
-00025c50: 2020 6465 6620 6d65 7468 2873 656c 662c    def meth(self,
-00025c60: 206f 7468 6572 2c20 6c65 7665 6c3d 4e6f   other, level=No
-00025c70: 6e65 2c20 6669 6c6c 5f76 616c 7565 3d4e  ne, fill_value=N
-00025c80: 6f6e 652c 2061 7869 733d 3029 3a0a 2020  one, axis=0):.  
-00025c90: 2020 2020 2020 2020 2020 6966 206c 6576            if lev
-00025ca0: 656c 2069 7320 6e6f 7420 4e6f 6e65 3a0a  el is not None:.
-00025cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025cc0: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-00025cd0: 6e74 6564 4572 726f 7228 226c 6576 656c  ntedError("level
-00025ce0: 206d 7573 7420 6265 204e 6f6e 6522 290a   must be None").
-00025cf0: 2020 2020 2020 2020 2020 2020 6178 6973              axis
-00025d00: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
-00025d10: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
-00025d20: 2020 2020 2020 2020 2069 6620 6669 6c6c           if fill
-00025d30: 5f76 616c 7565 2069 7320 4e6f 6e65 3a0a  _value is None:.
-00025d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025d50: 7265 7475 726e 2065 6c65 6d77 6973 6528  return elemwise(
-00025d60: 636f 6d70 6172 6973 6f6e 2c20 7365 6c66  comparison, self
-00025d70: 2c20 6f74 6865 722c 2061 7869 733d 6178  , other, axis=ax
-00025d80: 6973 290a 2020 2020 2020 2020 2020 2020  is).            
-00025d90: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00025da0: 2020 2020 2020 6f70 203d 2070 6172 7469        op = parti
-00025db0: 616c 2863 6f6d 7061 7269 736f 6e2c 2066  al(comparison, f
-00025dc0: 696c 6c5f 7661 6c75 653d 6669 6c6c 5f76  ill_value=fill_v
-00025dd0: 616c 7565 290a 2020 2020 2020 2020 2020  alue).          
-00025de0: 2020 2020 2020 7265 7475 726e 2065 6c65        return ele
-00025df0: 6d77 6973 6528 6f70 2c20 7365 6c66 2c20  mwise(op, self, 
-00025e00: 6f74 6865 722c 2061 7869 733d 6178 6973  other, axis=axis
-00025e10: 290a 0a20 2020 2020 2020 206d 6574 682e  )..        meth.
-00025e20: 5f5f 6e61 6d65 5f5f 203d 206e 616d 650a  __name__ = name.
-00025e30: 2020 2020 2020 2020 7365 7461 7474 7228          setattr(
-00025e40: 636c 732c 206e 616d 652c 2064 6572 6976  cls, name, deriv
-00025e50: 6564 5f66 726f 6d28 6f72 6967 696e 616c  ed_from(original
-00025e60: 2928 6d65 7468 2929 0a0a 2020 2020 4069  )(meth))..    @i
-00025e70: 6e73 6572 745f 6d65 7461 5f70 6172 616d  nsert_meta_param
-00025e80: 5f64 6573 6372 6970 7469 6f6e 2870 6164  _description(pad
-00025e90: 3d31 3229 0a20 2020 2064 6566 2061 7070  =12).    def app
-00025ea0: 6c79 2873 656c 662c 2066 756e 632c 2063  ly(self, func, c
-00025eb0: 6f6e 7665 7274 5f64 7479 7065 3d6e 6f5f  onvert_dtype=no_
-00025ec0: 6465 6661 756c 742c 206d 6574 613d 6e6f  default, meta=no
-00025ed0: 5f64 6566 6175 6c74 2c20 6172 6773 3d28  _default, args=(
-00025ee0: 292c 202a 2a6b 7764 7329 3a0a 2020 2020  ), **kwds):.    
-00025ef0: 2020 2020 2222 2250 6172 616c 6c65 6c20      """Parallel 
-00025f00: 7665 7273 696f 6e20 6f66 2070 616e 6461  version of panda
-00025f10: 732e 5365 7269 6573 2e61 7070 6c79 0a0a  s.Series.apply..
-00025f20: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00025f30: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00025f40: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6675  -----.        fu
-00025f50: 6e63 203a 2066 756e 6374 696f 6e0a 2020  nc : function.  
-00025f60: 2020 2020 2020 2020 2020 4675 6e63 7469            Functi
-00025f70: 6f6e 2074 6f20 6170 706c 790a 2020 2020  on to apply.    
-00025f80: 2020 2020 636f 6e76 6572 745f 6474 7970      convert_dtyp
-00025f90: 6520 3a20 626f 6f6c 6561 6e2c 2064 6566  e : boolean, def
-00025fa0: 6175 6c74 2054 7275 650a 2020 2020 2020  ault True.      
-00025fb0: 2020 2020 2020 5472 7920 746f 2066 696e        Try to fin
-00025fc0: 6420 6265 7474 6572 2064 7479 7065 2066  d better dtype f
-00025fd0: 6f72 2065 6c65 6d65 6e74 7769 7365 2066  or elementwise f
-00025fe0: 756e 6374 696f 6e20 7265 7375 6c74 732e  unction results.
-00025ff0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00026000: 4661 6c73 652c 206c 6561 7665 2061 7320  False, leave as 
-00026010: 6474 7970 653d 6f62 6a65 6374 2e0a 2020  dtype=object..  
-00026020: 2020 2020 2020 244d 4554 410a 2020 2020        $META.    
-00026030: 2020 2020 6172 6773 203a 2074 7570 6c65      args : tuple
-00026040: 0a20 2020 2020 2020 2020 2020 2050 6f73  .            Pos
-00026050: 6974 696f 6e61 6c20 6172 6775 6d65 6e74  itional argument
-00026060: 7320 746f 2070 6173 7320 746f 2066 756e  s to pass to fun
-00026070: 6374 696f 6e20 696e 2061 6464 6974 696f  ction in additio
-00026080: 6e20 746f 2074 6865 2076 616c 7565 2e0a  n to the value..
-00026090: 0a20 2020 2020 2020 2041 6464 6974 696f  .        Additio
-000260a0: 6e61 6c20 6b65 7977 6f72 6420 6172 6775  nal keyword argu
-000260b0: 6d65 6e74 7320 7769 6c6c 2062 6520 7061  ments will be pa
-000260c0: 7373 6564 2061 7320 6b65 7977 6f72 6473  ssed as keywords
-000260d0: 2074 6f20 7468 6520 6675 6e63 7469 6f6e   to the function
-000260e0: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-000260f0: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
-00026100: 2d2d 0a20 2020 2020 2020 2061 7070 6c69  --.        appli
-00026110: 6564 203a 2053 6572 6965 7320 6f72 2044  ed : Series or D
-00026120: 6174 6146 7261 6d65 2069 6620 6675 6e63  ataFrame if func
-00026130: 2072 6574 7572 6e73 2061 2053 6572 6965   returns a Serie
-00026140: 732e 0a0a 2020 2020 2020 2020 4578 616d  s...        Exam
-00026150: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
-00026160: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
-00026170: 3e20 696d 706f 7274 2064 6173 6b2e 6461  > import dask.da
-00026180: 7461 6672 616d 6520 6173 2064 640a 2020  taframe as dd.  
-00026190: 2020 2020 2020 3e3e 3e20 7320 3d20 7064        >>> s = pd
-000261a0: 2e53 6572 6965 7328 7261 6e67 6528 3529  .Series(range(5)
-000261b0: 2c20 6e61 6d65 3d27 7827 290a 2020 2020  , name='x').    
-000261c0: 2020 2020 3e3e 3e20 6473 203d 2064 642e      >>> ds = dd.
-000261d0: 6672 6f6d 5f70 616e 6461 7328 732c 206e  from_pandas(s, n
-000261e0: 7061 7274 6974 696f 6e73 3d32 290a 0a20  partitions=2).. 
-000261f0: 2020 2020 2020 2041 7070 6c79 2061 2066         Apply a f
-00026200: 756e 6374 696f 6e20 656c 656d 656e 7477  unction elementw
-00026210: 6973 6520 6163 726f 7373 2074 6865 2053  ise across the S
-00026220: 6572 6965 732c 2070 6173 7369 6e67 2069  eries, passing i
-00026230: 6e20 6578 7472 610a 2020 2020 2020 2020  n extra.        
-00026240: 6172 6775 6d65 6e74 7320 696e 2060 6061  arguments in ``a
-00026250: 7267 7360 6020 616e 6420 6060 6b77 6172  rgs`` and ``kwar
-00026260: 6773 6060 3a0a 0a20 2020 2020 2020 203e  gs``:..        >
-00026270: 3e3e 2064 6566 206d 7961 6464 2878 2c20  >> def myadd(x, 
-00026280: 612c 2062 3d31 293a 0a20 2020 2020 2020  a, b=1):.       
-00026290: 202e 2e2e 2020 2020 2072 6574 7572 6e20   ...     return 
-000262a0: 7820 2b20 6120 2b20 620a 2020 2020 2020  x + a + b.      
-000262b0: 2020 3e3e 3e20 7265 7320 3d20 6473 2e61    >>> res = ds.a
-000262c0: 7070 6c79 286d 7961 6464 2c20 6172 6773  pply(myadd, args
-000262d0: 3d28 322c 292c 2062 3d31 2e35 2920 2023  =(2,), b=1.5)  #
-000262e0: 2064 6f63 7465 7374 3a20 2b53 4b49 500a   doctest: +SKIP.
-000262f0: 0a20 2020 2020 2020 2042 7920 6465 6661  .        By defa
-00026300: 756c 742c 2064 6173 6b20 7472 6965 7320  ult, dask tries 
-00026310: 746f 2069 6e66 6572 2074 6865 206f 7574  to infer the out
-00026320: 7075 7420 6d65 7461 6461 7461 2062 7920  put metadata by 
-00026330: 7275 6e6e 696e 6720 796f 7572 0a20 2020  running your.   
-00026340: 2020 2020 2070 726f 7669 6465 6420 6675       provided fu
-00026350: 6e63 7469 6f6e 206f 6e20 736f 6d65 2066  nction on some f
-00026360: 616b 6520 6461 7461 2e20 5468 6973 2077  ake data. This w
-00026370: 6f72 6b73 2077 656c 6c20 696e 206d 616e  orks well in man
-00026380: 7920 6361 7365 732c 2062 7574 0a20 2020  y cases, but.   
-00026390: 2020 2020 2063 616e 2073 6f6d 6574 696d       can sometim
-000263a0: 6573 2062 6520 6578 7065 6e73 6976 652c  es be expensive,
-000263b0: 206f 7220 6576 656e 2066 6169 6c2e 2054   or even fail. T
-000263c0: 6f20 6176 6f69 6420 7468 6973 2c20 796f  o avoid this, yo
-000263d0: 7520 6361 6e0a 2020 2020 2020 2020 6d61  u can.        ma
-000263e0: 6e75 616c 6c79 2073 7065 6369 6679 2074  nually specify t
-000263f0: 6865 206f 7574 7075 7420 6d65 7461 6461  he output metada
-00026400: 7461 2077 6974 6820 7468 6520 6060 6d65  ta with the ``me
-00026410: 7461 6060 206b 6579 776f 7264 2e20 5468  ta`` keyword. Th
-00026420: 6973 0a20 2020 2020 2020 2063 616e 2062  is.        can b
-00026430: 6520 7370 6563 6966 6965 6420 696e 206d  e specified in m
-00026440: 616e 7920 666f 726d 732c 2066 6f72 206d  any forms, for m
-00026450: 6f72 6520 696e 666f 726d 6174 696f 6e20  ore information 
-00026460: 7365 650a 2020 2020 2020 2020 6060 6461  see.        ``da
-00026470: 736b 2e64 6174 6166 7261 6d65 2e75 7469  sk.dataframe.uti
-00026480: 6c73 2e6d 616b 655f 6d65 7461 6060 2e0a  ls.make_meta``..
-00026490: 0a20 2020 2020 2020 2048 6572 6520 7765  .        Here we
-000264a0: 2073 7065 6369 6679 2074 6865 206f 7574   specify the out
-000264b0: 7075 7420 6973 2061 2053 6572 6965 7320  put is a Series 
-000264c0: 7769 7468 206e 616d 6520 6060 2778 2760  with name ``'x'`
-000264d0: 602c 2061 6e64 2064 7479 7065 0a20 2020  `, and dtype.   
-000264e0: 2020 2020 2060 6066 6c6f 6174 3634 6060       ``float64``
-000264f0: 3a0a 0a20 2020 2020 2020 203e 3e3e 2072  :..        >>> r
-00026500: 6573 203d 2064 732e 6170 706c 7928 6d79  es = ds.apply(my
-00026510: 6164 642c 2061 7267 733d 2832 2c29 2c20  add, args=(2,), 
-00026520: 623d 312e 352c 206d 6574 613d 2827 7827  b=1.5, meta=('x'
-00026530: 2c20 2766 3827 2929 0a0a 2020 2020 2020  , 'f8'))..      
-00026540: 2020 496e 2074 6865 2063 6173 6520 7768    In the case wh
-00026550: 6572 6520 7468 6520 6d65 7461 6461 7461  ere the metadata
-00026560: 2064 6f65 736e 2774 2063 6861 6e67 652c   doesn't change,
-00026570: 2079 6f75 2063 616e 2061 6c73 6f20 7061   you can also pa
-00026580: 7373 2069 6e0a 2020 2020 2020 2020 7468  ss in.        th
-00026590: 6520 6f62 6a65 6374 2069 7473 656c 6620  e object itself 
-000265a0: 6469 7265 6374 6c79 3a0a 0a20 2020 2020  directly:..     
-000265b0: 2020 203e 3e3e 2072 6573 203d 2064 732e     >>> res = ds.
-000265c0: 6170 706c 7928 6c61 6d62 6461 2078 3a20  apply(lambda x: 
-000265d0: 7820 2b20 312c 206d 6574 613d 6473 290a  x + 1, meta=ds).
-000265e0: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
-000265f0: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
-00026600: 2d2d 0a20 2020 2020 2020 2064 6173 6b2e  --.        dask.
-00026610: 5365 7269 6573 2e6d 6170 5f70 6172 7469  Series.map_parti
-00026620: 7469 6f6e 730a 2020 2020 2020 2020 2222  tions.        ""
-00026630: 220a 2020 2020 2020 2020 6966 2063 6f6e  ".        if con
-00026640: 7665 7274 5f64 7479 7065 2069 7320 6e6f  vert_dtype is no
-00026650: 7420 6e6f 5f64 6566 6175 6c74 3a0a 2020  t no_default:.  
-00026660: 2020 2020 2020 2020 2020 6b77 6473 5b22            kwds["
-00026670: 636f 6e76 6572 745f 6474 7970 6522 5d20  convert_dtype"] 
-00026680: 3d20 636f 6e76 6572 745f 6474 7970 650a  = convert_dtype.
-00026690: 0a20 2020 2020 2020 2023 206c 6574 2070  .        # let p
-000266a0: 616e 6461 7320 7472 6967 6765 7220 616e  andas trigger an
-000266b0: 7920 7761 726e 696e 6773 2c20 7375 6368  y warnings, such
-000266c0: 2061 7320 636f 6e76 6572 745f 6474 7970   as convert_dtyp
-000266d0: 6520 7761 726e 696e 670a 2020 2020 2020  e warning.      
-000266e0: 2020 7365 6c66 2e5f 6d65 7461 2e61 7070    self._meta.app
-000266f0: 6c79 2866 756e 632c 2061 7267 733d 6172  ly(func, args=ar
-00026700: 6773 2c20 2a2a 6b77 6473 290a 0a20 2020  gs, **kwds)..   
-00026710: 2020 2020 2069 6620 6d65 7461 2069 7320       if meta is 
-00026720: 6e6f 5f64 6566 6175 6c74 3a0a 2020 2020  no_default:.    
-00026730: 2020 2020 2020 2020 7769 7468 2063 6865          with che
-00026740: 636b 5f63 6f6e 7665 7274 5f64 7479 7065  ck_convert_dtype
-00026750: 5f64 6570 7265 6361 7469 6f6e 2829 3a0a  _deprecation():.
-00026760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026770: 6d65 7461 203d 205f 656d 756c 6174 6528  meta = _emulate(
-00026780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026790: 2020 2020 204d 2e61 7070 6c79 2c20 7365       M.apply, se
-000267a0: 6c66 2e5f 6d65 7461 5f6e 6f6e 656d 7074  lf._meta_nonempt
-000267b0: 792c 2066 756e 632c 2061 7267 733d 6172  y, func, args=ar
-000267c0: 6773 2c20 7564 663d 5472 7565 2c20 2a2a  gs, udf=True, **
-000267d0: 6b77 6473 0a20 2020 2020 2020 2020 2020  kwds.           
-000267e0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-000267f0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-00026800: 286d 6574 615f 7761 726e 696e 6728 6d65  (meta_warning(me
-00026810: 7461 2929 0a20 2020 2020 2020 2065 6c69  ta)).        eli
-00026820: 6620 5041 4e44 4153 5f47 545f 3231 303a  f PANDAS_GT_210:
-00026830: 0a20 2020 2020 2020 2020 2020 2074 6573  .            tes
-00026840: 745f 6d65 7461 203d 206d 616b 655f 6d65  t_meta = make_me
-00026850: 7461 286d 6574 6129 0a20 2020 2020 2020  ta(meta).       
-00026860: 2020 2020 2069 6620 6973 5f64 6174 6166       if is_dataf
-00026870: 7261 6d65 5f6c 696b 6528 7465 7374 5f6d  rame_like(test_m
-00026880: 6574 6129 3a0a 2020 2020 2020 2020 2020  eta):.          
-00026890: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-000268a0: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
-000268b0: 2020 2020 2020 2020 2022 5265 7475 726e           "Return
-000268c0: 696e 6720 6120 4461 7461 4672 616d 6520  ing a DataFrame 
-000268d0: 6672 6f6d 2053 6572 6965 732e 6170 706c  from Series.appl
-000268e0: 7920 7768 656e 2074 6865 2073 7570 706c  y when the suppl
-000268f0: 6965 6420 6675 6e63 7469 6f6e 2022 0a20  ied function ". 
-00026900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026910: 2020 2022 7265 7475 726e 7320 6120 5365     "returns a Se
-00026920: 7269 6573 2069 7320 6465 7072 6563 6174  ries is deprecat
-00026930: 6564 2061 6e64 2077 696c 6c20 6265 2072  ed and will be r
-00026940: 656d 6f76 6564 2069 6e20 6120 6675 7475  emoved in a futu
-00026950: 7265 2076 6572 7369 6f6e 2e22 2c0a 2020  re version.",.  
-00026960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026970: 2020 4675 7475 7265 5761 726e 696e 672c    FutureWarning,
-00026980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026990: 2020 2020 2073 7461 636b 6c65 7665 6c3d       stacklevel=
-000269a0: 322c 0a20 2020 2020 2020 2020 2020 2020  2,.             
-000269b0: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
-000269c0: 7475 726e 206d 6170 5f70 6172 7469 7469  turn map_partiti
-000269d0: 6f6e 7328 6d65 7468 6f64 732e 6170 706c  ons(methods.appl
-000269e0: 792c 2073 656c 662c 2066 756e 632c 2061  y, self, func, a
-000269f0: 7267 733d 6172 6773 2c20 6d65 7461 3d6d  rgs=args, meta=m
-00026a00: 6574 612c 202a 2a6b 7764 7329 0a0a 2020  eta, **kwds)..  
-00026a10: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00026a20: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
-00026a30: 6566 2063 6f76 2873 656c 662c 206f 7468  ef cov(self, oth
-00026a40: 6572 2c20 6d69 6e5f 7065 7269 6f64 733d  er, min_periods=
-00026a50: 4e6f 6e65 2c20 7370 6c69 745f 6576 6572  None, split_ever
-00026a60: 793d 4661 6c73 6529 3a0a 2020 2020 2020  y=False):.      
-00026a70: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
-00026a80: 6672 616d 652e 6d75 6c74 6920 696d 706f  frame.multi impo
-00026a90: 7274 2063 6f6e 6361 740a 0a20 2020 2020  rt concat..     
-00026aa0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-00026ab0: 616e 6365 286f 7468 6572 2c20 5365 7269  ance(other, Seri
-00026ac0: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
-00026ad0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-00026ae0: 2822 6f74 6865 7220 6d75 7374 2062 6520  ("other must be 
-00026af0: 6120 6461 736b 2e64 6174 6166 7261 6d65  a dask.dataframe
-00026b00: 2e53 6572 6965 7322 290a 2020 2020 2020  .Series").      
-00026b10: 2020 6466 203d 2063 6f6e 6361 7428 5b73    df = concat([s
-00026b20: 656c 662c 206f 7468 6572 5d2c 2061 7869  elf, other], axi
-00026b30: 733d 3129 0a20 2020 2020 2020 2072 6574  s=1).        ret
-00026b40: 7572 6e20 5f63 6f76 5f63 6f72 7228 0a20  urn _cov_corr(. 
-00026b50: 2020 2020 2020 2020 2020 2064 662c 206d             df, m
-00026b60: 696e 5f70 6572 696f 6473 2c20 7363 616c  in_periods, scal
-00026b70: 6172 3d54 7275 652c 206e 756d 6572 6963  ar=True, numeric
-00026b80: 5f6f 6e6c 793d 4661 6c73 652c 2073 706c  _only=False, spl
-00026b90: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
-00026ba0: 7665 7279 0a20 2020 2020 2020 2029 0a0a  very.        )..
-00026bb0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00026bc0: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
-00026bd0: 2064 6566 2063 6f72 7228 7365 6c66 2c20   def corr(self, 
-00026be0: 6f74 6865 722c 206d 6574 686f 643d 2270  other, method="p
-00026bf0: 6561 7273 6f6e 222c 206d 696e 5f70 6572  earson", min_per
-00026c00: 696f 6473 3d4e 6f6e 652c 2073 706c 6974  iods=None, split
-00026c10: 5f65 7665 7279 3d46 616c 7365 293a 0a20  _every=False):. 
-00026c20: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-00026c30: 2e64 6174 6166 7261 6d65 2e6d 756c 7469  .dataframe.multi
-00026c40: 2069 6d70 6f72 7420 636f 6e63 6174 0a0a   import concat..
-00026c50: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-00026c60: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
-00026c70: 2053 6572 6965 7329 3a0a 2020 2020 2020   Series):.      
-00026c80: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00026c90: 4572 726f 7228 226f 7468 6572 206d 7573  Error("other mus
-00026ca0: 7420 6265 2061 2064 6173 6b2e 6461 7461  t be a dask.data
-00026cb0: 6672 616d 652e 5365 7269 6573 2229 0a20  frame.Series"). 
-00026cc0: 2020 2020 2020 2069 6620 6d65 7468 6f64         if method
-00026cd0: 2021 3d20 2270 6561 7273 6f6e 223a 0a20   != "pearson":. 
-00026ce0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00026cf0: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
-00026d00: 7272 6f72 2822 4f6e 6c79 2050 6561 7273  rror("Only Pears
-00026d10: 6f6e 2063 6f72 7265 6c61 7469 6f6e 2068  on correlation h
-00026d20: 6173 2062 6565 6e20 696d 706c 656d 656e  as been implemen
-00026d30: 7465 6422 290a 2020 2020 2020 2020 6466  ted").        df
-00026d40: 203d 2063 6f6e 6361 7428 5b73 656c 662c   = concat([self,
-00026d50: 206f 7468 6572 5d2c 2061 7869 733d 3129   other], axis=1)
-00026d60: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00026d70: 5f63 6f76 5f63 6f72 7228 0a20 2020 2020  _cov_corr(.     
-00026d80: 2020 2020 2020 2064 662c 0a20 2020 2020         df,.     
-00026d90: 2020 2020 2020 206d 696e 5f70 6572 696f         min_perio
-00026da0: 6473 2c0a 2020 2020 2020 2020 2020 2020  ds,.            
-00026db0: 636f 7272 3d54 7275 652c 0a20 2020 2020  corr=True,.     
-00026dc0: 2020 2020 2020 2073 6361 6c61 723d 5472         scalar=Tr
-00026dd0: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-00026de0: 6e75 6d65 7269 635f 6f6e 6c79 3d46 616c  numeric_only=Fal
-00026df0: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00026e00: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
-00026e10: 745f 6576 6572 792c 0a20 2020 2020 2020  t_every,.       
-00026e20: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
-00026e30: 5f66 726f 6d28 7064 2e53 6572 6965 7329  _from(pd.Series)
-00026e40: 0a20 2020 2064 6566 2061 7574 6f63 6f72  .    def autocor
-00026e50: 7228 7365 6c66 2c20 6c61 673d 312c 2073  r(self, lag=1, s
-00026e60: 706c 6974 5f65 7665 7279 3d46 616c 7365  plit_every=False
-00026e70: 293a 0a20 2020 2020 2020 2069 6620 6e6f  ):.        if no
-00026e80: 7420 6973 696e 7374 616e 6365 286c 6167  t isinstance(lag
-00026e90: 2c20 496e 7465 6772 616c 293a 0a20 2020  , Integral):.   
-00026ea0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00026eb0: 7970 6545 7272 6f72 2822 6c61 6720 6d75  ypeError("lag mu
-00026ec0: 7374 2062 6520 616e 2069 6e74 6567 6572  st be an integer
-00026ed0: 2229 0a20 2020 2020 2020 2072 6574 7572  ").        retur
-00026ee0: 6e20 7365 6c66 2e63 6f72 7228 7365 6c66  n self.corr(self
-00026ef0: 2069 6620 6c61 6720 3d3d 2030 2065 6c73   if lag == 0 els
-00026f00: 6520 7365 6c66 2e73 6869 6674 286c 6167  e self.shift(lag
-00026f10: 292c 2073 706c 6974 5f65 7665 7279 3d73  ), split_every=s
-00026f20: 706c 6974 5f65 7665 7279 290a 0a20 2020  plit_every)..   
-00026f30: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-00026f40: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
-00026f50: 6620 6d65 6d6f 7279 5f75 7361 6765 2873  f memory_usage(s
-00026f60: 656c 662c 2069 6e64 6578 3d54 7275 652c  elf, index=True,
-00026f70: 2064 6565 703d 4661 6c73 6529 3a0a 2020   deep=False):.  
-00026f80: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00026f90: 662e 7265 6475 6374 696f 6e28 0a20 2020  f.reduction(.   
-00026fa0: 2020 2020 2020 2020 204d 2e6d 656d 6f72           M.memor
-00026fb0: 795f 7573 6167 652c 0a20 2020 2020 2020  y_usage,.       
-00026fc0: 2020 2020 204d 2e73 756d 2c0a 2020 2020       M.sum,.    
-00026fd0: 2020 2020 2020 2020 6368 756e 6b5f 6b77          chunk_kw
-00026fe0: 6172 6773 3d7b 2269 6e64 6578 223a 2069  args={"index": i
-00026ff0: 6e64 6578 2c20 2264 6565 7022 3a20 6465  ndex, "deep": de
-00027000: 6570 7d2c 0a20 2020 2020 2020 2020 2020  ep},.           
-00027010: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-00027020: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00027030: 746f 6b65 6e3d 7365 6c66 2e5f 746f 6b65  token=self._toke
-00027040: 6e5f 7072 6566 6978 202b 2022 6d65 6d6f  n_prefix + "memo
-00027050: 7279 2d75 7361 6765 222c 0a20 2020 2020  ry-usage",.     
-00027060: 2020 2029 0a0a 2020 2020 6465 6620 5f5f     )..    def __
-00027070: 6469 766d 6f64 5f5f 2873 656c 662c 206f  divmod__(self, o
-00027080: 7468 6572 293a 0a20 2020 2020 2020 2072  ther):.        r
-00027090: 6573 3120 3d20 7365 6c66 202f 2f20 6f74  es1 = self // ot
-000270a0: 6865 720a 2020 2020 2020 2020 7265 7332  her.        res2
-000270b0: 203d 2073 656c 6620 2520 6f74 6865 720a   = self % other.
-000270c0: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-000270d0: 6573 312c 2072 6573 320a 0a20 2020 2064  es1, res2..    d
-000270e0: 6566 205f 5f72 6469 766d 6f64 5f5f 2873  ef __rdivmod__(s
-000270f0: 656c 662c 206f 7468 6572 293a 0a20 2020  elf, other):.   
-00027100: 2020 2020 2072 6573 3120 3d20 6f74 6865       res1 = othe
-00027110: 7220 2f2f 2073 656c 660a 2020 2020 2020  r // self.      
-00027120: 2020 7265 7332 203d 206f 7468 6572 2025    res2 = other %
-00027130: 2073 656c 660a 2020 2020 2020 2020 7265   self.        re
-00027140: 7475 726e 2072 6573 312c 2072 6573 320a  turn res1, res2.
-00027150: 0a20 2020 2069 6620 6e6f 7420 5041 4e44  .    if not PAND
-00027160: 4153 5f47 545f 3230 303a 0a0a 2020 2020  AS_GT_200:..    
-00027170: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00027180: 2020 2020 2020 4064 6572 6976 6564 5f66        @derived_f
-00027190: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
-000271a0: 2020 2020 2020 2064 6566 2069 735f 6d6f         def is_mo
-000271b0: 6e6f 746f 6e69 6328 7365 6c66 293a 0a20  notonic(self):. 
-000271c0: 2020 2020 2020 2020 2020 2069 6620 5041             if PA
-000271d0: 4e44 4153 5f47 545f 3135 303a 0a20 2020  NDAS_GT_150:.   
-000271e0: 2020 2020 2020 2020 2020 2020 2077 6172               war
-000271f0: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
-00027200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027210: 2269 735f 6d6f 6e6f 746f 6e69 6320 6973  "is_monotonic is
-00027220: 2064 6570 7265 6361 7465 6420 616e 6420   deprecated and 
-00027230: 7769 6c6c 2062 6520 7265 6d6f 7665 6420  will be removed 
-00027240: 696e 2061 2066 7574 7572 6520 7665 7273  in a future vers
-00027250: 696f 6e2e 2022 0a20 2020 2020 2020 2020  ion. ".         
-00027260: 2020 2020 2020 2020 2020 2022 5573 6520             "Use 
-00027270: 6973 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63  is_monotonic_inc
-00027280: 7265 6173 696e 6720 696e 7374 6561 642e  reasing instead.
-00027290: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000272a0: 2020 2020 2020 2046 7574 7572 6557 6172         FutureWar
-000272b0: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
-000272c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000272d0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-000272e0: 6973 5f6d 6f6e 6f74 6f6e 6963 5f69 6e63  is_monotonic_inc
-000272f0: 7265 6173 696e 670a 0a20 2020 2040 7072  reasing..    @pr
-00027300: 6f70 6572 7479 0a20 2020 2040 6465 7269  operty.    @deri
-00027310: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
-00027320: 6573 290a 2020 2020 6465 6620 6973 5f6d  es).    def is_m
-00027330: 6f6e 6f74 6f6e 6963 5f69 6e63 7265 6173  onotonic_increas
-00027340: 696e 6728 7365 6c66 293a 0a20 2020 2020  ing(self):.     
-00027350: 2020 2072 6574 7572 6e20 6163 6128 0a20     return aca(. 
-00027360: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-00027370: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
-00027380: 6e6b 3d6d 6574 686f 6473 2e6d 6f6e 6f74  nk=methods.monot
-00027390: 6f6e 6963 5f69 6e63 7265 6173 696e 675f  onic_increasing_
-000273a0: 6368 756e 6b2c 0a20 2020 2020 2020 2020  chunk,.         
-000273b0: 2020 2063 6f6d 6269 6e65 3d6d 6574 686f     combine=metho
-000273c0: 6473 2e6d 6f6e 6f74 6f6e 6963 5f69 6e63  ds.monotonic_inc
-000273d0: 7265 6173 696e 675f 636f 6d62 696e 652c  reasing_combine,
-000273e0: 0a20 2020 2020 2020 2020 2020 2061 6767  .            agg
-000273f0: 7265 6761 7465 3d6d 6574 686f 6473 2e6d  regate=methods.m
-00027400: 6f6e 6f74 6f6e 6963 5f69 6e63 7265 6173  onotonic_increas
-00027410: 696e 675f 6167 6772 6567 6174 652c 0a20  ing_aggregate,. 
-00027420: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
-00027430: 626f 6f6c 2c0a 2020 2020 2020 2020 2020  bool,.          
-00027440: 2020 746f 6b65 6e3d 226d 6f6e 6f74 6f6e    token="monoton
-00027450: 6963 5f69 6e63 7265 6173 696e 6722 2c0a  ic_increasing",.
-00027460: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-00027470: 7072 6f70 6572 7479 0a20 2020 2040 6465  property.    @de
-00027480: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
-00027490: 7269 6573 290a 2020 2020 6465 6620 6973  ries).    def is
-000274a0: 5f6d 6f6e 6f74 6f6e 6963 5f64 6563 7265  _monotonic_decre
-000274b0: 6173 696e 6728 7365 6c66 293a 0a20 2020  asing(self):.   
-000274c0: 2020 2020 2072 6574 7572 6e20 6163 6128       return aca(
-000274d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000274e0: 662c 0a20 2020 2020 2020 2020 2020 2063  f,.            c
-000274f0: 6875 6e6b 3d6d 6574 686f 6473 2e6d 6f6e  hunk=methods.mon
-00027500: 6f74 6f6e 6963 5f64 6563 7265 6173 696e  otonic_decreasin
-00027510: 675f 6368 756e 6b2c 0a20 2020 2020 2020  g_chunk,.       
-00027520: 2020 2020 2063 6f6d 6269 6e65 3d6d 6574       combine=met
-00027530: 686f 6473 2e6d 6f6e 6f74 6f6e 6963 5f64  hods.monotonic_d
-00027540: 6563 7265 6173 696e 675f 636f 6d62 696e  ecreasing_combin
-00027550: 652c 0a20 2020 2020 2020 2020 2020 2061  e,.            a
-00027560: 6767 7265 6761 7465 3d6d 6574 686f 6473  ggregate=methods
-00027570: 2e6d 6f6e 6f74 6f6e 6963 5f64 6563 7265  .monotonic_decre
-00027580: 6173 696e 675f 6167 6772 6567 6174 652c  asing_aggregate,
-00027590: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-000275a0: 613d 626f 6f6c 2c0a 2020 2020 2020 2020  a=bool,.        
-000275b0: 2020 2020 746f 6b65 6e3d 226d 6f6e 6f74      token="monot
-000275c0: 6f6e 6963 5f64 6563 7265 6173 696e 6722  onic_decreasing"
-000275d0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-000275e0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
-000275f0: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
-00027600: 6620 7669 6577 2873 656c 662c 2064 7479  f view(self, dty
-00027610: 7065 293a 0a20 2020 2020 2020 206d 6574  pe):.        met
-00027620: 6120 3d20 7365 6c66 2e5f 6d65 7461 2e76  a = self._meta.v
-00027630: 6965 7728 6474 7970 6529 0a20 2020 2020  iew(dtype).     
-00027640: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-00027650: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
-00027660: 7669 6577 2c20 6474 7970 652c 206d 6574  view, dtype, met
-00027670: 613d 6d65 7461 290a 0a0a 636c 6173 7320  a=meta)...class 
-00027680: 496e 6465 7828 5365 7269 6573 293a 0a20  Index(Series):. 
-00027690: 2020 205f 7061 7274 6974 696f 6e5f 7479     _partition_ty
-000276a0: 7065 203d 2070 642e 496e 6465 780a 2020  pe = pd.Index.  
-000276b0: 2020 5f69 735f 7061 7274 6974 696f 6e5f    _is_partition_
-000276c0: 7479 7065 203d 2073 7461 7469 636d 6574  type = staticmet
-000276d0: 686f 6428 6973 5f69 6e64 6578 5f6c 696b  hod(is_index_lik
-000276e0: 6529 0a20 2020 205f 746f 6b65 6e5f 7072  e).    _token_pr
-000276f0: 6566 6978 203d 2022 696e 6465 782d 220a  efix = "index-".
-00027700: 2020 2020 5f61 6363 6573 736f 7273 3a20      _accessors: 
-00027710: 436c 6173 7356 6172 5b73 6574 5b73 7472  ClassVar[set[str
-00027720: 5d5d 203d 2073 6574 2829 0a0a 2020 2020  ]] = set()..    
-00027730: 5f64 745f 6174 7472 6962 7574 6573 203d  _dt_attributes =
-00027740: 207b 0a20 2020 2020 2020 2022 6e61 6e6f   {.        "nano
-00027750: 7365 636f 6e64 222c 0a20 2020 2020 2020  second",.       
-00027760: 2022 6d69 6372 6f73 6563 6f6e 6422 2c0a   "microsecond",.
-00027770: 2020 2020 2020 2020 226d 696c 6c69 7365          "millise
-00027780: 636f 6e64 222c 0a20 2020 2020 2020 2022  cond",.        "
-00027790: 6461 796f 6679 6561 7222 2c0a 2020 2020  dayofyear",.    
-000277a0: 2020 2020 226d 696e 7574 6522 2c0a 2020      "minute",.  
-000277b0: 2020 2020 2020 2268 6f75 7222 2c0a 2020        "hour",.  
-000277c0: 2020 2020 2020 2264 6179 222c 0a20 2020        "day",.   
-000277d0: 2020 2020 2022 6461 796f 6677 6565 6b22       "dayofweek"
-000277e0: 2c0a 2020 2020 2020 2020 2273 6563 6f6e  ,.        "secon
-000277f0: 6422 2c0a 2020 2020 2020 2020 2277 6565  d",.        "wee
-00027800: 6b22 2c0a 2020 2020 2020 2020 2277 6565  k",.        "wee
-00027810: 6b64 6179 222c 0a20 2020 2020 2020 2022  kday",.        "
-00027820: 7765 656b 6f66 7965 6172 222c 0a20 2020  weekofyear",.   
-00027830: 2020 2020 2022 6d6f 6e74 6822 2c0a 2020       "month",.  
-00027840: 2020 2020 2020 2271 7561 7274 6572 222c        "quarter",
-00027850: 0a20 2020 2020 2020 2022 7965 6172 222c  .        "year",
-00027860: 0a20 2020 207d 0a0a 2020 2020 5f63 6174  .    }..    _cat
-00027870: 5f61 7474 7269 6275 7465 7320 3d20 7b0a  _attributes = {.
-00027880: 2020 2020 2020 2020 226b 6e6f 776e 222c          "known",
-00027890: 0a20 2020 2020 2020 2022 6173 5f6b 6e6f  .        "as_kno
-000278a0: 776e 222c 0a20 2020 2020 2020 2022 6173  wn",.        "as
-000278b0: 5f75 6e6b 6e6f 776e 222c 0a20 2020 2020  _unknown",.     
-000278c0: 2020 2022 6164 645f 6361 7465 676f 7269     "add_categori
-000278d0: 6573 222c 0a20 2020 2020 2020 2022 6361  es",.        "ca
-000278e0: 7465 676f 7269 6573 222c 0a20 2020 2020  tegories",.     
-000278f0: 2020 2022 7265 6d6f 7665 5f63 6174 6567     "remove_categ
-00027900: 6f72 6965 7322 2c0a 2020 2020 2020 2020  ories",.        
-00027910: 2272 656f 7264 6572 5f63 6174 6567 6f72  "reorder_categor
-00027920: 6965 7322 2c0a 2020 2020 2020 2020 2261  ies",.        "a
-00027930: 735f 6f72 6465 7265 6422 2c0a 2020 2020  s_ordered",.    
-00027940: 2020 2020 2263 6f64 6573 222c 0a20 2020      "codes",.   
-00027950: 2020 2020 2022 7265 6d6f 7665 5f75 6e75       "remove_unu
-00027960: 7365 645f 6361 7465 676f 7269 6573 222c  sed_categories",
-00027970: 0a20 2020 2020 2020 2022 7365 745f 6361  .        "set_ca
-00027980: 7465 676f 7269 6573 222c 0a20 2020 2020  tegories",.     
-00027990: 2020 2022 6173 5f75 6e6f 7264 6572 6564     "as_unordered
-000279a0: 222c 0a20 2020 2020 2020 2022 6f72 6465  ",.        "orde
-000279b0: 7265 6422 2c0a 2020 2020 2020 2020 2272  red",.        "r
-000279c0: 656e 616d 655f 6361 7465 676f 7269 6573  ename_categories
-000279d0: 222c 0a20 2020 207d 0a0a 2020 2020 5f6d  ",.    }..    _m
-000279e0: 6f6e 6f74 6f6e 6963 5f61 7474 7269 6275  onotonic_attribu
-000279f0: 7465 7320 3d20 7b0a 2020 2020 2020 2020  tes = {.        
-00027a00: 2269 735f 6d6f 6e6f 746f 6e69 6322 2c0a  "is_monotonic",.
-00027a10: 2020 2020 2020 2020 2269 735f 6d6f 6e6f          "is_mono
-00027a20: 746f 6e69 635f 696e 6372 6561 7369 6e67  tonic_increasing
-00027a30: 222c 0a20 2020 2020 2020 2022 6973 5f6d  ",.        "is_m
-00027a40: 6f6e 6f74 6f6e 6963 5f64 6563 7265 6173  onotonic_decreas
-00027a50: 696e 6722 2c0a 2020 2020 7d0a 0a20 2020  ing",.    }..   
-00027a60: 2064 6566 205f 5f67 6574 6174 7472 5f5f   def __getattr__
-00027a70: 2873 656c 662c 206b 6579 293a 0a20 2020  (self, key):.   
-00027a80: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
-00027a90: 2020 2020 2020 6973 696e 7374 616e 6365        isinstance
-00027aa0: 2873 656c 662e 5f6d 6574 612e 6474 7970  (self._meta.dtyp
-00027ab0: 652c 2070 642e 4361 7465 676f 7269 6361  e, pd.Categorica
-00027ac0: 6c44 7479 7065 290a 2020 2020 2020 2020  lDtype).        
-00027ad0: 2020 2020 616e 6420 6b65 7920 696e 2073      and key in s
-00027ae0: 656c 662e 5f63 6174 5f61 7474 7269 6275  elf._cat_attribu
-00027af0: 7465 730a 2020 2020 2020 2020 293a 0a20  tes.        ):. 
-00027b00: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00027b10: 6e20 6765 7461 7474 7228 7365 6c66 2e63  n getattr(self.c
-00027b20: 6174 2c20 6b65 7929 0a20 2020 2020 2020  at, key).       
-00027b30: 2065 6c69 6620 6b65 7920 696e 2073 656c   elif key in sel
-00027b40: 662e 5f64 745f 6174 7472 6962 7574 6573  f._dt_attributes
-00027b50: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00027b60: 7475 726e 2067 6574 6174 7472 2873 656c  turn getattr(sel
-00027b70: 662e 6474 2c20 6b65 7929 0a20 2020 2020  f.dt, key).     
-00027b80: 2020 2065 6c69 6620 6b65 7920 696e 2073     elif key in s
-00027b90: 656c 662e 5f6d 6f6e 6f74 6f6e 6963 5f61  elf._monotonic_a
-00027ba0: 7474 7269 6275 7465 733a 0a20 2020 2020  ttributes:.     
+00022cf0: 2069 6620 6e6f 7420 6e65 772e 6973 5f6d   if not new.is_m
+00022d00: 6f6e 6f74 6f6e 6963 5f69 6e63 7265 6173  onotonic_increas
+00022d10: 696e 673a 0a20 2020 2020 2020 2020 2020  ing:.           
+00022d20: 2020 2020 2020 2020 2020 2020 206d 7367               msg
+00022d30: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00022d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022d50: 2022 736f 7274 6564 5f69 6e64 6578 3d54   "sorted_index=T
+00022d60: 7275 652c 2062 7574 2074 6865 2074 7261  rue, but the tra
+00022d70: 6e73 666f 726d 6564 2069 6e64 6578 2022  nsformed index "
+00022d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022d90: 2020 2020 2020 2020 2020 2020 2022 6973               "is
+00022da0: 6e27 7420 6d6f 6e6f 746f 6e69 635f 696e  n't monotonic_in
+00022db0: 6372 6561 7369 6e67 220a 2020 2020 2020  creasing".      
+00022dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022dd0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00022de0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00022df0: 6520 5661 6c75 6545 7272 6f72 286d 7367  e ValueError(msg
+00022e00: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00022e10: 2020 2020 2020 7265 732e 5f64 6976 6973        res._divis
+00022e20: 696f 6e73 203d 2074 7570 6c65 286d 6574  ions = tuple(met
+00022e30: 686f 6473 2e74 6f6c 6973 7428 6e65 7729  hods.tolist(new)
+00022e40: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00022e50: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00022e60: 2020 2020 2020 2020 2020 2020 7265 7320              res 
+00022e70: 3d20 7265 732e 636c 6561 725f 6469 7669  = res.clear_divi
+00022e80: 7369 6f6e 7328 290a 2020 2020 2020 2020  sions().        
+00022e90: 2020 2020 6966 2069 6e70 6c61 6365 3a0a      if inplace:.
+00022ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022eb0: 7365 6c66 2e64 6173 6b20 3d20 7265 732e  self.dask = res.
+00022ec0: 6461 736b 0a20 2020 2020 2020 2020 2020  dask.           
+00022ed0: 2020 2020 2073 656c 662e 5f6e 616d 6520       self._name 
+00022ee0: 3d20 7265 732e 5f6e 616d 650a 2020 2020  = res._name.    
+00022ef0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00022f00: 2e5f 6469 7669 7369 6f6e 7320 3d20 7265  ._divisions = re
+00022f10: 732e 6469 7669 7369 6f6e 730a 2020 2020  s.divisions.    
+00022f20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00022f30: 2e5f 6d65 7461 203d 2072 6573 2e5f 6d65  ._meta = res._me
+00022f40: 7461 0a20 2020 2020 2020 2020 2020 2020  ta.             
+00022f50: 2020 2072 6573 203d 2073 656c 660a 2020     res = self.  
+00022f60: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+00022f70: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00022f80: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00022f90: 2020 2064 6566 2072 6f75 6e64 2873 656c     def round(sel
+00022fa0: 662c 2064 6563 696d 616c 733d 3029 3a0a  f, decimals=0):.
+00022fb0: 2020 2020 2020 2020 7265 7475 726e 2065          return e
+00022fc0: 6c65 6d77 6973 6528 4d2e 726f 756e 642c  lemwise(M.round,
+00022fd0: 2073 656c 662c 2064 6563 696d 616c 7329   self, decimals)
+00022fe0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00022ff0: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00023000: 2020 2064 6566 2074 6f5f 7469 6d65 7374     def to_timest
+00023010: 616d 7028 7365 6c66 2c20 6672 6571 3d4e  amp(self, freq=N
+00023020: 6f6e 652c 2068 6f77 3d22 7374 6172 7422  one, how="start"
+00023030: 2c20 6178 6973 3d30 293a 0a20 2020 2020  , axis=0):.     
+00023040: 2020 2064 6620 3d20 656c 656d 7769 7365     df = elemwise
+00023050: 284d 2e74 6f5f 7469 6d65 7374 616d 702c  (M.to_timestamp,
+00023060: 2073 656c 662c 2066 7265 712c 2068 6f77   self, freq, how
+00023070: 2c20 6178 6973 290a 2020 2020 2020 2020  , axis).        
+00023080: 6466 2e64 6976 6973 696f 6e73 203d 2074  df.divisions = t
+00023090: 7570 6c65 2870 642e 496e 6465 7828 7365  uple(pd.Index(se
+000230a0: 6c66 2e64 6976 6973 696f 6e73 292e 746f  lf.divisions).to
+000230b0: 5f74 696d 6573 7461 6d70 2866 7265 713d  _timestamp(freq=
+000230c0: 6672 6571 2c20 686f 773d 686f 7729 290a  freq, how=how)).
+000230d0: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+000230e0: 660a 0a20 2020 2064 6566 2071 7561 6e74  f..    def quant
+000230f0: 696c 6528 7365 6c66 2c20 713d 302e 352c  ile(self, q=0.5,
+00023100: 206d 6574 686f 643d 2264 6566 6175 6c74   method="default
+00023110: 2229 3a0a 2020 2020 2020 2020 2222 2241  "):.        """A
+00023120: 7070 726f 7869 6d61 7465 2071 7561 6e74  pproximate quant
+00023130: 696c 6573 206f 6620 5365 7269 6573 0a0a  iles of Series..
+00023140: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00023150: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00023160: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7120  -----.        q 
+00023170: 3a20 6c69 7374 2f61 7272 6179 206f 6620  : list/array of 
+00023180: 666c 6f61 7473 2c20 6465 6661 756c 7420  floats, default 
+00023190: 302e 3520 2835 3025 290a 2020 2020 2020  0.5 (50%).      
+000231a0: 2020 2020 2020 4974 6572 6162 6c65 206f        Iterable o
+000231b0: 6620 6e75 6d62 6572 7320 7261 6e67 696e  f numbers rangin
+000231c0: 6720 6672 6f6d 2030 2074 6f20 3120 666f  g from 0 to 1 fo
+000231d0: 7220 7468 6520 6465 7369 7265 6420 7175  r the desired qu
+000231e0: 616e 7469 6c65 730a 2020 2020 2020 2020  antiles.        
+000231f0: 6d65 7468 6f64 203a 207b 2764 6566 6175  method : {'defau
+00023200: 6c74 272c 2027 7464 6967 6573 7427 2c20  lt', 'tdigest', 
+00023210: 2764 6173 6b27 7d2c 206f 7074 696f 6e61  'dask'}, optiona
+00023220: 6c0a 2020 2020 2020 2020 2020 2020 5768  l.            Wh
+00023230: 6174 206d 6574 686f 6420 746f 2075 7365  at method to use
+00023240: 2e20 4279 2064 6566 6175 6c74 2077 696c  . By default wil
+00023250: 6c20 7573 6520 6461 736b 2773 2069 6e74  l use dask's int
+00023260: 6572 6e61 6c20 6375 7374 6f6d 0a20 2020  ernal custom.   
+00023270: 2020 2020 2020 2020 2061 6c67 6f72 6974           algorit
+00023280: 686d 2028 6060 2764 6173 6b27 6060 292e  hm (``'dask'``).
+00023290: 2020 4966 2073 6574 2074 6f20 6060 2774    If set to ``'t
+000232a0: 6469 6765 7374 2760 6020 7769 6c6c 2075  digest'`` will u
+000232b0: 7365 2074 6469 6765 7374 0a20 2020 2020  se tdigest.     
+000232c0: 2020 2020 2020 2066 6f72 2066 6c6f 6174         for float
+000232d0: 7320 616e 6420 696e 7473 2061 6e64 2066  s and ints and f
+000232e0: 616c 6c62 6163 6b20 746f 2074 6865 2060  allback to the `
+000232f0: 6027 6461 736b 2760 6020 6f74 6865 7277  `'dask'`` otherw
+00023300: 6973 652e 0a20 2020 2020 2020 2022 2222  ise..        """
+00023310: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00023320: 7175 616e 7469 6c65 2873 656c 662c 2071  quantile(self, q
+00023330: 2c20 6d65 7468 6f64 3d6d 6574 686f 6429  , method=method)
+00023340: 0a0a 2020 2020 6465 6620 6d65 6469 616e  ..    def median
+00023350: 5f61 7070 726f 7869 6d61 7465 2873 656c  _approximate(sel
+00023360: 662c 206d 6574 686f 643d 2264 6566 6175  f, method="defau
+00023370: 6c74 2229 3a0a 2020 2020 2020 2020 2222  lt"):.        ""
+00023380: 2252 6574 7572 6e20 7468 6520 6170 7072  "Return the appr
+00023390: 6f78 696d 6174 6520 6d65 6469 616e 206f  oximate median o
+000233a0: 6620 7468 6520 7661 6c75 6573 206f 7665  f the values ove
+000233b0: 7220 7468 6520 7265 7175 6573 7465 6420  r the requested 
+000233c0: 6178 6973 2e0a 0a20 2020 2020 2020 2050  axis...        P
+000233d0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+000233e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+000233f0: 2020 2020 206d 6574 686f 6420 3a20 7b27       method : {'
+00023400: 6465 6661 756c 7427 2c20 2774 6469 6765  default', 'tdige
+00023410: 7374 272c 2027 6461 736b 277d 2c20 6f70  st', 'dask'}, op
+00023420: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00023430: 2020 2057 6861 7420 6d65 7468 6f64 2074     What method t
+00023440: 6f20 7573 652e 2042 7920 6465 6661 756c  o use. By defaul
+00023450: 7420 7769 6c6c 2075 7365 2044 6173 6b27  t will use Dask'
+00023460: 7320 696e 7465 726e 616c 2063 7573 746f  s internal custo
+00023470: 6d0a 2020 2020 2020 2020 2020 2020 616c  m.            al
+00023480: 676f 7269 7468 6d20 2860 6022 6461 736b  gorithm (``"dask
+00023490: 2260 6029 2e20 2049 6620 7365 7420 746f  "``).  If set to
+000234a0: 2060 6022 7464 6967 6573 7422 6060 2077   ``"tdigest"`` w
+000234b0: 696c 6c20 7573 6520 7464 6967 6573 740a  ill use tdigest.
+000234c0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000234d0: 666c 6f61 7473 2061 6e64 2069 6e74 7320  floats and ints 
+000234e0: 616e 6420 6661 6c6c 6261 636b 2074 6f20  and fallback to 
+000234f0: 7468 6520 6060 2264 6173 6b22 6060 206f  the ``"dask"`` o
+00023500: 7468 6572 7769 7365 2e0a 2020 2020 2020  therwise..      
+00023510: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+00023520: 7475 726e 2073 656c 662e 7175 616e 7469  turn self.quanti
+00023530: 6c65 2871 3d30 2e35 2c20 6d65 7468 6f64  le(q=0.5, method
+00023540: 3d6d 6574 686f 6429 0a0a 2020 2020 4064  =method)..    @d
+00023550: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+00023560: 6572 6965 7329 0a20 2020 2064 6566 206d  eries).    def m
+00023570: 6564 6961 6e28 7365 6c66 2c20 6d65 7468  edian(self, meth
+00023580: 6f64 3d22 6465 6661 756c 7422 293a 0a20  od="default"):. 
+00023590: 2020 2020 2020 2069 6620 7365 6c66 2e6e         if self.n
+000235a0: 7061 7274 6974 696f 6e73 203d 3d20 313a  partitions == 1:
+000235b0: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
+000235c0: 616e 2070 726f 7669 6465 2061 6e20 6578  an provide an ex
+000235d0: 6163 7420 6d65 6469 616e 2069 6e20 7468  act median in th
+000235e0: 6573 6520 6361 7365 730a 2020 2020 2020  ese cases.      
+000235f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00023600: 662e 6d65 6469 616e 5f61 7070 726f 7869  f.median_approxi
+00023610: 6d61 7465 286d 6574 686f 643d 6d65 7468  mate(method=meth
+00023620: 6f64 290a 2020 2020 2020 2020 7261 6973  od).        rais
+00023630: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+00023640: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00023650: 2020 2022 4461 736b 2064 6f65 736e 2774     "Dask doesn't
+00023660: 2069 6d70 6c65 6d65 6e74 2061 6e20 6578   implement an ex
+00023670: 6163 7420 6d65 6469 616e 2069 6e20 616c  act median in al
+00023680: 6c20 6361 7365 7320 6173 2074 6869 7320  l cases as this 
+00023690: 6973 2068 6172 6420 746f 2064 6f20 696e  is hard to do in
+000236a0: 2070 6172 616c 6c65 6c2e 2022 0a20 2020   parallel. ".   
+000236b0: 2020 2020 2020 2020 2022 5365 6520 7468           "See th
+000236c0: 6520 606d 6564 6961 6e5f 6170 7072 6f78  e `median_approx
+000236d0: 696d 6174 6560 206d 6574 686f 6420 696e  imate` method in
+000236e0: 7374 6561 642c 2077 6869 6368 2075 7365  stead, which use
+000236f0: 7320 616e 2061 7070 726f 7869 6d61 7465  s an approximate
+00023700: 2061 6c67 6f72 6974 686d 2e22 0a20 2020   algorithm.".   
+00023710: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00023720: 5f72 6570 6172 7469 7469 6f6e 5f71 7561  _repartition_qua
+00023730: 6e74 696c 6573 2873 656c 662c 206e 7061  ntiles(self, npa
+00023740: 7274 6974 696f 6e73 2c20 7570 7361 6d70  rtitions, upsamp
+00023750: 6c65 3d31 2e30 293a 0a20 2020 2020 2020  le=1.0):.       
+00023760: 2022 2222 4170 7072 6f78 696d 6174 6520   """Approximate 
+00023770: 7175 616e 7469 6c65 7320 6f66 2053 6572  quantiles of Ser
+00023780: 6965 7320 7573 6564 2066 6f72 2072 6570  ies used for rep
+00023790: 6172 7469 7469 6f6e 696e 6722 2222 0a20  artitioning""". 
+000237a0: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+000237b0: 2e64 6174 6166 7261 6d65 2e70 6172 7469  .dataframe.parti
+000237c0: 7469 6f6e 7175 616e 7469 6c65 7320 696d  tionquantiles im
+000237d0: 706f 7274 2070 6172 7469 7469 6f6e 5f71  port partition_q
+000237e0: 7561 6e74 696c 6573 0a0a 2020 2020 2020  uantiles..      
+000237f0: 2020 7265 7475 726e 2070 6172 7469 7469    return partiti
+00023800: 6f6e 5f71 7561 6e74 696c 6573 2873 656c  on_quantiles(sel
+00023810: 662c 206e 7061 7274 6974 696f 6e73 2c20  f, npartitions, 
+00023820: 7570 7361 6d70 6c65 3d75 7073 616d 706c  upsample=upsampl
+00023830: 6529 0a0a 2020 2020 6465 6620 5f5f 6765  e)..    def __ge
+00023840: 7469 7465 6d5f 5f28 7365 6c66 2c20 6b65  titem__(self, ke
+00023850: 7929 3a0a 2020 2020 2020 2020 6966 2069  y):.        if i
+00023860: 7369 6e73 7461 6e63 6528 6b65 792c 2053  sinstance(key, S
+00023870: 6572 6965 7329 2061 6e64 2073 656c 662e  eries) and self.
+00023880: 6469 7669 7369 6f6e 7320 3d3d 206b 6579  divisions == key
+00023890: 2e64 6976 6973 696f 6e73 3a0a 2020 2020  .divisions:.    
+000238a0: 2020 2020 2020 2020 6e61 6d65 203d 2022          name = "
+000238b0: 696e 6465 782d 2573 2220 2520 746f 6b65  index-%s" % toke
+000238c0: 6e69 7a65 2873 656c 662c 206b 6579 290a  nize(self, key).
+000238d0: 2020 2020 2020 2020 2020 2020 6473 6b20              dsk 
+000238e0: 3d20 7061 7274 6974 696f 6e77 6973 655f  = partitionwise_
+000238f0: 6772 6170 6828 6f70 6572 6174 6f72 2e67  graph(operator.g
+00023900: 6574 6974 656d 2c20 6e61 6d65 2c20 7365  etitem, name, se
+00023910: 6c66 2c20 6b65 7929 0a20 2020 2020 2020  lf, key).       
+00023920: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
+00023930: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+00023940: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
+00023950: 652c 2064 736b 2c20 6465 7065 6e64 656e  e, dsk, dependen
+00023960: 6369 6573 3d5b 7365 6c66 2c20 6b65 795d  cies=[self, key]
+00023970: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00023980: 7475 726e 2053 6572 6965 7328 6772 6170  turn Series(grap
+00023990: 682c 206e 616d 652c 2073 656c 662e 5f6d  h, name, self._m
+000239a0: 6574 612c 2073 656c 662e 6469 7669 7369  eta, self.divisi
+000239b0: 6f6e 7329 0a20 2020 2020 2020 2072 6574  ons).        ret
+000239c0: 7572 6e20 7365 6c66 2e6c 6f63 5b6b 6579  urn self.loc[key
+000239d0: 5d0a 0a20 2020 2040 6465 7269 7665 645f  ]..    @derived_
+000239e0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+000239f0: 6529 0a20 2020 2064 6566 205f 6765 745f  e).    def _get_
+00023a00: 6e75 6d65 7269 635f 6461 7461 2873 656c  numeric_data(sel
+00023a10: 662c 2068 6f77 3d22 616e 7922 2c20 7375  f, how="any", su
+00023a20: 6273 6574 3d4e 6f6e 6529 3a0a 2020 2020  bset=None):.    
+00023a30: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
+00023a40: 0a20 2020 2069 6620 6e6f 7420 5041 4e44  .    if not PAND
+00023a50: 4153 5f47 545f 3230 303a 0a0a 2020 2020  AS_GT_200:..    
+00023a60: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00023a70: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
+00023a80: 2020 2020 2064 6566 2069 7465 7269 7465       def iterite
+00023a90: 6d73 2873 656c 6629 3a0a 2020 2020 2020  ms(self):.      
+00023aa0: 2020 2020 2020 6966 2050 414e 4441 535f        if PANDAS_
+00023ab0: 4754 5f31 3530 3a0a 2020 2020 2020 2020  GT_150:.        
+00023ac0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+00023ad0: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
+00023ae0: 2020 2020 2020 2020 2020 2022 6974 6572             "iter
+00023af0: 6974 656d 7320 6973 2064 6570 7265 6361  items is depreca
+00023b00: 7465 6420 616e 6420 7769 6c6c 2062 6520  ted and will be 
+00023b10: 7265 6d6f 7665 6420 696e 2061 2066 7574  removed in a fut
+00023b20: 7572 6520 7665 7273 696f 6e2e 2022 0a20  ure version. ". 
+00023b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023b40: 2020 2022 5573 6520 2e69 7465 6d73 2069     "Use .items i
+00023b50: 6e73 7465 6164 2e22 2c0a 2020 2020 2020  nstead.",.      
+00023b60: 2020 2020 2020 2020 2020 2020 2020 4675                Fu
+00023b70: 7475 7265 5761 726e 696e 672c 0a20 2020  tureWarning,.   
+00023b80: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00023b90: 2020 2020 2020 2020 2020 2023 2057 6520             # We 
+00023ba0: 7573 6520 7468 6520 605f 6020 6765 6e65  use the `_` gene
+00023bb0: 7261 746f 7220 6265 6c6f 7720 746f 2065  rator below to e
+00023bc0: 6e73 7572 6520 7468 6520 6465 7072 6563  nsure the deprec
+00023bd0: 6174 696f 6e20 7761 726e 696e 6720 6162  ation warning ab
+00023be0: 6f76 650a 2020 2020 2020 2020 2020 2020  ove.            
+00023bf0: 2320 6973 2072 6169 7365 6420 7768 656e  # is raised when
+00023c00: 2060 2e69 7465 7269 7465 6d73 2829 6020   `.iteritems()` 
+00023c10: 6973 2063 616c 6c65 642c 206e 6f74 2077  is called, not w
+00023c20: 6865 6e20 7468 6520 6669 7273 7420 606e  hen the first `n
+00023c30: 6578 7428 3c67 656e 6572 6174 6f72 3e29  ext(<generator>)
+00023c40: 600a 2020 2020 2020 2020 2020 2020 2320  `.            # 
+00023c50: 6974 6572 6174 696f 6e20 6861 7070 656e  iteration happen
+00023c60: 730a 0a20 2020 2020 2020 2020 2020 2064  s..            d
+00023c70: 6566 205f 2873 656c 6629 3a0a 2020 2020  ef _(self):.    
+00023c80: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00023c90: 6920 696e 2072 616e 6765 2873 656c 662e  i in range(self.
+00023ca0: 6e70 6172 7469 7469 6f6e 7329 3a0a 2020  npartitions):.  
+00023cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023cc0: 2020 7320 3d20 7365 6c66 2e67 6574 5f70    s = self.get_p
+00023cd0: 6172 7469 7469 6f6e 2869 292e 636f 6d70  artition(i).comp
+00023ce0: 7574 6528 290a 2020 2020 2020 2020 2020  ute().          
+00023cf0: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
+00023d00: 6672 6f6d 2073 2e69 7465 6d73 2829 0a0a  from s.items()..
+00023d10: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00023d20: 726e 205f 2873 656c 6629 0a0a 2020 2020  rn _(self)..    
+00023d30: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00023d40: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
+00023d50: 205f 5f69 7465 725f 5f28 7365 6c66 293a   __iter__(self):
+00023d60: 0a20 2020 2020 2020 2066 6f72 2069 2069  .        for i i
+00023d70: 6e20 7261 6e67 6528 7365 6c66 2e6e 7061  n range(self.npa
+00023d80: 7274 6974 696f 6e73 293a 0a20 2020 2020  rtitions):.     
+00023d90: 2020 2020 2020 2073 203d 2073 656c 662e         s = self.
+00023da0: 6765 745f 7061 7274 6974 696f 6e28 6929  get_partition(i)
+00023db0: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
+00023dc0: 2020 2020 2020 2079 6965 6c64 2066 726f         yield fro
+00023dd0: 6d20 730a 0a20 2020 2040 5f64 6570 7265  m s..    @_depre
+00023de0: 6361 7465 6428 0a20 2020 2020 2020 206d  cated(.        m
+00023df0: 6573 7361 6765 3d28 0a20 2020 2020 2020  essage=(.       
+00023e00: 2020 2020 2022 5573 696e 6720 7468 6520       "Using the 
+00023e10: 6060 696e 6060 206f 7065 7261 746f 7220  ``in`` operator 
+00023e20: 746f 2074 6573 7420 666f 7220 6d65 6d62  to test for memb
+00023e30: 6572 7368 6970 2069 6e20 5365 7269 6573  ership in Series
+00023e40: 2069 7320 220a 2020 2020 2020 2020 2020   is ".          
+00023e50: 2020 2264 6570 7265 6361 7465 642e 2054    "deprecated. T
+00023e60: 6f20 7465 7374 2066 6f72 206d 656d 6265  o test for membe
+00023e70: 7273 6869 7020 696e 2074 6865 2069 6e64  rship in the ind
+00023e80: 6578 2075 7365 2022 0a20 2020 2020 2020  ex use ".       
+00023e90: 2020 2020 2022 6060 2873 2e69 6e64 6578       "``(s.index
+00023ea0: 203d 3d20 6b65 7929 2e61 6e79 2829 6060   == key).any()``
+00023eb0: 2e20 5369 6d69 6c61 726c 7920 746f 2074  . Similarly to t
+00023ec0: 6573 7420 666f 7220 6d65 6d62 6572 7368  est for membersh
+00023ed0: 6970 2069 6e20 220a 2020 2020 2020 2020  ip in ".        
+00023ee0: 2020 2020 2274 6865 2076 616c 7565 7320      "the values 
+00023ef0: 7573 6520 6060 2873 203d 3d20 6b65 7929  use ``(s == key)
+00023f00: 2e61 6e79 2829 6060 220a 2020 2020 2020  .any()``".      
+00023f10: 2020 290a 2020 2020 290a 2020 2020 6465    ).    ).    de
+00023f20: 6620 5f5f 636f 6e74 6169 6e73 5f5f 2873  f __contains__(s
+00023f30: 656c 662c 206b 6579 293a 0a20 2020 2020  elf, key):.     
+00023f40: 2020 2072 6574 7572 6e20 2873 656c 6620     return (self 
+00023f50: 3d3d 206b 6579 292e 616e 7928 292e 636f  == key).any().co
+00023f60: 6d70 7574 6528 290a 0a20 2020 2040 636c  mpute()..    @cl
+00023f70: 6173 736d 6574 686f 640a 2020 2020 6465  assmethod.    de
+00023f80: 6620 5f76 616c 6964 6174 655f 6178 6973  f _validate_axis
+00023f90: 2863 6c73 2c20 6178 6973 3d30 2c20 6e6f  (cls, axis=0, no
+00023fa0: 6e65 5f69 735f 7a65 726f 3a20 626f 6f6c  ne_is_zero: bool
+00023fb0: 203d 2054 7275 6529 202d 3e20 4e6f 6e65   = True) -> None
+00023fc0: 207c 204c 6974 6572 616c 5b30 2c20 315d   | Literal[0, 1]
+00023fd0: 3a0a 2020 2020 2020 2020 6966 2061 7869  :.        if axi
+00023fe0: 7320 6e6f 7420 696e 2028 302c 2022 696e  s not in (0, "in
+00023ff0: 6465 7822 2c20 4e6f 6e65 293a 0a20 2020  dex", None):.   
+00024000: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00024010: 616c 7565 4572 726f 7228 6622 4e6f 2061  alueError(f"No a
+00024020: 7869 7320 6e61 6d65 6420 7b61 7869 737d  xis named {axis}
+00024030: 2229 0a20 2020 2020 2020 2023 2063 6f6e  ").        # con
+00024040: 7665 7274 2074 6f20 6e75 6d65 7269 6320  vert to numeric 
+00024050: 6178 6973 0a20 2020 2020 2020 206e 756d  axis.        num
+00024060: 6572 6963 5f61 7869 733a 2064 6963 745b  eric_axis: dict[
+00024070: 7374 7220 7c20 4e6f 6e65 2c20 4c69 7465  str | None, Lite
+00024080: 7261 6c5b 302c 2031 5d5d 203d 207b 2269  ral[0, 1]] = {"i
+00024090: 6e64 6578 223a 2030 7d0a 2020 2020 2020  ndex": 0}.      
+000240a0: 2020 6966 206e 6f6e 655f 6973 5f7a 6572    if none_is_zer
+000240b0: 6f3a 0a20 2020 2020 2020 2020 2020 206e  o:.            n
+000240c0: 756d 6572 6963 5f61 7869 735b 4e6f 6e65  umeric_axis[None
+000240d0: 5d20 3d20 300a 2020 2020 2020 2020 7265  ] = 0.        re
+000240e0: 7475 726e 206e 756d 6572 6963 5f61 7869  turn numeric_axi
+000240f0: 732e 6765 7428 6178 6973 2c20 6178 6973  s.get(axis, axis
+00024100: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00024110: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
+00024120: 2020 2020 6465 6620 6772 6f75 7062 7928      def groupby(
+00024130: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00024140: 2020 2020 2020 2062 793d 4e6f 6e65 2c0a         by=None,.
+00024150: 2020 2020 2020 2020 6772 6f75 705f 6b65          group_ke
+00024160: 7973 3d47 524f 5550 5f4b 4559 535f 4445  ys=GROUP_KEYS_DE
+00024170: 4641 554c 542c 0a20 2020 2020 2020 2073  FAULT,.        s
+00024180: 6f72 743d 4e6f 6e65 2c0a 2020 2020 2020  ort=None,.      
+00024190: 2020 6f62 7365 7276 6564 3d4e 6f6e 652c    observed=None,
+000241a0: 0a20 2020 2020 2020 2064 726f 706e 613d  .        dropna=
+000241b0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2a2a  None,.        **
+000241c0: 6b77 6172 6773 2c0a 2020 2020 293a 0a20  kwargs,.    ):. 
+000241d0: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+000241e0: 2e64 6174 6166 7261 6d65 2e67 726f 7570  .dataframe.group
+000241f0: 6279 2069 6d70 6f72 7420 5365 7269 6573  by import Series
+00024200: 4772 6f75 7042 790a 0a20 2020 2020 2020  GroupBy..       
+00024210: 2072 6574 7572 6e20 5365 7269 6573 4772   return SeriesGr
+00024220: 6f75 7042 7928 0a20 2020 2020 2020 2020  oupBy(.         
+00024230: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00024240: 2020 2020 2062 793d 6279 2c0a 2020 2020       by=by,.    
+00024250: 2020 2020 2020 2020 6772 6f75 705f 6b65          group_ke
+00024260: 7973 3d67 726f 7570 5f6b 6579 732c 0a20  ys=group_keys,. 
+00024270: 2020 2020 2020 2020 2020 2073 6f72 743d             sort=
+00024280: 736f 7274 2c0a 2020 2020 2020 2020 2020  sort,.          
+00024290: 2020 6f62 7365 7276 6564 3d6f 6273 6572    observed=obser
+000242a0: 7665 642c 0a20 2020 2020 2020 2020 2020  ved,.           
+000242b0: 2064 726f 706e 613d 6472 6f70 6e61 2c0a   dropna=dropna,.
+000242c0: 2020 2020 2020 2020 2020 2020 2a2a 6b77              **kw
+000242d0: 6172 6773 2c0a 2020 2020 2020 2020 290a  args,.        ).
+000242e0: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
+000242f0: 6f6d 2870 642e 5365 7269 6573 290a 2020  om(pd.Series).  
+00024300: 2020 6465 6620 636f 756e 7428 7365 6c66    def count(self
+00024310: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
+00024320: 6c73 6529 3a0a 2020 2020 2020 2020 7265  lse):.        re
+00024330: 7475 726e 2073 7570 6572 2829 2e63 6f75  turn super().cou
+00024340: 6e74 2873 706c 6974 5f65 7665 7279 3d73  nt(split_every=s
+00024350: 706c 6974 5f65 7665 7279 290a 0a20 2020  plit_every)..   
+00024360: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00024370: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
+00024380: 6620 6d6f 6465 2873 656c 662c 2064 726f  f mode(self, dro
+00024390: 706e 613d 5472 7565 2c20 7370 6c69 745f  pna=True, split_
+000243a0: 6576 6572 793d 4661 6c73 6529 3a0a 2020  every=False):.  
+000243b0: 2020 2020 2020 7265 7475 726e 2073 7570        return sup
+000243c0: 6572 2829 2e6d 6f64 6528 6472 6f70 6e61  er().mode(dropna
+000243d0: 3d64 726f 706e 612c 2073 706c 6974 5f65  =dropna, split_e
+000243e0: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
+000243f0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00024400: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
+00024410: 2020 2020 6465 6620 6578 706c 6f64 6528      def explode(
+00024420: 7365 6c66 293a 0a20 2020 2020 2020 206d  self):.        m
+00024430: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
+00024440: 2e65 7870 6c6f 6465 2829 0a20 2020 2020  .explode().     
+00024450: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
+00024460: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
+00024470: 6578 706c 6f64 652c 206d 6574 613d 6d65  explode, meta=me
+00024480: 7461 2c20 656e 666f 7263 655f 6d65 7461  ta, enforce_meta
+00024490: 6461 7461 3d46 616c 7365 290a 0a20 2020  data=False)..   
+000244a0: 2064 6566 2075 6e69 7175 6528 7365 6c66   def unique(self
+000244b0: 2c20 7370 6c69 745f 6576 6572 793d 4e6f  , split_every=No
+000244c0: 6e65 2c20 7370 6c69 745f 6f75 743d 3129  ne, split_out=1)
+000244d0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000244e0: 2020 2020 2020 5265 7475 726e 2053 6572        Return Ser
+000244f0: 6965 7320 6f66 2075 6e69 7175 6520 7661  ies of unique va
+00024500: 6c75 6573 2069 6e20 7468 6520 6f62 6a65  lues in the obje
+00024510: 6374 2e20 496e 636c 7564 6573 204e 4120  ct. Includes NA 
+00024520: 7661 6c75 6573 2e0a 0a20 2020 2020 2020  values...       
+00024530: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+00024540: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00024550: 2075 6e69 7175 6573 203a 2053 6572 6965   uniques : Serie
+00024560: 730a 2020 2020 2020 2020 2222 220a 2020  s.        """.  
+00024570: 2020 2020 2020 7265 7475 726e 2061 6361        return aca
+00024580: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00024590: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+000245a0: 6368 756e 6b3d 6d65 7468 6f64 732e 756e  chunk=methods.un
+000245b0: 6971 7565 2c0a 2020 2020 2020 2020 2020  ique,.          
+000245c0: 2020 6167 6772 6567 6174 653d 6d65 7468    aggregate=meth
+000245d0: 6f64 732e 756e 6971 7565 2c0a 2020 2020  ods.unique,.    
+000245e0: 2020 2020 2020 2020 6d65 7461 3d73 656c          meta=sel
+000245f0: 662e 5f6d 6574 612c 0a20 2020 2020 2020  f._meta,.       
+00024600: 2020 2020 2074 6f6b 656e 3d22 756e 6971       token="uniq
+00024610: 7565 222c 0a20 2020 2020 2020 2020 2020  ue",.           
+00024620: 2073 706c 6974 5f65 7665 7279 3d73 706c   split_every=spl
+00024630: 6974 5f65 7665 7279 2c0a 2020 2020 2020  it_every,.      
+00024640: 2020 2020 2020 7365 7269 6573 5f6e 616d        series_nam
+00024650: 653d 7365 6c66 2e6e 616d 652c 0a20 2020  e=self.name,.   
+00024660: 2020 2020 2020 2020 2073 706c 6974 5f6f           split_o
+00024670: 7574 3d73 706c 6974 5f6f 7574 2c0a 2020  ut=split_out,.  
+00024680: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
+00024690: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
+000246a0: 7269 6573 290a 2020 2020 6465 6620 6e75  ries).    def nu
+000246b0: 6e69 7175 6528 7365 6c66 2c20 7370 6c69  nique(self, spli
+000246c0: 745f 6576 6572 793d 4e6f 6e65 2c20 6472  t_every=None, dr
+000246d0: 6f70 6e61 3d54 7275 6529 3a0a 2020 2020  opna=True):.    
+000246e0: 2020 2020 756e 6971 7320 3d20 7365 6c66      uniqs = self
+000246f0: 2e64 726f 705f 6475 706c 6963 6174 6573  .drop_duplicates
+00024700: 2873 706c 6974 5f65 7665 7279 3d73 706c  (split_every=spl
+00024710: 6974 5f65 7665 7279 290a 2020 2020 2020  it_every).      
+00024720: 2020 6966 2064 726f 706e 613a 0a20 2020    if dropna:.   
+00024730: 2020 2020 2020 2020 2023 2063 6f75 6e74           # count
+00024740: 206d 696d 6963 7320 7061 6e64 6173 2062   mimics pandas b
+00024750: 6568 6176 696f 7220 616e 6420 6578 636c  ehavior and excl
+00024760: 7564 6573 204e 4120 7661 6c75 6573 0a20  udes NA values. 
+00024770: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00024780: 6e20 756e 6971 732e 636f 756e 7428 290a  n uniqs.count().
+00024790: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000247a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000247b0: 2075 6e69 7173 2e73 697a 650a 0a20 2020   uniqs.size..   
+000247c0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+000247d0: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
+000247e0: 6620 7661 6c75 655f 636f 756e 7473 280a  f value_counts(.
+000247f0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00024800: 2020 2020 2020 736f 7274 3d4e 6f6e 652c        sort=None,
+00024810: 0a20 2020 2020 2020 2061 7363 656e 6469  .        ascendi
+00024820: 6e67 3d46 616c 7365 2c0a 2020 2020 2020  ng=False,.      
+00024830: 2020 6472 6f70 6e61 3d54 7275 652c 0a20    dropna=True,. 
+00024840: 2020 2020 2020 206e 6f72 6d61 6c69 7a65         normalize
+00024850: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00024860: 7370 6c69 745f 6576 6572 793d 4e6f 6e65  split_every=None
+00024870: 2c0a 2020 2020 2020 2020 7370 6c69 745f  ,.        split_
+00024880: 6f75 743d 312c 0a20 2020 2029 3a0a 2020  out=1,.    ):.  
+00024890: 2020 2020 2020 6b77 6172 6773 203d 207b        kwargs = {
+000248a0: 2273 6f72 7422 3a20 736f 7274 2c20 2261  "sort": sort, "a
+000248b0: 7363 656e 6469 6e67 223a 2061 7363 656e  scending": ascen
+000248c0: 6469 6e67 2c20 2264 726f 706e 6122 3a20  ding, "dropna": 
+000248d0: 6472 6f70 6e61 7d0a 2020 2020 2020 2020  dropna}.        
+000248e0: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
+000248f0: 203d 207b 226e 6f72 6d61 6c69 7a65 223a   = {"normalize":
+00024900: 206e 6f72 6d61 6c69 7a65 7d0a 2020 2020   normalize}.    
+00024910: 2020 2020 6966 2073 706c 6974 5f6f 7574      if split_out
+00024920: 203e 2031 3a0a 2020 2020 2020 2020 2020   > 1:.          
+00024930: 2020 6167 6772 6567 6174 655f 6b77 6172    aggregate_kwar
+00024940: 6773 5b22 746f 7461 6c5f 6c65 6e67 7468  gs["total_length
+00024950: 225d 203d 2028 0a20 2020 2020 2020 2020  "] = (.         
+00024960: 2020 2020 2020 206c 656e 2873 656c 6629         len(self)
+00024970: 2069 6620 6472 6f70 6e61 2069 7320 4661   if dropna is Fa
+00024980: 6c73 6520 656c 7365 206c 656e 2873 656c  lse else len(sel
+00024990: 662e 6472 6f70 6e61 2829 290a 2020 2020  f.dropna()).    
+000249a0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+000249b0: 2020 2072 6574 7572 6e20 6163 6128 0a20     return aca(. 
+000249c0: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+000249d0: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
+000249e0: 6e6b 3d4d 2e76 616c 7565 5f63 6f75 6e74  nk=M.value_count
+000249f0: 732c 0a20 2020 2020 2020 2020 2020 2061  s,.            a
+00024a00: 6767 7265 6761 7465 3d6d 6574 686f 6473  ggregate=methods
+00024a10: 2e76 616c 7565 5f63 6f75 6e74 735f 6167  .value_counts_ag
+00024a20: 6772 6567 6174 652c 0a20 2020 2020 2020  gregate,.       
+00024a30: 2020 2020 2063 6f6d 6269 6e65 3d6d 6574       combine=met
+00024a40: 686f 6473 2e76 616c 7565 5f63 6f75 6e74  hods.value_count
+00024a50: 735f 636f 6d62 696e 652c 0a20 2020 2020  s_combine,.     
+00024a60: 2020 2020 2020 206d 6574 613d 7365 6c66         meta=self
+00024a70: 2e5f 6d65 7461 2e76 616c 7565 5f63 6f75  ._meta.value_cou
+00024a80: 6e74 7328 6e6f 726d 616c 697a 653d 6e6f  nts(normalize=no
+00024a90: 726d 616c 697a 6529 2c0a 2020 2020 2020  rmalize),.      
+00024aa0: 2020 2020 2020 746f 6b65 6e3d 2276 616c        token="val
+00024ab0: 7565 2d63 6f75 6e74 7322 2c0a 2020 2020  ue-counts",.    
+00024ac0: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
+00024ad0: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
+00024ae0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+00024af0: 6974 5f6f 7574 3d73 706c 6974 5f6f 7574  it_out=split_out
+00024b00: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
+00024b10: 6c69 745f 6f75 745f 7365 7475 703d 7370  lit_out_setup=sp
+00024b20: 6c69 745f 6f75 745f 6f6e 5f69 6e64 6578  lit_out_on_index
+00024b30: 2c0a 2020 2020 2020 2020 2020 2020 6167  ,.            ag
+00024b40: 6772 6567 6174 655f 6b77 6172 6773 3d61  gregate_kwargs=a
+00024b50: 6767 7265 6761 7465 5f6b 7761 7267 732c  ggregate_kwargs,
+00024b60: 0a20 2020 2020 2020 2020 2020 202a 2a6b  .            **k
+00024b70: 7761 7267 732c 0a20 2020 2020 2020 2029  wargs,.        )
+00024b80: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00024b90: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+00024ba0: 2020 2064 6566 206e 6c61 7267 6573 7428     def nlargest(
+00024bb0: 7365 6c66 2c20 6e3d 352c 2073 706c 6974  self, n=5, split
+00024bc0: 5f65 7665 7279 3d4e 6f6e 6529 3a0a 2020  _every=None):.  
+00024bd0: 2020 2020 2020 7265 7475 726e 2061 6361        return aca
+00024be0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00024bf0: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+00024c00: 6368 756e 6b3d 4d2e 6e6c 6172 6765 7374  chunk=M.nlargest
+00024c10: 2c0a 2020 2020 2020 2020 2020 2020 6167  ,.            ag
+00024c20: 6772 6567 6174 653d 4d2e 6e6c 6172 6765  gregate=M.nlarge
+00024c30: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
+00024c40: 6d65 7461 3d73 656c 662e 5f6d 6574 612c  meta=self._meta,
+00024c50: 0a20 2020 2020 2020 2020 2020 2074 6f6b  .            tok
+00024c60: 656e 3d22 7365 7269 6573 2d6e 6c61 7267  en="series-nlarg
+00024c70: 6573 7422 2c0a 2020 2020 2020 2020 2020  est",.          
+00024c80: 2020 7370 6c69 745f 6576 6572 793d 7370    split_every=sp
+00024c90: 6c69 745f 6576 6572 792c 0a20 2020 2020  lit_every,.     
+00024ca0: 2020 2020 2020 206e 3d6e 2c0a 2020 2020         n=n,.    
+00024cb0: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
+00024cc0: 7665 645f 6672 6f6d 2870 642e 5365 7269  ved_from(pd.Seri
+00024cd0: 6573 290a 2020 2020 6465 6620 6e73 6d61  es).    def nsma
+00024ce0: 6c6c 6573 7428 7365 6c66 2c20 6e3d 352c  llest(self, n=5,
+00024cf0: 2073 706c 6974 5f65 7665 7279 3d4e 6f6e   split_every=Non
+00024d00: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
+00024d10: 726e 2061 6361 280a 2020 2020 2020 2020  rn aca(.        
+00024d20: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00024d30: 2020 2020 2020 6368 756e 6b3d 4d2e 6e73        chunk=M.ns
+00024d40: 6d61 6c6c 6573 742c 0a20 2020 2020 2020  mallest,.       
+00024d50: 2020 2020 2061 6767 7265 6761 7465 3d4d       aggregate=M
+00024d60: 2e6e 736d 616c 6c65 7374 2c0a 2020 2020  .nsmallest,.    
+00024d70: 2020 2020 2020 2020 6d65 7461 3d73 656c          meta=sel
+00024d80: 662e 5f6d 6574 612c 0a20 2020 2020 2020  f._meta,.       
+00024d90: 2020 2020 2074 6f6b 656e 3d22 7365 7269       token="seri
+00024da0: 6573 2d6e 736d 616c 6c65 7374 222c 0a20  es-nsmallest",. 
+00024db0: 2020 2020 2020 2020 2020 2073 706c 6974             split
+00024dc0: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
+00024dd0: 7279 2c0a 2020 2020 2020 2020 2020 2020  ry,.            
+00024de0: 6e3d 6e2c 0a20 2020 2020 2020 2029 0a0a  n=n,.        )..
+00024df0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00024e00: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
+00024e10: 2064 6566 2069 7369 6e28 7365 6c66 2c20   def isin(self, 
+00024e20: 7661 6c75 6573 293a 0a20 2020 2020 2020  values):.       
+00024e30: 2023 2041 6464 6564 206a 7573 7420 746f   # Added just to
+00024e40: 2067 6574 2074 6865 2064 6966 6665 7265   get the differe
+00024e50: 6e74 2064 6f63 7374 7269 6e67 2066 6f72  nt docstring for
+00024e60: 2053 6572 6965 730a 2020 2020 2020 2020   Series.        
+00024e70: 7265 7475 726e 2073 7570 6572 2829 2e69  return super().i
+00024e80: 7369 6e28 7661 6c75 6573 290a 0a20 2020  sin(values)..   
+00024e90: 2040 696e 7365 7274 5f6d 6574 615f 7061   @insert_meta_pa
+00024ea0: 7261 6d5f 6465 7363 7269 7074 696f 6e28  ram_description(
+00024eb0: 7061 643d 3132 290a 2020 2020 4064 6572  pad=12).    @der
+00024ec0: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
+00024ed0: 6965 7329 0a20 2020 2064 6566 206d 6170  ies).    def map
+00024ee0: 2873 656c 662c 2061 7267 2c20 6e61 5f61  (self, arg, na_a
+00024ef0: 6374 696f 6e3d 4e6f 6e65 2c20 6d65 7461  ction=None, meta
+00024f00: 3d6e 6f5f 6465 6661 756c 7429 3a0a 2020  =no_default):.  
+00024f10: 2020 2020 2020 6966 2069 735f 7365 7269        if is_seri
+00024f20: 6573 5f6c 696b 6528 6172 6729 2061 6e64  es_like(arg) and
+00024f30: 2069 735f 6461 736b 5f63 6f6c 6c65 6374   is_dask_collect
+00024f40: 696f 6e28 6172 6729 3a0a 2020 2020 2020  ion(arg):.      
+00024f50: 2020 2020 2020 7265 7475 726e 2073 6572        return ser
+00024f60: 6965 735f 6d61 7028 7365 6c66 2c20 6172  ies_map(self, ar
+00024f70: 6729 0a20 2020 2020 2020 2069 6620 6e6f  g).        if no
+00024f80: 7420 280a 2020 2020 2020 2020 2020 2020  t (.            
+00024f90: 6973 696e 7374 616e 6365 2861 7267 2c20  isinstance(arg, 
+00024fa0: 6469 6374 290a 2020 2020 2020 2020 2020  dict).          
+00024fb0: 2020 6f72 2063 616c 6c61 626c 6528 6172    or callable(ar
+00024fc0: 6729 0a20 2020 2020 2020 2020 2020 206f  g).            o
+00024fd0: 7220 6973 5f73 6572 6965 735f 6c69 6b65  r is_series_like
+00024fe0: 2861 7267 290a 2020 2020 2020 2020 2020  (arg).          
+00024ff0: 2020 616e 6420 6e6f 7420 6973 5f64 6173    and not is_das
+00025000: 6b5f 636f 6c6c 6563 7469 6f6e 2861 7267  k_collection(arg
+00025010: 290a 2020 2020 2020 2020 293a 0a20 2020  ).        ):.   
+00025020: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+00025030: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
+00025040: 2020 2020 2020 2020 2020 6622 6172 6720            f"arg 
+00025050: 6d75 7374 2062 6520 7061 6e64 6173 2e53  must be pandas.S
+00025060: 6572 6965 732c 2064 6963 7420 6f72 2063  eries, dict or c
+00025070: 616c 6c61 626c 652e 2047 6f74 207b 7479  allable. Got {ty
+00025080: 7065 2861 7267 297d 220a 2020 2020 2020  pe(arg)}".      
+00025090: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000250a0: 6e61 6d65 203d 2022 6d61 702d 2220 2b20  name = "map-" + 
+000250b0: 746f 6b65 6e69 7a65 2873 656c 662c 2061  tokenize(self, a
+000250c0: 7267 2c20 6e61 5f61 6374 696f 6e29 0a20  rg, na_action). 
+000250d0: 2020 2020 2020 2064 736b 203d 207b 0a20         dsk = {. 
+000250e0: 2020 2020 2020 2020 2020 2028 6e61 6d65             (name
+000250f0: 2c20 6929 3a20 284d 2e6d 6170 2c20 6b2c  , i): (M.map, k,
+00025100: 2061 7267 2c20 6e61 5f61 6374 696f 6e29   arg, na_action)
+00025110: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00025120: 2069 2c20 6b20 696e 2065 6e75 6d65 7261   i, k in enumera
+00025130: 7465 2873 656c 662e 5f5f 6461 736b 5f6b  te(self.__dask_k
+00025140: 6579 735f 5f28 2929 0a20 2020 2020 2020  eys__()).       
+00025150: 207d 0a20 2020 2020 2020 2067 7261 7068   }.        graph
+00025160: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+00025170: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+00025180: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
+00025190: 7065 6e64 656e 6369 6573 3d5b 7365 6c66  pendencies=[self
+000251a0: 5d29 0a20 2020 2020 2020 2069 6620 6d65  ]).        if me
+000251b0: 7461 2069 7320 6e6f 5f64 6566 6175 6c74  ta is no_default
+000251c0: 3a0a 2020 2020 2020 2020 2020 2020 6d65  :.            me
+000251d0: 7461 203d 205f 656d 756c 6174 6528 4d2e  ta = _emulate(M.
+000251e0: 6d61 702c 2073 656c 662c 2061 7267 2c20  map, self, arg, 
+000251f0: 6e61 5f61 6374 696f 6e3d 6e61 5f61 6374  na_action=na_act
+00025200: 696f 6e2c 2075 6466 3d54 7275 6529 0a20  ion, udf=True). 
+00025210: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00025220: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
+00025230: 6d61 6b65 5f6d 6574 6128 0a20 2020 2020  make_meta(.     
+00025240: 2020 2020 2020 2020 2020 206d 6574 612c             meta,
+00025250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025260: 2069 6e64 6578 3d67 6574 6174 7472 286d   index=getattr(m
+00025270: 616b 655f 6d65 7461 2873 656c 6629 2c20  ake_meta(self), 
+00025280: 2269 6e64 6578 222c 204e 6f6e 6529 2c0a  "index", None),.
+00025290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000252a0: 7061 7265 6e74 5f6d 6574 613d 7365 6c66  parent_meta=self
+000252b0: 2e5f 6d65 7461 2c0a 2020 2020 2020 2020  ._meta,.        
+000252c0: 2020 2020 290a 0a20 2020 2020 2020 2072      )..        r
+000252d0: 6574 7572 6e20 7479 7065 2873 656c 6629  eturn type(self)
+000252e0: 2867 7261 7068 2c20 6e61 6d65 2c20 6d65  (graph, name, me
+000252f0: 7461 2c20 7365 6c66 2e64 6976 6973 696f  ta, self.divisio
+00025300: 6e73 290a 0a20 2020 2040 6465 7269 7665  ns)..    @derive
+00025310: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
+00025320: 290a 2020 2020 6465 6620 6472 6f70 6e61  ).    def dropna
+00025330: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00025340: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
+00025350: 7061 7274 6974 696f 6e73 284d 2e64 726f  partitions(M.dro
+00025360: 706e 612c 2065 6e66 6f72 6365 5f6d 6574  pna, enforce_met
+00025370: 6164 6174 613d 4661 6c73 6529 0a0a 2020  adata=False)..  
+00025380: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00025390: 7064 2e53 6572 6965 7329 0a20 2020 2064  pd.Series).    d
+000253a0: 6566 2062 6574 7765 656e 2873 656c 662c  ef between(self,
+000253b0: 206c 6566 742c 2072 6967 6874 2c20 696e   left, right, in
+000253c0: 636c 7573 6976 653d 2262 6f74 6822 293a  clusive="both"):
+000253d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000253e0: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
+000253f0: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
+00025400: 204d 2e62 6574 7765 656e 2c20 6c65 6674   M.between, left
+00025410: 3d6c 6566 742c 2072 6967 6874 3d72 6967  =left, right=rig
+00025420: 6874 2c20 696e 636c 7573 6976 653d 696e  ht, inclusive=in
+00025430: 636c 7573 6976 650a 2020 2020 2020 2020  clusive.        
+00025440: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00025450: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
+00025460: 2020 2020 6465 6620 636c 6970 2873 656c      def clip(sel
+00025470: 662c 206c 6f77 6572 3d4e 6f6e 652c 2075  f, lower=None, u
+00025480: 7070 6572 3d4e 6f6e 652c 206f 7574 3d4e  pper=None, out=N
+00025490: 6f6e 6529 3a0a 2020 2020 2020 2020 6966  one):.        if
+000254a0: 206f 7574 2069 7320 6e6f 7420 4e6f 6e65   out is not None
+000254b0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+000254c0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+000254d0: 276f 7574 2720 6d75 7374 2062 6520 4e6f  'out' must be No
+000254e0: 6e65 2229 0a20 2020 2020 2020 2023 206e  ne").        # n
+000254f0: 702e 636c 6970 206d 6179 2070 6173 7320  p.clip may pass 
+00025500: 6f75 740a 2020 2020 2020 2020 7265 7475  out.        retu
+00025510: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
+00025520: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
+00025530: 2020 2020 4d2e 636c 6970 2c20 6c6f 7765      M.clip, lowe
+00025540: 723d 6c6f 7765 722c 2075 7070 6572 3d75  r=lower, upper=u
+00025550: 7070 6572 2c20 656e 666f 7263 655f 6d65  pper, enforce_me
+00025560: 7461 6461 7461 3d46 616c 7365 0a20 2020  tadata=False.   
+00025570: 2020 2020 2029 0a0a 2020 2020 4064 6572       )..    @der
+00025580: 6976 6564 5f66 726f 6d28 7064 2e53 6572  ived_from(pd.Ser
+00025590: 6965 7329 0a20 2020 2064 6566 2061 6c69  ies).    def ali
+000255a0: 676e 2873 656c 662c 206f 7468 6572 2c20  gn(self, other, 
+000255b0: 6a6f 696e 3d22 6f75 7465 7222 2c20 6178  join="outer", ax
+000255c0: 6973 3d4e 6f6e 652c 2066 696c 6c5f 7661  is=None, fill_va
+000255d0: 6c75 653d 4e6f 6e65 293a 0a20 2020 2020  lue=None):.     
+000255e0: 2020 2072 6574 7572 6e20 7375 7065 7228     return super(
+000255f0: 292e 616c 6967 6e28 6f74 6865 722c 206a  ).align(other, j
+00025600: 6f69 6e3d 6a6f 696e 2c20 6178 6973 3d61  oin=join, axis=a
+00025610: 7869 732c 2066 696c 6c5f 7661 6c75 653d  xis, fill_value=
+00025620: 6669 6c6c 5f76 616c 7565 290a 0a20 2020  fill_value)..   
+00025630: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+00025640: 642e 5365 7269 6573 290a 2020 2020 6465  d.Series).    de
+00025650: 6620 636f 6d62 696e 6528 7365 6c66 2c20  f combine(self, 
+00025660: 6f74 6865 722c 2066 756e 632c 2066 696c  other, func, fil
+00025670: 6c5f 7661 6c75 653d 4e6f 6e65 293a 0a20  l_value=None):. 
+00025680: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00025690: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+000256a0: 7328 4d2e 636f 6d62 696e 652c 206f 7468  s(M.combine, oth
+000256b0: 6572 2c20 6675 6e63 2c20 6669 6c6c 5f76  er, func, fill_v
+000256c0: 616c 7565 3d66 696c 6c5f 7661 6c75 6529  alue=fill_value)
+000256d0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+000256e0: 726f 6d28 7064 2e53 6572 6965 7329 0a20  rom(pd.Series). 
+000256f0: 2020 2064 6566 2073 7175 6565 7a65 2873     def squeeze(s
+00025700: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00025710: 7475 726e 2073 656c 660a 0a20 2020 2040  turn self..    @
+00025720: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+00025730: 5365 7269 6573 290a 2020 2020 6465 6620  Series).    def 
+00025740: 636f 6d62 696e 655f 6669 7273 7428 7365  combine_first(se
+00025750: 6c66 2c20 6f74 6865 7229 3a0a 2020 2020  lf, other):.    
+00025760: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00025770: 6d61 705f 7061 7274 6974 696f 6e73 284d  map_partitions(M
+00025780: 2e63 6f6d 6269 6e65 5f66 6972 7374 2c20  .combine_first, 
+00025790: 6f74 6865 7229 0a0a 2020 2020 6465 6620  other)..    def 
+000257a0: 746f 5f62 6167 2873 656c 662c 2069 6e64  to_bag(self, ind
+000257b0: 6578 3d46 616c 7365 2c20 666f 726d 6174  ex=False, format
+000257c0: 3d22 7475 706c 6522 293a 0a20 2020 2020  ="tuple"):.     
+000257d0: 2020 2022 2222 4372 6561 7465 2061 2044     """Create a D
+000257e0: 6173 6b20 4261 6720 6672 6f6d 2061 2053  ask Bag from a S
+000257f0: 6572 6965 7322 2222 0a20 2020 2020 2020  eries""".       
+00025800: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
+00025810: 7261 6d65 2e69 6f20 696d 706f 7274 2074  rame.io import t
+00025820: 6f5f 6261 670a 0a20 2020 2020 2020 2072  o_bag..        r
+00025830: 6574 7572 6e20 746f 5f62 6167 2873 656c  eturn to_bag(sel
+00025840: 662c 2069 6e64 6578 2c20 666f 726d 6174  f, index, format
+00025850: 3d66 6f72 6d61 7429 0a0a 2020 2020 4064  =format)..    @d
+00025860: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+00025870: 6572 6965 7329 0a20 2020 2064 6566 2074  eries).    def t
+00025880: 6f5f 6672 616d 6528 7365 6c66 2c20 6e61  o_frame(self, na
+00025890: 6d65 3d4e 6f6e 6529 3a0a 2020 2020 2020  me=None):.      
+000258a0: 2020 6172 6773 203d 205b 5d20 6966 206e    args = [] if n
+000258b0: 616d 6520 6973 204e 6f6e 6520 656c 7365  ame is None else
+000258c0: 205b 6e61 6d65 5d0a 2020 2020 2020 2020   [name].        
+000258d0: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
+000258e0: 7061 7274 6974 696f 6e73 284d 2e74 6f5f  partitions(M.to_
+000258f0: 6672 616d 652c 202a 6172 6773 2c20 6d65  frame, *args, me
+00025900: 7461 3d73 656c 662e 5f6d 6574 612e 746f  ta=self._meta.to
+00025910: 5f66 7261 6d65 282a 6172 6773 2929 0a0a  _frame(*args))..
+00025920: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00025930: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
+00025940: 2064 6566 2074 6f5f 7374 7269 6e67 2873   def to_string(s
+00025950: 656c 662c 206d 6178 5f72 6f77 733d 3529  elf, max_rows=5)
+00025960: 3a0a 2020 2020 2020 2020 2320 6f70 7469  :.        # opti
+00025970: 6f6e 5f63 6f6e 7465 7874 2064 6f65 736e  on_context doesn
+00025980: 2774 2061 6666 6563 740a 2020 2020 2020  't affect.      
+00025990: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
+000259a0: 6570 725f 6461 7461 2829 2e74 6f5f 7374  epr_data().to_st
+000259b0: 7269 6e67 286d 6178 5f72 6f77 733d 6d61  ring(max_rows=ma
+000259c0: 785f 726f 7773 290a 0a20 2020 2040 636c  x_rows)..    @cl
+000259d0: 6173 736d 6574 686f 640a 2020 2020 6465  assmethod.    de
+000259e0: 6620 5f62 696e 645f 6f70 6572 6174 6f72  f _bind_operator
+000259f0: 5f6d 6574 686f 6428 636c 732c 206e 616d  _method(cls, nam
+00025a00: 652c 206f 702c 206f 7269 6769 6e61 6c3d  e, op, original=
+00025a10: 7064 2e53 6572 6965 7329 3a0a 2020 2020  pd.Series):.    
+00025a20: 2020 2020 2222 2262 696e 6420 6f70 6572      """bind oper
+00025a30: 6174 6f72 206d 6574 686f 6420 6c69 6b65  ator method like
+00025a40: 2053 6572 6965 732e 6164 6420 746f 2074   Series.add to t
+00025a50: 6869 7320 636c 6173 7322 2222 0a0a 2020  his class"""..  
+00025a60: 2020 2020 2020 6465 6620 6d65 7468 2873        def meth(s
+00025a70: 656c 662c 206f 7468 6572 2c20 6c65 7665  elf, other, leve
+00025a80: 6c3d 4e6f 6e65 2c20 6669 6c6c 5f76 616c  l=None, fill_val
+00025a90: 7565 3d4e 6f6e 652c 2061 7869 733d 3029  ue=None, axis=0)
+00025aa0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00025ab0: 206c 6576 656c 2069 7320 6e6f 7420 4e6f   level is not No
+00025ac0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00025ad0: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
+00025ae0: 6c65 6d65 6e74 6564 4572 726f 7228 226c  lementedError("l
+00025af0: 6576 656c 206d 7573 7420 6265 204e 6f6e  evel must be Non
+00025b00: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
+00025b10: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
+00025b20: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
+00025b30: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+00025b40: 6120 3d20 5f65 6d75 6c61 7465 286f 702c  a = _emulate(op,
+00025b50: 2073 656c 662c 206f 7468 6572 2c20 6178   self, other, ax
+00025b60: 6973 3d61 7869 732c 2066 696c 6c5f 7661  is=axis, fill_va
+00025b70: 6c75 653d 6669 6c6c 5f76 616c 7565 290a  lue=fill_value).
+00025b80: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00025b90: 726e 206d 6170 5f70 6172 7469 7469 6f6e  rn map_partition
+00025ba0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00025bb0: 2020 206f 702c 2073 656c 662c 206f 7468     op, self, oth
+00025bc0: 6572 2c20 6d65 7461 3d6d 6574 612c 2061  er, meta=meta, a
+00025bd0: 7869 733d 6178 6973 2c20 6669 6c6c 5f76  xis=axis, fill_v
+00025be0: 616c 7565 3d66 696c 6c5f 7661 6c75 650a  alue=fill_value.
+00025bf0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00025c00: 2020 2020 2020 206d 6574 682e 5f5f 6e61         meth.__na
+00025c10: 6d65 5f5f 203d 206e 616d 650a 2020 2020  me__ = name.    
+00025c20: 2020 2020 7365 7461 7474 7228 636c 732c      setattr(cls,
+00025c30: 206e 616d 652c 2064 6572 6976 6564 5f66   name, derived_f
+00025c40: 726f 6d28 6f72 6967 696e 616c 2928 6d65  rom(original)(me
+00025c50: 7468 2929 0a0a 2020 2020 4063 6c61 7373  th))..    @class
+00025c60: 6d65 7468 6f64 0a20 2020 2064 6566 205f  method.    def _
+00025c70: 6269 6e64 5f63 6f6d 7061 7269 736f 6e5f  bind_comparison_
+00025c80: 6d65 7468 6f64 2863 6c73 2c20 6e61 6d65  method(cls, name
+00025c90: 2c20 636f 6d70 6172 6973 6f6e 2c20 6f72  , comparison, or
+00025ca0: 6967 696e 616c 3d70 642e 5365 7269 6573  iginal=pd.Series
+00025cb0: 293a 0a20 2020 2020 2020 2022 2222 6269  ):.        """bi
+00025cc0: 6e64 2063 6f6d 7061 7269 736f 6e20 6d65  nd comparison me
+00025cd0: 7468 6f64 206c 696b 6520 5365 7269 6573  thod like Series
+00025ce0: 2e65 7120 746f 2074 6869 7320 636c 6173  .eq to this clas
+00025cf0: 7322 2222 0a0a 2020 2020 2020 2020 6465  s"""..        de
+00025d00: 6620 6d65 7468 2873 656c 662c 206f 7468  f meth(self, oth
+00025d10: 6572 2c20 6c65 7665 6c3d 4e6f 6e65 2c20  er, level=None, 
+00025d20: 6669 6c6c 5f76 616c 7565 3d4e 6f6e 652c  fill_value=None,
+00025d30: 2061 7869 733d 3029 3a0a 2020 2020 2020   axis=0):.      
+00025d40: 2020 2020 2020 6966 206c 6576 656c 2069        if level i
+00025d50: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00025d60: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00025d70: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+00025d80: 4572 726f 7228 226c 6576 656c 206d 7573  Error("level mus
+00025d90: 7420 6265 204e 6f6e 6522 290a 2020 2020  t be None").    
+00025da0: 2020 2020 2020 2020 6178 6973 203d 2073          axis = s
+00025db0: 656c 662e 5f76 616c 6964 6174 655f 6178  elf._validate_ax
+00025dc0: 6973 2861 7869 7329 0a20 2020 2020 2020  is(axis).       
+00025dd0: 2020 2020 2069 6620 6669 6c6c 5f76 616c       if fill_val
+00025de0: 7565 2069 7320 4e6f 6e65 3a0a 2020 2020  ue is None:.    
+00025df0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00025e00: 726e 2065 6c65 6d77 6973 6528 636f 6d70  rn elemwise(comp
+00025e10: 6172 6973 6f6e 2c20 7365 6c66 2c20 6f74  arison, self, ot
+00025e20: 6865 722c 2061 7869 733d 6178 6973 290a  her, axis=axis).
+00025e30: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00025e40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00025e50: 2020 6f70 203d 2070 6172 7469 616c 2863    op = partial(c
+00025e60: 6f6d 7061 7269 736f 6e2c 2066 696c 6c5f  omparison, fill_
+00025e70: 7661 6c75 653d 6669 6c6c 5f76 616c 7565  value=fill_value
+00025e80: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00025e90: 2020 7265 7475 726e 2065 6c65 6d77 6973    return elemwis
+00025ea0: 6528 6f70 2c20 7365 6c66 2c20 6f74 6865  e(op, self, othe
+00025eb0: 722c 2061 7869 733d 6178 6973 290a 0a20  r, axis=axis).. 
+00025ec0: 2020 2020 2020 206d 6574 682e 5f5f 6e61         meth.__na
+00025ed0: 6d65 5f5f 203d 206e 616d 650a 2020 2020  me__ = name.    
+00025ee0: 2020 2020 7365 7461 7474 7228 636c 732c      setattr(cls,
+00025ef0: 206e 616d 652c 2064 6572 6976 6564 5f66   name, derived_f
+00025f00: 726f 6d28 6f72 6967 696e 616c 2928 6d65  rom(original)(me
+00025f10: 7468 2929 0a0a 2020 2020 4069 6e73 6572  th))..    @inser
+00025f20: 745f 6d65 7461 5f70 6172 616d 5f64 6573  t_meta_param_des
+00025f30: 6372 6970 7469 6f6e 2870 6164 3d31 3229  cription(pad=12)
+00025f40: 0a20 2020 2064 6566 2061 7070 6c79 2873  .    def apply(s
+00025f50: 656c 662c 2066 756e 632c 2063 6f6e 7665  elf, func, conve
+00025f60: 7274 5f64 7479 7065 3d6e 6f5f 6465 6661  rt_dtype=no_defa
+00025f70: 756c 742c 206d 6574 613d 6e6f 5f64 6566  ult, meta=no_def
+00025f80: 6175 6c74 2c20 6172 6773 3d28 292c 202a  ault, args=(), *
+00025f90: 2a6b 7764 7329 3a0a 2020 2020 2020 2020  *kwds):.        
+00025fa0: 2222 2250 6172 616c 6c65 6c20 7665 7273  """Parallel vers
+00025fb0: 696f 6e20 6f66 2070 616e 6461 732e 5365  ion of pandas.Se
+00025fc0: 7269 6573 2e61 7070 6c79 0a0a 2020 2020  ries.apply..    
+00025fd0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00025fe0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00025ff0: 2d0a 2020 2020 2020 2020 6675 6e63 203a  -.        func :
+00026000: 2066 756e 6374 696f 6e0a 2020 2020 2020   function.      
+00026010: 2020 2020 2020 4675 6e63 7469 6f6e 2074        Function t
+00026020: 6f20 6170 706c 790a 2020 2020 2020 2020  o apply.        
+00026030: 636f 6e76 6572 745f 6474 7970 6520 3a20  convert_dtype : 
+00026040: 626f 6f6c 6561 6e2c 2064 6566 6175 6c74  boolean, default
+00026050: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+00026060: 2020 5472 7920 746f 2066 696e 6420 6265    Try to find be
+00026070: 7474 6572 2064 7479 7065 2066 6f72 2065  tter dtype for e
+00026080: 6c65 6d65 6e74 7769 7365 2066 756e 6374  lementwise funct
+00026090: 696f 6e20 7265 7375 6c74 732e 0a20 2020  ion results..   
+000260a0: 2020 2020 2020 2020 2049 6620 4661 6c73           If Fals
+000260b0: 652c 206c 6561 7665 2061 7320 6474 7970  e, leave as dtyp
+000260c0: 653d 6f62 6a65 6374 2e0a 2020 2020 2020  e=object..      
+000260d0: 2020 244d 4554 410a 2020 2020 2020 2020    $META.        
+000260e0: 6172 6773 203a 2074 7570 6c65 0a20 2020  args : tuple.   
+000260f0: 2020 2020 2020 2020 2050 6f73 6974 696f           Positio
+00026100: 6e61 6c20 6172 6775 6d65 6e74 7320 746f  nal arguments to
+00026110: 2070 6173 7320 746f 2066 756e 6374 696f   pass to functio
+00026120: 6e20 696e 2061 6464 6974 696f 6e20 746f  n in addition to
+00026130: 2074 6865 2076 616c 7565 2e0a 0a20 2020   the value...   
+00026140: 2020 2020 2041 6464 6974 696f 6e61 6c20       Additional 
+00026150: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
+00026160: 7320 7769 6c6c 2062 6520 7061 7373 6564  s will be passed
+00026170: 2061 7320 6b65 7977 6f72 6473 2074 6f20   as keywords to 
+00026180: 7468 6520 6675 6e63 7469 6f6e 2e0a 0a20  the function... 
+00026190: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
+000261a0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+000261b0: 2020 2020 2020 2061 7070 6c69 6564 203a         applied :
+000261c0: 2053 6572 6965 7320 6f72 2044 6174 6146   Series or DataF
+000261d0: 7261 6d65 2069 6620 6675 6e63 2072 6574  rame if func ret
+000261e0: 7572 6e73 2061 2053 6572 6965 732e 0a0a  urns a Series...
+000261f0: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+00026200: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00026210: 2d0a 2020 2020 2020 2020 3e3e 3e20 696d  -.        >>> im
+00026220: 706f 7274 2064 6173 6b2e 6461 7461 6672  port dask.datafr
+00026230: 616d 6520 6173 2064 640a 2020 2020 2020  ame as dd.      
+00026240: 2020 3e3e 3e20 7320 3d20 7064 2e53 6572    >>> s = pd.Ser
+00026250: 6965 7328 7261 6e67 6528 3529 2c20 6e61  ies(range(5), na
+00026260: 6d65 3d27 7827 290a 2020 2020 2020 2020  me='x').        
+00026270: 3e3e 3e20 6473 203d 2064 642e 6672 6f6d  >>> ds = dd.from
+00026280: 5f70 616e 6461 7328 732c 206e 7061 7274  _pandas(s, npart
+00026290: 6974 696f 6e73 3d32 290a 0a20 2020 2020  itions=2)..     
+000262a0: 2020 2041 7070 6c79 2061 2066 756e 6374     Apply a funct
+000262b0: 696f 6e20 656c 656d 656e 7477 6973 6520  ion elementwise 
+000262c0: 6163 726f 7373 2074 6865 2053 6572 6965  across the Serie
+000262d0: 732c 2070 6173 7369 6e67 2069 6e20 6578  s, passing in ex
+000262e0: 7472 610a 2020 2020 2020 2020 6172 6775  tra.        argu
+000262f0: 6d65 6e74 7320 696e 2060 6061 7267 7360  ments in ``args`
+00026300: 6020 616e 6420 6060 6b77 6172 6773 6060  ` and ``kwargs``
+00026310: 3a0a 0a20 2020 2020 2020 203e 3e3e 2064  :..        >>> d
+00026320: 6566 206d 7961 6464 2878 2c20 612c 2062  ef myadd(x, a, b
+00026330: 3d31 293a 0a20 2020 2020 2020 202e 2e2e  =1):.        ...
+00026340: 2020 2020 2072 6574 7572 6e20 7820 2b20       return x + 
+00026350: 6120 2b20 620a 2020 2020 2020 2020 3e3e  a + b.        >>
+00026360: 3e20 7265 7320 3d20 6473 2e61 7070 6c79  > res = ds.apply
+00026370: 286d 7961 6464 2c20 6172 6773 3d28 322c  (myadd, args=(2,
+00026380: 292c 2062 3d31 2e35 2920 2023 2064 6f63  ), b=1.5)  # doc
+00026390: 7465 7374 3a20 2b53 4b49 500a 0a20 2020  test: +SKIP..   
+000263a0: 2020 2020 2042 7920 6465 6661 756c 742c       By default,
+000263b0: 2064 6173 6b20 7472 6965 7320 746f 2069   dask tries to i
+000263c0: 6e66 6572 2074 6865 206f 7574 7075 7420  nfer the output 
+000263d0: 6d65 7461 6461 7461 2062 7920 7275 6e6e  metadata by runn
+000263e0: 696e 6720 796f 7572 0a20 2020 2020 2020  ing your.       
+000263f0: 2070 726f 7669 6465 6420 6675 6e63 7469   provided functi
+00026400: 6f6e 206f 6e20 736f 6d65 2066 616b 6520  on on some fake 
+00026410: 6461 7461 2e20 5468 6973 2077 6f72 6b73  data. This works
+00026420: 2077 656c 6c20 696e 206d 616e 7920 6361   well in many ca
+00026430: 7365 732c 2062 7574 0a20 2020 2020 2020  ses, but.       
+00026440: 2063 616e 2073 6f6d 6574 696d 6573 2062   can sometimes b
+00026450: 6520 6578 7065 6e73 6976 652c 206f 7220  e expensive, or 
+00026460: 6576 656e 2066 6169 6c2e 2054 6f20 6176  even fail. To av
+00026470: 6f69 6420 7468 6973 2c20 796f 7520 6361  oid this, you ca
+00026480: 6e0a 2020 2020 2020 2020 6d61 6e75 616c  n.        manual
+00026490: 6c79 2073 7065 6369 6679 2074 6865 206f  ly specify the o
+000264a0: 7574 7075 7420 6d65 7461 6461 7461 2077  utput metadata w
+000264b0: 6974 6820 7468 6520 6060 6d65 7461 6060  ith the ``meta``
+000264c0: 206b 6579 776f 7264 2e20 5468 6973 0a20   keyword. This. 
+000264d0: 2020 2020 2020 2063 616e 2062 6520 7370         can be sp
+000264e0: 6563 6966 6965 6420 696e 206d 616e 7920  ecified in many 
+000264f0: 666f 726d 732c 2066 6f72 206d 6f72 6520  forms, for more 
+00026500: 696e 666f 726d 6174 696f 6e20 7365 650a  information see.
+00026510: 2020 2020 2020 2020 6060 6461 736b 2e64          ``dask.d
+00026520: 6174 6166 7261 6d65 2e75 7469 6c73 2e6d  ataframe.utils.m
+00026530: 616b 655f 6d65 7461 6060 2e0a 0a20 2020  ake_meta``...   
+00026540: 2020 2020 2048 6572 6520 7765 2073 7065       Here we spe
+00026550: 6369 6679 2074 6865 206f 7574 7075 7420  cify the output 
+00026560: 6973 2061 2053 6572 6965 7320 7769 7468  is a Series with
+00026570: 206e 616d 6520 6060 2778 2760 602c 2061   name ``'x'``, a
+00026580: 6e64 2064 7479 7065 0a20 2020 2020 2020  nd dtype.       
+00026590: 2060 6066 6c6f 6174 3634 6060 3a0a 0a20   ``float64``:.. 
+000265a0: 2020 2020 2020 203e 3e3e 2072 6573 203d         >>> res =
+000265b0: 2064 732e 6170 706c 7928 6d79 6164 642c   ds.apply(myadd,
+000265c0: 2061 7267 733d 2832 2c29 2c20 623d 312e   args=(2,), b=1.
+000265d0: 352c 206d 6574 613d 2827 7827 2c20 2766  5, meta=('x', 'f
+000265e0: 3827 2929 0a0a 2020 2020 2020 2020 496e  8'))..        In
+000265f0: 2074 6865 2063 6173 6520 7768 6572 6520   the case where 
+00026600: 7468 6520 6d65 7461 6461 7461 2064 6f65  the metadata doe
+00026610: 736e 2774 2063 6861 6e67 652c 2079 6f75  sn't change, you
+00026620: 2063 616e 2061 6c73 6f20 7061 7373 2069   can also pass i
+00026630: 6e0a 2020 2020 2020 2020 7468 6520 6f62  n.        the ob
+00026640: 6a65 6374 2069 7473 656c 6620 6469 7265  ject itself dire
+00026650: 6374 6c79 3a0a 0a20 2020 2020 2020 203e  ctly:..        >
+00026660: 3e3e 2072 6573 203d 2064 732e 6170 706c  >> res = ds.appl
+00026670: 7928 6c61 6d62 6461 2078 3a20 7820 2b20  y(lambda x: x + 
+00026680: 312c 206d 6574 613d 6473 290a 0a20 2020  1, meta=ds)..   
+00026690: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
+000266a0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+000266b0: 2020 2020 2020 2064 6173 6b2e 5365 7269         dask.Seri
+000266c0: 6573 2e6d 6170 5f70 6172 7469 7469 6f6e  es.map_partition
+000266d0: 730a 2020 2020 2020 2020 2222 220a 2020  s.        """.  
+000266e0: 2020 2020 2020 6966 2063 6f6e 7665 7274        if convert
+000266f0: 5f64 7479 7065 2069 7320 6e6f 7420 6e6f  _dtype is not no
+00026700: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
+00026710: 2020 2020 2020 6b77 6473 5b22 636f 6e76        kwds["conv
+00026720: 6572 745f 6474 7970 6522 5d20 3d20 636f  ert_dtype"] = co
+00026730: 6e76 6572 745f 6474 7970 650a 0a20 2020  nvert_dtype..   
+00026740: 2020 2020 2023 206c 6574 2070 616e 6461       # let panda
+00026750: 7320 7472 6967 6765 7220 616e 7920 7761  s trigger any wa
+00026760: 726e 696e 6773 2c20 7375 6368 2061 7320  rnings, such as 
+00026770: 636f 6e76 6572 745f 6474 7970 6520 7761  convert_dtype wa
+00026780: 726e 696e 670a 2020 2020 2020 2020 7365  rning.        se
+00026790: 6c66 2e5f 6d65 7461 2e61 7070 6c79 2866  lf._meta.apply(f
+000267a0: 756e 632c 2061 7267 733d 6172 6773 2c20  unc, args=args, 
+000267b0: 2a2a 6b77 6473 290a 0a20 2020 2020 2020  **kwds)..       
+000267c0: 2069 6620 6d65 7461 2069 7320 6e6f 5f64   if meta is no_d
+000267d0: 6566 6175 6c74 3a0a 2020 2020 2020 2020  efault:.        
+000267e0: 2020 2020 7769 7468 2063 6865 636b 5f63      with check_c
+000267f0: 6f6e 7665 7274 5f64 7479 7065 5f64 6570  onvert_dtype_dep
+00026800: 7265 6361 7469 6f6e 2829 3a0a 2020 2020  recation():.    
+00026810: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+00026820: 203d 205f 656d 756c 6174 6528 0a20 2020   = _emulate(.   
+00026830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026840: 204d 2e61 7070 6c79 2c20 7365 6c66 2e5f   M.apply, self._
+00026850: 6d65 7461 5f6e 6f6e 656d 7074 792c 2066  meta_nonempty, f
+00026860: 756e 632c 2061 7267 733d 6172 6773 2c20  unc, args=args, 
+00026870: 7564 663d 5472 7565 2c20 2a2a 6b77 6473  udf=True, **kwds
+00026880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026890: 2029 0a20 2020 2020 2020 2020 2020 2077   ).            w
+000268a0: 6172 6e69 6e67 732e 7761 726e 286d 6574  arnings.warn(met
+000268b0: 615f 7761 726e 696e 6728 6d65 7461 2929  a_warning(meta))
+000268c0: 0a20 2020 2020 2020 2065 6c69 6620 5041  .        elif PA
+000268d0: 4e44 4153 5f47 545f 3231 303a 0a20 2020  NDAS_GT_210:.   
+000268e0: 2020 2020 2020 2020 2074 6573 745f 6d65           test_me
+000268f0: 7461 203d 206d 616b 655f 6d65 7461 286d  ta = make_meta(m
+00026900: 6574 6129 0a20 2020 2020 2020 2020 2020  eta).           
+00026910: 2069 6620 6973 5f64 6174 6166 7261 6d65   if is_dataframe
+00026920: 5f6c 696b 6528 7465 7374 5f6d 6574 6129  _like(test_meta)
+00026930: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00026940: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+00026950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026960: 2020 2020 2022 5265 7475 726e 696e 6720       "Returning 
+00026970: 6120 4461 7461 4672 616d 6520 6672 6f6d  a DataFrame from
+00026980: 2053 6572 6965 732e 6170 706c 7920 7768   Series.apply wh
+00026990: 656e 2074 6865 2073 7570 706c 6965 6420  en the supplied 
+000269a0: 6675 6e63 7469 6f6e 2022 0a20 2020 2020  function ".     
+000269b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000269c0: 7265 7475 726e 7320 6120 5365 7269 6573  returns a Series
+000269d0: 2069 7320 6465 7072 6563 6174 6564 2061   is deprecated a
+000269e0: 6e64 2077 696c 6c20 6265 2072 656d 6f76  nd will be remov
+000269f0: 6564 2069 6e20 6120 6675 7475 7265 2076  ed in a future v
+00026a00: 6572 7369 6f6e 2e22 2c0a 2020 2020 2020  ersion.",.      
+00026a10: 2020 2020 2020 2020 2020 2020 2020 4675                Fu
+00026a20: 7475 7265 5761 726e 696e 672c 0a20 2020  tureWarning,.   
+00026a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026a40: 2073 7461 636b 6c65 7665 6c3d 322c 0a20   stacklevel=2,. 
+00026a50: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00026a60: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00026a70: 206d 6170 5f70 6172 7469 7469 6f6e 7328   map_partitions(
+00026a80: 6d65 7468 6f64 732e 6170 706c 792c 2073  methods.apply, s
+00026a90: 656c 662c 2066 756e 632c 2061 7267 733d  elf, func, args=
+00026aa0: 6172 6773 2c20 6d65 7461 3d6d 6574 612c  args, meta=meta,
+00026ab0: 202a 2a6b 7764 7329 0a0a 2020 2020 4064   **kwds)..    @d
+00026ac0: 6572 6976 6564 5f66 726f 6d28 7064 2e53  erived_from(pd.S
+00026ad0: 6572 6965 7329 0a20 2020 2064 6566 2063  eries).    def c
+00026ae0: 6f76 2873 656c 662c 206f 7468 6572 2c20  ov(self, other, 
+00026af0: 6d69 6e5f 7065 7269 6f64 733d 4e6f 6e65  min_periods=None
+00026b00: 2c20 7370 6c69 745f 6576 6572 793d 4661  , split_every=Fa
+00026b10: 6c73 6529 3a0a 2020 2020 2020 2020 6672  lse):.        fr
+00026b20: 6f6d 2064 6173 6b2e 6461 7461 6672 616d  om dask.datafram
+00026b30: 652e 6d75 6c74 6920 696d 706f 7274 2063  e.multi import c
+00026b40: 6f6e 6361 740a 0a20 2020 2020 2020 2069  oncat..        i
+00026b50: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+00026b60: 286f 7468 6572 2c20 5365 7269 6573 293a  (other, Series):
+00026b70: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00026b80: 7365 2054 7970 6545 7272 6f72 2822 6f74  se TypeError("ot
+00026b90: 6865 7220 6d75 7374 2062 6520 6120 6461  her must be a da
+00026ba0: 736b 2e64 6174 6166 7261 6d65 2e53 6572  sk.dataframe.Ser
+00026bb0: 6965 7322 290a 2020 2020 2020 2020 6466  ies").        df
+00026bc0: 203d 2063 6f6e 6361 7428 5b73 656c 662c   = concat([self,
+00026bd0: 206f 7468 6572 5d2c 2061 7869 733d 3129   other], axis=1)
+00026be0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00026bf0: 5f63 6f76 5f63 6f72 7228 0a20 2020 2020  _cov_corr(.     
+00026c00: 2020 2020 2020 2064 662c 206d 696e 5f70         df, min_p
+00026c10: 6572 696f 6473 2c20 7363 616c 6172 3d54  eriods, scalar=T
+00026c20: 7275 652c 206e 756d 6572 6963 5f6f 6e6c  rue, numeric_onl
+00026c30: 793d 4661 6c73 652c 2073 706c 6974 5f65  y=False, split_e
+00026c40: 7665 7279 3d73 706c 6974 5f65 7665 7279  very=split_every
+00026c50: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00026c60: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+00026c70: 2e53 6572 6965 7329 0a20 2020 2064 6566  .Series).    def
+00026c80: 2063 6f72 7228 7365 6c66 2c20 6f74 6865   corr(self, othe
+00026c90: 722c 206d 6574 686f 643d 2270 6561 7273  r, method="pears
+00026ca0: 6f6e 222c 206d 696e 5f70 6572 696f 6473  on", min_periods
+00026cb0: 3d4e 6f6e 652c 2073 706c 6974 5f65 7665  =None, split_eve
+00026cc0: 7279 3d46 616c 7365 293a 0a20 2020 2020  ry=False):.     
+00026cd0: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
+00026ce0: 6166 7261 6d65 2e6d 756c 7469 2069 6d70  aframe.multi imp
+00026cf0: 6f72 7420 636f 6e63 6174 0a0a 2020 2020  ort concat..    
+00026d00: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00026d10: 7461 6e63 6528 6f74 6865 722c 2053 6572  tance(other, Ser
+00026d20: 6965 7329 3a0a 2020 2020 2020 2020 2020  ies):.          
+00026d30: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00026d40: 7228 226f 7468 6572 206d 7573 7420 6265  r("other must be
+00026d50: 2061 2064 6173 6b2e 6461 7461 6672 616d   a dask.datafram
+00026d60: 652e 5365 7269 6573 2229 0a20 2020 2020  e.Series").     
+00026d70: 2020 2069 6620 6d65 7468 6f64 2021 3d20     if method != 
+00026d80: 2270 6561 7273 6f6e 223a 0a20 2020 2020  "pearson":.     
+00026d90: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+00026da0: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+00026db0: 2822 4f6e 6c79 2050 6561 7273 6f6e 2063  ("Only Pearson c
+00026dc0: 6f72 7265 6c61 7469 6f6e 2068 6173 2062  orrelation has b
+00026dd0: 6565 6e20 696d 706c 656d 656e 7465 6422  een implemented"
+00026de0: 290a 2020 2020 2020 2020 6466 203d 2063  ).        df = c
+00026df0: 6f6e 6361 7428 5b73 656c 662c 206f 7468  oncat([self, oth
+00026e00: 6572 5d2c 2061 7869 733d 3129 0a20 2020  er], axis=1).   
+00026e10: 2020 2020 2072 6574 7572 6e20 5f63 6f76       return _cov
+00026e20: 5f63 6f72 7228 0a20 2020 2020 2020 2020  _corr(.         
+00026e30: 2020 2064 662c 0a20 2020 2020 2020 2020     df,.         
+00026e40: 2020 206d 696e 5f70 6572 696f 6473 2c0a     min_periods,.
+00026e50: 2020 2020 2020 2020 2020 2020 636f 7272              corr
+00026e60: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
+00026e70: 2020 2073 6361 6c61 723d 5472 7565 2c0a     scalar=True,.
+00026e80: 2020 2020 2020 2020 2020 2020 6e75 6d65              nume
+00026e90: 7269 635f 6f6e 6c79 3d46 616c 7365 2c0a  ric_only=False,.
+00026ea0: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
+00026eb0: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
+00026ec0: 6572 792c 0a20 2020 2020 2020 2029 0a0a  ery,.        )..
+00026ed0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00026ee0: 6d28 7064 2e53 6572 6965 7329 0a20 2020  m(pd.Series).   
+00026ef0: 2064 6566 2061 7574 6f63 6f72 7228 7365   def autocorr(se
+00026f00: 6c66 2c20 6c61 673d 312c 2073 706c 6974  lf, lag=1, split
+00026f10: 5f65 7665 7279 3d46 616c 7365 293a 0a20  _every=False):. 
+00026f20: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+00026f30: 696e 7374 616e 6365 286c 6167 2c20 496e  instance(lag, In
+00026f40: 7465 6772 616c 293a 0a20 2020 2020 2020  tegral):.       
+00026f50: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00026f60: 7272 6f72 2822 6c61 6720 6d75 7374 2062  rror("lag must b
+00026f70: 6520 616e 2069 6e74 6567 6572 2229 0a20  e an integer"). 
+00026f80: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00026f90: 6c66 2e63 6f72 7228 7365 6c66 2069 6620  lf.corr(self if 
+00026fa0: 6c61 6720 3d3d 2030 2065 6c73 6520 7365  lag == 0 else se
+00026fb0: 6c66 2e73 6869 6674 286c 6167 292c 2073  lf.shift(lag), s
+00026fc0: 706c 6974 5f65 7665 7279 3d73 706c 6974  plit_every=split
+00026fd0: 5f65 7665 7279 290a 0a20 2020 2040 6465  _every)..    @de
+00026fe0: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
+00026ff0: 7269 6573 290a 2020 2020 6465 6620 6d65  ries).    def me
+00027000: 6d6f 7279 5f75 7361 6765 2873 656c 662c  mory_usage(self,
+00027010: 2069 6e64 6578 3d54 7275 652c 2064 6565   index=True, dee
+00027020: 703d 4661 6c73 6529 3a0a 2020 2020 2020  p=False):.      
+00027030: 2020 7265 7475 726e 2073 656c 662e 7265    return self.re
+00027040: 6475 6374 696f 6e28 0a20 2020 2020 2020  duction(.       
+00027050: 2020 2020 204d 2e6d 656d 6f72 795f 7573       M.memory_us
+00027060: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
+00027070: 204d 2e73 756d 2c0a 2020 2020 2020 2020   M.sum,.        
+00027080: 2020 2020 6368 756e 6b5f 6b77 6172 6773      chunk_kwargs
+00027090: 3d7b 2269 6e64 6578 223a 2069 6e64 6578  ={"index": index
+000270a0: 2c20 2264 6565 7022 3a20 6465 6570 7d2c  , "deep": deep},
+000270b0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+000270c0: 6974 5f65 7665 7279 3d46 616c 7365 2c0a  it_every=False,.
+000270d0: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
+000270e0: 6e3d 7365 6c66 2e5f 746f 6b65 6e5f 7072  n=self._token_pr
+000270f0: 6566 6978 202b 2022 6d65 6d6f 7279 2d75  efix + "memory-u
+00027100: 7361 6765 222c 0a20 2020 2020 2020 2029  sage",.        )
+00027110: 0a0a 2020 2020 6465 6620 5f5f 6469 766d  ..    def __divm
+00027120: 6f64 5f5f 2873 656c 662c 206f 7468 6572  od__(self, other
+00027130: 293a 0a20 2020 2020 2020 2072 6573 3120  ):.        res1 
+00027140: 3d20 7365 6c66 202f 2f20 6f74 6865 720a  = self // other.
+00027150: 2020 2020 2020 2020 7265 7332 203d 2073          res2 = s
+00027160: 656c 6620 2520 6f74 6865 720a 2020 2020  elf % other.    
+00027170: 2020 2020 7265 7475 726e 2072 6573 312c      return res1,
+00027180: 2072 6573 320a 0a20 2020 2064 6566 205f   res2..    def _
+00027190: 5f72 6469 766d 6f64 5f5f 2873 656c 662c  _rdivmod__(self,
+000271a0: 206f 7468 6572 293a 0a20 2020 2020 2020   other):.       
+000271b0: 2072 6573 3120 3d20 6f74 6865 7220 2f2f   res1 = other //
+000271c0: 2073 656c 660a 2020 2020 2020 2020 7265   self.        re
+000271d0: 7332 203d 206f 7468 6572 2025 2073 656c  s2 = other % sel
+000271e0: 660a 2020 2020 2020 2020 7265 7475 726e  f.        return
+000271f0: 2072 6573 312c 2072 6573 320a 0a20 2020   res1, res2..   
+00027200: 2069 6620 6e6f 7420 5041 4e44 4153 5f47   if not PANDAS_G
+00027210: 545f 3230 303a 0a0a 2020 2020 2020 2020  T_200:..        
+00027220: 4070 726f 7065 7274 790a 2020 2020 2020  @property.      
+00027230: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+00027240: 7064 2e53 6572 6965 7329 0a20 2020 2020  pd.Series).     
+00027250: 2020 2064 6566 2069 735f 6d6f 6e6f 746f     def is_monoto
+00027260: 6e69 6328 7365 6c66 293a 0a20 2020 2020  nic(self):.     
+00027270: 2020 2020 2020 2069 6620 5041 4e44 4153         if PANDAS
+00027280: 5f47 545f 3135 303a 0a20 2020 2020 2020  _GT_150:.       
+00027290: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
+000272a0: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
+000272b0: 2020 2020 2020 2020 2020 2020 2269 735f              "is_
+000272c0: 6d6f 6e6f 746f 6e69 6320 6973 2064 6570  monotonic is dep
+000272d0: 7265 6361 7465 6420 616e 6420 7769 6c6c  recated and will
+000272e0: 2062 6520 7265 6d6f 7665 6420 696e 2061   be removed in a
+000272f0: 2066 7574 7572 6520 7665 7273 696f 6e2e   future version.
+00027300: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+00027310: 2020 2020 2020 2022 5573 6520 6973 5f6d         "Use is_m
+00027320: 6f6e 6f74 6f6e 6963 5f69 6e63 7265 6173  onotonic_increas
+00027330: 696e 6720 696e 7374 6561 642e 222c 0a20  ing instead.",. 
+00027340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027350: 2020 2046 7574 7572 6557 6172 6e69 6e67     FutureWarning
+00027360: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00027370: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00027380: 7265 7475 726e 2073 656c 662e 6973 5f6d  return self.is_m
+00027390: 6f6e 6f74 6f6e 6963 5f69 6e63 7265 6173  onotonic_increas
+000273a0: 696e 670a 0a20 2020 2040 7072 6f70 6572  ing..    @proper
+000273b0: 7479 0a20 2020 2040 6465 7269 7665 645f  ty.    @derived_
+000273c0: 6672 6f6d 2870 642e 5365 7269 6573 290a  from(pd.Series).
+000273d0: 2020 2020 6465 6620 6973 5f6d 6f6e 6f74      def is_monot
+000273e0: 6f6e 6963 5f69 6e63 7265 6173 696e 6728  onic_increasing(
+000273f0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00027400: 6574 7572 6e20 6163 6128 0a20 2020 2020  eturn aca(.     
+00027410: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00027420: 2020 2020 2020 2020 2063 6875 6e6b 3d6d           chunk=m
+00027430: 6574 686f 6473 2e6d 6f6e 6f74 6f6e 6963  ethods.monotonic
+00027440: 5f69 6e63 7265 6173 696e 675f 6368 756e  _increasing_chun
+00027450: 6b2c 0a20 2020 2020 2020 2020 2020 2063  k,.            c
+00027460: 6f6d 6269 6e65 3d6d 6574 686f 6473 2e6d  ombine=methods.m
+00027470: 6f6e 6f74 6f6e 6963 5f69 6e63 7265 6173  onotonic_increas
+00027480: 696e 675f 636f 6d62 696e 652c 0a20 2020  ing_combine,.   
+00027490: 2020 2020 2020 2020 2061 6767 7265 6761           aggrega
+000274a0: 7465 3d6d 6574 686f 6473 2e6d 6f6e 6f74  te=methods.monot
+000274b0: 6f6e 6963 5f69 6e63 7265 6173 696e 675f  onic_increasing_
+000274c0: 6167 6772 6567 6174 652c 0a20 2020 2020  aggregate,.     
+000274d0: 2020 2020 2020 206d 6574 613d 626f 6f6c         meta=bool
+000274e0: 2c0a 2020 2020 2020 2020 2020 2020 746f  ,.            to
+000274f0: 6b65 6e3d 226d 6f6e 6f74 6f6e 6963 5f69  ken="monotonic_i
+00027500: 6e63 7265 6173 696e 6722 2c0a 2020 2020  ncreasing",.    
+00027510: 2020 2020 290a 0a20 2020 2040 7072 6f70      )..    @prop
+00027520: 6572 7479 0a20 2020 2040 6465 7269 7665  erty.    @derive
+00027530: 645f 6672 6f6d 2870 642e 5365 7269 6573  d_from(pd.Series
+00027540: 290a 2020 2020 6465 6620 6973 5f6d 6f6e  ).    def is_mon
+00027550: 6f74 6f6e 6963 5f64 6563 7265 6173 696e  otonic_decreasin
+00027560: 6728 7365 6c66 293a 0a20 2020 2020 2020  g(self):.       
+00027570: 2072 6574 7572 6e20 6163 6128 0a20 2020   return aca(.   
+00027580: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
+00027590: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
+000275a0: 3d6d 6574 686f 6473 2e6d 6f6e 6f74 6f6e  =methods.monoton
+000275b0: 6963 5f64 6563 7265 6173 696e 675f 6368  ic_decreasing_ch
+000275c0: 756e 6b2c 0a20 2020 2020 2020 2020 2020  unk,.           
+000275d0: 2063 6f6d 6269 6e65 3d6d 6574 686f 6473   combine=methods
+000275e0: 2e6d 6f6e 6f74 6f6e 6963 5f64 6563 7265  .monotonic_decre
+000275f0: 6173 696e 675f 636f 6d62 696e 652c 0a20  asing_combine,. 
+00027600: 2020 2020 2020 2020 2020 2061 6767 7265             aggre
+00027610: 6761 7465 3d6d 6574 686f 6473 2e6d 6f6e  gate=methods.mon
+00027620: 6f74 6f6e 6963 5f64 6563 7265 6173 696e  otonic_decreasin
+00027630: 675f 6167 6772 6567 6174 652c 0a20 2020  g_aggregate,.   
+00027640: 2020 2020 2020 2020 206d 6574 613d 626f           meta=bo
+00027650: 6f6c 2c0a 2020 2020 2020 2020 2020 2020  ol,.            
+00027660: 746f 6b65 6e3d 226d 6f6e 6f74 6f6e 6963  token="monotonic
+00027670: 5f64 6563 7265 6173 696e 6722 2c0a 2020  _decreasing",.  
+00027680: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
+00027690: 7269 7665 645f 6672 6f6d 2870 642e 5365  rived_from(pd.Se
+000276a0: 7269 6573 290a 2020 2020 6465 6620 7669  ries).    def vi
+000276b0: 6577 2873 656c 662c 2064 7479 7065 293a  ew(self, dtype):
+000276c0: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
+000276d0: 7365 6c66 2e5f 6d65 7461 2e76 6965 7728  self._meta.view(
+000276e0: 6474 7970 6529 0a20 2020 2020 2020 2072  dtype).        r
+000276f0: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+00027700: 6172 7469 7469 6f6e 7328 4d2e 7669 6577  artitions(M.view
+00027710: 2c20 6474 7970 652c 206d 6574 613d 6d65  , dtype, meta=me
+00027720: 7461 290a 0a0a 636c 6173 7320 496e 6465  ta)...class Inde
+00027730: 7828 5365 7269 6573 293a 0a20 2020 205f  x(Series):.    _
+00027740: 7061 7274 6974 696f 6e5f 7479 7065 203d  partition_type =
+00027750: 2070 642e 496e 6465 780a 2020 2020 5f69   pd.Index.    _i
+00027760: 735f 7061 7274 6974 696f 6e5f 7479 7065  s_partition_type
+00027770: 203d 2073 7461 7469 636d 6574 686f 6428   = staticmethod(
+00027780: 6973 5f69 6e64 6578 5f6c 696b 6529 0a20  is_index_like). 
+00027790: 2020 205f 746f 6b65 6e5f 7072 6566 6978     _token_prefix
+000277a0: 203d 2022 696e 6465 782d 220a 2020 2020   = "index-".    
+000277b0: 5f61 6363 6573 736f 7273 3a20 436c 6173  _accessors: Clas
+000277c0: 7356 6172 5b73 6574 5b73 7472 5d5d 203d  sVar[set[str]] =
+000277d0: 2073 6574 2829 0a0a 2020 2020 5f64 745f   set()..    _dt_
+000277e0: 6174 7472 6962 7574 6573 203d 207b 0a20  attributes = {. 
+000277f0: 2020 2020 2020 2022 6e61 6e6f 7365 636f         "nanoseco
+00027800: 6e64 222c 0a20 2020 2020 2020 2022 6d69  nd",.        "mi
+00027810: 6372 6f73 6563 6f6e 6422 2c0a 2020 2020  crosecond",.    
+00027820: 2020 2020 226d 696c 6c69 7365 636f 6e64      "millisecond
+00027830: 222c 0a20 2020 2020 2020 2022 6461 796f  ",.        "dayo
+00027840: 6679 6561 7222 2c0a 2020 2020 2020 2020  fyear",.        
+00027850: 226d 696e 7574 6522 2c0a 2020 2020 2020  "minute",.      
+00027860: 2020 2268 6f75 7222 2c0a 2020 2020 2020    "hour",.      
+00027870: 2020 2264 6179 222c 0a20 2020 2020 2020    "day",.       
+00027880: 2022 6461 796f 6677 6565 6b22 2c0a 2020   "dayofweek",.  
+00027890: 2020 2020 2020 2273 6563 6f6e 6422 2c0a        "second",.
+000278a0: 2020 2020 2020 2020 2277 6565 6b22 2c0a          "week",.
+000278b0: 2020 2020 2020 2020 2277 6565 6b64 6179          "weekday
+000278c0: 222c 0a20 2020 2020 2020 2022 7765 656b  ",.        "week
+000278d0: 6f66 7965 6172 222c 0a20 2020 2020 2020  ofyear",.       
+000278e0: 2022 6d6f 6e74 6822 2c0a 2020 2020 2020   "month",.      
+000278f0: 2020 2271 7561 7274 6572 222c 0a20 2020    "quarter",.   
+00027900: 2020 2020 2022 7965 6172 222c 0a20 2020       "year",.   
+00027910: 207d 0a0a 2020 2020 5f63 6174 5f61 7474   }..    _cat_att
+00027920: 7269 6275 7465 7320 3d20 7b0a 2020 2020  ributes = {.    
+00027930: 2020 2020 226b 6e6f 776e 222c 0a20 2020      "known",.   
+00027940: 2020 2020 2022 6173 5f6b 6e6f 776e 222c       "as_known",
+00027950: 0a20 2020 2020 2020 2022 6173 5f75 6e6b  .        "as_unk
+00027960: 6e6f 776e 222c 0a20 2020 2020 2020 2022  nown",.        "
+00027970: 6164 645f 6361 7465 676f 7269 6573 222c  add_categories",
+00027980: 0a20 2020 2020 2020 2022 6361 7465 676f  .        "catego
+00027990: 7269 6573 222c 0a20 2020 2020 2020 2022  ries",.        "
+000279a0: 7265 6d6f 7665 5f63 6174 6567 6f72 6965  remove_categorie
+000279b0: 7322 2c0a 2020 2020 2020 2020 2272 656f  s",.        "reo
+000279c0: 7264 6572 5f63 6174 6567 6f72 6965 7322  rder_categories"
+000279d0: 2c0a 2020 2020 2020 2020 2261 735f 6f72  ,.        "as_or
+000279e0: 6465 7265 6422 2c0a 2020 2020 2020 2020  dered",.        
+000279f0: 2263 6f64 6573 222c 0a20 2020 2020 2020  "codes",.       
+00027a00: 2022 7265 6d6f 7665 5f75 6e75 7365 645f   "remove_unused_
+00027a10: 6361 7465 676f 7269 6573 222c 0a20 2020  categories",.   
+00027a20: 2020 2020 2022 7365 745f 6361 7465 676f       "set_catego
+00027a30: 7269 6573 222c 0a20 2020 2020 2020 2022  ries",.        "
+00027a40: 6173 5f75 6e6f 7264 6572 6564 222c 0a20  as_unordered",. 
+00027a50: 2020 2020 2020 2022 6f72 6465 7265 6422         "ordered"
+00027a60: 2c0a 2020 2020 2020 2020 2272 656e 616d  ,.        "renam
+00027a70: 655f 6361 7465 676f 7269 6573 222c 0a20  e_categories",. 
+00027a80: 2020 207d 0a0a 2020 2020 5f6d 6f6e 6f74     }..    _monot
+00027a90: 6f6e 6963 5f61 7474 7269 6275 7465 7320  onic_attributes 
+00027aa0: 3d20 7b0a 2020 2020 2020 2020 2269 735f  = {.        "is_
+00027ab0: 6d6f 6e6f 746f 6e69 6322 2c0a 2020 2020  monotonic",.    
+00027ac0: 2020 2020 2269 735f 6d6f 6e6f 746f 6e69      "is_monotoni
+00027ad0: 635f 696e 6372 6561 7369 6e67 222c 0a20  c_increasing",. 
+00027ae0: 2020 2020 2020 2022 6973 5f6d 6f6e 6f74         "is_monot
+00027af0: 6f6e 6963 5f64 6563 7265 6173 696e 6722  onic_decreasing"
+00027b00: 2c0a 2020 2020 7d0a 0a20 2020 2064 6566  ,.    }..    def
+00027b10: 205f 5f67 6574 6174 7472 5f5f 2873 656c   __getattr__(sel
+00027b20: 662c 206b 6579 293a 0a20 2020 2020 2020  f, key):.       
+00027b30: 2069 6620 280a 2020 2020 2020 2020 2020   if (.          
+00027b40: 2020 6973 696e 7374 616e 6365 2873 656c    isinstance(sel
+00027b50: 662e 5f6d 6574 612e 6474 7970 652c 2070  f._meta.dtype, p
+00027b60: 642e 4361 7465 676f 7269 6361 6c44 7479  d.CategoricalDty
+00027b70: 7065 290a 2020 2020 2020 2020 2020 2020  pe).            
+00027b80: 616e 6420 6b65 7920 696e 2073 656c 662e  and key in self.
+00027b90: 5f63 6174 5f61 7474 7269 6275 7465 730a  _cat_attributes.
+00027ba0: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
 00027bb0: 2020 2020 2020 2072 6574 7572 6e20 6765         return ge
-00027bc0: 7461 7474 7228 7365 6c66 2c20 6b65 7929  tattr(self, key)
-00027bd0: 0a20 2020 2020 2020 2072 6169 7365 2041  .        raise A
-00027be0: 7474 7269 6275 7465 4572 726f 7228 2227  ttributeError("'
-00027bf0: 496e 6465 7827 206f 626a 6563 7420 6861  Index' object ha
-00027c00: 7320 6e6f 2061 7474 7269 6275 7465 2025  s no attribute %
-00027c10: 7222 2025 206b 6579 290a 0a20 2020 2064  r" % key)..    d
-00027c20: 6566 205f 5f64 6972 5f5f 2873 656c 6629  ef __dir__(self)
-00027c30: 3a0a 2020 2020 2020 2020 6f75 7420 3d20  :.        out = 
-00027c40: 7375 7065 7228 292e 5f5f 6469 725f 5f28  super().__dir__(
-00027c50: 290a 2020 2020 2020 2020 6f75 742e 6578  ).        out.ex
-00027c60: 7465 6e64 2873 656c 662e 5f64 745f 6174  tend(self._dt_at
-00027c70: 7472 6962 7574 6573 290a 2020 2020 2020  tributes).      
-00027c80: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00027c90: 7365 6c66 2e64 7479 7065 2c20 7064 2e43  self.dtype, pd.C
-00027ca0: 6174 6567 6f72 6963 616c 4474 7970 6529  ategoricalDtype)
-00027cb0: 3a0a 2020 2020 2020 2020 2020 2020 6f75  :.            ou
-00027cc0: 742e 6578 7465 6e64 2873 656c 662e 5f63  t.extend(self._c
-00027cd0: 6174 5f61 7474 7269 6275 7465 7329 0a20  at_attributes). 
-00027ce0: 2020 2020 2020 2072 6574 7572 6e20 6f75         return ou
-00027cf0: 740a 0a20 2020 2023 2054 7970 696e 673a  t..    # Typing:
-00027d00: 2068 7474 7073 3a2f 2f67 6974 6875 622e   https://github.
-00027d10: 636f 6d2f 7079 7468 6f6e 2f6d 7970 792f  com/python/mypy/
-00027d20: 6973 7375 6573 2f34 3132 350a 2020 2020  issues/4125.    
-00027d30: 4070 726f 7065 7274 7920 2023 2074 7970  @property  # typ
-00027d40: 653a 2069 676e 6f72 650a 2020 2020 6465  e: ignore.    de
-00027d50: 6620 696e 6465 7828 7365 6c66 293a 0a20  f index(self):. 
-00027d60: 2020 2020 2020 2072 6169 7365 2041 7474         raise Att
-00027d70: 7269 6275 7465 4572 726f 7228 0a20 2020  ributeError(.   
-00027d80: 2020 2020 2020 2020 2066 227b 7365 6c66           f"{self
-00027d90: 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e 616d  .__class__.__nam
-00027da0: 655f 5f21 727d 206f 626a 6563 7420 6861  e__!r} object ha
-00027db0: 7320 6e6f 2061 7474 7269 6275 7465 2027  s no attribute '
-00027dc0: 696e 6465 7827 220a 2020 2020 2020 2020  index'".        
-00027dd0: 290a 0a20 2020 2064 6566 205f 5f61 7272  )..    def __arr
-00027de0: 6179 5f77 7261 705f 5f28 7365 6c66 2c20  ay_wrap__(self, 
-00027df0: 6172 7261 792c 2063 6f6e 7465 7874 3d4e  array, context=N
-00027e00: 6f6e 6529 3a0a 2020 2020 2020 2020 7265  one):.        re
-00027e10: 7475 726e 2070 642e 496e 6465 7828 6172  turn pd.Index(ar
-00027e20: 7261 792c 206e 616d 653d 7365 6c66 2e6e  ray, name=self.n
-00027e30: 616d 6529 0a0a 2020 2020 6465 6620 6865  ame)..    def he
-00027e40: 6164 2873 656c 662c 206e 3d35 2c20 636f  ad(self, n=5, co
-00027e50: 6d70 7574 653d 5472 7565 293a 0a20 2020  mpute=True):.   
-00027e60: 2020 2020 2022 2222 4669 7273 7420 6e20       """First n 
-00027e70: 6974 656d 7320 6f66 2074 6865 2049 6e64  items of the Ind
-00027e80: 6578 2e0a 0a20 2020 2020 2020 2043 6176  ex...        Cav
-00027e90: 6561 742c 2074 6869 7320 6f6e 6c79 2063  eat, this only c
-00027ea0: 6865 636b 7320 7468 6520 6669 7273 7420  hecks the first 
-00027eb0: 7061 7274 6974 696f 6e2e 0a20 2020 2020  partition..     
-00027ec0: 2020 2022 2222 0a20 2020 2020 2020 206e     """.        n
-00027ed0: 616d 6520 3d20 2268 6561 642d 2564 2d25  ame = "head-%d-%
-00027ee0: 7322 2025 2028 6e2c 2073 656c 662e 5f6e  s" % (n, self._n
-00027ef0: 616d 6529 0a20 2020 2020 2020 2064 736b  ame).        dsk
-00027f00: 203d 207b 286e 616d 652c 2030 293a 2028   = {(name, 0): (
-00027f10: 6f70 6572 6174 6f72 2e67 6574 6974 656d  operator.getitem
-00027f20: 2c20 2873 656c 662e 5f6e 616d 652c 2030  , (self._name, 0
-00027f30: 292c 2073 6c69 6365 2830 2c20 6e29 297d  ), slice(0, n))}
-00027f40: 0a20 2020 2020 2020 2067 7261 7068 203d  .        graph =
-00027f50: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
-00027f60: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
-00027f70: 286e 616d 652c 2064 736b 2c20 6465 7065  (name, dsk, depe
-00027f80: 6e64 656e 6369 6573 3d5b 7365 6c66 5d29  ndencies=[self])
-00027f90: 0a0a 2020 2020 2020 2020 7265 7375 6c74  ..        result
-00027fa0: 203d 206e 6577 5f64 645f 6f62 6a65 6374   = new_dd_object
-00027fb0: 2867 7261 7068 2c20 6e61 6d65 2c20 7365  (graph, name, se
-00027fc0: 6c66 2e5f 6d65 7461 2c20 7365 6c66 2e64  lf._meta, self.d
-00027fd0: 6976 6973 696f 6e73 5b3a 325d 290a 0a20  ivisions[:2]).. 
-00027fe0: 2020 2020 2020 2069 6620 636f 6d70 7574         if comput
-00027ff0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00028000: 6573 756c 7420 3d20 7265 7375 6c74 2e63  esult = result.c
-00028010: 6f6d 7075 7465 2829 0a20 2020 2020 2020  ompute().       
-00028020: 2072 6574 7572 6e20 7265 7375 6c74 0a0a   return result..
-00028030: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00028040: 6d28 7064 2e49 6e64 6578 290a 2020 2020  m(pd.Index).    
-00028050: 6465 6620 6d61 7828 7365 6c66 2c20 7370  def max(self, sp
-00028060: 6c69 745f 6576 6572 793d 4661 6c73 6529  lit_every=False)
-00028070: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00028080: 2073 656c 662e 7265 6475 6374 696f 6e28   self.reduction(
-00028090: 0a20 2020 2020 2020 2020 2020 204d 2e6d  .            M.m
-000280a0: 6178 2c0a 2020 2020 2020 2020 2020 2020  ax,.            
-000280b0: 6d65 7461 3d73 656c 662e 5f6d 6574 615f  meta=self._meta_
-000280c0: 6e6f 6e65 6d70 7479 2e6d 6178 2829 2c0a  nonempty.max(),.
-000280d0: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
-000280e0: 6e3d 7365 6c66 2e5f 746f 6b65 6e5f 7072  n=self._token_pr
-000280f0: 6566 6978 202b 2022 6d61 7822 2c0a 2020  efix + "max",.  
-00028100: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
-00028110: 6576 6572 793d 7370 6c69 745f 6576 6572  every=split_ever
-00028120: 792c 0a20 2020 2020 2020 2029 0a0a 2020  y,.        )..  
-00028130: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-00028140: 7064 2e49 6e64 6578 290a 2020 2020 6465  pd.Index).    de
-00028150: 6620 6d69 6e28 7365 6c66 2c20 7370 6c69  f min(self, spli
-00028160: 745f 6576 6572 793d 4661 6c73 6529 3a0a  t_every=False):.
-00028170: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00028180: 656c 662e 7265 6475 6374 696f 6e28 0a20  elf.reduction(. 
-00028190: 2020 2020 2020 2020 2020 204d 2e6d 696e             M.min
-000281a0: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
-000281b0: 7461 3d73 656c 662e 5f6d 6574 615f 6e6f  ta=self._meta_no
-000281c0: 6e65 6d70 7479 2e6d 696e 2829 2c0a 2020  nempty.min(),.  
-000281d0: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
-000281e0: 7365 6c66 2e5f 746f 6b65 6e5f 7072 6566  self._token_pref
-000281f0: 6978 202b 2022 6d69 6e22 2c0a 2020 2020  ix + "min",.    
-00028200: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-00028210: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
-00028220: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00028230: 6465 6620 636f 756e 7428 7365 6c66 2c20  def count(self, 
-00028240: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
-00028250: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
-00028260: 726e 2073 656c 662e 7265 6475 6374 696f  rn self.reductio
-00028270: 6e28 0a20 2020 2020 2020 2020 2020 206d  n(.            m
-00028280: 6574 686f 6473 2e69 6e64 6578 5f63 6f75  ethods.index_cou
-00028290: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-000282a0: 6e70 2e73 756d 2c0a 2020 2020 2020 2020  np.sum,.        
-000282b0: 2020 2020 746f 6b65 6e3d 2269 6e64 6578      token="index
-000282c0: 2d63 6f75 6e74 222c 0a20 2020 2020 2020  -count",.       
-000282d0: 2020 2020 206d 6574 613d 696e 742c 0a20       meta=int,. 
-000282e0: 2020 2020 2020 2020 2020 2073 706c 6974             split
-000282f0: 5f65 7665 7279 3d73 706c 6974 5f65 7665  _every=split_eve
-00028300: 7279 2c0a 2020 2020 2020 2020 290a 0a20  ry,.        ).. 
-00028310: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00028320: 2870 642e 496e 6465 7829 0a20 2020 2064  (pd.Index).    d
-00028330: 6566 2073 6869 6674 2873 656c 662c 2070  ef shift(self, p
-00028340: 6572 696f 6473 3d31 2c20 6672 6571 3d4e  eriods=1, freq=N
-00028350: 6f6e 6529 3a0a 2020 2020 2020 2020 6966  one):.        if
-00028360: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
-00028370: 2e5f 6d65 7461 2c20 7064 2e50 6572 696f  ._meta, pd.Perio
-00028380: 6449 6e64 6578 293a 0a20 2020 2020 2020  dIndex):.       
-00028390: 2020 2020 2069 6620 6672 6571 2069 7320       if freq is 
-000283a0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-000283b0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-000283c0: 5661 6c75 6545 7272 6f72 2822 5065 7269  ValueError("Peri
-000283d0: 6f64 496e 6465 7820 646f 6573 6e27 7420  odIndex doesn't 
-000283e0: 6163 6365 7074 2060 6672 6571 6020 6172  accept `freq` ar
-000283f0: 6775 6d65 6e74 2229 0a20 2020 2020 2020  gument").       
-00028400: 2020 2020 206d 6574 6120 3d20 7365 6c66       meta = self
-00028410: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
-00028420: 7368 6966 7428 7065 7269 6f64 7329 0a20  shift(periods). 
-00028430: 2020 2020 2020 2020 2020 206f 7574 203d             out =
-00028440: 2073 656c 662e 6d61 705f 7061 7274 6974   self.map_partit
-00028450: 696f 6e73 280a 2020 2020 2020 2020 2020  ions(.          
-00028460: 2020 2020 2020 4d2e 7368 6966 742c 2070        M.shift, p
-00028470: 6572 696f 6473 2c20 6d65 7461 3d6d 6574  eriods, meta=met
-00028480: 612c 2074 6f6b 656e 3d22 7368 6966 7422  a, token="shift"
-00028490: 2c20 7472 616e 7366 6f72 6d5f 6469 7669  , transform_divi
-000284a0: 7369 6f6e 733d 4661 6c73 650a 2020 2020  sions=False.    
-000284b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000284c0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000284d0: 2020 2020 2320 5061 6e64 6173 2077 696c      # Pandas wil
-000284e0: 6c20 7261 6973 6520 666f 7220 6f74 6865  l raise for othe
-000284f0: 7220 696e 6465 7820 7479 7065 7320 7468  r index types th
-00028500: 6174 2064 6f6e 2774 2069 6d70 6c65 6d65  at don't impleme
-00028510: 6e74 2073 6869 6674 0a20 2020 2020 2020  nt shift.       
-00028520: 2020 2020 206d 6574 6120 3d20 7365 6c66       meta = self
-00028530: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792e  ._meta_nonempty.
-00028540: 7368 6966 7428 7065 7269 6f64 732c 2066  shift(periods, f
-00028550: 7265 713d 6672 6571 290a 2020 2020 2020  req=freq).      
-00028560: 2020 2020 2020 6f75 7420 3d20 7365 6c66        out = self
-00028570: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-00028580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028590: 204d 2e73 6869 6674 2c0a 2020 2020 2020   M.shift,.      
-000285a0: 2020 2020 2020 2020 2020 7065 7269 6f64            period
-000285b0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-000285c0: 2020 2074 6f6b 656e 3d22 7368 6966 7422     token="shift"
-000285d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000285e0: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
-000285f0: 2020 2020 2020 2020 2020 2020 2066 7265               fre
-00028600: 713d 6672 6571 2c0a 2020 2020 2020 2020  q=freq,.        
-00028610: 2020 2020 2020 2020 7472 616e 7366 6f72          transfor
-00028620: 6d5f 6469 7669 7369 6f6e 733d 4661 6c73  m_divisions=Fals
-00028630: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
-00028640: 0a20 2020 2020 2020 2069 6620 6672 6571  .        if freq
-00028650: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00028660: 2020 2020 2020 6672 6571 203d 206d 6574        freq = met
-00028670: 612e 6672 6571 0a20 2020 2020 2020 2072  a.freq.        r
-00028680: 6574 7572 6e20 6d61 7962 655f 7368 6966  eturn maybe_shif
-00028690: 745f 6469 7669 7369 6f6e 7328 6f75 742c  t_divisions(out,
-000286a0: 2070 6572 696f 6473 2c20 6672 6571 3d66   periods, freq=f
-000286b0: 7265 7129 0a0a 2020 2020 4064 6572 6976  req)..    @deriv
-000286c0: 6564 5f66 726f 6d28 7064 2e49 6e64 6578  ed_from(pd.Index
-000286d0: 290a 2020 2020 6465 6620 746f 5f73 6572  ).    def to_ser
-000286e0: 6965 7328 7365 6c66 293a 0a20 2020 2020  ies(self):.     
-000286f0: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-00028700: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
-00028710: 2020 2020 2020 2020 2020 204d 2e74 6f5f             M.to_
-00028720: 7365 7269 6573 2c0a 2020 2020 2020 2020  series,.        
-00028730: 2020 2020 6d65 7461 3d73 656c 662e 5f6d      meta=self._m
-00028740: 6574 612e 746f 5f73 6572 6965 7328 292c  eta.to_series(),
-00028750: 0a20 2020 2020 2020 2020 2020 2074 7261  .            tra
-00028760: 6e73 666f 726d 5f64 6976 6973 696f 6e73  nsform_divisions
-00028770: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00028780: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00028790: 6672 6f6d 2870 642e 496e 6465 782c 2075  from(pd.Index, u
-000287a0: 615f 6172 6773 3d5b 2269 6e64 6578 225d  a_args=["index"]
-000287b0: 290a 2020 2020 6465 6620 746f 5f66 7261  ).    def to_fra
-000287c0: 6d65 2873 656c 662c 2069 6e64 6578 3d54  me(self, index=T
-000287d0: 7275 652c 206e 616d 653d 4e6f 6e65 293a  rue, name=None):
-000287e0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-000287f0: 696e 6465 783a 0a20 2020 2020 2020 2020  index:.         
-00028800: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-00028810: 656d 656e 7465 6445 7272 6f72 2829 0a20  ementedError(). 
-00028820: 2020 2020 2020 2061 7267 7320 3d20 5b69         args = [i
-00028830: 6e64 6578 5d20 6966 206e 616d 6520 6973  ndex] if name is
-00028840: 204e 6f6e 6520 656c 7365 205b 696e 6465   None else [inde
-00028850: 782c 206e 616d 655d 0a0a 2020 2020 2020  x, name]..      
-00028860: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
-00028870: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
-00028880: 2020 2020 2020 2020 2020 4d2e 746f 5f66            M.to_f
-00028890: 7261 6d65 2c0a 2020 2020 2020 2020 2020  rame,.          
-000288a0: 2020 2a61 7267 732c 0a20 2020 2020 2020    *args,.       
-000288b0: 2020 2020 206d 6574 613d 7365 6c66 2e5f       meta=self._
-000288c0: 6d65 7461 2e74 6f5f 6672 616d 6528 2a61  meta.to_frame(*a
-000288d0: 7267 7329 2c0a 2020 2020 2020 2020 2020  rgs),.          
-000288e0: 2020 7472 616e 7366 6f72 6d5f 6469 7669    transform_divi
-000288f0: 7369 6f6e 733d 4661 6c73 652c 0a20 2020  sions=False,.   
-00028900: 2020 2020 2029 0a0a 2020 2020 4069 6e73       )..    @ins
-00028910: 6572 745f 6d65 7461 5f70 6172 616d 5f64  ert_meta_param_d
-00028920: 6573 6372 6970 7469 6f6e 2870 6164 3d31  escription(pad=1
-00028930: 3229 0a20 2020 2040 6465 7269 7665 645f  2).    @derived_
-00028940: 6672 6f6d 2870 642e 496e 6465 7829 0a20  from(pd.Index). 
-00028950: 2020 2064 6566 206d 6170 2873 656c 662c     def map(self,
-00028960: 2061 7267 2c20 6e61 5f61 6374 696f 6e3d   arg, na_action=
-00028970: 4e6f 6e65 2c20 6d65 7461 3d6e 6f5f 6465  None, meta=no_de
-00028980: 6661 756c 742c 2069 735f 6d6f 6e6f 746f  fault, is_monoto
-00028990: 6e69 633d 4661 6c73 6529 3a0a 2020 2020  nic=False):.    
-000289a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000289b0: 4e6f 7465 2074 6861 7420 7468 6973 206d  Note that this m
-000289c0: 6574 686f 6420 636c 6561 7273 2061 6e79  ethod clears any
-000289d0: 206b 6e6f 776e 2064 6976 6973 696f 6e73   known divisions
-000289e0: 2e0a 0a20 2020 2020 2020 2049 6620 796f  ...        If yo
-000289f0: 7572 206d 6170 7069 6e67 2066 756e 6374  ur mapping funct
-00028a00: 696f 6e20 6973 206d 6f6e 6f74 6f6e 6963  ion is monotonic
-00028a10: 616c 6c79 2069 6e63 7265 6173 696e 6720  ally increasing 
-00028a20: 7468 656e 2075 7365 2060 6973 5f6d 6f6e  then use `is_mon
-00028a30: 6f74 6f6e 6963 600a 2020 2020 2020 2020  otonic`.        
-00028a40: 746f 2061 7070 6c79 2074 6865 206d 6170  to apply the map
-00028a50: 696e 6720 6675 6e63 7469 6f6e 2074 6f20  ing function to 
-00028a60: 7468 6520 6f6c 6420 6469 7669 7369 6f6e  the old division
-00028a70: 7320 616e 6420 6173 7369 676e 2074 6865  s and assign the
-00028a80: 206e 6577 0a20 2020 2020 2020 2064 6976   new.        div
-00028a90: 6973 696f 6e73 2074 6f20 7468 6520 6f75  isions to the ou
-00028aa0: 7470 7574 2e0a 0a20 2020 2020 2020 2022  tput...        "
-00028ab0: 2222 0a20 2020 2020 2020 2061 7070 6c69  "".        appli
-00028ac0: 6564 203d 2073 7570 6572 2829 2e6d 6170  ed = super().map
-00028ad0: 2861 7267 2c20 6e61 5f61 6374 696f 6e3d  (arg, na_action=
-00028ae0: 6e61 5f61 6374 696f 6e2c 206d 6574 613d  na_action, meta=
-00028af0: 6d65 7461 290a 2020 2020 2020 2020 6966  meta).        if
-00028b00: 2069 735f 6d6f 6e6f 746f 6e69 6320 616e   is_monotonic an
-00028b10: 6420 7365 6c66 2e6b 6e6f 776e 5f64 6976  d self.known_div
-00028b20: 6973 696f 6e73 3a0a 2020 2020 2020 2020  isions:.        
-00028b30: 2020 2020 6170 706c 6965 642e 6469 7669      applied.divi
-00028b40: 7369 6f6e 7320 3d20 7475 706c 6528 0a20  sions = tuple(. 
-00028b50: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00028b60: 642e 5365 7269 6573 2873 656c 662e 6469  d.Series(self.di
-00028b70: 7669 7369 6f6e 7329 2e6d 6170 2861 7267  visions).map(arg
+00027bc0: 7461 7474 7228 7365 6c66 2e63 6174 2c20  tattr(self.cat, 
+00027bd0: 6b65 7929 0a20 2020 2020 2020 2065 6c69  key).        eli
+00027be0: 6620 6b65 7920 696e 2073 656c 662e 5f64  f key in self._d
+00027bf0: 745f 6174 7472 6962 7574 6573 3a0a 2020  t_attributes:.  
+00027c00: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00027c10: 2067 6574 6174 7472 2873 656c 662e 6474   getattr(self.dt
+00027c20: 2c20 6b65 7929 0a20 2020 2020 2020 2065  , key).        e
+00027c30: 6c69 6620 6b65 7920 696e 2073 656c 662e  lif key in self.
+00027c40: 5f6d 6f6e 6f74 6f6e 6963 5f61 7474 7269  _monotonic_attri
+00027c50: 6275 7465 733a 0a20 2020 2020 2020 2020  butes:.         
+00027c60: 2020 2072 6574 7572 6e20 6765 7461 7474     return getatt
+00027c70: 7228 7365 6c66 2c20 6b65 7929 0a20 2020  r(self, key).   
+00027c80: 2020 2020 2072 6169 7365 2041 7474 7269       raise Attri
+00027c90: 6275 7465 4572 726f 7228 2227 496e 6465  buteError("'Inde
+00027ca0: 7827 206f 626a 6563 7420 6861 7320 6e6f  x' object has no
+00027cb0: 2061 7474 7269 6275 7465 2025 7222 2025   attribute %r" %
+00027cc0: 206b 6579 290a 0a20 2020 2064 6566 205f   key)..    def _
+00027cd0: 5f64 6972 5f5f 2873 656c 6629 3a0a 2020  _dir__(self):.  
+00027ce0: 2020 2020 2020 6f75 7420 3d20 7375 7065        out = supe
+00027cf0: 7228 292e 5f5f 6469 725f 5f28 290a 2020  r().__dir__().  
+00027d00: 2020 2020 2020 6f75 742e 6578 7465 6e64        out.extend
+00027d10: 2873 656c 662e 5f64 745f 6174 7472 6962  (self._dt_attrib
+00027d20: 7574 6573 290a 2020 2020 2020 2020 6966  utes).        if
+00027d30: 2069 7369 6e73 7461 6e63 6528 7365 6c66   isinstance(self
+00027d40: 2e64 7479 7065 2c20 7064 2e43 6174 6567  .dtype, pd.Categ
+00027d50: 6f72 6963 616c 4474 7970 6529 3a0a 2020  oricalDtype):.  
+00027d60: 2020 2020 2020 2020 2020 6f75 742e 6578            out.ex
+00027d70: 7465 6e64 2873 656c 662e 5f63 6174 5f61  tend(self._cat_a
+00027d80: 7474 7269 6275 7465 7329 0a20 2020 2020  ttributes).     
+00027d90: 2020 2072 6574 7572 6e20 6f75 740a 0a20     return out.. 
+00027da0: 2020 2023 2054 7970 696e 673a 2068 7474     # Typing: htt
+00027db0: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
+00027dc0: 7079 7468 6f6e 2f6d 7970 792f 6973 7375  python/mypy/issu
+00027dd0: 6573 2f34 3132 350a 2020 2020 4070 726f  es/4125.    @pro
+00027de0: 7065 7274 7920 2023 2074 7970 653a 2069  perty  # type: i
+00027df0: 676e 6f72 650a 2020 2020 6465 6620 696e  gnore.    def in
+00027e00: 6465 7828 7365 6c66 293a 0a20 2020 2020  dex(self):.     
+00027e10: 2020 2072 6169 7365 2041 7474 7269 6275     raise Attribu
+00027e20: 7465 4572 726f 7228 0a20 2020 2020 2020  teError(.       
+00027e30: 2020 2020 2066 227b 7365 6c66 2e5f 5f63       f"{self.__c
+00027e40: 6c61 7373 5f5f 2e5f 5f6e 616d 655f 5f21  lass__.__name__!
+00027e50: 727d 206f 626a 6563 7420 6861 7320 6e6f  r} object has no
+00027e60: 2061 7474 7269 6275 7465 2027 696e 6465   attribute 'inde
+00027e70: 7827 220a 2020 2020 2020 2020 290a 0a20  x'".        ).. 
+00027e80: 2020 2064 6566 205f 5f61 7272 6179 5f77     def __array_w
+00027e90: 7261 705f 5f28 7365 6c66 2c20 6172 7261  rap__(self, arra
+00027ea0: 792c 2063 6f6e 7465 7874 3d4e 6f6e 6529  y, context=None)
+00027eb0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00027ec0: 2070 642e 496e 6465 7828 6172 7261 792c   pd.Index(array,
+00027ed0: 206e 616d 653d 7365 6c66 2e6e 616d 6529   name=self.name)
+00027ee0: 0a0a 2020 2020 6465 6620 6865 6164 2873  ..    def head(s
+00027ef0: 656c 662c 206e 3d35 2c20 636f 6d70 7574  elf, n=5, comput
+00027f00: 653d 5472 7565 293a 0a20 2020 2020 2020  e=True):.       
+00027f10: 2022 2222 4669 7273 7420 6e20 6974 656d   """First n item
+00027f20: 7320 6f66 2074 6865 2049 6e64 6578 2e0a  s of the Index..
+00027f30: 0a20 2020 2020 2020 2043 6176 6561 742c  .        Caveat,
+00027f40: 2074 6869 7320 6f6e 6c79 2063 6865 636b   this only check
+00027f50: 7320 7468 6520 6669 7273 7420 7061 7274  s the first part
+00027f60: 6974 696f 6e2e 0a20 2020 2020 2020 2022  ition..        "
+00027f70: 2222 0a20 2020 2020 2020 206e 616d 6520  "".        name 
+00027f80: 3d20 2268 6561 642d 2564 2d25 7322 2025  = "head-%d-%s" %
+00027f90: 2028 6e2c 2073 656c 662e 5f6e 616d 6529   (n, self._name)
+00027fa0: 0a20 2020 2020 2020 2064 736b 203d 207b  .        dsk = {
+00027fb0: 286e 616d 652c 2030 293a 2028 6f70 6572  (name, 0): (oper
+00027fc0: 6174 6f72 2e67 6574 6974 656d 2c20 2873  ator.getitem, (s
+00027fd0: 656c 662e 5f6e 616d 652c 2030 292c 2073  elf._name, 0), s
+00027fe0: 6c69 6365 2830 2c20 6e29 297d 0a20 2020  lice(0, n))}.   
+00027ff0: 2020 2020 2067 7261 7068 203d 2048 6967       graph = Hig
+00028000: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
+00028010: 5f63 6f6c 6c65 6374 696f 6e73 286e 616d  _collections(nam
+00028020: 652c 2064 736b 2c20 6465 7065 6e64 656e  e, dsk, dependen
+00028030: 6369 6573 3d5b 7365 6c66 5d29 0a0a 2020  cies=[self])..  
+00028040: 2020 2020 2020 7265 7375 6c74 203d 206e        result = n
+00028050: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
+00028060: 7068 2c20 6e61 6d65 2c20 7365 6c66 2e5f  ph, name, self._
+00028070: 6d65 7461 2c20 7365 6c66 2e64 6976 6973  meta, self.divis
+00028080: 696f 6e73 5b3a 325d 290a 0a20 2020 2020  ions[:2])..     
+00028090: 2020 2069 6620 636f 6d70 7574 653a 0a20     if compute:. 
+000280a0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+000280b0: 7420 3d20 7265 7375 6c74 2e63 6f6d 7075  t = result.compu
+000280c0: 7465 2829 0a20 2020 2020 2020 2072 6574  te().        ret
+000280d0: 7572 6e20 7265 7375 6c74 0a0a 2020 2020  urn result..    
+000280e0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+000280f0: 2e49 6e64 6578 290a 2020 2020 6465 6620  .Index).    def 
+00028100: 6d61 7828 7365 6c66 2c20 7370 6c69 745f  max(self, split_
+00028110: 6576 6572 793d 4661 6c73 6529 3a0a 2020  every=False):.  
+00028120: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00028130: 662e 7265 6475 6374 696f 6e28 0a20 2020  f.reduction(.   
+00028140: 2020 2020 2020 2020 204d 2e6d 6178 2c0a           M.max,.
+00028150: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+00028160: 3d73 656c 662e 5f6d 6574 615f 6e6f 6e65  =self._meta_none
+00028170: 6d70 7479 2e6d 6178 2829 2c0a 2020 2020  mpty.max(),.    
+00028180: 2020 2020 2020 2020 746f 6b65 6e3d 7365          token=se
+00028190: 6c66 2e5f 746f 6b65 6e5f 7072 6566 6978  lf._token_prefix
+000281a0: 202b 2022 6d61 7822 2c0a 2020 2020 2020   + "max",.      
+000281b0: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
+000281c0: 793d 7370 6c69 745f 6576 6572 792c 0a20  y=split_every,. 
+000281d0: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
+000281e0: 6572 6976 6564 5f66 726f 6d28 7064 2e49  erived_from(pd.I
+000281f0: 6e64 6578 290a 2020 2020 6465 6620 6d69  ndex).    def mi
+00028200: 6e28 7365 6c66 2c20 7370 6c69 745f 6576  n(self, split_ev
+00028210: 6572 793d 4661 6c73 6529 3a0a 2020 2020  ery=False):.    
+00028220: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00028230: 7265 6475 6374 696f 6e28 0a20 2020 2020  reduction(.     
+00028240: 2020 2020 2020 204d 2e6d 696e 2c0a 2020         M.min,.  
+00028250: 2020 2020 2020 2020 2020 6d65 7461 3d73            meta=s
+00028260: 656c 662e 5f6d 6574 615f 6e6f 6e65 6d70  elf._meta_nonemp
+00028270: 7479 2e6d 696e 2829 2c0a 2020 2020 2020  ty.min(),.      
+00028280: 2020 2020 2020 746f 6b65 6e3d 7365 6c66        token=self
+00028290: 2e5f 746f 6b65 6e5f 7072 6566 6978 202b  ._token_prefix +
+000282a0: 2022 6d69 6e22 2c0a 2020 2020 2020 2020   "min",.        
+000282b0: 2020 2020 7370 6c69 745f 6576 6572 793d      split_every=
+000282c0: 7370 6c69 745f 6576 6572 792c 0a20 2020  split_every,.   
+000282d0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+000282e0: 636f 756e 7428 7365 6c66 2c20 7370 6c69  count(self, spli
+000282f0: 745f 6576 6572 793d 4661 6c73 6529 3a0a  t_every=False):.
+00028300: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00028310: 656c 662e 7265 6475 6374 696f 6e28 0a20  elf.reduction(. 
+00028320: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+00028330: 6473 2e69 6e64 6578 5f63 6f75 6e74 2c0a  ds.index_count,.
+00028340: 2020 2020 2020 2020 2020 2020 6e70 2e73              np.s
+00028350: 756d 2c0a 2020 2020 2020 2020 2020 2020  um,.            
+00028360: 746f 6b65 6e3d 2269 6e64 6578 2d63 6f75  token="index-cou
+00028370: 6e74 222c 0a20 2020 2020 2020 2020 2020  nt",.           
+00028380: 206d 6574 613d 696e 742c 0a20 2020 2020   meta=int,.     
+00028390: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
+000283a0: 7279 3d73 706c 6974 5f65 7665 7279 2c0a  ry=split_every,.
+000283b0: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
+000283c0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+000283d0: 496e 6465 7829 0a20 2020 2064 6566 2073  Index).    def s
+000283e0: 6869 6674 2873 656c 662c 2070 6572 696f  hift(self, perio
+000283f0: 6473 3d31 2c20 6672 6571 3d4e 6f6e 6529  ds=1, freq=None)
+00028400: 3a0a 2020 2020 2020 2020 6966 2069 7369  :.        if isi
+00028410: 6e73 7461 6e63 6528 7365 6c66 2e5f 6d65  nstance(self._me
+00028420: 7461 2c20 7064 2e50 6572 696f 6449 6e64  ta, pd.PeriodInd
+00028430: 6578 293a 0a20 2020 2020 2020 2020 2020  ex):.           
+00028440: 2069 6620 6672 6571 2069 7320 6e6f 7420   if freq is not 
+00028450: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00028460: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00028470: 6545 7272 6f72 2822 5065 7269 6f64 496e  eError("PeriodIn
+00028480: 6465 7820 646f 6573 6e27 7420 6163 6365  dex doesn't acce
+00028490: 7074 2060 6672 6571 6020 6172 6775 6d65  pt `freq` argume
+000284a0: 6e74 2229 0a20 2020 2020 2020 2020 2020  nt").           
+000284b0: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
+000284c0: 7461 5f6e 6f6e 656d 7074 792e 7368 6966  ta_nonempty.shif
+000284d0: 7428 7065 7269 6f64 7329 0a20 2020 2020  t(periods).     
+000284e0: 2020 2020 2020 206f 7574 203d 2073 656c         out = sel
+000284f0: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+00028500: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00028510: 2020 4d2e 7368 6966 742c 2070 6572 696f    M.shift, perio
+00028520: 6473 2c20 6d65 7461 3d6d 6574 612c 2074  ds, meta=meta, t
+00028530: 6f6b 656e 3d22 7368 6966 7422 2c20 7472  oken="shift", tr
+00028540: 616e 7366 6f72 6d5f 6469 7669 7369 6f6e  ansform_division
+00028550: 733d 4661 6c73 650a 2020 2020 2020 2020  s=False.        
+00028560: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
+00028570: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00028580: 2320 5061 6e64 6173 2077 696c 6c20 7261  # Pandas will ra
+00028590: 6973 6520 666f 7220 6f74 6865 7220 696e  ise for other in
+000285a0: 6465 7820 7479 7065 7320 7468 6174 2064  dex types that d
+000285b0: 6f6e 2774 2069 6d70 6c65 6d65 6e74 2073  on't implement s
+000285c0: 6869 6674 0a20 2020 2020 2020 2020 2020  hift.           
+000285d0: 206d 6574 6120 3d20 7365 6c66 2e5f 6d65   meta = self._me
+000285e0: 7461 5f6e 6f6e 656d 7074 792e 7368 6966  ta_nonempty.shif
+000285f0: 7428 7065 7269 6f64 732c 2066 7265 713d  t(periods, freq=
+00028600: 6672 6571 290a 2020 2020 2020 2020 2020  freq).          
+00028610: 2020 6f75 7420 3d20 7365 6c66 2e6d 6170    out = self.map
+00028620: 5f70 6172 7469 7469 6f6e 7328 0a20 2020  _partitions(.   
+00028630: 2020 2020 2020 2020 2020 2020 204d 2e73               M.s
+00028640: 6869 6674 2c0a 2020 2020 2020 2020 2020  hift,.          
+00028650: 2020 2020 2020 7065 7269 6f64 732c 0a20        periods,. 
+00028660: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00028670: 6f6b 656e 3d22 7368 6966 7422 2c0a 2020  oken="shift",.  
+00028680: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+00028690: 7461 3d6d 6574 612c 0a20 2020 2020 2020  ta=meta,.       
+000286a0: 2020 2020 2020 2020 2066 7265 713d 6672           freq=fr
+000286b0: 6571 2c0a 2020 2020 2020 2020 2020 2020  eq,.            
+000286c0: 2020 2020 7472 616e 7366 6f72 6d5f 6469      transform_di
+000286d0: 7669 7369 6f6e 733d 4661 6c73 652c 0a20  visions=False,. 
+000286e0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000286f0: 2020 2020 2069 6620 6672 6571 2069 7320       if freq is 
+00028700: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00028710: 2020 6672 6571 203d 206d 6574 612e 6672    freq = meta.fr
+00028720: 6571 0a20 2020 2020 2020 2072 6574 7572  eq.        retur
+00028730: 6e20 6d61 7962 655f 7368 6966 745f 6469  n maybe_shift_di
+00028740: 7669 7369 6f6e 7328 6f75 742c 2070 6572  visions(out, per
+00028750: 696f 6473 2c20 6672 6571 3d66 7265 7129  iods, freq=freq)
+00028760: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00028770: 726f 6d28 7064 2e49 6e64 6578 290a 2020  rom(pd.Index).  
+00028780: 2020 6465 6620 746f 5f73 6572 6965 7328    def to_series(
+00028790: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+000287a0: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+000287b0: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+000287c0: 2020 2020 2020 204d 2e74 6f5f 7365 7269         M.to_seri
+000287d0: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+000287e0: 6d65 7461 3d73 656c 662e 5f6d 6574 612e  meta=self._meta.
+000287f0: 746f 5f73 6572 6965 7328 292c 0a20 2020  to_series(),.   
+00028800: 2020 2020 2020 2020 2074 7261 6e73 666f           transfo
+00028810: 726d 5f64 6976 6973 696f 6e73 3d46 616c  rm_divisions=Fal
+00028820: 7365 2c0a 2020 2020 2020 2020 290a 0a20  se,.        ).. 
+00028830: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00028840: 2870 642e 496e 6465 782c 2075 615f 6172  (pd.Index, ua_ar
+00028850: 6773 3d5b 2269 6e64 6578 225d 290a 2020  gs=["index"]).  
+00028860: 2020 6465 6620 746f 5f66 7261 6d65 2873    def to_frame(s
+00028870: 656c 662c 2069 6e64 6578 3d54 7275 652c  elf, index=True,
+00028880: 206e 616d 653d 4e6f 6e65 293a 0a20 2020   name=None):.   
+00028890: 2020 2020 2069 6620 6e6f 7420 696e 6465       if not inde
+000288a0: 783a 0a20 2020 2020 2020 2020 2020 2072  x:.            r
+000288b0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+000288c0: 7465 6445 7272 6f72 2829 0a20 2020 2020  tedError().     
+000288d0: 2020 2061 7267 7320 3d20 5b69 6e64 6578     args = [index
+000288e0: 5d20 6966 206e 616d 6520 6973 204e 6f6e  ] if name is Non
+000288f0: 6520 656c 7365 205b 696e 6465 782c 206e  e else [index, n
+00028900: 616d 655d 0a0a 2020 2020 2020 2020 7265  ame]..        re
+00028910: 7475 726e 2073 656c 662e 6d61 705f 7061  turn self.map_pa
+00028920: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+00028930: 2020 2020 2020 4d2e 746f 5f66 7261 6d65        M.to_frame
+00028940: 2c0a 2020 2020 2020 2020 2020 2020 2a61  ,.            *a
+00028950: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
+00028960: 206d 6574 613d 7365 6c66 2e5f 6d65 7461   meta=self._meta
+00028970: 2e74 6f5f 6672 616d 6528 2a61 7267 7329  .to_frame(*args)
+00028980: 2c0a 2020 2020 2020 2020 2020 2020 7472  ,.            tr
+00028990: 616e 7366 6f72 6d5f 6469 7669 7369 6f6e  ansform_division
+000289a0: 733d 4661 6c73 652c 0a20 2020 2020 2020  s=False,.       
+000289b0: 2029 0a0a 2020 2020 4069 6e73 6572 745f   )..    @insert_
+000289c0: 6d65 7461 5f70 6172 616d 5f64 6573 6372  meta_param_descr
+000289d0: 6970 7469 6f6e 2870 6164 3d31 3229 0a20  iption(pad=12). 
+000289e0: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+000289f0: 2870 642e 496e 6465 7829 0a20 2020 2064  (pd.Index).    d
+00028a00: 6566 206d 6170 2873 656c 662c 2061 7267  ef map(self, arg
+00028a10: 2c20 6e61 5f61 6374 696f 6e3d 4e6f 6e65  , na_action=None
+00028a20: 2c20 6d65 7461 3d6e 6f5f 6465 6661 756c  , meta=no_defaul
+00028a30: 742c 2069 735f 6d6f 6e6f 746f 6e69 633d  t, is_monotonic=
+00028a40: 4661 6c73 6529 3a0a 2020 2020 2020 2020  False):.        
+00028a50: 2222 220a 2020 2020 2020 2020 4e6f 7465  """.        Note
+00028a60: 2074 6861 7420 7468 6973 206d 6574 686f   that this metho
+00028a70: 6420 636c 6561 7273 2061 6e79 206b 6e6f  d clears any kno
+00028a80: 776e 2064 6976 6973 696f 6e73 2e0a 0a20  wn divisions... 
+00028a90: 2020 2020 2020 2049 6620 796f 7572 206d         If your m
+00028aa0: 6170 7069 6e67 2066 756e 6374 696f 6e20  apping function 
+00028ab0: 6973 206d 6f6e 6f74 6f6e 6963 616c 6c79  is monotonically
+00028ac0: 2069 6e63 7265 6173 696e 6720 7468 656e   increasing then
+00028ad0: 2075 7365 2060 6973 5f6d 6f6e 6f74 6f6e   use `is_monoton
+00028ae0: 6963 600a 2020 2020 2020 2020 746f 2061  ic`.        to a
+00028af0: 7070 6c79 2074 6865 206d 6170 696e 6720  pply the maping 
+00028b00: 6675 6e63 7469 6f6e 2074 6f20 7468 6520  function to the 
+00028b10: 6f6c 6420 6469 7669 7369 6f6e 7320 616e  old divisions an
+00028b20: 6420 6173 7369 676e 2074 6865 206e 6577  d assign the new
+00028b30: 0a20 2020 2020 2020 2064 6976 6973 696f  .        divisio
+00028b40: 6e73 2074 6f20 7468 6520 6f75 7470 7574  ns to the output
+00028b50: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
+00028b60: 2020 2020 2020 2061 7070 6c69 6564 203d         applied =
+00028b70: 2073 7570 6572 2829 2e6d 6170 2861 7267   super().map(arg
 00028b80: 2c20 6e61 5f61 6374 696f 6e3d 6e61 5f61  , na_action=na_a
-00028b90: 6374 696f 6e29 0a20 2020 2020 2020 2020  ction).         
-00028ba0: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
-00028bb0: 653a 0a20 2020 2020 2020 2020 2020 2061  e:.            a
-00028bc0: 7070 6c69 6564 203d 2061 7070 6c69 6564  pplied = applied
-00028bd0: 2e63 6c65 6172 5f64 6976 6973 696f 6e73  .clear_divisions
-00028be0: 2829 0a20 2020 2020 2020 2072 6574 7572  ().        retur
-00028bf0: 6e20 6170 706c 6965 640a 0a20 2020 2069  n applied..    i
-00028c00: 6620 6e6f 7420 5041 4e44 4153 5f47 545f  f not PANDAS_GT_
-00028c10: 3230 303a 0a0a 2020 2020 2020 2020 4070  200:..        @p
-00028c20: 726f 7065 7274 790a 2020 2020 2020 2020  roperty.        
-00028c30: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
-00028c40: 2e49 6e64 6578 290a 2020 2020 2020 2020  .Index).        
-00028c50: 6465 6620 6973 5f6d 6f6e 6f74 6f6e 6963  def is_monotonic
-00028c60: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00028c70: 2020 2020 6966 2050 414e 4441 535f 4754      if PANDAS_GT
-00028c80: 5f31 3530 3a0a 2020 2020 2020 2020 2020  _150:.          
-00028c90: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-00028ca0: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
-00028cb0: 2020 2020 2020 2020 2022 6973 5f6d 6f6e           "is_mon
-00028cc0: 6f74 6f6e 6963 2069 7320 6465 7072 6563  otonic is deprec
-00028cd0: 6174 6564 2061 6e64 2077 696c 6c20 6265  ated and will be
-00028ce0: 2072 656d 6f76 6564 2069 6e20 6120 6675   removed in a fu
-00028cf0: 7475 7265 2076 6572 7369 6f6e 2e20 220a  ture version. ".
-00028d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028d10: 2020 2020 2255 7365 2069 735f 6d6f 6e6f      "Use is_mono
-00028d20: 746f 6e69 635f 696e 6372 6561 7369 6e67  tonic_increasing
-00028d30: 2069 6e73 7465 6164 2e22 2c0a 2020 2020   instead.",.    
-00028d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028d50: 4675 7475 7265 5761 726e 696e 672c 0a20  FutureWarning,. 
-00028d60: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00028d70: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00028d80: 7572 6e20 7375 7065 7228 292e 6973 5f6d  urn super().is_m
-00028d90: 6f6e 6f74 6f6e 6963 5f69 6e63 7265 6173  onotonic_increas
-00028da0: 696e 670a 0a20 2020 2040 7072 6f70 6572  ing..    @proper
-00028db0: 7479 0a20 2020 2040 6465 7269 7665 645f  ty.    @derived_
-00028dc0: 6672 6f6d 2870 642e 496e 6465 7829 0a20  from(pd.Index). 
-00028dd0: 2020 2064 6566 2069 735f 6d6f 6e6f 746f     def is_monoto
-00028de0: 6e69 635f 696e 6372 6561 7369 6e67 2873  nic_increasing(s
-00028df0: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00028e00: 7475 726e 2073 7570 6572 2829 2e69 735f  turn super().is_
-00028e10: 6d6f 6e6f 746f 6e69 635f 696e 6372 6561  monotonic_increa
-00028e20: 7369 6e67 0a0a 2020 2020 4070 726f 7065  sing..    @prope
-00028e30: 7274 790a 2020 2020 4064 6572 6976 6564  rty.    @derived
-00028e40: 5f66 726f 6d28 7064 2e49 6e64 6578 290a  _from(pd.Index).
-00028e50: 2020 2020 6465 6620 6973 5f6d 6f6e 6f74      def is_monot
-00028e60: 6f6e 6963 5f64 6563 7265 6173 696e 6728  onic_decreasing(
-00028e70: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00028e80: 6574 7572 6e20 7375 7065 7228 292e 6973  eturn super().is
-00028e90: 5f6d 6f6e 6f74 6f6e 6963 5f64 6563 7265  _monotonic_decre
-00028ea0: 6173 696e 670a 0a20 2020 2040 6465 7269  asing..    @deri
-00028eb0: 7665 645f 6672 6f6d 2870 642e 496e 6465  ved_from(pd.Inde
-00028ec0: 7829 0a20 2020 2064 6566 206d 656d 6f72  x).    def memor
-00028ed0: 795f 7573 6167 6528 7365 6c66 2c20 6465  y_usage(self, de
-00028ee0: 6570 3d46 616c 7365 293a 0a20 2020 2020  ep=False):.     
-00028ef0: 2020 2072 6574 7572 6e20 7365 6c66 2e72     return self.r
-00028f00: 6564 7563 7469 6f6e 280a 2020 2020 2020  eduction(.      
-00028f10: 2020 2020 2020 4d2e 6d65 6d6f 7279 5f75        M.memory_u
-00028f20: 7361 6765 2c0a 2020 2020 2020 2020 2020  sage,.          
-00028f30: 2020 4d2e 7375 6d2c 0a20 2020 2020 2020    M.sum,.       
-00028f40: 2020 2020 2063 6875 6e6b 5f6b 7761 7267       chunk_kwarg
-00028f50: 733d 7b22 6465 6570 223a 2064 6565 707d  s={"deep": deep}
-00028f60: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
-00028f70: 6c69 745f 6576 6572 793d 4661 6c73 652c  lit_every=False,
-00028f80: 0a20 2020 2020 2020 2020 2020 2074 6f6b  .            tok
-00028f90: 656e 3d73 656c 662e 5f74 6f6b 656e 5f70  en=self._token_p
-00028fa0: 7265 6669 7820 2b20 226d 656d 6f72 792d  refix + "memory-
-00028fb0: 7573 6167 6522 2c0a 2020 2020 2020 2020  usage",.        
-00028fc0: 290a 0a0a 636c 6173 7320 4461 7461 4672  )...class DataFr
-00028fd0: 616d 6528 5f46 7261 6d65 293a 0a20 2020  ame(_Frame):.   
-00028fe0: 2022 2222 0a20 2020 2050 6172 616c 6c65   """.    Paralle
-00028ff0: 6c20 5061 6e64 6173 2044 6174 6146 7261  l Pandas DataFra
-00029000: 6d65 0a0a 2020 2020 446f 206e 6f74 2075  me..    Do not u
-00029010: 7365 2074 6869 7320 636c 6173 7320 6469  se this class di
-00029020: 7265 6374 6c79 2e20 2049 6e73 7465 6164  rectly.  Instead
-00029030: 2075 7365 2066 756e 6374 696f 6e73 206c   use functions l
-00029040: 696b 650a 2020 2020 6060 6464 2e72 6561  ike.    ``dd.rea
-00029050: 645f 6373 7660 602c 2060 6064 642e 7265  d_csv``, ``dd.re
-00029060: 6164 5f70 6172 7175 6574 6060 2c20 6f72  ad_parquet``, or
-00029070: 2060 6064 642e 6672 6f6d 5f70 616e 6461   ``dd.from_panda
-00029080: 7360 602e 0a0a 2020 2020 5061 7261 6d65  s``...    Parame
-00029090: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
-000290a0: 2d2d 2d0a 2020 2020 6473 6b3a 2064 6963  ---.    dsk: dic
-000290b0: 740a 2020 2020 2020 2020 5468 6520 6461  t.        The da
-000290c0: 736b 2067 7261 7068 2074 6f20 636f 6d70  sk graph to comp
-000290d0: 7574 6520 7468 6973 2044 6174 6146 7261  ute this DataFra
-000290e0: 6d65 0a20 2020 206e 616d 653a 2073 7472  me.    name: str
-000290f0: 0a20 2020 2020 2020 2054 6865 206b 6579  .        The key
-00029100: 2070 7265 6669 7820 7468 6174 2073 7065   prefix that spe
-00029110: 6369 6669 6573 2077 6869 6368 206b 6579  cifies which key
-00029120: 7320 696e 2074 6865 2064 6173 6b20 636f  s in the dask co
-00029130: 6d70 7269 7365 2074 6869 730a 2020 2020  mprise this.    
-00029140: 2020 2020 7061 7274 6963 756c 6172 2044      particular D
-00029150: 6174 6146 7261 6d65 0a20 2020 206d 6574  ataFrame.    met
-00029160: 613a 2070 616e 6461 732e 4461 7461 4672  a: pandas.DataFr
-00029170: 616d 650a 2020 2020 2020 2020 416e 2065  ame.        An e
-00029180: 6d70 7479 2060 6070 616e 6461 732e 4461  mpty ``pandas.Da
-00029190: 7461 4672 616d 6560 6020 7769 7468 206e  taFrame`` with n
-000291a0: 616d 6573 2c20 6474 7970 6573 2c20 616e  ames, dtypes, an
-000291b0: 6420 696e 6465 7820 6d61 7463 6869 6e67  d index matching
-000291c0: 0a20 2020 2020 2020 2074 6865 2065 7870  .        the exp
-000291d0: 6563 7465 6420 6f75 7470 7574 2e0a 2020  ected output..  
-000291e0: 2020 6469 7669 7369 6f6e 733a 2074 7570    divisions: tup
-000291f0: 6c65 206f 6620 696e 6465 7820 7661 6c75  le of index valu
-00029200: 6573 0a20 2020 2020 2020 2056 616c 7565  es.        Value
-00029210: 7320 616c 6f6e 6720 7768 6963 6820 7765  s along which we
-00029220: 2070 6172 7469 7469 6f6e 206f 7572 2062   partition our b
-00029230: 6c6f 636b 7320 6f6e 2074 6865 2069 6e64  locks on the ind
-00029240: 6578 0a20 2020 2022 2222 0a0a 2020 2020  ex.    """..    
-00029250: 5f70 6172 7469 7469 6f6e 5f74 7970 6520  _partition_type 
-00029260: 3d20 7064 2e44 6174 6146 7261 6d65 0a20  = pd.DataFrame. 
-00029270: 2020 205f 6973 5f70 6172 7469 7469 6f6e     _is_partition
-00029280: 5f74 7970 6520 3d20 7374 6174 6963 6d65  _type = staticme
-00029290: 7468 6f64 2869 735f 6461 7461 6672 616d  thod(is_datafram
-000292a0: 655f 6c69 6b65 290a 2020 2020 5f74 6f6b  e_like).    _tok
-000292b0: 656e 5f70 7265 6669 7820 3d20 2264 6174  en_prefix = "dat
-000292c0: 6166 7261 6d65 2d22 0a20 2020 205f 6163  aframe-".    _ac
-000292d0: 6365 7373 6f72 733a 2043 6c61 7373 5661  cessors: ClassVa
-000292e0: 725b 7365 745b 7374 725d 5d20 3d20 7365  r[set[str]] = se
-000292f0: 7428 290a 0a20 2020 2064 6566 205f 5f69  t()..    def __i
-00029300: 6e69 745f 5f28 7365 6c66 2c20 6473 6b2c  nit__(self, dsk,
-00029310: 206e 616d 652c 206d 6574 612c 2064 6976   name, meta, div
-00029320: 6973 696f 6e73 293a 0a20 2020 2020 2020  isions):.       
-00029330: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
-00029340: 5f28 6473 6b2c 206e 616d 652c 206d 6574  _(dsk, name, met
-00029350: 612c 2064 6976 6973 696f 6e73 290a 2020  a, divisions).  
-00029360: 2020 2020 2020 6966 2073 656c 662e 6461        if self.da
-00029370: 736b 2e6c 6179 6572 735b 6e61 6d65 5d2e  sk.layers[name].
-00029380: 636f 6c6c 6563 7469 6f6e 5f61 6e6e 6f74  collection_annot
-00029390: 6174 696f 6e73 2069 7320 4e6f 6e65 3a0a  ations is None:.
-000293a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000293b0: 2e64 6173 6b2e 6c61 7965 7273 5b6e 616d  .dask.layers[nam
-000293c0: 655d 2e63 6f6c 6c65 6374 696f 6e5f 616e  e].collection_an
-000293d0: 6e6f 7461 7469 6f6e 7320 3d20 7b0a 2020  notations = {.  
-000293e0: 2020 2020 2020 2020 2020 2020 2020 226e                "n
-000293f0: 7061 7274 6974 696f 6e73 223a 2073 656c  partitions": sel
-00029400: 662e 6e70 6172 7469 7469 6f6e 732c 0a20  f.npartitions,. 
-00029410: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00029420: 636f 6c75 6d6e 7322 3a20 5b63 6f6c 2066  columns": [col f
-00029430: 6f72 2063 6f6c 2069 6e20 7365 6c66 2e63  or col in self.c
-00029440: 6f6c 756d 6e73 5d2c 0a20 2020 2020 2020  olumns],.       
-00029450: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
-00029460: 2074 7970 656e 616d 6528 7479 7065 2873   typename(type(s
-00029470: 656c 6629 292c 0a20 2020 2020 2020 2020  elf)),.         
-00029480: 2020 2020 2020 2022 6461 7461 6672 616d         "datafram
-00029490: 655f 7479 7065 223a 2074 7970 656e 616d  e_type": typenam
-000294a0: 6528 7479 7065 2873 656c 662e 5f6d 6574  e(type(self._met
-000294b0: 6129 292c 0a20 2020 2020 2020 2020 2020  a)),.           
-000294c0: 2020 2020 2022 7365 7269 6573 5f64 7479       "series_dty
-000294d0: 7065 7322 3a20 7b0a 2020 2020 2020 2020  pes": {.        
-000294e0: 2020 2020 2020 2020 2020 2020 636f 6c3a              col:
-000294f0: 2073 656c 662e 5f6d 6574 615b 636f 6c5d   self._meta[col]
-00029500: 2e64 7479 7065 0a20 2020 2020 2020 2020  .dtype.         
-00029510: 2020 2020 2020 2020 2020 2069 6620 6861             if ha
-00029520: 7361 7474 7228 7365 6c66 2e5f 6d65 7461  sattr(self._meta
-00029530: 5b63 6f6c 5d2c 2022 6474 7970 6522 290a  [col], "dtype").
-00029540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029550: 2020 2020 656c 7365 204e 6f6e 650a 2020      else None.  
-00029560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029570: 2020 666f 7220 636f 6c20 696e 2073 656c    for col in sel
-00029580: 662e 5f6d 6574 612e 636f 6c75 6d6e 730a  f._meta.columns.
-00029590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000295a0: 7d2c 0a20 2020 2020 2020 2020 2020 207d  },.            }
-000295b0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-000295c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000295d0: 6461 736b 2e6c 6179 6572 735b 6e61 6d65  dask.layers[name
-000295e0: 5d2e 636f 6c6c 6563 7469 6f6e 5f61 6e6e  ].collection_ann
-000295f0: 6f74 6174 696f 6e73 2e75 7064 6174 6528  otations.update(
-00029600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029610: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-00029620: 2020 2020 2020 2022 6e70 6172 7469 7469         "npartiti
-00029630: 6f6e 7322 3a20 7365 6c66 2e6e 7061 7274  ons": self.npart
-00029640: 6974 696f 6e73 2c0a 2020 2020 2020 2020  itions,.        
-00029650: 2020 2020 2020 2020 2020 2020 2263 6f6c              "col
-00029660: 756d 6e73 223a 205b 636f 6c20 666f 7220  umns": [col for 
-00029670: 636f 6c20 696e 2073 656c 662e 636f 6c75  col in self.colu
-00029680: 6d6e 735d 2c0a 2020 2020 2020 2020 2020  mns],.          
-00029690: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
-000296a0: 3a20 7479 7065 6e61 6d65 2874 7970 6528  : typename(type(
-000296b0: 7365 6c66 2929 2c0a 2020 2020 2020 2020  self)),.        
-000296c0: 2020 2020 2020 2020 2020 2020 2264 6174              "dat
-000296d0: 6166 7261 6d65 5f74 7970 6522 3a20 7479  aframe_type": ty
-000296e0: 7065 6e61 6d65 2874 7970 6528 7365 6c66  pename(type(self
-000296f0: 2e5f 6d65 7461 2929 2c0a 2020 2020 2020  ._meta)),.      
-00029700: 2020 2020 2020 2020 2020 2020 2020 2273                "s
-00029710: 6572 6965 735f 6474 7970 6573 223a 207b  eries_dtypes": {
-00029720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029730: 2020 2020 2020 2020 2063 6f6c 3a20 7365           col: se
-00029740: 6c66 2e5f 6d65 7461 5b63 6f6c 5d2e 6474  lf._meta[col].dt
-00029750: 7970 650a 2020 2020 2020 2020 2020 2020  ype.            
-00029760: 2020 2020 2020 2020 2020 2020 6966 2068              if h
-00029770: 6173 6174 7472 2873 656c 662e 5f6d 6574  asattr(self._met
-00029780: 615b 636f 6c5d 2c20 2264 7479 7065 2229  a[col], "dtype")
-00029790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000297a0: 2020 2020 2020 2020 2065 6c73 6520 4e6f           else No
-000297b0: 6e65 0a20 2020 2020 2020 2020 2020 2020  ne.             
-000297c0: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
-000297d0: 6f6c 2069 6e20 7365 6c66 2e5f 6d65 7461  ol in self._meta
-000297e0: 2e63 6f6c 756d 6e73 0a20 2020 2020 2020  .columns.       
-000297f0: 2020 2020 2020 2020 2020 2020 207d 2c0a               },.
+00028b90: 6374 696f 6e2c 206d 6574 613d 6d65 7461  ction, meta=meta
+00028ba0: 290a 2020 2020 2020 2020 6966 2069 735f  ).        if is_
+00028bb0: 6d6f 6e6f 746f 6e69 6320 616e 6420 7365  monotonic and se
+00028bc0: 6c66 2e6b 6e6f 776e 5f64 6976 6973 696f  lf.known_divisio
+00028bd0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+00028be0: 6170 706c 6965 642e 6469 7669 7369 6f6e  applied.division
+00028bf0: 7320 3d20 7475 706c 6528 0a20 2020 2020  s = tuple(.     
+00028c00: 2020 2020 2020 2020 2020 2070 642e 5365             pd.Se
+00028c10: 7269 6573 2873 656c 662e 6469 7669 7369  ries(self.divisi
+00028c20: 6f6e 7329 2e6d 6170 2861 7267 2c20 6e61  ons).map(arg, na
+00028c30: 5f61 6374 696f 6e3d 6e61 5f61 6374 696f  _action=na_actio
+00028c40: 6e29 0a20 2020 2020 2020 2020 2020 2029  n).            )
+00028c50: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00028c60: 2020 2020 2020 2020 2020 2061 7070 6c69             appli
+00028c70: 6564 203d 2061 7070 6c69 6564 2e63 6c65  ed = applied.cle
+00028c80: 6172 5f64 6976 6973 696f 6e73 2829 0a20  ar_divisions(). 
+00028c90: 2020 2020 2020 2072 6574 7572 6e20 6170         return ap
+00028ca0: 706c 6965 640a 0a20 2020 2069 6620 6e6f  plied..    if no
+00028cb0: 7420 5041 4e44 4153 5f47 545f 3230 303a  t PANDAS_GT_200:
+00028cc0: 0a0a 2020 2020 2020 2020 4070 726f 7065  ..        @prope
+00028cd0: 7274 790a 2020 2020 2020 2020 4064 6572  rty.        @der
+00028ce0: 6976 6564 5f66 726f 6d28 7064 2e49 6e64  ived_from(pd.Ind
+00028cf0: 6578 290a 2020 2020 2020 2020 6465 6620  ex).        def 
+00028d00: 6973 5f6d 6f6e 6f74 6f6e 6963 2873 656c  is_monotonic(sel
+00028d10: 6629 3a0a 2020 2020 2020 2020 2020 2020  f):.            
+00028d20: 6966 2050 414e 4441 535f 4754 5f31 3530  if PANDAS_GT_150
+00028d30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00028d40: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+00028d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028d60: 2020 2020 2022 6973 5f6d 6f6e 6f74 6f6e       "is_monoton
+00028d70: 6963 2069 7320 6465 7072 6563 6174 6564  ic is deprecated
+00028d80: 2061 6e64 2077 696c 6c20 6265 2072 656d   and will be rem
+00028d90: 6f76 6564 2069 6e20 6120 6675 7475 7265  oved in a future
+00028da0: 2076 6572 7369 6f6e 2e20 220a 2020 2020   version. ".    
+00028db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028dc0: 2255 7365 2069 735f 6d6f 6e6f 746f 6e69  "Use is_monotoni
+00028dd0: 635f 696e 6372 6561 7369 6e67 2069 6e73  c_increasing ins
+00028de0: 7465 6164 2e22 2c0a 2020 2020 2020 2020  tead.",.        
+00028df0: 2020 2020 2020 2020 2020 2020 4675 7475              Futu
+00028e00: 7265 5761 726e 696e 672c 0a20 2020 2020  reWarning,.     
+00028e10: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00028e20: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00028e30: 7375 7065 7228 292e 6973 5f6d 6f6e 6f74  super().is_monot
+00028e40: 6f6e 6963 5f69 6e63 7265 6173 696e 670a  onic_increasing.
+00028e50: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00028e60: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00028e70: 2870 642e 496e 6465 7829 0a20 2020 2064  (pd.Index).    d
+00028e80: 6566 2069 735f 6d6f 6e6f 746f 6e69 635f  ef is_monotonic_
+00028e90: 696e 6372 6561 7369 6e67 2873 656c 6629  increasing(self)
+00028ea0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00028eb0: 2073 7570 6572 2829 2e69 735f 6d6f 6e6f   super().is_mono
+00028ec0: 746f 6e69 635f 696e 6372 6561 7369 6e67  tonic_increasing
+00028ed0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00028ee0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00028ef0: 6d28 7064 2e49 6e64 6578 290a 2020 2020  m(pd.Index).    
+00028f00: 6465 6620 6973 5f6d 6f6e 6f74 6f6e 6963  def is_monotonic
+00028f10: 5f64 6563 7265 6173 696e 6728 7365 6c66  _decreasing(self
+00028f20: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00028f30: 6e20 7375 7065 7228 292e 6973 5f6d 6f6e  n super().is_mon
+00028f40: 6f74 6f6e 6963 5f64 6563 7265 6173 696e  otonic_decreasin
+00028f50: 670a 0a20 2020 2040 6465 7269 7665 645f  g..    @derived_
+00028f60: 6672 6f6d 2870 642e 496e 6465 7829 0a20  from(pd.Index). 
+00028f70: 2020 2064 6566 206d 656d 6f72 795f 7573     def memory_us
+00028f80: 6167 6528 7365 6c66 2c20 6465 6570 3d46  age(self, deep=F
+00028f90: 616c 7365 293a 0a20 2020 2020 2020 2072  alse):.        r
+00028fa0: 6574 7572 6e20 7365 6c66 2e72 6564 7563  eturn self.reduc
+00028fb0: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
+00028fc0: 2020 4d2e 6d65 6d6f 7279 5f75 7361 6765    M.memory_usage
+00028fd0: 2c0a 2020 2020 2020 2020 2020 2020 4d2e  ,.            M.
+00028fe0: 7375 6d2c 0a20 2020 2020 2020 2020 2020  sum,.           
+00028ff0: 2063 6875 6e6b 5f6b 7761 7267 733d 7b22   chunk_kwargs={"
+00029000: 6465 6570 223a 2064 6565 707d 2c0a 2020  deep": deep},.  
+00029010: 2020 2020 2020 2020 2020 7370 6c69 745f            split_
+00029020: 6576 6572 793d 4661 6c73 652c 0a20 2020  every=False,.   
+00029030: 2020 2020 2020 2020 2074 6f6b 656e 3d73           token=s
+00029040: 656c 662e 5f74 6f6b 656e 5f70 7265 6669  elf._token_prefi
+00029050: 7820 2b20 226d 656d 6f72 792d 7573 6167  x + "memory-usag
+00029060: 6522 2c0a 2020 2020 2020 2020 290a 0a0a  e",.        )...
+00029070: 636c 6173 7320 4461 7461 4672 616d 6528  class DataFrame(
+00029080: 5f46 7261 6d65 293a 0a20 2020 2022 2222  _Frame):.    """
+00029090: 0a20 2020 2050 6172 616c 6c65 6c20 5061  .    Parallel Pa
+000290a0: 6e64 6173 2044 6174 6146 7261 6d65 0a0a  ndas DataFrame..
+000290b0: 2020 2020 446f 206e 6f74 2075 7365 2074      Do not use t
+000290c0: 6869 7320 636c 6173 7320 6469 7265 6374  his class direct
+000290d0: 6c79 2e20 2049 6e73 7465 6164 2075 7365  ly.  Instead use
+000290e0: 2066 756e 6374 696f 6e73 206c 696b 650a   functions like.
+000290f0: 2020 2020 6060 6464 2e72 6561 645f 6373      ``dd.read_cs
+00029100: 7660 602c 2060 6064 642e 7265 6164 5f70  v``, ``dd.read_p
+00029110: 6172 7175 6574 6060 2c20 6f72 2060 6064  arquet``, or ``d
+00029120: 642e 6672 6f6d 5f70 616e 6461 7360 602e  d.from_pandas``.
+00029130: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+00029140: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+00029150: 2020 2020 6473 6b3a 2064 6963 740a 2020      dsk: dict.  
+00029160: 2020 2020 2020 5468 6520 6461 736b 2067        The dask g
+00029170: 7261 7068 2074 6f20 636f 6d70 7574 6520  raph to compute 
+00029180: 7468 6973 2044 6174 6146 7261 6d65 0a20  this DataFrame. 
+00029190: 2020 206e 616d 653a 2073 7472 0a20 2020     name: str.   
+000291a0: 2020 2020 2054 6865 206b 6579 2070 7265       The key pre
+000291b0: 6669 7820 7468 6174 2073 7065 6369 6669  fix that specifi
+000291c0: 6573 2077 6869 6368 206b 6579 7320 696e  es which keys in
+000291d0: 2074 6865 2064 6173 6b20 636f 6d70 7269   the dask compri
+000291e0: 7365 2074 6869 730a 2020 2020 2020 2020  se this.        
+000291f0: 7061 7274 6963 756c 6172 2044 6174 6146  particular DataF
+00029200: 7261 6d65 0a20 2020 206d 6574 613a 2070  rame.    meta: p
+00029210: 616e 6461 732e 4461 7461 4672 616d 650a  andas.DataFrame.
+00029220: 2020 2020 2020 2020 416e 2065 6d70 7479          An empty
+00029230: 2060 6070 616e 6461 732e 4461 7461 4672   ``pandas.DataFr
+00029240: 616d 6560 6020 7769 7468 206e 616d 6573  ame`` with names
+00029250: 2c20 6474 7970 6573 2c20 616e 6420 696e  , dtypes, and in
+00029260: 6465 7820 6d61 7463 6869 6e67 0a20 2020  dex matching.   
+00029270: 2020 2020 2074 6865 2065 7870 6563 7465       the expecte
+00029280: 6420 6f75 7470 7574 2e0a 2020 2020 6469  d output..    di
+00029290: 7669 7369 6f6e 733a 2074 7570 6c65 206f  visions: tuple o
+000292a0: 6620 696e 6465 7820 7661 6c75 6573 0a20  f index values. 
+000292b0: 2020 2020 2020 2056 616c 7565 7320 616c         Values al
+000292c0: 6f6e 6720 7768 6963 6820 7765 2070 6172  ong which we par
+000292d0: 7469 7469 6f6e 206f 7572 2062 6c6f 636b  tition our block
+000292e0: 7320 6f6e 2074 6865 2069 6e64 6578 0a20  s on the index. 
+000292f0: 2020 2022 2222 0a0a 2020 2020 5f70 6172     """..    _par
+00029300: 7469 7469 6f6e 5f74 7970 6520 3d20 7064  tition_type = pd
+00029310: 2e44 6174 6146 7261 6d65 0a20 2020 205f  .DataFrame.    _
+00029320: 6973 5f70 6172 7469 7469 6f6e 5f74 7970  is_partition_typ
+00029330: 6520 3d20 7374 6174 6963 6d65 7468 6f64  e = staticmethod
+00029340: 2869 735f 6461 7461 6672 616d 655f 6c69  (is_dataframe_li
+00029350: 6b65 290a 2020 2020 5f74 6f6b 656e 5f70  ke).    _token_p
+00029360: 7265 6669 7820 3d20 2264 6174 6166 7261  refix = "datafra
+00029370: 6d65 2d22 0a20 2020 205f 6163 6365 7373  me-".    _access
+00029380: 6f72 733a 2043 6c61 7373 5661 725b 7365  ors: ClassVar[se
+00029390: 745b 7374 725d 5d20 3d20 7365 7428 290a  t[str]] = set().
+000293a0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+000293b0: 5f28 7365 6c66 2c20 6473 6b2c 206e 616d  _(self, dsk, nam
+000293c0: 652c 206d 6574 612c 2064 6976 6973 696f  e, meta, divisio
+000293d0: 6e73 293a 0a20 2020 2020 2020 2073 7570  ns):.        sup
+000293e0: 6572 2829 2e5f 5f69 6e69 745f 5f28 6473  er().__init__(ds
+000293f0: 6b2c 206e 616d 652c 206d 6574 612c 2064  k, name, meta, d
+00029400: 6976 6973 696f 6e73 290a 2020 2020 2020  ivisions).      
+00029410: 2020 6966 2073 656c 662e 6461 736b 2e6c    if self.dask.l
+00029420: 6179 6572 735b 6e61 6d65 5d2e 636f 6c6c  ayers[name].coll
+00029430: 6563 7469 6f6e 5f61 6e6e 6f74 6174 696f  ection_annotatio
+00029440: 6e73 2069 7320 4e6f 6e65 3a0a 2020 2020  ns is None:.    
+00029450: 2020 2020 2020 2020 7365 6c66 2e64 6173          self.das
+00029460: 6b2e 6c61 7965 7273 5b6e 616d 655d 2e63  k.layers[name].c
+00029470: 6f6c 6c65 6374 696f 6e5f 616e 6e6f 7461  ollection_annota
+00029480: 7469 6f6e 7320 3d20 7b0a 2020 2020 2020  tions = {.      
+00029490: 2020 2020 2020 2020 2020 226e 7061 7274            "npart
+000294a0: 6974 696f 6e73 223a 2073 656c 662e 6e70  itions": self.np
+000294b0: 6172 7469 7469 6f6e 732c 0a20 2020 2020  artitions,.     
+000294c0: 2020 2020 2020 2020 2020 2022 636f 6c75             "colu
+000294d0: 6d6e 7322 3a20 5b63 6f6c 2066 6f72 2063  mns": [col for c
+000294e0: 6f6c 2069 6e20 7365 6c66 2e63 6f6c 756d  ol in self.colum
+000294f0: 6e73 5d2c 0a20 2020 2020 2020 2020 2020  ns],.           
+00029500: 2020 2020 2022 7479 7065 223a 2074 7970       "type": typ
+00029510: 656e 616d 6528 7479 7065 2873 656c 6629  ename(type(self)
+00029520: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00029530: 2020 2022 6461 7461 6672 616d 655f 7479     "dataframe_ty
+00029540: 7065 223a 2074 7970 656e 616d 6528 7479  pe": typename(ty
+00029550: 7065 2873 656c 662e 5f6d 6574 6129 292c  pe(self._meta)),
+00029560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029570: 2022 7365 7269 6573 5f64 7479 7065 7322   "series_dtypes"
+00029580: 3a20 7b0a 2020 2020 2020 2020 2020 2020  : {.            
+00029590: 2020 2020 2020 2020 636f 6c3a 2073 656c          col: sel
+000295a0: 662e 5f6d 6574 615b 636f 6c5d 2e64 7479  f._meta[col].dty
+000295b0: 7065 0a20 2020 2020 2020 2020 2020 2020  pe.             
+000295c0: 2020 2020 2020 2069 6620 6861 7361 7474         if hasatt
+000295d0: 7228 7365 6c66 2e5f 6d65 7461 5b63 6f6c  r(self._meta[col
+000295e0: 5d2c 2022 6474 7970 6522 290a 2020 2020  ], "dtype").    
+000295f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029600: 656c 7365 204e 6f6e 650a 2020 2020 2020  else None.      
+00029610: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00029620: 7220 636f 6c20 696e 2073 656c 662e 5f6d  r col in self._m
+00029630: 6574 612e 636f 6c75 6d6e 730a 2020 2020  eta.columns.    
+00029640: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+00029650: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+00029660: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00029670: 2020 2020 2020 2073 656c 662e 6461 736b         self.dask
+00029680: 2e6c 6179 6572 735b 6e61 6d65 5d2e 636f  .layers[name].co
+00029690: 6c6c 6563 7469 6f6e 5f61 6e6e 6f74 6174  llection_annotat
+000296a0: 696f 6e73 2e75 7064 6174 6528 0a20 2020  ions.update(.   
+000296b0: 2020 2020 2020 2020 2020 2020 207b 0a20               {. 
+000296c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000296d0: 2020 2022 6e70 6172 7469 7469 6f6e 7322     "npartitions"
+000296e0: 3a20 7365 6c66 2e6e 7061 7274 6974 696f  : self.npartitio
+000296f0: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
+00029700: 2020 2020 2020 2020 2263 6f6c 756d 6e73          "columns
+00029710: 223a 205b 636f 6c20 666f 7220 636f 6c20  ": [col for col 
+00029720: 696e 2073 656c 662e 636f 6c75 6d6e 735d  in self.columns]
+00029730: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00029740: 2020 2020 2020 2274 7970 6522 3a20 7479        "type": ty
+00029750: 7065 6e61 6d65 2874 7970 6528 7365 6c66  pename(type(self
+00029760: 2929 2c0a 2020 2020 2020 2020 2020 2020  )),.            
+00029770: 2020 2020 2020 2020 2264 6174 6166 7261          "datafra
+00029780: 6d65 5f74 7970 6522 3a20 7479 7065 6e61  me_type": typena
+00029790: 6d65 2874 7970 6528 7365 6c66 2e5f 6d65  me(type(self._me
+000297a0: 7461 2929 2c0a 2020 2020 2020 2020 2020  ta)),.          
+000297b0: 2020 2020 2020 2020 2020 2273 6572 6965            "serie
+000297c0: 735f 6474 7970 6573 223a 207b 0a20 2020  s_dtypes": {.   
+000297d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000297e0: 2020 2020 2063 6f6c 3a20 7365 6c66 2e5f       col: self._
+000297f0: 6d65 7461 5b63 6f6c 5d2e 6474 7970 650a  meta[col].dtype.
 00029800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029810: 7d0a 2020 2020 2020 2020 2020 2020 290a  }.            ).
-00029820: 0a20 2020 2064 6566 205f 5f61 7272 6179  .    def __array
-00029830: 5f77 7261 705f 5f28 7365 6c66 2c20 6172  _wrap__(self, ar
-00029840: 7261 792c 2063 6f6e 7465 7874 3d4e 6f6e  ray, context=Non
-00029850: 6529 3a0a 2020 2020 2020 2020 6966 2069  e):.        if i
-00029860: 7369 6e73 7461 6e63 6528 636f 6e74 6578  sinstance(contex
-00029870: 742c 2074 7570 6c65 2920 616e 6420 6c65  t, tuple) and le
-00029880: 6e28 636f 6e74 6578 7429 203e 2030 3a0a  n(context) > 0:.
-00029890: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-000298a0: 7369 6e73 7461 6e63 6528 636f 6e74 6578  sinstance(contex
-000298b0: 745b 315d 5b30 5d2c 206e 702e 6e64 6172  t[1][0], np.ndar
-000298c0: 7261 7929 2061 6e64 2063 6f6e 7465 7874  ray) and context
-000298d0: 5b31 5d5b 305d 2e73 6861 7065 203d 3d20  [1][0].shape == 
-000298e0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-000298f0: 2020 2020 696e 6465 7820 3d20 4e6f 6e65      index = None
-00029900: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00029910: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00029920: 2020 2069 6e64 6578 203d 2063 6f6e 7465     index = conte
-00029930: 7874 5b31 5d5b 305d 2e69 6e64 6578 0a20  xt[1][0].index. 
-00029940: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00029950: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-00029960: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00029970: 706f 7274 2069 6e73 7065 6374 0a0a 2020  port inspect..  
-00029980: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-00029990: 7468 6f64 5f6e 616d 6520 3d20 6622 607b  thod_name = f"`{
-000299a0: 696e 7370 6563 742e 7374 6163 6b28 295b  inspect.stack()[
-000299b0: 335d 5b33 5d7d 6022 0a20 2020 2020 2020  3][3]}`".       
-000299c0: 2020 2020 2065 7863 6570 7420 496e 6465       except Inde
-000299d0: 7845 7272 6f72 3a0a 2020 2020 2020 2020  xError:.        
-000299e0: 2020 2020 2020 2020 6d65 7468 6f64 5f6e          method_n
-000299f0: 616d 6520 3d20 2254 6869 7320 6d65 7468  ame = "This meth
-00029a00: 6f64 220a 0a20 2020 2020 2020 2020 2020  od"..           
-00029a10: 2072 6169 7365 204e 6f74 496d 706c 656d   raise NotImplem
-00029a20: 656e 7465 6445 7272 6f72 280a 2020 2020  entedError(.    
-00029a30: 2020 2020 2020 2020 2020 2020 6622 7b6d              f"{m
-00029a40: 6574 686f 645f 6e61 6d65 7d20 6973 206e  ethod_name} is n
-00029a50: 6f74 2069 6d70 6c65 6d65 6e74 6564 2066  ot implemented f
-00029a60: 6f72 2060 6461 736b 2e64 6174 6166 7261  or `dask.datafra
-00029a70: 6d65 2e44 6174 6146 7261 6d65 602e 220a  me.DataFrame`.".
-00029a80: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00029a90: 2020 2020 2020 2072 6574 7572 6e20 6d65         return me
-00029aa0: 7461 5f66 7261 6d65 5f63 6f6e 7374 7275  ta_frame_constru
-00029ab0: 6374 6f72 2873 656c 6629 2861 7272 6179  ctor(self)(array
-00029ac0: 2c20 696e 6465 783d 696e 6465 782c 2063  , index=index, c
-00029ad0: 6f6c 756d 6e73 3d73 656c 662e 636f 6c75  olumns=self.colu
-00029ae0: 6d6e 7329 0a0a 2020 2020 4070 726f 7065  mns)..    @prope
-00029af0: 7274 790a 2020 2020 6465 6620 6178 6573  rty.    def axes
-00029b00: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00029b10: 7265 7475 726e 205b 7365 6c66 2e69 6e64  return [self.ind
-00029b20: 6578 2c20 7365 6c66 2e63 6f6c 756d 6e73  ex, self.columns
-00029b30: 5d0a 0a20 2020 2040 7072 6f70 6572 7479  ]..    @property
-00029b40: 0a20 2020 2064 6566 2063 6f6c 756d 6e73  .    def columns
-00029b50: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00029b60: 7265 7475 726e 2073 656c 662e 5f6d 6574  return self._met
-00029b70: 612e 636f 6c75 6d6e 730a 0a20 2020 2040  a.columns..    @
-00029b80: 636f 6c75 6d6e 732e 7365 7474 6572 0a20  columns.setter. 
-00029b90: 2020 2064 6566 2063 6f6c 756d 6e73 2873     def columns(s
-00029ba0: 656c 662c 2063 6f6c 756d 6e73 293a 0a20  elf, columns):. 
-00029bb0: 2020 2020 2020 2072 656e 616d 6564 203d         renamed =
-00029bc0: 205f 7265 6e61 6d65 5f64 6173 6b28 7365   _rename_dask(se
-00029bd0: 6c66 2c20 636f 6c75 6d6e 7329 0a20 2020  lf, columns).   
-00029be0: 2020 2020 2073 656c 662e 5f6d 6574 6120       self._meta 
-00029bf0: 3d20 7265 6e61 6d65 642e 5f6d 6574 610a  = renamed._meta.
-00029c00: 2020 2020 2020 2020 7365 6c66 2e5f 6e61          self._na
-00029c10: 6d65 203d 2072 656e 616d 6564 2e5f 6e61  me = renamed._na
-00029c20: 6d65 0a20 2020 2020 2020 2073 656c 662e  me.        self.
-00029c30: 6461 736b 203d 2072 656e 616d 6564 2e64  dask = renamed.d
-00029c40: 6173 6b0a 0a20 2020 2040 7072 6f70 6572  ask..    @proper
-00029c50: 7479 0a20 2020 2064 6566 2069 6c6f 6328  ty.    def iloc(
-00029c60: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00029c70: 2222 5075 7265 6c79 2069 6e74 6567 6572  ""Purely integer
-00029c80: 2d6c 6f63 6174 696f 6e20 6261 7365 6420  -location based 
-00029c90: 696e 6465 7869 6e67 2066 6f72 2073 656c  indexing for sel
-00029ca0: 6563 7469 6f6e 2062 7920 706f 7369 7469  ection by positi
-00029cb0: 6f6e 2e0a 0a20 2020 2020 2020 204f 6e6c  on...        Onl
-00029cc0: 7920 696e 6465 7869 6e67 2074 6865 2063  y indexing the c
-00029cd0: 6f6c 756d 6e20 706f 7369 7469 6f6e 7320  olumn positions 
-00029ce0: 6973 2073 7570 706f 7274 6564 2e20 5472  is supported. Tr
-00029cf0: 7969 6e67 2074 6f20 7365 6c65 6374 0a20  ying to select. 
-00029d00: 2020 2020 2020 2072 6f77 2070 6f73 6974         row posit
-00029d10: 696f 6e73 2077 696c 6c20 7261 6973 6520  ions will raise 
-00029d20: 6120 5661 6c75 6545 7272 6f72 2e0a 0a20  a ValueError... 
-00029d30: 2020 2020 2020 2053 6565 203a 7265 663a         See :ref:
-00029d40: 6064 6174 6166 7261 6d65 2e69 6e64 6578  `dataframe.index
-00029d50: 696e 6760 2066 6f72 206d 6f72 652e 0a0a  ing` for more...
-00029d60: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
-00029d70: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00029d80: 2d0a 2020 2020 2020 2020 3e3e 3e20 6466  -.        >>> df
-00029d90: 2e69 6c6f 635b 3a2c 205b 322c 2030 2c20  .iloc[:, [2, 0, 
-00029da0: 315d 5d20 2023 2064 6f63 7465 7374 3a20  1]]  # doctest: 
-00029db0: 2b53 4b49 500a 2020 2020 2020 2020 2222  +SKIP.        ""
-00029dc0: 220a 2020 2020 2020 2020 6672 6f6d 2064  ".        from d
-00029dd0: 6173 6b2e 6461 7461 6672 616d 652e 696e  ask.dataframe.in
-00029de0: 6465 7869 6e67 2069 6d70 6f72 7420 5f69  dexing import _i
-00029df0: 4c6f 6349 6e64 6578 6572 0a0a 2020 2020  LocIndexer..    
-00029e00: 2020 2020 2320 466f 7220 6461 7461 6672      # For datafr
-00029e10: 616d 6573 2077 6974 6820 756e 6971 7565  ames with unique
-00029e20: 2063 6f6c 756d 6e20 6e61 6d65 732c 2074   column names, t
-00029e30: 6869 7320 7769 6c6c 2062 6520 7472 616e  his will be tran
-00029e40: 7366 6f72 6d65 6420 696e 746f 2061 205f  sformed into a _
-00029e50: 5f67 6574 6974 656d 5f5f 2063 616c 6c0a  _getitem__ call.
-00029e60: 2020 2020 2020 2020 7265 7475 726e 205f          return _
-00029e70: 694c 6f63 496e 6465 7865 7228 7365 6c66  iLocIndexer(self
-00029e80: 290a 0a20 2020 2064 6566 205f 5f6c 656e  )..    def __len
-00029e90: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-00029ea0: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-00029eb0: 2020 2073 203d 2073 656c 662e 696c 6f63     s = self.iloc
-00029ec0: 5b3a 2c20 305d 0a20 2020 2020 2020 2065  [:, 0].        e
-00029ed0: 7863 6570 7420 496e 6465 7845 7272 6f72  xcept IndexError
-00029ee0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00029ef0: 7475 726e 2073 7570 6572 2829 2e5f 5f6c  turn super().__l
-00029f00: 656e 5f5f 2829 0a20 2020 2020 2020 2065  en__().        e
-00029f10: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00029f20: 2072 6574 7572 6e20 6c65 6e28 7329 0a0a   return len(s)..
-00029f30: 2020 2020 6465 6620 5f5f 636f 6e74 6169      def __contai
-00029f40: 6e73 5f5f 2873 656c 662c 206b 6579 293a  ns__(self, key):
-00029f50: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00029f60: 6b65 7920 696e 2073 656c 662e 5f6d 6574  key in self._met
-00029f70: 610a 0a20 2020 2040 7072 6f70 6572 7479  a..    @property
-00029f80: 0a20 2020 2064 6566 2065 6d70 7479 2873  .    def empty(s
-00029f90: 656c 6629 3a0a 2020 2020 2020 2020 2320  elf):.        # 
-00029fa0: 5f5f 6765 7461 7474 725f 5f20 7769 6c6c  __getattr__ will
-00029fb0: 2062 6520 6361 6c6c 6564 2061 6674 6572   be called after
-00029fc0: 2077 6520 7261 6973 6520 7468 6973 2c20   we raise this, 
-00029fd0: 736f 2077 6527 6c6c 2072 6169 7365 2069  so we'll raise i
-00029fe0: 7420 6167 6169 6e20 6672 6f6d 2074 6865  t again from the
-00029ff0: 7265 0a20 2020 2020 2020 2072 6169 7365  re.        raise
-0002a000: 2041 7474 7269 6275 7465 4e6f 7449 6d70   AttributeNotImp
-0002a010: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
-0002a020: 2020 2020 2020 2020 2020 2022 4368 6563             "Chec
-0002a030: 6b69 6e67 2077 6865 7468 6572 2061 2044  king whether a D
-0002a040: 6173 6b20 4461 7461 4672 616d 6520 6861  ask DataFrame ha
-0002a050: 7320 616e 7920 726f 7773 206d 6179 2062  s any rows may b
-0002a060: 6520 6578 7065 6e73 6976 652e 2022 0a20  e expensive. ". 
-0002a070: 2020 2020 2020 2020 2020 2022 486f 7765             "Howe
-0002a080: 7665 722c 2063 6865 636b 696e 6720 7468  ver, checking th
-0002a090: 6520 6e75 6d62 6572 206f 6620 636f 6c75  e number of colu
-0002a0a0: 6d6e 7320 6973 2066 6173 742e 2022 0a20  mns is fast. ". 
-0002a0b0: 2020 2020 2020 2020 2020 2022 4465 7065             "Depe
-0002a0c0: 6e64 696e 6720 6f6e 2077 6869 6368 206f  nding on which o
-0002a0d0: 6620 7468 6573 6520 7265 7375 6c74 7320  f these results 
-0002a0e0: 796f 7520 6e65 6564 2c20 7573 6520 6569  you need, use ei
-0002a0f0: 7468 6572 2022 0a20 2020 2020 2020 2020  ther ".         
-0002a100: 2020 2022 606c 656e 2864 662e 696e 6465     "`len(df.inde
-0002a110: 7829 203d 3d20 3060 206f 7220 606c 656e  x) == 0` or `len
-0002a120: 2864 662e 636f 6c75 6d6e 7329 203d 3d20  (df.columns) == 
-0002a130: 3060 220a 2020 2020 2020 2020 290a 0a20  0`".        ).. 
-0002a140: 2020 2064 6566 205f 5f67 6574 6974 656d     def __getitem
-0002a150: 5f5f 2873 656c 662c 206b 6579 293a 0a20  __(self, key):. 
-0002a160: 2020 2020 2020 206e 616d 6520 3d20 2267         name = "g
-0002a170: 6574 6974 656d 2d25 7322 2025 2074 6f6b  etitem-%s" % tok
-0002a180: 656e 697a 6528 7365 6c66 2c20 6b65 7929  enize(self, key)
-0002a190: 0a20 2020 2020 2020 2069 6620 6e70 2e69  .        if np.i
-0002a1a0: 7373 6361 6c61 7228 6b65 7929 206f 7220  sscalar(key) or 
-0002a1b0: 6973 696e 7374 616e 6365 286b 6579 2c20  isinstance(key, 
-0002a1c0: 2874 7570 6c65 2c20 7374 7229 293a 0a20  (tuple, str)):. 
-0002a1d0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-0002a1e0: 696e 7374 616e 6365 2873 656c 662e 5f6d  instance(self._m
-0002a1f0: 6574 612e 696e 6465 782c 2028 7064 2e44  eta.index, (pd.D
-0002a200: 6174 6574 696d 6549 6e64 6578 2c20 7064  atetimeIndex, pd
-0002a210: 2e50 6572 696f 6449 6e64 6578 2929 3a0a  .PeriodIndex)):.
-0002a220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a230: 6966 206b 6579 206e 6f74 2069 6e20 7365  if key not in se
-0002a240: 6c66 2e5f 6d65 7461 2e63 6f6c 756d 6e73  lf._meta.columns
-0002a250: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002a260: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-0002a270: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
-0002a280: 2020 2020 2020 2020 2020 2020 2022 496e               "In
-0002a290: 6465 7869 6e67 2061 2044 6174 6146 7261  dexing a DataFra
-0002a2a0: 6d65 2077 6974 6820 6120 6461 7465 7469  me with a dateti
-0002a2b0: 6d65 6c69 6b65 2069 6e64 6578 2075 7369  melike index usi
-0002a2c0: 6e67 2061 2073 696e 676c 6520 220a 2020  ng a single ".  
-0002a2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a2e0: 2020 2020 2020 2273 7472 696e 6720 746f        "string to
-0002a2f0: 2073 6c69 6365 2074 6865 2072 6f77 732c   slice the rows,
-0002a300: 206c 696b 6520 6066 7261 6d65 5b73 7472   like `frame[str
-0002a310: 696e 675d 602c 2069 7320 6465 7072 6563  ing]`, is deprec
-0002a320: 6174 6564 2022 0a20 2020 2020 2020 2020  ated ".         
-0002a330: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002a340: 616e 6420 7769 6c6c 2062 6520 7265 6d6f  and will be remo
-0002a350: 7665 6420 696e 2061 2066 7574 7572 6520  ved in a future 
-0002a360: 7665 7273 696f 6e2e 2055 7365 2060 6672  version. Use `fr
-0002a370: 616d 652e 6c6f 635b 7374 7269 6e67 5d60  ame.loc[string]`
-0002a380: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-0002a390: 2020 2020 2020 2020 2020 2022 696e 7374             "inst
-0002a3a0: 6561 642e 222c 0a20 2020 2020 2020 2020  ead.",.         
-0002a3b0: 2020 2020 2020 2020 2020 2020 2020 2046                 F
-0002a3c0: 7574 7572 6557 6172 6e69 6e67 2c0a 2020  utureWarning,.  
-0002a3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a3e0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0002a3f0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002a400: 656c 662e 6c6f 635b 6b65 795d 0a0a 2020  elf.loc[key]..  
-0002a410: 2020 2020 2020 2020 2020 2320 6572 726f            # erro
-0002a420: 7220 6973 2072 6169 7365 6420 6672 6f6d  r is raised from
-0002a430: 2070 616e 6461 730a 2020 2020 2020 2020   pandas.        
-0002a440: 2020 2020 6d65 7461 203d 2073 656c 662e      meta = self.
-0002a450: 5f6d 6574 615b 5f65 7874 7261 6374 5f6d  _meta[_extract_m
-0002a460: 6574 6128 6b65 7929 5d0a 2020 2020 2020  eta(key)].      
-0002a470: 2020 2020 2020 6473 6b20 3d20 7061 7274        dsk = part
-0002a480: 6974 696f 6e77 6973 655f 6772 6170 6828  itionwise_graph(
-0002a490: 6f70 6572 6174 6f72 2e67 6574 6974 656d  operator.getitem
-0002a4a0: 2c20 6e61 6d65 2c20 7365 6c66 2c20 6b65  , name, self, ke
-0002a4b0: 7929 0a20 2020 2020 2020 2020 2020 2067  y).            g
-0002a4c0: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
-0002a4d0: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
-0002a4e0: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
-0002a4f0: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
-0002a500: 7365 6c66 5d29 0a20 2020 2020 2020 2020  self]).         
-0002a510: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
-0002a520: 5f6f 626a 6563 7428 6772 6170 682c 206e  _object(graph, n
-0002a530: 616d 652c 206d 6574 612c 2073 656c 662e  ame, meta, self.
-0002a540: 6469 7669 7369 6f6e 7329 0a20 2020 2020  divisions).     
-0002a550: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-0002a560: 6365 286b 6579 2c20 736c 6963 6529 3a0a  ce(key, slice):.
-0002a570: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
-0002a580: 2070 616e 6461 732e 6170 692e 7479 7065   pandas.api.type
-0002a590: 7320 696d 706f 7274 2069 735f 666c 6f61  s import is_floa
-0002a5a0: 745f 6474 7970 650a 0a20 2020 2020 2020  t_dtype..       
-0002a5b0: 2020 2020 2069 735f 696e 7465 6765 725f       is_integer_
-0002a5c0: 736c 6963 6520 3d20 616e 7928 0a20 2020  slice = any(.   
-0002a5d0: 2020 2020 2020 2020 2020 2020 2069 7369               isi
-0002a5e0: 6e73 7461 6e63 6528 692c 2049 6e74 6567  nstance(i, Integ
-0002a5f0: 7261 6c29 2066 6f72 2069 2069 6e20 286b  ral) for i in (k
-0002a600: 6579 2e73 7461 7274 2c20 6b65 792e 7374  ey.start, key.st
-0002a610: 6570 2c20 6b65 792e 7374 6f70 290a 2020  ep, key.stop).  
-0002a620: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0002a630: 2020 2020 2020 2020 2320 536c 6963 696e          # Slicin
-0002a640: 6720 7769 7468 2069 6e74 6567 6572 206c  g with integer l
-0002a650: 6162 656c 7320 6973 2061 6c77 6179 7320  abels is always 
-0002a660: 696c 6f63 2062 6173 6564 2065 7863 6570  iloc based excep
-0002a670: 7420 666f 7220 610a 2020 2020 2020 2020  t for a.        
-0002a680: 2020 2020 2320 666c 6f61 7420 696e 6465      # float inde
-0002a690: 7865 7220 666f 7220 736f 6d65 2072 6561  xer for some rea
-0002a6a0: 736f 6e0a 2020 2020 2020 2020 2020 2020  son.            
-0002a6b0: 6966 2069 735f 696e 7465 6765 725f 736c  if is_integer_sl
-0002a6c0: 6963 6520 616e 6420 6e6f 7420 6973 5f66  ice and not is_f
-0002a6d0: 6c6f 6174 5f64 7479 7065 2873 656c 662e  loat_dtype(self.
-0002a6e0: 696e 6465 782e 6474 7970 6529 3a0a 2020  index.dtype):.  
-0002a6f0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0002a700: 4e4f 5445 3a20 7468 6973 2061 6c77 6179  NOTE: this alway
-0002a710: 7320 6661 696c 7320 6375 7272 656e 746c  s fails currentl
-0002a720: 792c 2061 7320 696c 6f63 2069 7320 6d6f  y, as iloc is mo
-0002a730: 7374 6c79 0a20 2020 2020 2020 2020 2020  stly.           
-0002a740: 2020 2020 2023 2075 6e73 7570 706f 7274       # unsupport
-0002a750: 6564 2c20 6275 7420 7765 2063 616c 6c20  ed, but we call 
-0002a760: 6974 2061 6e79 7761 7920 6865 7265 2066  it anyway here f
-0002a770: 6f72 2066 7574 7572 652d 7072 6f6f 6669  or future-proofi
-0002a780: 6e67 0a20 2020 2020 2020 2020 2020 2020  ng.             
-0002a790: 2020 2023 2061 6e64 2065 7272 6f72 2d61     # and error-a
-0002a7a0: 7474 7269 6275 7469 6f6e 2070 7572 706f  ttribution purpo
-0002a7b0: 7365 730a 2020 2020 2020 2020 2020 2020  ses.            
-0002a7c0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0002a7d0: 696c 6f63 5b6b 6579 5d0a 2020 2020 2020  iloc[key].      
-0002a7e0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0002a7f0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0002a800: 726e 2073 656c 662e 6c6f 635b 6b65 795d  rn self.loc[key]
-0002a810: 0a0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
-0002a820: 6e73 7461 6e63 6528 6b65 792c 2028 6e70  nstance(key, (np
-0002a830: 2e6e 6461 7272 6179 2c20 6c69 7374 2929  .ndarray, list))
-0002a840: 206f 7220 280a 2020 2020 2020 2020 2020   or (.          
-0002a850: 2020 6e6f 7420 6973 5f64 6173 6b5f 636f    not is_dask_co
-0002a860: 6c6c 6563 7469 6f6e 286b 6579 2920 616e  llection(key) an
-0002a870: 6420 2869 735f 7365 7269 6573 5f6c 696b  d (is_series_lik
-0002a880: 6528 6b65 7929 206f 7220 6973 5f69 6e64  e(key) or is_ind
-0002a890: 6578 5f6c 696b 6528 6b65 7929 290a 2020  ex_like(key)).  
-0002a8a0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-0002a8b0: 2020 2020 2023 2065 7272 6f72 2069 7320       # error is 
-0002a8c0: 7261 6973 6564 2066 726f 6d20 7061 6e64  raised from pand
-0002a8d0: 6173 0a20 2020 2020 2020 2020 2020 206d  as.            m
-0002a8e0: 6574 6120 3d20 7365 6c66 2e5f 6d65 7461  eta = self._meta
-0002a8f0: 5b5f 6578 7472 6163 745f 6d65 7461 286b  [_extract_meta(k
-0002a900: 6579 295d 0a0a 2020 2020 2020 2020 2020  ey)]..          
-0002a910: 2020 6473 6b20 3d20 7061 7274 6974 696f    dsk = partitio
-0002a920: 6e77 6973 655f 6772 6170 6828 6f70 6572  nwise_graph(oper
-0002a930: 6174 6f72 2e67 6574 6974 656d 2c20 6e61  ator.getitem, na
-0002a940: 6d65 2c20 7365 6c66 2c20 6b65 7929 0a20  me, self, key). 
-0002a950: 2020 2020 2020 2020 2020 2067 7261 7068             graph
-0002a960: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
-0002a970: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
-0002a980: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
-0002a990: 7065 6e64 656e 6369 6573 3d5b 7365 6c66  pendencies=[self
-0002a9a0: 5d29 0a20 2020 2020 2020 2020 2020 2072  ]).            r
-0002a9b0: 6574 7572 6e20 6e65 775f 6464 5f6f 626a  eturn new_dd_obj
-0002a9c0: 6563 7428 6772 6170 682c 206e 616d 652c  ect(graph, name,
-0002a9d0: 206d 6574 612c 2073 656c 662e 6469 7669   meta, self.divi
-0002a9e0: 7369 6f6e 7329 0a20 2020 2020 2020 2069  sions).        i
-0002a9f0: 6620 6973 696e 7374 616e 6365 286b 6579  f isinstance(key
-0002aa00: 2c20 5365 7269 6573 293a 0a20 2020 2020  , Series):.     
-0002aa10: 2020 2020 2020 2023 2064 6f20 6e6f 7420         # do not 
-0002aa20: 7065 7266 6f72 6d20 6475 6d6d 7920 6361  perform dummy ca
-0002aa30: 6c63 756c 6174 696f 6e2c 2061 7320 636f  lculation, as co
-0002aa40: 6c75 6d6e 7320 7769 6c6c 206e 6f74 2062  lumns will not b
-0002aa50: 6520 6368 616e 6765 642e 0a20 2020 2020  e changed..     
-0002aa60: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
-0002aa70: 6976 6973 696f 6e73 2021 3d20 6b65 792e  ivisions != key.
-0002aa80: 6469 7669 7369 6f6e 733a 0a20 2020 2020  divisions:.     
-0002aa90: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
-0002aaa0: 6461 736b 2e64 6174 6166 7261 6d65 2e6d  dask.dataframe.m
-0002aab0: 756c 7469 2069 6d70 6f72 7420 5f6d 6179  ulti import _may
-0002aac0: 6265 5f61 6c69 676e 5f70 6172 7469 7469  be_align_partiti
-0002aad0: 6f6e 730a 0a20 2020 2020 2020 2020 2020  ons..           
-0002aae0: 2020 2020 2073 656c 662c 206b 6579 203d       self, key =
-0002aaf0: 205f 6d61 7962 655f 616c 6967 6e5f 7061   _maybe_align_pa
-0002ab00: 7274 6974 696f 6e73 285b 7365 6c66 2c20  rtitions([self, 
-0002ab10: 6b65 795d 290a 2020 2020 2020 2020 2020  key]).          
-0002ab20: 2020 6473 6b20 3d20 7061 7274 6974 696f    dsk = partitio
-0002ab30: 6e77 6973 655f 6772 6170 6828 6f70 6572  nwise_graph(oper
-0002ab40: 6174 6f72 2e67 6574 6974 656d 2c20 6e61  ator.getitem, na
-0002ab50: 6d65 2c20 7365 6c66 2c20 6b65 7929 0a20  me, self, key). 
-0002ab60: 2020 2020 2020 2020 2020 2067 7261 7068             graph
-0002ab70: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
-0002ab80: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
-0002ab90: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
-0002aba0: 7065 6e64 656e 6369 6573 3d5b 7365 6c66  pendencies=[self
-0002abb0: 2c20 6b65 795d 290a 2020 2020 2020 2020  , key]).        
-0002abc0: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
-0002abd0: 645f 6f62 6a65 6374 2867 7261 7068 2c20  d_object(graph, 
-0002abe0: 6e61 6d65 2c20 7365 6c66 2c20 7365 6c66  name, self, self
-0002abf0: 2e64 6976 6973 696f 6e73 290a 2020 2020  .divisions).    
-0002ac00: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0002ac10: 6528 6b65 792c 2044 6174 6146 7261 6d65  e(key, DataFrame
-0002ac20: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-0002ac30: 6574 7572 6e20 7365 6c66 2e77 6865 7265  eturn self.where
-0002ac40: 286b 6579 2c20 6e70 2e6e 616e 290a 0a20  (key, np.nan).. 
-0002ac50: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
-0002ac60: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
-0002ac70: 286b 6579 290a 0a20 2020 2064 6566 205f  (key)..    def _
-0002ac80: 5f73 6574 6974 656d 5f5f 2873 656c 662c  _setitem__(self,
-0002ac90: 206b 6579 2c20 7661 6c75 6529 3a0a 2020   key, value):.  
-0002aca0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0002acb0: 6e63 6528 6b65 792c 2028 7475 706c 652c  nce(key, (tuple,
-0002acc0: 206c 6973 7429 2920 616e 6420 6973 696e   list)) and isin
-0002acd0: 7374 616e 6365 2876 616c 7565 2c20 4461  stance(value, Da
-0002ace0: 7461 4672 616d 6529 3a0a 2020 2020 2020  taFrame):.      
-0002acf0: 2020 2020 2020 6466 203d 2073 656c 662e        df = self.
-0002ad00: 6173 7369 676e 282a 2a7b 6b3a 2076 616c  assign(**{k: val
-0002ad10: 7565 5b63 5d20 666f 7220 6b2c 2063 2069  ue[c] for k, c i
-0002ad20: 6e20 7a69 7028 6b65 792c 2076 616c 7565  n zip(key, value
-0002ad30: 2e63 6f6c 756d 6e73 297d 290a 0a20 2020  .columns)})..   
-0002ad40: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
-0002ad50: 616e 6365 286b 6579 2c20 7064 2e49 6e64  ance(key, pd.Ind
-0002ad60: 6578 2920 616e 6420 6e6f 7420 6973 696e  ex) and not isin
-0002ad70: 7374 616e 6365 2876 616c 7565 2c20 4461  stance(value, Da
-0002ad80: 7461 4672 616d 6529 3a0a 2020 2020 2020  taFrame):.      
-0002ad90: 2020 2020 2020 6b65 7920 3d20 6c69 7374        key = list
-0002ada0: 286b 6579 290a 2020 2020 2020 2020 2020  (key).          
-0002adb0: 2020 6466 203d 2073 656c 662e 6173 7369    df = self.assi
-0002adc0: 676e 282a 2a7b 6b3a 2076 616c 7565 2066  gn(**{k: value f
-0002add0: 6f72 206b 2069 6e20 6b65 797d 290a 2020  or k in key}).  
-0002ade0: 2020 2020 2020 656c 6966 2028 0a20 2020        elif (.   
-0002adf0: 2020 2020 2020 2020 2069 735f 6461 7461           is_data
-0002ae00: 6672 616d 655f 6c69 6b65 286b 6579 290a  frame_like(key).
-0002ae10: 2020 2020 2020 2020 2020 2020 6f72 2069              or i
-0002ae20: 735f 7365 7269 6573 5f6c 696b 6528 6b65  s_series_like(ke
-0002ae30: 7929 0a20 2020 2020 2020 2020 2020 206f  y).            o
-0002ae40: 7220 6973 696e 7374 616e 6365 286b 6579  r isinstance(key
-0002ae50: 2c20 2844 6174 6146 7261 6d65 2c20 5365  , (DataFrame, Se
-0002ae60: 7269 6573 2929 0a20 2020 2020 2020 2029  ries)).        )
-0002ae70: 3a0a 2020 2020 2020 2020 2020 2020 6466  :.            df
-0002ae80: 203d 2073 656c 662e 7768 6572 6528 7e6b   = self.where(~k
-0002ae90: 6579 2c20 7661 6c75 6529 0a20 2020 2020  ey, value).     
-0002aea0: 2020 2065 6c69 6620 6e6f 7420 6973 696e     elif not isin
-0002aeb0: 7374 616e 6365 286b 6579 2c20 7374 7229  stance(key, str)
-0002aec0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0002aed0: 6973 6520 4e6f 7449 6d70 6c65 6d65 6e74  ise NotImplement
-0002aee0: 6564 4572 726f 7228 6622 4974 656d 2061  edError(f"Item a
-0002aef0: 7373 6967 6e6d 656e 7420 7769 7468 207b  ssignment with {
-0002af00: 7479 7065 286b 6579 297d 206e 6f74 2073  type(key)} not s
-0002af10: 7570 706f 7274 6564 2229 0a20 2020 2020  upported").     
-0002af20: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0002af30: 2020 2020 2064 6620 3d20 7365 6c66 2e61       df = self.a
-0002af40: 7373 6967 6e28 2a2a 7b6b 6579 3a20 7661  ssign(**{key: va
-0002af50: 6c75 657d 290a 0a20 2020 2020 2020 2073  lue})..        s
-0002af60: 656c 662e 6461 736b 203d 2064 662e 6461  elf.dask = df.da
-0002af70: 736b 0a20 2020 2020 2020 2073 656c 662e  sk.        self.
-0002af80: 5f6e 616d 6520 3d20 6466 2e5f 6e61 6d65  _name = df._name
-0002af90: 0a20 2020 2020 2020 2073 656c 662e 5f6d  .        self._m
-0002afa0: 6574 6120 3d20 6466 2e5f 6d65 7461 0a20  eta = df._meta. 
-0002afb0: 2020 2020 2020 2073 656c 662e 5f64 6976         self._div
-0002afc0: 6973 696f 6e73 203d 2064 662e 6469 7669  isions = df.divi
-0002afd0: 7369 6f6e 730a 0a20 2020 2064 6566 205f  sions..    def _
-0002afe0: 5f64 656c 6974 656d 5f5f 2873 656c 662c  _delitem__(self,
-0002aff0: 206b 6579 293a 0a20 2020 2020 2020 2072   key):.        r
-0002b000: 6573 756c 7420 3d20 7365 6c66 2e64 726f  esult = self.dro
-0002b010: 7028 5b6b 6579 5d2c 2061 7869 733d 3129  p([key], axis=1)
-0002b020: 0a20 2020 2020 2020 2073 656c 662e 6461  .        self.da
-0002b030: 736b 203d 2072 6573 756c 742e 6461 736b  sk = result.dask
-0002b040: 0a20 2020 2020 2020 2073 656c 662e 5f6e  .        self._n
-0002b050: 616d 6520 3d20 7265 7375 6c74 2e5f 6e61  ame = result._na
-0002b060: 6d65 0a20 2020 2020 2020 2073 656c 662e  me.        self.
-0002b070: 5f6d 6574 6120 3d20 7265 7375 6c74 2e5f  _meta = result._
-0002b080: 6d65 7461 0a0a 2020 2020 6465 6620 5f5f  meta..    def __
-0002b090: 7365 7461 7474 725f 5f28 7365 6c66 2c20  setattr__(self, 
-0002b0a0: 6b65 792c 2076 616c 7565 293a 0a20 2020  key, value):.   
-0002b0b0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-0002b0c0: 2020 2020 2020 636f 6c75 6d6e 7320 3d20        columns = 
-0002b0d0: 6f62 6a65 6374 2e5f 5f67 6574 6174 7472  object.__getattr
-0002b0e0: 6962 7574 655f 5f28 7365 6c66 2c20 225f  ibute__(self, "_
-0002b0f0: 6d65 7461 2229 2e63 6f6c 756d 6e73 0a20  meta").columns. 
-0002b100: 2020 2020 2020 2065 7863 6570 7420 4174         except At
-0002b110: 7472 6962 7574 6545 7272 6f72 3a0a 2020  tributeError:.  
-0002b120: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-0002b130: 7320 3d20 2829 0a0a 2020 2020 2020 2020  s = ()..        
-0002b140: 2320 6578 636c 7564 6520 7072 6f74 6563  # exclude protec
-0002b150: 7465 6420 6174 7472 6962 7574 6573 2066  ted attributes f
-0002b160: 726f 6d20 7365 7469 7465 6d0a 2020 2020  rom setitem.    
-0002b170: 2020 2020 6966 206b 6579 2069 6e20 636f      if key in co
-0002b180: 6c75 6d6e 7320 616e 6420 6b65 7920 6e6f  lumns and key no
-0002b190: 7420 696e 205b 2264 6976 6973 696f 6e73  t in ["divisions
-0002b1a0: 222c 2022 6461 736b 222c 2022 5f6e 616d  ", "dask", "_nam
-0002b1b0: 6522 2c20 225f 6d65 7461 225d 3a0a 2020  e", "_meta"]:.  
-0002b1c0: 2020 2020 2020 2020 2020 7365 6c66 5b6b            self[k
-0002b1d0: 6579 5d20 3d20 7661 6c75 650a 2020 2020  ey] = value.    
-0002b1e0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0002b1f0: 2020 2020 2020 6f62 6a65 6374 2e5f 5f73        object.__s
-0002b200: 6574 6174 7472 5f5f 2873 656c 662c 206b  etattr__(self, k
-0002b210: 6579 2c20 7661 6c75 6529 0a0a 2020 2020  ey, value)..    
-0002b220: 6465 6620 5f5f 6765 7461 7474 725f 5f28  def __getattr__(
-0002b230: 7365 6c66 2c20 6b65 7929 3a0a 2020 2020  self, key):.    
-0002b240: 2020 2020 6966 206b 6579 2069 6e20 7365      if key in se
-0002b250: 6c66 2e63 6f6c 756d 6e73 3a0a 2020 2020  lf.columns:.    
-0002b260: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002b270: 656c 665b 6b65 795d 0a20 2020 2020 2020  elf[key].       
-0002b280: 2065 6c69 6620 6b65 7920 3d3d 2022 656d   elif key == "em
-0002b290: 7074 7922 3a0a 2020 2020 2020 2020 2020  pty":.          
-0002b2a0: 2020 2320 7365 6c66 2e65 6d70 7479 2072    # self.empty r
-0002b2b0: 6169 7365 7320 4174 7472 6962 7574 654e  aises AttributeN
-0002b2c0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-0002b2d0: 6f72 2c20 7768 6963 6820 696e 636c 7564  or, which includ
-0002b2e0: 6573 0a20 2020 2020 2020 2020 2020 2023  es.            #
-0002b2f0: 2041 7474 7269 6275 7465 4572 726f 722c   AttributeError,
-0002b300: 2077 6869 6368 206d 6561 6e73 2077 6520   which means we 
-0002b310: 656e 6420 7570 2068 6572 6520 696e 2073  end up here in s
-0002b320: 656c 662e 5f5f 6765 7461 7474 725f 5f2c  elf.__getattr__,
-0002b330: 0a20 2020 2020 2020 2020 2020 2023 2062  .            # b
-0002b340: 6563 6175 7365 2044 6174 6146 7261 6d65  ecause DataFrame
-0002b350: 2e5f 5f67 6574 6174 7472 6962 7574 655f  .__getattribute_
-0002b360: 5f20 646f 6573 6e27 7420 7468 696e 6b20  _ doesn't think 
-0002b370: 7468 6520 6174 7472 6962 7574 6520 6578  the attribute ex
-0002b380: 6973 7473 0a20 2020 2020 2020 2020 2020  ists.           
-0002b390: 2023 2061 6e64 2075 7365 7320 5f5f 6765   # and uses __ge
-0002b3a0: 7461 7474 725f 5f20 6173 2074 6865 2066  tattr__ as the f
-0002b3b0: 616c 6c62 6163 6b2e 2053 6f2c 2067 6574  allback. So, get
-0002b3c0: 2060 7365 6c66 2e65 6d70 7479 6020 6d6f   `self.empty` mo
-0002b3d0: 7265 0a20 2020 2020 2020 2020 2020 2023  re.            #
-0002b3e0: 2066 6f72 6365 6675 6c6c 7920 7669 6120   forcefully via 
-0002b3f0: 6f62 6a65 6374 2e5f 5f67 6574 6174 7472  object.__getattr
-0002b400: 6962 7574 655f 5f20 746f 2072 6169 7365  ibute__ to raise
-0002b410: 2069 6e66 6f72 6d61 7469 7665 2065 7272   informative err
-0002b420: 6f72 2e0a 2020 2020 2020 2020 2020 2020  or..            
-0002b430: 6f62 6a65 6374 2e5f 5f67 6574 6174 7472  object.__getattr
-0002b440: 6962 7574 655f 5f28 7365 6c66 2c20 6b65  ibute__(self, ke
-0002b450: 7929 0a20 2020 2020 2020 2065 6c73 653a  y).        else:
-0002b460: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0002b470: 7365 2041 7474 7269 6275 7465 4572 726f  se AttributeErro
-0002b480: 7228 2227 4461 7461 4672 616d 6527 206f  r("'DataFrame' o
-0002b490: 626a 6563 7420 6861 7320 6e6f 2061 7474  bject has no att
-0002b4a0: 7269 6275 7465 2025 7222 2025 206b 6579  ribute %r" % key
-0002b4b0: 290a 0a20 2020 2064 6566 205f 5f64 6972  )..    def __dir
-0002b4c0: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
-0002b4d0: 2020 6f20 3d20 7365 7428 6469 7228 7479    o = set(dir(ty
-0002b4e0: 7065 2873 656c 6629 2929 0a20 2020 2020  pe(self))).     
-0002b4f0: 2020 206f 2e75 7064 6174 6528 7365 6c66     o.update(self
-0002b500: 2e5f 5f64 6963 745f 5f29 0a20 2020 2020  .__dict__).     
-0002b510: 2020 206f 2e75 7064 6174 6528 6320 666f     o.update(c fo
-0002b520: 7220 6320 696e 2073 656c 662e 636f 6c75  r c in self.colu
-0002b530: 6d6e 7320 6966 2028 6973 696e 7374 616e  mns if (isinstan
-0002b540: 6365 2863 2c20 7374 7229 2061 6e64 2063  ce(c, str) and c
-0002b550: 2e69 7369 6465 6e74 6966 6965 7228 2929  .isidentifier())
-0002b560: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0002b570: 206c 6973 7428 6f29 0a0a 2020 2020 6465   list(o)..    de
-0002b580: 6620 5f5f 6974 6572 5f5f 2873 656c 6629  f __iter__(self)
-0002b590: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0002b5a0: 2069 7465 7228 7365 6c66 2e5f 6d65 7461   iter(self._meta
-0002b5b0: 290a 0a20 2020 2064 6566 205f 6970 7974  )..    def _ipyt
-0002b5c0: 686f 6e5f 6b65 795f 636f 6d70 6c65 7469  hon_key_completi
-0002b5d0: 6f6e 735f 2873 656c 6629 3a0a 2020 2020  ons_(self):.    
-0002b5e0: 2020 2020 7265 7475 726e 206d 6574 686f      return metho
-0002b5f0: 6473 2e74 6f6c 6973 7428 7365 6c66 2e63  ds.tolist(self.c
-0002b600: 6f6c 756d 6e73 290a 0a20 2020 2040 7072  olumns)..    @pr
-0002b610: 6f70 6572 7479 0a20 2020 2064 6566 206e  operty.    def n
-0002b620: 6469 6d28 7365 6c66 293a 0a20 2020 2020  dim(self):.     
-0002b630: 2020 2022 2222 5265 7475 726e 2064 696d     """Return dim
-0002b640: 656e 7369 6f6e 616c 6974 7922 2222 0a20  ensionality""". 
-0002b650: 2020 2020 2020 2072 6574 7572 6e20 320a         return 2.
-0002b660: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0002b670: 2020 2064 6566 2073 6861 7065 2873 656c     def shape(sel
-0002b680: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
-0002b690: 2020 2020 2020 2020 5265 7475 726e 2061          Return a
-0002b6a0: 2074 7570 6c65 2072 6570 7265 7365 6e74   tuple represent
-0002b6b0: 696e 6720 7468 6520 6469 6d65 6e73 696f  ing the dimensio
-0002b6c0: 6e61 6c69 7479 206f 6620 7468 6520 4461  nality of the Da
-0002b6d0: 7461 4672 616d 652e 0a0a 2020 2020 2020  taFrame...      
-0002b6e0: 2020 5468 6520 6e75 6d62 6572 206f 6620    The number of 
-0002b6f0: 726f 7773 2069 7320 6120 4465 6c61 7965  rows is a Delaye
-0002b700: 6420 7265 7375 6c74 2e20 5468 6520 6e75  d result. The nu
-0002b710: 6d62 6572 206f 6620 636f 6c75 6d6e 730a  mber of columns.
-0002b720: 2020 2020 2020 2020 6973 2061 2063 6f6e          is a con
-0002b730: 6372 6574 6520 696e 7465 6765 722e 0a0a  crete integer...
-0002b740: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
-0002b750: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0002b760: 2d0a 2020 2020 2020 2020 3e3e 3e20 6466  -.        >>> df
-0002b770: 2e73 697a 6520 2023 2064 6f63 7465 7374  .size  # doctest
-0002b780: 3a20 2b53 4b49 500a 2020 2020 2020 2020  : +SKIP.        
-0002b790: 2844 656c 6179 6564 2827 696e 742d 3037  (Delayed('int-07
-0002b7a0: 6630 3630 3735 2d35 6563 632d 3464 3737  f06075-5ecc-4d77
-0002b7b0: 2d38 3137 652d 3633 6336 3961 3931 3838  -817e-63c69a9188
-0002b7c0: 6138 2729 2c20 3229 0a20 2020 2020 2020  a8'), 2).       
-0002b7d0: 2022 2222 0a20 2020 2020 2020 2063 6f6c   """.        col
-0002b7e0: 5f73 697a 6520 3d20 6c65 6e28 7365 6c66  _size = len(self
-0002b7f0: 2e63 6f6c 756d 6e73 290a 2020 2020 2020  .columns).      
-0002b800: 2020 6966 2063 6f6c 5f73 697a 6520 3d3d    if col_size ==
-0002b810: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-0002b820: 7265 7475 726e 2028 7365 6c66 2e69 6e64  return (self.ind
-0002b830: 6578 2e73 6861 7065 5b30 5d2c 2030 290a  ex.shape[0], 0).
-0002b840: 2020 2020 2020 2020 726f 775f 7369 7a65          row_size
-0002b850: 203d 2064 656c 6179 6564 2869 6e74 2928   = delayed(int)(
-0002b860: 7365 6c66 2e73 697a 6520 2f20 636f 6c5f  self.size / col_
-0002b870: 7369 7a65 290a 2020 2020 2020 2020 7265  size).        re
-0002b880: 7475 726e 2028 726f 775f 7369 7a65 2c20  turn (row_size, 
-0002b890: 636f 6c5f 7369 7a65 290a 0a20 2020 2040  col_size)..    @
-0002b8a0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0002b8b0: 2064 7479 7065 7328 7365 6c66 293a 0a20   dtypes(self):. 
-0002b8c0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-0002b8d0: 2064 6174 6120 7479 7065 7322 2222 0a20   data types""". 
-0002b8e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0002b8f0: 6c66 2e5f 6d65 7461 2e64 7479 7065 730a  lf._meta.dtypes.
-0002b900: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-0002b910: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-0002b920: 0a20 2020 2064 6566 2073 656c 6563 745f  .    def select_
-0002b930: 6474 7970 6573 2873 656c 662c 2069 6e63  dtypes(self, inc
-0002b940: 6c75 6465 3d4e 6f6e 652c 2065 7863 6c75  lude=None, exclu
-0002b950: 6465 3d4e 6f6e 6529 3a0a 2020 2020 2020  de=None):.      
-0002b960: 2020 6373 203d 2073 656c 662e 5f6d 6574    cs = self._met
-0002b970: 612e 7365 6c65 6374 5f64 7479 7065 7328  a.select_dtypes(
-0002b980: 696e 636c 7564 653d 696e 636c 7564 652c  include=include,
-0002b990: 2065 7863 6c75 6465 3d65 7863 6c75 6465   exclude=exclude
-0002b9a0: 290a 2020 2020 2020 2020 696e 6465 7865  ).        indexe
-0002b9b0: 7220 3d20 7365 6c66 2e5f 6765 745f 636f  r = self._get_co
-0002b9c0: 6c75 6d6e 735f 696e 6465 7865 735f 6261  lumns_indexes_ba
-0002b9d0: 7365 645f 6f6e 5f64 7479 7065 7328 6373  sed_on_dtypes(cs
-0002b9e0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0002b9f0: 2073 656c 662e 696c 6f63 5b3a 2c20 696e   self.iloc[:, in
-0002ba00: 6465 7865 725d 0a0a 2020 2020 6465 6620  dexer]..    def 
-0002ba10: 736f 7274 5f76 616c 7565 7328 0a20 2020  sort_values(.   
-0002ba20: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0002ba30: 2020 2062 793a 2073 7472 207c 206c 6973     by: str | lis
-0002ba40: 745b 7374 725d 2c0a 2020 2020 2020 2020  t[str],.        
-0002ba50: 6e70 6172 7469 7469 6f6e 733a 2069 6e74  npartitions: int
-0002ba60: 207c 204c 6974 6572 616c 5b22 6175 746f   | Literal["auto
-0002ba70: 225d 207c 204e 6f6e 6520 3d20 4e6f 6e65  "] | None = None
-0002ba80: 2c0a 2020 2020 2020 2020 6173 6365 6e64  ,.        ascend
-0002ba90: 696e 673a 2062 6f6f 6c20 3d20 5472 7565  ing: bool = True
-0002baa0: 2c0a 2020 2020 2020 2020 6e61 5f70 6f73  ,.        na_pos
-0002bab0: 6974 696f 6e3a 204c 6974 6572 616c 5b22  ition: Literal["
-0002bac0: 6669 7273 7422 5d20 7c20 4c69 7465 7261  first"] | Litera
-0002bad0: 6c5b 226c 6173 7422 5d20 3d20 226c 6173  l["last"] = "las
-0002bae0: 7422 2c0a 2020 2020 2020 2020 736f 7274  t",.        sort
-0002baf0: 5f66 756e 6374 696f 6e3a 2043 616c 6c61  _function: Calla
-0002bb00: 626c 655b 5b70 642e 4461 7461 4672 616d  ble[[pd.DataFram
-0002bb10: 655d 2c20 7064 2e44 6174 6146 7261 6d65  e], pd.DataFrame
-0002bb20: 5d20 7c20 4e6f 6e65 203d 204e 6f6e 652c  ] | None = None,
-0002bb30: 0a20 2020 2020 2020 2073 6f72 745f 6675  .        sort_fu
-0002bb40: 6e63 7469 6f6e 5f6b 7761 7267 733a 204d  nction_kwargs: M
-0002bb50: 6170 7069 6e67 5b73 7472 2c20 416e 795d  apping[str, Any]
-0002bb60: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2c0a   | None = None,.
-0002bb70: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
-0002bb80: 2c0a 2020 2020 2920 2d3e 2044 6174 6146  ,.    ) -> DataF
-0002bb90: 7261 6d65 3a0a 2020 2020 2020 2020 2222  rame:.        ""
-0002bba0: 2253 6f72 7420 7468 6520 6461 7461 7365  "Sort the datase
-0002bbb0: 7420 6279 2061 2073 696e 676c 6520 636f  t by a single co
-0002bbc0: 6c75 6d6e 2e0a 0a20 2020 2020 2020 2053  lumn...        S
-0002bbd0: 6f72 7469 6e67 2061 2070 6172 616c 6c65  orting a paralle
-0002bbe0: 6c20 6461 7461 7365 7420 7265 7175 6972  l dataset requir
-0002bbf0: 6573 2065 7870 656e 7369 7665 2073 6875  es expensive shu
-0002bc00: 6666 6c65 7320 616e 6420 6973 2067 656e  ffles and is gen
-0002bc10: 6572 616c 6c79 0a20 2020 2020 2020 206e  erally.        n
-0002bc20: 6f74 2072 6563 6f6d 6d65 6e64 6564 2e20  ot recommended. 
-0002bc30: 5365 6520 6060 7365 745f 696e 6465 7860  See ``set_index`
-0002bc40: 6020 666f 7220 696d 706c 656d 656e 7461  ` for implementa
-0002bc50: 7469 6f6e 2064 6574 6169 6c73 2e0a 0a20  tion details... 
-0002bc60: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0002bc70: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-0002bc80: 2d2d 2d2d 0a20 2020 2020 2020 2062 793a  ----.        by:
-0002bc90: 2073 7472 206f 7220 6c69 7374 5b73 7472   str or list[str
-0002bca0: 5d0a 2020 2020 2020 2020 2020 2020 436f  ].            Co
-0002bcb0: 6c75 6d6e 2873 2920 746f 2073 6f72 7420  lumn(s) to sort 
-0002bcc0: 6279 2e0a 2020 2020 2020 2020 6e70 6172  by..        npar
-0002bcd0: 7469 7469 6f6e 733a 2069 6e74 2c20 4e6f  titions: int, No
-0002bce0: 6e65 2c20 6f72 2027 6175 746f 270a 2020  ne, or 'auto'.  
-0002bcf0: 2020 2020 2020 2020 2020 5468 6520 6964            The id
-0002bd00: 6561 6c20 6e75 6d62 6572 206f 6620 6f75  eal number of ou
-0002bd10: 7470 7574 2070 6172 7469 7469 6f6e 732e  tput partitions.
-0002bd20: 2049 6620 4e6f 6e65 2c20 7573 6520 7468   If None, use th
-0002bd30: 6520 7361 6d65 2061 730a 2020 2020 2020  e same as.      
-0002bd40: 2020 2020 2020 7468 6520 696e 7075 742e        the input.
-0002bd50: 2049 6620 2761 7574 6f27 2074 6865 6e20   If 'auto' then 
-0002bd60: 6465 6369 6465 2062 7920 6d65 6d6f 7279  decide by memory
-0002bd70: 2075 7365 2e0a 2020 2020 2020 2020 6173   use..        as
-0002bd80: 6365 6e64 696e 673a 2062 6f6f 6c2c 206f  cending: bool, o
-0002bd90: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-0002bda0: 2020 2020 536f 7274 2061 7363 656e 6469      Sort ascendi
-0002bdb0: 6e67 2076 732e 2064 6573 6365 6e64 696e  ng vs. descendin
-0002bdc0: 672e 0a20 2020 2020 2020 2020 2020 2044  g..            D
-0002bdd0: 6566 6175 6c74 7320 746f 2054 7275 652e  efaults to True.
-0002bde0: 0a20 2020 2020 2020 206e 615f 706f 7369  .        na_posi
-0002bdf0: 7469 6f6e 3a20 7b27 6c61 7374 272c 2027  tion: {'last', '
-0002be00: 6669 7273 7427 7d2c 206f 7074 696f 6e61  first'}, optiona
-0002be10: 6c0a 2020 2020 2020 2020 2020 2020 5075  l.            Pu
-0002be20: 7473 204e 614e 7320 6174 2074 6865 2062  ts NaNs at the b
-0002be30: 6567 696e 6e69 6e67 2069 6620 2766 6972  eginning if 'fir
-0002be40: 7374 272c 2070 7574 7320 4e61 4e20 6174  st', puts NaN at
-0002be50: 2074 6865 2065 6e64 2069 6620 276c 6173   the end if 'las
-0002be60: 7427 2e0a 2020 2020 2020 2020 2020 2020  t'..            
-0002be70: 4465 6661 756c 7473 2074 6f20 276c 6173  Defaults to 'las
-0002be80: 7427 2e0a 2020 2020 2020 2020 736f 7274  t'..        sort
-0002be90: 5f66 756e 6374 696f 6e3a 2066 756e 6374  _function: funct
-0002bea0: 696f 6e2c 206f 7074 696f 6e61 6c0a 2020  ion, optional.  
-0002beb0: 2020 2020 2020 2020 2020 536f 7274 696e            Sortin
-0002bec0: 6720 6675 6e63 7469 6f6e 2074 6f20 7573  g function to us
-0002bed0: 6520 7768 656e 2073 6f72 7469 6e67 2075  e when sorting u
-0002bee0: 6e64 6572 6c79 696e 6720 7061 7274 6974  nderlying partit
-0002bef0: 696f 6e73 2e0a 2020 2020 2020 2020 2020  ions..          
-0002bf00: 2020 4966 204e 6f6e 652c 2064 6566 6175    If None, defau
-0002bf10: 6c74 7320 746f 2060 604d 2e73 6f72 745f  lts to ``M.sort_
-0002bf20: 7661 6c75 6573 6060 2028 7468 6520 7061  values`` (the pa
-0002bf30: 7274 6974 696f 6e20 6c69 6272 6172 7927  rtition library'
-0002bf40: 730a 2020 2020 2020 2020 2020 2020 696d  s.            im
-0002bf50: 706c 656d 656e 7461 7469 6f6e 206f 6620  plementation of 
-0002bf60: 6060 736f 7274 5f76 616c 7565 7360 6029  ``sort_values``)
-0002bf70: 2e0a 2020 2020 2020 2020 736f 7274 5f66  ..        sort_f
-0002bf80: 756e 6374 696f 6e5f 6b77 6172 6773 3a20  unction_kwargs: 
-0002bf90: 6469 6374 2c20 6f70 7469 6f6e 616c 0a20  dict, optional. 
-0002bfa0: 2020 2020 2020 2020 2020 2041 6464 6974             Addit
-0002bfb0: 696f 6e61 6c20 6b65 7977 6f72 6420 6172  ional keyword ar
-0002bfc0: 6775 6d65 6e74 7320 746f 2070 6173 7320  guments to pass 
-0002bfd0: 746f 2074 6865 2070 6172 7469 7469 6f6e  to the partition
-0002bfe0: 2073 6f72 7469 6e67 2066 756e 6374 696f   sorting functio
-0002bff0: 6e2e 0a20 2020 2020 2020 2020 2020 2042  n..            B
-0002c000: 7920 6465 6661 756c 742c 2060 6062 7960  y default, ``by`
-0002c010: 602c 2060 6061 7363 656e 6469 6e67 6060  `, ``ascending``
-0002c020: 2c20 616e 6420 6060 6e61 5f70 6f73 6974  , and ``na_posit
-0002c030: 696f 6e60 6020 6172 6520 7072 6f76 6964  ion`` are provid
-0002c040: 6564 2e0a 0a20 2020 2020 2020 2045 7861  ed...        Exa
-0002c050: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
-0002c060: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
-0002c070: 3e3e 2064 6632 203d 2064 662e 736f 7274  >> df2 = df.sort
-0002c080: 5f76 616c 7565 7328 2778 2729 2020 2320  _values('x')  # 
-0002c090: 646f 6374 6573 743a 202b 534b 4950 0a20  doctest: +SKIP. 
-0002c0a0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002c0b0: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
-0002c0c0: 6166 7261 6d65 2e73 6875 6666 6c65 2069  aframe.shuffle i
-0002c0d0: 6d70 6f72 7420 736f 7274 5f76 616c 7565  mport sort_value
-0002c0e0: 730a 0a20 2020 2020 2020 2072 6574 7572  s..        retur
-0002c0f0: 6e20 736f 7274 5f76 616c 7565 7328 0a20  n sort_values(. 
-0002c100: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-0002c110: 0a20 2020 2020 2020 2020 2020 2062 792c  .            by,
-0002c120: 0a20 2020 2020 2020 2020 2020 2061 7363  .            asc
-0002c130: 656e 6469 6e67 3d61 7363 656e 6469 6e67  ending=ascending
-0002c140: 2c0a 2020 2020 2020 2020 2020 2020 6e70  ,.            np
-0002c150: 6172 7469 7469 6f6e 733d 6e70 6172 7469  artitions=nparti
-0002c160: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
-0002c170: 2020 206e 615f 706f 7369 7469 6f6e 3d6e     na_position=n
-0002c180: 615f 706f 7369 7469 6f6e 2c0a 2020 2020  a_position,.    
-0002c190: 2020 2020 2020 2020 736f 7274 5f66 756e          sort_fun
-0002c1a0: 6374 696f 6e3d 736f 7274 5f66 756e 6374  ction=sort_funct
-0002c1b0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-0002c1c0: 2073 6f72 745f 6675 6e63 7469 6f6e 5f6b   sort_function_k
-0002c1d0: 7761 7267 733d 736f 7274 5f66 756e 6374  wargs=sort_funct
-0002c1e0: 696f 6e5f 6b77 6172 6773 2c0a 2020 2020  ion_kwargs,.    
-0002c1f0: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
-0002c200: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-0002c210: 2064 6566 2073 6574 5f69 6e64 6578 280a   def set_index(.
-0002c220: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0002c230: 2020 2020 2020 6f74 6865 723a 2073 7472        other: str
-0002c240: 207c 2053 6572 6965 732c 0a20 2020 2020   | Series,.     
-0002c250: 2020 2064 726f 703a 2062 6f6f 6c20 3d20     drop: bool = 
-0002c260: 5472 7565 2c0a 2020 2020 2020 2020 736f  True,.        so
-0002c270: 7274 6564 3a20 626f 6f6c 203d 2046 616c  rted: bool = Fal
-0002c280: 7365 2c0a 2020 2020 2020 2020 6e70 6172  se,.        npar
-0002c290: 7469 7469 6f6e 733a 2069 6e74 207c 204c  titions: int | L
-0002c2a0: 6974 6572 616c 5b22 6175 746f 225d 207c  iteral["auto"] |
-0002c2b0: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
-0002c2c0: 2020 2020 2020 6469 7669 7369 6f6e 733a        divisions:
-0002c2d0: 2053 6571 7565 6e63 6520 7c20 4e6f 6e65   Sequence | None
-0002c2e0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0002c2f0: 2069 6e70 6c61 6365 3a20 626f 6f6c 203d   inplace: bool =
-0002c300: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-0002c310: 736f 7274 3a20 626f 6f6c 203d 2054 7275  sort: bool = Tru
-0002c320: 652c 0a20 2020 2020 2020 202a 2a6b 7761  e,.        **kwa
-0002c330: 7267 732c 0a20 2020 2029 3a0a 2020 2020  rgs,.    ):.    
-0002c340: 2020 2020 2222 2253 6574 2074 6865 2044      """Set the D
-0002c350: 6174 6146 7261 6d65 2069 6e64 6578 2028  ataFrame index (
-0002c360: 726f 7720 6c61 6265 6c73 2920 7573 696e  row labels) usin
-0002c370: 6720 616e 2065 7869 7374 696e 6720 636f  g an existing co
-0002c380: 6c75 6d6e 2e0a 0a20 2020 2020 2020 2049  lumn...        I
-0002c390: 6620 6060 736f 7274 3d46 616c 7365 6060  f ``sort=False``
-0002c3a0: 2c20 7468 6973 2066 756e 6374 696f 6e20  , this function 
-0002c3b0: 6f70 6572 6174 6573 2065 7861 6374 6c79  operates exactly
-0002c3c0: 206c 696b 6520 6060 7061 6e64 6173 2e73   like ``pandas.s
-0002c3d0: 6574 5f69 6e64 6578 6060 0a20 2020 2020  et_index``.     
-0002c3e0: 2020 2061 6e64 2073 6574 7320 7468 6520     and sets the 
-0002c3f0: 696e 6465 7820 6f6e 2074 6865 2044 6174  index on the Dat
-0002c400: 6146 7261 6d65 2e20 4966 2060 6073 6f72  aFrame. If ``sor
-0002c410: 743d 5472 7565 6060 2028 6465 6661 756c  t=True`` (defaul
-0002c420: 7429 2c0a 2020 2020 2020 2020 7468 6973  t),.        this
-0002c430: 2066 756e 6374 696f 6e20 616c 736f 2073   function also s
-0002c440: 6f72 7473 2074 6865 2044 6174 6146 7261  orts the DataFra
-0002c450: 6d65 2062 7920 7468 6520 6e65 7720 696e  me by the new in
-0002c460: 6465 782e 2054 6869 7320 6361 6e20 6861  dex. This can ha
-0002c470: 7665 2061 0a20 2020 2020 2020 2073 6967  ve a.        sig
-0002c480: 6e69 6669 6361 6e74 2069 6d70 6163 7420  nificant impact 
-0002c490: 6f6e 2070 6572 666f 726d 616e 6365 2c20  on performance, 
-0002c4a0: 6265 6361 7573 6520 6a6f 696e 732c 2067  because joins, g
-0002c4b0: 726f 7570 6279 732c 206c 6f6f 6b75 7073  roupbys, lookups
-0002c4c0: 2c20 6574 632e 0a20 2020 2020 2020 2061  , etc..        a
-0002c4d0: 7265 2061 6c6c 206d 7563 6820 6661 7374  re all much fast
-0002c4e0: 6572 206f 6e20 7468 6174 2063 6f6c 756d  er on that colum
-0002c4f0: 6e2e 2048 6f77 6576 6572 2c20 7468 6973  n. However, this
-0002c500: 2070 6572 666f 726d 616e 6365 2069 6e63   performance inc
-0002c510: 7265 6173 650a 2020 2020 2020 2020 636f  rease.        co
-0002c520: 6d65 7320 7769 7468 2061 2063 6f73 742c  mes with a cost,
-0002c530: 2073 6f72 7469 6e67 2061 2070 6172 616c   sorting a paral
-0002c540: 6c65 6c20 6461 7461 7365 7420 7265 7175  lel dataset requ
-0002c550: 6972 6573 2065 7870 656e 7369 7665 2073  ires expensive s
-0002c560: 6875 6666 6c65 732e 0a20 2020 2020 2020  huffles..       
-0002c570: 204f 6674 656e 2077 6520 6060 7365 745f   Often we ``set_
-0002c580: 696e 6465 7860 6020 6f6e 6365 2064 6972  index`` once dir
-0002c590: 6563 746c 7920 6166 7465 7220 6461 7461  ectly after data
-0002c5a0: 2069 6e67 6573 7420 616e 6420 6669 6c74   ingest and filt
-0002c5b0: 6572 696e 6720 616e 640a 2020 2020 2020  ering and.      
-0002c5c0: 2020 7468 656e 2070 6572 666f 726d 206d    then perform m
-0002c5d0: 616e 7920 6368 6561 7020 636f 6d70 7574  any cheap comput
-0002c5e0: 6174 696f 6e73 206f 6666 206f 6620 7468  ations off of th
-0002c5f0: 6520 736f 7274 6564 2064 6174 6173 6574  e sorted dataset
-0002c600: 2e0a 0a20 2020 2020 2020 2057 6974 6820  ...        With 
-0002c610: 6060 736f 7274 3d54 7275 6560 602c 2074  ``sort=True``, t
-0002c620: 6869 7320 6675 6e63 7469 6f6e 2069 7320  his function is 
-0002c630: 6d75 6368 206d 6f72 6520 6578 7065 6e73  much more expens
-0002c640: 6976 652e 2055 6e64 6572 206e 6f72 6d61  ive. Under norma
-0002c650: 6c0a 2020 2020 2020 2020 6f70 6572 6174  l.        operat
-0002c660: 696f 6e20 7468 6973 2066 756e 6374 696f  ion this functio
-0002c670: 6e20 646f 6573 2061 6e20 696e 6974 6961  n does an initia
-0002c680: 6c20 7061 7373 206f 7665 7220 7468 6520  l pass over the 
-0002c690: 696e 6465 7820 636f 6c75 6d6e 2074 6f0a  index column to.
-0002c6a0: 2020 2020 2020 2020 636f 6d70 7574 6520          compute 
-0002c6b0: 6170 7072 6f78 696d 6174 6520 7175 616e  approximate quan
-0002c6c0: 7469 6c65 7320 746f 2073 6572 7665 2061  tiles to serve a
-0002c6d0: 7320 6675 7475 7265 2064 6976 6973 696f  s future divisio
-0002c6e0: 6e73 2e20 4974 2074 6865 6e20 7061 7373  ns. It then pass
-0002c6f0: 6573 0a20 2020 2020 2020 206f 7665 7220  es.        over 
-0002c700: 7468 6520 6461 7461 2061 2073 6563 6f6e  the data a secon
-0002c710: 6420 7469 6d65 2c20 7370 6c69 7474 696e  d time, splittin
-0002c720: 6720 7570 2065 6163 6820 696e 7075 7420  g up each input 
-0002c730: 7061 7274 6974 696f 6e20 696e 746f 2073  partition into s
-0002c740: 6576 6572 616c 0a20 2020 2020 2020 2070  everal.        p
-0002c750: 6965 6365 7320 616e 6420 7368 6172 696e  ieces and sharin
-0002c760: 6720 7468 6f73 6520 7069 6563 6573 2074  g those pieces t
-0002c770: 6f20 616c 6c20 6f66 2074 6865 206f 7574  o all of the out
-0002c780: 7075 7420 7061 7274 6974 696f 6e73 206e  put partitions n
-0002c790: 6f77 2069 6e0a 2020 2020 2020 2020 736f  ow in.        so
-0002c7a0: 7274 6564 206f 7264 6572 2e0a 0a20 2020  rted order...   
-0002c7b0: 2020 2020 2049 6e20 736f 6d65 2063 6173       In some cas
-0002c7c0: 6573 2077 6520 6361 6e20 616c 6c65 7669  es we can allevi
-0002c7d0: 6174 6520 7468 6f73 6520 636f 7374 732c  ate those costs,
-0002c7e0: 2066 6f72 2065 7861 6d70 6c65 2069 6620   for example if 
-0002c7f0: 796f 7572 2064 6174 6173 6574 2069 730a  your dataset is.
-0002c800: 2020 2020 2020 2020 736f 7274 6564 2061          sorted a
-0002c810: 6c72 6561 6479 2074 6865 6e20 7765 2063  lready then we c
-0002c820: 616e 2061 766f 6964 206d 616b 696e 6720  an avoid making 
-0002c830: 6d61 6e79 2073 6d61 6c6c 2070 6965 6365  many small piece
-0002c840: 7320 6f72 2069 6620 796f 7520 6b6e 6f77  s or if you know
-0002c850: 0a20 2020 2020 2020 2067 6f6f 6420 7661  .        good va
-0002c860: 6c75 6573 2074 6f20 7370 6c69 7420 7468  lues to split th
-0002c870: 6520 6e65 7720 696e 6465 7820 636f 6c75  e new index colu
-0002c880: 6d6e 2074 6865 6e20 7765 2063 616e 2061  mn then we can a
-0002c890: 766f 6964 2074 6865 2069 6e69 7469 616c  void the initial
-0002c8a0: 0a20 2020 2020 2020 2070 6173 7320 6f76  .        pass ov
-0002c8b0: 6572 2074 6865 2064 6174 612e 2046 6f72  er the data. For
-0002c8c0: 2065 7861 6d70 6c65 2069 6620 796f 7572   example if your
-0002c8d0: 206e 6577 2069 6e64 6578 2069 7320 6120   new index is a 
-0002c8e0: 6461 7465 7469 6d65 2069 6e64 6578 2061  datetime index a
-0002c8f0: 6e64 0a20 2020 2020 2020 2079 6f75 7220  nd.        your 
-0002c900: 6461 7461 2069 7320 616c 7265 6164 7920  data is already 
-0002c910: 736f 7274 6564 2062 7920 6461 7920 7468  sorted by day th
-0002c920: 656e 2074 6869 7320 656e 7469 7265 206f  en this entire o
-0002c930: 7065 7261 7469 6f6e 2063 616e 2062 6520  peration can be 
-0002c940: 646f 6e65 0a20 2020 2020 2020 2066 6f72  done.        for
-0002c950: 2066 7265 652e 2059 6f75 2063 616e 2063   free. You can c
-0002c960: 6f6e 7472 6f6c 2074 6865 7365 206f 7074  ontrol these opt
-0002c970: 696f 6e73 2077 6974 6820 7468 6520 666f  ions with the fo
-0002c980: 6c6c 6f77 696e 6720 7061 7261 6d65 7465  llowing paramete
-0002c990: 7273 2e0a 0a20 2020 2020 2020 2050 6172  rs...        Par
-0002c9a0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-0002c9b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0002c9c0: 2020 206f 7468 6572 3a20 7374 7269 6e67     other: string
-0002c9d0: 206f 7220 4461 736b 2053 6572 6965 730a   or Dask Series.
-0002c9e0: 2020 2020 2020 2020 2020 2020 436f 6c75              Colu
-0002c9f0: 6d6e 2074 6f20 7573 6520 6173 2069 6e64  mn to use as ind
-0002ca00: 6578 2e0a 2020 2020 2020 2020 6472 6f70  ex..        drop
-0002ca10: 3a20 626f 6f6c 6561 6e2c 2064 6566 6175  : boolean, defau
-0002ca20: 6c74 2054 7275 650a 2020 2020 2020 2020  lt True.        
-0002ca30: 2020 2020 4465 6c65 7465 2063 6f6c 756d      Delete colum
-0002ca40: 6e20 746f 2062 6520 7573 6564 2061 7320  n to be used as 
-0002ca50: 7468 6520 6e65 7720 696e 6465 782e 0a20  the new index.. 
-0002ca60: 2020 2020 2020 2073 6f72 7465 643a 2062         sorted: b
-0002ca70: 6f6f 6c2c 206f 7074 696f 6e61 6c0a 2020  ool, optional.  
-0002ca80: 2020 2020 2020 2020 2020 4966 2074 6865            If the
-0002ca90: 2069 6e64 6578 2063 6f6c 756d 6e20 6973   index column is
-0002caa0: 2061 6c72 6561 6479 2073 6f72 7465 6420   already sorted 
-0002cab0: 696e 2069 6e63 7265 6173 696e 6720 6f72  in increasing or
-0002cac0: 6465 722e 0a20 2020 2020 2020 2020 2020  der..           
-0002cad0: 2044 6566 6175 6c74 7320 746f 2046 616c   Defaults to Fal
-0002cae0: 7365 0a20 2020 2020 2020 206e 7061 7274  se.        npart
-0002caf0: 6974 696f 6e73 3a20 696e 742c 204e 6f6e  itions: int, Non
-0002cb00: 652c 206f 7220 2761 7574 6f27 0a20 2020  e, or 'auto'.   
-0002cb10: 2020 2020 2020 2020 2054 6865 2069 6465           The ide
-0002cb20: 616c 206e 756d 6265 7220 6f66 206f 7574  al number of out
-0002cb30: 7075 7420 7061 7274 6974 696f 6e73 2e20  put partitions. 
-0002cb40: 4966 204e 6f6e 652c 2075 7365 2074 6865  If None, use the
-0002cb50: 2073 616d 6520 6173 0a20 2020 2020 2020   same as.       
-0002cb60: 2020 2020 2074 6865 2069 6e70 7574 2e20       the input. 
-0002cb70: 4966 2027 6175 746f 2720 7468 656e 2064  If 'auto' then d
-0002cb80: 6563 6964 6520 6279 206d 656d 6f72 7920  ecide by memory 
-0002cb90: 7573 652e 0a20 2020 2020 2020 2020 2020  use..           
-0002cba0: 204f 6e6c 7920 7573 6564 2077 6865 6e20   Only used when 
-0002cbb0: 6060 6469 7669 7369 6f6e 7360 6020 6973  ``divisions`` is
-0002cbc0: 206e 6f74 2067 6976 656e 2e20 4966 2060   not given. If `
-0002cbd0: 6064 6976 6973 696f 6e73 6060 2069 7320  `divisions`` is 
-0002cbe0: 6769 7665 6e2c 0a20 2020 2020 2020 2020  given,.         
-0002cbf0: 2020 2074 6865 206e 756d 6265 7220 6f66     the number of
-0002cc00: 206f 7574 7075 7420 7061 7274 6974 696f   output partitio
-0002cc10: 6e73 2077 696c 6c20 6265 2060 606c 656e  ns will be ``len
-0002cc20: 2864 6976 6973 696f 6e73 2920 2d20 3160  (divisions) - 1`
-0002cc30: 602e 0a20 2020 2020 2020 2064 6976 6973  `..        divis
-0002cc40: 696f 6e73 3a20 6c69 7374 2c20 6f70 7469  ions: list, opti
-0002cc50: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-0002cc60: 2054 6865 2022 6469 7669 6469 6e67 206c   The "dividing l
-0002cc70: 696e 6573 2220 7573 6564 2074 6f20 7370  ines" used to sp
-0002cc80: 6c69 7420 7468 6520 6e65 7720 696e 6465  lit the new inde
-0002cc90: 7820 696e 746f 2070 6172 7469 7469 6f6e  x into partition
-0002cca0: 732e 0a20 2020 2020 2020 2020 2020 2046  s..            F
-0002ccb0: 6f72 2060 6064 6976 6973 696f 6e73 3d5b  or ``divisions=[
-0002ccc0: 302c 2031 302c 2035 302c 2031 3030 5d60  0, 10, 50, 100]`
-0002ccd0: 602c 2074 6865 7265 2077 6f75 6c64 2062  `, there would b
-0002cce0: 6520 7468 7265 6520 6f75 7470 7574 2070  e three output p
-0002ccf0: 6172 7469 7469 6f6e 732c 0a20 2020 2020  artitions,.     
-0002cd00: 2020 2020 2020 2077 6865 7265 2074 6865         where the
-0002cd10: 206e 6577 2069 6e64 6578 2063 6f6e 7461   new index conta
-0002cd20: 696e 6564 205b 302c 2031 3029 2c20 5b31  ined [0, 10), [1
-0002cd30: 302c 2035 3029 2c20 616e 6420 5b35 302c  0, 50), and [50,
-0002cd40: 2031 3030 292c 2072 6573 7065 6374 6976   100), respectiv
-0002cd50: 656c 792e 0a20 2020 2020 2020 2020 2020  ely..           
-0002cd60: 2053 6565 2068 7474 7073 3a2f 2f64 6f63   See https://doc
-0002cd70: 732e 6461 736b 2e6f 7267 2f65 6e2f 6c61  s.dask.org/en/la
-0002cd80: 7465 7374 2f64 6174 6166 7261 6d65 2d64  test/dataframe-d
-0002cd90: 6573 6967 6e2e 6874 6d6c 2370 6172 7469  esign.html#parti
-0002cda0: 7469 6f6e 732e 0a20 2020 2020 2020 2020  tions..         
-0002cdb0: 2020 2049 6620 6e6f 7420 6769 7665 6e20     If not given 
-0002cdc0: 2864 6566 6175 6c74 292c 2067 6f6f 6420  (default), good 
-0002cdd0: 6469 7669 7369 6f6e 7320 6172 6520 6361  divisions are ca
-0002cde0: 6c63 756c 6174 6564 2062 7920 696d 6d65  lculated by imme
-0002cdf0: 6469 6174 656c 7920 636f 6d70 7574 696e  diately computin
-0002ce00: 670a 2020 2020 2020 2020 2020 2020 7468  g.            th
-0002ce10: 6520 6461 7461 2061 6e64 206c 6f6f 6b69  e data and looki
-0002ce20: 6e67 2061 7420 7468 6520 6469 7374 7269  ng at the distri
-0002ce30: 6275 7469 6f6e 206f 6620 6974 7320 7661  bution of its va
-0002ce40: 6c75 6573 2e20 466f 7220 6c61 7267 6520  lues. For large 
-0002ce50: 6461 7461 7365 7473 2c0a 2020 2020 2020  datasets,.      
-0002ce60: 2020 2020 2020 7468 6973 2063 616e 2062        this can b
-0002ce70: 6520 6578 7065 6e73 6976 652e 0a20 2020  e expensive..   
-0002ce80: 2020 2020 2020 2020 204e 6f74 6520 7468           Note th
-0002ce90: 6174 2069 6620 6060 736f 7274 6564 3d54  at if ``sorted=T
-0002cea0: 7275 6560 602c 2073 7065 6369 6669 6564  rue``, specified
-0002ceb0: 2064 6976 6973 696f 6e73 2061 7265 2061   divisions are a
-0002cec0: 7373 756d 6564 2074 6f20 6d61 7463 680a  ssumed to match.
-0002ced0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-0002cee0: 6578 6973 7469 6e67 2070 6172 7469 7469  existing partiti
-0002cef0: 6f6e 7320 696e 2074 6865 2064 6174 613b  ons in the data;
-0002cf00: 2069 6620 7468 6973 2069 7320 756e 7472   if this is untr
-0002cf10: 7565 2079 6f75 2073 686f 756c 640a 2020  ue you should.  
-0002cf20: 2020 2020 2020 2020 2020 6c65 6176 6520            leave 
-0002cf30: 6469 7669 7369 6f6e 7320 656d 7074 7920  divisions empty 
-0002cf40: 616e 6420 6361 6c6c 2060 6072 6570 6172  and call ``repar
-0002cf50: 7469 7469 6f6e 6060 2061 6674 6572 2060  tition`` after `
-0002cf60: 6073 6574 5f69 6e64 6578 6060 2e0a 2020  `set_index``..  
-0002cf70: 2020 2020 2020 696e 706c 6163 653a 2062        inplace: b
-0002cf80: 6f6f 6c2c 206f 7074 696f 6e61 6c0a 2020  ool, optional.  
-0002cf90: 2020 2020 2020 2020 2020 4d6f 6469 6679            Modify
-0002cfa0: 696e 6720 7468 6520 4461 7461 4672 616d  ing the DataFram
-0002cfb0: 6520 696e 2070 6c61 6365 2069 7320 6e6f  e in place is no
-0002cfc0: 7420 7375 7070 6f72 7465 6420 6279 2044  t supported by D
-0002cfd0: 6173 6b2e 0a20 2020 2020 2020 2020 2020  ask..           
-0002cfe0: 2044 6566 6175 6c74 7320 746f 2046 616c   Defaults to Fal
-0002cff0: 7365 2e0a 2020 2020 2020 2020 736f 7274  se..        sort
-0002d000: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
-0002d010: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-0002d020: 6060 5472 7565 6060 2c20 736f 7274 2074  ``True``, sort t
-0002d030: 6865 2044 6174 6146 7261 6d65 2062 7920  he DataFrame by 
-0002d040: 7468 6520 6e65 7720 696e 6465 782e 204f  the new index. O
-0002d050: 7468 6572 7769 7365 0a20 2020 2020 2020  therwise.       
-0002d060: 2020 2020 2073 6574 2074 6865 2069 6e64       set the ind
-0002d070: 6578 206f 6e20 7468 6520 696e 6469 7669  ex on the indivi
-0002d080: 6475 616c 2065 7869 7374 696e 6720 7061  dual existing pa
-0002d090: 7274 6974 696f 6e73 2e0a 2020 2020 2020  rtitions..      
-0002d0a0: 2020 2020 2020 4465 6661 756c 7473 2074        Defaults t
-0002d0b0: 6f20 6060 5472 7565 6060 2e0a 2020 2020  o ``True``..    
-0002d0c0: 2020 2020 7368 7566 666c 653a 2073 7472      shuffle: str
-0002d0d0: 696e 672c 2027 6469 736b 2720 6f72 2027  ing, 'disk' or '
-0002d0e0: 7461 736b 7327 2c20 6f70 7469 6f6e 616c  tasks', optional
-0002d0f0: 0a20 2020 2020 2020 2020 2020 2045 6974  .            Eit
-0002d100: 6865 7220 6060 2764 6973 6b27 6060 2066  her ``'disk'`` f
-0002d110: 6f72 2073 696e 676c 652d 6e6f 6465 206f  or single-node o
-0002d120: 7065 7261 7469 6f6e 206f 7220 6060 2774  peration or ``'t
-0002d130: 6173 6b73 2760 6020 666f 720a 2020 2020  asks'`` for.    
-0002d140: 2020 2020 2020 2020 6469 7374 7269 6275          distribu
-0002d150: 7465 6420 6f70 6572 6174 696f 6e2e 2020  ted operation.  
-0002d160: 5769 6c6c 2062 6520 696e 6665 7272 6564  Will be inferred
-0002d170: 2062 7920 796f 7572 2063 7572 7265 6e74   by your current
-0002d180: 2073 6368 6564 756c 6572 2e0a 2020 2020   scheduler..    
-0002d190: 2020 2020 636f 6d70 7574 653a 2062 6f6f      compute: boo
-0002d1a0: 6c2c 2064 6566 6175 6c74 2046 616c 7365  l, default False
-0002d1b0: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
-0002d1c0: 7468 6572 206f 7220 6e6f 7420 746f 2074  ther or not to t
-0002d1d0: 7269 6767 6572 2061 6e20 696d 6d65 6469  rigger an immedi
-0002d1e0: 6174 6520 636f 6d70 7574 6174 696f 6e2e  ate computation.
-0002d1f0: 2044 6566 6175 6c74 7320 746f 2046 616c   Defaults to Fal
-0002d200: 7365 2e0a 2020 2020 2020 2020 2020 2020  se..            
-0002d210: 4e6f 7465 2c20 7468 6174 2065 7665 6e20  Note, that even 
-0002d220: 6966 2079 6f75 2073 6574 2060 6063 6f6d  if you set ``com
-0002d230: 7075 7465 3d46 616c 7365 6060 2c20 616e  pute=False``, an
-0002d240: 2069 6d6d 6564 6961 7465 2063 6f6d 7075   immediate compu
-0002d250: 7461 7469 6f6e 0a20 2020 2020 2020 2020  tation.         
-0002d260: 2020 2077 696c 6c20 7374 696c 6c20 6265     will still be
-0002d270: 2074 7269 6767 6572 6564 2069 6620 6060   triggered if ``
-0002d280: 6469 7669 7369 6f6e 7360 6020 6973 2060  divisions`` is `
-0002d290: 604e 6f6e 6560 602e 0a20 2020 2020 2020  `None``..       
-0002d2a0: 2070 6172 7469 7469 6f6e 5f73 697a 653a   partition_size:
-0002d2b0: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
-0002d2c0: 2020 2020 2020 2020 2020 2044 6573 6972             Desir
-0002d2d0: 6564 2073 697a 6520 6f66 2065 6163 6820  ed size of each 
-0002d2e0: 7061 7274 6974 696f 6e73 2069 6e20 6279  partitions in by
-0002d2f0: 7465 732e 0a20 2020 2020 2020 2020 2020  tes..           
-0002d300: 204f 6e6c 7920 7573 6564 2077 6865 6e20   Only used when 
-0002d310: 6060 6e70 6172 7469 7469 6f6e 733d 2761  ``npartitions='a
-0002d320: 7574 6f27 6060 0a0a 2020 2020 2020 2020  uto'``..        
-0002d330: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
-0002d340: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-0002d350: 2020 3e3e 3e20 696d 706f 7274 2064 6173    >>> import das
-0002d360: 6b0a 2020 2020 2020 2020 3e3e 3e20 6464  k.        >>> dd
-0002d370: 6620 3d20 6461 736b 2e64 6174 6173 6574  f = dask.dataset
-0002d380: 732e 7469 6d65 7365 7269 6573 2873 7461  s.timeseries(sta
-0002d390: 7274 3d22 3230 3231 2d30 312d 3031 222c  rt="2021-01-01",
-0002d3a0: 2065 6e64 3d22 3230 3231 2d30 312d 3037   end="2021-01-07
-0002d3b0: 222c 2066 7265 713d 2231 4822 292e 7265  ", freq="1H").re
-0002d3c0: 7365 745f 696e 6465 7828 290a 2020 2020  set_index().    
-0002d3d0: 2020 2020 3e3e 3e20 6464 6632 203d 2064      >>> ddf2 = d
-0002d3e0: 6466 2e73 6574 5f69 6e64 6578 2822 7822  df.set_index("x"
-0002d3f0: 290a 2020 2020 2020 2020 3e3e 3e20 6464  ).        >>> dd
-0002d400: 6632 203d 2064 6466 2e73 6574 5f69 6e64  f2 = ddf.set_ind
-0002d410: 6578 2864 6466 2e78 290a 2020 2020 2020  ex(ddf.x).      
-0002d420: 2020 3e3e 3e20 6464 6632 203d 2064 6466    >>> ddf2 = ddf
-0002d430: 2e73 6574 5f69 6e64 6578 2864 6466 2e74  .set_index(ddf.t
-0002d440: 696d 6573 7461 6d70 2c20 736f 7274 6564  imestamp, sorted
-0002d450: 3d54 7275 6529 0a0a 2020 2020 2020 2020  =True)..        
-0002d460: 4120 636f 6d6d 6f6e 2063 6173 6520 6973  A common case is
-0002d470: 2077 6865 6e20 7765 2068 6176 6520 6120   when we have a 
-0002d480: 6461 7465 7469 6d65 2063 6f6c 756d 6e20  datetime column 
-0002d490: 7468 6174 2077 6520 6b6e 6f77 2074 6f20  that we know to 
-0002d4a0: 6265 0a20 2020 2020 2020 2073 6f72 7465  be.        sorte
-0002d4b0: 6420 616e 6420 6973 2063 6c65 616e 6c79  d and is cleanly
-0002d4c0: 2064 6976 6964 6564 2062 7920 6461 792e   divided by day.
-0002d4d0: 2020 5765 2063 616e 2073 6574 2074 6869    We can set thi
-0002d4e0: 7320 696e 6465 7820 666f 7220 6672 6565  s index for free
-0002d4f0: 0a20 2020 2020 2020 2062 7920 7370 6563  .        by spec
-0002d500: 6966 7969 6e67 2062 6f74 6820 7468 6174  ifying both that
-0002d510: 2074 6865 2063 6f6c 756d 6e20 6973 2070   the column is p
-0002d520: 7265 2d73 6f72 7465 6420 616e 6420 7468  re-sorted and th
-0002d530: 6520 7061 7274 6963 756c 6172 0a20 2020  e particular.   
-0002d540: 2020 2020 2064 6976 6973 696f 6e73 2061       divisions a
-0002d550: 6c6f 6e67 2077 6869 6368 2069 7320 6973  long which is is
-0002d560: 2073 6570 6172 6174 6564 0a0a 2020 2020   separated..    
-0002d570: 2020 2020 3e3e 3e20 696d 706f 7274 2070      >>> import p
-0002d580: 616e 6461 7320 6173 2070 640a 2020 2020  andas as pd.    
-0002d590: 2020 2020 3e3e 3e20 6469 7669 7369 6f6e      >>> division
-0002d5a0: 7320 3d20 7064 2e64 6174 655f 7261 6e67  s = pd.date_rang
-0002d5b0: 6528 7374 6172 743d 2232 3032 312d 3031  e(start="2021-01
-0002d5c0: 2d30 3122 2c20 656e 643d 2232 3032 312d  -01", end="2021-
-0002d5d0: 3031 2d30 3722 2c20 6672 6571 3d27 3144  01-07", freq='1D
-0002d5e0: 2729 0a20 2020 2020 2020 203e 3e3e 2064  ').        >>> d
-0002d5f0: 6976 6973 696f 6e73 0a20 2020 2020 2020  ivisions.       
-0002d600: 2044 6174 6574 696d 6549 6e64 6578 285b   DatetimeIndex([
-0002d610: 2732 3032 312d 3031 2d30 3127 2c20 2732  '2021-01-01', '2
-0002d620: 3032 312d 3031 2d30 3227 2c20 2732 3032  021-01-02', '202
-0002d630: 312d 3031 2d30 3327 2c20 2732 3032 312d  1-01-03', '2021-
-0002d640: 3031 2d30 3427 2c0a 2020 2020 2020 2020  01-04',.        
-0002d650: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0002d660: 3230 3231 2d30 312d 3035 272c 2027 3230  2021-01-05', '20
-0002d670: 3231 2d30 312d 3036 272c 2027 3230 3231  21-01-06', '2021
-0002d680: 2d30 312d 3037 275d 2c0a 2020 2020 2020  -01-07'],.      
-0002d690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d6a0: 6474 7970 653d 2764 6174 6574 696d 6536  dtype='datetime6
-0002d6b0: 345b 6e73 5d27 2c20 6672 6571 3d27 4427  4[ns]', freq='D'
-0002d6c0: 290a 0a20 2020 2020 2020 204e 6f74 6520  )..        Note 
-0002d6d0: 7468 6174 2060 606c 656e 2864 6976 6973  that ``len(divis
-0002d6e0: 6f6e 7329 6060 2069 7320 6571 7561 6c20  ons)`` is equal 
-0002d6f0: 746f 2060 606e 7061 7274 6974 696f 6e73  to ``npartitions
-0002d700: 202b 2031 6060 2e20 5468 6973 2069 7320   + 1``. This is 
-0002d710: 6265 6361 7573 6520 6060 6469 7669 7369  because ``divisi
-0002d720: 6f6e 7360 600a 2020 2020 2020 2020 7265  ons``.        re
-0002d730: 7072 6573 656e 7473 2074 6865 2075 7070  presents the upp
-0002d740: 6572 2061 6e64 206c 6f77 6572 2062 6f75  er and lower bou
-0002d750: 6e64 7320 6f66 2065 6163 6820 7061 7274  nds of each part
-0002d760: 6974 696f 6e2e 2054 6865 2066 6972 7374  ition. The first
-0002d770: 2069 7465 6d20 6973 2074 6865 0a20 2020   item is the.   
-0002d780: 2020 2020 206c 6f77 6572 2062 6f75 6e64       lower bound
-0002d790: 206f 6620 7468 6520 6669 7273 7420 7061   of the first pa
-0002d7a0: 7274 6974 696f 6e2c 2074 6865 2073 6563  rtition, the sec
-0002d7b0: 6f6e 6420 6974 656d 2069 7320 7468 6520  ond item is the 
-0002d7c0: 6c6f 7765 7220 626f 756e 6420 6f66 2074  lower bound of t
-0002d7d0: 6865 0a20 2020 2020 2020 2073 6563 6f6e  he.        secon
-0002d7e0: 6420 7061 7274 6974 696f 6e20 616e 6420  d partition and 
-0002d7f0: 7468 6520 7570 7065 7220 626f 756e 6420  the upper bound 
-0002d800: 6f66 2074 6865 2066 6972 7374 2070 6172  of the first par
-0002d810: 7469 7469 6f6e 2c20 616e 6420 736f 206f  tition, and so o
-0002d820: 6e2e 0a20 2020 2020 2020 2054 6865 2073  n..        The s
-0002d830: 6563 6f6e 642d 746f 2d6c 6173 7420 6974  econd-to-last it
-0002d840: 656d 2069 7320 7468 6520 6c6f 7765 7220  em is the lower 
-0002d850: 626f 756e 6420 6f66 2074 6865 206c 6173  bound of the las
-0002d860: 7420 7061 7274 6974 696f 6e2c 2061 6e64  t partition, and
-0002d870: 2074 6865 206c 6173 740a 2020 2020 2020   the last.      
-0002d880: 2020 2865 7874 7261 2920 6974 656d 2069    (extra) item i
-0002d890: 7320 7468 6520 7570 7065 7220 626f 756e  s the upper boun
-0002d8a0: 6420 6f66 2074 6865 206c 6173 7420 7061  d of the last pa
-0002d8b0: 7274 6974 696f 6e2e 0a0a 2020 2020 2020  rtition...      
-0002d8c0: 2020 3e3e 3e20 6464 6632 203d 2064 6466    >>> ddf2 = ddf
-0002d8d0: 2e73 6574 5f69 6e64 6578 2822 7469 6d65  .set_index("time
-0002d8e0: 7374 616d 7022 2c20 736f 7274 6564 3d54  stamp", sorted=T
-0002d8f0: 7275 652c 2064 6976 6973 696f 6e73 3d64  rue, divisions=d
-0002d900: 6976 6973 696f 6e73 2e74 6f6c 6973 7428  ivisions.tolist(
-0002d910: 2929 0a0a 2020 2020 2020 2020 4966 2079  ))..        If y
-0002d920: 6f75 276c 6c20 6265 2072 756e 6e69 6e67  ou'll be running
-0002d930: 2060 7365 745f 696e 6465 7860 206f 6e20   `set_index` on 
-0002d940: 7468 6520 7361 6d65 2028 6f72 2073 696d  the same (or sim
-0002d950: 696c 6172 2920 6461 7461 7365 7473 2072  ilar) datasets r
-0002d960: 6570 6561 7465 646c 792c 0a20 2020 2020  epeatedly,.     
-0002d970: 2020 2079 6f75 2063 6f75 6c64 2073 6176     you could sav
-0002d980: 6520 7469 6d65 2062 7920 6c65 7474 696e  e time by lettin
-0002d990: 6720 4461 736b 2063 616c 6375 6c61 7465  g Dask calculate
-0002d9a0: 2067 6f6f 6420 6469 7669 7369 6f6e 7320   good divisions 
-0002d9b0: 6f6e 6365 2c20 7468 656e 2063 6f70 792d  once, then copy-
-0002d9c0: 7061 7374 696e 670a 2020 2020 2020 2020  pasting.        
-0002d9d0: 7468 656d 2074 6f20 7265 7573 652e 2054  them to reuse. T
-0002d9e0: 6869 7320 6973 2065 7370 6563 6961 6c6c  his is especiall
-0002d9f0: 7920 6865 6c70 6675 6c20 7275 6e6e 696e  y helpful runnin
-0002da00: 6720 696e 2061 204a 7570 7974 6572 206e  g in a Jupyter n
-0002da10: 6f74 6562 6f6f 6b3a 0a0a 2020 2020 2020  otebook:..      
-0002da20: 2020 3e3e 3e20 6464 6632 203d 2064 6466    >>> ddf2 = ddf
-0002da30: 2e73 6574 5f69 6e64 6578 2822 6e61 6d65  .set_index("name
-0002da40: 2229 2020 2320 736c 6f77 2c20 6361 6c63  ")  # slow, calc
-0002da50: 756c 6174 6573 2064 6174 6120 6469 7374  ulates data dist
-0002da60: 7269 6275 7469 6f6e 0a20 2020 2020 2020  ribution.       
-0002da70: 203e 3e3e 2064 6466 322e 6469 7669 7369   >>> ddf2.divisi
-0002da80: 6f6e 7320 2023 2064 6f63 7465 7374 3a20  ons  # doctest: 
-0002da90: 2b53 4b49 500a 2020 2020 2020 2020 5b22  +SKIP.        ["
-0002daa0: 416c 6963 6522 2c20 224c 6175 7261 222c  Alice", "Laura",
-0002dab0: 2022 5572 7375 6c61 222c 2022 5a65 6c64   "Ursula", "Zeld
-0002dac0: 6122 5d0a 2020 2020 2020 2020 3e3e 3e20  a"].        >>> 
-0002dad0: 2320 5e20 4e6f 7720 636f 7079 2d70 6173  # ^ Now copy-pas
-0002dae0: 7465 2074 6869 7320 616e 6420 6564 6974  te this and edit
-0002daf0: 2074 6865 206c 696e 6520 6162 6f76 6520   the line above 
-0002db00: 746f 3a0a 2020 2020 2020 2020 3e3e 3e20  to:.        >>> 
-0002db10: 2320 6464 6632 203d 2064 6466 2e73 6574  # ddf2 = ddf.set
-0002db20: 5f69 6e64 6578 2822 6e61 6d65 222c 2064  _index("name", d
-0002db30: 6976 6973 696f 6e73 3d5b 2241 6c69 6365  ivisions=["Alice
-0002db40: 222c 2022 4c61 7572 6122 2c20 2255 7273  ", "Laura", "Urs
-0002db50: 756c 6122 2c20 225a 656c 6461 225d 290a  ula", "Zelda"]).
-0002db60: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-0002db70: 2020 2020 2069 6620 696e 706c 6163 653a       if inplace:
-0002db80: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0002db90: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-0002dba0: 6445 7272 6f72 2822 5468 6520 696e 706c  dError("The inpl
-0002dbb0: 6163 653d 206b 6579 776f 7264 2069 7320  ace= keyword is 
-0002dbc0: 6e6f 7420 7375 7070 6f72 7465 6422 290a  not supported").
-0002dbd0: 2020 2020 2020 2020 7072 655f 736f 7274          pre_sort
-0002dbe0: 6564 203d 2073 6f72 7465 640a 2020 2020  ed = sorted.    
-0002dbf0: 2020 2020 6465 6c20 736f 7274 6564 0a0a      del sorted..
-0002dc00: 2020 2020 2020 2020 2320 4368 6563 6b20          # Check 
-0002dc10: 6f74 6865 7220 6361 6e20 6265 2074 7261  other can be tra
-0002dc20: 6e73 6c61 7465 6420 746f 2063 6f6c 756d  nslated to colum
-0002dc30: 6e20 6e61 6d65 206f 7220 636f 6c75 6d6e  n name or column
-0002dc40: 206f 626a 6563 742c 2070 6f73 7369 626c   object, possibl
-0002dc50: 7920 666c 6174 7465 6e69 6e67 2069 740a  y flattening it.
-0002dc60: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-0002dc70: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
-0002dc80: 2073 7472 293a 0a20 2020 2020 2020 2020   str):.         
-0002dc90: 2020 2023 2049 7420 6d61 7920 7265 6665     # It may refe
-0002dca0: 7220 746f 2073 6576 6572 616c 2063 6f6c  r to several col
-0002dcb0: 756d 6e73 0a20 2020 2020 2020 2020 2020  umns.           
-0002dcc0: 2069 6620 6973 696e 7374 616e 6365 286f   if isinstance(o
-0002dcd0: 7468 6572 2c20 5365 7175 656e 6365 293a  ther, Sequence):
-0002dce0: 2020 2320 7479 7065 3a20 6967 6e6f 7265    # type: ignore
-0002dcf0: 5b75 6e72 6561 6368 6162 6c65 5d0a 2020  [unreachable].  
-0002dd00: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0002dd10: 4163 6365 7074 205b 2261 225d 2c20 6275  Accept ["a"], bu
-0002dd20: 7420 6e6f 7420 5b5b 2261 225d 5d0a 2020  t not [["a"]].  
-0002dd30: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0002dd40: 206c 656e 286f 7468 6572 2920 3d3d 2031   len(other) == 1
-0002dd50: 2061 6e64 2028 2020 2320 7479 7065 3a20   and (  # type: 
-0002dd60: 6967 6e6f 7265 5b75 6e72 6561 6368 6162  ignore[unreachab
-0002dd70: 6c65 5d0a 2020 2020 2020 2020 2020 2020  le].            
-0002dd80: 2020 2020 2020 2020 6973 696e 7374 616e          isinstan
-0002dd90: 6365 286f 7468 6572 5b30 5d2c 2073 7472  ce(other[0], str
-0002dda0: 2920 6f72 206e 6f74 2069 7369 6e73 7461  ) or not isinsta
-0002ddb0: 6e63 6528 6f74 6865 725b 305d 2c20 5365  nce(other[0], Se
-0002ddc0: 7175 656e 6365 290a 2020 2020 2020 2020  quence).        
-0002ddd0: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-0002dde0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-0002ddf0: 7468 6572 203d 206f 7468 6572 5b30 5d0a  ther = other[0].
-0002de00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002de10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0002de20: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0002de30: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
-0002de40: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0002de50: 2020 2020 2020 2020 2020 2020 2022 4461               "Da
-0002de60: 736b 2064 6174 6166 7261 6d65 2064 6f65  sk dataframe doe
-0002de70: 7320 6e6f 7420 7965 7420 7375 7070 6f72  s not yet suppor
-0002de80: 7420 6d75 6c74 692d 696e 6465 7865 732e  t multi-indexes.
-0002de90: 5c6e 220a 2020 2020 2020 2020 2020 2020  \n".            
-0002dea0: 2020 2020 2020 2020 2020 2020 6622 596f              f"Yo
-0002deb0: 7520 7472 6965 6420 746f 2069 6e64 6578  u tried to index
-0002dec0: 2077 6974 6820 7468 6973 2069 6e64 6578   with this index
-0002ded0: 3a20 7b6f 7468 6572 7d5c 6e22 0a20 2020  : {other}\n".   
-0002dee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002def0: 2020 2020 2022 496e 6465 7865 7320 6d75       "Indexes mu
-0002df00: 7374 2062 6520 7369 6e67 6c65 2063 6f6c  st be single col
-0002df10: 756d 6e73 206f 6e6c 792e 220a 2020 2020  umns only.".    
-0002df20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002df30: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
-0002df40: 204f 7220 6265 2061 2066 7261 6d65 2064   Or be a frame d
-0002df50: 6972 6563 746c 790a 2020 2020 2020 2020  irectly.        
-0002df60: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-0002df70: 6e63 6528 6f74 6865 722c 2044 6174 6146  nce(other, DataF
-0002df80: 7261 6d65 293a 2020 2320 7479 7065 3a20  rame):  # type: 
-0002df90: 6967 6e6f 7265 5b75 6e72 6561 6368 6162  ignore[unreachab
-0002dfa0: 6c65 5d0a 2020 2020 2020 2020 2020 2020  le].            
-0002dfb0: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-0002dfc0: 6c65 6d65 6e74 6564 4572 726f 7228 0a20  lementedError(. 
-0002dfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dfe0: 2020 2022 4461 736b 2064 6174 6166 7261     "Dask datafra
-0002dff0: 6d65 2064 6f65 7320 6e6f 7420 7965 7420  me does not yet 
-0002e000: 7375 7070 6f72 7420 6d75 6c74 692d 696e  support multi-in
-0002e010: 6465 7865 732e 5c6e 220a 2020 2020 2020  dexes.\n".      
-0002e020: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0002e030: 596f 7520 7472 6965 6420 746f 2069 6e64  You tried to ind
-0002e040: 6578 2077 6974 6820 6120 6672 616d 6520  ex with a frame 
-0002e050: 7769 7468 2074 6865 7365 2063 6f6c 756d  with these colum
-0002e060: 6e73 3a20 7b6c 6973 7428 6f74 6865 722e  ns: {list(other.
-0002e070: 636f 6c75 6d6e 7329 7d5c 6e22 0a20 2020  columns)}\n".   
-0002e080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e090: 2022 496e 6465 7865 7320 6d75 7374 2062   "Indexes must b
-0002e0a0: 6520 7369 6e67 6c65 2063 6f6c 756d 6e73  e single columns
-0002e0b0: 206f 6e6c 792e 220a 2020 2020 2020 2020   only.".        
-0002e0c0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0002e0d0: 2020 2023 2049 6620 616c 7265 6164 7920     # If already 
-0002e0e0: 6120 7365 7269 6573 0a20 2020 2020 2020  a series.       
-0002e0f0: 2069 6620 6973 696e 7374 616e 6365 286f   if isinstance(o
-0002e100: 7468 6572 2c20 5365 7269 6573 293a 0a20  ther, Series):. 
-0002e110: 2020 2020 2020 2020 2020 2023 2049 6620             # If 
-0002e120: 6974 2773 2061 6c72 6561 6479 2074 6865  it's already the
-0002e130: 2069 6e64 6578 2c20 7468 6572 6527 7320   index, there's 
-0002e140: 6e6f 7468 696e 6720 746f 2064 6f0a 2020  nothing to do.  
-0002e150: 2020 2020 2020 2020 2020 6966 206f 7468            if oth
-0002e160: 6572 2e5f 6e61 6d65 203d 3d20 7365 6c66  er._name == self
-0002e170: 2e69 6e64 6578 2e5f 6e61 6d65 3a0a 2020  .index._name:.  
-0002e180: 2020 2020 2020 2020 2020 2020 2020 7761                wa
-0002e190: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
-0002e1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e1b0: 2022 4e65 7720 696e 6465 7820 6861 7320   "New index has 
-0002e1c0: 7361 6d65 206e 616d 6520 6173 2065 7869  same name as exi
-0002e1d0: 7374 696e 672c 2074 6869 7320 6973 2061  sting, this is a
-0002e1e0: 206e 6f2d 6f70 2e22 2c20 5573 6572 5761   no-op.", UserWa
-0002e1f0: 726e 696e 670a 2020 2020 2020 2020 2020  rning.          
-0002e200: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0002e210: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002e220: 656c 660a 0a20 2020 2020 2020 2023 2049  elf..        # I
-0002e230: 6620 7468 6520 6e61 6d65 206f 6620 6120  f the name of a 
-0002e240: 636f 6c75 6d6e 2f69 6e64 6578 0a20 2020  column/index.   
-0002e250: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0002e260: 2020 2020 2020 2023 2057 6974 6820 7468         # With th
-0002e270: 6520 7361 6d65 206e 616d 6520 6173 2074  e same name as t
-0002e280: 6865 2069 6e64 6578 2c20 7468 6572 6527  he index, there'
-0002e290: 7320 6e6f 7468 696e 6720 746f 2064 6f20  s nothing to do 
-0002e2a0: 6569 7468 6572 0a20 2020 2020 2020 2020  either.         
-0002e2b0: 2020 2069 6620 6f74 6865 7220 3d3d 2073     if other == s
-0002e2c0: 656c 662e 696e 6465 782e 6e61 6d65 3a0a  elf.index.name:.
-0002e2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e2e0: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
-0002e2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e300: 2020 2022 4e65 7720 696e 6465 7820 6861     "New index ha
-0002e310: 7320 7361 6d65 206e 616d 6520 6173 2065  s same name as e
-0002e320: 7869 7374 696e 672c 2074 6869 7320 6973  xisting, this is
-0002e330: 2061 206e 6f2d 6f70 2e22 2c20 5573 6572   a no-op.", User
-0002e340: 5761 726e 696e 670a 2020 2020 2020 2020  Warning.        
-0002e350: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002e360: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0002e370: 2073 656c 660a 0a20 2020 2020 2020 2020   self..         
-0002e380: 2020 2023 2049 6620 6120 6d69 7373 696e     # If a missin
-0002e390: 6720 636f 6c75 6d6e 2c20 4b65 7945 7272  g column, KeyErr
-0002e3a0: 6f72 0a20 2020 2020 2020 2020 2020 2069  or.            i
-0002e3b0: 6620 6f74 6865 7220 6e6f 7420 696e 2073  f other not in s
-0002e3c0: 656c 662e 636f 6c75 6d6e 733a 0a20 2020  elf.columns:.   
-0002e3d0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0002e3e0: 7365 204b 6579 4572 726f 7228 0a20 2020  se KeyError(.   
-0002e3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e400: 2066 2244 6174 6120 6861 7320 6e6f 2063   f"Data has no c
-0002e410: 6f6c 756d 6e20 277b 6f74 6865 727d 273a  olumn '{other}':
-0002e420: 2075 7365 2061 6e79 2063 6f6c 756d 6e20   use any column 
-0002e430: 6f66 207b 6c69 7374 2873 656c 662e 636f  of {list(self.co
-0002e440: 6c75 6d6e 7329 7d22 0a20 2020 2020 2020  lumns)}".       
-0002e450: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0002e460: 2020 2020 2320 4368 6563 6b20 6469 7669      # Check divi
-0002e470: 7369 6f6e 730a 2020 2020 2020 2020 6966  sions.        if
-0002e480: 2064 6976 6973 696f 6e73 2069 7320 6e6f   divisions is no
-0002e490: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0002e4a0: 2020 2020 6368 6563 6b5f 6469 7669 7369      check_divisi
-0002e4b0: 6f6e 7328 6469 7669 7369 6f6e 7329 0a20  ons(divisions). 
-0002e4c0: 2020 2020 2020 2065 6c69 6620 280a 2020         elif (.  
-0002e4d0: 2020 2020 2020 2020 2020 6973 696e 7374            isinst
-0002e4e0: 616e 6365 286f 7468 6572 2c20 496e 6465  ance(other, Inde
-0002e4f0: 7829 0a20 2020 2020 2020 2020 2020 2061  x).            a
-0002e500: 6e64 206f 7468 6572 2e6b 6e6f 776e 5f64  nd other.known_d
-0002e510: 6976 6973 696f 6e73 0a20 2020 2020 2020  ivisions.       
-0002e520: 2020 2020 2061 6e64 206f 7468 6572 2e6e       and other.n
-0002e530: 7061 7274 6974 696f 6e73 203d 3d20 7365  partitions == se
-0002e540: 6c66 2e6e 7061 7274 6974 696f 6e73 0a20  lf.npartitions. 
-0002e550: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-0002e560: 2020 2020 2020 2320 4966 2074 6865 2069        # If the i
-0002e570: 6e64 6578 2068 6173 2074 6865 2073 616d  ndex has the sam
-0002e580: 6520 6e75 6d62 6572 206f 6620 7061 7274  e number of part
-0002e590: 6974 696f 6e73 2061 6e64 206b 6e6f 776e  itions and known
-0002e5a0: 0a20 2020 2020 2020 2020 2020 2023 2064  .            # d
-0002e5b0: 6976 6973 696f 6e73 2c20 7468 656e 2077  ivisions, then w
-0002e5c0: 6520 6361 6e20 7472 6561 7420 6974 2061  e can treat it a
-0002e5d0: 7320 7072 652d 736f 7274 6564 2077 6974  s pre-sorted wit
-0002e5e0: 6820 6b6e 6f77 6e0a 2020 2020 2020 2020  h known.        
-0002e5f0: 2020 2020 2320 6469 7669 7369 6f6e 730a      # divisions.
-0002e600: 2020 2020 2020 2020 2020 2020 7072 655f              pre_
-0002e610: 736f 7274 6564 203d 2054 7275 650a 2020  sorted = True.  
-0002e620: 2020 2020 2020 2020 2020 6469 7669 7369            divisi
-0002e630: 6f6e 7320 3d20 6f74 6865 722e 6469 7669  ons = other.divi
-0002e640: 7369 6f6e 730a 0a20 2020 2020 2020 2023  sions..        #
-0002e650: 2049 6620 696e 6465 7820 6973 2061 6c72   If index is alr
-0002e660: 6561 6479 2073 6f72 7465 642c 2074 616b  eady sorted, tak
-0002e670: 6520 6164 7661 6e74 6167 6520 6f66 2074  e advantage of t
-0002e680: 6861 7420 7769 7468 2073 6574 5f73 6f72  hat with set_sor
-0002e690: 7465 645f 696e 6465 780a 2020 2020 2020  ted_index.      
-0002e6a0: 2020 6966 2070 7265 5f73 6f72 7465 643a    if pre_sorted:
-0002e6b0: 0a20 2020 2020 2020 2020 2020 2066 726f  .            fro
-0002e6c0: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
-0002e6d0: 2e73 6875 6666 6c65 2069 6d70 6f72 7420  .shuffle import 
-0002e6e0: 7365 745f 736f 7274 6564 5f69 6e64 6578  set_sorted_index
-0002e6f0: 0a0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-0002e700: 7475 726e 2073 6574 5f73 6f72 7465 645f  turn set_sorted_
-0002e710: 696e 6465 7828 0a20 2020 2020 2020 2020  index(.         
-0002e720: 2020 2020 2020 2073 656c 662c 206f 7468         self, oth
-0002e730: 6572 2c20 6472 6f70 3d64 726f 702c 2064  er, drop=drop, d
-0002e740: 6976 6973 696f 6e73 3d64 6976 6973 696f  ivisions=divisio
-0002e750: 6e73 2c20 2a2a 6b77 6172 6773 0a20 2020  ns, **kwargs.   
-0002e760: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0002e770: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0002e780: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
-0002e790: 6174 6166 7261 6d65 2e73 6875 6666 6c65  ataframe.shuffle
-0002e7a0: 2069 6d70 6f72 7420 7365 745f 696e 6465   import set_inde
-0002e7b0: 780a 0a20 2020 2020 2020 2020 2020 2072  x..            r
-0002e7c0: 6574 7572 6e20 7365 745f 696e 6465 7828  eturn set_index(
-0002e7d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e7e0: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
-0002e7f0: 2020 2020 2020 206f 7468 6572 2c0a 2020         other,.  
-0002e800: 2020 2020 2020 2020 2020 2020 2020 6472                dr
-0002e810: 6f70 3d64 726f 702c 0a20 2020 2020 2020  op=drop,.       
-0002e820: 2020 2020 2020 2020 206e 7061 7274 6974           npartit
-0002e830: 696f 6e73 3d6e 7061 7274 6974 696f 6e73  ions=npartitions
-0002e840: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002e850: 2020 6469 7669 7369 6f6e 733d 6469 7669    divisions=divi
-0002e860: 7369 6f6e 732c 0a20 2020 2020 2020 2020  sions,.         
-0002e870: 2020 2020 2020 2073 6f72 743d 736f 7274         sort=sort
-0002e880: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002e890: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
-0002e8a0: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-0002e8b0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-0002e8c0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-0002e8d0: 6566 2070 6f70 2873 656c 662c 2069 7465  ef pop(self, ite
-0002e8e0: 6d29 3a0a 2020 2020 2020 2020 6f75 7420  m):.        out 
-0002e8f0: 3d20 7365 6c66 5b69 7465 6d5d 0a20 2020  = self[item].   
-0002e900: 2020 2020 2064 656c 2073 656c 665b 6974       del self[it
-0002e910: 656d 5d0a 2020 2020 2020 2020 7265 7475  em].        retu
-0002e920: 726e 206f 7574 0a0a 2020 2020 4064 6572  rn out..    @der
-0002e930: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-0002e940: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-0002e950: 6e6c 6172 6765 7374 2873 656c 662c 206e  nlargest(self, n
-0002e960: 3d35 2c20 636f 6c75 6d6e 733d 6e6f 5f64  =5, columns=no_d
-0002e970: 6566 6175 6c74 2c20 7370 6c69 745f 6576  efault, split_ev
-0002e980: 6572 793d 4e6f 6e65 293a 0a20 2020 2020  ery=None):.     
-0002e990: 2020 2069 6620 636f 6c75 6d6e 7320 6973     if columns is
-0002e9a0: 206e 6f5f 6465 6661 756c 743a 0a20 2020   no_default:.   
-0002e9b0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-0002e9c0: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
-0002e9d0: 2020 2020 2020 2020 2020 2244 6174 6146            "DataF
-0002e9e0: 7261 6d65 2e6e 6c61 7267 6573 7428 2920  rame.nlargest() 
-0002e9f0: 6d69 7373 696e 6720 7265 7175 6972 6564  missing required
-0002ea00: 2070 6f73 6974 696f 6e61 6c20 6172 6775   positional argu
-0002ea10: 6d65 6e74 3a20 2763 6f6c 756d 6e73 2722  ment: 'columns'"
-0002ea20: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0002ea30: 2020 2020 2020 2074 6f6b 656e 203d 2022         token = "
-0002ea40: 6461 7461 6672 616d 652d 6e6c 6172 6765  dataframe-nlarge
-0002ea50: 7374 220a 2020 2020 2020 2020 7265 7475  st".        retu
-0002ea60: 726e 2061 6361 280a 2020 2020 2020 2020  rn aca(.        
-0002ea70: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0002ea80: 2020 2020 2020 6368 756e 6b3d 4d2e 6e6c        chunk=M.nl
-0002ea90: 6172 6765 7374 2c0a 2020 2020 2020 2020  argest,.        
-0002eaa0: 2020 2020 6167 6772 6567 6174 653d 4d2e      aggregate=M.
-0002eab0: 6e6c 6172 6765 7374 2c0a 2020 2020 2020  nlargest,.      
-0002eac0: 2020 2020 2020 6d65 7461 3d73 656c 662e        meta=self.
-0002ead0: 5f6d 6574 612c 0a20 2020 2020 2020 2020  _meta,.         
-0002eae0: 2020 2074 6f6b 656e 3d74 6f6b 656e 2c0a     token=token,.
-0002eaf0: 2020 2020 2020 2020 2020 2020 7370 6c69              spli
-0002eb00: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
-0002eb10: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
-0002eb20: 206e 3d6e 2c0a 2020 2020 2020 2020 2020   n=n,.          
-0002eb30: 2020 636f 6c75 6d6e 733d 636f 6c75 6d6e    columns=column
-0002eb40: 732c 0a20 2020 2020 2020 2029 0a0a 2020  s,.        )..  
-0002eb50: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
-0002eb60: 7064 2e44 6174 6146 7261 6d65 290a 2020  pd.DataFrame).  
-0002eb70: 2020 6465 6620 6e73 6d61 6c6c 6573 7428    def nsmallest(
-0002eb80: 7365 6c66 2c20 6e3d 352c 2063 6f6c 756d  self, n=5, colum
-0002eb90: 6e73 3d6e 6f5f 6465 6661 756c 742c 2073  ns=no_default, s
-0002eba0: 706c 6974 5f65 7665 7279 3d4e 6f6e 6529  plit_every=None)
-0002ebb0: 3a0a 2020 2020 2020 2020 6966 2063 6f6c  :.        if col
-0002ebc0: 756d 6e73 2069 7320 6e6f 5f64 6566 6175  umns is no_defau
-0002ebd0: 6c74 3a0a 2020 2020 2020 2020 2020 2020  lt:.            
-0002ebe0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-0002ebf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ec00: 2022 4461 7461 4672 616d 652e 6e73 6d61   "DataFrame.nsma
-0002ec10: 6c6c 6573 7428 2920 6d69 7373 696e 6720  llest() missing 
-0002ec20: 7265 7175 6972 6564 2070 6f73 6974 696f  required positio
-0002ec30: 6e61 6c20 6172 6775 6d65 6e74 3a20 2763  nal argument: 'c
-0002ec40: 6f6c 756d 6e73 2722 0a20 2020 2020 2020  olumns'".       
-0002ec50: 2020 2020 2029 0a20 2020 2020 2020 2074       ).        t
-0002ec60: 6f6b 656e 203d 2022 6461 7461 6672 616d  oken = "datafram
-0002ec70: 652d 6e73 6d61 6c6c 6573 7422 0a20 2020  e-nsmallest".   
-0002ec80: 2020 2020 2072 6574 7572 6e20 6163 6128       return aca(
-0002ec90: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0002eca0: 662c 0a20 2020 2020 2020 2020 2020 2063  f,.            c
-0002ecb0: 6875 6e6b 3d4d 2e6e 736d 616c 6c65 7374  hunk=M.nsmallest
-0002ecc0: 2c0a 2020 2020 2020 2020 2020 2020 6167  ,.            ag
-0002ecd0: 6772 6567 6174 653d 4d2e 6e73 6d61 6c6c  gregate=M.nsmall
-0002ece0: 6573 742c 0a20 2020 2020 2020 2020 2020  est,.           
-0002ecf0: 206d 6574 613d 7365 6c66 2e5f 6d65 7461   meta=self._meta
-0002ed00: 2c0a 2020 2020 2020 2020 2020 2020 746f  ,.            to
-0002ed10: 6b65 6e3d 746f 6b65 6e2c 0a20 2020 2020  ken=token,.     
-0002ed20: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-0002ed30: 7279 3d73 706c 6974 5f65 7665 7279 2c0a  ry=split_every,.
-0002ed40: 2020 2020 2020 2020 2020 2020 6e3d 6e2c              n=n,
-0002ed50: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-0002ed60: 756d 6e73 3d63 6f6c 756d 6e73 2c0a 2020  umns=columns,.  
-0002ed70: 2020 2020 2020 290a 0a20 2020 2040 6465        )..    @de
-0002ed80: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-0002ed90: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-0002eda0: 2067 726f 7570 6279 280a 2020 2020 2020   groupby(.      
-0002edb0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0002edc0: 6279 3d4e 6f6e 652c 0a20 2020 2020 2020  by=None,.       
-0002edd0: 2067 726f 7570 5f6b 6579 733d 4752 4f55   group_keys=GROU
-0002ede0: 505f 4b45 5953 5f44 4546 4155 4c54 2c0a  P_KEYS_DEFAULT,.
-0002edf0: 2020 2020 2020 2020 736f 7274 3d4e 6f6e          sort=Non
-0002ee00: 652c 0a20 2020 2020 2020 206f 6273 6572  e,.        obser
-0002ee10: 7665 643d 4e6f 6e65 2c0a 2020 2020 2020  ved=None,.      
-0002ee20: 2020 6472 6f70 6e61 3d4e 6f6e 652c 0a20    dropna=None,. 
-0002ee30: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
-0002ee40: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0002ee50: 6672 6f6d 2064 6173 6b2e 6461 7461 6672  from dask.datafr
-0002ee60: 616d 652e 6772 6f75 7062 7920 696d 706f  ame.groupby impo
-0002ee70: 7274 2044 6174 6146 7261 6d65 4772 6f75  rt DataFrameGrou
-0002ee80: 7042 790a 0a20 2020 2020 2020 2072 6574  pBy..        ret
-0002ee90: 7572 6e20 4461 7461 4672 616d 6547 726f  urn DataFrameGro
-0002eea0: 7570 4279 280a 2020 2020 2020 2020 2020  upBy(.          
-0002eeb0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0002eec0: 2020 2020 6279 3d62 792c 0a20 2020 2020      by=by,.     
-0002eed0: 2020 2020 2020 2067 726f 7570 5f6b 6579         group_key
-0002eee0: 733d 6772 6f75 705f 6b65 7973 2c0a 2020  s=group_keys,.  
-0002eef0: 2020 2020 2020 2020 2020 736f 7274 3d73            sort=s
-0002ef00: 6f72 742c 0a20 2020 2020 2020 2020 2020  ort,.           
-0002ef10: 206f 6273 6572 7665 643d 6f62 7365 7276   observed=observ
-0002ef20: 6564 2c0a 2020 2020 2020 2020 2020 2020  ed,.            
-0002ef30: 6472 6f70 6e61 3d64 726f 706e 612c 0a20  dropna=dropna,. 
-0002ef40: 2020 2020 2020 2020 2020 202a 2a6b 7761             **kwa
-0002ef50: 7267 732c 0a20 2020 2020 2020 2029 0a0a  rgs,.        )..
-0002ef60: 2020 2020 4077 7261 7073 2863 6174 6567      @wraps(categ
-0002ef70: 6f72 697a 6529 0a20 2020 2064 6566 2063  orize).    def c
-0002ef80: 6174 6567 6f72 697a 6528 7365 6c66 2c20  ategorize(self, 
-0002ef90: 636f 6c75 6d6e 733d 4e6f 6e65 2c20 696e  columns=None, in
-0002efa0: 6465 783d 4e6f 6e65 2c20 7370 6c69 745f  dex=None, split_
-0002efb0: 6576 6572 793d 4e6f 6e65 2c20 2a2a 6b77  every=None, **kw
-0002efc0: 6172 6773 293a 0a20 2020 2020 2020 2072  args):.        r
-0002efd0: 6574 7572 6e20 6361 7465 676f 7269 7a65  eturn categorize
-0002efe0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-0002eff0: 6c66 2c20 636f 6c75 6d6e 733d 636f 6c75  lf, columns=colu
-0002f000: 6d6e 732c 2069 6e64 6578 3d69 6e64 6578  mns, index=index
-0002f010: 2c20 7370 6c69 745f 6576 6572 793d 7370  , split_every=sp
-0002f020: 6c69 745f 6576 6572 792c 202a 2a6b 7761  lit_every, **kwa
-0002f030: 7267 730a 2020 2020 2020 2020 290a 0a20  rgs.        ).. 
-0002f040: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-0002f050: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-0002f060: 2020 2064 6566 2061 7373 6967 6e28 7365     def assign(se
-0002f070: 6c66 2c20 2a2a 6b77 6172 6773 293a 0a20  lf, **kwargs):. 
-0002f080: 2020 2020 2020 2064 6174 6120 3d20 7365         data = se
-0002f090: 6c66 2e63 6f70 7928 290a 2020 2020 2020  lf.copy().      
-0002f0a0: 2020 666f 7220 6b2c 2076 2069 6e20 6b77    for k, v in kw
-0002f0b0: 6172 6773 2e69 7465 6d73 2829 3a0a 2020  args.items():.  
-0002f0c0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0002f0d0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-0002f0e0: 2020 2069 7369 6e73 7461 6e63 6528 762c     isinstance(v,
-0002f0f0: 2053 6361 6c61 7229 0a20 2020 2020 2020   Scalar).       
-0002f100: 2020 2020 2020 2020 206f 7220 6973 5f73           or is_s
-0002f110: 6572 6965 735f 6c69 6b65 2876 290a 2020  eries_like(v).  
-0002f120: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-0002f130: 2063 616c 6c61 626c 6528 7629 0a20 2020   callable(v).   
-0002f140: 2020 2020 2020 2020 2020 2020 206f 7220               or 
-0002f150: 7064 2e61 7069 2e74 7970 6573 2e69 735f  pd.api.types.is_
-0002f160: 7363 616c 6172 2876 290a 2020 2020 2020  scalar(v).      
-0002f170: 2020 2020 2020 2020 2020 6f72 2069 735f            or is_
-0002f180: 696e 6465 785f 6c69 6b65 2876 290a 2020  index_like(v).  
-0002f190: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-0002f1a0: 2069 7369 6e73 7461 6e63 6528 762c 2041   isinstance(v, A
-0002f1b0: 7272 6179 290a 2020 2020 2020 2020 2020  rray).          
-0002f1c0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-0002f1d0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-0002f1e0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0002f1f0: 2020 2020 2020 2020 2020 6622 436f 6c75            f"Colu
-0002f200: 6d6e 2061 7373 6967 6e6d 656e 7420 646f  mn assignment do
-0002f210: 6573 6e27 7420 7375 7070 6f72 7420 7479  esn't support ty
-0002f220: 7065 207b 7479 7065 6e61 6d65 2874 7970  pe {typename(typ
-0002f230: 6528 7629 297d 220a 2020 2020 2020 2020  e(v))}".        
-0002f240: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002f250: 2020 2020 2020 6966 2063 616c 6c61 626c        if callabl
-0002f260: 6528 7629 3a0a 2020 2020 2020 2020 2020  e(v):.          
-0002f270: 2020 2020 2020 6b77 6172 6773 5b6b 5d20        kwargs[k] 
-0002f280: 3d20 7628 6461 7461 290a 2020 2020 2020  = v(data).      
-0002f290: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0002f2a0: 6e63 6528 762c 2041 7272 6179 293a 0a20  nce(v, Array):. 
-0002f2b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0002f2c0: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
-0002f2d0: 6d65 2e69 6f20 696d 706f 7274 2066 726f  me.io import fro
-0002f2e0: 6d5f 6461 736b 5f61 7272 6179 0a0a 2020  m_dask_array..  
-0002f2f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0002f300: 206c 656e 2876 2e73 6861 7065 2920 3e20   len(v.shape) > 
-0002f310: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-0002f320: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0002f330: 7565 4572 726f 7228 2241 7272 6179 2061  ueError("Array a
-0002f340: 7373 6967 6e6d 656e 7420 6f6e 6c79 2073  ssignment only s
-0002f350: 7570 706f 7274 7320 312d 4420 6172 7261  upports 1-D arra
-0002f360: 7973 2229 0a20 2020 2020 2020 2020 2020  ys").           
-0002f370: 2020 2020 2069 6620 762e 6e70 6172 7469       if v.nparti
-0002f380: 7469 6f6e 7320 213d 2064 6174 612e 6e70  tions != data.np
-0002f390: 6172 7469 7469 6f6e 733a 0a20 2020 2020  artitions:.     
-0002f3a0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0002f3b0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0002f3c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f3d0: 2020 2020 2020 2020 2022 4e75 6d62 6572           "Number
-0002f3e0: 206f 6620 7061 7274 6974 696f 6e73 2064   of partitions d
-0002f3f0: 6f20 6e6f 7420 6d61 7463 6820 220a 2020  o not match ".  
-0002f400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f410: 2020 2020 2020 6622 287b 762e 6e70 6172        f"({v.npar
-0002f420: 7469 7469 6f6e 737d 2021 3d20 7b64 6174  titions} != {dat
-0002f430: 612e 6e70 6172 7469 7469 6f6e 737d 2922  a.npartitions})"
-0002f440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f450: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0002f460: 2020 2020 2020 206b 7761 7267 735b 6b5d         kwargs[k]
-0002f470: 203d 2066 726f 6d5f 6461 736b 5f61 7272   = from_dask_arr
-0002f480: 6179 2876 2c20 696e 6465 783d 6461 7461  ay(v, index=data
-0002f490: 2e69 6e64 6578 2c20 6d65 7461 3d64 6174  .index, meta=dat
-0002f4a0: 612e 5f6d 6574 6129 0a0a 2020 2020 2020  a._meta)..      
-0002f4b0: 2020 2020 2020 7061 6972 7320 3d20 5b6b        pairs = [k
-0002f4c0: 2c20 6b77 6172 6773 5b6b 5d5d 0a0a 2020  , kwargs[k]]..  
-0002f4d0: 2020 2020 2020 2020 2020 2320 4669 6775            # Figu
-0002f4e0: 7265 206f 7574 2063 6f6c 756d 6e73 206f  re out columns o
-0002f4f0: 6620 7468 6520 6f75 7470 7574 0a20 2020  f the output.   
-0002f500: 2020 2020 2020 2020 2064 6632 203d 2064           df2 = d
-0002f510: 6174 612e 5f6d 6574 615f 6e6f 6e65 6d70  ata._meta_nonemp
-0002f520: 7479 2e61 7373 6967 6e28 0a20 2020 2020  ty.assign(.     
-0002f530: 2020 2020 2020 2020 2020 202a 2a5f 6578             **_ex
-0002f540: 7472 6163 745f 6d65 7461 287b 6b3a 206b  tract_meta({k: k
-0002f550: 7761 7267 735b 6b5d 7d2c 206e 6f6e 656d  wargs[k]}, nonem
-0002f560: 7074 793d 5472 7565 290a 2020 2020 2020  pty=True).      
-0002f570: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0002f580: 2020 2020 6461 7461 203d 2065 6c65 6d77      data = elemw
-0002f590: 6973 6528 6d65 7468 6f64 732e 6173 7369  ise(methods.assi
-0002f5a0: 676e 2c20 6461 7461 2c20 2a70 6169 7273  gn, data, *pairs
-0002f5b0: 2c20 6d65 7461 3d64 6632 290a 0a20 2020  , meta=df2)..   
-0002f5c0: 2020 2020 2072 6574 7572 6e20 6461 7461       return data
-0002f5d0: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
-0002f5e0: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
-0002f5f0: 2c20 7561 5f61 7267 733d 5b22 696e 6465  , ua_args=["inde
-0002f600: 7822 5d29 0a20 2020 2064 6566 2072 656e  x"]).    def ren
-0002f610: 616d 6528 7365 6c66 2c20 696e 6465 783d  ame(self, index=
-0002f620: 4e6f 6e65 2c20 636f 6c75 6d6e 733d 4e6f  None, columns=No
-0002f630: 6e65 293a 0a20 2020 2020 2020 2069 6620  ne):.        if 
-0002f640: 696e 6465 7820 6973 206e 6f74 204e 6f6e  index is not Non
-0002f650: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0002f660: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0002f670: 2243 616e 6e6f 7420 7265 6e61 6d65 2069  "Cannot rename i
-0002f680: 6e64 6578 2e22 290a 0a20 2020 2020 2020  ndex.")..       
-0002f690: 2023 202a 6172 6773 2068 6572 6520 6973   # *args here is
-0002f6a0: 2069 6e64 6578 2c20 636f 6c75 6d6e 7320   index, columns 
-0002f6b0: 6275 7420 636f 6c75 6d6e 7320 6172 6720  but columns arg 
-0002f6c0: 6973 2061 6c72 6561 6479 2075 7365 640a  is already used.
-0002f6d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0002f6e0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-0002f6f0: 6e73 284d 2e72 656e 616d 652c 204e 6f6e  ns(M.rename, Non
-0002f700: 652c 2063 6f6c 756d 6e73 3d63 6f6c 756d  e, columns=colum
-0002f710: 6e73 290a 0a20 2020 2064 6566 2071 7565  ns)..    def que
-0002f720: 7279 2873 656c 662c 2065 7870 722c 202a  ry(self, expr, *
-0002f730: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-0002f740: 2020 2222 2246 696c 7465 7220 6461 7461    """Filter data
-0002f750: 6672 616d 6520 7769 7468 2063 6f6d 706c  frame with compl
-0002f760: 6578 2065 7870 7265 7373 696f 6e0a 0a20  ex expression.. 
-0002f770: 2020 2020 2020 2042 6c6f 636b 6564 2076         Blocked v
-0002f780: 6572 7369 6f6e 206f 6620 7064 2e44 6174  ersion of pd.Dat
-0002f790: 6146 7261 6d65 2e71 7565 7279 0a0a 2020  aFrame.query..  
-0002f7a0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-0002f7b0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0002f7c0: 2d2d 2d0a 2020 2020 2020 2020 6578 7072  ---.        expr
-0002f7d0: 3a20 7374 720a 2020 2020 2020 2020 2020  : str.          
-0002f7e0: 2020 5468 6520 7175 6572 7920 7374 7269    The query stri
-0002f7f0: 6e67 2074 6f20 6576 616c 7561 7465 2e0a  ng to evaluate..
-0002f800: 2020 2020 2020 2020 2020 2020 596f 7520              You 
-0002f810: 6361 6e20 7265 6665 7220 746f 2063 6f6c  can refer to col
-0002f820: 756d 6e20 6e61 6d65 7320 7468 6174 2061  umn names that a
-0002f830: 7265 206e 6f74 2076 616c 6964 2050 7974  re not valid Pyt
-0002f840: 686f 6e20 7661 7269 6162 6c65 206e 616d  hon variable nam
-0002f850: 6573 0a20 2020 2020 2020 2020 2020 2062  es.            b
-0002f860: 7920 7375 7272 6f75 6e64 696e 6720 7468  y surrounding th
-0002f870: 656d 2069 6e20 6261 636b 7469 636b 732e  em in backticks.
-0002f880: 0a20 2020 2020 2020 2020 2020 2044 6173  .            Das
-0002f890: 6b20 646f 6573 206e 6f74 2066 756c 6c79  k does not fully
-0002f8a0: 2073 7570 706f 7274 2072 6566 6572 7269   support referri
-0002f8b0: 6e67 2074 6f20 7661 7269 6162 6c65 7320  ng to variables 
-0002f8c0: 7573 696e 6720 7468 6520 2740 2720 6368  using the '@' ch
-0002f8d0: 6172 6163 7465 722c 0a20 2020 2020 2020  aracter,.       
-0002f8e0: 2020 2020 2075 7365 2066 2d73 7472 696e       use f-strin
-0002f8f0: 6773 206f 7220 7468 6520 6060 6c6f 6361  gs or the ``loca
-0002f900: 6c5f 6469 6374 6060 206b 6579 776f 7264  l_dict`` keyword
-0002f910: 2061 7267 756d 656e 7420 696e 7374 6561   argument instea
-0002f920: 642e 0a0a 2020 2020 2020 2020 4e6f 7465  d...        Note
-0002f930: 730a 2020 2020 2020 2020 2d2d 2d2d 2d0a  s.        -----.
-0002f940: 2020 2020 2020 2020 5468 6973 2069 7320          This is 
-0002f950: 6c69 6b65 2074 6865 2073 6571 7565 6e74  like the sequent
-0002f960: 6961 6c20 7665 7273 696f 6e20 6578 6365  ial version exce
-0002f970: 7074 2074 6861 7420 7468 6973 2077 696c  pt that this wil
-0002f980: 6c20 616c 736f 2068 6170 7065 6e0a 2020  l also happen.  
-0002f990: 2020 2020 2020 696e 206d 616e 7920 7468        in many th
-0002f9a0: 7265 6164 732e 2020 5468 6973 206d 6179  reads.  This may
-0002f9b0: 2063 6f6e 666c 6963 7420 7769 7468 2060   conflict with `
-0002f9c0: 606e 756d 6578 7072 6060 2077 6869 6368  `numexpr`` which
-0002f9d0: 2077 696c 6c20 7573 650a 2020 2020 2020   will use.      
-0002f9e0: 2020 6d75 6c74 6970 6c65 2074 6872 6561    multiple threa
-0002f9f0: 6473 2069 7473 656c 662e 2020 5765 2072  ds itself.  We r
-0002fa00: 6563 6f6d 6d65 6e64 2074 6861 7420 796f  ecommend that yo
-0002fa10: 7520 7365 7420 6060 6e75 6d65 7870 7260  u set ``numexpr`
-0002fa20: 6020 746f 2075 7365 2061 0a20 2020 2020  ` to use a.     
-0002fa30: 2020 2073 696e 676c 6520 7468 7265 6164     single thread
-0002fa40: 3a0a 0a20 2020 2020 2020 202e 2e20 636f  :..        .. co
-0002fa50: 6465 2d62 6c6f 636b 3a3a 2070 7974 686f  de-block:: pytho
-0002fa60: 6e0a 0a20 2020 2020 2020 2020 2020 2069  n..            i
-0002fa70: 6d70 6f72 7420 6e75 6d65 7870 720a 2020  mport numexpr.  
-0002fa80: 2020 2020 2020 2020 2020 6e75 6d65 7870            numexp
-0002fa90: 722e 7365 745f 6e75 6d5f 7468 7265 6164  r.set_num_thread
-0002faa0: 7328 3129 0a0a 2020 2020 2020 2020 5365  s(1)..        Se
-0002fab0: 6520 616c 736f 0a20 2020 2020 2020 202d  e also.        -
-0002fac0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0002fad0: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
-0002fae0: 2e71 7565 7279 0a20 2020 2020 2020 2070  .query.        p
-0002faf0: 616e 6461 732e 6576 616c 0a0a 2020 2020  andas.eval..    
-0002fb00: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
-0002fb10: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-0002fb20: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-0002fb30: 2070 616e 6461 7320 6173 2070 640a 2020   pandas as pd.  
-0002fb40: 2020 2020 2020 3e3e 3e20 696d 706f 7274        >>> import
-0002fb50: 2064 6173 6b2e 6461 7461 6672 616d 6520   dask.dataframe 
-0002fb60: 6173 2064 640a 2020 2020 2020 2020 3e3e  as dd.        >>
-0002fb70: 3e20 6466 203d 2070 642e 4461 7461 4672  > df = pd.DataFr
-0002fb80: 616d 6528 7b27 7827 3a20 5b31 2c20 322c  ame({'x': [1, 2,
-0002fb90: 2031 2c20 325d 2c0a 2020 2020 2020 2020   1, 2],.        
-0002fba0: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-0002fbb0: 2020 2020 2020 2027 7927 3a20 5b31 2c20         'y': [1, 
-0002fbc0: 322c 2033 2c20 345d 2c0a 2020 2020 2020  2, 3, 4],.      
-0002fbd0: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
-0002fbe0: 2020 2020 2020 2020 2027 7a20 7a27 3a20           'z z': 
-0002fbf0: 5b34 2c20 332c 2032 2c20 315d 7d29 0a20  [4, 3, 2, 1]}). 
-0002fc00: 2020 2020 2020 203e 3e3e 2064 6466 203d         >>> ddf =
-0002fc10: 2064 642e 6672 6f6d 5f70 616e 6461 7328   dd.from_pandas(
-0002fc20: 6466 2c20 6e70 6172 7469 7469 6f6e 733d  df, npartitions=
-0002fc30: 3229 0a0a 2020 2020 2020 2020 5265 6665  2)..        Refe
-0002fc40: 7220 746f 2063 6f6c 756d 6e20 6e61 6d65  r to column name
-0002fc50: 7320 6469 7265 6374 6c79 3a0a 0a20 2020  s directly:..   
-0002fc60: 2020 2020 203e 3e3e 2064 6466 2e71 7565       >>> ddf.que
-0002fc70: 7279 2827 7920 3e20 7827 292e 636f 6d70  ry('y > x').comp
-0002fc80: 7574 6528 290a 2020 2020 2020 2020 2020  ute().          
-0002fc90: 2078 2020 7920 207a 207a 0a20 2020 2020   x  y  z z.     
-0002fca0: 2020 2032 2020 3120 2033 2020 2020 320a     2  1  3    2.
-0002fcb0: 2020 2020 2020 2020 3320 2032 2020 3420          3  2  4 
-0002fcc0: 2020 2031 0a0a 2020 2020 2020 2020 5265     1..        Re
-0002fcd0: 6665 7220 746f 2063 6f6c 756d 6e20 6e61  fer to column na
-0002fce0: 6d65 2075 7369 6e67 2062 6163 6b74 6963  me using backtic
-0002fcf0: 6b73 3a0a 0a20 2020 2020 2020 203e 3e3e  ks:..        >>>
-0002fd00: 2064 6466 2e71 7565 7279 2827 607a 207a   ddf.query('`z z
-0002fd10: 6020 3e20 7827 292e 636f 6d70 7574 6528  ` > x').compute(
-0002fd20: 290a 2020 2020 2020 2020 2020 2078 2020  ).           x  
-0002fd30: 7920 207a 207a 0a20 2020 2020 2020 2030  y  z z.        0
-0002fd40: 2020 3120 2031 2020 2020 340a 2020 2020    1  1    4.    
-0002fd50: 2020 2020 3120 2032 2020 3220 2020 2033      1  2  2    3
-0002fd60: 0a20 2020 2020 2020 2032 2020 3120 2033  .        2  1  3
-0002fd70: 2020 2020 320a 0a20 2020 2020 2020 2052      2..        R
-0002fd80: 6566 6572 2074 6f20 7661 7269 6162 6c65  efer to variable
-0002fd90: 206e 616d 6520 7573 696e 6720 662d 7374   name using f-st
-0002fda0: 7269 6e67 733a 0a0a 2020 2020 2020 2020  rings:..        
-0002fdb0: 3e3e 3e20 7661 6c75 6520 3d20 310a 2020  >>> value = 1.  
-0002fdc0: 2020 2020 2020 3e3e 3e20 6464 662e 7175        >>> ddf.qu
-0002fdd0: 6572 7928 6627 7820 3d3d 207b 7661 6c75  ery(f'x == {valu
-0002fde0: 657d 2729 2e63 6f6d 7075 7465 2829 0a20  e}').compute(). 
-0002fdf0: 2020 2020 2020 2020 2020 7820 2079 2020            x  y  
-0002fe00: 7a20 7a0a 2020 2020 2020 2020 3020 2031  z z.        0  1
-0002fe10: 2020 3120 2020 2034 0a20 2020 2020 2020    1    4.       
-0002fe20: 2032 2020 3120 2033 2020 2020 320a 0a20   2  1  3    2.. 
-0002fe30: 2020 2020 2020 2052 6566 6572 2074 6f20         Refer to 
-0002fe40: 7661 7269 6162 6c65 206e 616d 6520 7573  variable name us
-0002fe50: 696e 6720 6060 6c6f 6361 6c5f 6469 6374  ing ``local_dict
-0002fe60: 6060 3a0a 0a20 2020 2020 2020 203e 3e3e  ``:..        >>>
-0002fe70: 2064 6466 2e71 7565 7279 2827 7820 3d3d   ddf.query('x ==
-0002fe80: 2040 7661 6c75 6527 2c20 6c6f 6361 6c5f   @value', local_
-0002fe90: 6469 6374 3d7b 2276 616c 7565 223a 2076  dict={"value": v
-0002fea0: 616c 7565 7d29 2e63 6f6d 7075 7465 2829  alue}).compute()
-0002feb0: 0a20 2020 2020 2020 2020 2020 7820 2079  .           x  y
-0002fec0: 2020 7a20 7a0a 2020 2020 2020 2020 3020    z z.        0 
-0002fed0: 2031 2020 3120 2020 2034 0a20 2020 2020   1  1    4.     
-0002fee0: 2020 2032 2020 3120 2033 2020 2020 320a     2  1  3    2.
-0002fef0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0002ff00: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0002ff10: 6d61 705f 7061 7274 6974 696f 6e73 284d  map_partitions(M
-0002ff20: 2e71 7565 7279 2c20 6578 7072 2c20 2a2a  .query, expr, **
-0002ff30: 6b77 6172 6773 290a 0a20 2020 2040 6465  kwargs)..    @de
-0002ff40: 7269 7665 645f 6672 6f6d 2870 642e 4461  rived_from(pd.Da
-0002ff50: 7461 4672 616d 6529 0a20 2020 2064 6566  taFrame).    def
-0002ff60: 2065 7661 6c28 7365 6c66 2c20 6578 7072   eval(self, expr
-0002ff70: 2c20 696e 706c 6163 653d 4e6f 6e65 2c20  , inplace=None, 
-0002ff80: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
-0002ff90: 2020 2069 6620 696e 706c 6163 6520 6973     if inplace is
-0002ffa0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0002ffb0: 2020 2069 6e70 6c61 6365 203d 2046 616c     inplace = Fal
-0002ffc0: 7365 0a20 2020 2020 2020 2069 6620 223d  se.        if "=
-0002ffd0: 2220 696e 2065 7870 7220 616e 6420 696e  " in expr and in
-0002ffe0: 706c 6163 6520 696e 2028 5472 7565 2c20  place in (True, 
-0002fff0: 4e6f 6e65 293a 0a20 2020 2020 2020 2020  None):.         
-00030000: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-00030010: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
-00030020: 2020 2020 2020 2020 2020 2020 2020 2249                "I
-00030030: 6e70 6c61 6365 2065 7661 6c20 6e6f 7420  nplace eval not 
-00030040: 7375 7070 6f72 7465 642e 2050 6c65 6173  supported. Pleas
-00030050: 6520 7573 6520 696e 706c 6163 653d 4661  e use inplace=Fa
-00030060: 6c73 6522 0a20 2020 2020 2020 2020 2020  lse".           
-00030070: 2029 0a20 2020 2020 2020 206d 6574 6120   ).        meta 
-00030080: 3d20 7365 6c66 2e5f 6d65 7461 2e65 7661  = self._meta.eva
-00030090: 6c28 6578 7072 2c20 696e 706c 6163 653d  l(expr, inplace=
-000300a0: 696e 706c 6163 652c 202a 2a6b 7761 7267  inplace, **kwarg
-000300b0: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
-000300c0: 6e20 7365 6c66 2e6d 6170 5f70 6172 7469  n self.map_parti
-000300d0: 7469 6f6e 7328 4d2e 6576 616c 2c20 6578  tions(M.eval, ex
-000300e0: 7072 2c20 6d65 7461 3d6d 6574 612c 2069  pr, meta=meta, i
-000300f0: 6e70 6c61 6365 3d69 6e70 6c61 6365 2c20  nplace=inplace, 
-00030100: 2a2a 6b77 6172 6773 290a 0a20 2020 2040  **kwargs)..    @
-00030110: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00030120: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-00030130: 6566 2064 726f 706e 6128 7365 6c66 2c20  ef dropna(self, 
-00030140: 686f 773d 6e6f 5f64 6566 6175 6c74 2c20  how=no_default, 
-00030150: 7375 6273 6574 3d4e 6f6e 652c 2074 6872  subset=None, thr
-00030160: 6573 683d 6e6f 5f64 6566 6175 6c74 293a  esh=no_default):
-00030170: 0a20 2020 2020 2020 2023 2054 6865 7365  .        # These
-00030180: 206b 6579 776f 7264 7320 6172 6520 696e   keywords are in
-00030190: 636f 6d70 6174 6962 6c65 2077 6974 6820  compatible with 
-000301a0: 6561 6368 206f 7468 6572 2e0a 2020 2020  each other..    
-000301b0: 2020 2020 2320 446f 6e27 7420 616c 6c6f      # Don't allo
-000301c0: 7720 7468 656d 2062 6f74 6820 746f 2062  w them both to b
-000301d0: 6520 7365 742e 0a20 2020 2020 2020 2069  e set..        i
-000301e0: 6620 686f 7720 6973 206e 6f74 206e 6f5f  f how is not no_
-000301f0: 6465 6661 756c 7420 616e 6420 7468 7265  default and thre
-00030200: 7368 2069 7320 6e6f 7420 6e6f 5f64 6566  sh is not no_def
-00030210: 6175 6c74 3a0a 2020 2020 2020 2020 2020  ault:.          
-00030220: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-00030230: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00030240: 2020 2022 596f 7520 6361 6e6e 6f74 2073     "You cannot s
-00030250: 6574 2062 6f74 6820 7468 6520 686f 7720  et both the how 
-00030260: 616e 6420 7468 7265 7368 2061 7267 756d  and thresh argum
-00030270: 656e 7473 2061 7420 7468 6520 7361 6d65  ents at the same
-00030280: 2074 696d 652e 220a 2020 2020 2020 2020   time.".        
-00030290: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
-000302a0: 204f 6e6c 7920 7370 6563 6966 7920 6068   Only specify `h
-000302b0: 6f77 6020 6f72 2060 7468 7265 7368 6020  ow` or `thresh` 
-000302c0: 6b65 7977 6f72 6420 6966 2073 7065 6369  keyword if speci
-000302d0: 6669 6564 2062 7920 7468 6520 7573 6572  fied by the user
-000302e0: 0a20 2020 2020 2020 2023 2073 6f20 7765  .        # so we
-000302f0: 2075 7469 6c69 7a65 206f 7468 6572 2060   utilize other `
-00030300: 6472 6f70 6e61 6020 6b65 7977 6f72 6420  dropna` keyword 
-00030310: 6465 6661 756c 7473 2061 7070 726f 7072  defaults appropr
-00030320: 6961 7465 6c79 0a20 2020 2020 2020 206b  iately.        k
-00030330: 7761 7267 7320 3d20 7b22 7375 6273 6574  wargs = {"subset
-00030340: 223a 2073 7562 7365 747d 0a20 2020 2020  ": subset}.     
-00030350: 2020 2069 6620 686f 7720 6973 206e 6f74     if how is not
-00030360: 206e 6f5f 6465 6661 756c 743a 0a20 2020   no_default:.   
-00030370: 2020 2020 2020 2020 206b 7761 7267 735b           kwargs[
-00030380: 2268 6f77 225d 203d 2068 6f77 0a20 2020  "how"] = how.   
-00030390: 2020 2020 2065 6c69 6620 7468 7265 7368       elif thresh
-000303a0: 2069 7320 6e6f 7420 6e6f 5f64 6566 6175   is not no_defau
-000303b0: 6c74 3a0a 2020 2020 2020 2020 2020 2020  lt:.            
-000303c0: 6b77 6172 6773 5b22 7468 7265 7368 225d  kwargs["thresh"]
-000303d0: 203d 2074 6872 6573 680a 0a20 2020 2020   = thresh..     
-000303e0: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-000303f0: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
-00030400: 6472 6f70 6e61 2c20 2a2a 6b77 6172 6773  dropna, **kwargs
-00030410: 2c20 656e 666f 7263 655f 6d65 7461 6461  , enforce_metada
-00030420: 7461 3d46 616c 7365 290a 0a20 2020 2040  ta=False)..    @
-00030430: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00030440: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-00030450: 6566 2063 6c69 7028 7365 6c66 2c20 6c6f  ef clip(self, lo
-00030460: 7765 723d 4e6f 6e65 2c20 7570 7065 723d  wer=None, upper=
-00030470: 4e6f 6e65 2c20 6f75 743d 4e6f 6e65 293a  None, out=None):
-00030480: 0a20 2020 2020 2020 2069 6620 6f75 7420  .        if out 
-00030490: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-000304a0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-000304b0: 616c 7565 4572 726f 7228 2227 6f75 7427  alueError("'out'
-000304c0: 206d 7573 7420 6265 204e 6f6e 6522 290a   must be None").
-000304d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000304e0: 656c 662e 6d61 705f 7061 7274 6974 696f  elf.map_partitio
-000304f0: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
-00030500: 4d2e 636c 6970 2c20 6c6f 7765 723d 6c6f  M.clip, lower=lo
-00030510: 7765 722c 2075 7070 6572 3d75 7070 6572  wer, upper=upper
-00030520: 2c20 656e 666f 7263 655f 6d65 7461 6461  , enforce_metada
-00030530: 7461 3d46 616c 7365 0a20 2020 2020 2020  ta=False.       
-00030540: 2029 0a0a 2020 2020 4064 6572 6976 6564   )..    @derived
-00030550: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-00030560: 6d65 290a 2020 2020 6465 6620 7371 7565  me).    def sque
-00030570: 657a 6528 7365 6c66 2c20 6178 6973 3d4e  eze(self, axis=N
-00030580: 6f6e 6529 3a0a 2020 2020 2020 2020 6966  one):.        if
-00030590: 2061 7869 7320 696e 205b 4e6f 6e65 2c20   axis in [None, 
-000305a0: 315d 3a0a 2020 2020 2020 2020 2020 2020  1]:.            
-000305b0: 6966 206c 656e 2873 656c 662e 636f 6c75  if len(self.colu
-000305c0: 6d6e 7329 203d 3d20 313a 0a20 2020 2020  mns) == 1:.     
-000305d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000305e0: 6e20 7365 6c66 5b73 656c 662e 636f 6c75  n self[self.colu
-000305f0: 6d6e 735b 305d 5d0a 2020 2020 2020 2020  mns[0]].        
-00030600: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00030610: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00030620: 2073 656c 660a 0a20 2020 2020 2020 2065   self..        e
-00030630: 6c69 6620 6178 6973 203d 3d20 303a 0a20  lif axis == 0:. 
-00030640: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00030650: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
-00030660: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00030670: 2020 2020 2020 6622 7b74 7970 6528 7365        f"{type(se
-00030680: 6c66 297d 2064 6f65 7320 6e6f 7420 7375  lf)} does not su
-00030690: 7070 6f72 7420 7371 7565 657a 6520 616c  pport squeeze al
-000306a0: 6f6e 6720 6178 6973 2030 220a 2020 2020  ong axis 0".    
-000306b0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-000306c0: 2020 2065 6c69 6620 6178 6973 206e 6f74     elif axis not
-000306d0: 2069 6e20 5b30 2c20 312c 204e 6f6e 655d   in [0, 1, None]
-000306e0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-000306f0: 6973 6520 5661 6c75 6545 7272 6f72 2866  ise ValueError(f
-00030700: 224e 6f20 6178 6973 207b 6178 6973 7d20  "No axis {axis} 
-00030710: 666f 7220 6f62 6a65 6374 2074 7970 6520  for object type 
-00030720: 7b74 7970 6528 7365 6c66 297d 2229 0a0a  {type(self)}")..
-00030730: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
-00030740: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
-00030750: 2020 2020 6465 6620 746f 5f74 696d 6573      def to_times
-00030760: 7461 6d70 2873 656c 662c 2066 7265 713d  tamp(self, freq=
-00030770: 4e6f 6e65 2c20 686f 773d 2273 7461 7274  None, how="start
-00030780: 222c 2061 7869 733d 3029 3a0a 2020 2020  ", axis=0):.    
-00030790: 2020 2020 6466 203d 2065 6c65 6d77 6973      df = elemwis
-000307a0: 6528 4d2e 746f 5f74 696d 6573 7461 6d70  e(M.to_timestamp
-000307b0: 2c20 7365 6c66 2c20 6672 6571 2c20 686f  , self, freq, ho
-000307c0: 772c 2061 7869 7329 0a20 2020 2020 2020  w, axis).       
-000307d0: 2064 662e 6469 7669 7369 6f6e 7320 3d20   df.divisions = 
-000307e0: 7475 706c 6528 7064 2e49 6e64 6578 2873  tuple(pd.Index(s
-000307f0: 656c 662e 6469 7669 7369 6f6e 7329 2e74  elf.divisions).t
-00030800: 6f5f 7469 6d65 7374 616d 7028 686f 773d  o_timestamp(how=
-00030810: 686f 772c 2066 7265 713d 6672 6571 2929  how, freq=freq))
-00030820: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00030830: 6466 0a0a 2020 2020 4064 6572 6976 6564  df..    @derived
-00030840: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
-00030850: 6d65 290a 2020 2020 6465 6620 6578 706c  me).    def expl
-00030860: 6f64 6528 7365 6c66 2c20 636f 6c75 6d6e  ode(self, column
-00030870: 293a 0a20 2020 2020 2020 206d 6574 6120  ):.        meta 
-00030880: 3d20 7365 6c66 2e5f 6d65 7461 2e65 7870  = self._meta.exp
-00030890: 6c6f 6465 2863 6f6c 756d 6e29 0a20 2020  lode(column).   
-000308a0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000308b0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-000308c0: 4d2e 6578 706c 6f64 652c 2063 6f6c 756d  M.explode, colum
-000308d0: 6e2c 206d 6574 613d 6d65 7461 2c20 656e  n, meta=meta, en
-000308e0: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
-000308f0: 616c 7365 290a 0a20 2020 2064 6566 2074  alse)..    def t
-00030900: 6f5f 6261 6728 7365 6c66 2c20 696e 6465  o_bag(self, inde
-00030910: 783d 4661 6c73 652c 2066 6f72 6d61 743d  x=False, format=
-00030920: 2274 7570 6c65 2229 3a0a 2020 2020 2020  "tuple"):.      
-00030930: 2020 2222 2243 6f6e 7665 7274 2074 6f20    """Convert to 
-00030940: 6120 6461 736b 2042 6167 206f 6620 7475  a dask Bag of tu
-00030950: 706c 6573 206f 6620 6561 6368 2072 6f77  ples of each row
-00030960: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00030970: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-00030980: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00030990: 2069 6e64 6578 203a 2062 6f6f 6c2c 206f   index : bool, o
-000309a0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-000309b0: 2020 2020 4966 2054 7275 652c 2074 6865      If True, the
-000309c0: 2069 6e64 6578 2069 7320 696e 636c 7564   index is includ
-000309d0: 6564 2061 7320 7468 6520 6669 7273 7420  ed as the first 
-000309e0: 656c 656d 656e 7420 6f66 2065 6163 6820  element of each 
-000309f0: 7475 706c 652e 0a20 2020 2020 2020 2020  tuple..         
-00030a00: 2020 2044 6566 6175 6c74 2069 7320 4661     Default is Fa
-00030a10: 6c73 652e 0a20 2020 2020 2020 2066 6f72  lse..        for
-00030a20: 6d61 7420 3a20 7b22 7475 706c 6522 2c20  mat : {"tuple", 
-00030a30: 2264 6963 7422 2c20 2266 7261 6d65 227d  "dict", "frame"}
-00030a40: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00030a50: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
-00030a60: 6f20 7265 7475 726e 2061 2062 6167 206f  o return a bag o
-00030a70: 6620 7475 706c 6573 2c20 6469 6374 696f  f tuples, dictio
-00030a80: 6e61 7269 6573 2c20 6f72 0a20 2020 2020  naries, or.     
-00030a90: 2020 2020 2020 2064 6174 6166 7261 6d65         dataframe
-00030aa0: 2d6c 696b 6520 6f62 6a65 6374 732e 2044  -like objects. D
-00030ab0: 6566 6175 6c74 2069 7320 2274 7570 6c65  efault is "tuple
-00030ac0: 222e 2049 6620 2266 7261 6d65 222c 0a20  ". If "frame",. 
-00030ad0: 2020 2020 2020 2020 2020 2074 6865 206f             the o
-00030ae0: 7269 6769 6e61 6c20 7061 7274 6974 696f  riginal partitio
-00030af0: 6e73 206f 6620 6060 6466 6060 2077 696c  ns of ``df`` wil
-00030b00: 6c20 6e6f 7420 6265 2074 7261 6e73 666f  l not be transfo
-00030b10: 726d 6564 0a20 2020 2020 2020 2020 2020  rmed.           
-00030b20: 2069 6e20 616e 7920 7761 792e 0a20 2020   in any way..   
-00030b30: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00030b40: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
-00030b50: 7261 6d65 2e69 6f20 696d 706f 7274 2074  rame.io import t
-00030b60: 6f5f 6261 670a 0a20 2020 2020 2020 2072  o_bag..        r
-00030b70: 6574 7572 6e20 746f 5f62 6167 2873 656c  eturn to_bag(sel
-00030b80: 662c 2069 6e64 6578 2c20 666f 726d 6174  f, index, format
-00030b90: 290a 0a20 2020 2064 6566 2074 6f5f 7061  )..    def to_pa
-00030ba0: 7271 7565 7428 7365 6c66 2c20 7061 7468  rquet(self, path
-00030bb0: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-00030bc0: 7329 3a0a 2020 2020 2020 2020 2222 2253  s):.        """S
-00030bd0: 6565 2064 642e 746f 5f70 6172 7175 6574  ee dd.to_parquet
-00030be0: 2064 6f63 7374 7269 6e67 2066 6f72 206d   docstring for m
-00030bf0: 6f72 6520 696e 666f 726d 6174 696f 6e22  ore information"
-00030c00: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
-00030c10: 6461 736b 2e64 6174 6166 7261 6d65 2e69  dask.dataframe.i
-00030c20: 6f20 696d 706f 7274 2074 6f5f 7061 7271  o import to_parq
-00030c30: 7565 740a 0a20 2020 2020 2020 2072 6574  uet..        ret
-00030c40: 7572 6e20 746f 5f70 6172 7175 6574 2873  urn to_parquet(s
-00030c50: 656c 662c 2070 6174 682c 202a 6172 6773  elf, path, *args
-00030c60: 2c20 2a2a 6b77 6172 6773 290a 0a20 2020  , **kwargs)..   
-00030c70: 2064 6566 2074 6f5f 6f72 6328 7365 6c66   def to_orc(self
-00030c80: 2c20 7061 7468 2c20 2a61 7267 732c 202a  , path, *args, *
-00030c90: 2a6b 7761 7267 7329 3a0a 2020 2020 2020  *kwargs):.      
-00030ca0: 2020 2222 2253 6565 2064 642e 746f 5f6f    """See dd.to_o
-00030cb0: 7263 2064 6f63 7374 7269 6e67 2066 6f72  rc docstring for
-00030cc0: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
-00030cd0: 6e22 2222 0a20 2020 2020 2020 2066 726f  n""".        fro
-00030ce0: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
-00030cf0: 2e69 6f20 696d 706f 7274 2074 6f5f 6f72  .io import to_or
-00030d00: 630a 0a20 2020 2020 2020 2072 6574 7572  c..        retur
-00030d10: 6e20 746f 5f6f 7263 2873 656c 662c 2070  n to_orc(self, p
-00030d20: 6174 682c 202a 6172 6773 2c20 2a2a 6b77  ath, *args, **kw
-00030d30: 6172 6773 290a 0a20 2020 2040 6465 7269  args)..    @deri
-00030d40: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-00030d50: 4672 616d 6529 0a20 2020 2064 6566 2074  Frame).    def t
-00030d60: 6f5f 7374 7269 6e67 2873 656c 662c 206d  o_string(self, m
-00030d70: 6178 5f72 6f77 733d 3529 3a0a 2020 2020  ax_rows=5):.    
-00030d80: 2020 2020 2320 6f70 7469 6f6e 5f63 6f6e      # option_con
-00030d90: 7465 7874 2064 6f65 736e 2774 2061 6666  text doesn't aff
-00030da0: 6563 740a 2020 2020 2020 2020 7265 7475  ect.        retu
-00030db0: 726e 2073 656c 662e 5f72 6570 725f 6461  rn self._repr_da
-00030dc0: 7461 2829 2e74 6f5f 7374 7269 6e67 286d  ta().to_string(m
-00030dd0: 6178 5f72 6f77 733d 6d61 785f 726f 7773  ax_rows=max_rows
-00030de0: 2c20 7368 6f77 5f64 696d 656e 7369 6f6e  , show_dimension
-00030df0: 733d 4661 6c73 6529 0a0a 2020 2020 6465  s=False)..    de
-00030e00: 6620 5f67 6574 5f6e 756d 6572 6963 5f64  f _get_numeric_d
-00030e10: 6174 6128 7365 6c66 2c20 686f 773d 2261  ata(self, how="a
-00030e20: 6e79 222c 2073 7562 7365 743d 4e6f 6e65  ny", subset=None
-00030e30: 293a 0a20 2020 2020 2020 2023 2063 616c  ):.        # cal
-00030e40: 6375 6c61 7465 2063 6f6c 756d 6e73 2074  culate columns t
-00030e50: 6f20 6176 6f69 6420 756e 6e65 6365 7373  o avoid unnecess
-00030e60: 6172 7920 6361 6c63 756c 6174 696f 6e0a  ary calculation.
-00030e70: 2020 2020 2020 2020 6e75 6d65 7269 6373          numerics
-00030e80: 203d 2073 656c 662e 5f6d 6574 612e 5f67   = self._meta._g
-00030e90: 6574 5f6e 756d 6572 6963 5f64 6174 6128  et_numeric_data(
-00030ea0: 290a 0a20 2020 2020 2020 2069 6620 6c65  )..        if le
-00030eb0: 6e28 6e75 6d65 7269 6373 2e63 6f6c 756d  n(numerics.colum
-00030ec0: 6e73 2920 3c20 6c65 6e28 7365 6c66 2e63  ns) < len(self.c
-00030ed0: 6f6c 756d 6e73 293a 0a20 2020 2020 2020  olumns):.       
-00030ee0: 2020 2020 206e 616d 6520 3d20 7365 6c66       name = self
-00030ef0: 2e5f 746f 6b65 6e5f 7072 6566 6978 202b  ._token_prefix +
-00030f00: 2022 2d67 6574 5f6e 756d 6572 6963 5f64   "-get_numeric_d
-00030f10: 6174 6122 0a20 2020 2020 2020 2020 2020  ata".           
-00030f20: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
-00030f30: 5f70 6172 7469 7469 6f6e 7328 4d2e 5f67  _partitions(M._g
-00030f40: 6574 5f6e 756d 6572 6963 5f64 6174 612c  et_numeric_data,
-00030f50: 206d 6574 613d 6e75 6d65 7269 6373 2c20   meta=numerics, 
-00030f60: 746f 6b65 6e3d 6e61 6d65 290a 2020 2020  token=name).    
-00030f70: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00030f80: 2020 2020 2020 2320 7573 6520 6d79 7365        # use myse
-00030f90: 6c66 2069 6620 616c 6c20 6e75 6d65 7269  lf if all numeri
-00030fa0: 6373 0a20 2020 2020 2020 2020 2020 2072  cs.            r
-00030fb0: 6574 7572 6e20 7365 6c66 0a0a 2020 2020  eturn self..    
-00030fc0: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
-00030fd0: 2064 6566 205f 7661 6c69 6461 7465 5f61   def _validate_a
-00030fe0: 7869 7328 636c 732c 2061 7869 733d 302c  xis(cls, axis=0,
-00030ff0: 206e 6f6e 655f 6973 5f7a 6572 6f3a 2062   none_is_zero: b
-00031000: 6f6f 6c20 3d20 5472 7565 2920 2d3e 204e  ool = True) -> N
-00031010: 6f6e 6520 7c20 4c69 7465 7261 6c5b 302c  one | Literal[0,
-00031020: 2031 5d3a 0a20 2020 2020 2020 2069 6620   1]:.        if 
-00031030: 6178 6973 206e 6f74 2069 6e20 2830 2c20  axis not in (0, 
-00031040: 312c 2022 696e 6465 7822 2c20 2263 6f6c  1, "index", "col
-00031050: 756d 6e73 222c 204e 6f6e 6529 3a0a 2020  umns", None):.  
-00031060: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00031070: 5661 6c75 6545 7272 6f72 2866 224e 6f20  ValueError(f"No 
-00031080: 6178 6973 206e 616d 6564 207b 6178 6973  axis named {axis
-00031090: 7d22 290a 2020 2020 2020 2020 2320 636f  }").        # co
-000310a0: 6e76 6572 7420 746f 206e 756d 6572 6963  nvert to numeric
-000310b0: 2061 7869 730a 2020 2020 2020 2020 6e75   axis.        nu
-000310c0: 6d65 7269 635f 6178 6973 3a20 6469 6374  meric_axis: dict
-000310d0: 5b73 7472 207c 204e 6f6e 652c 204c 6974  [str | None, Lit
-000310e0: 6572 616c 5b30 2c20 315d 5d20 3d20 7b22  eral[0, 1]] = {"
-000310f0: 696e 6465 7822 3a20 302c 2022 636f 6c75  index": 0, "colu
-00031100: 6d6e 7322 3a20 317d 0a20 2020 2020 2020  mns": 1}.       
-00031110: 2069 6620 6e6f 6e65 5f69 735f 7a65 726f   if none_is_zero
-00031120: 3a0a 2020 2020 2020 2020 2020 2020 6e75  :.            nu
-00031130: 6d65 7269 635f 6178 6973 5b4e 6f6e 655d  meric_axis[None]
-00031140: 203d 2030 0a0a 2020 2020 2020 2020 7265   = 0..        re
-00031150: 7475 726e 206e 756d 6572 6963 5f61 7869  turn numeric_axi
-00031160: 732e 6765 7428 6178 6973 2c20 6178 6973  s.get(axis, axis
-00031170: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00031180: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-00031190: 6529 0a20 2020 2064 6566 2064 726f 7028  e).    def drop(
-000311a0: 7365 6c66 2c20 6c61 6265 6c73 3d4e 6f6e  self, labels=Non
-000311b0: 652c 2061 7869 733d 302c 2063 6f6c 756d  e, axis=0, colum
-000311c0: 6e73 3d4e 6f6e 652c 2065 7272 6f72 733d  ns=None, errors=
-000311d0: 2272 6169 7365 2229 3a0a 2020 2020 2020  "raise"):.      
-000311e0: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
-000311f0: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
-00031200: 7329 0a20 2020 2020 2020 2069 6620 6178  s).        if ax
-00031210: 6973 203d 3d20 3020 616e 6420 636f 6c75  is == 0 and colu
-00031220: 6d6e 7320 6973 206e 6f74 204e 6f6e 653a  mns is not None:
-00031230: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
-00031240: 6f6c 756d 6e73 206d 7573 7420 6265 2073  olumns must be s
-00031250: 7065 6369 6669 6564 2069 6620 6178 6973  pecified if axis
-00031260: 3d3d 300a 2020 2020 2020 2020 2020 2020  ==0.            
-00031270: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
-00031280: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
-00031290: 2020 2020 2020 2020 2020 2020 6472 6f70              drop
-000312a0: 5f62 795f 7368 616c 6c6f 775f 636f 7079  _by_shallow_copy
-000312b0: 2c20 636f 6c75 6d6e 732c 2065 7272 6f72  , columns, error
-000312c0: 733d 6572 726f 7273 2c20 656e 666f 7263  s=errors, enforc
-000312d0: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
-000312e0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-000312f0: 2020 2020 2020 2065 6c69 6620 6178 6973         elif axis
-00031300: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
-00031310: 2020 2072 6574 7572 6e20 7365 6c66 2e6d     return self.m
-00031320: 6170 5f70 6172 7469 7469 6f6e 7328 0a20  ap_partitions(. 
-00031330: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00031340: 726f 705f 6279 5f73 6861 6c6c 6f77 5f63  rop_by_shallow_c
-00031350: 6f70 792c 206c 6162 656c 732c 2065 7272  opy, labels, err
-00031360: 6f72 733d 6572 726f 7273 2c20 656e 666f  ors=errors, enfo
-00031370: 7263 655f 6d65 7461 6461 7461 3d46 616c  rce_metadata=Fal
-00031380: 7365 0a20 2020 2020 2020 2020 2020 2029  se.            )
-00031390: 0a20 2020 2020 2020 2072 6169 7365 204e  .        raise N
-000313a0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-000313b0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-000313c0: 2244 726f 7020 6375 7272 656e 746c 7920  "Drop currently 
-000313d0: 6f6e 6c79 2077 6f72 6b73 2066 6f72 2061  only works for a
-000313e0: 7869 733d 3120 6f72 2077 6865 6e20 636f  xis=1 or when co
-000313f0: 6c75 6d6e 7320 6973 206e 6f74 204e 6f6e  lumns is not Non
-00031400: 6522 0a20 2020 2020 2020 2029 0a0a 2020  e".        )..  
-00031410: 2020 6465 6620 6d65 7267 6528 0a20 2020    def merge(.   
-00031420: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00031430: 2020 2072 6967 6874 2c0a 2020 2020 2020     right,.      
-00031440: 2020 686f 773d 2269 6e6e 6572 222c 0a20    how="inner",. 
-00031450: 2020 2020 2020 206f 6e3d 4e6f 6e65 2c0a         on=None,.
-00031460: 2020 2020 2020 2020 6c65 6674 5f6f 6e3d          left_on=
-00031470: 4e6f 6e65 2c0a 2020 2020 2020 2020 7269  None,.        ri
-00031480: 6768 745f 6f6e 3d4e 6f6e 652c 0a20 2020  ght_on=None,.   
-00031490: 2020 2020 206c 6566 745f 696e 6465 783d       left_index=
-000314a0: 4661 6c73 652c 0a20 2020 2020 2020 2072  False,.        r
-000314b0: 6967 6874 5f69 6e64 6578 3d46 616c 7365  ight_index=False
-000314c0: 2c0a 2020 2020 2020 2020 7375 6666 6978  ,.        suffix
-000314d0: 6573 3d28 225f 7822 2c20 225f 7922 292c  es=("_x", "_y"),
-000314e0: 0a20 2020 2020 2020 2069 6e64 6963 6174  .        indicat
-000314f0: 6f72 3d46 616c 7365 2c0a 2020 2020 2020  or=False,.      
-00031500: 2020 6e70 6172 7469 7469 6f6e 733d 4e6f    npartitions=No
-00031510: 6e65 2c0a 2020 2020 2020 2020 7368 7566  ne,.        shuf
-00031520: 666c 653d 4e6f 6e65 2c0a 2020 2020 2020  fle=None,.      
-00031530: 2020 6272 6f61 6463 6173 743d 4e6f 6e65    broadcast=None
-00031540: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00031550: 2022 2222 4d65 7267 6520 7468 6520 4461   """Merge the Da
-00031560: 7461 4672 616d 6520 7769 7468 2061 6e6f  taFrame with ano
-00031570: 7468 6572 2044 6174 6146 7261 6d65 0a0a  ther DataFrame..
-00031580: 2020 2020 2020 2020 5468 6973 2077 696c          This wil
-00031590: 6c20 6d65 7267 6520 7468 6520 7477 6f20  l merge the two 
-000315a0: 6461 7461 7365 7473 2c20 6569 7468 6572  datasets, either
-000315b0: 206f 6e20 7468 6520 696e 6469 6365 732c   on the indices,
-000315c0: 2061 2063 6572 7461 696e 2063 6f6c 756d   a certain colum
-000315d0: 6e0a 2020 2020 2020 2020 696e 2065 6163  n.        in eac
-000315e0: 6820 6461 7461 7365 7420 6f72 2074 6865  h dataset or the
-000315f0: 2069 6e64 6578 2069 6e20 6f6e 6520 6461   index in one da
-00031600: 7461 7365 7420 616e 6420 7468 6520 636f  taset and the co
-00031610: 6c75 6d6e 2069 6e20 616e 6f74 6865 722e  lumn in another.
-00031620: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00031630: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-00031640: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00031650: 7269 6768 743a 2064 6173 6b2e 6461 7461  right: dask.data
-00031660: 6672 616d 652e 4461 7461 4672 616d 650a  frame.DataFrame.
-00031670: 2020 2020 2020 2020 686f 7720 3a20 7b27          how : {'
-00031680: 6c65 6674 272c 2027 7269 6768 7427 2c20  left', 'right', 
-00031690: 276f 7574 6572 272c 2027 696e 6e65 7227  'outer', 'inner'
-000316a0: 7d2c 2064 6566 6175 6c74 3a20 2769 6e6e  }, default: 'inn
-000316b0: 6572 270a 2020 2020 2020 2020 2020 2020  er'.            
-000316c0: 486f 7720 746f 2068 616e 646c 6520 7468  How to handle th
-000316d0: 6520 6f70 6572 6174 696f 6e20 6f66 2074  e operation of t
-000316e0: 6865 2074 776f 206f 626a 6563 7473 3a0a  he two objects:.
-000316f0: 0a20 2020 2020 2020 2020 2020 202d 206c  .            - l
-00031700: 6566 743a 2075 7365 2063 616c 6c69 6e67  eft: use calling
-00031710: 2066 7261 6d65 2773 2069 6e64 6578 2028   frame's index (
-00031720: 6f72 2063 6f6c 756d 6e20 6966 206f 6e20  or column if on 
-00031730: 6973 2073 7065 6369 6669 6564 290a 2020  is specified).  
-00031740: 2020 2020 2020 2020 2020 2d20 7269 6768            - righ
-00031750: 743a 2075 7365 206f 7468 6572 2066 7261  t: use other fra
-00031760: 6d65 2773 2069 6e64 6578 0a20 2020 2020  me's index.     
-00031770: 2020 2020 2020 202d 206f 7574 6572 3a20         - outer: 
-00031780: 666f 726d 2075 6e69 6f6e 206f 6620 6361  form union of ca
-00031790: 6c6c 696e 6720 6672 616d 6527 7320 696e  lling frame's in
-000317a0: 6465 7820 286f 7220 636f 6c75 6d6e 2069  dex (or column i
-000317b0: 6620 6f6e 2069 730a 2020 2020 2020 2020  f on is.        
-000317c0: 2020 2020 2020 7370 6563 6966 6965 6429        specified)
-000317d0: 2077 6974 6820 6f74 6865 7220 6672 616d   with other fram
-000317e0: 6527 7320 696e 6465 782c 2061 6e64 2073  e's index, and s
-000317f0: 6f72 7420 6974 0a20 2020 2020 2020 2020  ort it.         
-00031800: 2020 2020 206c 6578 6963 6f67 7261 7068       lexicograph
-00031810: 6963 616c 6c79 0a20 2020 2020 2020 2020  ically.         
-00031820: 2020 202d 2069 6e6e 6572 3a20 666f 726d     - inner: form
-00031830: 2069 6e74 6572 7365 6374 696f 6e20 6f66   intersection of
-00031840: 2063 616c 6c69 6e67 2066 7261 6d65 2773   calling frame's
-00031850: 2069 6e64 6578 2028 6f72 2063 6f6c 756d   index (or colum
-00031860: 6e20 6966 0a20 2020 2020 2020 2020 2020  n if.           
-00031870: 2020 206f 6e20 6973 2073 7065 6369 6669     on is specifi
-00031880: 6564 2920 7769 7468 206f 7468 6572 2066  ed) with other f
-00031890: 7261 6d65 2773 2069 6e64 6578 2c20 7072  rame's index, pr
-000318a0: 6573 6572 7669 6e67 2074 6865 206f 7264  eserving the ord
-000318b0: 6572 0a20 2020 2020 2020 2020 2020 2020  er.             
-000318c0: 206f 6620 7468 6520 6361 6c6c 696e 6727   of the calling'
-000318d0: 7320 6f6e 650a 0a20 2020 2020 2020 206f  s one..        o
-000318e0: 6e20 3a20 6c61 6265 6c20 6f72 206c 6973  n : label or lis
-000318f0: 740a 2020 2020 2020 2020 2020 2020 436f  t.            Co
-00031900: 6c75 6d6e 206f 7220 696e 6465 7820 6c65  lumn or index le
-00031910: 7665 6c20 6e61 6d65 7320 746f 206a 6f69  vel names to joi
-00031920: 6e20 6f6e 2e20 5468 6573 6520 6d75 7374  n on. These must
-00031930: 2062 6520 666f 756e 6420 696e 2062 6f74   be found in bot
-00031940: 680a 2020 2020 2020 2020 2020 2020 4461  h.            Da
-00031950: 7461 4672 616d 6573 2e20 4966 206f 6e20  taFrames. If on 
-00031960: 6973 204e 6f6e 6520 616e 6420 6e6f 7420  is None and not 
-00031970: 6d65 7267 696e 6720 6f6e 2069 6e64 6578  merging on index
-00031980: 6573 2074 6865 6e20 7468 6973 0a20 2020  es then this.   
-00031990: 2020 2020 2020 2020 2064 6566 6175 6c74           default
-000319a0: 7320 746f 2074 6865 2069 6e74 6572 7365  s to the interse
-000319b0: 6374 696f 6e20 6f66 2074 6865 2063 6f6c  ction of the col
-000319c0: 756d 6e73 2069 6e20 626f 7468 2044 6174  umns in both Dat
-000319d0: 6146 7261 6d65 732e 0a20 2020 2020 2020  aFrames..       
-000319e0: 206c 6566 745f 6f6e 203a 206c 6162 656c   left_on : label
-000319f0: 206f 7220 6c69 7374 2c20 6f72 2061 7272   or list, or arr
-00031a00: 6179 2d6c 696b 650a 2020 2020 2020 2020  ay-like.        
-00031a10: 2020 2020 436f 6c75 6d6e 2074 6f20 6a6f      Column to jo
-00031a20: 696e 206f 6e20 696e 2074 6865 206c 6566  in on in the lef
-00031a30: 7420 4461 7461 4672 616d 652e 204f 7468  t DataFrame. Oth
-00031a40: 6572 2074 6861 6e20 696e 2070 616e 6461  er than in panda
-00031a50: 730a 2020 2020 2020 2020 2020 2020 6172  s.            ar
-00031a60: 7261 7973 2061 6e64 206c 6973 7473 2061  rays and lists a
-00031a70: 7265 206f 6e6c 7920 7375 7070 6f72 7420  re only support 
-00031a80: 6966 2074 6865 6972 206c 656e 6774 6820  if their length 
-00031a90: 6973 2031 2e0a 2020 2020 2020 2020 7269  is 1..        ri
-00031aa0: 6768 745f 6f6e 203a 206c 6162 656c 206f  ght_on : label o
-00031ab0: 7220 6c69 7374 2c20 6f72 2061 7272 6179  r list, or array
-00031ac0: 2d6c 696b 650a 2020 2020 2020 2020 2020  -like.          
-00031ad0: 2020 436f 6c75 6d6e 2074 6f20 6a6f 696e    Column to join
-00031ae0: 206f 6e20 696e 2074 6865 2072 6967 6874   on in the right
-00031af0: 2044 6174 6146 7261 6d65 2e20 4f74 6865   DataFrame. Othe
-00031b00: 7220 7468 616e 2069 6e20 7061 6e64 6173  r than in pandas
-00031b10: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
-00031b20: 6179 7320 616e 6420 6c69 7374 7320 6172  ays and lists ar
-00031b30: 6520 6f6e 6c79 2073 7570 706f 7274 2069  e only support i
-00031b40: 6620 7468 6569 7220 6c65 6e67 7468 2069  f their length i
-00031b50: 7320 312e 0a20 2020 2020 2020 206c 6566  s 1..        lef
-00031b60: 745f 696e 6465 7820 3a20 626f 6f6c 6561  t_index : boolea
-00031b70: 6e2c 2064 6566 6175 6c74 2046 616c 7365  n, default False
-00031b80: 0a20 2020 2020 2020 2020 2020 2055 7365  .            Use
-00031b90: 2074 6865 2069 6e64 6578 2066 726f 6d20   the index from 
-00031ba0: 7468 6520 6c65 6674 2044 6174 6146 7261  the left DataFra
-00031bb0: 6d65 2061 7320 7468 6520 6a6f 696e 206b  me as the join k
-00031bc0: 6579 2e0a 2020 2020 2020 2020 7269 6768  ey..        righ
-00031bd0: 745f 696e 6465 7820 3a20 626f 6f6c 6561  t_index : boolea
-00031be0: 6e2c 2064 6566 6175 6c74 2046 616c 7365  n, default False
-00031bf0: 0a20 2020 2020 2020 2020 2020 2055 7365  .            Use
-00031c00: 2074 6865 2069 6e64 6578 2066 726f 6d20   the index from 
-00031c10: 7468 6520 7269 6768 7420 4461 7461 4672  the right DataFr
-00031c20: 616d 6520 6173 2074 6865 206a 6f69 6e20  ame as the join 
-00031c30: 6b65 792e 0a20 2020 2020 2020 2073 7566  key..        suf
-00031c40: 6669 7865 7320 3a20 322d 6c65 6e67 7468  fixes : 2-length
-00031c50: 2073 6571 7565 6e63 6520 2874 7570 6c65   sequence (tuple
-00031c60: 2c20 6c69 7374 2c20 2e2e 2e29 0a20 2020  , list, ...).   
-00031c70: 2020 2020 2020 2020 2053 7566 6669 7820           Suffix 
-00031c80: 746f 2061 7070 6c79 2074 6f20 6f76 6572  to apply to over
-00031c90: 6c61 7070 696e 6720 636f 6c75 6d6e 206e  lapping column n
-00031ca0: 616d 6573 2069 6e20 7468 6520 6c65 6674  ames in the left
-00031cb0: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
-00031cc0: 2072 6967 6874 2073 6964 652c 2072 6573   right side, res
-00031cd0: 7065 6374 6976 656c 790a 2020 2020 2020  pectively.      
-00031ce0: 2020 696e 6469 6361 746f 7220 3a20 626f    indicator : bo
-00031cf0: 6f6c 6561 6e20 6f72 2073 7472 696e 672c  olean or string,
-00031d00: 2064 6566 6175 6c74 2046 616c 7365 0a20   default False. 
-00031d10: 2020 2020 2020 2020 2020 2049 6620 5472             If Tr
-00031d20: 7565 2c20 6164 6473 2061 2063 6f6c 756d  ue, adds a colum
-00031d30: 6e20 746f 206f 7574 7075 7420 4461 7461  n to output Data
-00031d40: 4672 616d 6520 6361 6c6c 6564 2022 5f6d  Frame called "_m
-00031d50: 6572 6765 2220 7769 7468 0a20 2020 2020  erge" with.     
-00031d60: 2020 2020 2020 2069 6e66 6f72 6d61 7469         informati
-00031d70: 6f6e 206f 6e20 7468 6520 736f 7572 6365  on on the source
-00031d80: 206f 6620 6561 6368 2072 6f77 2e20 4966   of each row. If
-00031d90: 2073 7472 696e 672c 2063 6f6c 756d 6e20   string, column 
-00031da0: 7769 7468 0a20 2020 2020 2020 2020 2020  with.           
-00031db0: 2069 6e66 6f72 6d61 7469 6f6e 206f 6e20   information on 
-00031dc0: 736f 7572 6365 206f 6620 6561 6368 2072  source of each r
-00031dd0: 6f77 2077 696c 6c20 6265 2061 6464 6564  ow will be added
-00031de0: 2074 6f20 6f75 7470 7574 2044 6174 6146   to output DataF
-00031df0: 7261 6d65 2c0a 2020 2020 2020 2020 2020  rame,.          
-00031e00: 2020 616e 6420 636f 6c75 6d6e 2077 696c    and column wil
-00031e10: 6c20 6265 206e 616d 6564 2076 616c 7565  l be named value
-00031e20: 206f 6620 7374 7269 6e67 2e20 496e 666f   of string. Info
-00031e30: 726d 6174 696f 6e20 636f 6c75 6d6e 2069  rmation column i
-00031e40: 730a 2020 2020 2020 2020 2020 2020 4361  s.            Ca
-00031e50: 7465 676f 7269 6361 6c2d 7479 7065 2061  tegorical-type a
-00031e60: 6e64 2074 616b 6573 206f 6e20 6120 7661  nd takes on a va
-00031e70: 6c75 6520 6f66 2022 6c65 6674 5f6f 6e6c  lue of "left_onl
-00031e80: 7922 2066 6f72 206f 6273 6572 7661 7469  y" for observati
-00031e90: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
-00031ea0: 7768 6f73 6520 6d65 7267 6520 6b65 7920  whose merge key 
-00031eb0: 6f6e 6c79 2061 7070 6561 7273 2069 6e20  only appears in 
-00031ec0: 606c 6566 7460 2044 6174 6146 7261 6d65  `left` DataFrame
-00031ed0: 2c20 2272 6967 6874 5f6f 6e6c 7922 2066  , "right_only" f
-00031ee0: 6f72 0a20 2020 2020 2020 2020 2020 206f  or.            o
-00031ef0: 6273 6572 7661 7469 6f6e 7320 7768 6f73  bservations whos
-00031f00: 6520 6d65 7267 6520 6b65 7920 6f6e 6c79  e merge key only
-00031f10: 2061 7070 6561 7273 2069 6e20 6072 6967   appears in `rig
-00031f20: 6874 6020 4461 7461 4672 616d 652c 0a20  ht` DataFrame,. 
-00031f30: 2020 2020 2020 2020 2020 2061 6e64 2022             and "
-00031f40: 626f 7468 2220 6966 2074 6865 206f 6273  both" if the obs
-00031f50: 6572 7661 7469 6f6e e280 9973 206d 6572  ervation...s mer
-00031f60: 6765 206b 6579 2069 7320 666f 756e 6420  ge key is found 
-00031f70: 696e 2062 6f74 682e 0a20 2020 2020 2020  in both..       
-00031f80: 206e 7061 7274 6974 696f 6e73 3a20 696e   npartitions: in
-00031f90: 7420 6f72 204e 6f6e 652c 206f 7074 696f  t or None, optio
-00031fa0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00031fb0: 5468 6520 6964 6561 6c20 6e75 6d62 6572  The ideal number
-00031fc0: 206f 6620 6f75 7470 7574 2070 6172 7469   of output parti
-00031fd0: 7469 6f6e 732e 2054 6869 7320 6973 206f  tions. This is o
-00031fe0: 6e6c 7920 7574 696c 6973 6564 2077 6865  nly utilised whe
-00031ff0: 6e0a 2020 2020 2020 2020 2020 2020 7065  n.            pe
-00032000: 7266 6f72 6d69 6e67 2061 2068 6173 685f  rforming a hash_
-00032010: 6a6f 696e 2028 6d65 7267 696e 6720 6f6e  join (merging on
-00032020: 2063 6f6c 756d 6e73 206f 6e6c 7929 2e20   columns only). 
-00032030: 4966 2060 604e 6f6e 6560 6020 7468 656e  If ``None`` then
-00032040: 0a20 2020 2020 2020 2020 2020 2060 606e  .            ``n
-00032050: 7061 7274 6974 696f 6e73 203d 206d 6178  partitions = max
-00032060: 286c 6873 2e6e 7061 7274 6974 696f 6e73  (lhs.npartitions
-00032070: 2c20 7268 732e 6e70 6172 7469 7469 6f6e  , rhs.npartition
-00032080: 7329 6060 2e0a 2020 2020 2020 2020 2020  s)``..          
-00032090: 2020 4465 6661 756c 7420 6973 2060 604e    Default is ``N
-000320a0: 6f6e 6560 602e 0a20 2020 2020 2020 2073  one``..        s
-000320b0: 6875 6666 6c65 3a20 7b27 6469 736b 272c  huffle: {'disk',
-000320c0: 2027 7461 736b 7327 7d2c 206f 7074 696f   'tasks'}, optio
-000320d0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-000320e0: 4569 7468 6572 2060 6027 6469 736b 2760  Either ``'disk'`
-000320f0: 6020 666f 7220 7369 6e67 6c65 2d6e 6f64  ` for single-nod
-00032100: 6520 6f70 6572 6174 696f 6e20 6f72 2060  e operation or `
-00032110: 6027 7461 736b 7327 6060 2066 6f72 0a20  `'tasks'`` for. 
-00032120: 2020 2020 2020 2020 2020 2064 6973 7472             distr
-00032130: 6962 7574 6564 206f 7065 7261 7469 6f6e  ibuted operation
-00032140: 2e20 2057 696c 6c20 6265 2069 6e66 6572  .  Will be infer
-00032150: 7265 6420 6279 2079 6f75 7220 6375 7272  red by your curr
-00032160: 656e 7420 7363 6865 6475 6c65 722e 0a20  ent scheduler.. 
-00032170: 2020 2020 2020 2062 726f 6164 6361 7374         broadcast
-00032180: 3a20 626f 6f6c 6561 6e20 6f72 2066 6c6f  : boolean or flo
-00032190: 6174 2c20 6f70 7469 6f6e 616c 0a20 2020  at, optional.   
-000321a0: 2020 2020 2020 2020 2057 6865 7468 6572           Whether
-000321b0: 2074 6f20 7573 6520 6120 6272 6f61 6463   to use a broadc
-000321c0: 6173 742d 6261 7365 6420 6a6f 696e 2069  ast-based join i
-000321d0: 6e20 6c69 6575 206f 6620 6120 7368 7566  n lieu of a shuf
-000321e0: 666c 652d 6261 7365 640a 2020 2020 2020  fle-based.      
-000321f0: 2020 2020 2020 6a6f 696e 2066 6f72 2073        join for s
-00032200: 7570 706f 7274 6564 2063 6173 6573 2e20  upported cases. 
-00032210: 2042 7920 6465 6661 756c 742c 2061 2073   By default, a s
-00032220: 696d 706c 6520 6865 7572 6973 7469 6320  imple heuristic 
-00032230: 7769 6c6c 2062 650a 2020 2020 2020 2020  will be.        
-00032240: 2020 2020 7573 6564 2074 6f20 7365 6c65      used to sele
-00032250: 6374 2074 6865 2075 6e64 6572 6c79 696e  ct the underlyin
-00032260: 6720 616c 676f 7269 7468 6d2e 2049 6620  g algorithm. If 
-00032270: 6120 666c 6f61 7469 6e67 2d70 6f69 6e74  a floating-point
-00032280: 2076 616c 7565 0a20 2020 2020 2020 2020   value.         
-00032290: 2020 2069 7320 7370 6563 6966 6965 642c     is specified,
-000322a0: 2074 6861 7420 6e75 6d62 6572 2077 696c   that number wil
-000322b0: 6c20 6265 2075 7365 6420 6173 2074 6865  l be used as the
-000322c0: 2060 6062 726f 6164 6361 7374 5f62 6961   ``broadcast_bia
-000322d0: 7360 600a 2020 2020 2020 2020 2020 2020  s``.            
-000322e0: 7769 7468 696e 2074 6865 2073 696d 706c  within the simpl
-000322f0: 6520 6865 7572 6973 7469 6320 2861 206c  e heuristic (a l
-00032300: 6172 6765 206e 756d 6265 7220 6d61 6b65  arge number make
-00032310: 7320 4461 736b 206d 6f72 6520 6c69 6b65  s Dask more like
-00032320: 6c79 0a20 2020 2020 2020 2020 2020 2074  ly.            t
-00032330: 6f20 6368 6f6f 7365 2074 6865 2060 6062  o choose the ``b
-00032340: 726f 6163 6173 745f 6a6f 696e 6060 2063  roacast_join`` c
-00032350: 6f64 6520 7061 7468 292e 2053 6565 2060  ode path). See `
-00032360: 6062 726f 6164 6361 7374 5f6a 6f69 6e60  `broadcast_join`
-00032370: 600a 2020 2020 2020 2020 2020 2020 666f  `.            fo
-00032380: 7220 6d6f 7265 2069 6e66 6f72 6d61 7469  r more informati
-00032390: 6f6e 2e0a 0a20 2020 2020 2020 204e 6f74  on...        Not
-000323a0: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-000323b0: 0a0a 2020 2020 2020 2020 5468 6572 6520  ..        There 
-000323c0: 6172 6520 7468 7265 6520 7761 7973 2074  are three ways t
-000323d0: 6f20 6a6f 696e 2064 6174 6166 7261 6d65  o join dataframe
-000323e0: 733a 0a0a 2020 2020 2020 2020 312e 204a  s:..        1. J
-000323f0: 6f69 6e69 6e67 206f 6e20 696e 6469 6365  oining on indice
-00032400: 732e 2049 6e20 7468 6973 2063 6173 6520  s. In this case 
-00032410: 7468 6520 6469 7669 7369 6f6e 7320 6172  the divisions ar
-00032420: 650a 2020 2020 2020 2020 2020 2061 6c69  e.           ali
-00032430: 676e 6564 2075 7369 6e67 2074 6865 2066  gned using the f
-00032440: 756e 6374 696f 6e20 6060 6461 736b 2e64  unction ``dask.d
-00032450: 6174 6166 7261 6d65 2e6d 756c 7469 2e61  ataframe.multi.a
-00032460: 6c69 676e 5f70 6172 7469 7469 6f6e 7360  lign_partitions`
-00032470: 602e 0a20 2020 2020 2020 2020 2020 4166  `..           Af
-00032480: 7465 7277 6172 6473 2c20 6561 6368 2070  terwards, each p
-00032490: 6172 7469 7469 6f6e 2069 7320 6d65 7267  artition is merg
-000324a0: 6564 2077 6974 6820 7468 6520 7061 6e64  ed with the pand
-000324b0: 6173 206d 6572 6765 2066 756e 6374 696f  as merge functio
-000324c0: 6e2e 0a0a 2020 2020 2020 2020 322e 204a  n...        2. J
-000324d0: 6f69 6e69 6e67 206f 6e65 206f 6e20 696e  oining one on in
-000324e0: 6465 7820 616e 6420 6f6e 6520 6f6e 2063  dex and one on c
-000324f0: 6f6c 756d 6e2e 2049 6e20 7468 6973 2063  olumn. In this c
-00032500: 6173 6520 7468 6520 6469 7669 7369 6f6e  ase the division
-00032510: 7320 6f66 0a20 2020 2020 2020 2020 2020  s of.           
-00032520: 6461 7461 6672 616d 6520 6d65 7267 6564  dataframe merged
-00032530: 2062 7920 696e 6465 7820 283a 6d61 7468   by index (:math
-00032540: 3a60 645f 6960 2920 6172 6520 7573 6564  :`d_i`) are used
-00032550: 2074 6f20 6469 7669 6465 2074 6865 2063   to divide the c
-00032560: 6f6c 756d 6e0a 2020 2020 2020 2020 2020  olumn.          
-00032570: 206d 6572 6765 6420 6461 7461 6672 616d   merged datafram
-00032580: 6520 283a 6d61 7468 3a60 645f 6360 2920  e (:math:`d_c`) 
-00032590: 6f6e 6520 7573 696e 670a 2020 2020 2020  one using.      
-000325a0: 2020 2020 2060 6064 6173 6b2e 6461 7461       ``dask.data
-000325b0: 6672 616d 652e 6d75 6c74 692e 7265 6172  frame.multi.rear
-000325c0: 7261 6e67 655f 6279 5f64 6976 6973 696f  range_by_divisio
-000325d0: 6e73 6060 2e20 496e 2074 6869 7320 6361  ns``. In this ca
-000325e0: 7365 2074 6865 0a20 2020 2020 2020 2020  se the.         
-000325f0: 2020 6d65 7267 6564 2064 6174 6166 7261    merged datafra
-00032600: 6d65 2028 3a6d 6174 683a 6064 5f6d 6029  me (:math:`d_m`)
-00032610: 2068 6173 2074 6865 2065 7861 6374 2073   has the exact s
-00032620: 616d 6520 6469 7669 7369 6f6e 730a 2020  ame divisions.  
-00032630: 2020 2020 2020 2020 2061 7320 283a 6d61           as (:ma
-00032640: 7468 3a60 645f 6960 292e 2054 6869 7320  th:`d_i`). This 
-00032650: 6361 6e20 6c65 6164 2074 6f20 6973 7375  can lead to issu
-00032660: 6573 2069 6620 796f 7520 6d65 7267 6520  es if you merge 
-00032670: 6d75 6c74 6970 6c65 2072 6f77 7320 6672  multiple rows fr
-00032680: 6f6d 0a20 2020 2020 2020 2020 2020 283a  om.           (:
-00032690: 6d61 7468 3a60 645f 6360 2920 746f 206f  math:`d_c`) to o
-000326a0: 6e65 2072 6f77 2069 6e20 283a 6d61 7468  ne row in (:math
-000326b0: 3a60 645f 6960 292e 0a0a 2020 2020 2020  :`d_i`)...      
-000326c0: 2020 332e 204a 6f69 6e69 6e67 2062 6f74    3. Joining bot
-000326d0: 6820 6f6e 2063 6f6c 756d 6e73 2e20 496e  h on columns. In
-000326e0: 2074 6869 7320 6361 7365 2061 2068 6173   this case a has
-000326f0: 6820 6a6f 696e 2069 7320 7065 7266 6f72  h join is perfor
-00032700: 6d65 6420 7573 696e 670a 2020 2020 2020  med using.      
-00032710: 2020 2020 2060 6064 6173 6b2e 6461 7461       ``dask.data
-00032720: 6672 616d 652e 6d75 6c74 692e 6861 7368  frame.multi.hash
-00032730: 5f6a 6f69 6e60 602e 0a0a 2020 2020 2020  _join``...      
-00032740: 2020 496e 2073 6f6d 6520 6361 7365 732c    In some cases,
-00032750: 2079 6f75 206d 6179 2073 6565 2061 2060   you may see a `
-00032760: 604d 656d 6f72 7945 7272 6f72 6060 2069  `MemoryError`` i
-00032770: 6620 7468 6520 6060 6d65 7267 6560 6020  f the ``merge`` 
-00032780: 6f70 6572 6174 696f 6e20 7265 7175 6972  operation requir
-00032790: 6573 0a20 2020 2020 2020 2061 6e20 696e  es.        an in
-000327a0: 7465 726e 616c 2060 6073 6875 6666 6c65  ternal ``shuffle
-000327b0: 6060 2c20 6265 6361 7573 6520 7368 7566  ``, because shuf
-000327c0: 666c 696e 6720 706c 6163 6573 2061 6c6c  fling places all
-000327d0: 2072 6f77 7320 7468 6174 2068 6176 6520   rows that have 
-000327e0: 7468 6520 7361 6d65 0a20 2020 2020 2020  the same.       
-000327f0: 2069 6e64 6578 2069 6e20 7468 6520 7361   index in the sa
-00032800: 6d65 2070 6172 7469 7469 6f6e 2e20 546f  me partition. To
-00032810: 2061 766f 6964 2074 6869 7320 6572 726f   avoid this erro
-00032820: 722c 206d 616b 6520 7375 7265 2061 6c6c  r, make sure all
-00032830: 2072 6f77 7320 7769 7468 2074 6865 0a20   rows with the. 
-00032840: 2020 2020 2020 2073 616d 6520 6060 6f6e         same ``on
-00032850: 6060 2d63 6f6c 756d 6e20 7661 6c75 6520  ``-column value 
-00032860: 6361 6e20 6669 7420 6f6e 2061 2073 696e  can fit on a sin
-00032870: 676c 6520 7061 7274 6974 696f 6e2e 0a20  gle partition.. 
-00032880: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00032890: 2020 2020 6966 206e 6f74 2069 735f 6461      if not is_da
-000328a0: 7461 6672 616d 655f 6c69 6b65 2872 6967  taframe_like(rig
-000328b0: 6874 293a 0a20 2020 2020 2020 2020 2020  ht):.           
-000328c0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-000328d0: 7228 2272 6967 6874 206d 7573 7420 6265  r("right must be
-000328e0: 2044 6174 6146 7261 6d65 2229 0a0a 2020   DataFrame")..  
-000328f0: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
-00032900: 6461 7461 6672 616d 652e 6d75 6c74 6920  dataframe.multi 
-00032910: 696d 706f 7274 206d 6572 6765 0a0a 2020  import merge..  
-00032920: 2020 2020 2020 7265 7475 726e 206d 6572        return mer
-00032930: 6765 280a 2020 2020 2020 2020 2020 2020  ge(.            
-00032940: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
-00032950: 2020 7269 6768 742c 0a20 2020 2020 2020    right,.       
-00032960: 2020 2020 2068 6f77 3d68 6f77 2c0a 2020       how=how,.  
-00032970: 2020 2020 2020 2020 2020 6f6e 3d6f 6e2c            on=on,
-00032980: 0a20 2020 2020 2020 2020 2020 206c 6566  .            lef
-00032990: 745f 6f6e 3d6c 6566 745f 6f6e 2c0a 2020  t_on=left_on,.  
-000329a0: 2020 2020 2020 2020 2020 7269 6768 745f            right_
-000329b0: 6f6e 3d72 6967 6874 5f6f 6e2c 0a20 2020  on=right_on,.   
-000329c0: 2020 2020 2020 2020 206c 6566 745f 696e           left_in
-000329d0: 6465 783d 6c65 6674 5f69 6e64 6578 2c0a  dex=left_index,.
-000329e0: 2020 2020 2020 2020 2020 2020 7269 6768              righ
-000329f0: 745f 696e 6465 783d 7269 6768 745f 696e  t_index=right_in
-00032a00: 6465 782c 0a20 2020 2020 2020 2020 2020  dex,.           
-00032a10: 2073 7566 6669 7865 733d 7375 6666 6978   suffixes=suffix
-00032a20: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-00032a30: 6e70 6172 7469 7469 6f6e 733d 6e70 6172  npartitions=npar
-00032a40: 7469 7469 6f6e 732c 0a20 2020 2020 2020  titions,.       
-00032a50: 2020 2020 2069 6e64 6963 6174 6f72 3d69       indicator=i
-00032a60: 6e64 6963 6174 6f72 2c0a 2020 2020 2020  ndicator,.      
-00032a70: 2020 2020 2020 7368 7566 666c 653d 7368        shuffle=sh
-00032a80: 7566 666c 652c 0a20 2020 2020 2020 2020  uffle,.         
-00032a90: 2020 2062 726f 6164 6361 7374 3d62 726f     broadcast=bro
-00032aa0: 6164 6361 7374 2c0a 2020 2020 2020 2020  adcast,.        
-00032ab0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
-00032ac0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
-00032ad0: 6529 0a20 2020 2064 6566 206a 6f69 6e28  e).    def join(
-00032ae0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00032af0: 2020 2020 2020 206f 7468 6572 2c0a 2020         other,.  
-00032b00: 2020 2020 2020 6f6e 3d4e 6f6e 652c 0a20        on=None,. 
-00032b10: 2020 2020 2020 2068 6f77 3d22 6c65 6674         how="left
-00032b20: 222c 0a20 2020 2020 2020 206c 7375 6666  ",.        lsuff
-00032b30: 6978 3d22 222c 0a20 2020 2020 2020 2072  ix="",.        r
-00032b40: 7375 6666 6978 3d22 222c 0a20 2020 2020  suffix="",.     
-00032b50: 2020 206e 7061 7274 6974 696f 6e73 3d4e     npartitions=N
-00032b60: 6f6e 652c 0a20 2020 2020 2020 2073 6875  one,.        shu
-00032b70: 6666 6c65 3d4e 6f6e 652c 0a20 2020 2029  ffle=None,.    )
-00032b80: 3a0a 2020 2020 2020 2020 6966 2069 735f  :.        if is_
-00032b90: 7365 7269 6573 5f6c 696b 6528 6f74 6865  series_like(othe
-00032ba0: 7229 2061 6e64 2068 6173 6174 7472 286f  r) and hasattr(o
-00032bb0: 7468 6572 2c20 226e 616d 6522 293a 0a20  ther, "name"):. 
-00032bc0: 2020 2020 2020 2020 2020 206f 7468 6572             other
-00032bd0: 203d 206f 7468 6572 2e74 6f5f 6672 616d   = other.to_fram
-00032be0: 6528 290a 0a20 2020 2020 2020 2069 6620  e()..        if 
-00032bf0: 6e6f 7420 6973 5f64 6174 6166 7261 6d65  not is_dataframe
-00032c00: 5f6c 696b 6528 6f74 6865 7229 3a0a 2020  _like(other):.  
-00032c10: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00032c20: 2069 7369 6e73 7461 6e63 6528 6f74 6865   isinstance(othe
-00032c30: 722c 206c 6973 7429 206f 7220 6e6f 7420  r, list) or not 
-00032c40: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
-00032c50: 2020 2020 205b 6973 5f64 6174 6166 7261       [is_datafra
-00032c60: 6d65 5f6c 696b 6528 6f29 2066 6f72 206f  me_like(o) for o
-00032c70: 2069 6e20 6f74 6865 725d 0a20 2020 2020   in other].     
-00032c80: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-00032c90: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00032ca0: 5661 6c75 6545 7272 6f72 2822 6f74 6865  ValueError("othe
-00032cb0: 7220 6d75 7374 2062 6520 4461 7461 4672  r must be DataFr
-00032cc0: 616d 6520 6f72 206c 6973 7420 6f66 2044  ame or list of D
-00032cd0: 6174 6146 7261 6d65 7322 290a 2020 2020  ataFrames").    
-00032ce0: 2020 2020 2020 2020 6966 2068 6f77 206e          if how n
-00032cf0: 6f74 2069 6e20 5b22 6f75 7465 7222 2c20  ot in ["outer", 
-00032d00: 226c 6566 7422 5d3a 0a20 2020 2020 2020  "left"]:.       
-00032d10: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00032d20: 616c 7565 4572 726f 7228 226d 6572 6765  alueError("merge
-00032d30: 5f6d 756c 7469 206f 6e6c 7920 7375 7070  _multi only supp
-00032d40: 6f72 7473 206c 6566 7420 6f72 206f 7574  orts left or out
-00032d50: 6572 206a 6f69 6e73 2229 0a0a 2020 2020  er joins")..    
-00032d60: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-00032d70: 6b2e 6461 7461 6672 616d 652e 6d75 6c74  k.dataframe.mult
-00032d80: 6920 696d 706f 7274 205f 7265 6375 7273  i import _recurs
-00032d90: 6976 655f 7061 6972 7769 7365 5f6f 7574  ive_pairwise_out
-00032da0: 6572 5f6a 6f69 6e0a 0a20 2020 2020 2020  er_join..       
-00032db0: 2020 2020 2023 2049 6620 6974 7320 616e       # If its an
-00032dc0: 206f 7574 6572 206a 6f69 6e20 7765 2063   outer join we c
-00032dd0: 616e 2075 7365 2074 6865 2066 756c 6c20  an use the full 
-00032de0: 7265 6375 7273 6976 6520 7061 6972 7769  recursive pairwi
-00032df0: 7365 206a 6f69 6e2e 0a20 2020 2020 2020  se join..       
-00032e00: 2020 2020 2069 6620 686f 7720 3d3d 2022       if how == "
-00032e10: 6f75 7465 7222 3a0a 2020 2020 2020 2020  outer":.        
-00032e20: 2020 2020 2020 2020 6675 6c6c 203d 205b          full = [
-00032e30: 7365 6c66 5d20 2b20 6f74 6865 720a 0a20  self] + other.. 
-00032e40: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00032e50: 6574 7572 6e20 5f72 6563 7572 7369 7665  eturn _recursive
-00032e60: 5f70 6169 7277 6973 655f 6f75 7465 725f  _pairwise_outer_
-00032e70: 6a6f 696e 280a 2020 2020 2020 2020 2020  join(.          
-00032e80: 2020 2020 2020 2020 2020 6675 6c6c 2c0a            full,.
-00032e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032ea0: 2020 2020 6f6e 3d6f 6e2c 0a20 2020 2020      on=on,.     
-00032eb0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00032ec0: 7375 6666 6978 3d6c 7375 6666 6978 2c0a  suffix=lsuffix,.
-00032ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032ee0: 2020 2020 7273 7566 6669 783d 7273 7566      rsuffix=rsuf
-00032ef0: 6669 782c 0a20 2020 2020 2020 2020 2020  fix,.           
-00032f00: 2020 2020 2020 2020 206e 7061 7274 6974           npartit
-00032f10: 696f 6e73 3d6e 7061 7274 6974 696f 6e73  ions=npartitions
-00032f20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00032f30: 2020 2020 2020 7368 7566 666c 653d 7368        shuffle=sh
-00032f40: 7566 666c 652c 0a20 2020 2020 2020 2020  uffle,.         
-00032f50: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00032f60: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00032f70: 2020 2020 2020 2020 2020 2023 2044 6f20             # Do 
-00032f80: 7265 6375 7273 6976 6520 7061 6972 7769  recursive pairwi
-00032f90: 7365 206a 6f69 6e20 6f6e 2065 7665 7279  se join on every
-00032fa0: 7468 696e 6720 5f65 7863 6570 745f 2074  thing _except_ t
-00032fb0: 6865 206c 6173 7420 6a6f 696e 0a20 2020  he last join.   
-00032fc0: 2020 2020 2020 2020 2020 2020 2023 2077               # w
-00032fd0: 6865 7265 2077 6520 6e65 6564 2074 6f20  here we need to 
-00032fe0: 646f 2061 206c 6566 7420 6a6f 696e 2e0a  do a left join..
-00032ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033000: 6f74 6865 7220 3d20 5f72 6563 7572 7369  other = _recursi
-00033010: 7665 5f70 6169 7277 6973 655f 6f75 7465  ve_pairwise_oute
-00033020: 725f 6a6f 696e 280a 2020 2020 2020 2020  r_join(.        
-00033030: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
-00033040: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
-00033050: 2020 2020 2020 206f 6e3d 6f6e 2c0a 2020         on=on,.  
-00033060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033070: 2020 6c73 7566 6669 783d 6c73 7566 6669    lsuffix=lsuffi
-00033080: 782c 0a20 2020 2020 2020 2020 2020 2020  x,.             
-00033090: 2020 2020 2020 2072 7375 6666 6978 3d72         rsuffix=r
-000330a0: 7375 6666 6978 2c0a 2020 2020 2020 2020  suffix,.        
-000330b0: 2020 2020 2020 2020 2020 2020 6e70 6172              npar
-000330c0: 7469 7469 6f6e 733d 6e70 6172 7469 7469  titions=npartiti
-000330d0: 6f6e 732c 0a20 2020 2020 2020 2020 2020  ons,.           
-000330e0: 2020 2020 2020 2020 2073 6875 6666 6c65           shuffle
-000330f0: 3d73 6875 6666 6c65 2c0a 2020 2020 2020  =shuffle,.      
-00033100: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00033110: 2020 2020 2066 726f 6d20 6461 736b 2e64       from dask.d
-00033120: 6174 6166 7261 6d65 2e6d 756c 7469 2069  ataframe.multi i
-00033130: 6d70 6f72 7420 6d65 7267 650a 0a20 2020  mport merge..   
-00033140: 2020 2020 2072 6574 7572 6e20 6d65 7267       return merg
-00033150: 6528 0a20 2020 2020 2020 2020 2020 2073  e(.            s
-00033160: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-00033170: 206f 7468 6572 2c0a 2020 2020 2020 2020   other,.        
-00033180: 2020 2020 686f 773d 686f 772c 0a20 2020      how=how,.   
-00033190: 2020 2020 2020 2020 206c 6566 745f 696e           left_in
-000331a0: 6465 783d 6f6e 2069 7320 4e6f 6e65 2c0a  dex=on is None,.
-000331b0: 2020 2020 2020 2020 2020 2020 7269 6768              righ
-000331c0: 745f 696e 6465 783d 5472 7565 2c0a 2020  t_index=True,.  
-000331d0: 2020 2020 2020 2020 2020 6c65 6674 5f6f            left_o
-000331e0: 6e3d 6f6e 2c0a 2020 2020 2020 2020 2020  n=on,.          
-000331f0: 2020 7375 6666 6978 6573 3d28 6c73 7566    suffixes=(lsuf
-00033200: 6669 782c 2072 7375 6666 6978 292c 0a20  fix, rsuffix),. 
-00033210: 2020 2020 2020 2020 2020 206e 7061 7274             npart
-00033220: 6974 696f 6e73 3d6e 7061 7274 6974 696f  itions=npartitio
-00033230: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
-00033240: 7368 7566 666c 653d 7368 7566 666c 652c  shuffle=shuffle,
-00033250: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00033260: 6966 206e 6f74 2050 414e 4441 535f 4754  if not PANDAS_GT
-00033270: 5f32 3030 3a0a 0a20 2020 2020 2020 2040  _200:..        @
-00033280: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00033290: 4461 7461 4672 616d 6529 0a20 2020 2020  DataFrame).     
-000332a0: 2020 2064 6566 2061 7070 656e 6428 7365     def append(se
-000332b0: 6c66 2c20 6f74 6865 722c 2069 6e74 6572  lf, other, inter
-000332c0: 6c65 6176 655f 7061 7274 6974 696f 6e73  leave_partitions
-000332d0: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
-000332e0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-000332f0: 6365 286f 7468 6572 2c20 5365 7269 6573  ce(other, Series
-00033300: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00033310: 2020 206d 7367 203d 2028 0a20 2020 2020     msg = (.     
-00033320: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00033330: 556e 6162 6c65 2074 6f20 6170 7065 6e64  Unable to append
-00033340: 696e 6720 6464 2e53 6572 6965 7320 746f  ing dd.Series to
-00033350: 2064 642e 4461 7461 4672 616d 652e 220a   dd.DataFrame.".
-00033360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033370: 2020 2020 2255 7365 2070 642e 5365 7269      "Use pd.Seri
-00033380: 6573 2074 6f20 6170 7065 6e64 2061 7320  es to append as 
-00033390: 726f 772e 220a 2020 2020 2020 2020 2020  row.".          
-000333a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000333b0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-000333c0: 6c75 6545 7272 6f72 286d 7367 290a 2020  lueError(msg).  
-000333d0: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
-000333e0: 735f 7365 7269 6573 5f6c 696b 6528 6f74  s_series_like(ot
-000333f0: 6865 7229 3a0a 2020 2020 2020 2020 2020  her):.          
-00033400: 2020 2020 2020 6f74 6865 7220 3d20 6f74        other = ot
-00033410: 6865 722e 746f 5f66 7261 6d65 2829 2e54  her.to_frame().T
-00033420: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00033430: 7572 6e20 7375 7065 7228 292e 6170 7065  urn super().appe
-00033440: 6e64 286f 7468 6572 2c20 696e 7465 726c  nd(other, interl
-00033450: 6561 7665 5f70 6172 7469 7469 6f6e 733d  eave_partitions=
-00033460: 696e 7465 726c 6561 7665 5f70 6172 7469  interleave_parti
-00033470: 7469 6f6e 7329 0a0a 2020 2020 4064 6572  tions)..    @der
-00033480: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00033490: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-000334a0: 6974 6572 726f 7773 2873 656c 6629 3a0a  iterrows(self):.
-000334b0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-000334c0: 2072 616e 6765 2873 656c 662e 6e70 6172   range(self.npar
-000334d0: 7469 7469 6f6e 7329 3a0a 2020 2020 2020  titions):.      
-000334e0: 2020 2020 2020 6466 203d 2073 656c 662e        df = self.
-000334f0: 6765 745f 7061 7274 6974 696f 6e28 6929  get_partition(i)
-00033500: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
-00033510: 2020 2020 2020 2079 6965 6c64 2066 726f         yield fro
-00033520: 6d20 6466 2e69 7465 7272 6f77 7328 290a  m df.iterrows().
-00033530: 0a20 2020 2040 6465 7269 7665 645f 6672  .    @derived_fr
-00033540: 6f6d 2870 642e 4461 7461 4672 616d 6529  om(pd.DataFrame)
-00033550: 0a20 2020 2064 6566 2069 7465 7274 7570  .    def itertup
-00033560: 6c65 7328 7365 6c66 2c20 696e 6465 783d  les(self, index=
-00033570: 5472 7565 2c20 6e61 6d65 3d22 5061 6e64  True, name="Pand
-00033580: 6173 2229 3a0a 2020 2020 2020 2020 666f  as"):.        fo
-00033590: 7220 6920 696e 2072 616e 6765 2873 656c  r i in range(sel
-000335a0: 662e 6e70 6172 7469 7469 6f6e 7329 3a0a  f.npartitions):.
-000335b0: 2020 2020 2020 2020 2020 2020 6466 203d              df =
-000335c0: 2073 656c 662e 6765 745f 7061 7274 6974   self.get_partit
-000335d0: 696f 6e28 6929 2e63 6f6d 7075 7465 2829  ion(i).compute()
-000335e0: 0a20 2020 2020 2020 2020 2020 2079 6965  .            yie
-000335f0: 6c64 2066 726f 6d20 6466 2e69 7465 7274  ld from df.itert
-00033600: 7570 6c65 7328 696e 6465 783d 696e 6465  uples(index=inde
-00033610: 782c 206e 616d 653d 6e61 6d65 290a 0a20  x, name=name).. 
-00033620: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00033630: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-00033640: 2020 2064 6566 2069 7465 6d73 2873 656c     def items(sel
-00033650: 6629 3a0a 2020 2020 2020 2020 666f 7220  f):.        for 
-00033660: 636f 6c5f 6964 782c 206c 6162 656c 2069  col_idx, label i
-00033670: 6e20 656e 756d 6572 6174 6528 7365 6c66  n enumerate(self
-00033680: 2e63 6f6c 756d 6e73 293a 0a20 2020 2020  .columns):.     
-00033690: 2020 2020 2020 2079 6965 6c64 206c 6162         yield lab
-000336a0: 656c 2c20 7365 6c66 2e69 6c6f 635b 3a2c  el, self.iloc[:,
-000336b0: 2063 6f6c 5f69 6478 5d0a 0a20 2020 2040   col_idx]..    @
-000336c0: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
-000336d0: 6465 6620 5f62 696e 645f 6f70 6572 6174  def _bind_operat
-000336e0: 6f72 5f6d 6574 686f 6428 636c 732c 206e  or_method(cls, n
-000336f0: 616d 652c 206f 702c 206f 7269 6769 6e61  ame, op, origina
-00033700: 6c3d 7064 2e44 6174 6146 7261 6d65 293a  l=pd.DataFrame):
-00033710: 0a20 2020 2020 2020 2022 2222 6269 6e64  .        """bind
-00033720: 206f 7065 7261 746f 7220 6d65 7468 6f64   operator method
-00033730: 206c 696b 6520 4461 7461 4672 616d 652e   like DataFrame.
-00033740: 6164 6420 746f 2074 6869 7320 636c 6173  add to this clas
-00033750: 7322 2222 0a0a 2020 2020 2020 2020 2320  s"""..        # 
-00033760: 6e61 6d65 206d 7573 7420 6265 2065 7870  name must be exp
-00033770: 6c69 6369 746c 7920 7061 7373 6564 2066  licitly passed f
-00033780: 6f72 2064 6976 206d 6574 686f 6420 7768  or div method wh
-00033790: 6f73 6520 6e61 6d65 2069 7320 7472 7565  ose name is true
-000337a0: 6469 760a 0a20 2020 2020 2020 2064 6566  div..        def
-000337b0: 206d 6574 6828 7365 6c66 2c20 6f74 6865   meth(self, othe
-000337c0: 722c 2061 7869 733d 2263 6f6c 756d 6e73  r, axis="columns
-000337d0: 222c 206c 6576 656c 3d4e 6f6e 652c 2066  ", level=None, f
-000337e0: 696c 6c5f 7661 6c75 653d 4e6f 6e65 293a  ill_value=None):
-000337f0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00033800: 6c65 7665 6c20 6973 206e 6f74 204e 6f6e  level is not Non
-00033810: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00033820: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-00033830: 656d 656e 7465 6445 7272 6f72 2822 6c65  ementedError("le
-00033840: 7665 6c20 6d75 7374 2062 6520 4e6f 6e65  vel must be None
-00033850: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
-00033860: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
-00033870: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
-00033880: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00033890: 2061 7869 7320 696e 2028 312c 2022 636f   axis in (1, "co
-000338a0: 6c75 6d6e 7322 293a 0a20 2020 2020 2020  lumns"):.       
-000338b0: 2020 2020 2020 2020 2023 2057 6865 6e20           # When 
-000338c0: 6178 6973 3d31 2061 6e64 206f 7468 6572  axis=1 and other
-000338d0: 2069 7320 6120 7365 7269 6573 2c20 606f   is a series, `o
-000338e0: 7468 6572 6020 6973 2074 7261 6e73 706f  ther` is transpo
-000338f0: 7365 640a 2020 2020 2020 2020 2020 2020  sed.            
-00033900: 2020 2020 2320 616e 6420 7468 6520 6f70      # and the op
-00033910: 6572 6174 6f72 2069 7320 6170 706c 6965  erator is applie
-00033920: 6420 6272 6f61 6463 6173 7420 6163 726f  d broadcast acro
-00033930: 7373 2072 6f77 732e 2054 6869 730a 2020  ss rows. This.  
-00033940: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00033950: 6973 6e27 7420 7375 7070 6f72 7465 6420  isn't supported 
-00033960: 7769 7468 2064 642e 5365 7269 6573 2e0a  with dd.Series..
-00033970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033980: 6966 2069 7369 6e73 7461 6e63 6528 6f74  if isinstance(ot
-00033990: 6865 722c 2053 6572 6965 7329 3a0a 2020  her, Series):.  
+00029810: 2020 2020 2020 2020 6966 2068 6173 6174          if hasat
+00029820: 7472 2873 656c 662e 5f6d 6574 615b 636f  tr(self._meta[co
+00029830: 6c5d 2c20 2264 7479 7065 2229 0a20 2020  l], "dtype").   
+00029840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029850: 2020 2020 2065 6c73 6520 4e6f 6e65 0a20       else None. 
+00029860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029870: 2020 2020 2020 2066 6f72 2063 6f6c 2069         for col i
+00029880: 6e20 7365 6c66 2e5f 6d65 7461 2e63 6f6c  n self._meta.col
+00029890: 756d 6e73 0a20 2020 2020 2020 2020 2020  umns.           
+000298a0: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
+000298b0: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+000298c0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+000298d0: 2064 6566 205f 5f61 7272 6179 5f77 7261   def __array_wra
+000298e0: 705f 5f28 7365 6c66 2c20 6172 7261 792c  p__(self, array,
+000298f0: 2063 6f6e 7465 7874 3d4e 6f6e 6529 3a0a   context=None):.
+00029900: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00029910: 7461 6e63 6528 636f 6e74 6578 742c 2074  tance(context, t
+00029920: 7570 6c65 2920 616e 6420 6c65 6e28 636f  uple) and len(co
+00029930: 6e74 6578 7429 203e 2030 3a0a 2020 2020  ntext) > 0:.    
+00029940: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00029950: 7461 6e63 6528 636f 6e74 6578 745b 315d  tance(context[1]
+00029960: 5b30 5d2c 206e 702e 6e64 6172 7261 7929  [0], np.ndarray)
+00029970: 2061 6e64 2063 6f6e 7465 7874 5b31 5d5b   and context[1][
+00029980: 305d 2e73 6861 7065 203d 3d20 2829 3a0a  0].shape == ():.
+00029990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000299a0: 696e 6465 7820 3d20 4e6f 6e65 0a20 2020  index = None.   
+000299b0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+000299c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000299d0: 6e64 6578 203d 2063 6f6e 7465 7874 5b31  ndex = context[1
+000299e0: 5d5b 305d 2e69 6e64 6578 0a20 2020 2020  ][0].index.     
+000299f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00029a00: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+00029a10: 2020 2020 2020 2020 2020 696d 706f 7274            import
+00029a20: 2069 6e73 7065 6374 0a0a 2020 2020 2020   inspect..      
+00029a30: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00029a40: 5f6e 616d 6520 3d20 6622 607b 696e 7370  _name = f"`{insp
+00029a50: 6563 742e 7374 6163 6b28 295b 335d 5b33  ect.stack()[3][3
+00029a60: 5d7d 6022 0a20 2020 2020 2020 2020 2020  ]}`".           
+00029a70: 2065 7863 6570 7420 496e 6465 7845 7272   except IndexErr
+00029a80: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+00029a90: 2020 2020 6d65 7468 6f64 5f6e 616d 6520      method_name 
+00029aa0: 3d20 2254 6869 7320 6d65 7468 6f64 220a  = "This method".
+00029ab0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00029ac0: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
+00029ad0: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
+00029ae0: 2020 2020 2020 2020 6622 7b6d 6574 686f          f"{metho
+00029af0: 645f 6e61 6d65 7d20 6973 206e 6f74 2069  d_name} is not i
+00029b00: 6d70 6c65 6d65 6e74 6564 2066 6f72 2060  mplemented for `
+00029b10: 6461 736b 2e64 6174 6166 7261 6d65 2e44  dask.dataframe.D
+00029b20: 6174 6146 7261 6d65 602e 220a 2020 2020  ataFrame`.".    
+00029b30: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00029b40: 2020 2072 6574 7572 6e20 6d65 7461 5f66     return meta_f
+00029b50: 7261 6d65 5f63 6f6e 7374 7275 6374 6f72  rame_constructor
+00029b60: 2873 656c 6629 2861 7272 6179 2c20 696e  (self)(array, in
+00029b70: 6465 783d 696e 6465 782c 2063 6f6c 756d  dex=index, colum
+00029b80: 6e73 3d73 656c 662e 636f 6c75 6d6e 7329  ns=self.columns)
+00029b90: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00029ba0: 2020 2020 6465 6620 6178 6573 2873 656c      def axes(sel
+00029bb0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00029bc0: 726e 205b 7365 6c66 2e69 6e64 6578 2c20  rn [self.index, 
+00029bd0: 7365 6c66 2e63 6f6c 756d 6e73 5d0a 0a20  self.columns].. 
+00029be0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00029bf0: 2064 6566 2063 6f6c 756d 6e73 2873 656c   def columns(sel
+00029c00: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00029c10: 726e 2073 656c 662e 5f6d 6574 612e 636f  rn self._meta.co
+00029c20: 6c75 6d6e 730a 0a20 2020 2040 636f 6c75  lumns..    @colu
+00029c30: 6d6e 732e 7365 7474 6572 0a20 2020 2064  mns.setter.    d
+00029c40: 6566 2063 6f6c 756d 6e73 2873 656c 662c  ef columns(self,
+00029c50: 2063 6f6c 756d 6e73 293a 0a20 2020 2020   columns):.     
+00029c60: 2020 2072 656e 616d 6564 203d 205f 7265     renamed = _re
+00029c70: 6e61 6d65 5f64 6173 6b28 7365 6c66 2c20  name_dask(self, 
+00029c80: 636f 6c75 6d6e 7329 0a20 2020 2020 2020  columns).       
+00029c90: 2073 656c 662e 5f6d 6574 6120 3d20 7265   self._meta = re
+00029ca0: 6e61 6d65 642e 5f6d 6574 610a 2020 2020  named._meta.    
+00029cb0: 2020 2020 7365 6c66 2e5f 6e61 6d65 203d      self._name =
+00029cc0: 2072 656e 616d 6564 2e5f 6e61 6d65 0a20   renamed._name. 
+00029cd0: 2020 2020 2020 2073 656c 662e 6461 736b         self.dask
+00029ce0: 203d 2072 656e 616d 6564 2e64 6173 6b0a   = renamed.dask.
+00029cf0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00029d00: 2020 2064 6566 2069 6c6f 6328 7365 6c66     def iloc(self
+00029d10: 293a 0a20 2020 2020 2020 2022 2222 5075  ):.        """Pu
+00029d20: 7265 6c79 2069 6e74 6567 6572 2d6c 6f63  rely integer-loc
+00029d30: 6174 696f 6e20 6261 7365 6420 696e 6465  ation based inde
+00029d40: 7869 6e67 2066 6f72 2073 656c 6563 7469  xing for selecti
+00029d50: 6f6e 2062 7920 706f 7369 7469 6f6e 2e0a  on by position..
+00029d60: 0a20 2020 2020 2020 204f 6e6c 7920 696e  .        Only in
+00029d70: 6465 7869 6e67 2074 6865 2063 6f6c 756d  dexing the colum
+00029d80: 6e20 706f 7369 7469 6f6e 7320 6973 2073  n positions is s
+00029d90: 7570 706f 7274 6564 2e20 5472 7969 6e67  upported. Trying
+00029da0: 2074 6f20 7365 6c65 6374 0a20 2020 2020   to select.     
+00029db0: 2020 2072 6f77 2070 6f73 6974 696f 6e73     row positions
+00029dc0: 2077 696c 6c20 7261 6973 6520 6120 5661   will raise a Va
+00029dd0: 6c75 6545 7272 6f72 2e0a 0a20 2020 2020  lueError...     
+00029de0: 2020 2053 6565 203a 7265 663a 6064 6174     See :ref:`dat
+00029df0: 6166 7261 6d65 2e69 6e64 6578 696e 6760  aframe.indexing`
+00029e00: 2066 6f72 206d 6f72 652e 0a0a 2020 2020   for more...    
+00029e10: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+00029e20: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00029e30: 2020 2020 2020 3e3e 3e20 6466 2e69 6c6f        >>> df.ilo
+00029e40: 635b 3a2c 205b 322c 2030 2c20 315d 5d20  c[:, [2, 0, 1]] 
+00029e50: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+00029e60: 500a 2020 2020 2020 2020 2222 220a 2020  P.        """.  
+00029e70: 2020 2020 2020 6672 6f6d 2064 6173 6b2e        from dask.
+00029e80: 6461 7461 6672 616d 652e 696e 6465 7869  dataframe.indexi
+00029e90: 6e67 2069 6d70 6f72 7420 5f69 4c6f 6349  ng import _iLocI
+00029ea0: 6e64 6578 6572 0a0a 2020 2020 2020 2020  ndexer..        
+00029eb0: 2320 466f 7220 6461 7461 6672 616d 6573  # For dataframes
+00029ec0: 2077 6974 6820 756e 6971 7565 2063 6f6c   with unique col
+00029ed0: 756d 6e20 6e61 6d65 732c 2074 6869 7320  umn names, this 
+00029ee0: 7769 6c6c 2062 6520 7472 616e 7366 6f72  will be transfor
+00029ef0: 6d65 6420 696e 746f 2061 205f 5f67 6574  med into a __get
+00029f00: 6974 656d 5f5f 2063 616c 6c0a 2020 2020  item__ call.    
+00029f10: 2020 2020 7265 7475 726e 205f 694c 6f63      return _iLoc
+00029f20: 496e 6465 7865 7228 7365 6c66 290a 0a20  Indexer(self).. 
+00029f30: 2020 2064 6566 205f 5f6c 656e 5f5f 2873     def __len__(s
+00029f40: 656c 6629 3a0a 2020 2020 2020 2020 7472  elf):.        tr
+00029f50: 793a 0a20 2020 2020 2020 2020 2020 2073  y:.            s
+00029f60: 203d 2073 656c 662e 696c 6f63 5b3a 2c20   = self.iloc[:, 
+00029f70: 305d 0a20 2020 2020 2020 2065 7863 6570  0].        excep
+00029f80: 7420 496e 6465 7845 7272 6f72 3a0a 2020  t IndexError:.  
+00029f90: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00029fa0: 2073 7570 6572 2829 2e5f 5f6c 656e 5f5f   super().__len__
+00029fb0: 2829 0a20 2020 2020 2020 2065 6c73 653a  ().        else:
+00029fc0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00029fd0: 7572 6e20 6c65 6e28 7329 0a0a 2020 2020  urn len(s)..    
+00029fe0: 6465 6620 5f5f 636f 6e74 6169 6e73 5f5f  def __contains__
+00029ff0: 2873 656c 662c 206b 6579 293a 0a20 2020  (self, key):.   
+0002a000: 2020 2020 2072 6574 7572 6e20 6b65 7920       return key 
+0002a010: 696e 2073 656c 662e 5f6d 6574 610a 0a20  in self._meta.. 
+0002a020: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0002a030: 2064 6566 2065 6d70 7479 2873 656c 6629   def empty(self)
+0002a040: 3a0a 2020 2020 2020 2020 2320 5f5f 6765  :.        # __ge
+0002a050: 7461 7474 725f 5f20 7769 6c6c 2062 6520  tattr__ will be 
+0002a060: 6361 6c6c 6564 2061 6674 6572 2077 6520  called after we 
+0002a070: 7261 6973 6520 7468 6973 2c20 736f 2077  raise this, so w
+0002a080: 6527 6c6c 2072 6169 7365 2069 7420 6167  e'll raise it ag
+0002a090: 6169 6e20 6672 6f6d 2074 6865 7265 0a20  ain from there. 
+0002a0a0: 2020 2020 2020 2072 6169 7365 2041 7474         raise Att
+0002a0b0: 7269 6275 7465 4e6f 7449 6d70 6c65 6d65  ributeNotImpleme
+0002a0c0: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
+0002a0d0: 2020 2020 2020 2022 4368 6563 6b69 6e67         "Checking
+0002a0e0: 2077 6865 7468 6572 2061 2044 6173 6b20   whether a Dask 
+0002a0f0: 4461 7461 4672 616d 6520 6861 7320 616e  DataFrame has an
+0002a100: 7920 726f 7773 206d 6179 2062 6520 6578  y rows may be ex
+0002a110: 7065 6e73 6976 652e 2022 0a20 2020 2020  pensive. ".     
+0002a120: 2020 2020 2020 2022 486f 7765 7665 722c         "However,
+0002a130: 2063 6865 636b 696e 6720 7468 6520 6e75   checking the nu
+0002a140: 6d62 6572 206f 6620 636f 6c75 6d6e 7320  mber of columns 
+0002a150: 6973 2066 6173 742e 2022 0a20 2020 2020  is fast. ".     
+0002a160: 2020 2020 2020 2022 4465 7065 6e64 696e         "Dependin
+0002a170: 6720 6f6e 2077 6869 6368 206f 6620 7468  g on which of th
+0002a180: 6573 6520 7265 7375 6c74 7320 796f 7520  ese results you 
+0002a190: 6e65 6564 2c20 7573 6520 6569 7468 6572  need, use either
+0002a1a0: 2022 0a20 2020 2020 2020 2020 2020 2022   ".            "
+0002a1b0: 606c 656e 2864 662e 696e 6465 7829 203d  `len(df.index) =
+0002a1c0: 3d20 3060 206f 7220 606c 656e 2864 662e  = 0` or `len(df.
+0002a1d0: 636f 6c75 6d6e 7329 203d 3d20 3060 220a  columns) == 0`".
+0002a1e0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+0002a1f0: 6566 205f 5f67 6574 6974 656d 5f5f 2873  ef __getitem__(s
+0002a200: 656c 662c 206b 6579 293a 0a20 2020 2020  elf, key):.     
+0002a210: 2020 206e 616d 6520 3d20 2267 6574 6974     name = "getit
+0002a220: 656d 2d25 7322 2025 2074 6f6b 656e 697a  em-%s" % tokeniz
+0002a230: 6528 7365 6c66 2c20 6b65 7929 0a20 2020  e(self, key).   
+0002a240: 2020 2020 2069 6620 6e70 2e69 7373 6361       if np.issca
+0002a250: 6c61 7228 6b65 7929 206f 7220 6973 696e  lar(key) or isin
+0002a260: 7374 616e 6365 286b 6579 2c20 2874 7570  stance(key, (tup
+0002a270: 6c65 2c20 7374 7229 293a 0a20 2020 2020  le, str)):.     
+0002a280: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0002a290: 616e 6365 2873 656c 662e 5f6d 6574 612e  ance(self._meta.
+0002a2a0: 696e 6465 782c 2028 7064 2e44 6174 6574  index, (pd.Datet
+0002a2b0: 696d 6549 6e64 6578 2c20 7064 2e50 6572  imeIndex, pd.Per
+0002a2c0: 696f 6449 6e64 6578 2929 3a0a 2020 2020  iodIndex)):.    
+0002a2d0: 2020 2020 2020 2020 2020 2020 6966 206b              if k
+0002a2e0: 6579 206e 6f74 2069 6e20 7365 6c66 2e5f  ey not in self._
+0002a2f0: 6d65 7461 2e63 6f6c 756d 6e73 3a0a 2020  meta.columns:.  
+0002a300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a310: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+0002a320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a330: 2020 2020 2020 2020 2022 496e 6465 7869           "Indexi
+0002a340: 6e67 2061 2044 6174 6146 7261 6d65 2077  ng a DataFrame w
+0002a350: 6974 6820 6120 6461 7465 7469 6d65 6c69  ith a datetimeli
+0002a360: 6b65 2069 6e64 6578 2075 7369 6e67 2061  ke index using a
+0002a370: 2073 696e 676c 6520 220a 2020 2020 2020   single ".      
+0002a380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a390: 2020 2273 7472 696e 6720 746f 2073 6c69    "string to sli
+0002a3a0: 6365 2074 6865 2072 6f77 732c 206c 696b  ce the rows, lik
+0002a3b0: 6520 6066 7261 6d65 5b73 7472 696e 675d  e `frame[string]
+0002a3c0: 602c 2069 7320 6465 7072 6563 6174 6564  `, is deprecated
+0002a3d0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0002a3e0: 2020 2020 2020 2020 2020 2022 616e 6420             "and 
+0002a3f0: 7769 6c6c 2062 6520 7265 6d6f 7665 6420  will be removed 
+0002a400: 696e 2061 2066 7574 7572 6520 7665 7273  in a future vers
+0002a410: 696f 6e2e 2055 7365 2060 6672 616d 652e  ion. Use `frame.
+0002a420: 6c6f 635b 7374 7269 6e67 5d60 2022 0a20  loc[string]` ". 
+0002a430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a440: 2020 2020 2020 2022 696e 7374 6561 642e         "instead.
+0002a450: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0002a460: 2020 2020 2020 2020 2020 2046 7574 7572             Futur
+0002a470: 6557 6172 6e69 6e67 2c0a 2020 2020 2020  eWarning,.      
+0002a480: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0002a490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a4a0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0002a4b0: 6c6f 635b 6b65 795d 0a0a 2020 2020 2020  loc[key]..      
+0002a4c0: 2020 2020 2020 2320 6572 726f 7220 6973        # error is
+0002a4d0: 2072 6169 7365 6420 6672 6f6d 2070 616e   raised from pan
+0002a4e0: 6461 730a 2020 2020 2020 2020 2020 2020  das.            
+0002a4f0: 6d65 7461 203d 2073 656c 662e 5f6d 6574  meta = self._met
+0002a500: 615b 5f65 7874 7261 6374 5f6d 6574 6128  a[_extract_meta(
+0002a510: 6b65 7929 5d0a 2020 2020 2020 2020 2020  key)].          
+0002a520: 2020 6473 6b20 3d20 7061 7274 6974 696f    dsk = partitio
+0002a530: 6e77 6973 655f 6772 6170 6828 6f70 6572  nwise_graph(oper
+0002a540: 6174 6f72 2e67 6574 6974 656d 2c20 6e61  ator.getitem, na
+0002a550: 6d65 2c20 7365 6c66 2c20 6b65 7929 0a20  me, self, key). 
+0002a560: 2020 2020 2020 2020 2020 2067 7261 7068             graph
+0002a570: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+0002a580: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+0002a590: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
+0002a5a0: 7065 6e64 656e 6369 6573 3d5b 7365 6c66  pendencies=[self
+0002a5b0: 5d29 0a20 2020 2020 2020 2020 2020 2072  ]).            r
+0002a5c0: 6574 7572 6e20 6e65 775f 6464 5f6f 626a  eturn new_dd_obj
+0002a5d0: 6563 7428 6772 6170 682c 206e 616d 652c  ect(graph, name,
+0002a5e0: 206d 6574 612c 2073 656c 662e 6469 7669   meta, self.divi
+0002a5f0: 7369 6f6e 7329 0a20 2020 2020 2020 2065  sions).        e
+0002a600: 6c69 6620 6973 696e 7374 616e 6365 286b  lif isinstance(k
+0002a610: 6579 2c20 736c 6963 6529 3a0a 2020 2020  ey, slice):.    
+0002a620: 2020 2020 2020 2020 6672 6f6d 2070 616e          from pan
+0002a630: 6461 732e 6170 692e 7479 7065 7320 696d  das.api.types im
+0002a640: 706f 7274 2069 735f 666c 6f61 745f 6474  port is_float_dt
+0002a650: 7970 650a 0a20 2020 2020 2020 2020 2020  ype..           
+0002a660: 2069 735f 696e 7465 6765 725f 736c 6963   is_integer_slic
+0002a670: 6520 3d20 616e 7928 0a20 2020 2020 2020  e = any(.       
+0002a680: 2020 2020 2020 2020 2069 7369 6e73 7461           isinsta
+0002a690: 6e63 6528 692c 2049 6e74 6567 7261 6c29  nce(i, Integral)
+0002a6a0: 2066 6f72 2069 2069 6e20 286b 6579 2e73   for i in (key.s
+0002a6b0: 7461 7274 2c20 6b65 792e 7374 6570 2c20  tart, key.step, 
+0002a6c0: 6b65 792e 7374 6f70 290a 2020 2020 2020  key.stop).      
+0002a6d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0002a6e0: 2020 2020 2320 536c 6963 696e 6720 7769      # Slicing wi
+0002a6f0: 7468 2069 6e74 6567 6572 206c 6162 656c  th integer label
+0002a700: 7320 6973 2061 6c77 6179 7320 696c 6f63  s is always iloc
+0002a710: 2062 6173 6564 2065 7863 6570 7420 666f   based except fo
+0002a720: 7220 610a 2020 2020 2020 2020 2020 2020  r a.            
+0002a730: 2320 666c 6f61 7420 696e 6465 7865 7220  # float indexer 
+0002a740: 666f 7220 736f 6d65 2072 6561 736f 6e0a  for some reason.
+0002a750: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0002a760: 735f 696e 7465 6765 725f 736c 6963 6520  s_integer_slice 
+0002a770: 616e 6420 6e6f 7420 6973 5f66 6c6f 6174  and not is_float
+0002a780: 5f64 7479 7065 2873 656c 662e 696e 6465  _dtype(self.inde
+0002a790: 782e 6474 7970 6529 3a0a 2020 2020 2020  x.dtype):.      
+0002a7a0: 2020 2020 2020 2020 2020 2320 4e4f 5445            # NOTE
+0002a7b0: 3a20 7468 6973 2061 6c77 6179 7320 6661  : this always fa
+0002a7c0: 696c 7320 6375 7272 656e 746c 792c 2061  ils currently, a
+0002a7d0: 7320 696c 6f63 2069 7320 6d6f 7374 6c79  s iloc is mostly
+0002a7e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a7f0: 2023 2075 6e73 7570 706f 7274 6564 2c20   # unsupported, 
+0002a800: 6275 7420 7765 2063 616c 6c20 6974 2061  but we call it a
+0002a810: 6e79 7761 7920 6865 7265 2066 6f72 2066  nyway here for f
+0002a820: 7574 7572 652d 7072 6f6f 6669 6e67 0a20  uture-proofing. 
+0002a830: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0002a840: 2061 6e64 2065 7272 6f72 2d61 7474 7269   and error-attri
+0002a850: 6275 7469 6f6e 2070 7572 706f 7365 730a  bution purposes.
+0002a860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a870: 7265 7475 726e 2073 656c 662e 696c 6f63  return self.iloc
+0002a880: 5b6b 6579 5d0a 2020 2020 2020 2020 2020  [key].          
+0002a890: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0002a8a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0002a8b0: 656c 662e 6c6f 635b 6b65 795d 0a0a 2020  elf.loc[key]..  
+0002a8c0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0002a8d0: 6e63 6528 6b65 792c 2028 6e70 2e6e 6461  nce(key, (np.nda
+0002a8e0: 7272 6179 2c20 6c69 7374 2929 206f 7220  rray, list)) or 
+0002a8f0: 280a 2020 2020 2020 2020 2020 2020 6e6f  (.            no
+0002a900: 7420 6973 5f64 6173 6b5f 636f 6c6c 6563  t is_dask_collec
+0002a910: 7469 6f6e 286b 6579 2920 616e 6420 2869  tion(key) and (i
+0002a920: 735f 7365 7269 6573 5f6c 696b 6528 6b65  s_series_like(ke
+0002a930: 7929 206f 7220 6973 5f69 6e64 6578 5f6c  y) or is_index_l
+0002a940: 696b 6528 6b65 7929 290a 2020 2020 2020  ike(key)).      
+0002a950: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+0002a960: 2023 2065 7272 6f72 2069 7320 7261 6973   # error is rais
+0002a970: 6564 2066 726f 6d20 7061 6e64 6173 0a20  ed from pandas. 
+0002a980: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
+0002a990: 3d20 7365 6c66 2e5f 6d65 7461 5b5f 6578  = self._meta[_ex
+0002a9a0: 7472 6163 745f 6d65 7461 286b 6579 295d  tract_meta(key)]
+0002a9b0: 0a0a 2020 2020 2020 2020 2020 2020 6473  ..            ds
+0002a9c0: 6b20 3d20 7061 7274 6974 696f 6e77 6973  k = partitionwis
+0002a9d0: 655f 6772 6170 6828 6f70 6572 6174 6f72  e_graph(operator
+0002a9e0: 2e67 6574 6974 656d 2c20 6e61 6d65 2c20  .getitem, name, 
+0002a9f0: 7365 6c66 2c20 6b65 7929 0a20 2020 2020  self, key).     
+0002aa00: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
+0002aa10: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
+0002aa20: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
+0002aa30: 616d 652c 2064 736b 2c20 6465 7065 6e64  ame, dsk, depend
+0002aa40: 656e 6369 6573 3d5b 7365 6c66 5d29 0a20  encies=[self]). 
+0002aa50: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0002aa60: 6e20 6e65 775f 6464 5f6f 626a 6563 7428  n new_dd_object(
+0002aa70: 6772 6170 682c 206e 616d 652c 206d 6574  graph, name, met
+0002aa80: 612c 2073 656c 662e 6469 7669 7369 6f6e  a, self.division
+0002aa90: 7329 0a20 2020 2020 2020 2069 6620 6973  s).        if is
+0002aaa0: 696e 7374 616e 6365 286b 6579 2c20 5365  instance(key, Se
+0002aab0: 7269 6573 293a 0a20 2020 2020 2020 2020  ries):.         
+0002aac0: 2020 2023 2064 6f20 6e6f 7420 7065 7266     # do not perf
+0002aad0: 6f72 6d20 6475 6d6d 7920 6361 6c63 756c  orm dummy calcul
+0002aae0: 6174 696f 6e2c 2061 7320 636f 6c75 6d6e  ation, as column
+0002aaf0: 7320 7769 6c6c 206e 6f74 2062 6520 6368  s will not be ch
+0002ab00: 616e 6765 642e 0a20 2020 2020 2020 2020  anged..         
+0002ab10: 2020 2069 6620 7365 6c66 2e64 6976 6973     if self.divis
+0002ab20: 696f 6e73 2021 3d20 6b65 792e 6469 7669  ions != key.divi
+0002ab30: 7369 6f6e 733a 0a20 2020 2020 2020 2020  sions:.         
+0002ab40: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+0002ab50: 2e64 6174 6166 7261 6d65 2e6d 756c 7469  .dataframe.multi
+0002ab60: 2069 6d70 6f72 7420 5f6d 6179 6265 5f61   import _maybe_a
+0002ab70: 6c69 676e 5f70 6172 7469 7469 6f6e 730a  lign_partitions.
+0002ab80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ab90: 2073 656c 662c 206b 6579 203d 205f 6d61   self, key = _ma
+0002aba0: 7962 655f 616c 6967 6e5f 7061 7274 6974  ybe_align_partit
+0002abb0: 696f 6e73 285b 7365 6c66 2c20 6b65 795d  ions([self, key]
+0002abc0: 290a 2020 2020 2020 2020 2020 2020 6473  ).            ds
+0002abd0: 6b20 3d20 7061 7274 6974 696f 6e77 6973  k = partitionwis
+0002abe0: 655f 6772 6170 6828 6f70 6572 6174 6f72  e_graph(operator
+0002abf0: 2e67 6574 6974 656d 2c20 6e61 6d65 2c20  .getitem, name, 
+0002ac00: 7365 6c66 2c20 6b65 7929 0a20 2020 2020  self, key).     
+0002ac10: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
+0002ac20: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
+0002ac30: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 286e  om_collections(n
+0002ac40: 616d 652c 2064 736b 2c20 6465 7065 6e64  ame, dsk, depend
+0002ac50: 656e 6369 6573 3d5b 7365 6c66 2c20 6b65  encies=[self, ke
+0002ac60: 795d 290a 2020 2020 2020 2020 2020 2020  y]).            
+0002ac70: 7265 7475 726e 206e 6577 5f64 645f 6f62  return new_dd_ob
+0002ac80: 6a65 6374 2867 7261 7068 2c20 6e61 6d65  ject(graph, name
+0002ac90: 2c20 7365 6c66 2c20 7365 6c66 2e64 6976  , self, self.div
+0002aca0: 6973 696f 6e73 290a 2020 2020 2020 2020  isions).        
+0002acb0: 6966 2069 7369 6e73 7461 6e63 6528 6b65  if isinstance(ke
+0002acc0: 792c 2044 6174 6146 7261 6d65 293a 0a20  y, DataFrame):. 
+0002acd0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0002ace0: 6e20 7365 6c66 2e77 6865 7265 286b 6579  n self.where(key
+0002acf0: 2c20 6e70 2e6e 616e 290a 0a20 2020 2020  , np.nan)..     
+0002ad00: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+0002ad10: 656d 656e 7465 6445 7272 6f72 286b 6579  ementedError(key
+0002ad20: 290a 0a20 2020 2064 6566 205f 5f73 6574  )..    def __set
+0002ad30: 6974 656d 5f5f 2873 656c 662c 206b 6579  item__(self, key
+0002ad40: 2c20 7661 6c75 6529 3a0a 2020 2020 2020  , value):.      
+0002ad50: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0002ad60: 6b65 792c 2028 7475 706c 652c 206c 6973  key, (tuple, lis
+0002ad70: 7429 2920 616e 6420 6973 696e 7374 616e  t)) and isinstan
+0002ad80: 6365 2876 616c 7565 2c20 4461 7461 4672  ce(value, DataFr
+0002ad90: 616d 6529 3a0a 2020 2020 2020 2020 2020  ame):.          
+0002ada0: 2020 6466 203d 2073 656c 662e 6173 7369    df = self.assi
+0002adb0: 676e 282a 2a7b 6b3a 2076 616c 7565 5b63  gn(**{k: value[c
+0002adc0: 5d20 666f 7220 6b2c 2063 2069 6e20 7a69  ] for k, c in zi
+0002add0: 7028 6b65 792c 2076 616c 7565 2e63 6f6c  p(key, value.col
+0002ade0: 756d 6e73 297d 290a 0a20 2020 2020 2020  umns)})..       
+0002adf0: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+0002ae00: 286b 6579 2c20 7064 2e49 6e64 6578 2920  (key, pd.Index) 
+0002ae10: 616e 6420 6e6f 7420 6973 696e 7374 616e  and not isinstan
+0002ae20: 6365 2876 616c 7565 2c20 4461 7461 4672  ce(value, DataFr
+0002ae30: 616d 6529 3a0a 2020 2020 2020 2020 2020  ame):.          
+0002ae40: 2020 6b65 7920 3d20 6c69 7374 286b 6579    key = list(key
+0002ae50: 290a 2020 2020 2020 2020 2020 2020 6466  ).            df
+0002ae60: 203d 2073 656c 662e 6173 7369 676e 282a   = self.assign(*
+0002ae70: 2a7b 6b3a 2076 616c 7565 2066 6f72 206b  *{k: value for k
+0002ae80: 2069 6e20 6b65 797d 290a 2020 2020 2020   in key}).      
+0002ae90: 2020 656c 6966 2028 0a20 2020 2020 2020    elif (.       
+0002aea0: 2020 2020 2069 735f 6461 7461 6672 616d       is_datafram
+0002aeb0: 655f 6c69 6b65 286b 6579 290a 2020 2020  e_like(key).    
+0002aec0: 2020 2020 2020 2020 6f72 2069 735f 7365          or is_se
+0002aed0: 7269 6573 5f6c 696b 6528 6b65 7929 0a20  ries_like(key). 
+0002aee0: 2020 2020 2020 2020 2020 206f 7220 6973             or is
+0002aef0: 696e 7374 616e 6365 286b 6579 2c20 2844  instance(key, (D
+0002af00: 6174 6146 7261 6d65 2c20 5365 7269 6573  ataFrame, Series
+0002af10: 2929 0a20 2020 2020 2020 2029 3a0a 2020  )).        ):.  
+0002af20: 2020 2020 2020 2020 2020 6466 203d 2073            df = s
+0002af30: 656c 662e 7768 6572 6528 7e6b 6579 2c20  elf.where(~key, 
+0002af40: 7661 6c75 6529 0a20 2020 2020 2020 2065  value).        e
+0002af50: 6c69 6620 6e6f 7420 6973 696e 7374 616e  lif not isinstan
+0002af60: 6365 286b 6579 2c20 7374 7229 3a0a 2020  ce(key, str):.  
+0002af70: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0002af80: 4e6f 7449 6d70 6c65 6d65 6e74 6564 4572  NotImplementedEr
+0002af90: 726f 7228 6622 4974 656d 2061 7373 6967  ror(f"Item assig
+0002afa0: 6e6d 656e 7420 7769 7468 207b 7479 7065  nment with {type
+0002afb0: 286b 6579 297d 206e 6f74 2073 7570 706f  (key)} not suppo
+0002afc0: 7274 6564 2229 0a20 2020 2020 2020 2065  rted").        e
+0002afd0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0002afe0: 2064 6620 3d20 7365 6c66 2e61 7373 6967   df = self.assig
+0002aff0: 6e28 2a2a 7b6b 6579 3a20 7661 6c75 657d  n(**{key: value}
+0002b000: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+0002b010: 6461 736b 203d 2064 662e 6461 736b 0a20  dask = df.dask. 
+0002b020: 2020 2020 2020 2073 656c 662e 5f6e 616d         self._nam
+0002b030: 6520 3d20 6466 2e5f 6e61 6d65 0a20 2020  e = df._name.   
+0002b040: 2020 2020 2073 656c 662e 5f6d 6574 6120       self._meta 
+0002b050: 3d20 6466 2e5f 6d65 7461 0a20 2020 2020  = df._meta.     
+0002b060: 2020 2073 656c 662e 5f64 6976 6973 696f     self._divisio
+0002b070: 6e73 203d 2064 662e 6469 7669 7369 6f6e  ns = df.division
+0002b080: 730a 0a20 2020 2064 6566 205f 5f64 656c  s..    def __del
+0002b090: 6974 656d 5f5f 2873 656c 662c 206b 6579  item__(self, key
+0002b0a0: 293a 0a20 2020 2020 2020 2072 6573 756c  ):.        resul
+0002b0b0: 7420 3d20 7365 6c66 2e64 726f 7028 5b6b  t = self.drop([k
+0002b0c0: 6579 5d2c 2061 7869 733d 3129 0a20 2020  ey], axis=1).   
+0002b0d0: 2020 2020 2073 656c 662e 6461 736b 203d       self.dask =
+0002b0e0: 2072 6573 756c 742e 6461 736b 0a20 2020   result.dask.   
+0002b0f0: 2020 2020 2073 656c 662e 5f6e 616d 6520       self._name 
+0002b100: 3d20 7265 7375 6c74 2e5f 6e61 6d65 0a20  = result._name. 
+0002b110: 2020 2020 2020 2073 656c 662e 5f6d 6574         self._met
+0002b120: 6120 3d20 7265 7375 6c74 2e5f 6d65 7461  a = result._meta
+0002b130: 0a0a 2020 2020 6465 6620 5f5f 7365 7461  ..    def __seta
+0002b140: 7474 725f 5f28 7365 6c66 2c20 6b65 792c  ttr__(self, key,
+0002b150: 2076 616c 7565 293a 0a20 2020 2020 2020   value):.       
+0002b160: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0002b170: 2020 636f 6c75 6d6e 7320 3d20 6f62 6a65    columns = obje
+0002b180: 6374 2e5f 5f67 6574 6174 7472 6962 7574  ct.__getattribut
+0002b190: 655f 5f28 7365 6c66 2c20 225f 6d65 7461  e__(self, "_meta
+0002b1a0: 2229 2e63 6f6c 756d 6e73 0a20 2020 2020  ").columns.     
+0002b1b0: 2020 2065 7863 6570 7420 4174 7472 6962     except Attrib
+0002b1c0: 7574 6545 7272 6f72 3a0a 2020 2020 2020  uteError:.      
+0002b1d0: 2020 2020 2020 636f 6c75 6d6e 7320 3d20        columns = 
+0002b1e0: 2829 0a0a 2020 2020 2020 2020 2320 6578  ()..        # ex
+0002b1f0: 636c 7564 6520 7072 6f74 6563 7465 6420  clude protected 
+0002b200: 6174 7472 6962 7574 6573 2066 726f 6d20  attributes from 
+0002b210: 7365 7469 7465 6d0a 2020 2020 2020 2020  setitem.        
+0002b220: 6966 206b 6579 2069 6e20 636f 6c75 6d6e  if key in column
+0002b230: 7320 616e 6420 6b65 7920 6e6f 7420 696e  s and key not in
+0002b240: 205b 2264 6976 6973 696f 6e73 222c 2022   ["divisions", "
+0002b250: 6461 736b 222c 2022 5f6e 616d 6522 2c20  dask", "_name", 
+0002b260: 225f 6d65 7461 225d 3a0a 2020 2020 2020  "_meta"]:.      
+0002b270: 2020 2020 2020 7365 6c66 5b6b 6579 5d20        self[key] 
+0002b280: 3d20 7661 6c75 650a 2020 2020 2020 2020  = value.        
+0002b290: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0002b2a0: 2020 6f62 6a65 6374 2e5f 5f73 6574 6174    object.__setat
+0002b2b0: 7472 5f5f 2873 656c 662c 206b 6579 2c20  tr__(self, key, 
+0002b2c0: 7661 6c75 6529 0a0a 2020 2020 6465 6620  value)..    def 
+0002b2d0: 5f5f 6765 7461 7474 725f 5f28 7365 6c66  __getattr__(self
+0002b2e0: 2c20 6b65 7929 3a0a 2020 2020 2020 2020  , key):.        
+0002b2f0: 6966 206b 6579 2069 6e20 7365 6c66 2e63  if key in self.c
+0002b300: 6f6c 756d 6e73 3a0a 2020 2020 2020 2020  olumns:.        
+0002b310: 2020 2020 7265 7475 726e 2073 656c 665b      return self[
+0002b320: 6b65 795d 0a20 2020 2020 2020 2065 6c69  key].        eli
+0002b330: 6620 6b65 7920 3d3d 2022 656d 7074 7922  f key == "empty"
+0002b340: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+0002b350: 7365 6c66 2e65 6d70 7479 2072 6169 7365  self.empty raise
+0002b360: 7320 4174 7472 6962 7574 654e 6f74 496d  s AttributeNotIm
+0002b370: 706c 656d 656e 7465 6445 7272 6f72 2c20  plementedError, 
+0002b380: 7768 6963 6820 696e 636c 7564 6573 0a20  which includes. 
+0002b390: 2020 2020 2020 2020 2020 2023 2041 7474             # Att
+0002b3a0: 7269 6275 7465 4572 726f 722c 2077 6869  ributeError, whi
+0002b3b0: 6368 206d 6561 6e73 2077 6520 656e 6420  ch means we end 
+0002b3c0: 7570 2068 6572 6520 696e 2073 656c 662e  up here in self.
+0002b3d0: 5f5f 6765 7461 7474 725f 5f2c 0a20 2020  __getattr__,.   
+0002b3e0: 2020 2020 2020 2020 2023 2062 6563 6175           # becau
+0002b3f0: 7365 2044 6174 6146 7261 6d65 2e5f 5f67  se DataFrame.__g
+0002b400: 6574 6174 7472 6962 7574 655f 5f20 646f  etattribute__ do
+0002b410: 6573 6e27 7420 7468 696e 6b20 7468 6520  esn't think the 
+0002b420: 6174 7472 6962 7574 6520 6578 6973 7473  attribute exists
+0002b430: 0a20 2020 2020 2020 2020 2020 2023 2061  .            # a
+0002b440: 6e64 2075 7365 7320 5f5f 6765 7461 7474  nd uses __getatt
+0002b450: 725f 5f20 6173 2074 6865 2066 616c 6c62  r__ as the fallb
+0002b460: 6163 6b2e 2053 6f2c 2067 6574 2060 7365  ack. So, get `se
+0002b470: 6c66 2e65 6d70 7479 6020 6d6f 7265 0a20  lf.empty` more. 
+0002b480: 2020 2020 2020 2020 2020 2023 2066 6f72             # for
+0002b490: 6365 6675 6c6c 7920 7669 6120 6f62 6a65  cefully via obje
+0002b4a0: 6374 2e5f 5f67 6574 6174 7472 6962 7574  ct.__getattribut
+0002b4b0: 655f 5f20 746f 2072 6169 7365 2069 6e66  e__ to raise inf
+0002b4c0: 6f72 6d61 7469 7665 2065 7272 6f72 2e0a  ormative error..
+0002b4d0: 2020 2020 2020 2020 2020 2020 6f62 6a65              obje
+0002b4e0: 6374 2e5f 5f67 6574 6174 7472 6962 7574  ct.__getattribut
+0002b4f0: 655f 5f28 7365 6c66 2c20 6b65 7929 0a20  e__(self, key). 
+0002b500: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0002b510: 2020 2020 2020 2020 2072 6169 7365 2041           raise A
+0002b520: 7474 7269 6275 7465 4572 726f 7228 2227  ttributeError("'
+0002b530: 4461 7461 4672 616d 6527 206f 626a 6563  DataFrame' objec
+0002b540: 7420 6861 7320 6e6f 2061 7474 7269 6275  t has no attribu
+0002b550: 7465 2025 7222 2025 206b 6579 290a 0a20  te %r" % key).. 
+0002b560: 2020 2064 6566 205f 5f64 6972 5f5f 2873     def __dir__(s
+0002b570: 656c 6629 3a0a 2020 2020 2020 2020 6f20  elf):.        o 
+0002b580: 3d20 7365 7428 6469 7228 7479 7065 2873  = set(dir(type(s
+0002b590: 656c 6629 2929 0a20 2020 2020 2020 206f  elf))).        o
+0002b5a0: 2e75 7064 6174 6528 7365 6c66 2e5f 5f64  .update(self.__d
+0002b5b0: 6963 745f 5f29 0a20 2020 2020 2020 206f  ict__).        o
+0002b5c0: 2e75 7064 6174 6528 6320 666f 7220 6320  .update(c for c 
+0002b5d0: 696e 2073 656c 662e 636f 6c75 6d6e 7320  in self.columns 
+0002b5e0: 6966 2028 6973 696e 7374 616e 6365 2863  if (isinstance(c
+0002b5f0: 2c20 7374 7229 2061 6e64 2063 2e69 7369  , str) and c.isi
+0002b600: 6465 6e74 6966 6965 7228 2929 290a 2020  dentifier())).  
+0002b610: 2020 2020 2020 7265 7475 726e 206c 6973        return lis
+0002b620: 7428 6f29 0a0a 2020 2020 6465 6620 5f5f  t(o)..    def __
+0002b630: 6974 6572 5f5f 2873 656c 6629 3a0a 2020  iter__(self):.  
+0002b640: 2020 2020 2020 7265 7475 726e 2069 7465        return ite
+0002b650: 7228 7365 6c66 2e5f 6d65 7461 290a 0a20  r(self._meta).. 
+0002b660: 2020 2064 6566 205f 6970 7974 686f 6e5f     def _ipython_
+0002b670: 6b65 795f 636f 6d70 6c65 7469 6f6e 735f  key_completions_
+0002b680: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0002b690: 7265 7475 726e 206d 6574 686f 6473 2e74  return methods.t
+0002b6a0: 6f6c 6973 7428 7365 6c66 2e63 6f6c 756d  olist(self.colum
+0002b6b0: 6e73 290a 0a20 2020 2040 7072 6f70 6572  ns)..    @proper
+0002b6c0: 7479 0a20 2020 2064 6566 206e 6469 6d28  ty.    def ndim(
+0002b6d0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+0002b6e0: 2222 5265 7475 726e 2064 696d 656e 7369  ""Return dimensi
+0002b6f0: 6f6e 616c 6974 7922 2222 0a20 2020 2020  onality""".     
+0002b700: 2020 2072 6574 7572 6e20 320a 0a20 2020     return 2..   
+0002b710: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0002b720: 6566 2073 6861 7065 2873 656c 6629 3a0a  ef shape(self):.
+0002b730: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0002b740: 2020 2020 5265 7475 726e 2061 2074 7570      Return a tup
+0002b750: 6c65 2072 6570 7265 7365 6e74 696e 6720  le representing 
+0002b760: 7468 6520 6469 6d65 6e73 696f 6e61 6c69  the dimensionali
+0002b770: 7479 206f 6620 7468 6520 4461 7461 4672  ty of the DataFr
+0002b780: 616d 652e 0a0a 2020 2020 2020 2020 5468  ame...        Th
+0002b790: 6520 6e75 6d62 6572 206f 6620 726f 7773  e number of rows
+0002b7a0: 2069 7320 6120 4465 6c61 7965 6420 7265   is a Delayed re
+0002b7b0: 7375 6c74 2e20 5468 6520 6e75 6d62 6572  sult. The number
+0002b7c0: 206f 6620 636f 6c75 6d6e 730a 2020 2020   of columns.    
+0002b7d0: 2020 2020 6973 2061 2063 6f6e 6372 6574      is a concret
+0002b7e0: 6520 696e 7465 6765 722e 0a0a 2020 2020  e integer...    
+0002b7f0: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+0002b800: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+0002b810: 2020 2020 2020 3e3e 3e20 6466 2e73 697a        >>> df.siz
+0002b820: 6520 2023 2064 6f63 7465 7374 3a20 2b53  e  # doctest: +S
+0002b830: 4b49 500a 2020 2020 2020 2020 2844 656c  KIP.        (Del
+0002b840: 6179 6564 2827 696e 742d 3037 6630 3630  ayed('int-07f060
+0002b850: 3735 2d35 6563 632d 3464 3737 2d38 3137  75-5ecc-4d77-817
+0002b860: 652d 3633 6336 3961 3931 3838 6138 2729  e-63c69a9188a8')
+0002b870: 2c20 3229 0a20 2020 2020 2020 2022 2222  , 2).        """
+0002b880: 0a20 2020 2020 2020 2063 6f6c 5f73 697a  .        col_siz
+0002b890: 6520 3d20 6c65 6e28 7365 6c66 2e63 6f6c  e = len(self.col
+0002b8a0: 756d 6e73 290a 2020 2020 2020 2020 6966  umns).        if
+0002b8b0: 2063 6f6c 5f73 697a 6520 3d3d 2030 3a0a   col_size == 0:.
+0002b8c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0002b8d0: 726e 2028 7365 6c66 2e69 6e64 6578 2e73  rn (self.index.s
+0002b8e0: 6861 7065 5b30 5d2c 2030 290a 2020 2020  hape[0], 0).    
+0002b8f0: 2020 2020 726f 775f 7369 7a65 203d 2064      row_size = d
+0002b900: 656c 6179 6564 2869 6e74 2928 7365 6c66  elayed(int)(self
+0002b910: 2e73 697a 6520 2f20 636f 6c5f 7369 7a65  .size / col_size
+0002b920: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0002b930: 2028 726f 775f 7369 7a65 2c20 636f 6c5f   (row_size, col_
+0002b940: 7369 7a65 290a 0a20 2020 2040 7072 6f70  size)..    @prop
+0002b950: 6572 7479 0a20 2020 2064 6566 2064 7479  erty.    def dty
+0002b960: 7065 7328 7365 6c66 293a 0a20 2020 2020  pes(self):.     
+0002b970: 2020 2022 2222 5265 7475 726e 2064 6174     """Return dat
+0002b980: 6120 7479 7065 7322 2222 0a20 2020 2020  a types""".     
+0002b990: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0002b9a0: 6d65 7461 2e64 7479 7065 730a 0a20 2020  meta.dtypes..   
+0002b9b0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+0002b9c0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+0002b9d0: 2064 6566 2073 656c 6563 745f 6474 7970   def select_dtyp
+0002b9e0: 6573 2873 656c 662c 2069 6e63 6c75 6465  es(self, include
+0002b9f0: 3d4e 6f6e 652c 2065 7863 6c75 6465 3d4e  =None, exclude=N
+0002ba00: 6f6e 6529 3a0a 2020 2020 2020 2020 6373  one):.        cs
+0002ba10: 203d 2073 656c 662e 5f6d 6574 612e 7365   = self._meta.se
+0002ba20: 6c65 6374 5f64 7479 7065 7328 696e 636c  lect_dtypes(incl
+0002ba30: 7564 653d 696e 636c 7564 652c 2065 7863  ude=include, exc
+0002ba40: 6c75 6465 3d65 7863 6c75 6465 290a 2020  lude=exclude).  
+0002ba50: 2020 2020 2020 696e 6465 7865 7220 3d20        indexer = 
+0002ba60: 7365 6c66 2e5f 6765 745f 636f 6c75 6d6e  self._get_column
+0002ba70: 735f 696e 6465 7865 735f 6261 7365 645f  s_indexes_based_
+0002ba80: 6f6e 5f64 7479 7065 7328 6373 290a 2020  on_dtypes(cs).  
+0002ba90: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0002baa0: 662e 696c 6f63 5b3a 2c20 696e 6465 7865  f.iloc[:, indexe
+0002bab0: 725d 0a0a 2020 2020 6465 6620 736f 7274  r]..    def sort
+0002bac0: 5f76 616c 7565 7328 0a20 2020 2020 2020  _values(.       
+0002bad0: 2073 656c 662c 0a20 2020 2020 2020 2062   self,.        b
+0002bae0: 793a 2073 7472 207c 206c 6973 745b 7374  y: str | list[st
+0002baf0: 725d 2c0a 2020 2020 2020 2020 6e70 6172  r],.        npar
+0002bb00: 7469 7469 6f6e 733a 2069 6e74 207c 204c  titions: int | L
+0002bb10: 6974 6572 616c 5b22 6175 746f 225d 207c  iteral["auto"] |
+0002bb20: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
+0002bb30: 2020 2020 2020 6173 6365 6e64 696e 673a        ascending:
+0002bb40: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
+0002bb50: 2020 2020 2020 6e61 5f70 6f73 6974 696f        na_positio
+0002bb60: 6e3a 204c 6974 6572 616c 5b22 6669 7273  n: Literal["firs
+0002bb70: 7422 5d20 7c20 4c69 7465 7261 6c5b 226c  t"] | Literal["l
+0002bb80: 6173 7422 5d20 3d20 226c 6173 7422 2c0a  ast"] = "last",.
+0002bb90: 2020 2020 2020 2020 736f 7274 5f66 756e          sort_fun
+0002bba0: 6374 696f 6e3a 2043 616c 6c61 626c 655b  ction: Callable[
+0002bbb0: 5b70 642e 4461 7461 4672 616d 655d 2c20  [pd.DataFrame], 
+0002bbc0: 7064 2e44 6174 6146 7261 6d65 5d20 7c20  pd.DataFrame] | 
+0002bbd0: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
+0002bbe0: 2020 2020 2073 6f72 745f 6675 6e63 7469       sort_functi
+0002bbf0: 6f6e 5f6b 7761 7267 733a 204d 6170 7069  on_kwargs: Mappi
+0002bc00: 6e67 5b73 7472 2c20 416e 795d 207c 204e  ng[str, Any] | N
+0002bc10: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
+0002bc20: 2020 2020 2a2a 6b77 6172 6773 2c0a 2020      **kwargs,.  
+0002bc30: 2020 2920 2d3e 2044 6174 6146 7261 6d65    ) -> DataFrame
+0002bc40: 3a0a 2020 2020 2020 2020 2222 2253 6f72  :.        """Sor
+0002bc50: 7420 7468 6520 6461 7461 7365 7420 6279  t the dataset by
+0002bc60: 2061 2073 696e 676c 6520 636f 6c75 6d6e   a single column
+0002bc70: 2e0a 0a20 2020 2020 2020 2053 6f72 7469  ...        Sorti
+0002bc80: 6e67 2061 2070 6172 616c 6c65 6c20 6461  ng a parallel da
+0002bc90: 7461 7365 7420 7265 7175 6972 6573 2065  taset requires e
+0002bca0: 7870 656e 7369 7665 2073 6875 6666 6c65  xpensive shuffle
+0002bcb0: 7320 616e 6420 6973 2067 656e 6572 616c  s and is general
+0002bcc0: 6c79 0a20 2020 2020 2020 206e 6f74 2072  ly.        not r
+0002bcd0: 6563 6f6d 6d65 6e64 6564 2e20 5365 6520  ecommended. See 
+0002bce0: 6060 7365 745f 696e 6465 7860 6020 666f  ``set_index`` fo
+0002bcf0: 7220 696d 706c 656d 656e 7461 7469 6f6e  r implementation
+0002bd00: 2064 6574 6169 6c73 2e0a 0a20 2020 2020   details...     
+0002bd10: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+0002bd20: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0002bd30: 0a20 2020 2020 2020 2062 793a 2073 7472  .        by: str
+0002bd40: 206f 7220 6c69 7374 5b73 7472 5d0a 2020   or list[str].  
+0002bd50: 2020 2020 2020 2020 2020 436f 6c75 6d6e            Column
+0002bd60: 2873 2920 746f 2073 6f72 7420 6279 2e0a  (s) to sort by..
+0002bd70: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
+0002bd80: 6f6e 733a 2069 6e74 2c20 4e6f 6e65 2c20  ons: int, None, 
+0002bd90: 6f72 2027 6175 746f 270a 2020 2020 2020  or 'auto'.      
+0002bda0: 2020 2020 2020 5468 6520 6964 6561 6c20        The ideal 
+0002bdb0: 6e75 6d62 6572 206f 6620 6f75 7470 7574  number of output
+0002bdc0: 2070 6172 7469 7469 6f6e 732e 2049 6620   partitions. If 
+0002bdd0: 4e6f 6e65 2c20 7573 6520 7468 6520 7361  None, use the sa
+0002bde0: 6d65 2061 730a 2020 2020 2020 2020 2020  me as.          
+0002bdf0: 2020 7468 6520 696e 7075 742e 2049 6620    the input. If 
+0002be00: 2761 7574 6f27 2074 6865 6e20 6465 6369  'auto' then deci
+0002be10: 6465 2062 7920 6d65 6d6f 7279 2075 7365  de by memory use
+0002be20: 2e0a 2020 2020 2020 2020 6173 6365 6e64  ..        ascend
+0002be30: 696e 673a 2062 6f6f 6c2c 206f 7074 696f  ing: bool, optio
+0002be40: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+0002be50: 536f 7274 2061 7363 656e 6469 6e67 2076  Sort ascending v
+0002be60: 732e 2064 6573 6365 6e64 696e 672e 0a20  s. descending.. 
+0002be70: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
+0002be80: 6c74 7320 746f 2054 7275 652e 0a20 2020  lts to True..   
+0002be90: 2020 2020 206e 615f 706f 7369 7469 6f6e       na_position
+0002bea0: 3a20 7b27 6c61 7374 272c 2027 6669 7273  : {'last', 'firs
+0002beb0: 7427 7d2c 206f 7074 696f 6e61 6c0a 2020  t'}, optional.  
+0002bec0: 2020 2020 2020 2020 2020 5075 7473 204e            Puts N
+0002bed0: 614e 7320 6174 2074 6865 2062 6567 696e  aNs at the begin
+0002bee0: 6e69 6e67 2069 6620 2766 6972 7374 272c  ning if 'first',
+0002bef0: 2070 7574 7320 4e61 4e20 6174 2074 6865   puts NaN at the
+0002bf00: 2065 6e64 2069 6620 276c 6173 7427 2e0a   end if 'last'..
+0002bf10: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
+0002bf20: 756c 7473 2074 6f20 276c 6173 7427 2e0a  ults to 'last'..
+0002bf30: 2020 2020 2020 2020 736f 7274 5f66 756e          sort_fun
+0002bf40: 6374 696f 6e3a 2066 756e 6374 696f 6e2c  ction: function,
+0002bf50: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0002bf60: 2020 2020 2020 536f 7274 696e 6720 6675        Sorting fu
+0002bf70: 6e63 7469 6f6e 2074 6f20 7573 6520 7768  nction to use wh
+0002bf80: 656e 2073 6f72 7469 6e67 2075 6e64 6572  en sorting under
+0002bf90: 6c79 696e 6720 7061 7274 6974 696f 6e73  lying partitions
+0002bfa0: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+0002bfb0: 204e 6f6e 652c 2064 6566 6175 6c74 7320   None, defaults 
+0002bfc0: 746f 2060 604d 2e73 6f72 745f 7661 6c75  to ``M.sort_valu
+0002bfd0: 6573 6060 2028 7468 6520 7061 7274 6974  es`` (the partit
+0002bfe0: 696f 6e20 6c69 6272 6172 7927 730a 2020  ion library's.  
+0002bff0: 2020 2020 2020 2020 2020 696d 706c 656d            implem
+0002c000: 656e 7461 7469 6f6e 206f 6620 6060 736f  entation of ``so
+0002c010: 7274 5f76 616c 7565 7360 6029 2e0a 2020  rt_values``)..  
+0002c020: 2020 2020 2020 736f 7274 5f66 756e 6374        sort_funct
+0002c030: 696f 6e5f 6b77 6172 6773 3a20 6469 6374  ion_kwargs: dict
+0002c040: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0002c050: 2020 2020 2020 2041 6464 6974 696f 6e61         Additiona
+0002c060: 6c20 6b65 7977 6f72 6420 6172 6775 6d65  l keyword argume
+0002c070: 6e74 7320 746f 2070 6173 7320 746f 2074  nts to pass to t
+0002c080: 6865 2070 6172 7469 7469 6f6e 2073 6f72  he partition sor
+0002c090: 7469 6e67 2066 756e 6374 696f 6e2e 0a20  ting function.. 
+0002c0a0: 2020 2020 2020 2020 2020 2042 7920 6465             By de
+0002c0b0: 6661 756c 742c 2060 6062 7960 602c 2060  fault, ``by``, `
+0002c0c0: 6061 7363 656e 6469 6e67 6060 2c20 616e  `ascending``, an
+0002c0d0: 6420 6060 6e61 5f70 6f73 6974 696f 6e60  d ``na_position`
+0002c0e0: 6020 6172 6520 7072 6f76 6964 6564 2e0a  ` are provided..
+0002c0f0: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+0002c100: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0002c110: 2d2d 0a20 2020 2020 2020 203e 3e3e 2064  --.        >>> d
+0002c120: 6632 203d 2064 662e 736f 7274 5f76 616c  f2 = df.sort_val
+0002c130: 7565 7328 2778 2729 2020 2320 646f 6374  ues('x')  # doct
+0002c140: 6573 743a 202b 534b 4950 0a20 2020 2020  est: +SKIP.     
+0002c150: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+0002c160: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
+0002c170: 6d65 2e73 6875 6666 6c65 2069 6d70 6f72  me.shuffle impor
+0002c180: 7420 736f 7274 5f76 616c 7565 730a 0a20  t sort_values.. 
+0002c190: 2020 2020 2020 2072 6574 7572 6e20 736f         return so
+0002c1a0: 7274 5f76 616c 7565 7328 0a20 2020 2020  rt_values(.     
+0002c1b0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0002c1c0: 2020 2020 2020 2020 2062 792c 0a20 2020           by,.   
+0002c1d0: 2020 2020 2020 2020 2061 7363 656e 6469           ascendi
+0002c1e0: 6e67 3d61 7363 656e 6469 6e67 2c0a 2020  ng=ascending,.  
+0002c1f0: 2020 2020 2020 2020 2020 6e70 6172 7469            nparti
+0002c200: 7469 6f6e 733d 6e70 6172 7469 7469 6f6e  tions=npartition
+0002c210: 732c 0a20 2020 2020 2020 2020 2020 206e  s,.            n
+0002c220: 615f 706f 7369 7469 6f6e 3d6e 615f 706f  a_position=na_po
+0002c230: 7369 7469 6f6e 2c0a 2020 2020 2020 2020  sition,.        
+0002c240: 2020 2020 736f 7274 5f66 756e 6374 696f      sort_functio
+0002c250: 6e3d 736f 7274 5f66 756e 6374 696f 6e2c  n=sort_function,
+0002c260: 0a20 2020 2020 2020 2020 2020 2073 6f72  .            sor
+0002c270: 745f 6675 6e63 7469 6f6e 5f6b 7761 7267  t_function_kwarg
+0002c280: 733d 736f 7274 5f66 756e 6374 696f 6e5f  s=sort_function_
+0002c290: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+0002c2a0: 2020 2020 2a2a 6b77 6172 6773 2c0a 2020      **kwargs,.  
+0002c2b0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+0002c2c0: 2073 6574 5f69 6e64 6578 280a 2020 2020   set_index(.    
+0002c2d0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0002c2e0: 2020 6f74 6865 723a 2073 7472 207c 2053    other: str | S
+0002c2f0: 6572 6965 732c 0a20 2020 2020 2020 2064  eries,.        d
+0002c300: 726f 703a 2062 6f6f 6c20 3d20 5472 7565  rop: bool = True
+0002c310: 2c0a 2020 2020 2020 2020 736f 7274 6564  ,.        sorted
+0002c320: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+0002c330: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
+0002c340: 6f6e 733a 2069 6e74 207c 204c 6974 6572  ons: int | Liter
+0002c350: 616c 5b22 6175 746f 225d 207c 204e 6f6e  al["auto"] | Non
+0002c360: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
+0002c370: 2020 6469 7669 7369 6f6e 733a 2053 6571    divisions: Seq
+0002c380: 7565 6e63 6520 7c20 4e6f 6e65 203d 204e  uence | None = N
+0002c390: 6f6e 652c 0a20 2020 2020 2020 2069 6e70  one,.        inp
+0002c3a0: 6c61 6365 3a20 626f 6f6c 203d 2046 616c  lace: bool = Fal
+0002c3b0: 7365 2c0a 2020 2020 2020 2020 736f 7274  se,.        sort
+0002c3c0: 3a20 626f 6f6c 203d 2054 7275 652c 0a20  : bool = True,. 
+0002c3d0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
+0002c3e0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+0002c3f0: 2222 2253 6574 2074 6865 2044 6174 6146  """Set the DataF
+0002c400: 7261 6d65 2069 6e64 6578 2028 726f 7720  rame index (row 
+0002c410: 6c61 6265 6c73 2920 7573 696e 6720 616e  labels) using an
+0002c420: 2065 7869 7374 696e 6720 636f 6c75 6d6e   existing column
+0002c430: 2e0a 0a20 2020 2020 2020 2049 6620 6060  ...        If ``
+0002c440: 736f 7274 3d46 616c 7365 6060 2c20 7468  sort=False``, th
+0002c450: 6973 2066 756e 6374 696f 6e20 6f70 6572  is function oper
+0002c460: 6174 6573 2065 7861 6374 6c79 206c 696b  ates exactly lik
+0002c470: 6520 6060 7061 6e64 6173 2e73 6574 5f69  e ``pandas.set_i
+0002c480: 6e64 6578 6060 0a20 2020 2020 2020 2061  ndex``.        a
+0002c490: 6e64 2073 6574 7320 7468 6520 696e 6465  nd sets the inde
+0002c4a0: 7820 6f6e 2074 6865 2044 6174 6146 7261  x on the DataFra
+0002c4b0: 6d65 2e20 4966 2060 6073 6f72 743d 5472  me. If ``sort=Tr
+0002c4c0: 7565 6060 2028 6465 6661 756c 7429 2c0a  ue`` (default),.
+0002c4d0: 2020 2020 2020 2020 7468 6973 2066 756e          this fun
+0002c4e0: 6374 696f 6e20 616c 736f 2073 6f72 7473  ction also sorts
+0002c4f0: 2074 6865 2044 6174 6146 7261 6d65 2062   the DataFrame b
+0002c500: 7920 7468 6520 6e65 7720 696e 6465 782e  y the new index.
+0002c510: 2054 6869 7320 6361 6e20 6861 7665 2061   This can have a
+0002c520: 0a20 2020 2020 2020 2073 6967 6e69 6669  .        signifi
+0002c530: 6361 6e74 2069 6d70 6163 7420 6f6e 2070  cant impact on p
+0002c540: 6572 666f 726d 616e 6365 2c20 6265 6361  erformance, beca
+0002c550: 7573 6520 6a6f 696e 732c 2067 726f 7570  use joins, group
+0002c560: 6279 732c 206c 6f6f 6b75 7073 2c20 6574  bys, lookups, et
+0002c570: 632e 0a20 2020 2020 2020 2061 7265 2061  c..        are a
+0002c580: 6c6c 206d 7563 6820 6661 7374 6572 206f  ll much faster o
+0002c590: 6e20 7468 6174 2063 6f6c 756d 6e2e 2048  n that column. H
+0002c5a0: 6f77 6576 6572 2c20 7468 6973 2070 6572  owever, this per
+0002c5b0: 666f 726d 616e 6365 2069 6e63 7265 6173  formance increas
+0002c5c0: 650a 2020 2020 2020 2020 636f 6d65 7320  e.        comes 
+0002c5d0: 7769 7468 2061 2063 6f73 742c 2073 6f72  with a cost, sor
+0002c5e0: 7469 6e67 2061 2070 6172 616c 6c65 6c20  ting a parallel 
+0002c5f0: 6461 7461 7365 7420 7265 7175 6972 6573  dataset requires
+0002c600: 2065 7870 656e 7369 7665 2073 6875 6666   expensive shuff
+0002c610: 6c65 732e 0a20 2020 2020 2020 204f 6674  les..        Oft
+0002c620: 656e 2077 6520 6060 7365 745f 696e 6465  en we ``set_inde
+0002c630: 7860 6020 6f6e 6365 2064 6972 6563 746c  x`` once directl
+0002c640: 7920 6166 7465 7220 6461 7461 2069 6e67  y after data ing
+0002c650: 6573 7420 616e 6420 6669 6c74 6572 696e  est and filterin
+0002c660: 6720 616e 640a 2020 2020 2020 2020 7468  g and.        th
+0002c670: 656e 2070 6572 666f 726d 206d 616e 7920  en perform many 
+0002c680: 6368 6561 7020 636f 6d70 7574 6174 696f  cheap computatio
+0002c690: 6e73 206f 6666 206f 6620 7468 6520 736f  ns off of the so
+0002c6a0: 7274 6564 2064 6174 6173 6574 2e0a 0a20  rted dataset... 
+0002c6b0: 2020 2020 2020 2057 6974 6820 6060 736f         With ``so
+0002c6c0: 7274 3d54 7275 6560 602c 2074 6869 7320  rt=True``, this 
+0002c6d0: 6675 6e63 7469 6f6e 2069 7320 6d75 6368  function is much
+0002c6e0: 206d 6f72 6520 6578 7065 6e73 6976 652e   more expensive.
+0002c6f0: 2055 6e64 6572 206e 6f72 6d61 6c0a 2020   Under normal.  
+0002c700: 2020 2020 2020 6f70 6572 6174 696f 6e20        operation 
+0002c710: 7468 6973 2066 756e 6374 696f 6e20 646f  this function do
+0002c720: 6573 2061 6e20 696e 6974 6961 6c20 7061  es an initial pa
+0002c730: 7373 206f 7665 7220 7468 6520 696e 6465  ss over the inde
+0002c740: 7820 636f 6c75 6d6e 2074 6f0a 2020 2020  x column to.    
+0002c750: 2020 2020 636f 6d70 7574 6520 6170 7072      compute appr
+0002c760: 6f78 696d 6174 6520 7175 616e 7469 6c65  oximate quantile
+0002c770: 7320 746f 2073 6572 7665 2061 7320 6675  s to serve as fu
+0002c780: 7475 7265 2064 6976 6973 696f 6e73 2e20  ture divisions. 
+0002c790: 4974 2074 6865 6e20 7061 7373 6573 0a20  It then passes. 
+0002c7a0: 2020 2020 2020 206f 7665 7220 7468 6520         over the 
+0002c7b0: 6461 7461 2061 2073 6563 6f6e 6420 7469  data a second ti
+0002c7c0: 6d65 2c20 7370 6c69 7474 696e 6720 7570  me, splitting up
+0002c7d0: 2065 6163 6820 696e 7075 7420 7061 7274   each input part
+0002c7e0: 6974 696f 6e20 696e 746f 2073 6576 6572  ition into sever
+0002c7f0: 616c 0a20 2020 2020 2020 2070 6965 6365  al.        piece
+0002c800: 7320 616e 6420 7368 6172 696e 6720 7468  s and sharing th
+0002c810: 6f73 6520 7069 6563 6573 2074 6f20 616c  ose pieces to al
+0002c820: 6c20 6f66 2074 6865 206f 7574 7075 7420  l of the output 
+0002c830: 7061 7274 6974 696f 6e73 206e 6f77 2069  partitions now i
+0002c840: 6e0a 2020 2020 2020 2020 736f 7274 6564  n.        sorted
+0002c850: 206f 7264 6572 2e0a 0a20 2020 2020 2020   order...       
+0002c860: 2049 6e20 736f 6d65 2063 6173 6573 2077   In some cases w
+0002c870: 6520 6361 6e20 616c 6c65 7669 6174 6520  e can alleviate 
+0002c880: 7468 6f73 6520 636f 7374 732c 2066 6f72  those costs, for
+0002c890: 2065 7861 6d70 6c65 2069 6620 796f 7572   example if your
+0002c8a0: 2064 6174 6173 6574 2069 730a 2020 2020   dataset is.    
+0002c8b0: 2020 2020 736f 7274 6564 2061 6c72 6561      sorted alrea
+0002c8c0: 6479 2074 6865 6e20 7765 2063 616e 2061  dy then we can a
+0002c8d0: 766f 6964 206d 616b 696e 6720 6d61 6e79  void making many
+0002c8e0: 2073 6d61 6c6c 2070 6965 6365 7320 6f72   small pieces or
+0002c8f0: 2069 6620 796f 7520 6b6e 6f77 0a20 2020   if you know.   
+0002c900: 2020 2020 2067 6f6f 6420 7661 6c75 6573       good values
+0002c910: 2074 6f20 7370 6c69 7420 7468 6520 6e65   to split the ne
+0002c920: 7720 696e 6465 7820 636f 6c75 6d6e 2074  w index column t
+0002c930: 6865 6e20 7765 2063 616e 2061 766f 6964  hen we can avoid
+0002c940: 2074 6865 2069 6e69 7469 616c 0a20 2020   the initial.   
+0002c950: 2020 2020 2070 6173 7320 6f76 6572 2074       pass over t
+0002c960: 6865 2064 6174 612e 2046 6f72 2065 7861  he data. For exa
+0002c970: 6d70 6c65 2069 6620 796f 7572 206e 6577  mple if your new
+0002c980: 2069 6e64 6578 2069 7320 6120 6461 7465   index is a date
+0002c990: 7469 6d65 2069 6e64 6578 2061 6e64 0a20  time index and. 
+0002c9a0: 2020 2020 2020 2079 6f75 7220 6461 7461         your data
+0002c9b0: 2069 7320 616c 7265 6164 7920 736f 7274   is already sort
+0002c9c0: 6564 2062 7920 6461 7920 7468 656e 2074  ed by day then t
+0002c9d0: 6869 7320 656e 7469 7265 206f 7065 7261  his entire opera
+0002c9e0: 7469 6f6e 2063 616e 2062 6520 646f 6e65  tion can be done
+0002c9f0: 0a20 2020 2020 2020 2066 6f72 2066 7265  .        for fre
+0002ca00: 652e 2059 6f75 2063 616e 2063 6f6e 7472  e. You can contr
+0002ca10: 6f6c 2074 6865 7365 206f 7074 696f 6e73  ol these options
+0002ca20: 2077 6974 6820 7468 6520 666f 6c6c 6f77   with the follow
+0002ca30: 696e 6720 7061 7261 6d65 7465 7273 2e0a  ing parameters..
+0002ca40: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0002ca50: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+0002ca60: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206f  ------.        o
+0002ca70: 7468 6572 3a20 7374 7269 6e67 206f 7220  ther: string or 
+0002ca80: 4461 736b 2053 6572 6965 730a 2020 2020  Dask Series.    
+0002ca90: 2020 2020 2020 2020 436f 6c75 6d6e 2074          Column t
+0002caa0: 6f20 7573 6520 6173 2069 6e64 6578 2e0a  o use as index..
+0002cab0: 2020 2020 2020 2020 6472 6f70 3a20 626f          drop: bo
+0002cac0: 6f6c 6561 6e2c 2064 6566 6175 6c74 2054  olean, default T
+0002cad0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+0002cae0: 4465 6c65 7465 2063 6f6c 756d 6e20 746f  Delete column to
+0002caf0: 2062 6520 7573 6564 2061 7320 7468 6520   be used as the 
+0002cb00: 6e65 7720 696e 6465 782e 0a20 2020 2020  new index..     
+0002cb10: 2020 2073 6f72 7465 643a 2062 6f6f 6c2c     sorted: bool,
+0002cb20: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0002cb30: 2020 2020 2020 4966 2074 6865 2069 6e64        If the ind
+0002cb40: 6578 2063 6f6c 756d 6e20 6973 2061 6c72  ex column is alr
+0002cb50: 6561 6479 2073 6f72 7465 6420 696e 2069  eady sorted in i
+0002cb60: 6e63 7265 6173 696e 6720 6f72 6465 722e  ncreasing order.
+0002cb70: 0a20 2020 2020 2020 2020 2020 2044 6566  .            Def
+0002cb80: 6175 6c74 7320 746f 2046 616c 7365 0a20  aults to False. 
+0002cb90: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
+0002cba0: 6e73 3a20 696e 742c 204e 6f6e 652c 206f  ns: int, None, o
+0002cbb0: 7220 2761 7574 6f27 0a20 2020 2020 2020  r 'auto'.       
+0002cbc0: 2020 2020 2054 6865 2069 6465 616c 206e       The ideal n
+0002cbd0: 756d 6265 7220 6f66 206f 7574 7075 7420  umber of output 
+0002cbe0: 7061 7274 6974 696f 6e73 2e20 4966 204e  partitions. If N
+0002cbf0: 6f6e 652c 2075 7365 2074 6865 2073 616d  one, use the sam
+0002cc00: 6520 6173 0a20 2020 2020 2020 2020 2020  e as.           
+0002cc10: 2074 6865 2069 6e70 7574 2e20 4966 2027   the input. If '
+0002cc20: 6175 746f 2720 7468 656e 2064 6563 6964  auto' then decid
+0002cc30: 6520 6279 206d 656d 6f72 7920 7573 652e  e by memory use.
+0002cc40: 0a20 2020 2020 2020 2020 2020 204f 6e6c  .            Onl
+0002cc50: 7920 7573 6564 2077 6865 6e20 6060 6469  y used when ``di
+0002cc60: 7669 7369 6f6e 7360 6020 6973 206e 6f74  visions`` is not
+0002cc70: 2067 6976 656e 2e20 4966 2060 6064 6976   given. If ``div
+0002cc80: 6973 696f 6e73 6060 2069 7320 6769 7665  isions`` is give
+0002cc90: 6e2c 0a20 2020 2020 2020 2020 2020 2074  n,.            t
+0002cca0: 6865 206e 756d 6265 7220 6f66 206f 7574  he number of out
+0002ccb0: 7075 7420 7061 7274 6974 696f 6e73 2077  put partitions w
+0002ccc0: 696c 6c20 6265 2060 606c 656e 2864 6976  ill be ``len(div
+0002ccd0: 6973 696f 6e73 2920 2d20 3160 602e 0a20  isions) - 1``.. 
+0002cce0: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
+0002ccf0: 3a20 6c69 7374 2c20 6f70 7469 6f6e 616c  : list, optional
+0002cd00: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+0002cd10: 2022 6469 7669 6469 6e67 206c 696e 6573   "dividing lines
+0002cd20: 2220 7573 6564 2074 6f20 7370 6c69 7420  " used to split 
+0002cd30: 7468 6520 6e65 7720 696e 6465 7820 696e  the new index in
+0002cd40: 746f 2070 6172 7469 7469 6f6e 732e 0a20  to partitions.. 
+0002cd50: 2020 2020 2020 2020 2020 2046 6f72 2060             For `
+0002cd60: 6064 6976 6973 696f 6e73 3d5b 302c 2031  `divisions=[0, 1
+0002cd70: 302c 2035 302c 2031 3030 5d60 602c 2074  0, 50, 100]``, t
+0002cd80: 6865 7265 2077 6f75 6c64 2062 6520 7468  here would be th
+0002cd90: 7265 6520 6f75 7470 7574 2070 6172 7469  ree output parti
+0002cda0: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
+0002cdb0: 2020 2077 6865 7265 2074 6865 206e 6577     where the new
+0002cdc0: 2069 6e64 6578 2063 6f6e 7461 696e 6564   index contained
+0002cdd0: 205b 302c 2031 3029 2c20 5b31 302c 2035   [0, 10), [10, 5
+0002cde0: 3029 2c20 616e 6420 5b35 302c 2031 3030  0), and [50, 100
+0002cdf0: 292c 2072 6573 7065 6374 6976 656c 792e  ), respectively.
+0002ce00: 0a20 2020 2020 2020 2020 2020 2053 6565  .            See
+0002ce10: 2068 7474 7073 3a2f 2f64 6f63 732e 6461   https://docs.da
+0002ce20: 736b 2e6f 7267 2f65 6e2f 6c61 7465 7374  sk.org/en/latest
+0002ce30: 2f64 6174 6166 7261 6d65 2d64 6573 6967  /dataframe-desig
+0002ce40: 6e2e 6874 6d6c 2370 6172 7469 7469 6f6e  n.html#partition
+0002ce50: 732e 0a20 2020 2020 2020 2020 2020 2049  s..            I
+0002ce60: 6620 6e6f 7420 6769 7665 6e20 2864 6566  f not given (def
+0002ce70: 6175 6c74 292c 2067 6f6f 6420 6469 7669  ault), good divi
+0002ce80: 7369 6f6e 7320 6172 6520 6361 6c63 756c  sions are calcul
+0002ce90: 6174 6564 2062 7920 696d 6d65 6469 6174  ated by immediat
+0002cea0: 656c 7920 636f 6d70 7574 696e 670a 2020  ely computing.  
+0002ceb0: 2020 2020 2020 2020 2020 7468 6520 6461            the da
+0002cec0: 7461 2061 6e64 206c 6f6f 6b69 6e67 2061  ta and looking a
+0002ced0: 7420 7468 6520 6469 7374 7269 6275 7469  t the distributi
+0002cee0: 6f6e 206f 6620 6974 7320 7661 6c75 6573  on of its values
+0002cef0: 2e20 466f 7220 6c61 7267 6520 6461 7461  . For large data
+0002cf00: 7365 7473 2c0a 2020 2020 2020 2020 2020  sets,.          
+0002cf10: 2020 7468 6973 2063 616e 2062 6520 6578    this can be ex
+0002cf20: 7065 6e73 6976 652e 0a20 2020 2020 2020  pensive..       
+0002cf30: 2020 2020 204e 6f74 6520 7468 6174 2069       Note that i
+0002cf40: 6620 6060 736f 7274 6564 3d54 7275 6560  f ``sorted=True`
+0002cf50: 602c 2073 7065 6369 6669 6564 2064 6976  `, specified div
+0002cf60: 6973 696f 6e73 2061 7265 2061 7373 756d  isions are assum
+0002cf70: 6564 2074 6f20 6d61 7463 680a 2020 2020  ed to match.    
+0002cf80: 2020 2020 2020 2020 7468 6520 6578 6973          the exis
+0002cf90: 7469 6e67 2070 6172 7469 7469 6f6e 7320  ting partitions 
+0002cfa0: 696e 2074 6865 2064 6174 613b 2069 6620  in the data; if 
+0002cfb0: 7468 6973 2069 7320 756e 7472 7565 2079  this is untrue y
+0002cfc0: 6f75 2073 686f 756c 640a 2020 2020 2020  ou should.      
+0002cfd0: 2020 2020 2020 6c65 6176 6520 6469 7669        leave divi
+0002cfe0: 7369 6f6e 7320 656d 7074 7920 616e 6420  sions empty and 
+0002cff0: 6361 6c6c 2060 6072 6570 6172 7469 7469  call ``repartiti
+0002d000: 6f6e 6060 2061 6674 6572 2060 6073 6574  on`` after ``set
+0002d010: 5f69 6e64 6578 6060 2e0a 2020 2020 2020  _index``..      
+0002d020: 2020 696e 706c 6163 653a 2062 6f6f 6c2c    inplace: bool,
+0002d030: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0002d040: 2020 2020 2020 4d6f 6469 6679 696e 6720        Modifying 
+0002d050: 7468 6520 4461 7461 4672 616d 6520 696e  the DataFrame in
+0002d060: 2070 6c61 6365 2069 7320 6e6f 7420 7375   place is not su
+0002d070: 7070 6f72 7465 6420 6279 2044 6173 6b2e  pported by Dask.
+0002d080: 0a20 2020 2020 2020 2020 2020 2044 6566  .            Def
+0002d090: 6175 6c74 7320 746f 2046 616c 7365 2e0a  aults to False..
+0002d0a0: 2020 2020 2020 2020 736f 7274 3a20 626f          sort: bo
+0002d0b0: 6f6c 2c20 6f70 7469 6f6e 616c 0a20 2020  ol, optional.   
+0002d0c0: 2020 2020 2020 2020 2049 6620 6060 5472           If ``Tr
+0002d0d0: 7565 6060 2c20 736f 7274 2074 6865 2044  ue``, sort the D
+0002d0e0: 6174 6146 7261 6d65 2062 7920 7468 6520  ataFrame by the 
+0002d0f0: 6e65 7720 696e 6465 782e 204f 7468 6572  new index. Other
+0002d100: 7769 7365 0a20 2020 2020 2020 2020 2020  wise.           
+0002d110: 2073 6574 2074 6865 2069 6e64 6578 206f   set the index o
+0002d120: 6e20 7468 6520 696e 6469 7669 6475 616c  n the individual
+0002d130: 2065 7869 7374 696e 6720 7061 7274 6974   existing partit
+0002d140: 696f 6e73 2e0a 2020 2020 2020 2020 2020  ions..          
+0002d150: 2020 4465 6661 756c 7473 2074 6f20 6060    Defaults to ``
+0002d160: 5472 7565 6060 2e0a 2020 2020 2020 2020  True``..        
+0002d170: 7368 7566 666c 653a 2073 7472 696e 672c  shuffle: string,
+0002d180: 2027 6469 736b 2720 6f72 2027 7461 736b   'disk' or 'task
+0002d190: 7327 2c20 6f70 7469 6f6e 616c 0a20 2020  s', optional.   
+0002d1a0: 2020 2020 2020 2020 2045 6974 6865 7220           Either 
+0002d1b0: 6060 2764 6973 6b27 6060 2066 6f72 2073  ``'disk'`` for s
+0002d1c0: 696e 676c 652d 6e6f 6465 206f 7065 7261  ingle-node opera
+0002d1d0: 7469 6f6e 206f 7220 6060 2774 6173 6b73  tion or ``'tasks
+0002d1e0: 2760 6020 666f 720a 2020 2020 2020 2020  '`` for.        
+0002d1f0: 2020 2020 6469 7374 7269 6275 7465 6420      distributed 
+0002d200: 6f70 6572 6174 696f 6e2e 2020 5769 6c6c  operation.  Will
+0002d210: 2062 6520 696e 6665 7272 6564 2062 7920   be inferred by 
+0002d220: 796f 7572 2063 7572 7265 6e74 2073 6368  your current sch
+0002d230: 6564 756c 6572 2e0a 2020 2020 2020 2020  eduler..        
+0002d240: 636f 6d70 7574 653a 2062 6f6f 6c2c 2064  compute: bool, d
+0002d250: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
+0002d260: 2020 2020 2020 2020 2057 6865 7468 6572           Whether
+0002d270: 206f 7220 6e6f 7420 746f 2074 7269 6767   or not to trigg
+0002d280: 6572 2061 6e20 696d 6d65 6469 6174 6520  er an immediate 
+0002d290: 636f 6d70 7574 6174 696f 6e2e 2044 6566  computation. Def
+0002d2a0: 6175 6c74 7320 746f 2046 616c 7365 2e0a  aults to False..
+0002d2b0: 2020 2020 2020 2020 2020 2020 4e6f 7465              Note
+0002d2c0: 2c20 7468 6174 2065 7665 6e20 6966 2079  , that even if y
+0002d2d0: 6f75 2073 6574 2060 6063 6f6d 7075 7465  ou set ``compute
+0002d2e0: 3d46 616c 7365 6060 2c20 616e 2069 6d6d  =False``, an imm
+0002d2f0: 6564 6961 7465 2063 6f6d 7075 7461 7469  ediate computati
+0002d300: 6f6e 0a20 2020 2020 2020 2020 2020 2077  on.            w
+0002d310: 696c 6c20 7374 696c 6c20 6265 2074 7269  ill still be tri
+0002d320: 6767 6572 6564 2069 6620 6060 6469 7669  ggered if ``divi
+0002d330: 7369 6f6e 7360 6020 6973 2060 604e 6f6e  sions`` is ``Non
+0002d340: 6560 602e 0a20 2020 2020 2020 2070 6172  e``..        par
+0002d350: 7469 7469 6f6e 5f73 697a 653a 2069 6e74  tition_size: int
+0002d360: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0002d370: 2020 2020 2020 2044 6573 6972 6564 2073         Desired s
+0002d380: 697a 6520 6f66 2065 6163 6820 7061 7274  ize of each part
+0002d390: 6974 696f 6e73 2069 6e20 6279 7465 732e  itions in bytes.
+0002d3a0: 0a20 2020 2020 2020 2020 2020 204f 6e6c  .            Onl
+0002d3b0: 7920 7573 6564 2077 6865 6e20 6060 6e70  y used when ``np
+0002d3c0: 6172 7469 7469 6f6e 733d 2761 7574 6f27  artitions='auto'
+0002d3d0: 6060 0a0a 2020 2020 2020 2020 4578 616d  ``..        Exam
+0002d3e0: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
+0002d3f0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
+0002d400: 3e20 696d 706f 7274 2064 6173 6b0a 2020  > import dask.  
+0002d410: 2020 2020 2020 3e3e 3e20 6464 6620 3d20        >>> ddf = 
+0002d420: 6461 736b 2e64 6174 6173 6574 732e 7469  dask.datasets.ti
+0002d430: 6d65 7365 7269 6573 2873 7461 7274 3d22  meseries(start="
+0002d440: 3230 3231 2d30 312d 3031 222c 2065 6e64  2021-01-01", end
+0002d450: 3d22 3230 3231 2d30 312d 3037 222c 2066  ="2021-01-07", f
+0002d460: 7265 713d 2231 4822 292e 7265 7365 745f  req="1H").reset_
+0002d470: 696e 6465 7828 290a 2020 2020 2020 2020  index().        
+0002d480: 3e3e 3e20 6464 6632 203d 2064 6466 2e73  >>> ddf2 = ddf.s
+0002d490: 6574 5f69 6e64 6578 2822 7822 290a 2020  et_index("x").  
+0002d4a0: 2020 2020 2020 3e3e 3e20 6464 6632 203d        >>> ddf2 =
+0002d4b0: 2064 6466 2e73 6574 5f69 6e64 6578 2864   ddf.set_index(d
+0002d4c0: 6466 2e78 290a 2020 2020 2020 2020 3e3e  df.x).        >>
+0002d4d0: 3e20 6464 6632 203d 2064 6466 2e73 6574  > ddf2 = ddf.set
+0002d4e0: 5f69 6e64 6578 2864 6466 2e74 696d 6573  _index(ddf.times
+0002d4f0: 7461 6d70 2c20 736f 7274 6564 3d54 7275  tamp, sorted=Tru
+0002d500: 6529 0a0a 2020 2020 2020 2020 4120 636f  e)..        A co
+0002d510: 6d6d 6f6e 2063 6173 6520 6973 2077 6865  mmon case is whe
+0002d520: 6e20 7765 2068 6176 6520 6120 6461 7465  n we have a date
+0002d530: 7469 6d65 2063 6f6c 756d 6e20 7468 6174  time column that
+0002d540: 2077 6520 6b6e 6f77 2074 6f20 6265 0a20   we know to be. 
+0002d550: 2020 2020 2020 2073 6f72 7465 6420 616e         sorted an
+0002d560: 6420 6973 2063 6c65 616e 6c79 2064 6976  d is cleanly div
+0002d570: 6964 6564 2062 7920 6461 792e 2020 5765  ided by day.  We
+0002d580: 2063 616e 2073 6574 2074 6869 7320 696e   can set this in
+0002d590: 6465 7820 666f 7220 6672 6565 0a20 2020  dex for free.   
+0002d5a0: 2020 2020 2062 7920 7370 6563 6966 7969       by specifyi
+0002d5b0: 6e67 2062 6f74 6820 7468 6174 2074 6865  ng both that the
+0002d5c0: 2063 6f6c 756d 6e20 6973 2070 7265 2d73   column is pre-s
+0002d5d0: 6f72 7465 6420 616e 6420 7468 6520 7061  orted and the pa
+0002d5e0: 7274 6963 756c 6172 0a20 2020 2020 2020  rticular.       
+0002d5f0: 2064 6976 6973 696f 6e73 2061 6c6f 6e67   divisions along
+0002d600: 2077 6869 6368 2069 7320 6973 2073 6570   which is is sep
+0002d610: 6172 6174 6564 0a0a 2020 2020 2020 2020  arated..        
+0002d620: 3e3e 3e20 696d 706f 7274 2070 616e 6461  >>> import panda
+0002d630: 7320 6173 2070 640a 2020 2020 2020 2020  s as pd.        
+0002d640: 3e3e 3e20 6469 7669 7369 6f6e 7320 3d20  >>> divisions = 
+0002d650: 7064 2e64 6174 655f 7261 6e67 6528 7374  pd.date_range(st
+0002d660: 6172 743d 2232 3032 312d 3031 2d30 3122  art="2021-01-01"
+0002d670: 2c20 656e 643d 2232 3032 312d 3031 2d30  , end="2021-01-0
+0002d680: 3722 2c20 6672 6571 3d27 3144 2729 0a20  7", freq='1D'). 
+0002d690: 2020 2020 2020 203e 3e3e 2064 6976 6973         >>> divis
+0002d6a0: 696f 6e73 0a20 2020 2020 2020 2044 6174  ions.        Dat
+0002d6b0: 6574 696d 6549 6e64 6578 285b 2732 3032  etimeIndex(['202
+0002d6c0: 312d 3031 2d30 3127 2c20 2732 3032 312d  1-01-01', '2021-
+0002d6d0: 3031 2d30 3227 2c20 2732 3032 312d 3031  01-02', '2021-01
+0002d6e0: 2d30 3327 2c20 2732 3032 312d 3031 2d30  -03', '2021-01-0
+0002d6f0: 3427 2c0a 2020 2020 2020 2020 2020 2020  4',.            
+0002d700: 2020 2020 2020 2020 2020 2027 3230 3231             '2021
+0002d710: 2d30 312d 3035 272c 2027 3230 3231 2d30  -01-05', '2021-0
+0002d720: 312d 3036 272c 2027 3230 3231 2d30 312d  1-06', '2021-01-
+0002d730: 3037 275d 2c0a 2020 2020 2020 2020 2020  07'],.          
+0002d740: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
+0002d750: 653d 2764 6174 6574 696d 6536 345b 6e73  e='datetime64[ns
+0002d760: 5d27 2c20 6672 6571 3d27 4427 290a 0a20  ]', freq='D').. 
+0002d770: 2020 2020 2020 204e 6f74 6520 7468 6174         Note that
+0002d780: 2060 606c 656e 2864 6976 6973 6f6e 7329   ``len(divisons)
+0002d790: 6060 2069 7320 6571 7561 6c20 746f 2060  `` is equal to `
+0002d7a0: 606e 7061 7274 6974 696f 6e73 202b 2031  `npartitions + 1
+0002d7b0: 6060 2e20 5468 6973 2069 7320 6265 6361  ``. This is beca
+0002d7c0: 7573 6520 6060 6469 7669 7369 6f6e 7360  use ``divisions`
+0002d7d0: 600a 2020 2020 2020 2020 7265 7072 6573  `.        repres
+0002d7e0: 656e 7473 2074 6865 2075 7070 6572 2061  ents the upper a
+0002d7f0: 6e64 206c 6f77 6572 2062 6f75 6e64 7320  nd lower bounds 
+0002d800: 6f66 2065 6163 6820 7061 7274 6974 696f  of each partitio
+0002d810: 6e2e 2054 6865 2066 6972 7374 2069 7465  n. The first ite
+0002d820: 6d20 6973 2074 6865 0a20 2020 2020 2020  m is the.       
+0002d830: 206c 6f77 6572 2062 6f75 6e64 206f 6620   lower bound of 
+0002d840: 7468 6520 6669 7273 7420 7061 7274 6974  the first partit
+0002d850: 696f 6e2c 2074 6865 2073 6563 6f6e 6420  ion, the second 
+0002d860: 6974 656d 2069 7320 7468 6520 6c6f 7765  item is the lowe
+0002d870: 7220 626f 756e 6420 6f66 2074 6865 0a20  r bound of the. 
+0002d880: 2020 2020 2020 2073 6563 6f6e 6420 7061         second pa
+0002d890: 7274 6974 696f 6e20 616e 6420 7468 6520  rtition and the 
+0002d8a0: 7570 7065 7220 626f 756e 6420 6f66 2074  upper bound of t
+0002d8b0: 6865 2066 6972 7374 2070 6172 7469 7469  he first partiti
+0002d8c0: 6f6e 2c20 616e 6420 736f 206f 6e2e 0a20  on, and so on.. 
+0002d8d0: 2020 2020 2020 2054 6865 2073 6563 6f6e         The secon
+0002d8e0: 642d 746f 2d6c 6173 7420 6974 656d 2069  d-to-last item i
+0002d8f0: 7320 7468 6520 6c6f 7765 7220 626f 756e  s the lower boun
+0002d900: 6420 6f66 2074 6865 206c 6173 7420 7061  d of the last pa
+0002d910: 7274 6974 696f 6e2c 2061 6e64 2074 6865  rtition, and the
+0002d920: 206c 6173 740a 2020 2020 2020 2020 2865   last.        (e
+0002d930: 7874 7261 2920 6974 656d 2069 7320 7468  xtra) item is th
+0002d940: 6520 7570 7065 7220 626f 756e 6420 6f66  e upper bound of
+0002d950: 2074 6865 206c 6173 7420 7061 7274 6974   the last partit
+0002d960: 696f 6e2e 0a0a 2020 2020 2020 2020 3e3e  ion...        >>
+0002d970: 3e20 6464 6632 203d 2064 6466 2e73 6574  > ddf2 = ddf.set
+0002d980: 5f69 6e64 6578 2822 7469 6d65 7374 616d  _index("timestam
+0002d990: 7022 2c20 736f 7274 6564 3d54 7275 652c  p", sorted=True,
+0002d9a0: 2064 6976 6973 696f 6e73 3d64 6976 6973   divisions=divis
+0002d9b0: 696f 6e73 2e74 6f6c 6973 7428 2929 0a0a  ions.tolist())..
+0002d9c0: 2020 2020 2020 2020 4966 2079 6f75 276c          If you'l
+0002d9d0: 6c20 6265 2072 756e 6e69 6e67 2060 7365  l be running `se
+0002d9e0: 745f 696e 6465 7860 206f 6e20 7468 6520  t_index` on the 
+0002d9f0: 7361 6d65 2028 6f72 2073 696d 696c 6172  same (or similar
+0002da00: 2920 6461 7461 7365 7473 2072 6570 6561  ) datasets repea
+0002da10: 7465 646c 792c 0a20 2020 2020 2020 2079  tedly,.        y
+0002da20: 6f75 2063 6f75 6c64 2073 6176 6520 7469  ou could save ti
+0002da30: 6d65 2062 7920 6c65 7474 696e 6720 4461  me by letting Da
+0002da40: 736b 2063 616c 6375 6c61 7465 2067 6f6f  sk calculate goo
+0002da50: 6420 6469 7669 7369 6f6e 7320 6f6e 6365  d divisions once
+0002da60: 2c20 7468 656e 2063 6f70 792d 7061 7374  , then copy-past
+0002da70: 696e 670a 2020 2020 2020 2020 7468 656d  ing.        them
+0002da80: 2074 6f20 7265 7573 652e 2054 6869 7320   to reuse. This 
+0002da90: 6973 2065 7370 6563 6961 6c6c 7920 6865  is especially he
+0002daa0: 6c70 6675 6c20 7275 6e6e 696e 6720 696e  lpful running in
+0002dab0: 2061 204a 7570 7974 6572 206e 6f74 6562   a Jupyter noteb
+0002dac0: 6f6f 6b3a 0a0a 2020 2020 2020 2020 3e3e  ook:..        >>
+0002dad0: 3e20 6464 6632 203d 2064 6466 2e73 6574  > ddf2 = ddf.set
+0002dae0: 5f69 6e64 6578 2822 6e61 6d65 2229 2020  _index("name")  
+0002daf0: 2320 736c 6f77 2c20 6361 6c63 756c 6174  # slow, calculat
+0002db00: 6573 2064 6174 6120 6469 7374 7269 6275  es data distribu
+0002db10: 7469 6f6e 0a20 2020 2020 2020 203e 3e3e  tion.        >>>
+0002db20: 2064 6466 322e 6469 7669 7369 6f6e 7320   ddf2.divisions 
+0002db30: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
+0002db40: 500a 2020 2020 2020 2020 5b22 416c 6963  P.        ["Alic
+0002db50: 6522 2c20 224c 6175 7261 222c 2022 5572  e", "Laura", "Ur
+0002db60: 7375 6c61 222c 2022 5a65 6c64 6122 5d0a  sula", "Zelda"].
+0002db70: 2020 2020 2020 2020 3e3e 3e20 2320 5e20          >>> # ^ 
+0002db80: 4e6f 7720 636f 7079 2d70 6173 7465 2074  Now copy-paste t
+0002db90: 6869 7320 616e 6420 6564 6974 2074 6865  his and edit the
+0002dba0: 206c 696e 6520 6162 6f76 6520 746f 3a0a   line above to:.
+0002dbb0: 2020 2020 2020 2020 3e3e 3e20 2320 6464          >>> # dd
+0002dbc0: 6632 203d 2064 6466 2e73 6574 5f69 6e64  f2 = ddf.set_ind
+0002dbd0: 6578 2822 6e61 6d65 222c 2064 6976 6973  ex("name", divis
+0002dbe0: 696f 6e73 3d5b 2241 6c69 6365 222c 2022  ions=["Alice", "
+0002dbf0: 4c61 7572 6122 2c20 2255 7273 756c 6122  Laura", "Ursula"
+0002dc00: 2c20 225a 656c 6461 225d 290a 2020 2020  , "Zelda"]).    
+0002dc10: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+0002dc20: 2069 6620 696e 706c 6163 653a 0a20 2020   if inplace:.   
+0002dc30: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+0002dc40: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+0002dc50: 6f72 2822 5468 6520 696e 706c 6163 653d  or("The inplace=
+0002dc60: 206b 6579 776f 7264 2069 7320 6e6f 7420   keyword is not 
+0002dc70: 7375 7070 6f72 7465 6422 290a 2020 2020  supported").    
+0002dc80: 2020 2020 7072 655f 736f 7274 6564 203d      pre_sorted =
+0002dc90: 2073 6f72 7465 640a 2020 2020 2020 2020   sorted.        
+0002dca0: 6465 6c20 736f 7274 6564 0a0a 2020 2020  del sorted..    
+0002dcb0: 2020 2020 2320 4368 6563 6b20 6f74 6865      # Check othe
+0002dcc0: 7220 6361 6e20 6265 2074 7261 6e73 6c61  r can be transla
+0002dcd0: 7465 6420 746f 2063 6f6c 756d 6e20 6e61  ted to column na
+0002dce0: 6d65 206f 7220 636f 6c75 6d6e 206f 626a  me or column obj
+0002dcf0: 6563 742c 2070 6f73 7369 626c 7920 666c  ect, possibly fl
+0002dd00: 6174 7465 6e69 6e67 2069 740a 2020 2020  attening it.    
+0002dd10: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+0002dd20: 7461 6e63 6528 6f74 6865 722c 2073 7472  tance(other, str
+0002dd30: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
+0002dd40: 2049 7420 6d61 7920 7265 6665 7220 746f   It may refer to
+0002dd50: 2073 6576 6572 616c 2063 6f6c 756d 6e73   several columns
+0002dd60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0002dd70: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
+0002dd80: 2c20 5365 7175 656e 6365 293a 2020 2320  , Sequence):  # 
+0002dd90: 7479 7065 3a20 6967 6e6f 7265 5b75 6e72  type: ignore[unr
+0002dda0: 6561 6368 6162 6c65 5d0a 2020 2020 2020  eachable].      
+0002ddb0: 2020 2020 2020 2020 2020 2320 4163 6365            # Acce
+0002ddc0: 7074 205b 2261 225d 2c20 6275 7420 6e6f  pt ["a"], but no
+0002ddd0: 7420 5b5b 2261 225d 5d0a 2020 2020 2020  t [["a"]].      
+0002dde0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+0002ddf0: 286f 7468 6572 2920 3d3d 2031 2061 6e64  (other) == 1 and
+0002de00: 2028 2020 2320 7479 7065 3a20 6967 6e6f   (  # type: igno
+0002de10: 7265 5b75 6e72 6561 6368 6162 6c65 5d0a  re[unreachable].
+0002de20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002de30: 2020 2020 6973 696e 7374 616e 6365 286f      isinstance(o
+0002de40: 7468 6572 5b30 5d2c 2073 7472 2920 6f72  ther[0], str) or
+0002de50: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+0002de60: 6f74 6865 725b 305d 2c20 5365 7175 656e  other[0], Sequen
+0002de70: 6365 290a 2020 2020 2020 2020 2020 2020  ce).            
+0002de80: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+0002de90: 2020 2020 2020 2020 2020 206f 7468 6572             other
+0002dea0: 203d 206f 7468 6572 5b30 5d0a 2020 2020   = other[0].    
+0002deb0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0002dec0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002ded0: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+0002dee0: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+0002def0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002df00: 2020 2020 2020 2020 2022 4461 736b 2064           "Dask d
+0002df10: 6174 6166 7261 6d65 2064 6f65 7320 6e6f  ataframe does no
+0002df20: 7420 7965 7420 7375 7070 6f72 7420 6d75  t yet support mu
+0002df30: 6c74 692d 696e 6465 7865 732e 5c6e 220a  lti-indexes.\n".
+0002df40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002df50: 2020 2020 2020 2020 6622 596f 7520 7472          f"You tr
+0002df60: 6965 6420 746f 2069 6e64 6578 2077 6974  ied to index wit
+0002df70: 6820 7468 6973 2069 6e64 6578 3a20 7b6f  h this index: {o
+0002df80: 7468 6572 7d5c 6e22 0a20 2020 2020 2020  ther}\n".       
+0002df90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dfa0: 2022 496e 6465 7865 7320 6d75 7374 2062   "Indexes must b
+0002dfb0: 6520 7369 6e67 6c65 2063 6f6c 756d 6e73  e single columns
+0002dfc0: 206f 6e6c 792e 220a 2020 2020 2020 2020   only.".        
+0002dfd0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0002dfe0: 2020 2020 2020 2020 2020 2023 204f 7220             # Or 
+0002dff0: 6265 2061 2066 7261 6d65 2064 6972 6563  be a frame direc
+0002e000: 746c 790a 2020 2020 2020 2020 2020 2020  tly.            
+0002e010: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+0002e020: 6f74 6865 722c 2044 6174 6146 7261 6d65  other, DataFrame
+0002e030: 293a 2020 2320 7479 7065 3a20 6967 6e6f  ):  # type: igno
+0002e040: 7265 5b75 6e72 6561 6368 6162 6c65 5d0a  re[unreachable].
+0002e050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e060: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+0002e070: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
+0002e080: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002e090: 4461 736b 2064 6174 6166 7261 6d65 2064  Dask dataframe d
+0002e0a0: 6f65 7320 6e6f 7420 7965 7420 7375 7070  oes not yet supp
+0002e0b0: 6f72 7420 6d75 6c74 692d 696e 6465 7865  ort multi-indexe
+0002e0c0: 732e 5c6e 220a 2020 2020 2020 2020 2020  s.\n".          
+0002e0d0: 2020 2020 2020 2020 2020 6622 596f 7520            f"You 
+0002e0e0: 7472 6965 6420 746f 2069 6e64 6578 2077  tried to index w
+0002e0f0: 6974 6820 6120 6672 616d 6520 7769 7468  ith a frame with
+0002e100: 2074 6865 7365 2063 6f6c 756d 6e73 3a20   these columns: 
+0002e110: 7b6c 6973 7428 6f74 6865 722e 636f 6c75  {list(other.colu
+0002e120: 6d6e 7329 7d5c 6e22 0a20 2020 2020 2020  mns)}\n".       
+0002e130: 2020 2020 2020 2020 2020 2020 2022 496e               "In
+0002e140: 6465 7865 7320 6d75 7374 2062 6520 7369  dexes must be si
+0002e150: 6e67 6c65 2063 6f6c 756d 6e73 206f 6e6c  ngle columns onl
+0002e160: 792e 220a 2020 2020 2020 2020 2020 2020  y.".            
+0002e170: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
+0002e180: 2049 6620 616c 7265 6164 7920 6120 7365   If already a se
+0002e190: 7269 6573 0a20 2020 2020 2020 2069 6620  ries.        if 
+0002e1a0: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
+0002e1b0: 2c20 5365 7269 6573 293a 0a20 2020 2020  , Series):.     
+0002e1c0: 2020 2020 2020 2023 2049 6620 6974 2773         # If it's
+0002e1d0: 2061 6c72 6561 6479 2074 6865 2069 6e64   already the ind
+0002e1e0: 6578 2c20 7468 6572 6527 7320 6e6f 7468  ex, there's noth
+0002e1f0: 696e 6720 746f 2064 6f0a 2020 2020 2020  ing to do.      
+0002e200: 2020 2020 2020 6966 206f 7468 6572 2e5f        if other._
+0002e210: 6e61 6d65 203d 3d20 7365 6c66 2e69 6e64  name == self.ind
+0002e220: 6578 2e5f 6e61 6d65 3a0a 2020 2020 2020  ex._name:.      
+0002e230: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
+0002e240: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
+0002e250: 2020 2020 2020 2020 2020 2020 2022 4e65               "Ne
+0002e260: 7720 696e 6465 7820 6861 7320 7361 6d65  w index has same
+0002e270: 206e 616d 6520 6173 2065 7869 7374 696e   name as existin
+0002e280: 672c 2074 6869 7320 6973 2061 206e 6f2d  g, this is a no-
+0002e290: 6f70 2e22 2c20 5573 6572 5761 726e 696e  op.", UserWarnin
+0002e2a0: 670a 2020 2020 2020 2020 2020 2020 2020  g.              
+0002e2b0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0002e2c0: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
+0002e2d0: 0a20 2020 2020 2020 2023 2049 6620 7468  .        # If th
+0002e2e0: 6520 6e61 6d65 206f 6620 6120 636f 6c75  e name of a colu
+0002e2f0: 6d6e 2f69 6e64 6578 0a20 2020 2020 2020  mn/index.       
+0002e300: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0002e310: 2020 2023 2057 6974 6820 7468 6520 7361     # With the sa
+0002e320: 6d65 206e 616d 6520 6173 2074 6865 2069  me name as the i
+0002e330: 6e64 6578 2c20 7468 6572 6527 7320 6e6f  ndex, there's no
+0002e340: 7468 696e 6720 746f 2064 6f20 6569 7468  thing to do eith
+0002e350: 6572 0a20 2020 2020 2020 2020 2020 2069  er.            i
+0002e360: 6620 6f74 6865 7220 3d3d 2073 656c 662e  f other == self.
+0002e370: 696e 6465 782e 6e61 6d65 3a0a 2020 2020  index.name:.    
+0002e380: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+0002e390: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
+0002e3a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002e3b0: 4e65 7720 696e 6465 7820 6861 7320 7361  New index has sa
+0002e3c0: 6d65 206e 616d 6520 6173 2065 7869 7374  me name as exist
+0002e3d0: 696e 672c 2074 6869 7320 6973 2061 206e  ing, this is a n
+0002e3e0: 6f2d 6f70 2e22 2c20 5573 6572 5761 726e  o-op.", UserWarn
+0002e3f0: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+0002e400: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0002e410: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0002e420: 660a 0a20 2020 2020 2020 2020 2020 2023  f..            #
+0002e430: 2049 6620 6120 6d69 7373 696e 6720 636f   If a missing co
+0002e440: 6c75 6d6e 2c20 4b65 7945 7272 6f72 0a20  lumn, KeyError. 
+0002e450: 2020 2020 2020 2020 2020 2069 6620 6f74             if ot
+0002e460: 6865 7220 6e6f 7420 696e 2073 656c 662e  her not in self.
+0002e470: 636f 6c75 6d6e 733a 0a20 2020 2020 2020  columns:.       
+0002e480: 2020 2020 2020 2020 2072 6169 7365 204b           raise K
+0002e490: 6579 4572 726f 7228 0a20 2020 2020 2020  eyError(.       
+0002e4a0: 2020 2020 2020 2020 2020 2020 2066 2244               f"D
+0002e4b0: 6174 6120 6861 7320 6e6f 2063 6f6c 756d  ata has no colum
+0002e4c0: 6e20 277b 6f74 6865 727d 273a 2075 7365  n '{other}': use
+0002e4d0: 2061 6e79 2063 6f6c 756d 6e20 6f66 207b   any column of {
+0002e4e0: 6c69 7374 2873 656c 662e 636f 6c75 6d6e  list(self.column
+0002e4f0: 7329 7d22 0a20 2020 2020 2020 2020 2020  s)}".           
+0002e500: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0002e510: 2320 4368 6563 6b20 6469 7669 7369 6f6e  # Check division
+0002e520: 730a 2020 2020 2020 2020 6966 2064 6976  s.        if div
+0002e530: 6973 696f 6e73 2069 7320 6e6f 7420 4e6f  isions is not No
+0002e540: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0002e550: 6368 6563 6b5f 6469 7669 7369 6f6e 7328  check_divisions(
+0002e560: 6469 7669 7369 6f6e 7329 0a20 2020 2020  divisions).     
+0002e570: 2020 2065 6c69 6620 280a 2020 2020 2020     elif (.      
+0002e580: 2020 2020 2020 6973 696e 7374 616e 6365        isinstance
+0002e590: 286f 7468 6572 2c20 496e 6465 7829 0a20  (other, Index). 
+0002e5a0: 2020 2020 2020 2020 2020 2061 6e64 206f             and o
+0002e5b0: 7468 6572 2e6b 6e6f 776e 5f64 6976 6973  ther.known_divis
+0002e5c0: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
+0002e5d0: 2061 6e64 206f 7468 6572 2e6e 7061 7274   and other.npart
+0002e5e0: 6974 696f 6e73 203d 3d20 7365 6c66 2e6e  itions == self.n
+0002e5f0: 7061 7274 6974 696f 6e73 0a20 2020 2020  partitions.     
+0002e600: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+0002e610: 2020 2320 4966 2074 6865 2069 6e64 6578    # If the index
+0002e620: 2068 6173 2074 6865 2073 616d 6520 6e75   has the same nu
+0002e630: 6d62 6572 206f 6620 7061 7274 6974 696f  mber of partitio
+0002e640: 6e73 2061 6e64 206b 6e6f 776e 0a20 2020  ns and known.   
+0002e650: 2020 2020 2020 2020 2023 2064 6976 6973           # divis
+0002e660: 696f 6e73 2c20 7468 656e 2077 6520 6361  ions, then we ca
+0002e670: 6e20 7472 6561 7420 6974 2061 7320 7072  n treat it as pr
+0002e680: 652d 736f 7274 6564 2077 6974 6820 6b6e  e-sorted with kn
+0002e690: 6f77 6e0a 2020 2020 2020 2020 2020 2020  own.            
+0002e6a0: 2320 6469 7669 7369 6f6e 730a 2020 2020  # divisions.    
+0002e6b0: 2020 2020 2020 2020 7072 655f 736f 7274          pre_sort
+0002e6c0: 6564 203d 2054 7275 650a 2020 2020 2020  ed = True.      
+0002e6d0: 2020 2020 2020 6469 7669 7369 6f6e 7320        divisions 
+0002e6e0: 3d20 6f74 6865 722e 6469 7669 7369 6f6e  = other.division
+0002e6f0: 730a 0a20 2020 2020 2020 2023 2049 6620  s..        # If 
+0002e700: 696e 6465 7820 6973 2061 6c72 6561 6479  index is already
+0002e710: 2073 6f72 7465 642c 2074 616b 6520 6164   sorted, take ad
+0002e720: 7661 6e74 6167 6520 6f66 2074 6861 7420  vantage of that 
+0002e730: 7769 7468 2073 6574 5f73 6f72 7465 645f  with set_sorted_
+0002e740: 696e 6465 780a 2020 2020 2020 2020 6966  index.        if
+0002e750: 2070 7265 5f73 6f72 7465 643a 0a20 2020   pre_sorted:.   
+0002e760: 2020 2020 2020 2020 2066 726f 6d20 6461           from da
+0002e770: 736b 2e64 6174 6166 7261 6d65 2e73 6875  sk.dataframe.shu
+0002e780: 6666 6c65 2069 6d70 6f72 7420 7365 745f  ffle import set_
+0002e790: 736f 7274 6564 5f69 6e64 6578 0a0a 2020  sorted_index..  
+0002e7a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0002e7b0: 2073 6574 5f73 6f72 7465 645f 696e 6465   set_sorted_inde
+0002e7c0: 7828 0a20 2020 2020 2020 2020 2020 2020  x(.             
+0002e7d0: 2020 2073 656c 662c 206f 7468 6572 2c20     self, other, 
+0002e7e0: 6472 6f70 3d64 726f 702c 2064 6976 6973  drop=drop, divis
+0002e7f0: 696f 6e73 3d64 6976 6973 696f 6e73 2c20  ions=divisions, 
+0002e800: 2a2a 6b77 6172 6773 0a20 2020 2020 2020  **kwargs.       
+0002e810: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+0002e820: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0002e830: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
+0002e840: 7261 6d65 2e73 6875 6666 6c65 2069 6d70  rame.shuffle imp
+0002e850: 6f72 7420 7365 745f 696e 6465 780a 0a20  ort set_index.. 
+0002e860: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0002e870: 6e20 7365 745f 696e 6465 7828 0a20 2020  n set_index(.   
+0002e880: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0002e890: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
+0002e8a0: 2020 206f 7468 6572 2c0a 2020 2020 2020     other,.      
+0002e8b0: 2020 2020 2020 2020 2020 6472 6f70 3d64            drop=d
+0002e8c0: 726f 702c 0a20 2020 2020 2020 2020 2020  rop,.           
+0002e8d0: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
+0002e8e0: 3d6e 7061 7274 6974 696f 6e73 2c0a 2020  =npartitions,.  
+0002e8f0: 2020 2020 2020 2020 2020 2020 2020 6469                di
+0002e900: 7669 7369 6f6e 733d 6469 7669 7369 6f6e  visions=division
+0002e910: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0002e920: 2020 2073 6f72 743d 736f 7274 2c0a 2020     sort=sort,.  
+0002e930: 2020 2020 2020 2020 2020 2020 2020 2a2a                **
+0002e940: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+0002e950: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
+0002e960: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+0002e970: 4672 616d 6529 0a20 2020 2064 6566 2070  Frame).    def p
+0002e980: 6f70 2873 656c 662c 2069 7465 6d29 3a0a  op(self, item):.
+0002e990: 2020 2020 2020 2020 6f75 7420 3d20 7365          out = se
+0002e9a0: 6c66 5b69 7465 6d5d 0a20 2020 2020 2020  lf[item].       
+0002e9b0: 2064 656c 2073 656c 665b 6974 656d 5d0a   del self[item].
+0002e9c0: 2020 2020 2020 2020 7265 7475 726e 206f          return o
+0002e9d0: 7574 0a0a 2020 2020 4064 6572 6976 6564  ut..    @derived
+0002e9e0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+0002e9f0: 6d65 290a 2020 2020 6465 6620 6e6c 6172  me).    def nlar
+0002ea00: 6765 7374 2873 656c 662c 206e 3d35 2c20  gest(self, n=5, 
+0002ea10: 636f 6c75 6d6e 733d 6e6f 5f64 6566 6175  columns=no_defau
+0002ea20: 6c74 2c20 7370 6c69 745f 6576 6572 793d  lt, split_every=
+0002ea30: 4e6f 6e65 293a 0a20 2020 2020 2020 2069  None):.        i
+0002ea40: 6620 636f 6c75 6d6e 7320 6973 206e 6f5f  f columns is no_
+0002ea50: 6465 6661 756c 743a 0a20 2020 2020 2020  default:.       
+0002ea60: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+0002ea70: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0002ea80: 2020 2020 2020 2244 6174 6146 7261 6d65        "DataFrame
+0002ea90: 2e6e 6c61 7267 6573 7428 2920 6d69 7373  .nlargest() miss
+0002eaa0: 696e 6720 7265 7175 6972 6564 2070 6f73  ing required pos
+0002eab0: 6974 696f 6e61 6c20 6172 6775 6d65 6e74  itional argument
+0002eac0: 3a20 2763 6f6c 756d 6e73 2722 0a20 2020  : 'columns'".   
+0002ead0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0002eae0: 2020 2074 6f6b 656e 203d 2022 6461 7461     token = "data
+0002eaf0: 6672 616d 652d 6e6c 6172 6765 7374 220a  frame-nlargest".
+0002eb00: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+0002eb10: 6361 280a 2020 2020 2020 2020 2020 2020  ca(.            
+0002eb20: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
+0002eb30: 2020 6368 756e 6b3d 4d2e 6e6c 6172 6765    chunk=M.nlarge
+0002eb40: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
+0002eb50: 6167 6772 6567 6174 653d 4d2e 6e6c 6172  aggregate=M.nlar
+0002eb60: 6765 7374 2c0a 2020 2020 2020 2020 2020  gest,.          
+0002eb70: 2020 6d65 7461 3d73 656c 662e 5f6d 6574    meta=self._met
+0002eb80: 612c 0a20 2020 2020 2020 2020 2020 2074  a,.            t
+0002eb90: 6f6b 656e 3d74 6f6b 656e 2c0a 2020 2020  oken=token,.    
+0002eba0: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
+0002ebb0: 6572 793d 7370 6c69 745f 6576 6572 792c  ery=split_every,
+0002ebc0: 0a20 2020 2020 2020 2020 2020 206e 3d6e  .            n=n
+0002ebd0: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
+0002ebe0: 6c75 6d6e 733d 636f 6c75 6d6e 732c 0a20  lumns=columns,. 
+0002ebf0: 2020 2020 2020 2029 0a0a 2020 2020 4064         )..    @d
+0002ec00: 6572 6976 6564 5f66 726f 6d28 7064 2e44  erived_from(pd.D
+0002ec10: 6174 6146 7261 6d65 290a 2020 2020 6465  ataFrame).    de
+0002ec20: 6620 6e73 6d61 6c6c 6573 7428 7365 6c66  f nsmallest(self
+0002ec30: 2c20 6e3d 352c 2063 6f6c 756d 6e73 3d6e  , n=5, columns=n
+0002ec40: 6f5f 6465 6661 756c 742c 2073 706c 6974  o_default, split
+0002ec50: 5f65 7665 7279 3d4e 6f6e 6529 3a0a 2020  _every=None):.  
+0002ec60: 2020 2020 2020 6966 2063 6f6c 756d 6e73        if columns
+0002ec70: 2069 7320 6e6f 5f64 6566 6175 6c74 3a0a   is no_default:.
+0002ec80: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0002ec90: 6520 5479 7065 4572 726f 7228 0a20 2020  e TypeError(.   
+0002eca0: 2020 2020 2020 2020 2020 2020 2022 4461               "Da
+0002ecb0: 7461 4672 616d 652e 6e73 6d61 6c6c 6573  taFrame.nsmalles
+0002ecc0: 7428 2920 6d69 7373 696e 6720 7265 7175  t() missing requ
+0002ecd0: 6972 6564 2070 6f73 6974 696f 6e61 6c20  ired positional 
+0002ece0: 6172 6775 6d65 6e74 3a20 2763 6f6c 756d  argument: 'colum
+0002ecf0: 6e73 2722 0a20 2020 2020 2020 2020 2020  ns'".           
+0002ed00: 2029 0a20 2020 2020 2020 2074 6f6b 656e   ).        token
+0002ed10: 203d 2022 6461 7461 6672 616d 652d 6e73   = "dataframe-ns
+0002ed20: 6d61 6c6c 6573 7422 0a20 2020 2020 2020  mallest".       
+0002ed30: 2072 6574 7572 6e20 6163 6128 0a20 2020   return aca(.   
+0002ed40: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
+0002ed50: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
+0002ed60: 3d4d 2e6e 736d 616c 6c65 7374 2c0a 2020  =M.nsmallest,.  
+0002ed70: 2020 2020 2020 2020 2020 6167 6772 6567            aggreg
+0002ed80: 6174 653d 4d2e 6e73 6d61 6c6c 6573 742c  ate=M.nsmallest,
+0002ed90: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+0002eda0: 613d 7365 6c66 2e5f 6d65 7461 2c0a 2020  a=self._meta,.  
+0002edb0: 2020 2020 2020 2020 2020 746f 6b65 6e3d            token=
+0002edc0: 746f 6b65 6e2c 0a20 2020 2020 2020 2020  token,.         
+0002edd0: 2020 2073 706c 6974 5f65 7665 7279 3d73     split_every=s
+0002ede0: 706c 6974 5f65 7665 7279 2c0a 2020 2020  plit_every,.    
+0002edf0: 2020 2020 2020 2020 6e3d 6e2c 0a20 2020          n=n,.   
+0002ee00: 2020 2020 2020 2020 2063 6f6c 756d 6e73           columns
+0002ee10: 3d63 6f6c 756d 6e73 2c0a 2020 2020 2020  =columns,.      
+0002ee20: 2020 290a 0a20 2020 2040 6465 7269 7665    )..    @derive
+0002ee30: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+0002ee40: 616d 6529 0a20 2020 2064 6566 2067 726f  ame).    def gro
+0002ee50: 7570 6279 280a 2020 2020 2020 2020 7365  upby(.        se
+0002ee60: 6c66 2c0a 2020 2020 2020 2020 6279 3d4e  lf,.        by=N
+0002ee70: 6f6e 652c 0a20 2020 2020 2020 2067 726f  one,.        gro
+0002ee80: 7570 5f6b 6579 733d 4752 4f55 505f 4b45  up_keys=GROUP_KE
+0002ee90: 5953 5f44 4546 4155 4c54 2c0a 2020 2020  YS_DEFAULT,.    
+0002eea0: 2020 2020 736f 7274 3d4e 6f6e 652c 0a20      sort=None,. 
+0002eeb0: 2020 2020 2020 206f 6273 6572 7665 643d         observed=
+0002eec0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6472  None,.        dr
+0002eed0: 6f70 6e61 3d4e 6f6e 652c 0a20 2020 2020  opna=None,.     
+0002eee0: 2020 202a 2a6b 7761 7267 732c 0a20 2020     **kwargs,.   
+0002eef0: 2029 3a0a 2020 2020 2020 2020 6672 6f6d   ):.        from
+0002ef00: 2064 6173 6b2e 6461 7461 6672 616d 652e   dask.dataframe.
+0002ef10: 6772 6f75 7062 7920 696d 706f 7274 2044  groupby import D
+0002ef20: 6174 6146 7261 6d65 4772 6f75 7042 790a  ataFrameGroupBy.
+0002ef30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002ef40: 4461 7461 4672 616d 6547 726f 7570 4279  DataFrameGroupBy
+0002ef50: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+0002ef60: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+0002ef70: 6279 3d62 792c 0a20 2020 2020 2020 2020  by=by,.         
+0002ef80: 2020 2067 726f 7570 5f6b 6579 733d 6772     group_keys=gr
+0002ef90: 6f75 705f 6b65 7973 2c0a 2020 2020 2020  oup_keys,.      
+0002efa0: 2020 2020 2020 736f 7274 3d73 6f72 742c        sort=sort,
+0002efb0: 0a20 2020 2020 2020 2020 2020 206f 6273  .            obs
+0002efc0: 6572 7665 643d 6f62 7365 7276 6564 2c0a  erved=observed,.
+0002efd0: 2020 2020 2020 2020 2020 2020 6472 6f70              drop
+0002efe0: 6e61 3d64 726f 706e 612c 0a20 2020 2020  na=dropna,.     
+0002eff0: 2020 2020 2020 202a 2a6b 7761 7267 732c         **kwargs,
+0002f000: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0002f010: 4077 7261 7073 2863 6174 6567 6f72 697a  @wraps(categoriz
+0002f020: 6529 0a20 2020 2064 6566 2063 6174 6567  e).    def categ
+0002f030: 6f72 697a 6528 7365 6c66 2c20 636f 6c75  orize(self, colu
+0002f040: 6d6e 733d 4e6f 6e65 2c20 696e 6465 783d  mns=None, index=
+0002f050: 4e6f 6e65 2c20 7370 6c69 745f 6576 6572  None, split_ever
+0002f060: 793d 4e6f 6e65 2c20 2a2a 6b77 6172 6773  y=None, **kwargs
+0002f070: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+0002f080: 6e20 6361 7465 676f 7269 7a65 280a 2020  n categorize(.  
+0002f090: 2020 2020 2020 2020 2020 7365 6c66 2c20            self, 
+0002f0a0: 636f 6c75 6d6e 733d 636f 6c75 6d6e 732c  columns=columns,
+0002f0b0: 2069 6e64 6578 3d69 6e64 6578 2c20 7370   index=index, sp
+0002f0c0: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+0002f0d0: 6576 6572 792c 202a 2a6b 7761 7267 730a  every, **kwargs.
+0002f0e0: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
+0002f0f0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+0002f100: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+0002f110: 6566 2061 7373 6967 6e28 7365 6c66 2c20  ef assign(self, 
+0002f120: 2a2a 6b77 6172 6773 293a 0a20 2020 2020  **kwargs):.     
+0002f130: 2020 2064 6174 6120 3d20 7365 6c66 2e63     data = self.c
+0002f140: 6f70 7928 290a 2020 2020 2020 2020 666f  opy().        fo
+0002f150: 7220 6b2c 2076 2069 6e20 6b77 6172 6773  r k, v in kwargs
+0002f160: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
+0002f170: 2020 2020 2020 6966 206e 6f74 2028 0a20        if not (. 
+0002f180: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002f190: 7369 6e73 7461 6e63 6528 762c 2053 6361  sinstance(v, Sca
+0002f1a0: 6c61 7229 0a20 2020 2020 2020 2020 2020  lar).           
+0002f1b0: 2020 2020 206f 7220 6973 5f73 6572 6965       or is_serie
+0002f1c0: 735f 6c69 6b65 2876 290a 2020 2020 2020  s_like(v).      
+0002f1d0: 2020 2020 2020 2020 2020 6f72 2063 616c            or cal
+0002f1e0: 6c61 626c 6528 7629 0a20 2020 2020 2020  lable(v).       
+0002f1f0: 2020 2020 2020 2020 206f 7220 7064 2e61           or pd.a
+0002f200: 7069 2e74 7970 6573 2e69 735f 7363 616c  pi.types.is_scal
+0002f210: 6172 2876 290a 2020 2020 2020 2020 2020  ar(v).          
+0002f220: 2020 2020 2020 6f72 2069 735f 696e 6465        or is_inde
+0002f230: 785f 6c69 6b65 2876 290a 2020 2020 2020  x_like(v).      
+0002f240: 2020 2020 2020 2020 2020 6f72 2069 7369            or isi
+0002f250: 6e73 7461 6e63 6528 762c 2041 7272 6179  nstance(v, Array
+0002f260: 290a 2020 2020 2020 2020 2020 2020 293a  ).            ):
+0002f270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f280: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+0002f290: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002f2a0: 2020 2020 2020 6622 436f 6c75 6d6e 2061        f"Column a
+0002f2b0: 7373 6967 6e6d 656e 7420 646f 6573 6e27  ssignment doesn'
+0002f2c0: 7420 7375 7070 6f72 7420 7479 7065 207b  t support type {
+0002f2d0: 7479 7065 6e61 6d65 2874 7970 6528 7629  typename(type(v)
+0002f2e0: 297d 220a 2020 2020 2020 2020 2020 2020  )}".            
+0002f2f0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0002f300: 2020 6966 2063 616c 6c61 626c 6528 7629    if callable(v)
+0002f310: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002f320: 2020 6b77 6172 6773 5b6b 5d20 3d20 7628    kwargs[k] = v(
+0002f330: 6461 7461 290a 2020 2020 2020 2020 2020  data).          
+0002f340: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0002f350: 762c 2041 7272 6179 293a 0a20 2020 2020  v, Array):.     
+0002f360: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
+0002f370: 6461 736b 2e64 6174 6166 7261 6d65 2e69  dask.dataframe.i
+0002f380: 6f20 696d 706f 7274 2066 726f 6d5f 6461  o import from_da
+0002f390: 736b 5f61 7272 6179 0a0a 2020 2020 2020  sk_array..      
+0002f3a0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+0002f3b0: 2876 2e73 6861 7065 2920 3e20 313a 0a20  (v.shape) > 1:. 
+0002f3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f3d0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0002f3e0: 726f 7228 2241 7272 6179 2061 7373 6967  ror("Array assig
+0002f3f0: 6e6d 656e 7420 6f6e 6c79 2073 7570 706f  nment only suppo
+0002f400: 7274 7320 312d 4420 6172 7261 7973 2229  rts 1-D arrays")
+0002f410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f420: 2069 6620 762e 6e70 6172 7469 7469 6f6e   if v.npartition
+0002f430: 7320 213d 2064 6174 612e 6e70 6172 7469  s != data.nparti
+0002f440: 7469 6f6e 733a 0a20 2020 2020 2020 2020  tions:.         
+0002f450: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0002f460: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+0002f470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f480: 2020 2020 2022 4e75 6d62 6572 206f 6620       "Number of 
+0002f490: 7061 7274 6974 696f 6e73 2064 6f20 6e6f  partitions do no
+0002f4a0: 7420 6d61 7463 6820 220a 2020 2020 2020  t match ".      
+0002f4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f4c0: 2020 6622 287b 762e 6e70 6172 7469 7469    f"({v.npartiti
+0002f4d0: 6f6e 737d 2021 3d20 7b64 6174 612e 6e70  ons} != {data.np
+0002f4e0: 6172 7469 7469 6f6e 737d 2922 0a20 2020  artitions})".   
+0002f4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f500: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+0002f510: 2020 206b 7761 7267 735b 6b5d 203d 2066     kwargs[k] = f
+0002f520: 726f 6d5f 6461 736b 5f61 7272 6179 2876  rom_dask_array(v
+0002f530: 2c20 696e 6465 783d 6461 7461 2e69 6e64  , index=data.ind
+0002f540: 6578 2c20 6d65 7461 3d64 6174 612e 5f6d  ex, meta=data._m
+0002f550: 6574 6129 0a0a 2020 2020 2020 2020 2020  eta)..          
+0002f560: 2020 7061 6972 7320 3d20 5b6b 2c20 6b77    pairs = [k, kw
+0002f570: 6172 6773 5b6b 5d5d 0a0a 2020 2020 2020  args[k]]..      
+0002f580: 2020 2020 2020 2320 4669 6775 7265 206f        # Figure o
+0002f590: 7574 2063 6f6c 756d 6e73 206f 6620 7468  ut columns of th
+0002f5a0: 6520 6f75 7470 7574 0a20 2020 2020 2020  e output.       
+0002f5b0: 2020 2020 2064 6632 203d 2064 6174 612e       df2 = data.
+0002f5c0: 5f6d 6574 615f 6e6f 6e65 6d70 7479 2e61  _meta_nonempty.a
+0002f5d0: 7373 6967 6e28 0a20 2020 2020 2020 2020  ssign(.         
+0002f5e0: 2020 2020 2020 202a 2a5f 6578 7472 6163         **_extrac
+0002f5f0: 745f 6d65 7461 287b 6b3a 206b 7761 7267  t_meta({k: kwarg
+0002f600: 735b 6b5d 7d2c 206e 6f6e 656d 7074 793d  s[k]}, nonempty=
+0002f610: 5472 7565 290a 2020 2020 2020 2020 2020  True).          
+0002f620: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0002f630: 6461 7461 203d 2065 6c65 6d77 6973 6528  data = elemwise(
+0002f640: 6d65 7468 6f64 732e 6173 7369 676e 2c20  methods.assign, 
+0002f650: 6461 7461 2c20 2a70 6169 7273 2c20 6d65  data, *pairs, me
+0002f660: 7461 3d64 6632 290a 0a20 2020 2020 2020  ta=df2)..       
+0002f670: 2072 6574 7572 6e20 6461 7461 0a0a 2020   return data..  
+0002f680: 2020 4064 6572 6976 6564 5f66 726f 6d28    @derived_from(
+0002f690: 7064 2e44 6174 6146 7261 6d65 2c20 7561  pd.DataFrame, ua
+0002f6a0: 5f61 7267 733d 5b22 696e 6465 7822 5d29  _args=["index"])
+0002f6b0: 0a20 2020 2064 6566 2072 656e 616d 6528  .    def rename(
+0002f6c0: 7365 6c66 2c20 696e 6465 783d 4e6f 6e65  self, index=None
+0002f6d0: 2c20 636f 6c75 6d6e 733d 4e6f 6e65 293a  , columns=None):
+0002f6e0: 0a20 2020 2020 2020 2069 6620 696e 6465  .        if inde
+0002f6f0: 7820 6973 206e 6f74 204e 6f6e 653a 0a20  x is not None:. 
+0002f700: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0002f710: 2056 616c 7565 4572 726f 7228 2243 616e   ValueError("Can
+0002f720: 6e6f 7420 7265 6e61 6d65 2069 6e64 6578  not rename index
+0002f730: 2e22 290a 0a20 2020 2020 2020 2023 202a  .")..        # *
+0002f740: 6172 6773 2068 6572 6520 6973 2069 6e64  args here is ind
+0002f750: 6578 2c20 636f 6c75 6d6e 7320 6275 7420  ex, columns but 
+0002f760: 636f 6c75 6d6e 7320 6172 6720 6973 2061  columns arg is a
+0002f770: 6c72 6561 6479 2075 7365 640a 2020 2020  lready used.    
+0002f780: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0002f790: 6d61 705f 7061 7274 6974 696f 6e73 284d  map_partitions(M
+0002f7a0: 2e72 656e 616d 652c 204e 6f6e 652c 2063  .rename, None, c
+0002f7b0: 6f6c 756d 6e73 3d63 6f6c 756d 6e73 290a  olumns=columns).
+0002f7c0: 0a20 2020 2064 6566 2071 7565 7279 2873  .    def query(s
+0002f7d0: 656c 662c 2065 7870 722c 202a 2a6b 7761  elf, expr, **kwa
+0002f7e0: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
+0002f7f0: 2246 696c 7465 7220 6461 7461 6672 616d  "Filter datafram
+0002f800: 6520 7769 7468 2063 6f6d 706c 6578 2065  e with complex e
+0002f810: 7870 7265 7373 696f 6e0a 0a20 2020 2020  xpression..     
+0002f820: 2020 2042 6c6f 636b 6564 2076 6572 7369     Blocked versi
+0002f830: 6f6e 206f 6620 7064 2e44 6174 6146 7261  on of pd.DataFra
+0002f840: 6d65 2e71 7565 7279 0a0a 2020 2020 2020  me.query..      
+0002f850: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0002f860: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+0002f870: 2020 2020 2020 2020 6578 7072 3a20 7374          expr: st
+0002f880: 720a 2020 2020 2020 2020 2020 2020 5468  r.            Th
+0002f890: 6520 7175 6572 7920 7374 7269 6e67 2074  e query string t
+0002f8a0: 6f20 6576 616c 7561 7465 2e0a 2020 2020  o evaluate..    
+0002f8b0: 2020 2020 2020 2020 596f 7520 6361 6e20          You can 
+0002f8c0: 7265 6665 7220 746f 2063 6f6c 756d 6e20  refer to column 
+0002f8d0: 6e61 6d65 7320 7468 6174 2061 7265 206e  names that are n
+0002f8e0: 6f74 2076 616c 6964 2050 7974 686f 6e20  ot valid Python 
+0002f8f0: 7661 7269 6162 6c65 206e 616d 6573 0a20  variable names. 
+0002f900: 2020 2020 2020 2020 2020 2062 7920 7375             by su
+0002f910: 7272 6f75 6e64 696e 6720 7468 656d 2069  rrounding them i
+0002f920: 6e20 6261 636b 7469 636b 732e 0a20 2020  n backticks..   
+0002f930: 2020 2020 2020 2020 2044 6173 6b20 646f           Dask do
+0002f940: 6573 206e 6f74 2066 756c 6c79 2073 7570  es not fully sup
+0002f950: 706f 7274 2072 6566 6572 7269 6e67 2074  port referring t
+0002f960: 6f20 7661 7269 6162 6c65 7320 7573 696e  o variables usin
+0002f970: 6720 7468 6520 2740 2720 6368 6172 6163  g the '@' charac
+0002f980: 7465 722c 0a20 2020 2020 2020 2020 2020  ter,.           
+0002f990: 2075 7365 2066 2d73 7472 696e 6773 206f   use f-strings o
+0002f9a0: 7220 7468 6520 6060 6c6f 6361 6c5f 6469  r the ``local_di
+0002f9b0: 6374 6060 206b 6579 776f 7264 2061 7267  ct`` keyword arg
+0002f9c0: 756d 656e 7420 696e 7374 6561 642e 0a0a  ument instead...
+0002f9d0: 2020 2020 2020 2020 4e6f 7465 730a 2020          Notes.  
+0002f9e0: 2020 2020 2020 2d2d 2d2d 2d0a 2020 2020        -----.    
+0002f9f0: 2020 2020 5468 6973 2069 7320 6c69 6b65      This is like
+0002fa00: 2074 6865 2073 6571 7565 6e74 6961 6c20   the sequential 
+0002fa10: 7665 7273 696f 6e20 6578 6365 7074 2074  version except t
+0002fa20: 6861 7420 7468 6973 2077 696c 6c20 616c  hat this will al
+0002fa30: 736f 2068 6170 7065 6e0a 2020 2020 2020  so happen.      
+0002fa40: 2020 696e 206d 616e 7920 7468 7265 6164    in many thread
+0002fa50: 732e 2020 5468 6973 206d 6179 2063 6f6e  s.  This may con
+0002fa60: 666c 6963 7420 7769 7468 2060 606e 756d  flict with ``num
+0002fa70: 6578 7072 6060 2077 6869 6368 2077 696c  expr`` which wil
+0002fa80: 6c20 7573 650a 2020 2020 2020 2020 6d75  l use.        mu
+0002fa90: 6c74 6970 6c65 2074 6872 6561 6473 2069  ltiple threads i
+0002faa0: 7473 656c 662e 2020 5765 2072 6563 6f6d  tself.  We recom
+0002fab0: 6d65 6e64 2074 6861 7420 796f 7520 7365  mend that you se
+0002fac0: 7420 6060 6e75 6d65 7870 7260 6020 746f  t ``numexpr`` to
+0002fad0: 2075 7365 2061 0a20 2020 2020 2020 2073   use a.        s
+0002fae0: 696e 676c 6520 7468 7265 6164 3a0a 0a20  ingle thread:.. 
+0002faf0: 2020 2020 2020 202e 2e20 636f 6465 2d62         .. code-b
+0002fb00: 6c6f 636b 3a3a 2070 7974 686f 6e0a 0a20  lock:: python.. 
+0002fb10: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
+0002fb20: 7420 6e75 6d65 7870 720a 2020 2020 2020  t numexpr.      
+0002fb30: 2020 2020 2020 6e75 6d65 7870 722e 7365        numexpr.se
+0002fb40: 745f 6e75 6d5f 7468 7265 6164 7328 3129  t_num_threads(1)
+0002fb50: 0a0a 2020 2020 2020 2020 5365 6520 616c  ..        See al
+0002fb60: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+0002fb70: 2d2d 2d0a 2020 2020 2020 2020 7061 6e64  ---.        pand
+0002fb80: 6173 2e44 6174 6146 7261 6d65 2e71 7565  as.DataFrame.que
+0002fb90: 7279 0a20 2020 2020 2020 2070 616e 6461  ry.        panda
+0002fba0: 732e 6576 616c 0a0a 2020 2020 2020 2020  s.eval..        
+0002fbb0: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
+0002fbc0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+0002fbd0: 2020 3e3e 3e20 696d 706f 7274 2070 616e    >>> import pan
+0002fbe0: 6461 7320 6173 2070 640a 2020 2020 2020  das as pd.      
+0002fbf0: 2020 3e3e 3e20 696d 706f 7274 2064 6173    >>> import das
+0002fc00: 6b2e 6461 7461 6672 616d 6520 6173 2064  k.dataframe as d
+0002fc10: 640a 2020 2020 2020 2020 3e3e 3e20 6466  d.        >>> df
+0002fc20: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
+0002fc30: 7b27 7827 3a20 5b31 2c20 322c 2031 2c20  {'x': [1, 2, 1, 
+0002fc40: 325d 2c0a 2020 2020 2020 2020 2e2e 2e20  2],.        ... 
+0002fc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fc60: 2020 2027 7927 3a20 5b31 2c20 322c 2033     'y': [1, 2, 3
+0002fc70: 2c20 345d 2c0a 2020 2020 2020 2020 2e2e  , 4],.        ..
+0002fc80: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
+0002fc90: 2020 2020 2027 7a20 7a27 3a20 5b34 2c20       'z z': [4, 
+0002fca0: 332c 2032 2c20 315d 7d29 0a20 2020 2020  3, 2, 1]}).     
+0002fcb0: 2020 203e 3e3e 2064 6466 203d 2064 642e     >>> ddf = dd.
+0002fcc0: 6672 6f6d 5f70 616e 6461 7328 6466 2c20  from_pandas(df, 
+0002fcd0: 6e70 6172 7469 7469 6f6e 733d 3229 0a0a  npartitions=2)..
+0002fce0: 2020 2020 2020 2020 5265 6665 7220 746f          Refer to
+0002fcf0: 2063 6f6c 756d 6e20 6e61 6d65 7320 6469   column names di
+0002fd00: 7265 6374 6c79 3a0a 0a20 2020 2020 2020  rectly:..       
+0002fd10: 203e 3e3e 2064 6466 2e71 7565 7279 2827   >>> ddf.query('
+0002fd20: 7920 3e20 7827 292e 636f 6d70 7574 6528  y > x').compute(
+0002fd30: 290a 2020 2020 2020 2020 2020 2078 2020  ).           x  
+0002fd40: 7920 207a 207a 0a20 2020 2020 2020 2032  y  z z.        2
+0002fd50: 2020 3120 2033 2020 2020 320a 2020 2020    1  3    2.    
+0002fd60: 2020 2020 3320 2032 2020 3420 2020 2031      3  2  4    1
+0002fd70: 0a0a 2020 2020 2020 2020 5265 6665 7220  ..        Refer 
+0002fd80: 746f 2063 6f6c 756d 6e20 6e61 6d65 2075  to column name u
+0002fd90: 7369 6e67 2062 6163 6b74 6963 6b73 3a0a  sing backticks:.
+0002fda0: 0a20 2020 2020 2020 203e 3e3e 2064 6466  .        >>> ddf
+0002fdb0: 2e71 7565 7279 2827 607a 207a 6020 3e20  .query('`z z` > 
+0002fdc0: 7827 292e 636f 6d70 7574 6528 290a 2020  x').compute().  
+0002fdd0: 2020 2020 2020 2020 2078 2020 7920 207a           x  y  z
+0002fde0: 207a 0a20 2020 2020 2020 2030 2020 3120   z.        0  1 
+0002fdf0: 2031 2020 2020 340a 2020 2020 2020 2020   1    4.        
+0002fe00: 3120 2032 2020 3220 2020 2033 0a20 2020  1  2  2    3.   
+0002fe10: 2020 2020 2032 2020 3120 2033 2020 2020       2  1  3    
+0002fe20: 320a 0a20 2020 2020 2020 2052 6566 6572  2..        Refer
+0002fe30: 2074 6f20 7661 7269 6162 6c65 206e 616d   to variable nam
+0002fe40: 6520 7573 696e 6720 662d 7374 7269 6e67  e using f-string
+0002fe50: 733a 0a0a 2020 2020 2020 2020 3e3e 3e20  s:..        >>> 
+0002fe60: 7661 6c75 6520 3d20 310a 2020 2020 2020  value = 1.      
+0002fe70: 2020 3e3e 3e20 6464 662e 7175 6572 7928    >>> ddf.query(
+0002fe80: 6627 7820 3d3d 207b 7661 6c75 657d 2729  f'x == {value}')
+0002fe90: 2e63 6f6d 7075 7465 2829 0a20 2020 2020  .compute().     
+0002fea0: 2020 2020 2020 7820 2079 2020 7a20 7a0a        x  y  z z.
+0002feb0: 2020 2020 2020 2020 3020 2031 2020 3120          0  1  1 
+0002fec0: 2020 2034 0a20 2020 2020 2020 2032 2020     4.        2  
+0002fed0: 3120 2033 2020 2020 320a 0a20 2020 2020  1  3    2..     
+0002fee0: 2020 2052 6566 6572 2074 6f20 7661 7269     Refer to vari
+0002fef0: 6162 6c65 206e 616d 6520 7573 696e 6720  able name using 
+0002ff00: 6060 6c6f 6361 6c5f 6469 6374 6060 3a0a  ``local_dict``:.
+0002ff10: 0a20 2020 2020 2020 203e 3e3e 2064 6466  .        >>> ddf
+0002ff20: 2e71 7565 7279 2827 7820 3d3d 2040 7661  .query('x == @va
+0002ff30: 6c75 6527 2c20 6c6f 6361 6c5f 6469 6374  lue', local_dict
+0002ff40: 3d7b 2276 616c 7565 223a 2076 616c 7565  ={"value": value
+0002ff50: 7d29 2e63 6f6d 7075 7465 2829 0a20 2020  }).compute().   
+0002ff60: 2020 2020 2020 2020 7820 2079 2020 7a20          x  y  z 
+0002ff70: 7a0a 2020 2020 2020 2020 3020 2031 2020  z.        0  1  
+0002ff80: 3120 2020 2034 0a20 2020 2020 2020 2032  1    4.        2
+0002ff90: 2020 3120 2033 2020 2020 320a 2020 2020    1  3    2.    
+0002ffa0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0002ffb0: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
+0002ffc0: 7061 7274 6974 696f 6e73 284d 2e71 7565  partitions(M.que
+0002ffd0: 7279 2c20 6578 7072 2c20 2a2a 6b77 6172  ry, expr, **kwar
+0002ffe0: 6773 290a 0a20 2020 2040 6465 7269 7665  gs)..    @derive
+0002fff0: 645f 6672 6f6d 2870 642e 4461 7461 4672  d_from(pd.DataFr
+00030000: 616d 6529 0a20 2020 2064 6566 2065 7661  ame).    def eva
+00030010: 6c28 7365 6c66 2c20 6578 7072 2c20 696e  l(self, expr, in
+00030020: 706c 6163 653d 4e6f 6e65 2c20 2a2a 6b77  place=None, **kw
+00030030: 6172 6773 293a 0a20 2020 2020 2020 2069  args):.        i
+00030040: 6620 696e 706c 6163 6520 6973 204e 6f6e  f inplace is Non
+00030050: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
+00030060: 6e70 6c61 6365 203d 2046 616c 7365 0a20  nplace = False. 
+00030070: 2020 2020 2020 2069 6620 223d 2220 696e         if "=" in
+00030080: 2065 7870 7220 616e 6420 696e 706c 6163   expr and inplac
+00030090: 6520 696e 2028 5472 7565 2c20 4e6f 6e65  e in (True, None
+000300a0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+000300b0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+000300c0: 7465 6445 7272 6f72 280a 2020 2020 2020  tedError(.      
+000300d0: 2020 2020 2020 2020 2020 2249 6e70 6c61            "Inpla
+000300e0: 6365 2065 7661 6c20 6e6f 7420 7375 7070  ce eval not supp
+000300f0: 6f72 7465 642e 2050 6c65 6173 6520 7573  orted. Please us
+00030100: 6520 696e 706c 6163 653d 4661 6c73 6522  e inplace=False"
+00030110: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00030120: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
+00030130: 6c66 2e5f 6d65 7461 2e65 7661 6c28 6578  lf._meta.eval(ex
+00030140: 7072 2c20 696e 706c 6163 653d 696e 706c  pr, inplace=inpl
+00030150: 6163 652c 202a 2a6b 7761 7267 7329 0a20  ace, **kwargs). 
+00030160: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00030170: 6c66 2e6d 6170 5f70 6172 7469 7469 6f6e  lf.map_partition
+00030180: 7328 4d2e 6576 616c 2c20 6578 7072 2c20  s(M.eval, expr, 
+00030190: 6d65 7461 3d6d 6574 612c 2069 6e70 6c61  meta=meta, inpla
+000301a0: 6365 3d69 6e70 6c61 6365 2c20 2a2a 6b77  ce=inplace, **kw
+000301b0: 6172 6773 290a 0a20 2020 2040 6465 7269  args)..    @deri
+000301c0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+000301d0: 4672 616d 6529 0a20 2020 2064 6566 2064  Frame).    def d
+000301e0: 726f 706e 6128 7365 6c66 2c20 686f 773d  ropna(self, how=
+000301f0: 6e6f 5f64 6566 6175 6c74 2c20 7375 6273  no_default, subs
+00030200: 6574 3d4e 6f6e 652c 2074 6872 6573 683d  et=None, thresh=
+00030210: 6e6f 5f64 6566 6175 6c74 293a 0a20 2020  no_default):.   
+00030220: 2020 2020 2023 2054 6865 7365 206b 6579       # These key
+00030230: 776f 7264 7320 6172 6520 696e 636f 6d70  words are incomp
+00030240: 6174 6962 6c65 2077 6974 6820 6561 6368  atible with each
+00030250: 206f 7468 6572 2e0a 2020 2020 2020 2020   other..        
+00030260: 2320 446f 6e27 7420 616c 6c6f 7720 7468  # Don't allow th
+00030270: 656d 2062 6f74 6820 746f 2062 6520 7365  em both to be se
+00030280: 742e 0a20 2020 2020 2020 2069 6620 686f  t..        if ho
+00030290: 7720 6973 206e 6f74 206e 6f5f 6465 6661  w is not no_defa
+000302a0: 756c 7420 616e 6420 7468 7265 7368 2069  ult and thresh i
+000302b0: 7320 6e6f 7420 6e6f 5f64 6566 6175 6c74  s not no_default
+000302c0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+000302d0: 6973 6520 5479 7065 4572 726f 7228 0a20  ise TypeError(. 
+000302e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000302f0: 596f 7520 6361 6e6e 6f74 2073 6574 2062  You cannot set b
+00030300: 6f74 6820 7468 6520 686f 7720 616e 6420  oth the how and 
+00030310: 7468 7265 7368 2061 7267 756d 656e 7473  thresh arguments
+00030320: 2061 7420 7468 6520 7361 6d65 2074 696d   at the same tim
+00030330: 652e 220a 2020 2020 2020 2020 2020 2020  e.".            
+00030340: 290a 0a20 2020 2020 2020 2023 204f 6e6c  )..        # Onl
+00030350: 7920 7370 6563 6966 7920 6068 6f77 6020  y specify `how` 
+00030360: 6f72 2060 7468 7265 7368 6020 6b65 7977  or `thresh` keyw
+00030370: 6f72 6420 6966 2073 7065 6369 6669 6564  ord if specified
+00030380: 2062 7920 7468 6520 7573 6572 0a20 2020   by the user.   
+00030390: 2020 2020 2023 2073 6f20 7765 2075 7469       # so we uti
+000303a0: 6c69 7a65 206f 7468 6572 2060 6472 6f70  lize other `drop
+000303b0: 6e61 6020 6b65 7977 6f72 6420 6465 6661  na` keyword defa
+000303c0: 756c 7473 2061 7070 726f 7072 6961 7465  ults appropriate
+000303d0: 6c79 0a20 2020 2020 2020 206b 7761 7267  ly.        kwarg
+000303e0: 7320 3d20 7b22 7375 6273 6574 223a 2073  s = {"subset": s
+000303f0: 7562 7365 747d 0a20 2020 2020 2020 2069  ubset}.        i
+00030400: 6620 686f 7720 6973 206e 6f74 206e 6f5f  f how is not no_
+00030410: 6465 6661 756c 743a 0a20 2020 2020 2020  default:.       
+00030420: 2020 2020 206b 7761 7267 735b 2268 6f77       kwargs["how
+00030430: 225d 203d 2068 6f77 0a20 2020 2020 2020  "] = how.       
+00030440: 2065 6c69 6620 7468 7265 7368 2069 7320   elif thresh is 
+00030450: 6e6f 7420 6e6f 5f64 6566 6175 6c74 3a0a  not no_default:.
+00030460: 2020 2020 2020 2020 2020 2020 6b77 6172              kwar
+00030470: 6773 5b22 7468 7265 7368 225d 203d 2074  gs["thresh"] = t
+00030480: 6872 6573 680a 0a20 2020 2020 2020 2072  hresh..        r
+00030490: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+000304a0: 6172 7469 7469 6f6e 7328 4d2e 6472 6f70  artitions(M.drop
+000304b0: 6e61 2c20 2a2a 6b77 6172 6773 2c20 656e  na, **kwargs, en
+000304c0: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
+000304d0: 616c 7365 290a 0a20 2020 2040 6465 7269  alse)..    @deri
+000304e0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+000304f0: 4672 616d 6529 0a20 2020 2064 6566 2063  Frame).    def c
+00030500: 6c69 7028 7365 6c66 2c20 6c6f 7765 723d  lip(self, lower=
+00030510: 4e6f 6e65 2c20 7570 7065 723d 4e6f 6e65  None, upper=None
+00030520: 2c20 6f75 743d 4e6f 6e65 293a 0a20 2020  , out=None):.   
+00030530: 2020 2020 2069 6620 6f75 7420 6973 206e       if out is n
+00030540: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00030550: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00030560: 4572 726f 7228 2227 6f75 7427 206d 7573  Error("'out' mus
+00030570: 7420 6265 204e 6f6e 6522 290a 2020 2020  t be None").    
+00030580: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00030590: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
+000305a0: 2020 2020 2020 2020 2020 2020 4d2e 636c              M.cl
+000305b0: 6970 2c20 6c6f 7765 723d 6c6f 7765 722c  ip, lower=lower,
+000305c0: 2075 7070 6572 3d75 7070 6572 2c20 656e   upper=upper, en
+000305d0: 666f 7263 655f 6d65 7461 6461 7461 3d46  force_metadata=F
+000305e0: 616c 7365 0a20 2020 2020 2020 2029 0a0a  alse.        )..
+000305f0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+00030600: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+00030610: 2020 2020 6465 6620 7371 7565 657a 6528      def squeeze(
+00030620: 7365 6c66 2c20 6178 6973 3d4e 6f6e 6529  self, axis=None)
+00030630: 3a0a 2020 2020 2020 2020 6966 2061 7869  :.        if axi
+00030640: 7320 696e 205b 4e6f 6e65 2c20 315d 3a0a  s in [None, 1]:.
+00030650: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00030660: 656e 2873 656c 662e 636f 6c75 6d6e 7329  en(self.columns)
+00030670: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+00030680: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00030690: 6c66 5b73 656c 662e 636f 6c75 6d6e 735b  lf[self.columns[
+000306a0: 305d 5d0a 2020 2020 2020 2020 2020 2020  0]].            
+000306b0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000306c0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000306d0: 660a 0a20 2020 2020 2020 2065 6c69 6620  f..        elif 
+000306e0: 6178 6973 203d 3d20 303a 0a20 2020 2020  axis == 0:.     
+000306f0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+00030700: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+00030710: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00030720: 2020 6622 7b74 7970 6528 7365 6c66 297d    f"{type(self)}
+00030730: 2064 6f65 7320 6e6f 7420 7375 7070 6f72   does not suppor
+00030740: 7420 7371 7565 657a 6520 616c 6f6e 6720  t squeeze along 
+00030750: 6178 6973 2030 220a 2020 2020 2020 2020  axis 0".        
+00030760: 2020 2020 290a 0a20 2020 2020 2020 2065      )..        e
+00030770: 6c69 6620 6178 6973 206e 6f74 2069 6e20  lif axis not in 
+00030780: 5b30 2c20 312c 204e 6f6e 655d 3a0a 2020  [0, 1, None]:.  
+00030790: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000307a0: 5661 6c75 6545 7272 6f72 2866 224e 6f20  ValueError(f"No 
+000307b0: 6178 6973 207b 6178 6973 7d20 666f 7220  axis {axis} for 
+000307c0: 6f62 6a65 6374 2074 7970 6520 7b74 7970  object type {typ
+000307d0: 6528 7365 6c66 297d 2229 0a0a 2020 2020  e(self)}")..    
+000307e0: 4064 6572 6976 6564 5f66 726f 6d28 7064  @derived_from(pd
+000307f0: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+00030800: 6465 6620 746f 5f74 696d 6573 7461 6d70  def to_timestamp
+00030810: 2873 656c 662c 2066 7265 713d 4e6f 6e65  (self, freq=None
+00030820: 2c20 686f 773d 2273 7461 7274 222c 2061  , how="start", a
+00030830: 7869 733d 3029 3a0a 2020 2020 2020 2020  xis=0):.        
+00030840: 6466 203d 2065 6c65 6d77 6973 6528 4d2e  df = elemwise(M.
+00030850: 746f 5f74 696d 6573 7461 6d70 2c20 7365  to_timestamp, se
+00030860: 6c66 2c20 6672 6571 2c20 686f 772c 2061  lf, freq, how, a
+00030870: 7869 7329 0a20 2020 2020 2020 2064 662e  xis).        df.
+00030880: 6469 7669 7369 6f6e 7320 3d20 7475 706c  divisions = tupl
+00030890: 6528 7064 2e49 6e64 6578 2873 656c 662e  e(pd.Index(self.
+000308a0: 6469 7669 7369 6f6e 7329 2e74 6f5f 7469  divisions).to_ti
+000308b0: 6d65 7374 616d 7028 686f 773d 686f 772c  mestamp(how=how,
+000308c0: 2066 7265 713d 6672 6571 2929 0a20 2020   freq=freq)).   
+000308d0: 2020 2020 2072 6574 7572 6e20 6466 0a0a       return df..
+000308e0: 2020 2020 4064 6572 6976 6564 5f66 726f      @derived_fro
+000308f0: 6d28 7064 2e44 6174 6146 7261 6d65 290a  m(pd.DataFrame).
+00030900: 2020 2020 6465 6620 6578 706c 6f64 6528      def explode(
+00030910: 7365 6c66 2c20 636f 6c75 6d6e 293a 0a20  self, column):. 
+00030920: 2020 2020 2020 206d 6574 6120 3d20 7365         meta = se
+00030930: 6c66 2e5f 6d65 7461 2e65 7870 6c6f 6465  lf._meta.explode
+00030940: 2863 6f6c 756d 6e29 0a20 2020 2020 2020  (column).       
+00030950: 2072 6574 7572 6e20 7365 6c66 2e6d 6170   return self.map
+00030960: 5f70 6172 7469 7469 6f6e 7328 4d2e 6578  _partitions(M.ex
+00030970: 706c 6f64 652c 2063 6f6c 756d 6e2c 206d  plode, column, m
+00030980: 6574 613d 6d65 7461 2c20 656e 666f 7263  eta=meta, enforc
+00030990: 655f 6d65 7461 6461 7461 3d46 616c 7365  e_metadata=False
+000309a0: 290a 0a20 2020 2064 6566 2074 6f5f 6261  )..    def to_ba
+000309b0: 6728 7365 6c66 2c20 696e 6465 783d 4661  g(self, index=Fa
+000309c0: 6c73 652c 2066 6f72 6d61 743d 2274 7570  lse, format="tup
+000309d0: 6c65 2229 3a0a 2020 2020 2020 2020 2222  le"):.        ""
+000309e0: 2243 6f6e 7665 7274 2074 6f20 6120 6461  "Convert to a da
+000309f0: 736b 2042 6167 206f 6620 7475 706c 6573  sk Bag of tuples
+00030a00: 206f 6620 6561 6368 2072 6f77 2e0a 0a20   of each row... 
+00030a10: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00030a20: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00030a30: 2d2d 2d2d 0a20 2020 2020 2020 2069 6e64  ----.        ind
+00030a40: 6578 203a 2062 6f6f 6c2c 206f 7074 696f  ex : bool, optio
+00030a50: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00030a60: 4966 2054 7275 652c 2074 6865 2069 6e64  If True, the ind
+00030a70: 6578 2069 7320 696e 636c 7564 6564 2061  ex is included a
+00030a80: 7320 7468 6520 6669 7273 7420 656c 656d  s the first elem
+00030a90: 656e 7420 6f66 2065 6163 6820 7475 706c  ent of each tupl
+00030aa0: 652e 0a20 2020 2020 2020 2020 2020 2044  e..            D
+00030ab0: 6566 6175 6c74 2069 7320 4661 6c73 652e  efault is False.
+00030ac0: 0a20 2020 2020 2020 2066 6f72 6d61 7420  .        format 
+00030ad0: 3a20 7b22 7475 706c 6522 2c20 2264 6963  : {"tuple", "dic
+00030ae0: 7422 2c20 2266 7261 6d65 227d 2c20 6f70  t", "frame"}, op
+00030af0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00030b00: 2020 2057 6865 7468 6572 2074 6f20 7265     Whether to re
+00030b10: 7475 726e 2061 2062 6167 206f 6620 7475  turn a bag of tu
+00030b20: 706c 6573 2c20 6469 6374 696f 6e61 7269  ples, dictionari
+00030b30: 6573 2c20 6f72 0a20 2020 2020 2020 2020  es, or.         
+00030b40: 2020 2064 6174 6166 7261 6d65 2d6c 696b     dataframe-lik
+00030b50: 6520 6f62 6a65 6374 732e 2044 6566 6175  e objects. Defau
+00030b60: 6c74 2069 7320 2274 7570 6c65 222e 2049  lt is "tuple". I
+00030b70: 6620 2266 7261 6d65 222c 0a20 2020 2020  f "frame",.     
+00030b80: 2020 2020 2020 2074 6865 206f 7269 6769         the origi
+00030b90: 6e61 6c20 7061 7274 6974 696f 6e73 206f  nal partitions o
+00030ba0: 6620 6060 6466 6060 2077 696c 6c20 6e6f  f ``df`` will no
+00030bb0: 7420 6265 2074 7261 6e73 666f 726d 6564  t be transformed
+00030bc0: 0a20 2020 2020 2020 2020 2020 2069 6e20  .            in 
+00030bd0: 616e 7920 7761 792e 0a20 2020 2020 2020  any way..       
+00030be0: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
+00030bf0: 6d20 6461 736b 2e64 6174 6166 7261 6d65  m dask.dataframe
+00030c00: 2e69 6f20 696d 706f 7274 2074 6f5f 6261  .io import to_ba
+00030c10: 670a 0a20 2020 2020 2020 2072 6574 7572  g..        retur
+00030c20: 6e20 746f 5f62 6167 2873 656c 662c 2069  n to_bag(self, i
+00030c30: 6e64 6578 2c20 666f 726d 6174 290a 0a20  ndex, format).. 
+00030c40: 2020 2064 6566 2074 6f5f 7061 7271 7565     def to_parque
+00030c50: 7428 7365 6c66 2c20 7061 7468 2c20 2a61  t(self, path, *a
+00030c60: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+00030c70: 2020 2020 2020 2020 2222 2253 6565 2064          """See d
+00030c80: 642e 746f 5f70 6172 7175 6574 2064 6f63  d.to_parquet doc
+00030c90: 7374 7269 6e67 2066 6f72 206d 6f72 6520  string for more 
+00030ca0: 696e 666f 726d 6174 696f 6e22 2222 0a20  information""". 
+00030cb0: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+00030cc0: 2e64 6174 6166 7261 6d65 2e69 6f20 696d  .dataframe.io im
+00030cd0: 706f 7274 2074 6f5f 7061 7271 7565 740a  port to_parquet.
+00030ce0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00030cf0: 746f 5f70 6172 7175 6574 2873 656c 662c  to_parquet(self,
+00030d00: 2070 6174 682c 202a 6172 6773 2c20 2a2a   path, *args, **
+00030d10: 6b77 6172 6773 290a 0a20 2020 2064 6566  kwargs)..    def
+00030d20: 2074 6f5f 6f72 6328 7365 6c66 2c20 7061   to_orc(self, pa
+00030d30: 7468 2c20 2a61 7267 732c 202a 2a6b 7761  th, *args, **kwa
+00030d40: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
+00030d50: 2253 6565 2064 642e 746f 5f6f 7263 2064  "See dd.to_orc d
+00030d60: 6f63 7374 7269 6e67 2066 6f72 206d 6f72  ocstring for mor
+00030d70: 6520 696e 666f 726d 6174 696f 6e22 2222  e information"""
+00030d80: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
+00030d90: 736b 2e64 6174 6166 7261 6d65 2e69 6f20  sk.dataframe.io 
+00030da0: 696d 706f 7274 2074 6f5f 6f72 630a 0a20  import to_orc.. 
+00030db0: 2020 2020 2020 2072 6574 7572 6e20 746f         return to
+00030dc0: 5f6f 7263 2873 656c 662c 2070 6174 682c  _orc(self, path,
+00030dd0: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+00030de0: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00030df0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+00030e00: 6529 0a20 2020 2064 6566 2074 6f5f 7374  e).    def to_st
+00030e10: 7269 6e67 2873 656c 662c 206d 6178 5f72  ring(self, max_r
+00030e20: 6f77 733d 3529 3a0a 2020 2020 2020 2020  ows=5):.        
+00030e30: 2320 6f70 7469 6f6e 5f63 6f6e 7465 7874  # option_context
+00030e40: 2064 6f65 736e 2774 2061 6666 6563 740a   doesn't affect.
+00030e50: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00030e60: 656c 662e 5f72 6570 725f 6461 7461 2829  elf._repr_data()
+00030e70: 2e74 6f5f 7374 7269 6e67 286d 6178 5f72  .to_string(max_r
+00030e80: 6f77 733d 6d61 785f 726f 7773 2c20 7368  ows=max_rows, sh
+00030e90: 6f77 5f64 696d 656e 7369 6f6e 733d 4661  ow_dimensions=Fa
+00030ea0: 6c73 6529 0a0a 2020 2020 6465 6620 5f67  lse)..    def _g
+00030eb0: 6574 5f6e 756d 6572 6963 5f64 6174 6128  et_numeric_data(
+00030ec0: 7365 6c66 2c20 686f 773d 2261 6e79 222c  self, how="any",
+00030ed0: 2073 7562 7365 743d 4e6f 6e65 293a 0a20   subset=None):. 
+00030ee0: 2020 2020 2020 2023 2063 616c 6375 6c61         # calcula
+00030ef0: 7465 2063 6f6c 756d 6e73 2074 6f20 6176  te columns to av
+00030f00: 6f69 6420 756e 6e65 6365 7373 6172 7920  oid unnecessary 
+00030f10: 6361 6c63 756c 6174 696f 6e0a 2020 2020  calculation.    
+00030f20: 2020 2020 6e75 6d65 7269 6373 203d 2073      numerics = s
+00030f30: 656c 662e 5f6d 6574 612e 5f67 6574 5f6e  elf._meta._get_n
+00030f40: 756d 6572 6963 5f64 6174 6128 290a 0a20  umeric_data().. 
+00030f50: 2020 2020 2020 2069 6620 6c65 6e28 6e75         if len(nu
+00030f60: 6d65 7269 6373 2e63 6f6c 756d 6e73 2920  merics.columns) 
+00030f70: 3c20 6c65 6e28 7365 6c66 2e63 6f6c 756d  < len(self.colum
+00030f80: 6e73 293a 0a20 2020 2020 2020 2020 2020  ns):.           
+00030f90: 206e 616d 6520 3d20 7365 6c66 2e5f 746f   name = self._to
+00030fa0: 6b65 6e5f 7072 6566 6978 202b 2022 2d67  ken_prefix + "-g
+00030fb0: 6574 5f6e 756d 6572 6963 5f64 6174 6122  et_numeric_data"
+00030fc0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00030fd0: 7572 6e20 7365 6c66 2e6d 6170 5f70 6172  urn self.map_par
+00030fe0: 7469 7469 6f6e 7328 4d2e 5f67 6574 5f6e  titions(M._get_n
+00030ff0: 756d 6572 6963 5f64 6174 612c 206d 6574  umeric_data, met
+00031000: 613d 6e75 6d65 7269 6373 2c20 746f 6b65  a=numerics, toke
+00031010: 6e3d 6e61 6d65 290a 2020 2020 2020 2020  n=name).        
+00031020: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00031030: 2020 2320 7573 6520 6d79 7365 6c66 2069    # use myself i
+00031040: 6620 616c 6c20 6e75 6d65 7269 6373 0a20  f all numerics. 
+00031050: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00031060: 6e20 7365 6c66 0a0a 2020 2020 4063 6c61  n self..    @cla
+00031070: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
+00031080: 205f 7661 6c69 6461 7465 5f61 7869 7328   _validate_axis(
+00031090: 636c 732c 2061 7869 733d 302c 206e 6f6e  cls, axis=0, non
+000310a0: 655f 6973 5f7a 6572 6f3a 2062 6f6f 6c20  e_is_zero: bool 
+000310b0: 3d20 5472 7565 2920 2d3e 204e 6f6e 6520  = True) -> None 
+000310c0: 7c20 4c69 7465 7261 6c5b 302c 2031 5d3a  | Literal[0, 1]:
+000310d0: 0a20 2020 2020 2020 2069 6620 6178 6973  .        if axis
+000310e0: 206e 6f74 2069 6e20 2830 2c20 312c 2022   not in (0, 1, "
+000310f0: 696e 6465 7822 2c20 2263 6f6c 756d 6e73  index", "columns
+00031100: 222c 204e 6f6e 6529 3a0a 2020 2020 2020  ", None):.      
+00031110: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00031120: 6545 7272 6f72 2866 224e 6f20 6178 6973  eError(f"No axis
+00031130: 206e 616d 6564 207b 6178 6973 7d22 290a   named {axis}").
+00031140: 2020 2020 2020 2020 2320 636f 6e76 6572          # conver
+00031150: 7420 746f 206e 756d 6572 6963 2061 7869  t to numeric axi
+00031160: 730a 2020 2020 2020 2020 6e75 6d65 7269  s.        numeri
+00031170: 635f 6178 6973 3a20 6469 6374 5b73 7472  c_axis: dict[str
+00031180: 207c 204e 6f6e 652c 204c 6974 6572 616c   | None, Literal
+00031190: 5b30 2c20 315d 5d20 3d20 7b22 696e 6465  [0, 1]] = {"inde
+000311a0: 7822 3a20 302c 2022 636f 6c75 6d6e 7322  x": 0, "columns"
+000311b0: 3a20 317d 0a20 2020 2020 2020 2069 6620  : 1}.        if 
+000311c0: 6e6f 6e65 5f69 735f 7a65 726f 3a0a 2020  none_is_zero:.  
+000311d0: 2020 2020 2020 2020 2020 6e75 6d65 7269            numeri
+000311e0: 635f 6178 6973 5b4e 6f6e 655d 203d 2030  c_axis[None] = 0
+000311f0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00031200: 206e 756d 6572 6963 5f61 7869 732e 6765   numeric_axis.ge
+00031210: 7428 6178 6973 2c20 6178 6973 290a 0a20  t(axis, axis).. 
+00031220: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00031230: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+00031240: 2020 2064 6566 2064 726f 7028 7365 6c66     def drop(self
+00031250: 2c20 6c61 6265 6c73 3d4e 6f6e 652c 2061  , labels=None, a
+00031260: 7869 733d 302c 2063 6f6c 756d 6e73 3d4e  xis=0, columns=N
+00031270: 6f6e 652c 2065 7272 6f72 733d 2272 6169  one, errors="rai
+00031280: 7365 2229 3a0a 2020 2020 2020 2020 6178  se"):.        ax
+00031290: 6973 203d 2073 656c 662e 5f76 616c 6964  is = self._valid
+000312a0: 6174 655f 6178 6973 2861 7869 7329 0a20  ate_axis(axis). 
+000312b0: 2020 2020 2020 2069 6620 6178 6973 203d         if axis =
+000312c0: 3d20 3020 616e 6420 636f 6c75 6d6e 7320  = 0 and columns 
+000312d0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+000312e0: 2020 2020 2020 2020 2023 2043 6f6c 756d           # Colum
+000312f0: 6e73 206d 7573 7420 6265 2073 7065 6369  ns must be speci
+00031300: 6669 6564 2069 6620 6178 6973 3d3d 300a  fied if axis==0.
+00031310: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00031320: 726e 2073 656c 662e 6d61 705f 7061 7274  rn self.map_part
+00031330: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
+00031340: 2020 2020 2020 2020 6472 6f70 5f62 795f          drop_by_
+00031350: 7368 616c 6c6f 775f 636f 7079 2c20 636f  shallow_copy, co
+00031360: 6c75 6d6e 732c 2065 7272 6f72 733d 6572  lumns, errors=er
+00031370: 726f 7273 2c20 656e 666f 7263 655f 6d65  rors, enforce_me
+00031380: 7461 6461 7461 3d46 616c 7365 0a20 2020  tadata=False.   
+00031390: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000313a0: 2020 2065 6c69 6620 6178 6973 203d 3d20     elif axis == 
+000313b0: 313a 0a20 2020 2020 2020 2020 2020 2072  1:.            r
+000313c0: 6574 7572 6e20 7365 6c66 2e6d 6170 5f70  eturn self.map_p
+000313d0: 6172 7469 7469 6f6e 7328 0a20 2020 2020  artitions(.     
+000313e0: 2020 2020 2020 2020 2020 2064 726f 705f             drop_
+000313f0: 6279 5f73 6861 6c6c 6f77 5f63 6f70 792c  by_shallow_copy,
+00031400: 206c 6162 656c 732c 2065 7272 6f72 733d   labels, errors=
+00031410: 6572 726f 7273 2c20 656e 666f 7263 655f  errors, enforce_
+00031420: 6d65 7461 6461 7461 3d46 616c 7365 0a20  metadata=False. 
+00031430: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00031440: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+00031450: 706c 656d 656e 7465 6445 7272 6f72 280a  plementedError(.
+00031460: 2020 2020 2020 2020 2020 2020 2244 726f              "Dro
+00031470: 7020 6375 7272 656e 746c 7920 6f6e 6c79  p currently only
+00031480: 2077 6f72 6b73 2066 6f72 2061 7869 733d   works for axis=
+00031490: 3120 6f72 2077 6865 6e20 636f 6c75 6d6e  1 or when column
+000314a0: 7320 6973 206e 6f74 204e 6f6e 6522 0a20  s is not None". 
+000314b0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+000314c0: 6620 6d65 7267 6528 0a20 2020 2020 2020  f merge(.       
+000314d0: 2073 656c 662c 0a20 2020 2020 2020 2072   self,.        r
+000314e0: 6967 6874 2c0a 2020 2020 2020 2020 686f  ight,.        ho
+000314f0: 773d 2269 6e6e 6572 222c 0a20 2020 2020  w="inner",.     
+00031500: 2020 206f 6e3d 4e6f 6e65 2c0a 2020 2020     on=None,.    
+00031510: 2020 2020 6c65 6674 5f6f 6e3d 4e6f 6e65      left_on=None
+00031520: 2c0a 2020 2020 2020 2020 7269 6768 745f  ,.        right_
+00031530: 6f6e 3d4e 6f6e 652c 0a20 2020 2020 2020  on=None,.       
+00031540: 206c 6566 745f 696e 6465 783d 4661 6c73   left_index=Fals
+00031550: 652c 0a20 2020 2020 2020 2072 6967 6874  e,.        right
+00031560: 5f69 6e64 6578 3d46 616c 7365 2c0a 2020  _index=False,.  
+00031570: 2020 2020 2020 7375 6666 6978 6573 3d28        suffixes=(
+00031580: 225f 7822 2c20 225f 7922 292c 0a20 2020  "_x", "_y"),.   
+00031590: 2020 2020 2069 6e64 6963 6174 6f72 3d46       indicator=F
+000315a0: 616c 7365 2c0a 2020 2020 2020 2020 6e70  alse,.        np
+000315b0: 6172 7469 7469 6f6e 733d 4e6f 6e65 2c0a  artitions=None,.
+000315c0: 2020 2020 2020 2020 7368 7566 666c 653d          shuffle=
+000315d0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6272  None,.        br
+000315e0: 6f61 6463 6173 743d 4e6f 6e65 2c0a 2020  oadcast=None,.  
+000315f0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+00031600: 4d65 7267 6520 7468 6520 4461 7461 4672  Merge the DataFr
+00031610: 616d 6520 7769 7468 2061 6e6f 7468 6572  ame with another
+00031620: 2044 6174 6146 7261 6d65 0a0a 2020 2020   DataFrame..    
+00031630: 2020 2020 5468 6973 2077 696c 6c20 6d65      This will me
+00031640: 7267 6520 7468 6520 7477 6f20 6461 7461  rge the two data
+00031650: 7365 7473 2c20 6569 7468 6572 206f 6e20  sets, either on 
+00031660: 7468 6520 696e 6469 6365 732c 2061 2063  the indices, a c
+00031670: 6572 7461 696e 2063 6f6c 756d 6e0a 2020  ertain column.  
+00031680: 2020 2020 2020 696e 2065 6163 6820 6461        in each da
+00031690: 7461 7365 7420 6f72 2074 6865 2069 6e64  taset or the ind
+000316a0: 6578 2069 6e20 6f6e 6520 6461 7461 7365  ex in one datase
+000316b0: 7420 616e 6420 7468 6520 636f 6c75 6d6e  t and the column
+000316c0: 2069 6e20 616e 6f74 6865 722e 0a0a 2020   in another...  
+000316d0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+000316e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000316f0: 2d2d 2d0a 2020 2020 2020 2020 7269 6768  ---.        righ
+00031700: 743a 2064 6173 6b2e 6461 7461 6672 616d  t: dask.datafram
+00031710: 652e 4461 7461 4672 616d 650a 2020 2020  e.DataFrame.    
+00031720: 2020 2020 686f 7720 3a20 7b27 6c65 6674      how : {'left
+00031730: 272c 2027 7269 6768 7427 2c20 276f 7574  ', 'right', 'out
+00031740: 6572 272c 2027 696e 6e65 7227 7d2c 2064  er', 'inner'}, d
+00031750: 6566 6175 6c74 3a20 2769 6e6e 6572 270a  efault: 'inner'.
+00031760: 2020 2020 2020 2020 2020 2020 486f 7720              How 
+00031770: 746f 2068 616e 646c 6520 7468 6520 6f70  to handle the op
+00031780: 6572 6174 696f 6e20 6f66 2074 6865 2074  eration of the t
+00031790: 776f 206f 626a 6563 7473 3a0a 0a20 2020  wo objects:..   
+000317a0: 2020 2020 2020 2020 202d 206c 6566 743a           - left:
+000317b0: 2075 7365 2063 616c 6c69 6e67 2066 7261   use calling fra
+000317c0: 6d65 2773 2069 6e64 6578 2028 6f72 2063  me's index (or c
+000317d0: 6f6c 756d 6e20 6966 206f 6e20 6973 2073  olumn if on is s
+000317e0: 7065 6369 6669 6564 290a 2020 2020 2020  pecified).      
+000317f0: 2020 2020 2020 2d20 7269 6768 743a 2075        - right: u
+00031800: 7365 206f 7468 6572 2066 7261 6d65 2773  se other frame's
+00031810: 2069 6e64 6578 0a20 2020 2020 2020 2020   index.         
+00031820: 2020 202d 206f 7574 6572 3a20 666f 726d     - outer: form
+00031830: 2075 6e69 6f6e 206f 6620 6361 6c6c 696e   union of callin
+00031840: 6720 6672 616d 6527 7320 696e 6465 7820  g frame's index 
+00031850: 286f 7220 636f 6c75 6d6e 2069 6620 6f6e  (or column if on
+00031860: 2069 730a 2020 2020 2020 2020 2020 2020   is.            
+00031870: 2020 7370 6563 6966 6965 6429 2077 6974    specified) wit
+00031880: 6820 6f74 6865 7220 6672 616d 6527 7320  h other frame's 
+00031890: 696e 6465 782c 2061 6e64 2073 6f72 7420  index, and sort 
+000318a0: 6974 0a20 2020 2020 2020 2020 2020 2020  it.             
+000318b0: 206c 6578 6963 6f67 7261 7068 6963 616c   lexicographical
+000318c0: 6c79 0a20 2020 2020 2020 2020 2020 202d  ly.            -
+000318d0: 2069 6e6e 6572 3a20 666f 726d 2069 6e74   inner: form int
+000318e0: 6572 7365 6374 696f 6e20 6f66 2063 616c  ersection of cal
+000318f0: 6c69 6e67 2066 7261 6d65 2773 2069 6e64  ling frame's ind
+00031900: 6578 2028 6f72 2063 6f6c 756d 6e20 6966  ex (or column if
+00031910: 0a20 2020 2020 2020 2020 2020 2020 206f  .              o
+00031920: 6e20 6973 2073 7065 6369 6669 6564 2920  n is specified) 
+00031930: 7769 7468 206f 7468 6572 2066 7261 6d65  with other frame
+00031940: 2773 2069 6e64 6578 2c20 7072 6573 6572  's index, preser
+00031950: 7669 6e67 2074 6865 206f 7264 6572 0a20  ving the order. 
+00031960: 2020 2020 2020 2020 2020 2020 206f 6620               of 
+00031970: 7468 6520 6361 6c6c 696e 6727 7320 6f6e  the calling's on
+00031980: 650a 0a20 2020 2020 2020 206f 6e20 3a20  e..        on : 
+00031990: 6c61 6265 6c20 6f72 206c 6973 740a 2020  label or list.  
+000319a0: 2020 2020 2020 2020 2020 436f 6c75 6d6e            Column
+000319b0: 206f 7220 696e 6465 7820 6c65 7665 6c20   or index level 
+000319c0: 6e61 6d65 7320 746f 206a 6f69 6e20 6f6e  names to join on
+000319d0: 2e20 5468 6573 6520 6d75 7374 2062 6520  . These must be 
+000319e0: 666f 756e 6420 696e 2062 6f74 680a 2020  found in both.  
+000319f0: 2020 2020 2020 2020 2020 4461 7461 4672            DataFr
+00031a00: 616d 6573 2e20 4966 206f 6e20 6973 204e  ames. If on is N
+00031a10: 6f6e 6520 616e 6420 6e6f 7420 6d65 7267  one and not merg
+00031a20: 696e 6720 6f6e 2069 6e64 6578 6573 2074  ing on indexes t
+00031a30: 6865 6e20 7468 6973 0a20 2020 2020 2020  hen this.       
+00031a40: 2020 2020 2064 6566 6175 6c74 7320 746f       defaults to
+00031a50: 2074 6865 2069 6e74 6572 7365 6374 696f   the intersectio
+00031a60: 6e20 6f66 2074 6865 2063 6f6c 756d 6e73  n of the columns
+00031a70: 2069 6e20 626f 7468 2044 6174 6146 7261   in both DataFra
+00031a80: 6d65 732e 0a20 2020 2020 2020 206c 6566  mes..        lef
+00031a90: 745f 6f6e 203a 206c 6162 656c 206f 7220  t_on : label or 
+00031aa0: 6c69 7374 2c20 6f72 2061 7272 6179 2d6c  list, or array-l
+00031ab0: 696b 650a 2020 2020 2020 2020 2020 2020  ike.            
+00031ac0: 436f 6c75 6d6e 2074 6f20 6a6f 696e 206f  Column to join o
+00031ad0: 6e20 696e 2074 6865 206c 6566 7420 4461  n in the left Da
+00031ae0: 7461 4672 616d 652e 204f 7468 6572 2074  taFrame. Other t
+00031af0: 6861 6e20 696e 2070 616e 6461 730a 2020  han in pandas.  
+00031b00: 2020 2020 2020 2020 2020 6172 7261 7973            arrays
+00031b10: 2061 6e64 206c 6973 7473 2061 7265 206f   and lists are o
+00031b20: 6e6c 7920 7375 7070 6f72 7420 6966 2074  nly support if t
+00031b30: 6865 6972 206c 656e 6774 6820 6973 2031  heir length is 1
+00031b40: 2e0a 2020 2020 2020 2020 7269 6768 745f  ..        right_
+00031b50: 6f6e 203a 206c 6162 656c 206f 7220 6c69  on : label or li
+00031b60: 7374 2c20 6f72 2061 7272 6179 2d6c 696b  st, or array-lik
+00031b70: 650a 2020 2020 2020 2020 2020 2020 436f  e.            Co
+00031b80: 6c75 6d6e 2074 6f20 6a6f 696e 206f 6e20  lumn to join on 
+00031b90: 696e 2074 6865 2072 6967 6874 2044 6174  in the right Dat
+00031ba0: 6146 7261 6d65 2e20 4f74 6865 7220 7468  aFrame. Other th
+00031bb0: 616e 2069 6e20 7061 6e64 6173 0a20 2020  an in pandas.   
+00031bc0: 2020 2020 2020 2020 2061 7272 6179 7320           arrays 
+00031bd0: 616e 6420 6c69 7374 7320 6172 6520 6f6e  and lists are on
+00031be0: 6c79 2073 7570 706f 7274 2069 6620 7468  ly support if th
+00031bf0: 6569 7220 6c65 6e67 7468 2069 7320 312e  eir length is 1.
+00031c00: 0a20 2020 2020 2020 206c 6566 745f 696e  .        left_in
+00031c10: 6465 7820 3a20 626f 6f6c 6561 6e2c 2064  dex : boolean, d
+00031c20: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
+00031c30: 2020 2020 2020 2020 2055 7365 2074 6865           Use the
+00031c40: 2069 6e64 6578 2066 726f 6d20 7468 6520   index from the 
+00031c50: 6c65 6674 2044 6174 6146 7261 6d65 2061  left DataFrame a
+00031c60: 7320 7468 6520 6a6f 696e 206b 6579 2e0a  s the join key..
+00031c70: 2020 2020 2020 2020 7269 6768 745f 696e          right_in
+00031c80: 6465 7820 3a20 626f 6f6c 6561 6e2c 2064  dex : boolean, d
+00031c90: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
+00031ca0: 2020 2020 2020 2020 2055 7365 2074 6865           Use the
+00031cb0: 2069 6e64 6578 2066 726f 6d20 7468 6520   index from the 
+00031cc0: 7269 6768 7420 4461 7461 4672 616d 6520  right DataFrame 
+00031cd0: 6173 2074 6865 206a 6f69 6e20 6b65 792e  as the join key.
+00031ce0: 0a20 2020 2020 2020 2073 7566 6669 7865  .        suffixe
+00031cf0: 7320 3a20 322d 6c65 6e67 7468 2073 6571  s : 2-length seq
+00031d00: 7565 6e63 6520 2874 7570 6c65 2c20 6c69  uence (tuple, li
+00031d10: 7374 2c20 2e2e 2e29 0a20 2020 2020 2020  st, ...).       
+00031d20: 2020 2020 2053 7566 6669 7820 746f 2061       Suffix to a
+00031d30: 7070 6c79 2074 6f20 6f76 6572 6c61 7070  pply to overlapp
+00031d40: 696e 6720 636f 6c75 6d6e 206e 616d 6573  ing column names
+00031d50: 2069 6e20 7468 6520 6c65 6674 2061 6e64   in the left and
+00031d60: 0a20 2020 2020 2020 2020 2020 2072 6967  .            rig
+00031d70: 6874 2073 6964 652c 2072 6573 7065 6374  ht side, respect
+00031d80: 6976 656c 790a 2020 2020 2020 2020 696e  ively.        in
+00031d90: 6469 6361 746f 7220 3a20 626f 6f6c 6561  dicator : boolea
+00031da0: 6e20 6f72 2073 7472 696e 672c 2064 6566  n or string, def
+00031db0: 6175 6c74 2046 616c 7365 0a20 2020 2020  ault False.     
+00031dc0: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
+00031dd0: 6164 6473 2061 2063 6f6c 756d 6e20 746f  adds a column to
+00031de0: 206f 7574 7075 7420 4461 7461 4672 616d   output DataFram
+00031df0: 6520 6361 6c6c 6564 2022 5f6d 6572 6765  e called "_merge
+00031e00: 2220 7769 7468 0a20 2020 2020 2020 2020  " with.         
+00031e10: 2020 2069 6e66 6f72 6d61 7469 6f6e 206f     information o
+00031e20: 6e20 7468 6520 736f 7572 6365 206f 6620  n the source of 
+00031e30: 6561 6368 2072 6f77 2e20 4966 2073 7472  each row. If str
+00031e40: 696e 672c 2063 6f6c 756d 6e20 7769 7468  ing, column with
+00031e50: 0a20 2020 2020 2020 2020 2020 2069 6e66  .            inf
+00031e60: 6f72 6d61 7469 6f6e 206f 6e20 736f 7572  ormation on sour
+00031e70: 6365 206f 6620 6561 6368 2072 6f77 2077  ce of each row w
+00031e80: 696c 6c20 6265 2061 6464 6564 2074 6f20  ill be added to 
+00031e90: 6f75 7470 7574 2044 6174 6146 7261 6d65  output DataFrame
+00031ea0: 2c0a 2020 2020 2020 2020 2020 2020 616e  ,.            an
+00031eb0: 6420 636f 6c75 6d6e 2077 696c 6c20 6265  d column will be
+00031ec0: 206e 616d 6564 2076 616c 7565 206f 6620   named value of 
+00031ed0: 7374 7269 6e67 2e20 496e 666f 726d 6174  string. Informat
+00031ee0: 696f 6e20 636f 6c75 6d6e 2069 730a 2020  ion column is.  
+00031ef0: 2020 2020 2020 2020 2020 4361 7465 676f            Catego
+00031f00: 7269 6361 6c2d 7479 7065 2061 6e64 2074  rical-type and t
+00031f10: 616b 6573 206f 6e20 6120 7661 6c75 6520  akes on a value 
+00031f20: 6f66 2022 6c65 6674 5f6f 6e6c 7922 2066  of "left_only" f
+00031f30: 6f72 206f 6273 6572 7661 7469 6f6e 730a  or observations.
+00031f40: 2020 2020 2020 2020 2020 2020 7768 6f73              whos
+00031f50: 6520 6d65 7267 6520 6b65 7920 6f6e 6c79  e merge key only
+00031f60: 2061 7070 6561 7273 2069 6e20 606c 6566   appears in `lef
+00031f70: 7460 2044 6174 6146 7261 6d65 2c20 2272  t` DataFrame, "r
+00031f80: 6967 6874 5f6f 6e6c 7922 2066 6f72 0a20  ight_only" for. 
+00031f90: 2020 2020 2020 2020 2020 206f 6273 6572             obser
+00031fa0: 7661 7469 6f6e 7320 7768 6f73 6520 6d65  vations whose me
+00031fb0: 7267 6520 6b65 7920 6f6e 6c79 2061 7070  rge key only app
+00031fc0: 6561 7273 2069 6e20 6072 6967 6874 6020  ears in `right` 
+00031fd0: 4461 7461 4672 616d 652c 0a20 2020 2020  DataFrame,.     
+00031fe0: 2020 2020 2020 2061 6e64 2022 626f 7468         and "both
+00031ff0: 2220 6966 2074 6865 206f 6273 6572 7661  " if the observa
+00032000: 7469 6f6e e280 9973 206d 6572 6765 206b  tion...s merge k
+00032010: 6579 2069 7320 666f 756e 6420 696e 2062  ey is found in b
+00032020: 6f74 682e 0a20 2020 2020 2020 206e 7061  oth..        npa
+00032030: 7274 6974 696f 6e73 3a20 696e 7420 6f72  rtitions: int or
+00032040: 204e 6f6e 652c 206f 7074 696f 6e61 6c0a   None, optional.
+00032050: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+00032060: 6964 6561 6c20 6e75 6d62 6572 206f 6620  ideal number of 
+00032070: 6f75 7470 7574 2070 6172 7469 7469 6f6e  output partition
+00032080: 732e 2054 6869 7320 6973 206f 6e6c 7920  s. This is only 
+00032090: 7574 696c 6973 6564 2077 6865 6e0a 2020  utilised when.  
+000320a0: 2020 2020 2020 2020 2020 7065 7266 6f72            perfor
+000320b0: 6d69 6e67 2061 2068 6173 685f 6a6f 696e  ming a hash_join
+000320c0: 2028 6d65 7267 696e 6720 6f6e 2063 6f6c   (merging on col
+000320d0: 756d 6e73 206f 6e6c 7929 2e20 4966 2060  umns only). If `
+000320e0: 604e 6f6e 6560 6020 7468 656e 0a20 2020  `None`` then.   
+000320f0: 2020 2020 2020 2020 2060 606e 7061 7274           ``npart
+00032100: 6974 696f 6e73 203d 206d 6178 286c 6873  itions = max(lhs
+00032110: 2e6e 7061 7274 6974 696f 6e73 2c20 7268  .npartitions, rh
+00032120: 732e 6e70 6172 7469 7469 6f6e 7329 6060  s.npartitions)``
+00032130: 2e0a 2020 2020 2020 2020 2020 2020 4465  ..            De
+00032140: 6661 756c 7420 6973 2060 604e 6f6e 6560  fault is ``None`
+00032150: 602e 0a20 2020 2020 2020 2073 6875 6666  `..        shuff
+00032160: 6c65 3a20 7b27 6469 736b 272c 2027 7461  le: {'disk', 'ta
+00032170: 736b 7327 7d2c 206f 7074 696f 6e61 6c0a  sks'}, optional.
+00032180: 2020 2020 2020 2020 2020 2020 4569 7468              Eith
+00032190: 6572 2060 6027 6469 736b 2760 6020 666f  er ``'disk'`` fo
+000321a0: 7220 7369 6e67 6c65 2d6e 6f64 6520 6f70  r single-node op
+000321b0: 6572 6174 696f 6e20 6f72 2060 6027 7461  eration or ``'ta
+000321c0: 736b 7327 6060 2066 6f72 0a20 2020 2020  sks'`` for.     
+000321d0: 2020 2020 2020 2064 6973 7472 6962 7574         distribut
+000321e0: 6564 206f 7065 7261 7469 6f6e 2e20 2057  ed operation.  W
+000321f0: 696c 6c20 6265 2069 6e66 6572 7265 6420  ill be inferred 
+00032200: 6279 2079 6f75 7220 6375 7272 656e 7420  by your current 
+00032210: 7363 6865 6475 6c65 722e 0a20 2020 2020  scheduler..     
+00032220: 2020 2062 726f 6164 6361 7374 3a20 626f     broadcast: bo
+00032230: 6f6c 6561 6e20 6f72 2066 6c6f 6174 2c20  olean or float, 
+00032240: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00032250: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
+00032260: 7573 6520 6120 6272 6f61 6463 6173 742d  use a broadcast-
+00032270: 6261 7365 6420 6a6f 696e 2069 6e20 6c69  based join in li
+00032280: 6575 206f 6620 6120 7368 7566 666c 652d  eu of a shuffle-
+00032290: 6261 7365 640a 2020 2020 2020 2020 2020  based.          
+000322a0: 2020 6a6f 696e 2066 6f72 2073 7570 706f    join for suppo
+000322b0: 7274 6564 2063 6173 6573 2e20 2042 7920  rted cases.  By 
+000322c0: 6465 6661 756c 742c 2061 2073 696d 706c  default, a simpl
+000322d0: 6520 6865 7572 6973 7469 6320 7769 6c6c  e heuristic will
+000322e0: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
+000322f0: 7573 6564 2074 6f20 7365 6c65 6374 2074  used to select t
+00032300: 6865 2075 6e64 6572 6c79 696e 6720 616c  he underlying al
+00032310: 676f 7269 7468 6d2e 2049 6620 6120 666c  gorithm. If a fl
+00032320: 6f61 7469 6e67 2d70 6f69 6e74 2076 616c  oating-point val
+00032330: 7565 0a20 2020 2020 2020 2020 2020 2069  ue.            i
+00032340: 7320 7370 6563 6966 6965 642c 2074 6861  s specified, tha
+00032350: 7420 6e75 6d62 6572 2077 696c 6c20 6265  t number will be
+00032360: 2075 7365 6420 6173 2074 6865 2060 6062   used as the ``b
+00032370: 726f 6164 6361 7374 5f62 6961 7360 600a  roadcast_bias``.
+00032380: 2020 2020 2020 2020 2020 2020 7769 7468              with
+00032390: 696e 2074 6865 2073 696d 706c 6520 6865  in the simple he
+000323a0: 7572 6973 7469 6320 2861 206c 6172 6765  uristic (a large
+000323b0: 206e 756d 6265 7220 6d61 6b65 7320 4461   number makes Da
+000323c0: 736b 206d 6f72 6520 6c69 6b65 6c79 0a20  sk more likely. 
+000323d0: 2020 2020 2020 2020 2020 2074 6f20 6368             to ch
+000323e0: 6f6f 7365 2074 6865 2060 6062 726f 6163  oose the ``broac
+000323f0: 6173 745f 6a6f 696e 6060 2063 6f64 6520  ast_join`` code 
+00032400: 7061 7468 292e 2053 6565 2060 6062 726f  path). See ``bro
+00032410: 6164 6361 7374 5f6a 6f69 6e60 600a 2020  adcast_join``.  
+00032420: 2020 2020 2020 2020 2020 666f 7220 6d6f            for mo
+00032430: 7265 2069 6e66 6f72 6d61 7469 6f6e 2e0a  re information..
+00032440: 0a20 2020 2020 2020 204e 6f74 6573 0a20  .        Notes. 
+00032450: 2020 2020 2020 202d 2d2d 2d2d 0a0a 2020         -----..  
+00032460: 2020 2020 2020 5468 6572 6520 6172 6520        There are 
+00032470: 7468 7265 6520 7761 7973 2074 6f20 6a6f  three ways to jo
+00032480: 696e 2064 6174 6166 7261 6d65 733a 0a0a  in dataframes:..
+00032490: 2020 2020 2020 2020 312e 204a 6f69 6e69          1. Joini
+000324a0: 6e67 206f 6e20 696e 6469 6365 732e 2049  ng on indices. I
+000324b0: 6e20 7468 6973 2063 6173 6520 7468 6520  n this case the 
+000324c0: 6469 7669 7369 6f6e 7320 6172 650a 2020  divisions are.  
+000324d0: 2020 2020 2020 2020 2061 6c69 676e 6564           aligned
+000324e0: 2075 7369 6e67 2074 6865 2066 756e 6374   using the funct
+000324f0: 696f 6e20 6060 6461 736b 2e64 6174 6166  ion ``dask.dataf
+00032500: 7261 6d65 2e6d 756c 7469 2e61 6c69 676e  rame.multi.align
+00032510: 5f70 6172 7469 7469 6f6e 7360 602e 0a20  _partitions``.. 
+00032520: 2020 2020 2020 2020 2020 4166 7465 7277            Afterw
+00032530: 6172 6473 2c20 6561 6368 2070 6172 7469  ards, each parti
+00032540: 7469 6f6e 2069 7320 6d65 7267 6564 2077  tion is merged w
+00032550: 6974 6820 7468 6520 7061 6e64 6173 206d  ith the pandas m
+00032560: 6572 6765 2066 756e 6374 696f 6e2e 0a0a  erge function...
+00032570: 2020 2020 2020 2020 322e 204a 6f69 6e69          2. Joini
+00032580: 6e67 206f 6e65 206f 6e20 696e 6465 7820  ng one on index 
+00032590: 616e 6420 6f6e 6520 6f6e 2063 6f6c 756d  and one on colum
+000325a0: 6e2e 2049 6e20 7468 6973 2063 6173 6520  n. In this case 
+000325b0: 7468 6520 6469 7669 7369 6f6e 7320 6f66  the divisions of
+000325c0: 0a20 2020 2020 2020 2020 2020 6461 7461  .           data
+000325d0: 6672 616d 6520 6d65 7267 6564 2062 7920  frame merged by 
+000325e0: 696e 6465 7820 283a 6d61 7468 3a60 645f  index (:math:`d_
+000325f0: 6960 2920 6172 6520 7573 6564 2074 6f20  i`) are used to 
+00032600: 6469 7669 6465 2074 6865 2063 6f6c 756d  divide the colum
+00032610: 6e0a 2020 2020 2020 2020 2020 206d 6572  n.           mer
+00032620: 6765 6420 6461 7461 6672 616d 6520 283a  ged dataframe (:
+00032630: 6d61 7468 3a60 645f 6360 2920 6f6e 6520  math:`d_c`) one 
+00032640: 7573 696e 670a 2020 2020 2020 2020 2020  using.          
+00032650: 2060 6064 6173 6b2e 6461 7461 6672 616d   ``dask.datafram
+00032660: 652e 6d75 6c74 692e 7265 6172 7261 6e67  e.multi.rearrang
+00032670: 655f 6279 5f64 6976 6973 696f 6e73 6060  e_by_divisions``
+00032680: 2e20 496e 2074 6869 7320 6361 7365 2074  . In this case t
+00032690: 6865 0a20 2020 2020 2020 2020 2020 6d65  he.           me
+000326a0: 7267 6564 2064 6174 6166 7261 6d65 2028  rged dataframe (
+000326b0: 3a6d 6174 683a 6064 5f6d 6029 2068 6173  :math:`d_m`) has
+000326c0: 2074 6865 2065 7861 6374 2073 616d 6520   the exact same 
+000326d0: 6469 7669 7369 6f6e 730a 2020 2020 2020  divisions.      
+000326e0: 2020 2020 2061 7320 283a 6d61 7468 3a60       as (:math:`
+000326f0: 645f 6960 292e 2054 6869 7320 6361 6e20  d_i`). This can 
+00032700: 6c65 6164 2074 6f20 6973 7375 6573 2069  lead to issues i
+00032710: 6620 796f 7520 6d65 7267 6520 6d75 6c74  f you merge mult
+00032720: 6970 6c65 2072 6f77 7320 6672 6f6d 0a20  iple rows from. 
+00032730: 2020 2020 2020 2020 2020 283a 6d61 7468            (:math
+00032740: 3a60 645f 6360 2920 746f 206f 6e65 2072  :`d_c`) to one r
+00032750: 6f77 2069 6e20 283a 6d61 7468 3a60 645f  ow in (:math:`d_
+00032760: 6960 292e 0a0a 2020 2020 2020 2020 332e  i`)...        3.
+00032770: 204a 6f69 6e69 6e67 2062 6f74 6820 6f6e   Joining both on
+00032780: 2063 6f6c 756d 6e73 2e20 496e 2074 6869   columns. In thi
+00032790: 7320 6361 7365 2061 2068 6173 6820 6a6f  s case a hash jo
+000327a0: 696e 2069 7320 7065 7266 6f72 6d65 6420  in is performed 
+000327b0: 7573 696e 670a 2020 2020 2020 2020 2020  using.          
+000327c0: 2060 6064 6173 6b2e 6461 7461 6672 616d   ``dask.datafram
+000327d0: 652e 6d75 6c74 692e 6861 7368 5f6a 6f69  e.multi.hash_joi
+000327e0: 6e60 602e 0a0a 2020 2020 2020 2020 496e  n``...        In
+000327f0: 2073 6f6d 6520 6361 7365 732c 2079 6f75   some cases, you
+00032800: 206d 6179 2073 6565 2061 2060 604d 656d   may see a ``Mem
+00032810: 6f72 7945 7272 6f72 6060 2069 6620 7468  oryError`` if th
+00032820: 6520 6060 6d65 7267 6560 6020 6f70 6572  e ``merge`` oper
+00032830: 6174 696f 6e20 7265 7175 6972 6573 0a20  ation requires. 
+00032840: 2020 2020 2020 2061 6e20 696e 7465 726e         an intern
+00032850: 616c 2060 6073 6875 6666 6c65 6060 2c20  al ``shuffle``, 
+00032860: 6265 6361 7573 6520 7368 7566 666c 696e  because shufflin
+00032870: 6720 706c 6163 6573 2061 6c6c 2072 6f77  g places all row
+00032880: 7320 7468 6174 2068 6176 6520 7468 6520  s that have the 
+00032890: 7361 6d65 0a20 2020 2020 2020 2069 6e64  same.        ind
+000328a0: 6578 2069 6e20 7468 6520 7361 6d65 2070  ex in the same p
+000328b0: 6172 7469 7469 6f6e 2e20 546f 2061 766f  artition. To avo
+000328c0: 6964 2074 6869 7320 6572 726f 722c 206d  id this error, m
+000328d0: 616b 6520 7375 7265 2061 6c6c 2072 6f77  ake sure all row
+000328e0: 7320 7769 7468 2074 6865 0a20 2020 2020  s with the.     
+000328f0: 2020 2073 616d 6520 6060 6f6e 6060 2d63     same ``on``-c
+00032900: 6f6c 756d 6e20 7661 6c75 6520 6361 6e20  olumn value can 
+00032910: 6669 7420 6f6e 2061 2073 696e 676c 6520  fit on a single 
+00032920: 7061 7274 6974 696f 6e2e 0a20 2020 2020  partition..     
+00032930: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+00032940: 6966 206e 6f74 2069 735f 6461 7461 6672  if not is_datafr
+00032950: 616d 655f 6c69 6b65 2872 6967 6874 293a  ame_like(right):
+00032960: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00032970: 7365 2056 616c 7565 4572 726f 7228 2272  se ValueError("r
+00032980: 6967 6874 206d 7573 7420 6265 2044 6174  ight must be Dat
+00032990: 6146 7261 6d65 2229 0a0a 2020 2020 2020  aFrame")..      
+000329a0: 2020 6672 6f6d 2064 6173 6b2e 6461 7461    from dask.data
+000329b0: 6672 616d 652e 6d75 6c74 6920 696d 706f  frame.multi impo
+000329c0: 7274 206d 6572 6765 0a0a 2020 2020 2020  rt merge..      
+000329d0: 2020 7265 7475 726e 206d 6572 6765 280a    return merge(.
+000329e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000329f0: 2c0a 2020 2020 2020 2020 2020 2020 7269  ,.            ri
+00032a00: 6768 742c 0a20 2020 2020 2020 2020 2020  ght,.           
+00032a10: 2068 6f77 3d68 6f77 2c0a 2020 2020 2020   how=how,.      
+00032a20: 2020 2020 2020 6f6e 3d6f 6e2c 0a20 2020        on=on,.   
+00032a30: 2020 2020 2020 2020 206c 6566 745f 6f6e           left_on
+00032a40: 3d6c 6566 745f 6f6e 2c0a 2020 2020 2020  =left_on,.      
+00032a50: 2020 2020 2020 7269 6768 745f 6f6e 3d72        right_on=r
+00032a60: 6967 6874 5f6f 6e2c 0a20 2020 2020 2020  ight_on,.       
+00032a70: 2020 2020 206c 6566 745f 696e 6465 783d       left_index=
+00032a80: 6c65 6674 5f69 6e64 6578 2c0a 2020 2020  left_index,.    
+00032a90: 2020 2020 2020 2020 7269 6768 745f 696e          right_in
+00032aa0: 6465 783d 7269 6768 745f 696e 6465 782c  dex=right_index,
+00032ab0: 0a20 2020 2020 2020 2020 2020 2073 7566  .            suf
+00032ac0: 6669 7865 733d 7375 6666 6978 6573 2c0a  fixes=suffixes,.
+00032ad0: 2020 2020 2020 2020 2020 2020 6e70 6172              npar
+00032ae0: 7469 7469 6f6e 733d 6e70 6172 7469 7469  titions=npartiti
+00032af0: 6f6e 732c 0a20 2020 2020 2020 2020 2020  ons,.           
+00032b00: 2069 6e64 6963 6174 6f72 3d69 6e64 6963   indicator=indic
+00032b10: 6174 6f72 2c0a 2020 2020 2020 2020 2020  ator,.          
+00032b20: 2020 7368 7566 666c 653d 7368 7566 666c    shuffle=shuffl
+00032b30: 652c 0a20 2020 2020 2020 2020 2020 2062  e,.            b
+00032b40: 726f 6164 6361 7374 3d62 726f 6164 6361  roadcast=broadca
+00032b50: 7374 2c0a 2020 2020 2020 2020 290a 0a20  st,.        ).. 
+00032b60: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
+00032b70: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
+00032b80: 2020 2064 6566 206a 6f69 6e28 0a20 2020     def join(.   
+00032b90: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00032ba0: 2020 206f 7468 6572 2c0a 2020 2020 2020     other,.      
+00032bb0: 2020 6f6e 3d4e 6f6e 652c 0a20 2020 2020    on=None,.     
+00032bc0: 2020 2068 6f77 3d22 6c65 6674 222c 0a20     how="left",. 
+00032bd0: 2020 2020 2020 206c 7375 6666 6978 3d22         lsuffix="
+00032be0: 222c 0a20 2020 2020 2020 2072 7375 6666  ",.        rsuff
+00032bf0: 6978 3d22 222c 0a20 2020 2020 2020 206e  ix="",.        n
+00032c00: 7061 7274 6974 696f 6e73 3d4e 6f6e 652c  partitions=None,
+00032c10: 0a20 2020 2020 2020 2073 6875 6666 6c65  .        shuffle
+00032c20: 3d4e 6f6e 652c 0a20 2020 2029 3a0a 2020  =None,.    ):.  
+00032c30: 2020 2020 2020 6966 2069 735f 7365 7269        if is_seri
+00032c40: 6573 5f6c 696b 6528 6f74 6865 7229 2061  es_like(other) a
+00032c50: 6e64 2068 6173 6174 7472 286f 7468 6572  nd hasattr(other
+00032c60: 2c20 226e 616d 6522 293a 0a20 2020 2020  , "name"):.     
+00032c70: 2020 2020 2020 206f 7468 6572 203d 206f         other = o
+00032c80: 7468 6572 2e74 6f5f 6672 616d 6528 290a  ther.to_frame().
+00032c90: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00032ca0: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
+00032cb0: 6528 6f74 6865 7229 3a0a 2020 2020 2020  e(other):.      
+00032cc0: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+00032cd0: 6e73 7461 6e63 6528 6f74 6865 722c 206c  nstance(other, l
+00032ce0: 6973 7429 206f 7220 6e6f 7420 616c 6c28  ist) or not all(
+00032cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032d00: 205b 6973 5f64 6174 6166 7261 6d65 5f6c   [is_dataframe_l
+00032d10: 696b 6528 6f29 2066 6f72 206f 2069 6e20  ike(o) for o in 
+00032d20: 6f74 6865 725d 0a20 2020 2020 2020 2020  other].         
+00032d30: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00032d40: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00032d50: 6545 7272 6f72 2822 6f74 6865 7220 6d75  eError("other mu
+00032d60: 7374 2062 6520 4461 7461 4672 616d 6520  st be DataFrame 
+00032d70: 6f72 206c 6973 7420 6f66 2044 6174 6146  or list of DataF
+00032d80: 7261 6d65 7322 290a 2020 2020 2020 2020  rames").        
+00032d90: 2020 2020 6966 2068 6f77 206e 6f74 2069      if how not i
+00032da0: 6e20 5b22 6f75 7465 7222 2c20 226c 6566  n ["outer", "lef
+00032db0: 7422 5d3a 0a20 2020 2020 2020 2020 2020  t"]:.           
+00032dc0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00032dd0: 4572 726f 7228 226d 6572 6765 5f6d 756c  Error("merge_mul
+00032de0: 7469 206f 6e6c 7920 7375 7070 6f72 7473  ti only supports
+00032df0: 206c 6566 7420 6f72 206f 7574 6572 206a   left or outer j
+00032e00: 6f69 6e73 2229 0a0a 2020 2020 2020 2020  oins")..        
+00032e10: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
+00032e20: 7461 6672 616d 652e 6d75 6c74 6920 696d  taframe.multi im
+00032e30: 706f 7274 205f 7265 6375 7273 6976 655f  port _recursive_
+00032e40: 7061 6972 7769 7365 5f6f 7574 6572 5f6a  pairwise_outer_j
+00032e50: 6f69 6e0a 0a20 2020 2020 2020 2020 2020  oin..           
+00032e60: 2023 2049 6620 6974 7320 616e 206f 7574   # If its an out
+00032e70: 6572 206a 6f69 6e20 7765 2063 616e 2075  er join we can u
+00032e80: 7365 2074 6865 2066 756c 6c20 7265 6375  se the full recu
+00032e90: 7273 6976 6520 7061 6972 7769 7365 206a  rsive pairwise j
+00032ea0: 6f69 6e2e 0a20 2020 2020 2020 2020 2020  oin..           
+00032eb0: 2069 6620 686f 7720 3d3d 2022 6f75 7465   if how == "oute
+00032ec0: 7222 3a0a 2020 2020 2020 2020 2020 2020  r":.            
+00032ed0: 2020 2020 6675 6c6c 203d 205b 7365 6c66      full = [self
+00032ee0: 5d20 2b20 6f74 6865 720a 0a20 2020 2020  ] + other..     
+00032ef0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00032f00: 6e20 5f72 6563 7572 7369 7665 5f70 6169  n _recursive_pai
+00032f10: 7277 6973 655f 6f75 7465 725f 6a6f 696e  rwise_outer_join
+00032f20: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00032f30: 2020 2020 2020 6675 6c6c 2c0a 2020 2020        full,.    
+00032f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032f50: 6f6e 3d6f 6e2c 0a20 2020 2020 2020 2020  on=on,.         
+00032f60: 2020 2020 2020 2020 2020 206c 7375 6666             lsuff
+00032f70: 6978 3d6c 7375 6666 6978 2c0a 2020 2020  ix=lsuffix,.    
+00032f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032f90: 7273 7566 6669 783d 7273 7566 6669 782c  rsuffix=rsuffix,
+00032fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032fb0: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
+00032fc0: 3d6e 7061 7274 6974 696f 6e73 2c0a 2020  =npartitions,.  
+00032fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032fe0: 2020 7368 7566 666c 653d 7368 7566 666c    shuffle=shuffl
+00032ff0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00033000: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00033010: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00033020: 2020 2020 2020 2023 2044 6f20 7265 6375         # Do recu
+00033030: 7273 6976 6520 7061 6972 7769 7365 206a  rsive pairwise j
+00033040: 6f69 6e20 6f6e 2065 7665 7279 7468 696e  oin on everythin
+00033050: 6720 5f65 7863 6570 745f 2074 6865 206c  g _except_ the l
+00033060: 6173 7420 6a6f 696e 0a20 2020 2020 2020  ast join.       
+00033070: 2020 2020 2020 2020 2023 2077 6865 7265           # where
+00033080: 2077 6520 6e65 6564 2074 6f20 646f 2061   we need to do a
+00033090: 206c 6566 7420 6a6f 696e 2e0a 2020 2020   left join..    
+000330a0: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
+000330b0: 7220 3d20 5f72 6563 7572 7369 7665 5f70  r = _recursive_p
+000330c0: 6169 7277 6973 655f 6f75 7465 725f 6a6f  airwise_outer_jo
+000330d0: 696e 280a 2020 2020 2020 2020 2020 2020  in(.            
+000330e0: 2020 2020 2020 2020 6f74 6865 722c 0a20          other,. 
+000330f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033100: 2020 206f 6e3d 6f6e 2c0a 2020 2020 2020     on=on,.      
+00033110: 2020 2020 2020 2020 2020 2020 2020 6c73                ls
+00033120: 7566 6669 783d 6c73 7566 6669 782c 0a20  uffix=lsuffix,. 
+00033130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033140: 2020 2072 7375 6666 6978 3d72 7375 6666     rsuffix=rsuff
+00033150: 6978 2c0a 2020 2020 2020 2020 2020 2020  ix,.            
+00033160: 2020 2020 2020 2020 6e70 6172 7469 7469          npartiti
+00033170: 6f6e 733d 6e70 6172 7469 7469 6f6e 732c  ons=npartitions,
+00033180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033190: 2020 2020 2073 6875 6666 6c65 3d73 6875       shuffle=shu
+000331a0: 6666 6c65 2c0a 2020 2020 2020 2020 2020  ffle,.          
+000331b0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000331c0: 2066 726f 6d20 6461 736b 2e64 6174 6166   from dask.dataf
+000331d0: 7261 6d65 2e6d 756c 7469 2069 6d70 6f72  rame.multi impor
+000331e0: 7420 6d65 7267 650a 0a20 2020 2020 2020  t merge..       
+000331f0: 2072 6574 7572 6e20 6d65 7267 6528 0a20   return merge(. 
+00033200: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+00033210: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
+00033220: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+00033230: 686f 773d 686f 772c 0a20 2020 2020 2020  how=how,.       
+00033240: 2020 2020 206c 6566 745f 696e 6465 783d       left_index=
+00033250: 6f6e 2069 7320 4e6f 6e65 2c0a 2020 2020  on is None,.    
+00033260: 2020 2020 2020 2020 7269 6768 745f 696e          right_in
+00033270: 6465 783d 5472 7565 2c0a 2020 2020 2020  dex=True,.      
+00033280: 2020 2020 2020 6c65 6674 5f6f 6e3d 6f6e        left_on=on
+00033290: 2c0a 2020 2020 2020 2020 2020 2020 7375  ,.            su
+000332a0: 6666 6978 6573 3d28 6c73 7566 6669 782c  ffixes=(lsuffix,
+000332b0: 2072 7375 6666 6978 292c 0a20 2020 2020   rsuffix),.     
+000332c0: 2020 2020 2020 206e 7061 7274 6974 696f         npartitio
+000332d0: 6e73 3d6e 7061 7274 6974 696f 6e73 2c0a  ns=npartitions,.
+000332e0: 2020 2020 2020 2020 2020 2020 7368 7566              shuf
+000332f0: 666c 653d 7368 7566 666c 652c 0a20 2020  fle=shuffle,.   
+00033300: 2020 2020 2029 0a0a 2020 2020 6966 206e       )..    if n
+00033310: 6f74 2050 414e 4441 535f 4754 5f32 3030  ot PANDAS_GT_200
+00033320: 3a0a 0a20 2020 2020 2020 2040 6465 7269  :..        @deri
+00033330: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+00033340: 4672 616d 6529 0a20 2020 2020 2020 2064  Frame).        d
+00033350: 6566 2061 7070 656e 6428 7365 6c66 2c20  ef append(self, 
+00033360: 6f74 6865 722c 2069 6e74 6572 6c65 6176  other, interleav
+00033370: 655f 7061 7274 6974 696f 6e73 3d46 616c  e_partitions=Fal
+00033380: 7365 293a 0a20 2020 2020 2020 2020 2020  se):.           
+00033390: 2069 6620 6973 696e 7374 616e 6365 286f   if isinstance(o
+000333a0: 7468 6572 2c20 5365 7269 6573 293a 0a20  ther, Series):. 
+000333b0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+000333c0: 7367 203d 2028 0a20 2020 2020 2020 2020  sg = (.         
+000333d0: 2020 2020 2020 2020 2020 2022 556e 6162             "Unab
+000333e0: 6c65 2074 6f20 6170 7065 6e64 696e 6720  le to appending 
+000333f0: 6464 2e53 6572 6965 7320 746f 2064 642e  dd.Series to dd.
+00033400: 4461 7461 4672 616d 652e 220a 2020 2020  DataFrame.".    
+00033410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033420: 2255 7365 2070 642e 5365 7269 6573 2074  "Use pd.Series t
+00033430: 6f20 6170 7065 6e64 2061 7320 726f 772e  o append as row.
+00033440: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00033450: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00033460: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00033470: 7272 6f72 286d 7367 290a 2020 2020 2020  rror(msg).      
+00033480: 2020 2020 2020 656c 6966 2069 735f 7365        elif is_se
+00033490: 7269 6573 5f6c 696b 6528 6f74 6865 7229  ries_like(other)
+000334a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000334b0: 2020 6f74 6865 7220 3d20 6f74 6865 722e    other = other.
+000334c0: 746f 5f66 7261 6d65 2829 2e54 0a20 2020  to_frame().T.   
+000334d0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000334e0: 7375 7065 7228 292e 6170 7065 6e64 286f  super().append(o
+000334f0: 7468 6572 2c20 696e 7465 726c 6561 7665  ther, interleave
+00033500: 5f70 6172 7469 7469 6f6e 733d 696e 7465  _partitions=inte
+00033510: 726c 6561 7665 5f70 6172 7469 7469 6f6e  rleave_partition
+00033520: 7329 0a0a 2020 2020 4064 6572 6976 6564  s)..    @derived
+00033530: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+00033540: 6d65 290a 2020 2020 6465 6620 6974 6572  me).    def iter
+00033550: 726f 7773 2873 656c 6629 3a0a 2020 2020  rows(self):.    
+00033560: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00033570: 6765 2873 656c 662e 6e70 6172 7469 7469  ge(self.npartiti
+00033580: 6f6e 7329 3a0a 2020 2020 2020 2020 2020  ons):.          
+00033590: 2020 6466 203d 2073 656c 662e 6765 745f    df = self.get_
+000335a0: 7061 7274 6974 696f 6e28 6929 2e63 6f6d  partition(i).com
+000335b0: 7075 7465 2829 0a20 2020 2020 2020 2020  pute().         
+000335c0: 2020 2079 6965 6c64 2066 726f 6d20 6466     yield from df
+000335d0: 2e69 7465 7272 6f77 7328 290a 0a20 2020  .iterrows()..   
+000335e0: 2040 6465 7269 7665 645f 6672 6f6d 2870   @derived_from(p
+000335f0: 642e 4461 7461 4672 616d 6529 0a20 2020  d.DataFrame).   
+00033600: 2064 6566 2069 7465 7274 7570 6c65 7328   def itertuples(
+00033610: 7365 6c66 2c20 696e 6465 783d 5472 7565  self, index=True
+00033620: 2c20 6e61 6d65 3d22 5061 6e64 6173 2229  , name="Pandas")
+00033630: 3a0a 2020 2020 2020 2020 666f 7220 6920  :.        for i 
+00033640: 696e 2072 616e 6765 2873 656c 662e 6e70  in range(self.np
+00033650: 6172 7469 7469 6f6e 7329 3a0a 2020 2020  artitions):.    
+00033660: 2020 2020 2020 2020 6466 203d 2073 656c          df = sel
+00033670: 662e 6765 745f 7061 7274 6974 696f 6e28  f.get_partition(
+00033680: 6929 2e63 6f6d 7075 7465 2829 0a20 2020  i).compute().   
+00033690: 2020 2020 2020 2020 2079 6965 6c64 2066           yield f
+000336a0: 726f 6d20 6466 2e69 7465 7274 7570 6c65  rom df.itertuple
+000336b0: 7328 696e 6465 783d 696e 6465 782c 206e  s(index=index, n
+000336c0: 616d 653d 6e61 6d65 290a 0a20 2020 2040  ame=name)..    @
+000336d0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+000336e0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+000336f0: 6566 2069 7465 6d73 2873 656c 6629 3a0a  ef items(self):.
+00033700: 2020 2020 2020 2020 666f 7220 636f 6c5f          for col_
+00033710: 6964 782c 206c 6162 656c 2069 6e20 656e  idx, label in en
+00033720: 756d 6572 6174 6528 7365 6c66 2e63 6f6c  umerate(self.col
+00033730: 756d 6e73 293a 0a20 2020 2020 2020 2020  umns):.         
+00033740: 2020 2079 6965 6c64 206c 6162 656c 2c20     yield label, 
+00033750: 7365 6c66 2e69 6c6f 635b 3a2c 2063 6f6c  self.iloc[:, col
+00033760: 5f69 6478 5d0a 0a20 2020 2040 636c 6173  _idx]..    @clas
+00033770: 736d 6574 686f 640a 2020 2020 6465 6620  smethod.    def 
+00033780: 5f62 696e 645f 6f70 6572 6174 6f72 5f6d  _bind_operator_m
+00033790: 6574 686f 6428 636c 732c 206e 616d 652c  ethod(cls, name,
+000337a0: 206f 702c 206f 7269 6769 6e61 6c3d 7064   op, original=pd
+000337b0: 2e44 6174 6146 7261 6d65 293a 0a20 2020  .DataFrame):.   
+000337c0: 2020 2020 2022 2222 6269 6e64 206f 7065       """bind ope
+000337d0: 7261 746f 7220 6d65 7468 6f64 206c 696b  rator method lik
+000337e0: 6520 4461 7461 4672 616d 652e 6164 6420  e DataFrame.add 
+000337f0: 746f 2074 6869 7320 636c 6173 7322 2222  to this class"""
+00033800: 0a0a 2020 2020 2020 2020 2320 6e61 6d65  ..        # name
+00033810: 206d 7573 7420 6265 2065 7870 6c69 6369   must be explici
+00033820: 746c 7920 7061 7373 6564 2066 6f72 2064  tly passed for d
+00033830: 6976 206d 6574 686f 6420 7768 6f73 6520  iv method whose 
+00033840: 6e61 6d65 2069 7320 7472 7565 6469 760a  name is truediv.
+00033850: 0a20 2020 2020 2020 2064 6566 206d 6574  .        def met
+00033860: 6828 7365 6c66 2c20 6f74 6865 722c 2061  h(self, other, a
+00033870: 7869 733d 2263 6f6c 756d 6e73 222c 206c  xis="columns", l
+00033880: 6576 656c 3d4e 6f6e 652c 2066 696c 6c5f  evel=None, fill_
+00033890: 7661 6c75 653d 4e6f 6e65 293a 0a20 2020  value=None):.   
+000338a0: 2020 2020 2020 2020 2069 6620 6c65 7665           if leve
+000338b0: 6c20 6973 206e 6f74 204e 6f6e 653a 0a20  l is not None:. 
+000338c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000338d0: 6169 7365 204e 6f74 496d 706c 656d 656e  aise NotImplemen
+000338e0: 7465 6445 7272 6f72 2822 6c65 7665 6c20  tedError("level 
+000338f0: 6d75 7374 2062 6520 4e6f 6e65 2229 0a0a  must be None")..
+00033900: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+00033910: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
+00033920: 655f 6178 6973 2861 7869 7329 0a0a 2020  e_axis(axis)..  
+00033930: 2020 2020 2020 2020 2020 6966 2061 7869            if axi
+00033940: 7320 696e 2028 312c 2022 636f 6c75 6d6e  s in (1, "column
+00033950: 7322 293a 0a20 2020 2020 2020 2020 2020  s"):.           
+00033960: 2020 2020 2023 2057 6865 6e20 6178 6973       # When axis
+00033970: 3d31 2061 6e64 206f 7468 6572 2069 7320  =1 and other is 
+00033980: 6120 7365 7269 6573 2c20 606f 7468 6572  a series, `other
+00033990: 6020 6973 2074 7261 6e73 706f 7365 640a  ` is transposed.
 000339a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000339b0: 2020 6d73 6720 3d20 6622 556e 6162 6c65    msg = f"Unable
-000339c0: 2074 6f20 7b6e 616d 657d 2064 642e 5365   to {name} dd.Se
-000339d0: 7269 6573 2077 6974 6820 6178 6973 3d31  ries with axis=1
-000339e0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-000339f0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00033a00: 6545 7272 6f72 286d 7367 290a 2020 2020  eError(msg).    
-00033a10: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00033a20: 2069 735f 7365 7269 6573 5f6c 696b 6528   is_series_like(
-00033a30: 6f74 6865 7229 3a0a 2020 2020 2020 2020  other):.        
-00033a40: 2020 2020 2020 2020 2020 2020 2320 5370              # Sp
-00033a50: 6563 6961 6c20 6361 7365 2066 6f72 2070  ecial case for p
-00033a60: 642e 5365 7269 6573 2074 6f20 6176 6f69  d.Series to avoi
-00033a70: 6420 756e 7761 6e74 6564 2070 6172 7469  d unwanted parti
-00033a80: 7469 6f6e 696e 670a 2020 2020 2020 2020  tioning.        
-00033a90: 2020 2020 2020 2020 2020 2020 2320 6f66              # of
-00033aa0: 206f 7468 6572 2e20 5765 2070 6173 7320   other. We pass 
-00033ab0: 6974 2069 6e20 6173 2061 206b 7761 7267  it in as a kwarg
-00033ac0: 2074 6f20 7072 6576 656e 7420 7468 6973   to prevent this
-00033ad0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00033ae0: 2020 2020 2020 6d65 7461 203d 205f 656d        meta = _em
-00033af0: 756c 6174 6528 0a20 2020 2020 2020 2020  ulate(.         
-00033b00: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00033b10: 702c 2073 656c 662c 206f 7468 6572 3d6f  p, self, other=o
-00033b20: 7468 6572 2c20 6178 6973 3d61 7869 732c  ther, axis=axis,
-00033b30: 2066 696c 6c5f 7661 6c75 653d 6669 6c6c   fill_value=fill
-00033b40: 5f76 616c 7565 0a20 2020 2020 2020 2020  _value.         
-00033b50: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00033b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033b70: 2072 6574 7572 6e20 6d61 705f 7061 7274   return map_part
-00033b80: 6974 696f 6e73 280a 2020 2020 2020 2020  itions(.        
-00033b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033ba0: 6f70 2c0a 2020 2020 2020 2020 2020 2020  op,.            
-00033bb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00033bc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00033bd0: 2020 2020 2020 2020 2020 6f74 6865 723d            other=
-00033be0: 6f74 6865 722c 0a20 2020 2020 2020 2020  other,.         
-00033bf0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00033c00: 6574 613d 6d65 7461 2c0a 2020 2020 2020  eta=meta,.      
-00033c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033c20: 2020 6178 6973 3d61 7869 732c 0a20 2020    axis=axis,.   
-00033c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033c40: 2020 2020 2066 696c 6c5f 7661 6c75 653d       fill_value=
-00033c50: 6669 6c6c 5f76 616c 7565 2c0a 2020 2020  fill_value,.    
-00033c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033c70: 2020 2020 656e 666f 7263 655f 6d65 7461      enforce_meta
-00033c80: 6461 7461 3d46 616c 7365 2c0a 2020 2020  data=False,.    
-00033c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033ca0: 290a 0a20 2020 2020 2020 2020 2020 206d  )..            m
-00033cb0: 6574 6120 3d20 5f65 6d75 6c61 7465 286f  eta = _emulate(o
-00033cc0: 702c 2073 656c 662c 206f 7468 6572 2c20  p, self, other, 
-00033cd0: 6178 6973 3d61 7869 732c 2066 696c 6c5f  axis=axis, fill_
-00033ce0: 7661 6c75 653d 6669 6c6c 5f76 616c 7565  value=fill_value
-00033cf0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00033d00: 7475 726e 206d 6170 5f70 6172 7469 7469  turn map_partiti
-00033d10: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
-00033d20: 2020 2020 206f 702c 0a20 2020 2020 2020       op,.       
-00033d30: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-00033d40: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00033d50: 7468 6572 2c0a 2020 2020 2020 2020 2020  ther,.          
-00033d60: 2020 2020 2020 6d65 7461 3d6d 6574 612c        meta=meta,
-00033d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033d80: 2061 7869 733d 6178 6973 2c0a 2020 2020   axis=axis,.    
-00033d90: 2020 2020 2020 2020 2020 2020 6669 6c6c              fill
-00033da0: 5f76 616c 7565 3d66 696c 6c5f 7661 6c75  _value=fill_valu
-00033db0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00033dc0: 2020 2065 6e66 6f72 6365 5f6d 6574 6164     enforce_metad
-00033dd0: 6174 613d 4661 6c73 652c 0a20 2020 2020  ata=False,.     
-00033de0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00033df0: 2020 6d65 7468 2e5f 5f6e 616d 655f 5f20    meth.__name__ 
-00033e00: 3d20 6e61 6d65 0a20 2020 2020 2020 2073  = name.        s
-00033e10: 6574 6174 7472 2863 6c73 2c20 6e61 6d65  etattr(cls, name
-00033e20: 2c20 6465 7269 7665 645f 6672 6f6d 286f  , derived_from(o
-00033e30: 7269 6769 6e61 6c29 286d 6574 6829 290a  riginal)(meth)).
-00033e40: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
-00033e50: 640a 2020 2020 6465 6620 5f62 696e 645f  d.    def _bind_
-00033e60: 636f 6d70 6172 6973 6f6e 5f6d 6574 686f  comparison_metho
-00033e70: 6428 636c 732c 206e 616d 652c 2063 6f6d  d(cls, name, com
-00033e80: 7061 7269 736f 6e2c 206f 7269 6769 6e61  parison, origina
-00033e90: 6c3d 7064 2e44 6174 6146 7261 6d65 293a  l=pd.DataFrame):
-00033ea0: 0a20 2020 2020 2020 2022 2222 6269 6e64  .        """bind
-00033eb0: 2063 6f6d 7061 7269 736f 6e20 6d65 7468   comparison meth
-00033ec0: 6f64 206c 696b 6520 4461 7461 4672 616d  od like DataFram
-00033ed0: 652e 6571 2074 6f20 7468 6973 2063 6c61  e.eq to this cla
-00033ee0: 7373 2222 220a 0a20 2020 2020 2020 2064  ss"""..        d
-00033ef0: 6566 206d 6574 6828 7365 6c66 2c20 6f74  ef meth(self, ot
-00033f00: 6865 722c 2061 7869 733d 2263 6f6c 756d  her, axis="colum
-00033f10: 6e73 222c 206c 6576 656c 3d4e 6f6e 6529  ns", level=None)
-00033f20: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00033f30: 206c 6576 656c 2069 7320 6e6f 7420 4e6f   level is not No
-00033f40: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00033f50: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-00033f60: 6c65 6d65 6e74 6564 4572 726f 7228 226c  lementedError("l
-00033f70: 6576 656c 206d 7573 7420 6265 204e 6f6e  evel must be Non
-00033f80: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
-00033f90: 6178 6973 203d 2073 656c 662e 5f76 616c  axis = self._val
-00033fa0: 6964 6174 655f 6178 6973 2861 7869 7329  idate_axis(axis)
-00033fb0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00033fc0: 7572 6e20 656c 656d 7769 7365 2863 6f6d  urn elemwise(com
-00033fd0: 7061 7269 736f 6e2c 2073 656c 662c 206f  parison, self, o
-00033fe0: 7468 6572 2c20 6178 6973 3d61 7869 7329  ther, axis=axis)
-00033ff0: 0a0a 2020 2020 2020 2020 6d65 7468 2e5f  ..        meth._
-00034000: 5f6e 616d 655f 5f20 3d20 6e61 6d65 0a20  _name__ = name. 
-00034010: 2020 2020 2020 2073 6574 6174 7472 2863         setattr(c
-00034020: 6c73 2c20 6e61 6d65 2c20 6465 7269 7665  ls, name, derive
-00034030: 645f 6672 6f6d 286f 7269 6769 6e61 6c29  d_from(original)
-00034040: 286d 6574 6829 290a 0a20 2020 2040 696e  (meth))..    @in
-00034050: 7365 7274 5f6d 6574 615f 7061 7261 6d5f  sert_meta_param_
-00034060: 6465 7363 7269 7074 696f 6e28 7061 643d  description(pad=
-00034070: 3132 290a 2020 2020 6465 6620 6170 706c  12).    def appl
-00034080: 7928 0a20 2020 2020 2020 2073 656c 662c  y(.        self,
-00034090: 0a20 2020 2020 2020 2066 756e 632c 0a20  .        func,. 
-000340a0: 2020 2020 2020 2061 7869 733d 302c 0a20         axis=0,. 
-000340b0: 2020 2020 2020 2062 726f 6164 6361 7374         broadcast
-000340c0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2072  =None,.        r
-000340d0: 6177 3d46 616c 7365 2c0a 2020 2020 2020  aw=False,.      
-000340e0: 2020 7265 6475 6365 3d4e 6f6e 652c 0a20    reduce=None,. 
-000340f0: 2020 2020 2020 2061 7267 733d 2829 2c0a         args=(),.
-00034100: 2020 2020 2020 2020 6d65 7461 3d6e 6f5f          meta=no_
-00034110: 6465 6661 756c 742c 0a20 2020 2020 2020  default,.       
-00034120: 2072 6573 756c 745f 7479 7065 3d4e 6f6e   result_type=Non
-00034130: 652c 0a20 2020 2020 2020 202a 2a6b 7764  e,.        **kwd
-00034140: 732c 0a20 2020 2029 3a0a 2020 2020 2020  s,.    ):.      
-00034150: 2020 2222 2250 6172 616c 6c65 6c20 7665    """Parallel ve
-00034160: 7273 696f 6e20 6f66 2070 616e 6461 732e  rsion of pandas.
-00034170: 4461 7461 4672 616d 652e 6170 706c 790a  DataFrame.apply.
-00034180: 0a20 2020 2020 2020 2054 6869 7320 6d69  .        This mi
-00034190: 6d69 6373 2074 6865 2070 616e 6461 7320  mics the pandas 
-000341a0: 7665 7273 696f 6e20 6578 6365 7074 2066  version except f
-000341b0: 6f72 2074 6865 2066 6f6c 6c6f 7769 6e67  or the following
-000341c0: 3a0a 0a20 2020 2020 2020 2031 2e20 204f  :..        1.  O
-000341d0: 6e6c 7920 6060 6178 6973 3d31 6060 2069  nly ``axis=1`` i
-000341e0: 7320 7375 7070 6f72 7465 6420 2861 6e64  s supported (and
-000341f0: 206d 7573 7420 6265 2073 7065 6369 6669   must be specifi
-00034200: 6564 2065 7870 6c69 6369 746c 7929 2e0a  ed explicitly)..
-00034210: 2020 2020 2020 2020 322e 2020 5468 6520          2.  The 
-00034220: 7573 6572 2073 686f 756c 6420 7072 6f76  user should prov
-00034230: 6964 6520 6f75 7470 7574 206d 6574 6164  ide output metad
-00034240: 6174 6120 7669 6120 7468 6520 606d 6574  ata via the `met
-00034250: 6160 206b 6579 776f 7264 2e0a 0a20 2020  a` keyword...   
-00034260: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-00034270: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00034280: 2d2d 0a20 2020 2020 2020 2066 756e 6320  --.        func 
-00034290: 3a20 6675 6e63 7469 6f6e 0a20 2020 2020  : function.     
-000342a0: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
-000342b0: 746f 2061 7070 6c79 2074 6f20 6561 6368  to apply to each
-000342c0: 2063 6f6c 756d 6e2f 726f 770a 2020 2020   column/row.    
-000342d0: 2020 2020 6178 6973 203a 207b 3020 6f72      axis : {0 or
-000342e0: 2027 696e 6465 7827 2c20 3120 6f72 2027   'index', 1 or '
-000342f0: 636f 6c75 6d6e 7327 7d2c 2064 6566 6175  columns'}, defau
-00034300: 6c74 2030 0a20 2020 2020 2020 2020 2020  lt 0.           
-00034310: 202d 2030 206f 7220 2769 6e64 6578 273a   - 0 or 'index':
-00034320: 2061 7070 6c79 2066 756e 6374 696f 6e20   apply function 
-00034330: 746f 2065 6163 6820 636f 6c75 6d6e 2028  to each column (
-00034340: 4e4f 5420 5355 5050 4f52 5445 4429 0a20  NOT SUPPORTED). 
-00034350: 2020 2020 2020 2020 2020 202d 2031 206f             - 1 o
-00034360: 7220 2763 6f6c 756d 6e73 273a 2061 7070  r 'columns': app
-00034370: 6c79 2066 756e 6374 696f 6e20 746f 2065  ly function to e
-00034380: 6163 6820 726f 770a 2020 2020 2020 2020  ach row.        
-00034390: 244d 4554 410a 2020 2020 2020 2020 6172  $META.        ar
-000343a0: 6773 203a 2074 7570 6c65 0a20 2020 2020  gs : tuple.     
-000343b0: 2020 2020 2020 2050 6f73 6974 696f 6e61         Positiona
-000343c0: 6c20 6172 6775 6d65 6e74 7320 746f 2070  l arguments to p
-000343d0: 6173 7320 746f 2066 756e 6374 696f 6e20  ass to function 
-000343e0: 696e 2061 6464 6974 696f 6e20 746f 2074  in addition to t
-000343f0: 6865 2061 7272 6179 2f73 6572 6965 730a  he array/series.
-00034400: 0a20 2020 2020 2020 2041 6464 6974 696f  .        Additio
-00034410: 6e61 6c20 6b65 7977 6f72 6420 6172 6775  nal keyword argu
-00034420: 6d65 6e74 7320 7769 6c6c 2062 6520 7061  ments will be pa
-00034430: 7373 6564 2061 7320 6b65 7977 6f72 6473  ssed as keywords
-00034440: 2074 6f20 7468 6520 6675 6e63 7469 6f6e   to the function
-00034450: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00034460: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00034470: 2d0a 2020 2020 2020 2020 6170 706c 6965  -.        applie
-00034480: 6420 3a20 5365 7269 6573 206f 7220 4461  d : Series or Da
-00034490: 7461 4672 616d 650a 0a20 2020 2020 2020  taFrame..       
-000344a0: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
-000344b0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-000344c0: 2020 203e 3e3e 2069 6d70 6f72 7420 7061     >>> import pa
-000344d0: 6e64 6173 2061 7320 7064 0a20 2020 2020  ndas as pd.     
-000344e0: 2020 203e 3e3e 2069 6d70 6f72 7420 6461     >>> import da
-000344f0: 736b 2e64 6174 6166 7261 6d65 2061 7320  sk.dataframe as 
-00034500: 6464 0a20 2020 2020 2020 203e 3e3e 2064  dd.        >>> d
-00034510: 6620 3d20 7064 2e44 6174 6146 7261 6d65  f = pd.DataFrame
-00034520: 287b 2778 273a 205b 312c 2032 2c20 332c  ({'x': [1, 2, 3,
-00034530: 2034 2c20 355d 2c0a 2020 2020 2020 2020   4, 5],.        
-00034540: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-00034550: 2020 2020 2020 2027 7927 3a20 5b31 2e2c         'y': [1.,
-00034560: 2032 2e2c 2033 2e2c 2034 2e2c 2035 2e5d   2., 3., 4., 5.]
-00034570: 7d29 0a20 2020 2020 2020 203e 3e3e 2064  }).        >>> d
-00034580: 6466 203d 2064 642e 6672 6f6d 5f70 616e  df = dd.from_pan
-00034590: 6461 7328 6466 2c20 6e70 6172 7469 7469  das(df, npartiti
-000345a0: 6f6e 733d 3229 0a0a 2020 2020 2020 2020  ons=2)..        
-000345b0: 4170 706c 7920 6120 6675 6e63 7469 6f6e  Apply a function
-000345c0: 2074 6f20 726f 772d 7769 7365 2070 6173   to row-wise pas
-000345d0: 7369 6e67 2069 6e20 6578 7472 6120 6172  sing in extra ar
-000345e0: 6775 6d65 6e74 7320 696e 2060 6061 7267  guments in ``arg
-000345f0: 7360 6020 616e 640a 2020 2020 2020 2020  s`` and.        
-00034600: 6060 6b77 6172 6773 6060 3a0a 0a20 2020  ``kwargs``:..   
-00034610: 2020 2020 203e 3e3e 2064 6566 206d 7961       >>> def mya
-00034620: 6464 2872 6f77 2c20 612c 2062 3d31 293a  dd(row, a, b=1):
-00034630: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00034640: 2072 6574 7572 6e20 726f 772e 7375 6d28   return row.sum(
-00034650: 2920 2b20 6120 2b20 620a 2020 2020 2020  ) + a + b.      
-00034660: 2020 3e3e 3e20 7265 7320 3d20 6464 662e    >>> res = ddf.
-00034670: 6170 706c 7928 6d79 6164 642c 2061 7869  apply(myadd, axi
-00034680: 733d 312c 2061 7267 733d 2832 2c29 2c20  s=1, args=(2,), 
-00034690: 623d 312e 3529 2020 2320 646f 6374 6573  b=1.5)  # doctes
-000346a0: 743a 202b 534b 4950 0a0a 2020 2020 2020  t: +SKIP..      
-000346b0: 2020 4279 2064 6566 6175 6c74 2c20 6461    By default, da
-000346c0: 736b 2074 7269 6573 2074 6f20 696e 6665  sk tries to infe
-000346d0: 7220 7468 6520 6f75 7470 7574 206d 6574  r the output met
-000346e0: 6164 6174 6120 6279 2072 756e 6e69 6e67  adata by running
-000346f0: 2079 6f75 720a 2020 2020 2020 2020 7072   your.        pr
-00034700: 6f76 6964 6564 2066 756e 6374 696f 6e20  ovided function 
-00034710: 6f6e 2073 6f6d 6520 6661 6b65 2064 6174  on some fake dat
-00034720: 612e 2054 6869 7320 776f 726b 7320 7765  a. This works we
-00034730: 6c6c 2069 6e20 6d61 6e79 2063 6173 6573  ll in many cases
-00034740: 2c20 6275 740a 2020 2020 2020 2020 6361  , but.        ca
-00034750: 6e20 736f 6d65 7469 6d65 7320 6265 2065  n sometimes be e
-00034760: 7870 656e 7369 7665 2c20 6f72 2065 7665  xpensive, or eve
-00034770: 6e20 6661 696c 2e20 546f 2061 766f 6964  n fail. To avoid
-00034780: 2074 6869 732c 2079 6f75 2063 616e 0a20   this, you can. 
-00034790: 2020 2020 2020 206d 616e 7561 6c6c 7920         manually 
-000347a0: 7370 6563 6966 7920 7468 6520 6f75 7470  specify the outp
-000347b0: 7574 206d 6574 6164 6174 6120 7769 7468  ut metadata with
-000347c0: 2074 6865 2060 606d 6574 6160 6020 6b65   the ``meta`` ke
-000347d0: 7977 6f72 642e 2054 6869 730a 2020 2020  yword. This.    
-000347e0: 2020 2020 6361 6e20 6265 2073 7065 6369      can be speci
-000347f0: 6669 6564 2069 6e20 6d61 6e79 2066 6f72  fied in many for
-00034800: 6d73 2c20 666f 7220 6d6f 7265 2069 6e66  ms, for more inf
-00034810: 6f72 6d61 7469 6f6e 2073 6565 0a20 2020  ormation see.   
-00034820: 2020 2020 2060 6064 6173 6b2e 6461 7461       ``dask.data
-00034830: 6672 616d 652e 7574 696c 732e 6d61 6b65  frame.utils.make
-00034840: 5f6d 6574 6160 602e 0a0a 2020 2020 2020  _meta``...      
-00034850: 2020 4865 7265 2077 6520 7370 6563 6966    Here we specif
-00034860: 7920 7468 6520 6f75 7470 7574 2069 7320  y the output is 
-00034870: 6120 5365 7269 6573 2077 6974 6820 6e61  a Series with na
-00034880: 6d65 2060 6027 7827 6060 2c20 616e 6420  me ``'x'``, and 
-00034890: 6474 7970 650a 2020 2020 2020 2020 6060  dtype.        ``
-000348a0: 666c 6f61 7436 3460 603a 0a0a 2020 2020  float64``:..    
-000348b0: 2020 2020 3e3e 3e20 7265 7320 3d20 6464      >>> res = dd
-000348c0: 662e 6170 706c 7928 6d79 6164 642c 2061  f.apply(myadd, a
-000348d0: 7869 733d 312c 2061 7267 733d 2832 2c29  xis=1, args=(2,)
-000348e0: 2c20 623d 312e 352c 206d 6574 613d 2827  , b=1.5, meta=('
-000348f0: 7827 2c20 2766 3827 2929 0a0a 2020 2020  x', 'f8'))..    
-00034900: 2020 2020 496e 2074 6865 2063 6173 6520      In the case 
-00034910: 7768 6572 6520 7468 6520 6d65 7461 6461  where the metada
-00034920: 7461 2064 6f65 736e 2774 2063 6861 6e67  ta doesn't chang
-00034930: 652c 2079 6f75 2063 616e 2061 6c73 6f20  e, you can also 
-00034940: 7061 7373 2069 6e0a 2020 2020 2020 2020  pass in.        
-00034950: 7468 6520 6f62 6a65 6374 2069 7473 656c  the object itsel
-00034960: 6620 6469 7265 6374 6c79 3a0a 0a20 2020  f directly:..   
-00034970: 2020 2020 203e 3e3e 2072 6573 203d 2064       >>> res = d
-00034980: 6466 2e61 7070 6c79 286c 616d 6264 6120  df.apply(lambda 
-00034990: 726f 773a 2072 6f77 202b 2031 2c20 6178  row: row + 1, ax
-000349a0: 6973 3d31 2c20 6d65 7461 3d64 6466 290a  is=1, meta=ddf).
-000349b0: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
-000349c0: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
-000349d0: 2d2d 0a20 2020 2020 2020 2064 6173 6b2e  --.        dask.
-000349e0: 4461 7461 4672 616d 652e 6d61 705f 7061  DataFrame.map_pa
-000349f0: 7274 6974 696f 6e73 0a20 2020 2020 2020  rtitions.       
-00034a00: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
-00034a10: 2062 726f 6164 6361 7374 2069 7320 6e6f   broadcast is no
-00034a20: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00034a30: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00034a40: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-00034a50: 2020 2022 5468 6520 6062 726f 6164 6361     "The `broadca
-00034a60: 7374 6020 6172 6775 6d65 6e74 2069 7320  st` argument is 
-00034a70: 6e6f 206c 6f6e 6765 7220 7573 6564 2f73  no longer used/s
-00034a80: 7570 706f 7274 6564 2e20 220a 2020 2020  upported. ".    
-00034a90: 2020 2020 2020 2020 2020 2020 2249 7420              "It 
-00034aa0: 7769 6c6c 2062 6520 6472 6f70 7065 6420  will be dropped 
-00034ab0: 696e 2061 2066 7574 7572 6520 7265 6c65  in a future rele
-00034ac0: 6173 652e 222c 0a20 2020 2020 2020 2020  ase.",.         
-00034ad0: 2020 2020 2020 2063 6174 6567 6f72 793d         category=
-00034ae0: 4675 7475 7265 5761 726e 696e 672c 0a20  FutureWarning,. 
-00034af0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00034b00: 2020 2020 2020 6178 6973 203d 2073 656c        axis = sel
-00034b10: 662e 5f76 616c 6964 6174 655f 6178 6973  f._validate_axis
-00034b20: 2861 7869 7329 0a20 2020 2020 2020 2070  (axis).        p
-00034b30: 616e 6461 735f 6b77 6172 6773 203d 207b  andas_kwargs = {
-00034b40: 2261 7869 7322 3a20 6178 6973 2c20 2272  "axis": axis, "r
-00034b50: 6177 223a 2072 6177 2c20 2272 6573 756c  aw": raw, "resul
-00034b60: 745f 7479 7065 223a 2072 6573 756c 745f  t_type": result_
-00034b70: 7479 7065 7d0a 0a20 2020 2020 2020 206b  type}..        k
-00034b80: 7764 732e 7570 6461 7465 2870 616e 6461  wds.update(panda
-00034b90: 735f 6b77 6172 6773 290a 0a20 2020 2020  s_kwargs)..     
-00034ba0: 2020 2069 6620 6178 6973 203d 3d20 303a     if axis == 0:
-00034bb0: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
-00034bc0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-00034bd0: 2020 2020 2022 6464 2e44 6174 6146 7261       "dd.DataFra
-00034be0: 6d65 2e61 7070 6c79 206f 6e6c 7920 7375  me.apply only su
-00034bf0: 7070 6f72 7473 2061 7869 733d 315c 6e22  pports axis=1\n"
-00034c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034c10: 2022 2020 5472 793a 2064 662e 6170 706c   "  Try: df.appl
-00034c20: 7928 6675 6e63 2c20 6178 6973 3d31 2922  y(func, axis=1)"
-00034c30: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00034c40: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00034c50: 204e 6f74 496d 706c 656d 656e 7465 6445   NotImplementedE
-00034c60: 7272 6f72 286d 7367 290a 0a20 2020 2020  rror(msg)..     
-00034c70: 2020 2069 6620 6d65 7461 2069 7320 6e6f     if meta is no
-00034c80: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
-00034c90: 2020 2020 2020 6d65 7461 203d 205f 656d        meta = _em
-00034ca0: 756c 6174 6528 0a20 2020 2020 2020 2020  ulate(.         
-00034cb0: 2020 2020 2020 204d 2e61 7070 6c79 2c20         M.apply, 
-00034cc0: 7365 6c66 2e5f 6d65 7461 5f6e 6f6e 656d  self._meta_nonem
-00034cd0: 7074 792c 2066 756e 632c 2061 7267 733d  pty, func, args=
-00034ce0: 6172 6773 2c20 7564 663d 5472 7565 2c20  args, udf=True, 
-00034cf0: 2a2a 6b77 6473 0a20 2020 2020 2020 2020  **kwds.         
-00034d00: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00034d10: 2077 6172 6e69 6e67 732e 7761 726e 286d   warnings.warn(m
-00034d20: 6574 615f 7761 726e 696e 6728 6d65 7461  eta_warning(meta
-00034d30: 2929 0a20 2020 2020 2020 206b 7764 732e  )).        kwds.
-00034d40: 7570 6461 7465 287b 2270 6172 656e 745f  update({"parent_
-00034d50: 6d65 7461 223a 2073 656c 662e 5f6d 6574  meta": self._met
-00034d60: 617d 290a 2020 2020 2020 2020 7265 7475  a}).        retu
-00034d70: 726e 206d 6170 5f70 6172 7469 7469 6f6e  rn map_partition
-00034d80: 7328 4d2e 6170 706c 792c 2073 656c 662c  s(M.apply, self,
-00034d90: 2066 756e 632c 2061 7267 733d 6172 6773   func, args=args
-00034da0: 2c20 6d65 7461 3d6d 6574 612c 202a 2a6b  , meta=meta, **k
-00034db0: 7764 7329 0a0a 2020 2020 4064 6572 6976  wds)..    @deriv
-00034dc0: 6564 5f66 726f 6d28 7064 2e44 6174 6146  ed_from(pd.DataF
-00034dd0: 7261 6d65 290a 2020 2020 6465 6620 6170  rame).    def ap
-00034de0: 706c 796d 6170 2873 656c 662c 2066 756e  plymap(self, fun
-00034df0: 632c 206d 6574 613d 6e6f 5f64 6566 6175  c, meta=no_defau
-00034e00: 6c74 293a 0a20 2020 2020 2020 2023 204c  lt):.        # L
-00034e10: 6574 2070 616e 6461 7320 7261 6973 6520  et pandas raise 
-00034e20: 6465 7072 6563 6174 696f 6e20 7761 726e  deprecation warn
-00034e30: 696e 6773 0a20 2020 2020 2020 2073 656c  ings.        sel
-00034e40: 662e 5f6d 6574 612e 6170 706c 796d 6170  f._meta.applymap
-00034e50: 2866 756e 6329 0a20 2020 2020 2020 2072  (func).        r
-00034e60: 6574 7572 6e20 656c 656d 7769 7365 286d  eturn elemwise(m
-00034e70: 6574 686f 6473 2e61 7070 6c79 6d61 702c  ethods.applymap,
-00034e80: 2073 656c 662c 2066 756e 632c 206d 6574   self, func, met
-00034e90: 613d 6d65 7461 290a 0a20 2020 2064 6566  a=meta)..    def
-00034ea0: 206d 6170 2873 656c 662c 2066 756e 632c   map(self, func,
-00034eb0: 206d 6574 613d 6e6f 5f64 6566 6175 6c74   meta=no_default
-00034ec0: 2c20 6e61 5f61 6374 696f 6e3d 4e6f 6e65  , na_action=None
-00034ed0: 293a 0a20 2020 2020 2020 2069 6620 6e6f  ):.        if no
-00034ee0: 7420 5041 4e44 4153 5f47 545f 3231 303a  t PANDAS_GT_210:
-00034ef0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00034f00: 7365 204e 6f74 496d 706c 656d 656e 7465  se NotImplemente
-00034f10: 6445 7272 6f72 280a 2020 2020 2020 2020  dError(.        
-00034f20: 2020 2020 2020 2020 6622 4461 7461 4672          f"DataFr
-00034f30: 616d 652e 6d61 7020 7265 7175 6972 6573  ame.map requires
-00034f40: 2070 616e 6461 733e 3d32 2e31 2e30 2c20   pandas>=2.1.0, 
-00034f50: 6275 7420 7061 6e64 6173 3d7b 5041 4e44  but pandas={PAND
-00034f60: 4153 5f56 4552 5349 4f4e 7d20 6973 2022  AS_VERSION} is "
-00034f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034f80: 2022 696e 7374 616c 6c65 642e 220a 2020   "installed.".  
-00034f90: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00034fa0: 2020 2020 7265 7475 726e 2065 6c65 6d77      return elemw
-00034fb0: 6973 6528 4d2e 6d61 702c 2073 656c 662c  ise(M.map, self,
-00034fc0: 2066 756e 632c 206d 6574 613d 6d65 7461   func, meta=meta
-00034fd0: 2c20 6e61 5f61 6374 696f 6e3d 6e61 5f61  , na_action=na_a
-00034fe0: 6374 696f 6e29 0a0a 2020 2020 4064 6572  ction)..    @der
-00034ff0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-00035000: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00035010: 726f 756e 6428 7365 6c66 2c20 6465 6369  round(self, deci
-00035020: 6d61 6c73 3d30 293a 0a20 2020 2020 2020  mals=0):.       
-00035030: 2072 6574 7572 6e20 656c 656d 7769 7365   return elemwise
-00035040: 284d 2e72 6f75 6e64 2c20 7365 6c66 2c20  (M.round, self, 
-00035050: 6465 6369 6d61 6c73 290a 0a20 2020 2040  decimals)..    @
-00035060: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
-00035070: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
-00035080: 6566 206e 756e 6971 7565 2873 656c 662c  ef nunique(self,
-00035090: 2073 706c 6974 5f65 7665 7279 3d46 616c   split_every=Fal
-000350a0: 7365 2c20 6472 6f70 6e61 3d54 7275 652c  se, dropna=True,
-000350b0: 2061 7869 733d 3029 3a0a 2020 2020 2020   axis=0):.      
-000350c0: 2020 6966 2061 7869 7320 3d3d 2031 3a0a    if axis == 1:.
-000350d0: 2020 2020 2020 2020 2020 2020 2320 7370              # sp
-000350e0: 6c69 745f 6576 6572 7920 6e6f 7420 7573  lit_every not us
-000350f0: 6564 2066 6f72 2061 7869 733d 310a 2020  ed for axis=1.  
-00035100: 2020 2020 2020 2020 2020 6d65 7461 203d            meta =
-00035110: 2073 656c 662e 5f6d 6574 615f 6e6f 6e65   self._meta_none
-00035120: 6d70 7479 2e6e 756e 6971 7565 2861 7869  mpty.nunique(axi
-00035130: 733d 6178 6973 290a 2020 2020 2020 2020  s=axis).        
-00035140: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00035150: 6d61 705f 7061 7274 6974 696f 6e73 280a  map_partitions(.
-00035160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035170: 4d2e 6e75 6e69 7175 652c 0a20 2020 2020  M.nunique,.     
-00035180: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
-00035190: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
-000351a0: 2020 2020 2020 746f 6b65 6e3d 2273 6572        token="ser
-000351b0: 6965 732d 6e75 6e69 7175 6522 2c0a 2020  ies-nunique",.  
-000351c0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-000351d0: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
-000351e0: 2020 2020 2020 2020 2064 726f 706e 613d           dropna=
-000351f0: 6472 6f70 6e61 2c0a 2020 2020 2020 2020  dropna,.        
-00035200: 2020 2020 2020 2020 656e 666f 7263 655f          enforce_
-00035210: 6d65 7461 6461 7461 3d46 616c 7365 2c0a  metadata=False,.
-00035220: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00035230: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00035240: 2020 2020 2020 2020 6e75 6e69 7175 655f          nunique_
-00035250: 6c69 7374 203d 205b 0a20 2020 2020 2020  list = [.       
-00035260: 2020 2020 2020 2020 2073 656c 662e 696c           self.il
-00035270: 6f63 5b3a 2c20 695d 2e6e 756e 6971 7565  oc[:, i].nunique
-00035280: 2873 706c 6974 5f65 7665 7279 3d73 706c  (split_every=spl
-00035290: 6974 5f65 7665 7279 2c20 6472 6f70 6e61  it_every, dropna
-000352a0: 3d64 726f 706e 6129 0a20 2020 2020 2020  =dropna).       
-000352b0: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
-000352c0: 6e20 7261 6e67 6528 6c65 6e28 7365 6c66  n range(len(self
-000352d0: 2e63 6f6c 756d 6e73 2929 0a20 2020 2020  .columns)).     
-000352e0: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-000352f0: 2020 2020 206e 616d 6520 3d20 2273 6572       name = "ser
-00035300: 6965 732d 2220 2b20 746f 6b65 6e69 7a65  ies-" + tokenize
-00035310: 282a 6e75 6e69 7175 655f 6c69 7374 290a  (*nunique_list).
-00035320: 2020 2020 2020 2020 2020 2020 6473 6b20              dsk 
-00035330: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-00035340: 2020 2020 286e 616d 652c 2030 293a 2028      (name, 0): (
-00035350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035360: 2020 2020 2061 7070 6c79 2c0a 2020 2020       apply,.    
-00035370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035380: 7064 2e53 6572 6965 732c 0a20 2020 2020  pd.Series,.     
-00035390: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-000353a0: 5b28 732e 5f6e 616d 652c 2030 2920 666f  [(s._name, 0) fo
-000353b0: 7220 7320 696e 206e 756e 6971 7565 5f6c  r s in nunique_l
-000353c0: 6973 745d 5d2c 0a20 2020 2020 2020 2020  ist]],.         
-000353d0: 2020 2020 2020 2020 2020 207b 2269 6e64             {"ind
-000353e0: 6578 223a 2073 656c 662e 636f 6c75 6d6e  ex": self.column
-000353f0: 737d 2c0a 2020 2020 2020 2020 2020 2020  s},.            
-00035400: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00035410: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
-00035420: 6772 6170 6820 3d20 4869 6768 4c65 7665  graph = HighLeve
-00035430: 6c47 7261 7068 2e66 726f 6d5f 636f 6c6c  lGraph.from_coll
-00035440: 6563 7469 6f6e 7328 0a20 2020 2020 2020  ections(.       
-00035450: 2020 2020 2020 2020 206e 616d 652c 2064           name, d
-00035460: 736b 2c20 6465 7065 6e64 656e 6369 6573  sk, dependencies
-00035470: 3d6e 756e 6971 7565 5f6c 6973 740a 2020  =nunique_list.  
-00035480: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00035490: 2020 2020 2020 2020 7265 7475 726e 2053          return S
-000354a0: 6572 6965 7328 6772 6170 682c 206e 616d  eries(graph, nam
-000354b0: 652c 2073 656c 662e 5f6d 6574 612e 6e75  e, self._meta.nu
-000354c0: 6e69 7175 6528 292c 2028 4e6f 6e65 2c20  nique(), (None, 
-000354d0: 4e6f 6e65 2929 0a0a 2020 2020 4064 6572  None))..    @der
-000354e0: 6976 6564 5f66 726f 6d28 7064 2e44 6174  ived_from(pd.Dat
-000354f0: 6146 7261 6d65 290a 2020 2020 6465 6620  aFrame).    def 
-00035500: 6d6f 6465 2873 656c 662c 2064 726f 706e  mode(self, dropn
-00035510: 613d 5472 7565 2c20 7370 6c69 745f 6576  a=True, split_ev
-00035520: 6572 793d 4661 6c73 652c 206e 756d 6572  ery=False, numer
-00035530: 6963 5f6f 6e6c 793d 4661 6c73 6529 3a0a  ic_only=False):.
-00035540: 2020 2020 2020 2020 6d6f 6465 5f73 6572          mode_ser
-00035550: 6965 735f 6c69 7374 203d 205b 5d0a 2020  ies_list = [].  
-00035560: 2020 2020 2020 666f 7220 636f 6c5f 696e        for col_in
-00035570: 6465 7820 696e 2072 616e 6765 286c 656e  dex in range(len
-00035580: 2873 656c 662e 636f 6c75 6d6e 7329 293a  (self.columns)):
-00035590: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-000355a0: 5f73 6572 6965 7320 3d20 7365 6c66 2e69  _series = self.i
-000355b0: 6c6f 635b 3a2c 2063 6f6c 5f69 6e64 6578  loc[:, col_index
-000355c0: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
-000355d0: 206e 756d 6572 6963 5f6f 6e6c 7920 616e   numeric_only an
-000355e0: 6420 6e6f 7420 7064 2e61 7069 2e74 7970  d not pd.api.typ
-000355f0: 6573 2e69 735f 6e75 6d65 7269 635f 6474  es.is_numeric_dt
-00035600: 7970 6528 636f 6c5f 7365 7269 6573 2e64  ype(col_series.d
-00035610: 7479 7065 293a 0a20 2020 2020 2020 2020  type):.         
-00035620: 2020 2020 2020 2063 6f6e 7469 6e75 650a         continue.
-00035630: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-00035640: 5f73 6572 6965 7320 3d20 5365 7269 6573  _series = Series
-00035650: 2e6d 6f64 6528 0a20 2020 2020 2020 2020  .mode(.         
-00035660: 2020 2020 2020 2063 6f6c 5f73 6572 6965         col_serie
-00035670: 732c 2064 726f 706e 613d 6472 6f70 6e61  s, dropna=dropna
-00035680: 2c20 7370 6c69 745f 6576 6572 793d 7370  , split_every=sp
-00035690: 6c69 745f 6576 6572 790a 2020 2020 2020  lit_every.      
-000356a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000356b0: 2020 2020 6d6f 6465 5f73 6572 6965 735f      mode_series_
-000356c0: 6c69 7374 2e61 7070 656e 6428 6d6f 6465  list.append(mode
-000356d0: 5f73 6572 6965 7329 0a0a 2020 2020 2020  _series)..      
-000356e0: 2020 6e61 6d65 203d 2022 636f 6e63 6174    name = "concat
-000356f0: 2d22 202b 2074 6f6b 656e 697a 6528 2a6d  -" + tokenize(*m
-00035700: 6f64 655f 7365 7269 6573 5f6c 6973 7429  ode_series_list)
-00035710: 0a0a 2020 2020 2020 2020 6473 6b20 3d20  ..        dsk = 
-00035720: 7b0a 2020 2020 2020 2020 2020 2020 286e  {.            (n
-00035730: 616d 652c 2030 293a 2028 0a20 2020 2020  ame, 0): (.     
-00035740: 2020 2020 2020 2020 2020 2061 7070 6c79             apply
-00035750: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00035760: 2020 6d65 7468 6f64 732e 636f 6e63 6174    methods.concat
-00035770: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00035780: 2020 5b5b 2864 662e 5f6e 616d 652c 2030    [[(df._name, 0
-00035790: 2920 666f 7220 6466 2069 6e20 6d6f 6465  ) for df in mode
-000357a0: 5f73 6572 6965 735f 6c69 7374 5d5d 2c0a  _series_list]],.
-000357b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000357c0: 7b22 6178 6973 223a 2031 7d2c 0a20 2020  {"axis": 1},.   
-000357d0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-000357e0: 2020 207d 0a0a 2020 2020 2020 2020 6d65     }..        me
-000357f0: 7461 203d 206d 6574 686f 6473 2e63 6f6e  ta = methods.con
-00035800: 6361 7428 5b64 662e 5f6d 6574 6120 666f  cat([df._meta fo
-00035810: 7220 6466 2069 6e20 6d6f 6465 5f73 6572  r df in mode_ser
-00035820: 6965 735f 6c69 7374 5d2c 2061 7869 733d  ies_list], axis=
-00035830: 3129 0a20 2020 2020 2020 2067 7261 7068  1).        graph
-00035840: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
-00035850: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
-00035860: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
-00035870: 6e61 6d65 2c20 6473 6b2c 2064 6570 656e  name, dsk, depen
-00035880: 6465 6e63 6965 733d 6d6f 6465 5f73 6572  dencies=mode_ser
-00035890: 6965 735f 6c69 7374 0a20 2020 2020 2020  ies_list.       
-000358a0: 2029 0a20 2020 2020 2020 2064 6466 203d   ).        ddf =
-000358b0: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
-000358c0: 7261 7068 2c20 6e61 6d65 2c20 6d65 7461  raph, name, meta
-000358d0: 2c20 6469 7669 7369 6f6e 733d 284e 6f6e  , divisions=(Non
-000358e0: 652c 204e 6f6e 6529 290a 0a20 2020 2020  e, None))..     
-000358f0: 2020 2072 6574 7572 6e20 6464 660a 0a20     return ddf.. 
-00035900: 2020 2040 6465 7269 7665 645f 6672 6f6d     @derived_from
-00035910: 2870 642e 4461 7461 4672 616d 6529 0a20  (pd.DataFrame). 
-00035920: 2020 2064 6566 2063 6f76 2873 656c 662c     def cov(self,
-00035930: 206d 696e 5f70 6572 696f 6473 3d4e 6f6e   min_periods=Non
-00035940: 652c 206e 756d 6572 6963 5f6f 6e6c 793d  e, numeric_only=
-00035950: 6e6f 5f64 6566 6175 6c74 2c20 7370 6c69  no_default, spli
-00035960: 745f 6576 6572 793d 4661 6c73 6529 3a0a  t_every=False):.
-00035970: 2020 2020 2020 2020 7265 7475 726e 205f          return _
-00035980: 636f 765f 636f 7272 280a 2020 2020 2020  cov_corr(.      
-00035990: 2020 2020 2020 7365 6c66 2c20 6d69 6e5f        self, min_
-000359a0: 7065 7269 6f64 732c 206e 756d 6572 6963  periods, numeric
-000359b0: 5f6f 6e6c 793d 6e75 6d65 7269 635f 6f6e  _only=numeric_on
-000359c0: 6c79 2c20 7370 6c69 745f 6576 6572 793d  ly, split_every=
-000359d0: 7370 6c69 745f 6576 6572 790a 2020 2020  split_every.    
-000359e0: 2020 2020 290a 0a20 2020 2040 6465 7269      )..    @deri
-000359f0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-00035a00: 4672 616d 6529 0a20 2020 2064 6566 2063  Frame).    def c
-00035a10: 6f72 7228 0a20 2020 2020 2020 2073 656c  orr(.        sel
-00035a20: 662c 0a20 2020 2020 2020 206d 6574 686f  f,.        metho
-00035a30: 643d 2270 6561 7273 6f6e 222c 0a20 2020  d="pearson",.   
-00035a40: 2020 2020 206d 696e 5f70 6572 696f 6473       min_periods
-00035a50: 3d4e 6f6e 652c 0a20 2020 2020 2020 206e  =None,.        n
-00035a60: 756d 6572 6963 5f6f 6e6c 793d 6e6f 5f64  umeric_only=no_d
-00035a70: 6566 6175 6c74 2c0a 2020 2020 2020 2020  efault,.        
-00035a80: 7370 6c69 745f 6576 6572 793d 4661 6c73  split_every=Fals
-00035a90: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00035aa0: 2020 6966 206d 6574 686f 6420 213d 2022    if method != "
-00035ab0: 7065 6172 736f 6e22 3a0a 2020 2020 2020  pearson":.      
-00035ac0: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
-00035ad0: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
-00035ae0: 224f 6e6c 7920 5065 6172 736f 6e20 636f  "Only Pearson co
-00035af0: 7272 656c 6174 696f 6e20 6861 7320 6265  rrelation has be
-00035b00: 656e 2069 6d70 6c65 6d65 6e74 6564 2229  en implemented")
-00035b10: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00035b20: 205f 636f 765f 636f 7272 280a 2020 2020   _cov_corr(.    
-00035b30: 2020 2020 2020 2020 7365 6c66 2c20 6d69          self, mi
-00035b40: 6e5f 7065 7269 6f64 732c 2054 7275 652c  n_periods, True,
-00035b50: 206e 756d 6572 6963 5f6f 6e6c 793d 6e75   numeric_only=nu
-00035b60: 6d65 7269 635f 6f6e 6c79 2c20 7370 6c69  meric_only, spli
-00035b70: 745f 6576 6572 793d 7370 6c69 745f 6576  t_every=split_ev
-00035b80: 6572 790a 2020 2020 2020 2020 290a 0a20  ery.        ).. 
-00035b90: 2020 2064 6566 2069 6e66 6f28 7365 6c66     def info(self
-00035ba0: 2c20 6275 663d 4e6f 6e65 2c20 7665 7262  , buf=None, verb
-00035bb0: 6f73 653d 4661 6c73 652c 206d 656d 6f72  ose=False, memor
-00035bc0: 795f 7573 6167 653d 4661 6c73 6529 3a0a  y_usage=False):.
-00035bd0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00035be0: 2020 2020 436f 6e63 6973 6520 7375 6d6d      Concise summ
-00035bf0: 6172 7920 6f66 2061 2044 6173 6b20 4461  ary of a Dask Da
-00035c00: 7461 4672 616d 652e 0a20 2020 2020 2020  taFrame..       
-00035c10: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
-00035c20: 2062 7566 2069 7320 4e6f 6e65 3a0a 2020   buf is None:.  
-00035c30: 2020 2020 2020 2020 2020 696d 706f 7274            import
-00035c40: 2073 7973 0a0a 2020 2020 2020 2020 2020   sys..          
-00035c50: 2020 6275 6620 3d20 7379 732e 7374 646f    buf = sys.stdo
-00035c60: 7574 0a0a 2020 2020 2020 2020 6c69 6e65  ut..        line
-00035c70: 7320 3d20 5b73 7472 2874 7970 6528 7365  s = [str(type(se
-00035c80: 6c66 2929 5d0a 0a20 2020 2020 2020 2069  lf))]..        i
-00035c90: 6620 6c65 6e28 7365 6c66 2e63 6f6c 756d  f len(self.colum
-00035ca0: 6e73 2920 3d3d 2030 3a0a 2020 2020 2020  ns) == 0:.      
-00035cb0: 2020 2020 2020 6c69 6e65 732e 6170 7065        lines.appe
-00035cc0: 6e64 2866 227b 7479 7065 2873 656c 662e  nd(f"{type(self.
-00035cd0: 696e 6465 782e 5f6d 6574 6129 2e5f 5f6e  index._meta).__n
-00035ce0: 616d 655f 5f7d 3a20 3020 656e 7472 6965  ame__}: 0 entrie
-00035cf0: 7322 290a 2020 2020 2020 2020 2020 2020  s").            
-00035d00: 6c69 6e65 732e 6170 7065 6e64 2866 2245  lines.append(f"E
-00035d10: 6d70 7479 207b 7479 7065 2873 656c 6629  mpty {type(self)
-00035d20: 2e5f 5f6e 616d 655f 5f7d 2229 0a20 2020  .__name__}").   
-00035d30: 2020 2020 2020 2020 2069 6620 5041 4e44           if PAND
-00035d40: 4153 5f47 545f 3135 303a 0a20 2020 2020  AS_GT_150:.     
-00035d50: 2020 2020 2020 2020 2020 2023 2070 616e             # pan
-00035d60: 6461 7320 6461 7461 6672 616d 6520 7374  das dataframe st
-00035d70: 6172 7465 6420 6164 6469 6e67 2061 206e  arted adding a n
-00035d80: 6577 6c69 6e65 2077 6865 6e20 696e 666f  ewline when info
-00035d90: 2069 7320 6361 6c6c 6564 2e0a 2020 2020   is called..    
+000339b0: 2320 616e 6420 7468 6520 6f70 6572 6174  # and the operat
+000339c0: 6f72 2069 7320 6170 706c 6965 6420 6272  or is applied br
+000339d0: 6f61 6463 6173 7420 6163 726f 7373 2072  oadcast across r
+000339e0: 6f77 732e 2054 6869 730a 2020 2020 2020  ows. This.      
+000339f0: 2020 2020 2020 2020 2020 2320 6973 6e27            # isn'
+00033a00: 7420 7375 7070 6f72 7465 6420 7769 7468  t supported with
+00033a10: 2064 642e 5365 7269 6573 2e0a 2020 2020   dd.Series..    
+00033a20: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00033a30: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
+00033a40: 2053 6572 6965 7329 3a0a 2020 2020 2020   Series):.      
+00033a50: 2020 2020 2020 2020 2020 2020 2020 6d73                ms
+00033a60: 6720 3d20 6622 556e 6162 6c65 2074 6f20  g = f"Unable to 
+00033a70: 7b6e 616d 657d 2064 642e 5365 7269 6573  {name} dd.Series
+00033a80: 2077 6974 6820 6178 6973 3d31 220a 2020   with axis=1".  
+00033a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033aa0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00033ab0: 6f72 286d 7367 290a 2020 2020 2020 2020  or(msg).        
+00033ac0: 2020 2020 2020 2020 656c 6966 2069 735f          elif is_
+00033ad0: 7365 7269 6573 5f6c 696b 6528 6f74 6865  series_like(othe
+00033ae0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+00033af0: 2020 2020 2020 2020 2320 5370 6563 6961          # Specia
+00033b00: 6c20 6361 7365 2066 6f72 2070 642e 5365  l case for pd.Se
+00033b10: 7269 6573 2074 6f20 6176 6f69 6420 756e  ries to avoid un
+00033b20: 7761 6e74 6564 2070 6172 7469 7469 6f6e  wanted partition
+00033b30: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
+00033b40: 2020 2020 2020 2020 2320 6f66 206f 7468          # of oth
+00033b50: 6572 2e20 5765 2070 6173 7320 6974 2069  er. We pass it i
+00033b60: 6e20 6173 2061 206b 7761 7267 2074 6f20  n as a kwarg to 
+00033b70: 7072 6576 656e 7420 7468 6973 2e0a 2020  prevent this..  
+00033b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033b90: 2020 6d65 7461 203d 205f 656d 756c 6174    meta = _emulat
+00033ba0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00033bb0: 2020 2020 2020 2020 2020 206f 702c 2073             op, s
+00033bc0: 656c 662c 206f 7468 6572 3d6f 7468 6572  elf, other=other
+00033bd0: 2c20 6178 6973 3d61 7869 732c 2066 696c  , axis=axis, fil
+00033be0: 6c5f 7661 6c75 653d 6669 6c6c 5f76 616c  l_value=fill_val
+00033bf0: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
+00033c00: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00033c10: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00033c20: 7572 6e20 6d61 705f 7061 7274 6974 696f  urn map_partitio
+00033c30: 6e73 280a 2020 2020 2020 2020 2020 2020  ns(.            
+00033c40: 2020 2020 2020 2020 2020 2020 6f70 2c0a              op,.
+00033c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033c60: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00033c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033c80: 2020 2020 2020 6f74 6865 723d 6f74 6865        other=othe
+00033c90: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
+00033ca0: 2020 2020 2020 2020 2020 206d 6574 613d             meta=
+00033cb0: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
+00033cc0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00033cd0: 6973 3d61 7869 732c 0a20 2020 2020 2020  is=axis,.       
+00033ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033cf0: 2066 696c 6c5f 7661 6c75 653d 6669 6c6c   fill_value=fill
+00033d00: 5f76 616c 7565 2c0a 2020 2020 2020 2020  _value,.        
+00033d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033d20: 656e 666f 7263 655f 6d65 7461 6461 7461  enforce_metadata
+00033d30: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00033d40: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00033d50: 2020 2020 2020 2020 2020 206d 6574 6120             meta 
+00033d60: 3d20 5f65 6d75 6c61 7465 286f 702c 2073  = _emulate(op, s
+00033d70: 656c 662c 206f 7468 6572 2c20 6178 6973  elf, other, axis
+00033d80: 3d61 7869 732c 2066 696c 6c5f 7661 6c75  =axis, fill_valu
+00033d90: 653d 6669 6c6c 5f76 616c 7565 290a 2020  e=fill_value).  
+00033da0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00033db0: 206d 6170 5f70 6172 7469 7469 6f6e 7328   map_partitions(
+00033dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033dd0: 206f 702c 0a20 2020 2020 2020 2020 2020   op,.           
+00033de0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00033df0: 2020 2020 2020 2020 2020 206f 7468 6572             other
+00033e00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00033e10: 2020 6d65 7461 3d6d 6574 612c 0a20 2020    meta=meta,.   
+00033e20: 2020 2020 2020 2020 2020 2020 2061 7869               axi
+00033e30: 733d 6178 6973 2c0a 2020 2020 2020 2020  s=axis,.        
+00033e40: 2020 2020 2020 2020 6669 6c6c 5f76 616c          fill_val
+00033e50: 7565 3d66 696c 6c5f 7661 6c75 652c 0a20  ue=fill_value,. 
+00033e60: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00033e70: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
+00033e80: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+00033e90: 2020 2029 0a0a 2020 2020 2020 2020 6d65     )..        me
+00033ea0: 7468 2e5f 5f6e 616d 655f 5f20 3d20 6e61  th.__name__ = na
+00033eb0: 6d65 0a20 2020 2020 2020 2073 6574 6174  me.        setat
+00033ec0: 7472 2863 6c73 2c20 6e61 6d65 2c20 6465  tr(cls, name, de
+00033ed0: 7269 7665 645f 6672 6f6d 286f 7269 6769  rived_from(origi
+00033ee0: 6e61 6c29 286d 6574 6829 290a 0a20 2020  nal)(meth))..   
+00033ef0: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
+00033f00: 2020 6465 6620 5f62 696e 645f 636f 6d70    def _bind_comp
+00033f10: 6172 6973 6f6e 5f6d 6574 686f 6428 636c  arison_method(cl
+00033f20: 732c 206e 616d 652c 2063 6f6d 7061 7269  s, name, compari
+00033f30: 736f 6e2c 206f 7269 6769 6e61 6c3d 7064  son, original=pd
+00033f40: 2e44 6174 6146 7261 6d65 293a 0a20 2020  .DataFrame):.   
+00033f50: 2020 2020 2022 2222 6269 6e64 2063 6f6d       """bind com
+00033f60: 7061 7269 736f 6e20 6d65 7468 6f64 206c  parison method l
+00033f70: 696b 6520 4461 7461 4672 616d 652e 6571  ike DataFrame.eq
+00033f80: 2074 6f20 7468 6973 2063 6c61 7373 2222   to this class""
+00033f90: 220a 0a20 2020 2020 2020 2064 6566 206d  "..        def m
+00033fa0: 6574 6828 7365 6c66 2c20 6f74 6865 722c  eth(self, other,
+00033fb0: 2061 7869 733d 2263 6f6c 756d 6e73 222c   axis="columns",
+00033fc0: 206c 6576 656c 3d4e 6f6e 6529 3a0a 2020   level=None):.  
+00033fd0: 2020 2020 2020 2020 2020 6966 206c 6576            if lev
+00033fe0: 656c 2069 7320 6e6f 7420 4e6f 6e65 3a0a  el is not None:.
+00033ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034000: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+00034010: 6e74 6564 4572 726f 7228 226c 6576 656c  ntedError("level
+00034020: 206d 7573 7420 6265 204e 6f6e 6522 290a   must be None").
+00034030: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+00034040: 203d 2073 656c 662e 5f76 616c 6964 6174   = self._validat
+00034050: 655f 6178 6973 2861 7869 7329 0a20 2020  e_axis(axis).   
+00034060: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00034070: 656c 656d 7769 7365 2863 6f6d 7061 7269  elemwise(compari
+00034080: 736f 6e2c 2073 656c 662c 206f 7468 6572  son, self, other
+00034090: 2c20 6178 6973 3d61 7869 7329 0a0a 2020  , axis=axis)..  
+000340a0: 2020 2020 2020 6d65 7468 2e5f 5f6e 616d        meth.__nam
+000340b0: 655f 5f20 3d20 6e61 6d65 0a20 2020 2020  e__ = name.     
+000340c0: 2020 2073 6574 6174 7472 2863 6c73 2c20     setattr(cls, 
+000340d0: 6e61 6d65 2c20 6465 7269 7665 645f 6672  name, derived_fr
+000340e0: 6f6d 286f 7269 6769 6e61 6c29 286d 6574  om(original)(met
+000340f0: 6829 290a 0a20 2020 2040 696e 7365 7274  h))..    @insert
+00034100: 5f6d 6574 615f 7061 7261 6d5f 6465 7363  _meta_param_desc
+00034110: 7269 7074 696f 6e28 7061 643d 3132 290a  ription(pad=12).
+00034120: 2020 2020 6465 6620 6170 706c 7928 0a20      def apply(. 
+00034130: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00034140: 2020 2020 2066 756e 632c 0a20 2020 2020       func,.     
+00034150: 2020 2061 7869 733d 302c 0a20 2020 2020     axis=0,.     
+00034160: 2020 2062 726f 6164 6361 7374 3d4e 6f6e     broadcast=Non
+00034170: 652c 0a20 2020 2020 2020 2072 6177 3d46  e,.        raw=F
+00034180: 616c 7365 2c0a 2020 2020 2020 2020 7265  alse,.        re
+00034190: 6475 6365 3d4e 6f6e 652c 0a20 2020 2020  duce=None,.     
+000341a0: 2020 2061 7267 733d 2829 2c0a 2020 2020     args=(),.    
+000341b0: 2020 2020 6d65 7461 3d6e 6f5f 6465 6661      meta=no_defa
+000341c0: 756c 742c 0a20 2020 2020 2020 2072 6573  ult,.        res
+000341d0: 756c 745f 7479 7065 3d4e 6f6e 652c 0a20  ult_type=None,. 
+000341e0: 2020 2020 2020 202a 2a6b 7764 732c 0a20         **kwds,. 
+000341f0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+00034200: 2250 6172 616c 6c65 6c20 7665 7273 696f  "Parallel versio
+00034210: 6e20 6f66 2070 616e 6461 732e 4461 7461  n of pandas.Data
+00034220: 4672 616d 652e 6170 706c 790a 0a20 2020  Frame.apply..   
+00034230: 2020 2020 2054 6869 7320 6d69 6d69 6373       This mimics
+00034240: 2074 6865 2070 616e 6461 7320 7665 7273   the pandas vers
+00034250: 696f 6e20 6578 6365 7074 2066 6f72 2074  ion except for t
+00034260: 6865 2066 6f6c 6c6f 7769 6e67 3a0a 0a20  he following:.. 
+00034270: 2020 2020 2020 2031 2e20 204f 6e6c 7920         1.  Only 
+00034280: 6060 6178 6973 3d31 6060 2069 7320 7375  ``axis=1`` is su
+00034290: 7070 6f72 7465 6420 2861 6e64 206d 7573  pported (and mus
+000342a0: 7420 6265 2073 7065 6369 6669 6564 2065  t be specified e
+000342b0: 7870 6c69 6369 746c 7929 2e0a 2020 2020  xplicitly)..    
+000342c0: 2020 2020 322e 2020 5468 6520 7573 6572      2.  The user
+000342d0: 2073 686f 756c 6420 7072 6f76 6964 6520   should provide 
+000342e0: 6f75 7470 7574 206d 6574 6164 6174 6120  output metadata 
+000342f0: 7669 6120 7468 6520 606d 6574 6160 206b  via the `meta` k
+00034300: 6579 776f 7264 2e0a 0a20 2020 2020 2020  eyword...       
+00034310: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00034320: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00034330: 2020 2020 2020 2066 756e 6320 3a20 6675         func : fu
+00034340: 6e63 7469 6f6e 0a20 2020 2020 2020 2020  nction.         
+00034350: 2020 2046 756e 6374 696f 6e20 746f 2061     Function to a
+00034360: 7070 6c79 2074 6f20 6561 6368 2063 6f6c  pply to each col
+00034370: 756d 6e2f 726f 770a 2020 2020 2020 2020  umn/row.        
+00034380: 6178 6973 203a 207b 3020 6f72 2027 696e  axis : {0 or 'in
+00034390: 6465 7827 2c20 3120 6f72 2027 636f 6c75  dex', 1 or 'colu
+000343a0: 6d6e 7327 7d2c 2064 6566 6175 6c74 2030  mns'}, default 0
+000343b0: 0a20 2020 2020 2020 2020 2020 202d 2030  .            - 0
+000343c0: 206f 7220 2769 6e64 6578 273a 2061 7070   or 'index': app
+000343d0: 6c79 2066 756e 6374 696f 6e20 746f 2065  ly function to e
+000343e0: 6163 6820 636f 6c75 6d6e 2028 4e4f 5420  ach column (NOT 
+000343f0: 5355 5050 4f52 5445 4429 0a20 2020 2020  SUPPORTED).     
+00034400: 2020 2020 2020 202d 2031 206f 7220 2763         - 1 or 'c
+00034410: 6f6c 756d 6e73 273a 2061 7070 6c79 2066  olumns': apply f
+00034420: 756e 6374 696f 6e20 746f 2065 6163 6820  unction to each 
+00034430: 726f 770a 2020 2020 2020 2020 244d 4554  row.        $MET
+00034440: 410a 2020 2020 2020 2020 6172 6773 203a  A.        args :
+00034450: 2074 7570 6c65 0a20 2020 2020 2020 2020   tuple.         
+00034460: 2020 2050 6f73 6974 696f 6e61 6c20 6172     Positional ar
+00034470: 6775 6d65 6e74 7320 746f 2070 6173 7320  guments to pass 
+00034480: 746f 2066 756e 6374 696f 6e20 696e 2061  to function in a
+00034490: 6464 6974 696f 6e20 746f 2074 6865 2061  ddition to the a
+000344a0: 7272 6179 2f73 6572 6965 730a 0a20 2020  rray/series..   
+000344b0: 2020 2020 2041 6464 6974 696f 6e61 6c20       Additional 
+000344c0: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
+000344d0: 7320 7769 6c6c 2062 6520 7061 7373 6564  s will be passed
+000344e0: 2061 7320 6b65 7977 6f72 6473 2074 6f20   as keywords to 
+000344f0: 7468 6520 6675 6e63 7469 6f6e 0a0a 2020  the function..  
+00034500: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+00034510: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+00034520: 2020 2020 2020 6170 706c 6965 6420 3a20        applied : 
+00034530: 5365 7269 6573 206f 7220 4461 7461 4672  Series or DataFr
+00034540: 616d 650a 0a20 2020 2020 2020 2045 7861  ame..        Exa
+00034550: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
+00034560: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
+00034570: 3e3e 2069 6d70 6f72 7420 7061 6e64 6173  >> import pandas
+00034580: 2061 7320 7064 0a20 2020 2020 2020 203e   as pd.        >
+00034590: 3e3e 2069 6d70 6f72 7420 6461 736b 2e64  >> import dask.d
+000345a0: 6174 6166 7261 6d65 2061 7320 6464 0a20  ataframe as dd. 
+000345b0: 2020 2020 2020 203e 3e3e 2064 6620 3d20         >>> df = 
+000345c0: 7064 2e44 6174 6146 7261 6d65 287b 2778  pd.DataFrame({'x
+000345d0: 273a 205b 312c 2032 2c20 332c 2034 2c20  ': [1, 2, 3, 4, 
+000345e0: 355d 2c0a 2020 2020 2020 2020 2e2e 2e20  5],.        ... 
+000345f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034600: 2020 2027 7927 3a20 5b31 2e2c 2032 2e2c     'y': [1., 2.,
+00034610: 2033 2e2c 2034 2e2c 2035 2e5d 7d29 0a20   3., 4., 5.]}). 
+00034620: 2020 2020 2020 203e 3e3e 2064 6466 203d         >>> ddf =
+00034630: 2064 642e 6672 6f6d 5f70 616e 6461 7328   dd.from_pandas(
+00034640: 6466 2c20 6e70 6172 7469 7469 6f6e 733d  df, npartitions=
+00034650: 3229 0a0a 2020 2020 2020 2020 4170 706c  2)..        Appl
+00034660: 7920 6120 6675 6e63 7469 6f6e 2074 6f20  y a function to 
+00034670: 726f 772d 7769 7365 2070 6173 7369 6e67  row-wise passing
+00034680: 2069 6e20 6578 7472 6120 6172 6775 6d65   in extra argume
+00034690: 6e74 7320 696e 2060 6061 7267 7360 6020  nts in ``args`` 
+000346a0: 616e 640a 2020 2020 2020 2020 6060 6b77  and.        ``kw
+000346b0: 6172 6773 6060 3a0a 0a20 2020 2020 2020  args``:..       
+000346c0: 203e 3e3e 2064 6566 206d 7961 6464 2872   >>> def myadd(r
+000346d0: 6f77 2c20 612c 2062 3d31 293a 0a20 2020  ow, a, b=1):.   
+000346e0: 2020 2020 202e 2e2e 2020 2020 2072 6574       ...     ret
+000346f0: 7572 6e20 726f 772e 7375 6d28 2920 2b20  urn row.sum() + 
+00034700: 6120 2b20 620a 2020 2020 2020 2020 3e3e  a + b.        >>
+00034710: 3e20 7265 7320 3d20 6464 662e 6170 706c  > res = ddf.appl
+00034720: 7928 6d79 6164 642c 2061 7869 733d 312c  y(myadd, axis=1,
+00034730: 2061 7267 733d 2832 2c29 2c20 623d 312e   args=(2,), b=1.
+00034740: 3529 2020 2320 646f 6374 6573 743a 202b  5)  # doctest: +
+00034750: 534b 4950 0a0a 2020 2020 2020 2020 4279  SKIP..        By
+00034760: 2064 6566 6175 6c74 2c20 6461 736b 2074   default, dask t
+00034770: 7269 6573 2074 6f20 696e 6665 7220 7468  ries to infer th
+00034780: 6520 6f75 7470 7574 206d 6574 6164 6174  e output metadat
+00034790: 6120 6279 2072 756e 6e69 6e67 2079 6f75  a by running you
+000347a0: 720a 2020 2020 2020 2020 7072 6f76 6964  r.        provid
+000347b0: 6564 2066 756e 6374 696f 6e20 6f6e 2073  ed function on s
+000347c0: 6f6d 6520 6661 6b65 2064 6174 612e 2054  ome fake data. T
+000347d0: 6869 7320 776f 726b 7320 7765 6c6c 2069  his works well i
+000347e0: 6e20 6d61 6e79 2063 6173 6573 2c20 6275  n many cases, bu
+000347f0: 740a 2020 2020 2020 2020 6361 6e20 736f  t.        can so
+00034800: 6d65 7469 6d65 7320 6265 2065 7870 656e  metimes be expen
+00034810: 7369 7665 2c20 6f72 2065 7665 6e20 6661  sive, or even fa
+00034820: 696c 2e20 546f 2061 766f 6964 2074 6869  il. To avoid thi
+00034830: 732c 2079 6f75 2063 616e 0a20 2020 2020  s, you can.     
+00034840: 2020 206d 616e 7561 6c6c 7920 7370 6563     manually spec
+00034850: 6966 7920 7468 6520 6f75 7470 7574 206d  ify the output m
+00034860: 6574 6164 6174 6120 7769 7468 2074 6865  etadata with the
+00034870: 2060 606d 6574 6160 6020 6b65 7977 6f72   ``meta`` keywor
+00034880: 642e 2054 6869 730a 2020 2020 2020 2020  d. This.        
+00034890: 6361 6e20 6265 2073 7065 6369 6669 6564  can be specified
+000348a0: 2069 6e20 6d61 6e79 2066 6f72 6d73 2c20   in many forms, 
+000348b0: 666f 7220 6d6f 7265 2069 6e66 6f72 6d61  for more informa
+000348c0: 7469 6f6e 2073 6565 0a20 2020 2020 2020  tion see.       
+000348d0: 2060 6064 6173 6b2e 6461 7461 6672 616d   ``dask.datafram
+000348e0: 652e 7574 696c 732e 6d61 6b65 5f6d 6574  e.utils.make_met
+000348f0: 6160 602e 0a0a 2020 2020 2020 2020 4865  a``...        He
+00034900: 7265 2077 6520 7370 6563 6966 7920 7468  re we specify th
+00034910: 6520 6f75 7470 7574 2069 7320 6120 5365  e output is a Se
+00034920: 7269 6573 2077 6974 6820 6e61 6d65 2060  ries with name `
+00034930: 6027 7827 6060 2c20 616e 6420 6474 7970  `'x'``, and dtyp
+00034940: 650a 2020 2020 2020 2020 6060 666c 6f61  e.        ``floa
+00034950: 7436 3460 603a 0a0a 2020 2020 2020 2020  t64``:..        
+00034960: 3e3e 3e20 7265 7320 3d20 6464 662e 6170  >>> res = ddf.ap
+00034970: 706c 7928 6d79 6164 642c 2061 7869 733d  ply(myadd, axis=
+00034980: 312c 2061 7267 733d 2832 2c29 2c20 623d  1, args=(2,), b=
+00034990: 312e 352c 206d 6574 613d 2827 7827 2c20  1.5, meta=('x', 
+000349a0: 2766 3827 2929 0a0a 2020 2020 2020 2020  'f8'))..        
+000349b0: 496e 2074 6865 2063 6173 6520 7768 6572  In the case wher
+000349c0: 6520 7468 6520 6d65 7461 6461 7461 2064  e the metadata d
+000349d0: 6f65 736e 2774 2063 6861 6e67 652c 2079  oesn't change, y
+000349e0: 6f75 2063 616e 2061 6c73 6f20 7061 7373  ou can also pass
+000349f0: 2069 6e0a 2020 2020 2020 2020 7468 6520   in.        the 
+00034a00: 6f62 6a65 6374 2069 7473 656c 6620 6469  object itself di
+00034a10: 7265 6374 6c79 3a0a 0a20 2020 2020 2020  rectly:..       
+00034a20: 203e 3e3e 2072 6573 203d 2064 6466 2e61   >>> res = ddf.a
+00034a30: 7070 6c79 286c 616d 6264 6120 726f 773a  pply(lambda row:
+00034a40: 2072 6f77 202b 2031 2c20 6178 6973 3d31   row + 1, axis=1
+00034a50: 2c20 6d65 7461 3d64 6466 290a 0a20 2020  , meta=ddf)..   
+00034a60: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
+00034a70: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+00034a80: 2020 2020 2020 2064 6173 6b2e 4461 7461         dask.Data
+00034a90: 4672 616d 652e 6d61 705f 7061 7274 6974  Frame.map_partit
+00034aa0: 696f 6e73 0a20 2020 2020 2020 2022 2222  ions.        """
+00034ab0: 0a0a 2020 2020 2020 2020 6966 2062 726f  ..        if bro
+00034ac0: 6164 6361 7374 2069 7320 6e6f 7420 4e6f  adcast is not No
+00034ad0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00034ae0: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
+00034af0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00034b00: 5468 6520 6062 726f 6164 6361 7374 6020  The `broadcast` 
+00034b10: 6172 6775 6d65 6e74 2069 7320 6e6f 206c  argument is no l
+00034b20: 6f6e 6765 7220 7573 6564 2f73 7570 706f  onger used/suppo
+00034b30: 7274 6564 2e20 220a 2020 2020 2020 2020  rted. ".        
+00034b40: 2020 2020 2020 2020 2249 7420 7769 6c6c          "It will
+00034b50: 2062 6520 6472 6f70 7065 6420 696e 2061   be dropped in a
+00034b60: 2066 7574 7572 6520 7265 6c65 6173 652e   future release.
+00034b70: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00034b80: 2020 2063 6174 6567 6f72 793d 4675 7475     category=Futu
+00034b90: 7265 5761 726e 696e 672c 0a20 2020 2020  reWarning,.     
+00034ba0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00034bb0: 2020 6178 6973 203d 2073 656c 662e 5f76    axis = self._v
+00034bc0: 616c 6964 6174 655f 6178 6973 2861 7869  alidate_axis(axi
+00034bd0: 7329 0a20 2020 2020 2020 2070 616e 6461  s).        panda
+00034be0: 735f 6b77 6172 6773 203d 207b 2261 7869  s_kwargs = {"axi
+00034bf0: 7322 3a20 6178 6973 2c20 2272 6177 223a  s": axis, "raw":
+00034c00: 2072 6177 2c20 2272 6573 756c 745f 7479   raw, "result_ty
+00034c10: 7065 223a 2072 6573 756c 745f 7479 7065  pe": result_type
+00034c20: 7d0a 0a20 2020 2020 2020 206b 7764 732e  }..        kwds.
+00034c30: 7570 6461 7465 2870 616e 6461 735f 6b77  update(pandas_kw
+00034c40: 6172 6773 290a 0a20 2020 2020 2020 2069  args)..        i
+00034c50: 6620 6178 6973 203d 3d20 303a 0a20 2020  f axis == 0:.   
+00034c60: 2020 2020 2020 2020 206d 7367 203d 2028           msg = (
+00034c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034c80: 2022 6464 2e44 6174 6146 7261 6d65 2e61   "dd.DataFrame.a
+00034c90: 7070 6c79 206f 6e6c 7920 7375 7070 6f72  pply only suppor
+00034ca0: 7473 2061 7869 733d 315c 6e22 0a20 2020  ts axis=1\n".   
+00034cb0: 2020 2020 2020 2020 2020 2020 2022 2020               "  
+00034cc0: 5472 793a 2064 662e 6170 706c 7928 6675  Try: df.apply(fu
+00034cd0: 6e63 2c20 6178 6973 3d31 2922 0a20 2020  nc, axis=1)".   
+00034ce0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00034cf0: 2020 2020 2020 2072 6169 7365 204e 6f74         raise Not
+00034d00: 496d 706c 656d 656e 7465 6445 7272 6f72  ImplementedError
+00034d10: 286d 7367 290a 0a20 2020 2020 2020 2069  (msg)..        i
+00034d20: 6620 6d65 7461 2069 7320 6e6f 5f64 6566  f meta is no_def
+00034d30: 6175 6c74 3a0a 2020 2020 2020 2020 2020  ault:.          
+00034d40: 2020 6d65 7461 203d 205f 656d 756c 6174    meta = _emulat
+00034d50: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00034d60: 2020 204d 2e61 7070 6c79 2c20 7365 6c66     M.apply, self
+00034d70: 2e5f 6d65 7461 5f6e 6f6e 656d 7074 792c  ._meta_nonempty,
+00034d80: 2066 756e 632c 2061 7267 733d 6172 6773   func, args=args
+00034d90: 2c20 7564 663d 5472 7565 2c20 2a2a 6b77  , udf=True, **kw
+00034da0: 6473 0a20 2020 2020 2020 2020 2020 2029  ds.            )
+00034db0: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+00034dc0: 6e69 6e67 732e 7761 726e 286d 6574 615f  nings.warn(meta_
+00034dd0: 7761 726e 696e 6728 6d65 7461 2929 0a20  warning(meta)). 
+00034de0: 2020 2020 2020 206b 7764 732e 7570 6461         kwds.upda
+00034df0: 7465 287b 2270 6172 656e 745f 6d65 7461  te({"parent_meta
+00034e00: 223a 2073 656c 662e 5f6d 6574 617d 290a  ": self._meta}).
+00034e10: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+00034e20: 6170 5f70 6172 7469 7469 6f6e 7328 4d2e  ap_partitions(M.
+00034e30: 6170 706c 792c 2073 656c 662c 2066 756e  apply, self, fun
+00034e40: 632c 2061 7267 733d 6172 6773 2c20 6d65  c, args=args, me
+00034e50: 7461 3d6d 6574 612c 202a 2a6b 7764 7329  ta=meta, **kwds)
+00034e60: 0a0a 2020 2020 4064 6572 6976 6564 5f66  ..    @derived_f
+00034e70: 726f 6d28 7064 2e44 6174 6146 7261 6d65  rom(pd.DataFrame
+00034e80: 290a 2020 2020 6465 6620 6170 706c 796d  ).    def applym
+00034e90: 6170 2873 656c 662c 2066 756e 632c 206d  ap(self, func, m
+00034ea0: 6574 613d 6e6f 5f64 6566 6175 6c74 293a  eta=no_default):
+00034eb0: 0a20 2020 2020 2020 2023 204c 6574 2070  .        # Let p
+00034ec0: 616e 6461 7320 7261 6973 6520 6465 7072  andas raise depr
+00034ed0: 6563 6174 696f 6e20 7761 726e 696e 6773  ecation warnings
+00034ee0: 0a20 2020 2020 2020 2073 656c 662e 5f6d  .        self._m
+00034ef0: 6574 612e 6170 706c 796d 6170 2866 756e  eta.applymap(fun
+00034f00: 6329 0a20 2020 2020 2020 2072 6574 7572  c).        retur
+00034f10: 6e20 656c 656d 7769 7365 286d 6574 686f  n elemwise(metho
+00034f20: 6473 2e61 7070 6c79 6d61 702c 2073 656c  ds.applymap, sel
+00034f30: 662c 2066 756e 632c 206d 6574 613d 6d65  f, func, meta=me
+00034f40: 7461 290a 0a20 2020 2064 6566 206d 6170  ta)..    def map
+00034f50: 2873 656c 662c 2066 756e 632c 206d 6574  (self, func, met
+00034f60: 613d 6e6f 5f64 6566 6175 6c74 2c20 6e61  a=no_default, na
+00034f70: 5f61 6374 696f 6e3d 4e6f 6e65 293a 0a20  _action=None):. 
+00034f80: 2020 2020 2020 2069 6620 6e6f 7420 5041         if not PA
+00034f90: 4e44 4153 5f47 545f 3231 303a 0a20 2020  NDAS_GT_210:.   
+00034fa0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+00034fb0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+00034fc0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00034fd0: 2020 2020 6622 4461 7461 4672 616d 652e      f"DataFrame.
+00034fe0: 6d61 7020 7265 7175 6972 6573 2070 616e  map requires pan
+00034ff0: 6461 733e 3d32 2e31 2e30 2c20 6275 7420  das>=2.1.0, but 
+00035000: 7061 6e64 6173 3d7b 5041 4e44 4153 5f56  pandas={PANDAS_V
+00035010: 4552 5349 4f4e 7d20 6973 2022 0a20 2020  ERSION} is ".   
+00035020: 2020 2020 2020 2020 2020 2020 2022 696e               "in
+00035030: 7374 616c 6c65 642e 220a 2020 2020 2020  stalled.".      
+00035040: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00035050: 7265 7475 726e 2065 6c65 6d77 6973 6528  return elemwise(
+00035060: 4d2e 6d61 702c 2073 656c 662c 2066 756e  M.map, self, fun
+00035070: 632c 206d 6574 613d 6d65 7461 2c20 6e61  c, meta=meta, na
+00035080: 5f61 6374 696f 6e3d 6e61 5f61 6374 696f  _action=na_actio
+00035090: 6e29 0a0a 2020 2020 4064 6572 6976 6564  n)..    @derived
+000350a0: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+000350b0: 6d65 290a 2020 2020 6465 6620 726f 756e  me).    def roun
+000350c0: 6428 7365 6c66 2c20 6465 6369 6d61 6c73  d(self, decimals
+000350d0: 3d30 293a 0a20 2020 2020 2020 2072 6574  =0):.        ret
+000350e0: 7572 6e20 656c 656d 7769 7365 284d 2e72  urn elemwise(M.r
+000350f0: 6f75 6e64 2c20 7365 6c66 2c20 6465 6369  ound, self, deci
+00035100: 6d61 6c73 290a 0a20 2020 2040 6465 7269  mals)..    @deri
+00035110: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
+00035120: 4672 616d 6529 0a20 2020 2064 6566 206e  Frame).    def n
+00035130: 756e 6971 7565 2873 656c 662c 2073 706c  unique(self, spl
+00035140: 6974 5f65 7665 7279 3d46 616c 7365 2c20  it_every=False, 
+00035150: 6472 6f70 6e61 3d54 7275 652c 2061 7869  dropna=True, axi
+00035160: 733d 3029 3a0a 2020 2020 2020 2020 6966  s=0):.        if
+00035170: 2061 7869 7320 3d3d 2031 3a0a 2020 2020   axis == 1:.    
+00035180: 2020 2020 2020 2020 2320 7370 6c69 745f          # split_
+00035190: 6576 6572 7920 6e6f 7420 7573 6564 2066  every not used f
+000351a0: 6f72 2061 7869 733d 310a 2020 2020 2020  or axis=1.      
+000351b0: 2020 2020 2020 6d65 7461 203d 2073 656c        meta = sel
+000351c0: 662e 5f6d 6574 615f 6e6f 6e65 6d70 7479  f._meta_nonempty
+000351d0: 2e6e 756e 6971 7565 2861 7869 733d 6178  .nunique(axis=ax
+000351e0: 6973 290a 2020 2020 2020 2020 2020 2020  is).            
+000351f0: 7265 7475 726e 2073 656c 662e 6d61 705f  return self.map_
+00035200: 7061 7274 6974 696f 6e73 280a 2020 2020  partitions(.    
+00035210: 2020 2020 2020 2020 2020 2020 4d2e 6e75              M.nu
+00035220: 6e69 7175 652c 0a20 2020 2020 2020 2020  nique,.         
+00035230: 2020 2020 2020 206d 6574 613d 6d65 7461         meta=meta
+00035240: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00035250: 2020 746f 6b65 6e3d 2273 6572 6965 732d    token="series-
+00035260: 6e75 6e69 7175 6522 2c0a 2020 2020 2020  nunique",.      
+00035270: 2020 2020 2020 2020 2020 6178 6973 3d61            axis=a
+00035280: 7869 732c 0a20 2020 2020 2020 2020 2020  xis,.           
+00035290: 2020 2020 2064 726f 706e 613d 6472 6f70       dropna=drop
+000352a0: 6e61 2c0a 2020 2020 2020 2020 2020 2020  na,.            
+000352b0: 2020 2020 656e 666f 7263 655f 6d65 7461      enforce_meta
+000352c0: 6461 7461 3d46 616c 7365 2c0a 2020 2020  data=False,.    
+000352d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000352e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000352f0: 2020 2020 6e75 6e69 7175 655f 6c69 7374      nunique_list
+00035300: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+00035310: 2020 2020 2073 656c 662e 696c 6f63 5b3a       self.iloc[:
+00035320: 2c20 695d 2e6e 756e 6971 7565 2873 706c  , i].nunique(spl
+00035330: 6974 5f65 7665 7279 3d73 706c 6974 5f65  it_every=split_e
+00035340: 7665 7279 2c20 6472 6f70 6e61 3d64 726f  very, dropna=dro
+00035350: 706e 6129 0a20 2020 2020 2020 2020 2020  pna).           
+00035360: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+00035370: 6e67 6528 6c65 6e28 7365 6c66 2e63 6f6c  nge(len(self.col
+00035380: 756d 6e73 2929 0a20 2020 2020 2020 2020  umns)).         
+00035390: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
+000353a0: 206e 616d 6520 3d20 2273 6572 6965 732d   name = "series-
+000353b0: 2220 2b20 746f 6b65 6e69 7a65 282a 6e75  " + tokenize(*nu
+000353c0: 6e69 7175 655f 6c69 7374 290a 2020 2020  nique_list).    
+000353d0: 2020 2020 2020 2020 6473 6b20 3d20 7b0a          dsk = {.
+000353e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000353f0: 286e 616d 652c 2030 293a 2028 0a20 2020  (name, 0): (.   
+00035400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035410: 2061 7070 6c79 2c0a 2020 2020 2020 2020   apply,.        
+00035420: 2020 2020 2020 2020 2020 2020 7064 2e53              pd.S
+00035430: 6572 6965 732c 0a20 2020 2020 2020 2020  eries,.         
+00035440: 2020 2020 2020 2020 2020 205b 5b28 732e             [[(s.
+00035450: 5f6e 616d 652c 2030 2920 666f 7220 7320  _name, 0) for s 
+00035460: 696e 206e 756e 6971 7565 5f6c 6973 745d  in nunique_list]
+00035470: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00035480: 2020 2020 2020 207b 2269 6e64 6578 223a         {"index":
+00035490: 2073 656c 662e 636f 6c75 6d6e 737d 2c0a   self.columns},.
+000354a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000354b0: 290a 2020 2020 2020 2020 2020 2020 7d0a  ).            }.
+000354c0: 2020 2020 2020 2020 2020 2020 6772 6170              grap
+000354d0: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
+000354e0: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
+000354f0: 6f6e 7328 0a20 2020 2020 2020 2020 2020  ons(.           
+00035500: 2020 2020 206e 616d 652c 2064 736b 2c20       name, dsk, 
+00035510: 6465 7065 6e64 656e 6369 6573 3d6e 756e  dependencies=nun
+00035520: 6971 7565 5f6c 6973 740a 2020 2020 2020  ique_list.      
+00035530: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00035540: 2020 2020 7265 7475 726e 2053 6572 6965      return Serie
+00035550: 7328 6772 6170 682c 206e 616d 652c 2073  s(graph, name, s
+00035560: 656c 662e 5f6d 6574 612e 6e75 6e69 7175  elf._meta.nuniqu
+00035570: 6528 292c 2028 4e6f 6e65 2c20 4e6f 6e65  e(), (None, None
+00035580: 2929 0a0a 2020 2020 4064 6572 6976 6564  ))..    @derived
+00035590: 5f66 726f 6d28 7064 2e44 6174 6146 7261  _from(pd.DataFra
+000355a0: 6d65 290a 2020 2020 6465 6620 6d6f 6465  me).    def mode
+000355b0: 2873 656c 662c 2064 726f 706e 613d 5472  (self, dropna=Tr
+000355c0: 7565 2c20 7370 6c69 745f 6576 6572 793d  ue, split_every=
+000355d0: 4661 6c73 652c 206e 756d 6572 6963 5f6f  False, numeric_o
+000355e0: 6e6c 793d 4661 6c73 6529 3a0a 2020 2020  nly=False):.    
+000355f0: 2020 2020 6d6f 6465 5f73 6572 6965 735f      mode_series_
+00035600: 6c69 7374 203d 205b 5d0a 2020 2020 2020  list = [].      
+00035610: 2020 666f 7220 636f 6c5f 696e 6465 7820    for col_index 
+00035620: 696e 2072 616e 6765 286c 656e 2873 656c  in range(len(sel
+00035630: 662e 636f 6c75 6d6e 7329 293a 0a20 2020  f.columns)):.   
+00035640: 2020 2020 2020 2020 2063 6f6c 5f73 6572           col_ser
+00035650: 6965 7320 3d20 7365 6c66 2e69 6c6f 635b  ies = self.iloc[
+00035660: 3a2c 2063 6f6c 5f69 6e64 6578 5d0a 2020  :, col_index].  
+00035670: 2020 2020 2020 2020 2020 6966 206e 756d            if num
+00035680: 6572 6963 5f6f 6e6c 7920 616e 6420 6e6f  eric_only and no
+00035690: 7420 7064 2e61 7069 2e74 7970 6573 2e69  t pd.api.types.i
+000356a0: 735f 6e75 6d65 7269 635f 6474 7970 6528  s_numeric_dtype(
+000356b0: 636f 6c5f 7365 7269 6573 2e64 7479 7065  col_series.dtype
+000356c0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000356d0: 2020 2063 6f6e 7469 6e75 650a 2020 2020     continue.    
+000356e0: 2020 2020 2020 2020 6d6f 6465 5f73 6572          mode_ser
+000356f0: 6965 7320 3d20 5365 7269 6573 2e6d 6f64  ies = Series.mod
+00035700: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00035710: 2020 2063 6f6c 5f73 6572 6965 732c 2064     col_series, d
+00035720: 726f 706e 613d 6472 6f70 6e61 2c20 7370  ropna=dropna, sp
+00035730: 6c69 745f 6576 6572 793d 7370 6c69 745f  lit_every=split_
+00035740: 6576 6572 790a 2020 2020 2020 2020 2020  every.          
+00035750: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00035760: 6d6f 6465 5f73 6572 6965 735f 6c69 7374  mode_series_list
+00035770: 2e61 7070 656e 6428 6d6f 6465 5f73 6572  .append(mode_ser
+00035780: 6965 7329 0a0a 2020 2020 2020 2020 6e61  ies)..        na
+00035790: 6d65 203d 2022 636f 6e63 6174 2d22 202b  me = "concat-" +
+000357a0: 2074 6f6b 656e 697a 6528 2a6d 6f64 655f   tokenize(*mode_
+000357b0: 7365 7269 6573 5f6c 6973 7429 0a0a 2020  series_list)..  
+000357c0: 2020 2020 2020 6473 6b20 3d20 7b0a 2020        dsk = {.  
+000357d0: 2020 2020 2020 2020 2020 286e 616d 652c            (name,
+000357e0: 2030 293a 2028 0a20 2020 2020 2020 2020   0): (.         
+000357f0: 2020 2020 2020 2061 7070 6c79 2c0a 2020         apply,.  
+00035800: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+00035810: 7468 6f64 732e 636f 6e63 6174 2c0a 2020  thods.concat,.  
+00035820: 2020 2020 2020 2020 2020 2020 2020 5b5b                [[
+00035830: 2864 662e 5f6e 616d 652c 2030 2920 666f  (df._name, 0) fo
+00035840: 7220 6466 2069 6e20 6d6f 6465 5f73 6572  r df in mode_ser
+00035850: 6965 735f 6c69 7374 5d5d 2c0a 2020 2020  ies_list]],.    
+00035860: 2020 2020 2020 2020 2020 2020 7b22 6178              {"ax
+00035870: 6973 223a 2031 7d2c 0a20 2020 2020 2020  is": 1},.       
+00035880: 2020 2020 2029 0a20 2020 2020 2020 207d       ).        }
+00035890: 0a0a 2020 2020 2020 2020 6d65 7461 203d  ..        meta =
+000358a0: 206d 6574 686f 6473 2e63 6f6e 6361 7428   methods.concat(
+000358b0: 5b64 662e 5f6d 6574 6120 666f 7220 6466  [df._meta for df
+000358c0: 2069 6e20 6d6f 6465 5f73 6572 6965 735f   in mode_series_
+000358d0: 6c69 7374 5d2c 2061 7869 733d 3129 0a20  list], axis=1). 
+000358e0: 2020 2020 2020 2067 7261 7068 203d 2048         graph = H
+000358f0: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
+00035900: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 280a  om_collections(.
+00035910: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00035920: 2c20 6473 6b2c 2064 6570 656e 6465 6e63  , dsk, dependenc
+00035930: 6965 733d 6d6f 6465 5f73 6572 6965 735f  ies=mode_series_
+00035940: 6c69 7374 0a20 2020 2020 2020 2029 0a20  list.        ). 
+00035950: 2020 2020 2020 2064 6466 203d 206e 6577         ddf = new
+00035960: 5f64 645f 6f62 6a65 6374 2867 7261 7068  _dd_object(graph
+00035970: 2c20 6e61 6d65 2c20 6d65 7461 2c20 6469  , name, meta, di
+00035980: 7669 7369 6f6e 733d 284e 6f6e 652c 204e  visions=(None, N
+00035990: 6f6e 6529 290a 0a20 2020 2020 2020 2072  one))..        r
+000359a0: 6574 7572 6e20 6464 660a 0a20 2020 2040  eturn ddf..    @
+000359b0: 6465 7269 7665 645f 6672 6f6d 2870 642e  derived_from(pd.
+000359c0: 4461 7461 4672 616d 6529 0a20 2020 2064  DataFrame).    d
+000359d0: 6566 2063 6f76 2873 656c 662c 206d 696e  ef cov(self, min
+000359e0: 5f70 6572 696f 6473 3d4e 6f6e 652c 206e  _periods=None, n
+000359f0: 756d 6572 6963 5f6f 6e6c 793d 6e6f 5f64  umeric_only=no_d
+00035a00: 6566 6175 6c74 2c20 7370 6c69 745f 6576  efault, split_ev
+00035a10: 6572 793d 4661 6c73 6529 3a0a 2020 2020  ery=False):.    
+00035a20: 2020 2020 7265 7475 726e 205f 636f 765f      return _cov_
+00035a30: 636f 7272 280a 2020 2020 2020 2020 2020  corr(.          
+00035a40: 2020 7365 6c66 2c20 6d69 6e5f 7065 7269    self, min_peri
+00035a50: 6f64 732c 206e 756d 6572 6963 5f6f 6e6c  ods, numeric_onl
+00035a60: 793d 6e75 6d65 7269 635f 6f6e 6c79 2c20  y=numeric_only, 
+00035a70: 7370 6c69 745f 6576 6572 793d 7370 6c69  split_every=spli
+00035a80: 745f 6576 6572 790a 2020 2020 2020 2020  t_every.        
+00035a90: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00035aa0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+00035ab0: 6529 0a20 2020 2064 6566 2063 6f72 7228  e).    def corr(
+00035ac0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00035ad0: 2020 2020 2020 206d 6574 686f 643d 2270         method="p
+00035ae0: 6561 7273 6f6e 222c 0a20 2020 2020 2020  earson",.       
+00035af0: 206d 696e 5f70 6572 696f 6473 3d4e 6f6e   min_periods=Non
+00035b00: 652c 0a20 2020 2020 2020 206e 756d 6572  e,.        numer
+00035b10: 6963 5f6f 6e6c 793d 6e6f 5f64 6566 6175  ic_only=no_defau
+00035b20: 6c74 2c0a 2020 2020 2020 2020 7370 6c69  lt,.        spli
+00035b30: 745f 6576 6572 793d 4661 6c73 652c 0a20  t_every=False,. 
+00035b40: 2020 2029 3a0a 2020 2020 2020 2020 6966     ):.        if
+00035b50: 206d 6574 686f 6420 213d 2022 7065 6172   method != "pear
+00035b60: 736f 6e22 3a0a 2020 2020 2020 2020 2020  son":.          
+00035b70: 2020 7261 6973 6520 4e6f 7449 6d70 6c65    raise NotImple
+00035b80: 6d65 6e74 6564 4572 726f 7228 224f 6e6c  mentedError("Onl
+00035b90: 7920 5065 6172 736f 6e20 636f 7272 656c  y Pearson correl
+00035ba0: 6174 696f 6e20 6861 7320 6265 656e 2069  ation has been i
+00035bb0: 6d70 6c65 6d65 6e74 6564 2229 0a0a 2020  mplemented")..  
+00035bc0: 2020 2020 2020 7265 7475 726e 205f 636f        return _co
+00035bd0: 765f 636f 7272 280a 2020 2020 2020 2020  v_corr(.        
+00035be0: 2020 2020 7365 6c66 2c20 6d69 6e5f 7065      self, min_pe
+00035bf0: 7269 6f64 732c 2054 7275 652c 206e 756d  riods, True, num
+00035c00: 6572 6963 5f6f 6e6c 793d 6e75 6d65 7269  eric_only=numeri
+00035c10: 635f 6f6e 6c79 2c20 7370 6c69 745f 6576  c_only, split_ev
+00035c20: 6572 793d 7370 6c69 745f 6576 6572 790a  ery=split_every.
+00035c30: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00035c40: 6566 2069 6e66 6f28 7365 6c66 2c20 6275  ef info(self, bu
+00035c50: 663d 4e6f 6e65 2c20 7665 7262 6f73 653d  f=None, verbose=
+00035c60: 4661 6c73 652c 206d 656d 6f72 795f 7573  False, memory_us
+00035c70: 6167 653d 4661 6c73 6529 3a0a 2020 2020  age=False):.    
+00035c80: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00035c90: 436f 6e63 6973 6520 7375 6d6d 6172 7920  Concise summary 
+00035ca0: 6f66 2061 2044 6173 6b20 4461 7461 4672  of a Dask DataFr
+00035cb0: 616d 652e 0a20 2020 2020 2020 2022 2222  ame..        """
+00035cc0: 0a0a 2020 2020 2020 2020 6966 2062 7566  ..        if buf
+00035cd0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00035ce0: 2020 2020 2020 696d 706f 7274 2073 7973        import sys
+00035cf0: 0a0a 2020 2020 2020 2020 2020 2020 6275  ..            bu
+00035d00: 6620 3d20 7379 732e 7374 646f 7574 0a0a  f = sys.stdout..
+00035d10: 2020 2020 2020 2020 6c69 6e65 7320 3d20          lines = 
+00035d20: 5b73 7472 2874 7970 6528 7365 6c66 2929  [str(type(self))
+00035d30: 5d0a 0a20 2020 2020 2020 2069 6620 6c65  ]..        if le
+00035d40: 6e28 7365 6c66 2e63 6f6c 756d 6e73 2920  n(self.columns) 
+00035d50: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
+00035d60: 2020 6c69 6e65 732e 6170 7065 6e64 2866    lines.append(f
+00035d70: 227b 7479 7065 2873 656c 662e 696e 6465  "{type(self.inde
+00035d80: 782e 5f6d 6574 6129 2e5f 5f6e 616d 655f  x._meta).__name_
+00035d90: 5f7d 3a20 3020 656e 7472 6965 7322 290a  _}: 0 entries").
 00035da0: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
-00035db0: 732e 6170 7065 6e64 2822 2229 0a20 2020  s.append("").   
-00035dc0: 2020 2020 2020 2020 2070 7574 5f6c 696e           put_lin
-00035dd0: 6573 2862 7566 2c20 6c69 6e65 7329 0a20  es(buf, lines). 
-00035de0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00035df0: 6e0a 0a20 2020 2020 2020 2023 2047 726f  n..        # Gro
-00035e00: 7570 2061 6e64 2065 7865 6375 7465 2074  up and execute t
-00035e10: 6865 2072 6571 7569 7265 6420 636f 6d70  he required comp
-00035e20: 7574 6174 696f 6e73 0a20 2020 2020 2020  utations.       
-00035e30: 2063 6f6d 7075 7461 7469 6f6e 7320 3d20   computations = 
-00035e40: 7b7d 0a20 2020 2020 2020 2069 6620 7665  {}.        if ve
-00035e50: 7262 6f73 653a 0a20 2020 2020 2020 2020  rbose:.         
-00035e60: 2020 206d 656d 6f72 795f 7573 6167 6520     memory_usage 
-00035e70: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
-00035e80: 2020 2063 6f6d 7075 7461 7469 6f6e 732e     computations.
-00035e90: 7570 6461 7465 287b 2269 6e64 6578 223a  update({"index":
-00035ea0: 2073 656c 662e 696e 6465 782c 2022 636f   self.index, "co
-00035eb0: 756e 7422 3a20 7365 6c66 2e63 6f75 6e74  unt": self.count
-00035ec0: 2829 7d29 0a20 2020 2020 2020 2069 6620  ()}).        if 
-00035ed0: 6d65 6d6f 7279 5f75 7361 6765 3a0a 2020  memory_usage:.  
-00035ee0: 2020 2020 2020 2020 2020 636f 6d70 7574            comput
-00035ef0: 6174 696f 6e73 2e75 7064 6174 6528 0a20  ations.update(. 
-00035f00: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00035f10: 226d 656d 6f72 795f 7573 6167 6522 3a20  "memory_usage": 
-00035f20: 7365 6c66 2e6d 6170 5f70 6172 7469 7469  self.map_partiti
-00035f30: 6f6e 7328 4d2e 6d65 6d6f 7279 5f75 7361  ons(M.memory_usa
-00035f40: 6765 2c20 696e 6465 783d 5472 7565 297d  ge, index=True)}
-00035f50: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00035f60: 2020 2020 2020 2063 6f6d 7075 7461 7469         computati
-00035f70: 6f6e 7320 3d20 6469 6374 280a 2020 2020  ons = dict(.    
-00035f80: 2020 2020 2020 2020 7a69 7028 636f 6d70          zip(comp
-00035f90: 7574 6174 696f 6e73 2e6b 6579 7328 292c  utations.keys(),
-00035fa0: 2064 612e 636f 6d70 7574 6528 2a63 6f6d   da.compute(*com
-00035fb0: 7075 7461 7469 6f6e 732e 7661 6c75 6573  putations.values
-00035fc0: 2829 2929 0a20 2020 2020 2020 2029 0a0a  ())).        )..
-00035fd0: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
-00035fe0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00035ff0: 696d 706f 7274 2074 6578 7477 7261 700a  import textwrap.
-00036000: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-00036010: 6578 203d 2063 6f6d 7075 7461 7469 6f6e  ex = computation
-00036020: 735b 2269 6e64 6578 225d 0a20 2020 2020  s["index"].     
-00036030: 2020 2020 2020 2063 6f75 6e74 7320 3d20         counts = 
-00036040: 636f 6d70 7574 6174 696f 6e73 5b22 636f  computations["co
-00036050: 756e 7422 5d0a 2020 2020 2020 2020 2020  unt"].          
-00036060: 2020 6c69 6e65 732e 6170 7065 6e64 2869    lines.append(i
-00036070: 6e64 6578 5f73 756d 6d61 7279 2869 6e64  ndex_summary(ind
-00036080: 6578 2929 0a20 2020 2020 2020 2020 2020  ex)).           
-00036090: 206c 696e 6573 2e61 7070 656e 6428 6622   lines.append(f"
-000360a0: 4461 7461 2063 6f6c 756d 6e73 2028 746f  Data columns (to
-000360b0: 7461 6c20 7b6c 656e 2873 656c 662e 636f  tal {len(self.co
-000360c0: 6c75 6d6e 7329 7d20 636f 6c75 6d6e 7329  lumns)} columns)
-000360d0: 3a22 290a 0a20 2020 2020 2020 2020 2020  :")..           
-000360e0: 2066 726f 6d20 7061 6e64 6173 2e69 6f2e   from pandas.io.
-000360f0: 666f 726d 6174 732e 7072 696e 7469 6e67  formats.printing
-00036100: 2069 6d70 6f72 7420 7070 7269 6e74 5f74   import pprint_t
-00036110: 6869 6e67 0a0a 2020 2020 2020 2020 2020  hing..          
-00036120: 2020 7370 6163 6520 3d20 6d61 7828 6c65    space = max(le
-00036130: 6e28 7070 7269 6e74 5f74 6869 6e67 286b  n(pprint_thing(k
-00036140: 2929 2066 6f72 206b 2069 6e20 7365 6c66  )) for k in self
-00036150: 2e63 6f6c 756d 6e73 2920 2b20 310a 2020  .columns) + 1.  
-00036160: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-00036170: 5f77 6964 7468 203d 206d 6178 2873 7061  _width = max(spa
-00036180: 6365 2c20 3729 0a0a 2020 2020 2020 2020  ce, 7)..        
-00036190: 2020 2020 6865 6164 6572 203d 2028 0a20      header = (. 
-000361a0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-000361b0: 6578 7477 7261 702e 6465 6465 6e74 280a  extwrap.dedent(.
-000361c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000361d0: 2020 2020 2222 225c 0a20 2020 2020 2020      """\.       
-000361e0: 2020 2020 2020 2320 2020 7b7b 636f 6c75        #   {{colu
-000361f0: 6d6e 3a3c 7b63 6f6c 756d 6e5f 7769 6474  mn:<{column_widt
-00036200: 687d 7d7d 204e 6f6e 2d4e 756c 6c20 436f  h}}} Non-Null Co
-00036210: 756e 7420 2044 7479 7065 0a20 2020 2020  unt  Dtype.     
-00036220: 2020 2020 2020 202d 2d2d 2020 7b7b 756e         ---  {{un
-00036230: 6465 726c 3a3c 7b63 6f6c 756d 6e5f 7769  derl:<{column_wi
-00036240: 6474 687d 7d7d 202d 2d2d 2d2d 2d2d 2d2d  dth}}} ---------
-00036250: 2d2d 2d2d 2d20 202d 2d2d 2d2d 2222 220a  -----  -----""".
-00036260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036270: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00036280: 2020 2e66 6f72 6d61 7428 636f 6c75 6d6e    .format(column
-00036290: 5f77 6964 7468 3d63 6f6c 756d 6e5f 7769  _width=column_wi
-000362a0: 6474 6829 0a20 2020 2020 2020 2020 2020  dth).           
-000362b0: 2020 2020 202e 666f 726d 6174 2863 6f6c       .format(col
-000362c0: 756d 6e3d 2243 6f6c 756d 6e22 2c20 756e  umn="Column", un
-000362d0: 6465 726c 3d22 2d2d 2d2d 2d2d 2229 0a20  derl="------"). 
-000362e0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000362f0: 2020 2020 2020 2020 2063 6f6c 756d 6e5f           column_
-00036300: 7465 6d70 6c61 7465 203d 2074 6578 7477  template = textw
-00036310: 7261 702e 6465 6465 6e74 280a 2020 2020  rap.dedent(.    
-00036320: 2020 2020 2020 2020 2020 2020 2222 225c              """\
-00036330: 0a20 2020 2020 2020 2020 2020 207b 7b69  .            {{i
-00036340: 3a5e 337d 7d20 207b 7b6e 616d 653a 3c7b  :^3}}  {{name:<{
-00036350: 636f 6c75 6d6e 5f77 6964 7468 7d7d 7d20  column_width}}} 
-00036360: 7b7b 636f 756e 747d 7d20 6e6f 6e2d 6e75  {{count}} non-nu
-00036370: 6c6c 2020 2020 2020 7b7b 6474 7970 657d  ll      {{dtype}
-00036380: 7d22 2222 2e66 6f72 6d61 7428 0a20 2020  }""".format(.   
-00036390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000363a0: 2063 6f6c 756d 6e5f 7769 6474 683d 636f   column_width=co
-000363b0: 6c75 6d6e 5f77 6964 7468 0a20 2020 2020  lumn_width.     
-000363c0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000363d0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-000363e0: 2020 2020 2020 2063 6f6c 756d 6e5f 696e         column_in
-000363f0: 666f 203d 205b 0a20 2020 2020 2020 2020  fo = [.         
-00036400: 2020 2020 2020 2063 6f6c 756d 6e5f 7465         column_te
-00036410: 6d70 6c61 7465 2e66 6f72 6d61 7428 0a20  mplate.format(. 
-00036420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036430: 2020 2069 3d70 7072 696e 745f 7468 696e     i=pprint_thin
-00036440: 6728 6929 2c0a 2020 2020 2020 2020 2020  g(i),.          
-00036450: 2020 2020 2020 2020 2020 6e61 6d65 3d70            name=p
-00036460: 7072 696e 745f 7468 696e 6728 6e61 6d65  print_thing(name
-00036470: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00036480: 2020 2020 2020 2063 6f75 6e74 3d70 7072         count=ppr
-00036490: 696e 745f 7468 696e 6728 636f 756e 7429  int_thing(count)
-000364a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000364b0: 2020 2020 2020 6474 7970 653d 7070 7269        dtype=ppri
-000364c0: 6e74 5f74 6869 6e67 2864 7479 7065 292c  nt_thing(dtype),
-000364d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000364e0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-000364f0: 2020 2066 6f72 2069 2c20 286e 616d 652c     for i, (name,
-00036500: 2063 6f75 6e74 2c20 6474 7970 6529 2069   count, dtype) i
-00036510: 6e20 656e 756d 6572 6174 6528 0a20 2020  n enumerate(.   
+00035db0: 732e 6170 7065 6e64 2866 2245 6d70 7479  s.append(f"Empty
+00035dc0: 207b 7479 7065 2873 656c 6629 2e5f 5f6e   {type(self).__n
+00035dd0: 616d 655f 5f7d 2229 0a20 2020 2020 2020  ame__}").       
+00035de0: 2020 2020 2069 6620 5041 4e44 4153 5f47       if PANDAS_G
+00035df0: 545f 3135 303a 0a20 2020 2020 2020 2020  T_150:.         
+00035e00: 2020 2020 2020 2023 2070 616e 6461 7320         # pandas 
+00035e10: 6461 7461 6672 616d 6520 7374 6172 7465  dataframe starte
+00035e20: 6420 6164 6469 6e67 2061 206e 6577 6c69  d adding a newli
+00035e30: 6e65 2077 6865 6e20 696e 666f 2069 7320  ne when info is 
+00035e40: 6361 6c6c 6564 2e0a 2020 2020 2020 2020  called..        
+00035e50: 2020 2020 2020 2020 6c69 6e65 732e 6170          lines.ap
+00035e60: 7065 6e64 2822 2229 0a20 2020 2020 2020  pend("").       
+00035e70: 2020 2020 2070 7574 5f6c 696e 6573 2862       put_lines(b
+00035e80: 7566 2c20 6c69 6e65 7329 0a20 2020 2020  uf, lines).     
+00035e90: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
+00035ea0: 2020 2020 2020 2023 2047 726f 7570 2061         # Group a
+00035eb0: 6e64 2065 7865 6375 7465 2074 6865 2072  nd execute the r
+00035ec0: 6571 7569 7265 6420 636f 6d70 7574 6174  equired computat
+00035ed0: 696f 6e73 0a20 2020 2020 2020 2063 6f6d  ions.        com
+00035ee0: 7075 7461 7469 6f6e 7320 3d20 7b7d 0a20  putations = {}. 
+00035ef0: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
+00035f00: 653a 0a20 2020 2020 2020 2020 2020 206d  e:.            m
+00035f10: 656d 6f72 795f 7573 6167 6520 3d20 5472  emory_usage = Tr
+00035f20: 7565 0a20 2020 2020 2020 2020 2020 2063  ue.            c
+00035f30: 6f6d 7075 7461 7469 6f6e 732e 7570 6461  omputations.upda
+00035f40: 7465 287b 2269 6e64 6578 223a 2073 656c  te({"index": sel
+00035f50: 662e 696e 6465 782c 2022 636f 756e 7422  f.index, "count"
+00035f60: 3a20 7365 6c66 2e63 6f75 6e74 2829 7d29  : self.count()})
+00035f70: 0a20 2020 2020 2020 2069 6620 6d65 6d6f  .        if memo
+00035f80: 7279 5f75 7361 6765 3a0a 2020 2020 2020  ry_usage:.      
+00035f90: 2020 2020 2020 636f 6d70 7574 6174 696f        computatio
+00035fa0: 6e73 2e75 7064 6174 6528 0a20 2020 2020  ns.update(.     
+00035fb0: 2020 2020 2020 2020 2020 207b 226d 656d             {"mem
+00035fc0: 6f72 795f 7573 6167 6522 3a20 7365 6c66  ory_usage": self
+00035fd0: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
+00035fe0: 4d2e 6d65 6d6f 7279 5f75 7361 6765 2c20  M.memory_usage, 
+00035ff0: 696e 6465 783d 5472 7565 297d 0a20 2020  index=True)}.   
+00036000: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00036010: 2020 2063 6f6d 7075 7461 7469 6f6e 7320     computations 
+00036020: 3d20 6469 6374 280a 2020 2020 2020 2020  = dict(.        
+00036030: 2020 2020 7a69 7028 636f 6d70 7574 6174      zip(computat
+00036040: 696f 6e73 2e6b 6579 7328 292c 2064 612e  ions.keys(), da.
+00036050: 636f 6d70 7574 6528 2a63 6f6d 7075 7461  compute(*computa
+00036060: 7469 6f6e 732e 7661 6c75 6573 2829 2929  tions.values()))
+00036070: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00036080: 2020 2020 6966 2076 6572 626f 7365 3a0a      if verbose:.
+00036090: 2020 2020 2020 2020 2020 2020 696d 706f              impo
+000360a0: 7274 2074 6578 7477 7261 700a 0a20 2020  rt textwrap..   
+000360b0: 2020 2020 2020 2020 2069 6e64 6578 203d           index =
+000360c0: 2063 6f6d 7075 7461 7469 6f6e 735b 2269   computations["i
+000360d0: 6e64 6578 225d 0a20 2020 2020 2020 2020  ndex"].         
+000360e0: 2020 2063 6f75 6e74 7320 3d20 636f 6d70     counts = comp
+000360f0: 7574 6174 696f 6e73 5b22 636f 756e 7422  utations["count"
+00036100: 5d0a 2020 2020 2020 2020 2020 2020 6c69  ].            li
+00036110: 6e65 732e 6170 7065 6e64 2869 6e64 6578  nes.append(index
+00036120: 5f73 756d 6d61 7279 2869 6e64 6578 2929  _summary(index))
+00036130: 0a20 2020 2020 2020 2020 2020 206c 696e  .            lin
+00036140: 6573 2e61 7070 656e 6428 6622 4461 7461  es.append(f"Data
+00036150: 2063 6f6c 756d 6e73 2028 746f 7461 6c20   columns (total 
+00036160: 7b6c 656e 2873 656c 662e 636f 6c75 6d6e  {len(self.column
+00036170: 7329 7d20 636f 6c75 6d6e 7329 3a22 290a  s)} columns):").
+00036180: 0a20 2020 2020 2020 2020 2020 2066 726f  .            fro
+00036190: 6d20 7061 6e64 6173 2e69 6f2e 666f 726d  m pandas.io.form
+000361a0: 6174 732e 7072 696e 7469 6e67 2069 6d70  ats.printing imp
+000361b0: 6f72 7420 7070 7269 6e74 5f74 6869 6e67  ort pprint_thing
+000361c0: 0a0a 2020 2020 2020 2020 2020 2020 7370  ..            sp
+000361d0: 6163 6520 3d20 6d61 7828 6c65 6e28 7070  ace = max(len(pp
+000361e0: 7269 6e74 5f74 6869 6e67 286b 2929 2066  rint_thing(k)) f
+000361f0: 6f72 206b 2069 6e20 7365 6c66 2e63 6f6c  or k in self.col
+00036200: 756d 6e73 2920 2b20 310a 2020 2020 2020  umns) + 1.      
+00036210: 2020 2020 2020 636f 6c75 6d6e 5f77 6964        column_wid
+00036220: 7468 203d 206d 6178 2873 7061 6365 2c20  th = max(space, 
+00036230: 3729 0a0a 2020 2020 2020 2020 2020 2020  7)..            
+00036240: 6865 6164 6572 203d 2028 0a20 2020 2020  header = (.     
+00036250: 2020 2020 2020 2020 2020 2074 6578 7477             textw
+00036260: 7261 702e 6465 6465 6e74 280a 2020 2020  rap.dedent(.    
+00036270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036280: 2222 225c 0a20 2020 2020 2020 2020 2020  """\.           
+00036290: 2020 2320 2020 7b7b 636f 6c75 6d6e 3a3c    #   {{column:<
+000362a0: 7b63 6f6c 756d 6e5f 7769 6474 687d 7d7d  {column_width}}}
+000362b0: 204e 6f6e 2d4e 756c 6c20 436f 756e 7420   Non-Null Count 
+000362c0: 2044 7479 7065 0a20 2020 2020 2020 2020   Dtype.         
+000362d0: 2020 202d 2d2d 2020 7b7b 756e 6465 726c     ---  {{underl
+000362e0: 3a3c 7b63 6f6c 756d 6e5f 7769 6474 687d  :<{column_width}
+000362f0: 7d7d 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  }} -------------
+00036300: 2d20 202d 2d2d 2d2d 2222 220a 2020 2020  -  -----""".    
+00036310: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00036320: 2020 2020 2020 2020 2020 2020 2020 2e66                .f
+00036330: 6f72 6d61 7428 636f 6c75 6d6e 5f77 6964  ormat(column_wid
+00036340: 7468 3d63 6f6c 756d 6e5f 7769 6474 6829  th=column_width)
+00036350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036360: 202e 666f 726d 6174 2863 6f6c 756d 6e3d   .format(column=
+00036370: 2243 6f6c 756d 6e22 2c20 756e 6465 726c  "Column", underl
+00036380: 3d22 2d2d 2d2d 2d2d 2229 0a20 2020 2020  ="------").     
+00036390: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000363a0: 2020 2020 2063 6f6c 756d 6e5f 7465 6d70       column_temp
+000363b0: 6c61 7465 203d 2074 6578 7477 7261 702e  late = textwrap.
+000363c0: 6465 6465 6e74 280a 2020 2020 2020 2020  dedent(.        
+000363d0: 2020 2020 2020 2020 2222 225c 0a20 2020          """\.   
+000363e0: 2020 2020 2020 2020 207b 7b69 3a5e 337d           {{i:^3}
+000363f0: 7d20 207b 7b6e 616d 653a 3c7b 636f 6c75  }  {{name:<{colu
+00036400: 6d6e 5f77 6964 7468 7d7d 7d20 7b7b 636f  mn_width}}} {{co
+00036410: 756e 747d 7d20 6e6f 6e2d 6e75 6c6c 2020  unt}} non-null  
+00036420: 2020 2020 7b7b 6474 7970 657d 7d22 2222      {{dtype}}"""
+00036430: 2e66 6f72 6d61 7428 0a20 2020 2020 2020  .format(.       
+00036440: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+00036450: 756d 6e5f 7769 6474 683d 636f 6c75 6d6e  umn_width=column
+00036460: 5f77 6964 7468 0a20 2020 2020 2020 2020  _width.         
+00036470: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00036480: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00036490: 2020 2063 6f6c 756d 6e5f 696e 666f 203d     column_info =
+000364a0: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+000364b0: 2020 2063 6f6c 756d 6e5f 7465 6d70 6c61     column_templa
+000364c0: 7465 2e66 6f72 6d61 7428 0a20 2020 2020  te.format(.     
+000364d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000364e0: 3d70 7072 696e 745f 7468 696e 6728 6929  =pprint_thing(i)
+000364f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00036500: 2020 2020 2020 6e61 6d65 3d70 7072 696e        name=pprin
+00036510: 745f 7468 696e 6728 6e61 6d65 292c 0a20  t_thing(name),. 
 00036520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036530: 207a 6970 2873 656c 662e 636f 6c75 6d6e   zip(self.column
-00036540: 732c 2063 6f75 6e74 732c 2073 656c 662e  s, counts, self.
-00036550: 6474 7970 6573 290a 2020 2020 2020 2020  dtypes).        
-00036560: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00036570: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-00036580: 2020 2020 6c69 6e65 732e 6578 7465 6e64      lines.extend
-00036590: 2868 6561 6465 722e 7370 6c69 7428 225c  (header.split("\
-000365a0: 6e22 2929 0a20 2020 2020 2020 2065 6c73  n")).        els
-000365b0: 653a 0a20 2020 2020 2020 2020 2020 2063  e:.            c
-000365c0: 6f6c 756d 6e5f 696e 666f 203d 205b 696e  olumn_info = [in
-000365d0: 6465 785f 7375 6d6d 6172 7928 7365 6c66  dex_summary(self
-000365e0: 2e63 6f6c 756d 6e73 2c20 6e61 6d65 3d22  .columns, name="
-000365f0: 436f 6c75 6d6e 7322 295d 0a0a 2020 2020  Columns")]..    
-00036600: 2020 2020 6c69 6e65 732e 6578 7465 6e64      lines.extend
-00036610: 2863 6f6c 756d 6e5f 696e 666f 290a 2020  (column_info).  
-00036620: 2020 2020 2020 6474 7970 655f 636f 756e        dtype_coun
-00036630: 7473 203d 205b 0a20 2020 2020 2020 2020  ts = [.         
-00036640: 2020 2022 2573 2825 6429 2220 2520 6b20     "%s(%d)" % k 
-00036650: 666f 7220 6b20 696e 2073 6f72 7465 6428  for k in sorted(
-00036660: 7365 6c66 2e64 7479 7065 732e 7661 6c75  self.dtypes.valu
-00036670: 655f 636f 756e 7473 2829 2e69 7465 6d73  e_counts().items
-00036680: 2829 2c20 6b65 793d 7374 7229 0a20 2020  (), key=str).   
-00036690: 2020 2020 205d 0a20 2020 2020 2020 206c       ].        l
-000366a0: 696e 6573 2e61 7070 656e 6428 2264 7479  ines.append("dty
-000366b0: 7065 733a 207b 7d22 2e66 6f72 6d61 7428  pes: {}".format(
-000366c0: 222c 2022 2e6a 6f69 6e28 6474 7970 655f  ", ".join(dtype_
-000366d0: 636f 756e 7473 2929 290a 0a20 2020 2020  counts)))..     
-000366e0: 2020 2069 6620 6d65 6d6f 7279 5f75 7361     if memory_usa
-000366f0: 6765 3a0a 2020 2020 2020 2020 2020 2020  ge:.            
-00036700: 6d65 6d6f 7279 5f69 6e74 203d 2063 6f6d  memory_int = com
-00036710: 7075 7461 7469 6f6e 735b 226d 656d 6f72  putations["memor
-00036720: 795f 7573 6167 6522 5d2e 7375 6d28 290a  y_usage"].sum().
-00036730: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
-00036740: 732e 6170 7065 6e64 2866 226d 656d 6f72  s.append(f"memor
-00036750: 7920 7573 6167 653a 207b 6d65 6d6f 7279  y usage: {memory
-00036760: 5f72 6570 7228 6d65 6d6f 7279 5f69 6e74  _repr(memory_int
-00036770: 297d 5c6e 2229 0a0a 2020 2020 2020 2020  )}\n")..        
-00036780: 7075 745f 6c69 6e65 7328 6275 662c 206c  put_lines(buf, l
-00036790: 696e 6573 290a 0a20 2020 2040 6465 7269  ines)..    @deri
-000367a0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-000367b0: 4672 616d 6529 0a20 2020 2064 6566 206d  Frame).    def m
-000367c0: 656d 6f72 795f 7573 6167 6528 7365 6c66  emory_usage(self
-000367d0: 2c20 696e 6465 783d 5472 7565 2c20 6465  , index=True, de
-000367e0: 6570 3d46 616c 7365 293a 0a20 2020 2020  ep=False):.     
-000367f0: 2020 2072 6573 756c 7420 3d20 7365 6c66     result = self
-00036800: 2e6d 6170 5f70 6172 7469 7469 6f6e 7328  .map_partitions(
-00036810: 4d2e 6d65 6d6f 7279 5f75 7361 6765 2c20  M.memory_usage, 
-00036820: 696e 6465 783d 696e 6465 782c 2064 6565  index=index, dee
-00036830: 703d 6465 6570 290a 2020 2020 2020 2020  p=deep).        
-00036840: 7265 7375 6c74 203d 2072 6573 756c 742e  result = result.
-00036850: 6772 6f75 7062 7928 7265 7375 6c74 2e69  groupby(result.i
-00036860: 6e64 6578 292e 7375 6d28 290a 2020 2020  ndex).sum().    
-00036870: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
-00036880: 740a 0a20 2020 2064 6566 2070 6976 6f74  t..    def pivot
-00036890: 5f74 6162 6c65 2873 656c 662c 2069 6e64  _table(self, ind
-000368a0: 6578 3d4e 6f6e 652c 2063 6f6c 756d 6e73  ex=None, columns
-000368b0: 3d4e 6f6e 652c 2076 616c 7565 733d 4e6f  =None, values=No
-000368c0: 6e65 2c20 6167 6766 756e 633d 226d 6561  ne, aggfunc="mea
-000368d0: 6e22 293a 0a20 2020 2020 2020 2022 2222  n"):.        """
-000368e0: 0a20 2020 2020 2020 2043 7265 6174 6520  .        Create 
-000368f0: 6120 7370 7265 6164 7368 6565 742d 7374  a spreadsheet-st
-00036900: 796c 6520 7069 766f 7420 7461 626c 6520  yle pivot table 
-00036910: 6173 2061 2044 6174 6146 7261 6d65 2e20  as a DataFrame. 
-00036920: 5461 7267 6574 2060 6063 6f6c 756d 6e73  Target ``columns
-00036930: 6060 0a20 2020 2020 2020 206d 7573 7420  ``.        must 
-00036940: 6861 7665 2063 6174 6567 6f72 7920 6474  have category dt
-00036950: 7970 6520 746f 2069 6e66 6572 2072 6573  ype to infer res
-00036960: 756c 7427 7320 6060 636f 6c75 6d6e 7360  ult's ``columns`
-00036970: 602e 0a20 2020 2020 2020 2060 6069 6e64  `..        ``ind
-00036980: 6578 6060 2c20 6060 636f 6c75 6d6e 7360  ex``, ``columns`
-00036990: 602c 2060 6076 616c 7565 7360 6020 616e  `, ``values`` an
-000369a0: 6420 6060 6167 6766 756e 6360 6020 6d75  d ``aggfunc`` mu
-000369b0: 7374 2062 6520 616c 6c20 7363 616c 6172  st be all scalar
-000369c0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-000369d0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-000369e0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-000369f0: 2076 616c 7565 7320 3a20 7363 616c 6172   values : scalar
-00036a00: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-00036a10: 756d 6e20 746f 2061 6767 7265 6761 7465  umn to aggregate
-00036a20: 0a20 2020 2020 2020 2069 6e64 6578 203a  .        index :
-00036a30: 2073 6361 6c61 720a 2020 2020 2020 2020   scalar.        
-00036a40: 2020 2020 636f 6c75 6d6e 2074 6f20 6265      column to be
-00036a50: 2069 6e64 6578 0a20 2020 2020 2020 2063   index.        c
-00036a60: 6f6c 756d 6e73 203a 2073 6361 6c61 720a  olumns : scalar.
-00036a70: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
-00036a80: 6d6e 2074 6f20 6265 2063 6f6c 756d 6e73  mn to be columns
-00036a90: 0a20 2020 2020 2020 2061 6767 6675 6e63  .        aggfunc
-00036aa0: 203a 207b 276d 6561 6e27 2c20 2773 756d   : {'mean', 'sum
-00036ab0: 272c 2027 636f 756e 7427 7d2c 2064 6566  ', 'count'}, def
-00036ac0: 6175 6c74 2027 6d65 616e 270a 0a20 2020  ault 'mean'..   
-00036ad0: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-00036ae0: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-00036af0: 2020 2020 2074 6162 6c65 203a 2044 6174       table : Dat
-00036b00: 6146 7261 6d65 0a20 2020 2020 2020 2022  aFrame.        "
-00036b10: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
-00036b20: 6461 736b 2e64 6174 6166 7261 6d65 2e72  dask.dataframe.r
-00036b30: 6573 6861 7065 2069 6d70 6f72 7420 7069  eshape import pi
-00036b40: 766f 745f 7461 626c 650a 0a20 2020 2020  vot_table..     
-00036b50: 2020 2072 6574 7572 6e20 7069 766f 745f     return pivot_
-00036b60: 7461 626c 6528 0a20 2020 2020 2020 2020  table(.         
-00036b70: 2020 2073 656c 662c 2069 6e64 6578 3d69     self, index=i
-00036b80: 6e64 6578 2c20 636f 6c75 6d6e 733d 636f  ndex, columns=co
-00036b90: 6c75 6d6e 732c 2076 616c 7565 733d 7661  lumns, values=va
-00036ba0: 6c75 6573 2c20 6167 6766 756e 633d 6167  lues, aggfunc=ag
-00036bb0: 6766 756e 630a 2020 2020 2020 2020 290a  gfunc.        ).
-00036bc0: 0a20 2020 2064 6566 206d 656c 7428 0a20  .    def melt(. 
-00036bd0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00036be0: 2020 2020 2069 645f 7661 7273 3d4e 6f6e       id_vars=Non
-00036bf0: 652c 0a20 2020 2020 2020 2076 616c 7565  e,.        value
-00036c00: 5f76 6172 733d 4e6f 6e65 2c0a 2020 2020  _vars=None,.    
-00036c10: 2020 2020 7661 725f 6e61 6d65 3d4e 6f6e      var_name=Non
-00036c20: 652c 0a20 2020 2020 2020 2076 616c 7565  e,.        value
-00036c30: 5f6e 616d 653d 2276 616c 7565 222c 0a20  _name="value",. 
-00036c40: 2020 2020 2020 2063 6f6c 5f6c 6576 656c         col_level
-00036c50: 3d4e 6f6e 652c 0a20 2020 2029 3a0a 2020  =None,.    ):.  
-00036c60: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00036c70: 2020 556e 7069 766f 7473 2061 2044 6174    Unpivots a Dat
-00036c80: 6146 7261 6d65 2066 726f 6d20 7769 6465  aFrame from wide
-00036c90: 2066 6f72 6d61 7420 746f 206c 6f6e 6720   format to long 
-00036ca0: 666f 726d 6174 2c0a 2020 2020 2020 2020  format,.        
-00036cb0: 6f70 7469 6f6e 616c 6c79 206c 6561 7669  optionally leavi
-00036cc0: 6e67 2069 6465 6e74 6966 6965 7220 7661  ng identifier va
-00036cd0: 7269 6162 6c65 7320 7365 742e 0a0a 2020  riables set...  
-00036ce0: 2020 2020 2020 5468 6973 2066 756e 6374        This funct
-00036cf0: 696f 6e20 6973 2075 7365 6675 6c20 746f  ion is useful to
-00036d00: 206d 6173 7361 6765 2061 2044 6174 6146   massage a DataF
-00036d10: 7261 6d65 2069 6e74 6f20 6120 666f 726d  rame into a form
-00036d20: 6174 2077 6865 7265 0a20 2020 2020 2020  at where.       
-00036d30: 206f 6e65 206f 7220 6d6f 7265 2063 6f6c   one or more col
-00036d40: 756d 6e73 2061 7265 2069 6465 6e74 6966  umns are identif
-00036d50: 6965 7220 7661 7269 6162 6c65 7320 2860  ier variables (`
-00036d60: 6069 645f 7661 7273 6060 292c 2077 6869  `id_vars``), whi
-00036d70: 6c65 0a20 2020 2020 2020 2061 6c6c 206f  le.        all o
-00036d80: 7468 6572 2063 6f6c 756d 6e73 2c20 636f  ther columns, co
-00036d90: 6e73 6964 6572 6564 206d 6561 7375 7265  nsidered measure
-00036da0: 6420 7661 7269 6162 6c65 7320 2860 6076  d variables (``v
-00036db0: 616c 7565 5f76 6172 7360 6029 2c0a 2020  alue_vars``),.  
-00036dc0: 2020 2020 2020 6172 6520 2275 6e70 6976        are "unpiv
-00036dd0: 6f74 6564 2220 746f 2074 6865 2072 6f77  oted" to the row
-00036de0: 2061 7869 732c 206c 6561 7669 6e67 206a   axis, leaving j
-00036df0: 7573 7420 7477 6f20 6e6f 6e2d 6964 656e  ust two non-iden
-00036e00: 7469 6669 6572 0a20 2020 2020 2020 2063  tifier.        c
-00036e10: 6f6c 756d 6e73 2c20 2776 6172 6961 626c  olumns, 'variabl
-00036e20: 6527 2061 6e64 2027 7661 6c75 6527 2e0a  e' and 'value'..
-00036e30: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00036e40: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00036e50: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2066  ------.        f
-00036e60: 7261 6d65 203a 2044 6174 6146 7261 6d65  rame : DataFrame
-00036e70: 0a20 2020 2020 2020 2069 645f 7661 7273  .        id_vars
-00036e80: 203a 2074 7570 6c65 2c20 6c69 7374 2c20   : tuple, list, 
-00036e90: 6f72 206e 6461 7272 6179 2c20 6f70 7469  or ndarray, opti
-00036ea0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00036eb0: 2043 6f6c 756d 6e28 7329 2074 6f20 7573   Column(s) to us
-00036ec0: 6520 6173 2069 6465 6e74 6966 6965 7220  e as identifier 
-00036ed0: 7661 7269 6162 6c65 732e 0a20 2020 2020  variables..     
-00036ee0: 2020 2076 616c 7565 5f76 6172 7320 3a20     value_vars : 
-00036ef0: 7475 706c 652c 206c 6973 742c 206f 7220  tuple, list, or 
-00036f00: 6e64 6172 7261 792c 206f 7074 696f 6e61  ndarray, optiona
-00036f10: 6c0a 2020 2020 2020 2020 2020 2020 436f  l.            Co
-00036f20: 6c75 6d6e 2873 2920 746f 2075 6e70 6976  lumn(s) to unpiv
-00036f30: 6f74 2e20 4966 206e 6f74 2073 7065 6369  ot. If not speci
-00036f40: 6669 6564 2c20 7573 6573 2061 6c6c 2063  fied, uses all c
-00036f50: 6f6c 756d 6e73 2074 6861 740a 2020 2020  olumns that.    
-00036f60: 2020 2020 2020 2020 6172 6520 6e6f 7420          are not 
-00036f70: 7365 7420 6173 2060 6964 5f76 6172 7360  set as `id_vars`
-00036f80: 2e0a 2020 2020 2020 2020 7661 725f 6e61  ..        var_na
-00036f90: 6d65 203a 2073 6361 6c61 720a 2020 2020  me : scalar.    
-00036fa0: 2020 2020 2020 2020 4e61 6d65 2074 6f20          Name to 
-00036fb0: 7573 6520 666f 7220 7468 6520 2776 6172  use for the 'var
-00036fc0: 6961 626c 6527 2063 6f6c 756d 6e2e 2049  iable' column. I
-00036fd0: 6620 4e6f 6e65 2069 7420 7573 6573 0a20  f None it uses. 
-00036fe0: 2020 2020 2020 2020 2020 2060 6066 7261             ``fra
-00036ff0: 6d65 2e63 6f6c 756d 6e73 2e6e 616d 6560  me.columns.name`
-00037000: 6020 6f72 2027 7661 7269 6162 6c65 272e  ` or 'variable'.
-00037010: 0a20 2020 2020 2020 2076 616c 7565 5f6e  .        value_n
-00037020: 616d 6520 3a20 7363 616c 6172 2c20 6465  ame : scalar, de
-00037030: 6661 756c 7420 2776 616c 7565 270a 2020  fault 'value'.  
-00037040: 2020 2020 2020 2020 2020 4e61 6d65 2074            Name t
-00037050: 6f20 7573 6520 666f 7220 7468 6520 2776  o use for the 'v
-00037060: 616c 7565 2720 636f 6c75 6d6e 2e0a 2020  alue' column..  
-00037070: 2020 2020 2020 636f 6c5f 6c65 7665 6c20        col_level 
-00037080: 3a20 696e 7420 6f72 2073 7472 696e 672c  : int or string,
-00037090: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-000370a0: 2020 2020 2020 4966 2063 6f6c 756d 6e73        If columns
-000370b0: 2061 7265 2061 204d 756c 7469 496e 6465   are a MultiInde
-000370c0: 7820 7468 656e 2075 7365 2074 6869 7320  x then use this 
-000370d0: 6c65 7665 6c20 746f 206d 656c 742e 0a0a  level to melt...
-000370e0: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
-000370f0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-00037100: 2020 2020 2020 2020 4461 7461 4672 616d          DataFram
-00037110: 650a 2020 2020 2020 2020 2020 2020 556e  e.            Un
-00037120: 7069 766f 7465 6420 4461 7461 4672 616d  pivoted DataFram
-00037130: 652e 0a0a 2020 2020 2020 2020 5365 6520  e...        See 
-00037140: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
-00037150: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7061  -----.        pa
-00037160: 6e64 6173 2e44 6174 6146 7261 6d65 2e6d  ndas.DataFrame.m
-00037170: 656c 740a 2020 2020 2020 2020 2222 220a  elt.        """.
-00037180: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-00037190: 6b2e 6461 7461 6672 616d 652e 7265 7368  k.dataframe.resh
-000371a0: 6170 6520 696d 706f 7274 206d 656c 740a  ape import melt.
-000371b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000371c0: 6d65 6c74 280a 2020 2020 2020 2020 2020  melt(.          
-000371d0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-000371e0: 2020 2020 6964 5f76 6172 733d 6964 5f76      id_vars=id_v
-000371f0: 6172 732c 0a20 2020 2020 2020 2020 2020  ars,.           
-00037200: 2076 616c 7565 5f76 6172 733d 7661 6c75   value_vars=valu
-00037210: 655f 7661 7273 2c0a 2020 2020 2020 2020  e_vars,.        
-00037220: 2020 2020 7661 725f 6e61 6d65 3d76 6172      var_name=var
-00037230: 5f6e 616d 652c 0a20 2020 2020 2020 2020  _name,.         
-00037240: 2020 2076 616c 7565 5f6e 616d 653d 7661     value_name=va
-00037250: 6c75 655f 6e61 6d65 2c0a 2020 2020 2020  lue_name,.      
-00037260: 2020 2020 2020 636f 6c5f 6c65 7665 6c3d        col_level=
-00037270: 636f 6c5f 6c65 7665 6c2c 0a20 2020 2020  col_level,.     
-00037280: 2020 2029 0a0a 2020 2020 6465 6620 746f     )..    def to
-00037290: 5f72 6563 6f72 6473 2873 656c 662c 2069  _records(self, i
-000372a0: 6e64 6578 3d46 616c 7365 2c20 6c65 6e67  ndex=False, leng
-000372b0: 7468 733d 4e6f 6e65 293a 0a20 2020 2020  ths=None):.     
-000372c0: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
-000372d0: 6166 7261 6d65 2e69 6f20 696d 706f 7274  aframe.io import
-000372e0: 2074 6f5f 7265 636f 7264 730a 0a20 2020   to_records..   
-000372f0: 2020 2020 2069 6620 6c65 6e67 7468 7320       if lengths 
-00037300: 6973 2054 7275 653a 0a20 2020 2020 2020  is True:.       
-00037310: 2020 2020 206c 656e 6774 6873 203d 2074       lengths = t
-00037320: 7570 6c65 2873 656c 662e 6d61 705f 7061  uple(self.map_pa
-00037330: 7274 6974 696f 6e73 286c 656e 292e 636f  rtitions(len).co
-00037340: 6d70 7574 6528 2929 0a0a 2020 2020 2020  mpute())..      
-00037350: 2020 7265 636f 7264 7320 3d20 746f 5f72    records = to_r
-00037360: 6563 6f72 6473 2873 656c 6629 0a0a 2020  ecords(self)..  
-00037370: 2020 2020 2020 6368 756e 6b73 203d 2073        chunks = s
-00037380: 656c 662e 5f76 616c 6964 6174 655f 6368  elf._validate_ch
-00037390: 756e 6b73 2872 6563 6f72 6473 2c20 6c65  unks(records, le
-000373a0: 6e67 7468 7329 0a20 2020 2020 2020 2072  ngths).        r
-000373b0: 6563 6f72 6473 2e5f 6368 756e 6b73 203d  ecords._chunks =
-000373c0: 2028 6368 756e 6b73 5b30 5d2c 290a 0a20   (chunks[0],).. 
-000373d0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-000373e0: 636f 7264 730a 0a20 2020 2040 6465 7269  cords..    @deri
-000373f0: 7665 645f 6672 6f6d 2870 642e 4461 7461  ved_from(pd.Data
-00037400: 4672 616d 6529 0a20 2020 2064 6566 2074  Frame).    def t
-00037410: 6f5f 6874 6d6c 2873 656c 662c 206d 6178  o_html(self, max
-00037420: 5f72 6f77 733d 3529 3a0a 2020 2020 2020  _rows=5):.      
-00037430: 2020 2320 7064 2e53 6572 6965 7320 646f    # pd.Series do
-00037440: 6573 6e27 7420 6861 7665 2068 746d 6c20  esn't have html 
-00037450: 7265 7072 0a20 2020 2020 2020 2064 6174  repr.        dat
-00037460: 6120 3d20 7365 6c66 2e5f 7265 7072 5f64  a = self._repr_d
-00037470: 6174 6128 292e 746f 5f68 746d 6c28 6d61  ata().to_html(ma
-00037480: 785f 726f 7773 3d6d 6178 5f72 6f77 732c  x_rows=max_rows,
-00037490: 2073 686f 775f 6469 6d65 6e73 696f 6e73   show_dimensions
-000374a0: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
-000374b0: 7265 7475 726e 2067 6574 5f74 656d 706c  return get_templ
-000374c0: 6174 6528 2264 6174 6166 7261 6d65 2e68  ate("dataframe.h
-000374d0: 746d 6c2e 6a32 2229 2e72 656e 6465 7228  tml.j2").render(
-000374e0: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-000374f0: 613d 6461 7461 2c0a 2020 2020 2020 2020  a=data,.        
-00037500: 2020 2020 6e61 6d65 3d73 656c 662e 5f6e      name=self._n
-00037510: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00037520: 206c 6179 6572 733d 6d61 7962 655f 706c   layers=maybe_pl
-00037530: 7572 616c 697a 6528 6c65 6e28 7365 6c66  uralize(len(self
-00037540: 2e64 6173 6b2e 6c61 7965 7273 292c 2022  .dask.layers), "
-00037550: 6772 6170 6820 6c61 7965 7222 292c 0a20  graph layer"),. 
-00037560: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00037570: 6620 5f72 6570 725f 6461 7461 2873 656c  f _repr_data(sel
-00037580: 6629 3a0a 2020 2020 2020 2020 6d65 7461  f):.        meta
-00037590: 203d 2073 656c 662e 5f6d 6574 610a 2020   = self._meta.  
-000375a0: 2020 2020 2020 696e 6465 7820 3d20 7365        index = se
-000375b0: 6c66 2e5f 7265 7072 5f64 6976 6973 696f  lf._repr_divisio
-000375c0: 6e73 0a20 2020 2020 2020 2063 6f6c 7320  ns.        cols 
-000375d0: 3d20 6d65 7461 2e63 6f6c 756d 6e73 0a20  = meta.columns. 
-000375e0: 2020 2020 2020 2069 6620 6c65 6e28 636f         if len(co
-000375f0: 6c73 2920 3d3d 2030 3a0a 2020 2020 2020  ls) == 0:.      
-00037600: 2020 2020 2020 7365 7269 6573 5f64 6620        series_df 
-00037610: 3d20 7064 2e44 6174 6146 7261 6d65 285b  = pd.DataFrame([
-00037620: 5b5d 5d20 2a20 6c65 6e28 696e 6465 7829  []] * len(index)
-00037630: 2c20 636f 6c75 6d6e 733d 636f 6c73 2c20  , columns=cols, 
-00037640: 696e 6465 783d 696e 6465 7829 0a20 2020  index=index).   
-00037650: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00037660: 2020 2020 2020 2073 6572 6965 735f 6466         series_df
-00037670: 203d 2070 642e 636f 6e63 6174 280a 2020   = pd.concat(.  
-00037680: 2020 2020 2020 2020 2020 2020 2020 5b5f                [_
-00037690: 7265 7072 5f64 6174 615f 7365 7269 6573  repr_data_series
-000376a0: 2873 2c20 696e 6465 783d 696e 6465 7829  (s, index=index)
-000376b0: 2066 6f72 205f 2c20 7320 696e 206d 6574   for _, s in met
-000376c0: 612e 6974 656d 7328 295d 2c20 6178 6973  a.items()], axis
-000376d0: 3d31 0a20 2020 2020 2020 2020 2020 2029  =1.            )
-000376e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000376f0: 7365 7269 6573 5f64 660a 0a20 2020 2064  series_df..    d
-00037700: 6566 205f 7265 7072 5f68 746d 6c5f 2873  ef _repr_html_(s
-00037710: 656c 6629 3a0a 2020 2020 2020 2020 6461  elf):.        da
-00037720: 7461 203d 2073 656c 662e 5f72 6570 725f  ta = self._repr_
-00037730: 6461 7461 2829 2e74 6f5f 6874 6d6c 280a  data().to_html(.
-00037740: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
-00037750: 726f 7773 3d35 2c20 7368 6f77 5f64 696d  rows=5, show_dim
-00037760: 656e 7369 6f6e 733d 4661 6c73 652c 206e  ensions=False, n
-00037770: 6f74 6562 6f6f 6b3d 5472 7565 0a20 2020  otebook=True.   
-00037780: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-00037790: 6574 7572 6e20 6765 745f 7465 6d70 6c61  eturn get_templa
-000377a0: 7465 2822 6461 7461 6672 616d 652e 6874  te("dataframe.ht
-000377b0: 6d6c 2e6a 3222 292e 7265 6e64 6572 280a  ml.j2").render(.
-000377c0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-000377d0: 3d64 6174 612c 0a20 2020 2020 2020 2020  =data,.         
-000377e0: 2020 206e 616d 653d 7365 6c66 2e5f 6e61     name=self._na
-000377f0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-00037800: 6c61 7965 7273 3d6d 6179 6265 5f70 6c75  layers=maybe_plu
-00037810: 7261 6c69 7a65 286c 656e 2873 656c 662e  ralize(len(self.
-00037820: 6461 736b 2e6c 6179 6572 7329 2c20 2267  dask.layers), "g
-00037830: 7261 7068 206c 6179 6572 2229 2c0a 2020  raph layer"),.  
-00037840: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00037850: 205f 7365 6c65 6374 5f63 6f6c 756d 6e73   _select_columns
-00037860: 5f6f 725f 696e 6465 7828 7365 6c66 2c20  _or_index(self, 
-00037870: 636f 6c75 6d6e 735f 6f72 5f69 6e64 6578  columns_or_index
-00037880: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-00037890: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-000378a0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-000378b0: 2d2d 2d2d 0a20 2020 2020 2020 2063 6f6c  ----.        col
-000378c0: 756d 6e73 5f6f 725f 696e 6465 780a 2020  umns_or_index.  
-000378d0: 2020 2020 2020 2020 2020 436f 6c75 6d6e            Column
-000378e0: 206f 7220 696e 6465 7820 6e61 6d65 2c20   or index name, 
-000378f0: 6f72 2061 206c 6973 7420 6f66 2074 6865  or a list of the
-00037900: 7365 0a0a 2020 2020 2020 2020 5265 7475  se..        Retu
-00037910: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-00037920: 2d2d 2d0a 2020 2020 2020 2020 6464 2e44  ---.        dd.D
-00037930: 6174 6146 7261 6d65 0a20 2020 2020 2020  ataFrame.       
-00037940: 2020 2020 2044 6173 6b20 4461 7461 4672       Dask DataFr
-00037950: 616d 6520 7769 7468 2063 6f6c 756d 6e73  ame with columns
-00037960: 2063 6f72 7265 7370 6f6e 6469 6e67 2074   corresponding t
-00037970: 6f20 6561 6368 2063 6f6c 756d 6e20 6f72  o each column or
-00037980: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-00037990: 6578 206c 6576 656c 2069 6e20 636f 6c75  ex level in colu
-000379a0: 6d6e 735f 6f72 5f69 6e64 6578 2e20 2049  mns_or_index.  I
-000379b0: 6620 696e 636c 7564 6564 2c20 7468 6520  f included, the 
-000379c0: 636f 6c75 6d6e 0a20 2020 2020 2020 2020  column.         
-000379d0: 2020 2063 6f72 7265 7370 6f6e 6469 6e67     corresponding
-000379e0: 2074 6f20 7468 6520 696e 6465 7820 6c65   to the index le
-000379f0: 7665 6c20 6973 206e 616d 6564 205f 696e  vel is named _in
-00037a00: 6465 780a 2020 2020 2020 2020 2222 220a  dex.        """.
-00037a10: 0a20 2020 2020 2020 2023 2045 6e73 7572  .        # Ensur
-00037a20: 6520 636f 6c75 6d6e 735f 6f72 5f69 6e64  e columns_or_ind
-00037a30: 6578 2069 7320 6120 6c69 7374 0a20 2020  ex is a list.   
-00037a40: 2020 2020 2063 6f6c 756d 6e73 5f6f 725f       columns_or_
-00037a50: 696e 6465 7820 3d20 280a 2020 2020 2020  index = (.      
-00037a60: 2020 2020 2020 636f 6c75 6d6e 735f 6f72        columns_or
-00037a70: 5f69 6e64 6578 0a20 2020 2020 2020 2020  _index.         
-00037a80: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00037a90: 2863 6f6c 756d 6e73 5f6f 725f 696e 6465  (columns_or_inde
-00037aa0: 782c 206c 6973 7429 0a20 2020 2020 2020  x, list).       
-00037ab0: 2020 2020 2065 6c73 6520 5b63 6f6c 756d       else [colum
-00037ac0: 6e73 5f6f 725f 696e 6465 785d 0a20 2020  ns_or_index].   
-00037ad0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00037ae0: 636f 6c75 6d6e 5f6e 616d 6573 203d 205b  column_names = [
-00037af0: 0a20 2020 2020 2020 2020 2020 206e 2066  .            n f
-00037b00: 6f72 206e 2069 6e20 636f 6c75 6d6e 735f  or n in columns_
-00037b10: 6f72 5f69 6e64 6578 2069 6620 7365 6c66  or_index if self
-00037b20: 2e5f 6973 5f63 6f6c 756d 6e5f 6c61 6265  ._is_column_labe
-00037b30: 6c5f 7265 6665 7265 6e63 6528 6e29 0a20  l_reference(n). 
-00037b40: 2020 2020 2020 205d 0a0a 2020 2020 2020         ]..      
-00037b50: 2020 7365 6c65 6374 6564 5f64 6620 3d20    selected_df = 
-00037b60: 7365 6c66 5b63 6f6c 756d 6e5f 6e61 6d65  self[column_name
-00037b70: 735d 0a20 2020 2020 2020 2069 6620 7365  s].        if se
-00037b80: 6c66 2e5f 636f 6e74 6169 6e73 5f69 6e64  lf._contains_ind
-00037b90: 6578 5f6e 616d 6528 636f 6c75 6d6e 735f  ex_name(columns_
-00037ba0: 6f72 5f69 6e64 6578 293a 0a20 2020 2020  or_index):.     
-00037bb0: 2020 2020 2020 2023 2049 6e64 6578 206e         # Index n
-00037bc0: 616d 6520 7761 7320 696e 636c 7564 6564  ame was included
-00037bd0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00037be0: 6563 7465 645f 6466 203d 2073 656c 6563  ected_df = selec
-00037bf0: 7465 645f 6466 2e61 7373 6967 6e28 5f69  ted_df.assign(_i
-00037c00: 6e64 6578 3d73 656c 662e 696e 6465 7829  ndex=self.index)
-00037c10: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00037c20: 2073 656c 6563 7465 645f 6466 0a0a 2020   selected_df..  
-00037c30: 2020 6465 6620 5f69 735f 636f 6c75 6d6e    def _is_column
-00037c40: 5f6c 6162 656c 5f72 6566 6572 656e 6365  _label_reference
-00037c50: 2873 656c 662c 206b 6579 293a 0a20 2020  (self, key):.   
-00037c60: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00037c70: 2054 6573 7420 7768 6574 6865 7220 6120   Test whether a 
-00037c80: 6b65 7920 6973 2061 2063 6f6c 756d 6e20  key is a column 
-00037c90: 6c61 6265 6c20 7265 6665 7265 6e63 650a  label reference.
-00037ca0: 0a20 2020 2020 2020 2054 6f20 6265 2063  .        To be c
-00037cb0: 6f6e 7369 6465 7265 6420 6120 636f 6c75  onsidered a colu
-00037cc0: 6d6e 206c 6162 656c 2072 6566 6572 656e  mn label referen
-00037cd0: 6365 2c20 606b 6579 6020 6d75 7374 206d  ce, `key` must m
-00037ce0: 6174 6368 2074 6865 206e 616d 6520 6f66  atch the name of
-00037cf0: 2061 740a 2020 2020 2020 2020 6c65 6173   at.        leas
-00037d00: 7420 6f6e 6520 636f 6c75 6d6e 2e0a 2020  t one column..  
-00037d10: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00037d20: 2020 7265 7475 726e 2028 0a20 2020 2020    return (.     
-00037d30: 2020 2020 2020 206e 6f74 2069 735f 6461         not is_da
-00037d40: 736b 5f63 6f6c 6c65 6374 696f 6e28 6b65  sk_collection(ke
-00037d50: 7929 0a20 2020 2020 2020 2020 2020 2061  y).            a
-00037d60: 6e64 2028 6e70 2e69 7373 6361 6c61 7228  nd (np.isscalar(
-00037d70: 6b65 7929 206f 7220 6973 696e 7374 616e  key) or isinstan
-00037d80: 6365 286b 6579 2c20 7475 706c 6529 290a  ce(key, tuple)).
-00037d90: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00037da0: 6b65 7920 696e 2073 656c 662e 636f 6c75  key in self.colu
-00037db0: 6d6e 730a 2020 2020 2020 2020 290a 0a20  mns.        ).. 
-00037dc0: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
-00037dd0: 2020 2020 6465 6620 6672 6f6d 5f64 6963      def from_dic
-00037de0: 7428 0a20 2020 2020 2020 2063 6c73 2c20  t(.        cls, 
-00037df0: 6461 7461 2c20 2a2c 206e 7061 7274 6974  data, *, npartit
-00037e00: 696f 6e73 2c20 6f72 6965 6e74 3d22 636f  ions, orient="co
-00037e10: 6c75 6d6e 7322 2c20 6474 7970 653d 4e6f  lumns", dtype=No
-00037e20: 6e65 2c20 636f 6c75 6d6e 733d 4e6f 6e65  ne, columns=None
-00037e30: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-00037e40: 2222 220a 2020 2020 2020 2020 436f 6e73  """.        Cons
-00037e50: 7472 7563 7420 6120 4461 736b 2044 6174  truct a Dask Dat
-00037e60: 6146 7261 6d65 2066 726f 6d20 6120 5079  aFrame from a Py
-00037e70: 7468 6f6e 2044 6963 7469 6f6e 6172 790a  thon Dictionary.
-00037e80: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
-00037e90: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
-00037ea0: 2d2d 0a20 2020 2020 2020 2064 6173 6b2e  --.        dask.
-00037eb0: 6461 7461 6672 616d 652e 6672 6f6d 5f64  dataframe.from_d
-00037ec0: 6963 740a 2020 2020 2020 2020 2222 220a  ict.        """.
-00037ed0: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-00037ee0: 6b2e 6461 7461 6672 616d 652e 696f 2069  k.dataframe.io i
-00037ef0: 6d70 6f72 7420 6672 6f6d 5f64 6963 740a  mport from_dict.
-00037f00: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00037f10: 6672 6f6d 5f64 6963 7428 0a20 2020 2020  from_dict(.     
-00037f20: 2020 2020 2020 2064 6174 612c 0a20 2020         data,.   
-00037f30: 2020 2020 2020 2020 206e 7061 7274 6974           npartit
-00037f40: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
-00037f50: 2020 6f72 6965 6e74 3d6f 7269 656e 742c    orient=orient,
-00037f60: 0a20 2020 2020 2020 2020 2020 2064 7479  .            dty
-00037f70: 7065 3d64 7479 7065 2c0a 2020 2020 2020  pe=dtype,.      
-00037f80: 2020 2020 2020 636f 6c75 6d6e 733d 636f        columns=co
-00037f90: 6c75 6d6e 732c 0a20 2020 2020 2020 2020  lumns,.         
-00037fa0: 2020 2063 6f6e 7374 7275 6374 6f72 3d63     constructor=c
-00037fb0: 6c73 2e5f 7061 7274 6974 696f 6e5f 7479  ls._partition_ty
-00037fc0: 7065 2c0a 2020 2020 2020 2020 290a 0a0a  pe,.        )...
-00037fd0: 2320 6269 6e64 206f 7065 7261 746f 7273  # bind operators
-00037fe0: 0a23 2054 4f44 4f3a 2064 796e 616d 6963  .# TODO: dynamic
-00037ff0: 616c 6c79 2062 6f75 6e64 206f 7065 7261  ally bound opera
-00038000: 746f 7273 2061 7265 2064 6566 6561 7469  tors are defeati
-00038010: 6e67 2074 7970 6520 616e 6e6f 7461 7469  ng type annotati
-00038020: 6f6e 730a 666f 7220 6f70 2069 6e20 5b0a  ons.for op in [.
-00038030: 2020 2020 6f70 6572 6174 6f72 2e61 6273      operator.abs
-00038040: 2c0a 2020 2020 6f70 6572 6174 6f72 2e61  ,.    operator.a
-00038050: 6464 2c0a 2020 2020 6f70 6572 6174 6f72  dd,.    operator
-00038060: 2e61 6e64 5f2c 0a20 2020 206f 7065 7261  .and_,.    opera
-00038070: 746f 722e 6571 2c0a 2020 2020 6f70 6572  tor.eq,.    oper
-00038080: 6174 6f72 2e67 742c 0a20 2020 206f 7065  ator.gt,.    ope
-00038090: 7261 746f 722e 6765 2c0a 2020 2020 6f70  rator.ge,.    op
-000380a0: 6572 6174 6f72 2e69 6e76 2c0a 2020 2020  erator.inv,.    
-000380b0: 6f70 6572 6174 6f72 2e6c 742c 0a20 2020  operator.lt,.   
-000380c0: 206f 7065 7261 746f 722e 6c65 2c0a 2020   operator.le,.  
-000380d0: 2020 6f70 6572 6174 6f72 2e6d 6f64 2c0a    operator.mod,.
-000380e0: 2020 2020 6f70 6572 6174 6f72 2e6d 756c      operator.mul
-000380f0: 2c0a 2020 2020 6f70 6572 6174 6f72 2e6e  ,.    operator.n
-00038100: 652c 0a20 2020 206f 7065 7261 746f 722e  e,.    operator.
-00038110: 6e65 672c 0a20 2020 206f 7065 7261 746f  neg,.    operato
-00038120: 722e 6f72 5f2c 0a20 2020 206f 7065 7261  r.or_,.    opera
-00038130: 746f 722e 706f 772c 0a20 2020 206f 7065  tor.pow,.    ope
-00038140: 7261 746f 722e 7375 622c 0a20 2020 206f  rator.sub,.    o
-00038150: 7065 7261 746f 722e 7472 7565 6469 762c  perator.truediv,
-00038160: 0a20 2020 206f 7065 7261 746f 722e 666c  .    operator.fl
-00038170: 6f6f 7264 6976 2c0a 2020 2020 6f70 6572  oordiv,.    oper
-00038180: 6174 6f72 2e78 6f72 2c0a 5d3a 0a20 2020  ator.xor,.]:.   
-00038190: 205f 4672 616d 652e 5f62 696e 645f 6f70   _Frame._bind_op
-000381a0: 6572 6174 6f72 286f 7029 0a20 2020 2053  erator(op).    S
-000381b0: 6361 6c61 722e 5f62 696e 645f 6f70 6572  calar._bind_oper
-000381c0: 6174 6f72 286f 7029 0a0a 666f 7220 6e61  ator(op)..for na
-000381d0: 6d65 2069 6e20 5b0a 2020 2020 2261 6464  me in [.    "add
-000381e0: 222c 0a20 2020 2022 7375 6222 2c0a 2020  ",.    "sub",.  
-000381f0: 2020 226d 756c 222c 0a20 2020 2022 6469    "mul",.    "di
-00038200: 7622 2c0a 2020 2020 2264 6976 6964 6522  v",.    "divide"
-00038210: 2c0a 2020 2020 2274 7275 6564 6976 222c  ,.    "truediv",
-00038220: 0a20 2020 2022 666c 6f6f 7264 6976 222c  .    "floordiv",
-00038230: 0a20 2020 2022 6d6f 6422 2c0a 2020 2020  .    "mod",.    
-00038240: 2270 6f77 222c 0a20 2020 2022 7261 6464  "pow",.    "radd
-00038250: 222c 0a20 2020 2022 7273 7562 222c 0a20  ",.    "rsub",. 
-00038260: 2020 2022 726d 756c 222c 0a20 2020 2022     "rmul",.    "
-00038270: 7264 6976 222c 0a20 2020 2022 7274 7275  rdiv",.    "rtru
-00038280: 6564 6976 222c 0a20 2020 2022 7266 6c6f  ediv",.    "rflo
-00038290: 6f72 6469 7622 2c0a 2020 2020 2272 6d6f  ordiv",.    "rmo
-000382a0: 6422 2c0a 2020 2020 2272 706f 7722 2c0a  d",.    "rpow",.
-000382b0: 5d3a 0a20 2020 206d 6574 6820 3d20 6765  ]:.    meth = ge
-000382c0: 7461 7474 7228 7064 2e44 6174 6146 7261  tattr(pd.DataFra
-000382d0: 6d65 2c20 6e61 6d65 290a 2020 2020 4461  me, name).    Da
-000382e0: 7461 4672 616d 652e 5f62 696e 645f 6f70  taFrame._bind_op
-000382f0: 6572 6174 6f72 5f6d 6574 686f 6428 6e61  erator_method(na
-00038300: 6d65 2c20 6d65 7468 290a 0a20 2020 206d  me, meth)..    m
-00038310: 6574 6820 3d20 6765 7461 7474 7228 7064  eth = getattr(pd
-00038320: 2e53 6572 6965 732c 206e 616d 6529 0a20  .Series, name). 
-00038330: 2020 2053 6572 6965 732e 5f62 696e 645f     Series._bind_
-00038340: 6f70 6572 6174 6f72 5f6d 6574 686f 6428  operator_method(
-00038350: 6e61 6d65 2c20 6d65 7468 290a 0a66 6f72  name, meth)..for
-00038360: 206e 616d 6520 696e 205b 226c 7422 2c20   name in ["lt", 
-00038370: 2267 7422 2c20 226c 6522 2c20 2267 6522  "gt", "le", "ge"
-00038380: 2c20 226e 6522 2c20 2265 7122 5d3a 0a20  , "ne", "eq"]:. 
-00038390: 2020 206d 6574 6820 3d20 6765 7461 7474     meth = getatt
-000383a0: 7228 7064 2e44 6174 6146 7261 6d65 2c20  r(pd.DataFrame, 
-000383b0: 6e61 6d65 290a 2020 2020 4461 7461 4672  name).    DataFr
-000383c0: 616d 652e 5f62 696e 645f 636f 6d70 6172  ame._bind_compar
-000383d0: 6973 6f6e 5f6d 6574 686f 6428 6e61 6d65  ison_method(name
-000383e0: 2c20 6d65 7468 290a 0a20 2020 206d 6574  , meth)..    met
-000383f0: 6820 3d20 6765 7461 7474 7228 7064 2e53  h = getattr(pd.S
-00038400: 6572 6965 732c 206e 616d 6529 0a20 2020  eries, name).   
-00038410: 2053 6572 6965 732e 5f62 696e 645f 636f   Series._bind_co
-00038420: 6d70 6172 6973 6f6e 5f6d 6574 686f 6428  mparison_method(
-00038430: 6e61 6d65 2c20 6d65 7468 290a 0a0a 6465  name, meth)...de
-00038440: 6620 6973 5f62 726f 6164 6361 7374 6162  f is_broadcastab
-00038450: 6c65 2864 6673 2c20 7329 3a0a 2020 2020  le(dfs, s):.    
-00038460: 2222 220a 2020 2020 5468 6973 2053 6572  """.    This Ser
-00038470: 6965 7320 6973 2062 726f 6164 6361 7374  ies is broadcast
-00038480: 6162 6c65 2061 6761 696e 7374 2061 6e6f  able against ano
-00038490: 7468 6572 2064 6174 6166 7261 6d65 2069  ther dataframe i
-000384a0: 6e20 7468 6520 7365 7175 656e 6365 0a20  n the sequence. 
-000384b0: 2020 2022 2222 0a0a 2020 2020 6465 6620     """..    def 
-000384c0: 636f 6d70 6172 6528 732c 2064 6629 3a0a  compare(s, df):.
-000384d0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-000384e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000384f0: 732e 6469 7669 7369 6f6e 7320 3d3d 2028  s.divisions == (
-00038500: 6466 2e63 6f6c 756d 6e73 2e6d 696e 2829  df.columns.min()
-00038510: 2c20 6466 2e63 6f6c 756d 6e73 2e6d 6178  , df.columns.max
-00038520: 2829 290a 2020 2020 2020 2020 6578 6365  ()).        exce
-00038530: 7074 2054 7970 6545 7272 6f72 3a0a 2020  pt TypeError:.  
-00038540: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00038550: 2046 616c 7365 0a0a 2020 2020 7265 7475   False..    retu
-00038560: 726e 2028 0a20 2020 2020 2020 2069 7369  rn (.        isi
-00038570: 6e73 7461 6e63 6528 732c 2053 6572 6965  nstance(s, Serie
-00038580: 7329 0a20 2020 2020 2020 2061 6e64 2073  s).        and s
-00038590: 2e6e 7061 7274 6974 696f 6e73 203d 3d20  .npartitions == 
-000385a0: 310a 2020 2020 2020 2020 616e 6420 732e  1.        and s.
-000385b0: 6b6e 6f77 6e5f 6469 7669 7369 6f6e 730a  known_divisions.
-000385c0: 2020 2020 2020 2020 616e 6420 616e 7928          and any(
-000385d0: 636f 6d70 6172 6528 732c 2064 6629 2066  compare(s, df) f
-000385e0: 6f72 2064 6620 696e 2064 6673 2069 6620  or df in dfs if 
-000385f0: 6973 696e 7374 616e 6365 2864 662c 2044  isinstance(df, D
-00038600: 6174 6146 7261 6d65 2929 0a20 2020 2029  ataFrame)).    )
-00038610: 0a0a 0a64 6566 2065 6c65 6d77 6973 6528  ...def elemwise(
-00038620: 6f70 2c20 2a61 7267 732c 206d 6574 613d  op, *args, meta=
-00038630: 6e6f 5f64 6566 6175 6c74 2c20 6f75 743d  no_default, out=
-00038640: 4e6f 6e65 2c20 7472 616e 7366 6f72 6d5f  None, transform_
-00038650: 6469 7669 7369 6f6e 733d 5472 7565 2c20  divisions=True, 
-00038660: 2a2a 6b77 6172 6773 293a 0a20 2020 2022  **kwargs):.    "
-00038670: 2222 456c 656d 656e 7477 6973 6520 6f70  ""Elementwise op
-00038680: 6572 6174 696f 6e20 666f 7220 4461 736b  eration for Dask
-00038690: 2064 6174 6166 7261 6d65 730a 0a20 2020   dataframes..   
-000386a0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-000386b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 206f  ----------.    o
-000386c0: 703a 2063 616c 6c61 626c 650a 2020 2020  p: callable.    
-000386d0: 2020 2020 4675 6e63 7469 6f6e 2074 6f20      Function to 
-000386e0: 6170 706c 7920 6163 726f 7373 2069 6e70  apply across inp
-000386f0: 7574 2064 6174 6166 7261 6d65 730a 2020  ut dataframes.  
-00038700: 2020 2a61 7267 733a 2044 6174 6146 7261    *args: DataFra
-00038710: 6d65 732c 2053 6572 6965 732c 2053 6361  mes, Series, Sca
-00038720: 6c61 7273 2c20 4172 7261 7973 2c0a 2020  lars, Arrays,.  
-00038730: 2020 2020 2020 5468 6520 6172 6775 6d65        The argume
-00038740: 6e74 7320 6f66 2074 6865 206f 7065 7261  nts of the opera
-00038750: 7469 6f6e 0a20 2020 206d 6574 613a 2070  tion.    meta: p
-00038760: 642e 4461 7461 4672 616d 652c 2070 642e  d.DataFrame, pd.
-00038770: 5365 7269 6573 2028 6f70 7469 6f6e 616c  Series (optional
-00038780: 290a 2020 2020 2020 2020 5661 6c69 6420  ).        Valid 
-00038790: 6d65 7461 6461 7461 2066 6f72 2074 6865  metadata for the
-000387a0: 206f 7065 7261 7469 6f6e 2e20 2057 696c   operation.  Wil
-000387b0: 6c20 6576 616c 7561 7465 206f 6e20 6120  l evaluate on a 
-000387c0: 736d 616c 6c20 7069 6563 6520 6f66 0a20  small piece of. 
-000387d0: 2020 2020 2020 2064 6174 6120 6966 206e         data if n
-000387e0: 6f74 2070 726f 7669 6465 642e 0a20 2020  ot provided..   
-000387f0: 2074 7261 6e73 666f 726d 5f64 6976 6973   transform_divis
-00038800: 696f 6e73 3a20 626f 6f6c 6561 6e0a 2020  ions: boolean.  
-00038810: 2020 2020 2020 4966 2074 6865 2069 6e70        If the inp
-00038820: 7574 2069 7320 6120 6060 6461 736b 2e64  ut is a ``dask.d
-00038830: 6174 6166 7261 6d65 2e49 6e64 6578 6060  ataframe.Index``
-00038840: 2077 6520 6e6f 726d 616c 6c79 2077 696c   we normally wil
-00038850: 6c20 616c 736f 2061 7070 6c79 0a20 2020  l also apply.   
-00038860: 2020 2020 2074 6865 2066 756e 6374 696f       the functio
-00038870: 6e20 6f6e 746f 2074 6865 2064 6976 6973  n onto the divis
-00038880: 696f 6e73 2061 6e64 2061 7070 6c79 2074  ions and apply t
-00038890: 686f 7365 2074 7261 6e73 666f 726d 6564  hose transformed
-000388a0: 2064 6976 6973 696f 6e73 0a20 2020 2020   divisions.     
-000388b0: 2020 2074 6f20 7468 6520 6f75 7470 7574     to the output
-000388c0: 2e20 2059 6f75 2063 616e 2070 6173 7320  .  You can pass 
-000388d0: 6060 7472 616e 7366 6f72 6d5f 6469 7669  ``transform_divi
-000388e0: 7369 6f6e 733d 4661 6c73 6560 6020 746f  sions=False`` to
-000388f0: 206f 7665 7272 6964 650a 2020 2020 2020   override.      
-00038900: 2020 7468 6973 2062 6568 6176 696f 720a    this behavior.
-00038910: 2020 2020 6f75 7420 3a20 6060 6461 736b      out : ``dask
-00038920: 2e61 7272 6179 6060 206f 7220 6060 4e6f  .array`` or ``No
-00038930: 6e65 6060 0a20 2020 2020 2020 2049 6620  ne``.        If 
-00038940: 6f75 7420 6973 2061 2064 6173 6b2e 4461  out is a dask.Da
-00038950: 7461 4672 616d 652c 2064 6173 6b2e 5365  taFrame, dask.Se
-00038960: 7269 6573 206f 7220 6461 736b 2e53 6361  ries or dask.Sca
-00038970: 6c61 7220 7468 656e 0a20 2020 2020 2020  lar then.       
-00038980: 2074 6869 7320 6f76 6572 7772 6974 6573   this overwrites
-00038990: 2074 6865 2063 6f6e 7465 6e74 7320 6f66   the contents of
-000389a0: 2069 7420 7769 7468 2074 6865 2072 6573   it with the res
-000389b0: 756c 740a 2020 2020 2a2a 6b77 6172 6773  ult.    **kwargs
-000389c0: 3a20 7363 616c 6172 730a 0a20 2020 2045  : scalars..    E
-000389d0: 7861 6d70 6c65 730a 2020 2020 2d2d 2d2d  xamples.    ----
-000389e0: 2d2d 2d2d 0a20 2020 203e 3e3e 2065 6c65  ----.    >>> ele
-000389f0: 6d77 6973 6528 6f70 6572 6174 6f72 2e61  mwise(operator.a
-00038a00: 6464 2c20 6466 2e78 2c20 6466 2e79 2920  dd, df.x, df.y) 
-00038a10: 2023 2064 6f63 7465 7374 3a20 2b53 4b49   # doctest: +SKI
-00038a20: 500a 2020 2020 2222 220a 2020 2020 5f6e  P.    """.    _n
-00038a30: 616d 6520 3d20 6675 6e63 6e61 6d65 286f  ame = funcname(o
-00038a40: 7029 202b 2022 2d22 202b 2074 6f6b 656e  p) + "-" + token
-00038a50: 697a 6528 6f70 2c20 2a61 7267 732c 202a  ize(op, *args, *
-00038a60: 2a6b 7761 7267 7329 0a0a 2020 2020 6172  *kwargs)..    ar
-00038a70: 6773 203d 205f 6d61 7962 655f 6672 6f6d  gs = _maybe_from
-00038a80: 5f70 616e 6461 7328 6172 6773 290a 0a20  _pandas(args).. 
-00038a90: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
-00038aa0: 6166 7261 6d65 2e6d 756c 7469 2069 6d70  aframe.multi imp
-00038ab0: 6f72 7420 5f6d 6179 6265 5f61 6c69 676e  ort _maybe_align
-00038ac0: 5f70 6172 7469 7469 6f6e 730a 0a20 2020  _partitions..   
-00038ad0: 2061 7267 7320 3d20 5f6d 6179 6265 5f61   args = _maybe_a
-00038ae0: 6c69 676e 5f70 6172 7469 7469 6f6e 7328  lign_partitions(
-00038af0: 6172 6773 290a 2020 2020 6461 736b 7320  args).    dasks 
-00038b00: 3d20 5b61 7267 2066 6f72 2061 7267 2069  = [arg for arg i
-00038b10: 6e20 6172 6773 2069 6620 6973 696e 7374  n args if isinst
-00038b20: 616e 6365 2861 7267 2c20 285f 4672 616d  ance(arg, (_Fram
-00038b30: 652c 2053 6361 6c61 722c 2041 7272 6179  e, Scalar, Array
-00038b40: 2929 5d0a 2020 2020 6466 7320 3d20 5b64  ))].    dfs = [d
-00038b50: 6620 666f 7220 6466 2069 6e20 6461 736b  f for df in dask
-00038b60: 7320 6966 2069 7369 6e73 7461 6e63 6528  s if isinstance(
-00038b70: 6466 2c20 5f46 7261 6d65 295d 0a0a 2020  df, _Frame)]..  
-00038b80: 2020 2320 436c 6561 6e20 7570 2064 6173    # Clean up das
-00038b90: 6b20 6172 7261 7973 2069 6620 7072 6573  k arrays if pres
-00038ba0: 656e 740a 2020 2020 6465 7073 203d 2064  ent.    deps = d
-00038bb0: 6173 6b73 2e63 6f70 7928 290a 2020 2020  asks.copy().    
-00038bc0: 666f 7220 692c 2061 2069 6e20 656e 756d  for i, a in enum
-00038bd0: 6572 6174 6528 6461 736b 7329 3a0a 2020  erate(dasks):.  
-00038be0: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-00038bf0: 6e73 7461 6e63 6528 612c 2041 7272 6179  nstance(a, Array
-00038c00: 293a 0a20 2020 2020 2020 2020 2020 2063  ):.            c
-00038c10: 6f6e 7469 6e75 650a 2020 2020 2020 2020  ontinue.        
-00038c20: 2320 456e 7375 7265 2074 6861 7420 7468  # Ensure that th
-00038c30: 6579 2068 6176 6520 7369 6d69 6c61 722d  ey have similar-
-00038c40: 6973 6820 6368 756e 6b20 7374 7275 6374  ish chunk struct
-00038c50: 7572 650a 2020 2020 2020 2020 6966 206e  ure.        if n
-00038c60: 6f74 2061 6c6c 286e 6f74 2061 2e63 6875  ot all(not a.chu
-00038c70: 6e6b 7320 6f72 206c 656e 2861 2e63 6875  nks or len(a.chu
-00038c80: 6e6b 735b 305d 2920 3d3d 2064 662e 6e70  nks[0]) == df.np
-00038c90: 6172 7469 7469 6f6e 7320 666f 7220 6466  artitions for df
-00038ca0: 2069 6e20 6466 7329 3a0a 2020 2020 2020   in dfs):.      
-00038cb0: 2020 2020 2020 6d73 6720 3d20 280a 2020        msg = (.  
-00038cc0: 2020 2020 2020 2020 2020 2020 2020 2257                "W
-00038cd0: 6865 6e20 636f 6d62 696e 696e 6720 6461  hen combining da
-00038ce0: 736b 2061 7272 6179 7320 7769 7468 2064  sk arrays with d
-00038cf0: 6174 6166 7261 6d65 7320 7468 6579 206d  ataframes they m
-00038d00: 7573 7420 220a 2020 2020 2020 2020 2020  ust ".          
-00038d10: 2020 2020 2020 226d 6174 6368 2063 6875        "match chu
-00038d20: 6e6b 696e 6720 6578 6163 746c 792e 2020  nking exactly.  
-00038d30: 4f70 6572 6174 696f 6e3a 2025 7322 2025  Operation: %s" %
-00038d40: 2066 756e 636e 616d 6528 6f70 290a 2020   funcname(op).  
-00038d50: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00038d60: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00038d70: 6c75 6545 7272 6f72 286d 7367 290a 2020  lueError(msg).  
-00038d80: 2020 2020 2020 2320 5265 6368 756e 6b20        # Rechunk 
-00038d90: 746f 2068 6176 6520 6120 7369 6e67 6c65  to have a single
-00038da0: 2063 6875 6e6b 2061 6c6f 6e67 2061 6c6c   chunk along all
-00038db0: 206f 7468 6572 2061 7865 730a 2020 2020   other axes.    
-00038dc0: 2020 2020 6966 2061 2e6e 6469 6d20 3e20      if a.ndim > 
-00038dd0: 313a 0a20 2020 2020 2020 2020 2020 2061  1:.            a
-00038de0: 203d 2061 2e72 6563 6875 6e6b 287b 6920   = a.rechunk({i 
-00038df0: 2b20 313a 2064 2066 6f72 2069 2c20 6420  + 1: d for i, d 
-00038e00: 696e 2065 6e75 6d65 7261 7465 2861 2e73  in enumerate(a.s
-00038e10: 6861 7065 5b31 3a5d 297d 290a 2020 2020  hape[1:])}).    
-00038e20: 2020 2020 2020 2020 6461 736b 735b 695d          dasks[i]
-00038e30: 203d 2061 0a0a 2020 2020 6469 7669 7369   = a..    divisi
-00038e40: 6f6e 7320 3d20 6466 735b 305d 2e64 6976  ons = dfs[0].div
-00038e50: 6973 696f 6e73 0a20 2020 2069 6620 7472  isions.    if tr
-00038e60: 616e 7366 6f72 6d5f 6469 7669 7369 6f6e  ansform_division
-00038e70: 7320 616e 6420 6973 696e 7374 616e 6365  s and isinstance
-00038e80: 2864 6673 5b30 5d2c 2049 6e64 6578 2920  (dfs[0], Index) 
-00038e90: 616e 6420 6c65 6e28 6466 7329 203d 3d20  and len(dfs) == 
-00038ea0: 313a 0a20 2020 2020 2020 2074 7279 3a0a  1:.        try:.
-00038eb0: 2020 2020 2020 2020 2020 2020 6469 7669              divi
-00038ec0: 7369 6f6e 7320 3d20 6f70 280a 2020 2020  sions = op(.    
-00038ed0: 2020 2020 2020 2020 2020 2020 2a5b 7064              *[pd
-00038ee0: 2e49 6e64 6578 2861 7267 2e64 6976 6973  .Index(arg.divis
-00038ef0: 696f 6e73 2920 6966 2061 7267 2069 7320  ions) if arg is 
-00038f00: 6466 735b 305d 2065 6c73 6520 6172 6720  dfs[0] else arg 
-00038f10: 666f 7220 6172 6720 696e 2061 7267 735d  for arg in args]
-00038f20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00038f30: 2020 2a2a 6b77 6172 6773 2c0a 2020 2020    **kwargs,.    
-00038f40: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00038f50: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00038f60: 6e63 6528 6469 7669 7369 6f6e 732c 2070  nce(divisions, p
-00038f70: 642e 496e 6465 7829 3a0a 2020 2020 2020  d.Index):.      
-00038f80: 2020 2020 2020 2020 2020 6469 7669 7369            divisi
-00038f90: 6f6e 7320 3d20 6d65 7468 6f64 732e 746f  ons = methods.to
-00038fa0: 6c69 7374 2864 6976 6973 696f 6e73 290a  list(divisions).
-00038fb0: 2020 2020 2020 2020 6578 6365 7074 2045          except E
-00038fc0: 7863 6570 7469 6f6e 3a0a 2020 2020 2020  xception:.      
-00038fd0: 2020 2020 2020 7061 7373 0a20 2020 2020        pass.     
-00038fe0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00038ff0: 2020 2020 2069 6620 6e6f 7420 7661 6c69       if not vali
-00039000: 645f 6469 7669 7369 6f6e 7328 6469 7669  d_divisions(divi
-00039010: 7369 6f6e 7329 3a0a 2020 2020 2020 2020  sions):.        
-00039020: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
-00039030: 7320 3d20 5b4e 6f6e 655d 202a 2028 6466  s = [None] * (df
-00039040: 735b 305d 2e6e 7061 7274 6974 696f 6e73  s[0].npartitions
-00039050: 202b 2031 290a 0a20 2020 205f 6973 5f62   + 1)..    _is_b
-00039060: 726f 6164 6361 7374 6162 6c65 203d 2070  roadcastable = p
-00039070: 6172 7469 616c 2869 735f 6272 6f61 6463  artial(is_broadc
-00039080: 6173 7461 626c 652c 2064 6673 290a 2020  astable, dfs).  
-00039090: 2020 6466 7320 3d20 6c69 7374 2872 656d    dfs = list(rem
-000390a0: 6f76 6528 5f69 735f 6272 6f61 6463 6173  ove(_is_broadcas
-000390b0: 7461 626c 652c 2064 6673 2929 0a0a 2020  table, dfs))..  
-000390c0: 2020 6f74 6865 7220 3d20 5b0a 2020 2020    other = [.    
-000390d0: 2020 2020 2869 2c20 6172 6729 0a20 2020      (i, arg).   
-000390e0: 2020 2020 2066 6f72 2069 2c20 6172 6720       for i, arg 
-000390f0: 696e 2065 6e75 6d65 7261 7465 2861 7267  in enumerate(arg
-00039100: 7329 0a20 2020 2020 2020 2069 6620 6e6f  s).        if no
-00039110: 7420 6973 696e 7374 616e 6365 2861 7267  t isinstance(arg
-00039120: 2c20 285f 4672 616d 652c 2053 6361 6c61  , (_Frame, Scala
-00039130: 722c 2041 7272 6179 2929 0a20 2020 205d  r, Array)).    ]
-00039140: 0a0a 2020 2020 2320 6164 6a75 7374 2074  ..    # adjust t
-00039150: 6865 206b 6579 206c 656e 6774 6820 6f66  he key length of
-00039160: 2053 6361 6c61 720a 2020 2020 6473 6b20   Scalar.    dsk 
-00039170: 3d20 7061 7274 6974 696f 6e77 6973 655f  = partitionwise_
-00039180: 6772 6170 6828 6f70 2c20 5f6e 616d 652c  graph(op, _name,
-00039190: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-000391a0: 290a 0a20 2020 2067 7261 7068 203d 2048  )..    graph = H
-000391b0: 6967 684c 6576 656c 4772 6170 682e 6672  ighLevelGraph.fr
-000391c0: 6f6d 5f63 6f6c 6c65 6374 696f 6e73 285f  om_collections(_
-000391d0: 6e61 6d65 2c20 6473 6b2c 2064 6570 656e  name, dsk, depen
-000391e0: 6465 6e63 6965 733d 6465 7073 290a 0a20  dencies=deps).. 
-000391f0: 2020 2069 6620 6d65 7461 2069 7320 6e6f     if meta is no
-00039200: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
-00039210: 2020 6966 206c 656e 2864 6673 2920 3e3d    if len(dfs) >=
-00039220: 2032 2061 6e64 206e 6f74 2061 6c6c 2868   2 and not all(h
-00039230: 6173 6174 7472 2864 2c20 226e 7061 7274  asattr(d, "npart
-00039240: 6974 696f 6e73 2229 2066 6f72 2064 2069  itions") for d i
-00039250: 6e20 6461 736b 7329 3a0a 2020 2020 2020  n dasks):.      
-00039260: 2020 2020 2020 2320 7368 6f75 6c64 206e        # should n
-00039270: 6f74 206f 6363 7572 2069 6e20 6375 7272  ot occur in curr
-00039280: 656e 7420 6675 6e63 730a 2020 2020 2020  ent funcs.      
-00039290: 2020 2020 2020 6d73 6720 3d20 2265 6c65        msg = "ele
-000392a0: 6d77 6973 6520 7769 7468 2032 206f 7220  mwise with 2 or 
-000392b0: 6d6f 7265 2044 6174 6146 7261 6d65 7320  more DataFrames 
-000392c0: 616e 6420 5363 616c 6172 2069 7320 6e6f  and Scalar is no
-000392d0: 7420 7375 7070 6f72 7465 6422 0a20 2020  t supported".   
-000392e0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-000392f0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-00039300: 6f72 286d 7367 290a 2020 2020 2020 2020  or(msg).        
-00039310: 2320 466f 7220 6272 6f61 6463 6173 7461  # For broadcasta
-00039320: 626c 6520 7365 7269 6573 2c20 7573 6520  ble series, use 
-00039330: 6e6f 2072 6f77 732e 0a20 2020 2020 2020  no rows..       
-00039340: 2070 6172 7473 203d 205b 0a20 2020 2020   parts = [.     
-00039350: 2020 2020 2020 2064 2e5f 6d65 7461 0a20         d._meta. 
-00039360: 2020 2020 2020 2020 2020 2069 6620 5f69             if _i
-00039370: 735f 6272 6f61 6463 6173 7461 626c 6528  s_broadcastable(
-00039380: 6429 0a20 2020 2020 2020 2020 2020 2065  d).            e
-00039390: 6c73 6520 6e70 2e65 6d70 7479 2828 292c  lse np.empty((),
-000393a0: 2064 7479 7065 3d64 2e64 7479 7065 290a   dtype=d.dtype).
-000393b0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-000393c0: 7369 6e73 7461 6e63 6528 642c 2041 7272  sinstance(d, Arr
-000393d0: 6179 290a 2020 2020 2020 2020 2020 2020  ay).            
-000393e0: 656c 7365 2064 2e5f 6d65 7461 5f6e 6f6e  else d._meta_non
-000393f0: 656d 7074 790a 2020 2020 2020 2020 2020  empty.          
-00039400: 2020 666f 7220 6420 696e 2064 6173 6b73    for d in dasks
-00039410: 0a20 2020 2020 2020 205d 0a20 2020 2020  .        ].     
-00039420: 2020 2077 6974 6820 7261 6973 655f 6f6e     with raise_on
-00039430: 5f6d 6574 615f 6572 726f 7228 6675 6e63  _meta_error(func
-00039440: 6e61 6d65 286f 7029 293a 0a20 2020 2020  name(op)):.     
-00039450: 2020 2020 2020 206d 6574 6120 3d20 7061         meta = pa
-00039460: 7274 6961 6c5f 6279 5f6f 7264 6572 282a  rtial_by_order(*
-00039470: 7061 7274 732c 2066 756e 6374 696f 6e3d  parts, function=
-00039480: 6f70 2c20 6f74 6865 723d 6f74 6865 7229  op, other=other)
-00039490: 0a0a 2020 2020 7265 7375 6c74 203d 206e  ..    result = n
-000394a0: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
-000394b0: 7068 2c20 5f6e 616d 652c 206d 6574 612c  ph, _name, meta,
-000394c0: 2064 6976 6973 696f 6e73 290a 2020 2020   divisions).    
-000394d0: 7265 7475 726e 2068 616e 646c 655f 6f75  return handle_ou
-000394e0: 7428 6f75 742c 2072 6573 756c 7429 0a0a  t(out, result)..
-000394f0: 0a64 6566 2068 616e 646c 655f 6f75 7428  .def handle_out(
-00039500: 6f75 742c 2072 6573 756c 7429 3a0a 2020  out, result):.  
-00039510: 2020 2222 2248 616e 646c 6520 6f75 7420    """Handle out 
-00039520: 7061 7261 6d65 7465 7273 0a0a 2020 2020  parameters..    
-00039530: 4966 206f 7574 2069 7320 6120 6461 736b  If out is a dask
-00039540: 2e44 6174 6146 7261 6d65 2c20 6461 736b  .DataFrame, dask
-00039550: 2e53 6572 6965 7320 6f72 2064 6173 6b2e  .Series or dask.
-00039560: 5363 616c 6172 2074 6865 6e0a 2020 2020  Scalar then.    
-00039570: 7468 6973 206f 7665 7277 7269 7465 7320  this overwrites 
-00039580: 7468 6520 636f 6e74 656e 7473 206f 6620  the contents of 
-00039590: 6974 2077 6974 6820 7468 6520 7265 7375  it with the resu
-000395a0: 6c74 0a20 2020 2022 2222 0a20 2020 2069  lt.    """.    i
-000395b0: 6620 6973 696e 7374 616e 6365 286f 7574  f isinstance(out
-000395c0: 2c20 7475 706c 6529 3a0a 2020 2020 2020  , tuple):.      
-000395d0: 2020 6966 206c 656e 286f 7574 2920 3d3d    if len(out) ==
-000395e0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-000395f0: 6f75 7420 3d20 6f75 745b 305d 0a20 2020  out = out[0].   
-00039600: 2020 2020 2065 6c69 6620 6c65 6e28 6f75       elif len(ou
-00039610: 7429 203e 2031 3a0a 2020 2020 2020 2020  t) > 1:.        
-00039620: 2020 2020 7261 6973 6520 4e6f 7449 6d70      raise NotImp
-00039630: 6c65 6d65 6e74 6564 4572 726f 7228 2254  lementedError("T
-00039640: 6865 206f 7574 2070 6172 616d 6574 6572  he out parameter
-00039650: 2069 7320 6e6f 7420 6675 6c6c 7920 7375   is not fully su
-00039660: 7070 6f72 7465 6422 290a 2020 2020 2020  pported").      
-00039670: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00039680: 2020 2020 6f75 7420 3d20 4e6f 6e65 0a0a      out = None..
-00039690: 2020 2020 2320 4e6f 7469 6365 2c20 7765      # Notice, we
-000396a0: 2075 7365 202e 5f5f 636c 6173 735f 5f20   use .__class__ 
-000396b0: 6173 206f 7070 6f73 6564 2074 6f20 7479  as opposed to ty
-000396c0: 7065 2829 2069 6e20 6f72 6465 7220 746f  pe() in order to
-000396d0: 2073 7570 706f 7274 0a20 2020 2023 206f   support.    # o
-000396e0: 626a 6563 7420 7072 6f78 6965 7320 7365  bject proxies se
-000396f0: 6520 3c68 7474 7073 3a2f 2f67 6974 6875  e <https://githu
-00039700: 622e 636f 6d2f 6461 736b 2f64 6173 6b2f  b.com/dask/dask/
-00039710: 7075 6c6c 2f36 3938 313e 0a20 2020 2069  pull/6981>.    i
-00039720: 6620 6f75 7420 6973 206e 6f74 204e 6f6e  f out is not Non
-00039730: 6520 616e 6420 6f75 742e 5f5f 636c 6173  e and out.__clas
-00039740: 735f 5f20 213d 2072 6573 756c 742e 5f5f  s__ != result.__
-00039750: 636c 6173 735f 5f3a 0a20 2020 2020 2020  class__:.       
-00039760: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-00039770: 280a 2020 2020 2020 2020 2020 2020 224d  (.            "M
-00039780: 6973 6d61 7463 6865 6420 7479 7065 7320  ismatched types 
-00039790: 6265 7477 6565 6e20 7265 7375 6c74 2061  between result a
-000397a0: 6e64 206f 7574 2070 6172 616d 6574 6572  nd out parameter
-000397b0: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-000397c0: 226f 7574 3d25 732c 2072 6573 756c 743d  "out=%s, result=
-000397d0: 2573 2220 2520 2873 7472 2874 7970 6528  %s" % (str(type(
-000397e0: 6f75 7429 292c 2073 7472 2874 7970 6528  out)), str(type(
-000397f0: 7265 7375 6c74 2929 290a 2020 2020 2020  result))).      
-00039800: 2020 290a 0a20 2020 2069 6620 6973 696e    )..    if isin
-00039810: 7374 616e 6365 286f 7574 2c20 4461 7461  stance(out, Data
-00039820: 4672 616d 6529 3a0a 2020 2020 2020 2020  Frame):.        
-00039830: 6966 206c 656e 286f 7574 2e63 6f6c 756d  if len(out.colum
-00039840: 6e73 2920 213d 206c 656e 2872 6573 756c  ns) != len(resul
-00039850: 742e 636f 6c75 6d6e 7329 3a0a 2020 2020  t.columns):.    
-00039860: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00039870: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-00039880: 2020 2020 2020 2020 2020 224d 6973 6d61            "Misma
-00039890: 7463 6865 6420 636f 6c75 6d6e 7320 636f  tched columns co
-000398a0: 756e 7420 6265 7477 6565 6e20 7265 7375  unt between resu
-000398b0: 6c74 2061 6e64 206f 7574 2070 6172 616d  lt and out param
-000398c0: 6574 6572 2e20 220a 2020 2020 2020 2020  eter. ".        
-000398d0: 2020 2020 2020 2020 226f 7574 3d25 732c          "out=%s,
-000398e0: 2072 6573 756c 743d 2573 2220 2520 2873   result=%s" % (s
-000398f0: 7472 286c 656e 286f 7574 2e63 6f6c 756d  tr(len(out.colum
-00039900: 6e73 2929 2c20 7374 7228 6c65 6e28 7265  ns)), str(len(re
-00039910: 7375 6c74 2e63 6f6c 756d 6e73 2929 290a  sult.columns))).
-00039920: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00039930: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00039940: 286f 7574 2c20 2853 6572 6965 732c 2044  (out, (Series, D
-00039950: 6174 6146 7261 6d65 2c20 5363 616c 6172  ataFrame, Scalar
-00039960: 2929 3a0a 2020 2020 2020 2020 6f75 742e  )):.        out.
-00039970: 5f6d 6574 6120 3d20 7265 7375 6c74 2e5f  _meta = result._
-00039980: 6d65 7461 0a20 2020 2020 2020 206f 7574  meta.        out
-00039990: 2e5f 6e61 6d65 203d 2072 6573 756c 742e  ._name = result.
-000399a0: 5f6e 616d 650a 2020 2020 2020 2020 6f75  _name.        ou
-000399b0: 742e 6461 736b 203d 2072 6573 756c 742e  t.dask = result.
-000399c0: 6461 736b 0a0a 2020 2020 2020 2020 6966  dask..        if
-000399d0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-000399e0: 6f75 742c 2053 6361 6c61 7229 3a0a 2020  out, Scalar):.  
-000399f0: 2020 2020 2020 2020 2020 6f75 742e 5f64            out._d
-00039a00: 6976 6973 696f 6e73 203d 2072 6573 756c  ivisions = resul
-00039a10: 742e 6469 7669 7369 6f6e 730a 2020 2020  t.divisions.    
-00039a20: 656c 6966 206f 7574 2069 7320 6e6f 7420  elif out is not 
-00039a30: 4e6f 6e65 3a0a 2020 2020 2020 2020 6d73  None:.        ms
-00039a40: 6720 3d20 280a 2020 2020 2020 2020 2020  g = (.          
-00039a50: 2020 2254 6865 206f 7574 2070 6172 616d    "The out param
-00039a60: 6574 6572 2069 7320 6e6f 7420 6675 6c6c  eter is not full
-00039a70: 7920 7375 7070 6f72 7465 642e 220a 2020  y supported.".  
-00039a80: 2020 2020 2020 2020 2020 2220 5265 6365            " Rece
-00039a90: 6976 6564 2074 7970 6520 2573 2c20 6578  ived type %s, ex
-00039aa0: 7065 6374 6564 2025 7320 220a 2020 2020  pected %s ".    
-00039ab0: 2020 2020 2020 2020 2520 280a 2020 2020          % (.    
-00039ac0: 2020 2020 2020 2020 2020 2020 7479 7065              type
-00039ad0: 6e61 6d65 2874 7970 6528 6f75 7429 292c  name(type(out)),
-00039ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00039af0: 2074 7970 656e 616d 6528 7479 7065 2872   typename(type(r
-00039b00: 6573 756c 7429 292c 0a20 2020 2020 2020  esult)),.       
-00039b10: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
-00039b20: 0a20 2020 2020 2020 2072 6169 7365 204e  .        raise N
-00039b30: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-00039b40: 6f72 286d 7367 290a 2020 2020 656c 7365  or(msg).    else
-00039b50: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00039b60: 2072 6573 756c 740a 0a0a 6465 6620 5f6d   result...def _m
-00039b70: 6179 6265 5f66 726f 6d5f 7061 6e64 6173  aybe_from_pandas
-00039b80: 2864 6673 293a 0a20 2020 2066 726f 6d20  (dfs):.    from 
-00039b90: 6461 736b 2e64 6174 6166 7261 6d65 2e69  dask.dataframe.i
-00039ba0: 6f20 696d 706f 7274 2066 726f 6d5f 7061  o import from_pa
-00039bb0: 6e64 6173 0a0a 2020 2020 6466 7320 3d20  ndas..    dfs = 
-00039bc0: 5b0a 2020 2020 2020 2020 6672 6f6d 5f70  [.        from_p
-00039bd0: 616e 6461 7328 6466 2c20 3129 0a20 2020  andas(df, 1).   
-00039be0: 2020 2020 2069 6620 2869 735f 7365 7269       if (is_seri
-00039bf0: 6573 5f6c 696b 6528 6466 2920 6f72 2069  es_like(df) or i
-00039c00: 735f 6461 7461 6672 616d 655f 6c69 6b65  s_dataframe_like
-00039c10: 2864 6629 2920 616e 6420 6e6f 7420 6973  (df)) and not is
-00039c20: 5f64 6173 6b5f 636f 6c6c 6563 7469 6f6e  _dask_collection
-00039c30: 2864 6629 0a20 2020 2020 2020 2065 6c73  (df).        els
-00039c40: 6520 6466 0a20 2020 2020 2020 2066 6f72  e df.        for
-00039c50: 2064 6620 696e 2064 6673 0a20 2020 205d   df in dfs.    ]
-00039c60: 0a20 2020 2072 6574 7572 6e20 6466 730a  .    return dfs.
-00039c70: 0a0a 6465 6620 6861 7368 5f73 6861 7264  ..def hash_shard
-00039c80: 280a 2020 2020 6466 2c20 6e70 6172 7473  (.    df, nparts
-00039c90: 2c20 7370 6c69 745f 6f75 745f 7365 7475  , split_out_setu
-00039ca0: 703d 4e6f 6e65 2c20 7370 6c69 745f 6f75  p=None, split_ou
-00039cb0: 745f 7365 7475 705f 6b77 6172 6773 3d4e  t_setup_kwargs=N
-00039cc0: 6f6e 652c 2069 676e 6f72 655f 696e 6465  one, ignore_inde
-00039cd0: 783d 4661 6c73 650a 293a 0a20 2020 2069  x=False.):.    i
-00039ce0: 6620 7370 6c69 745f 6f75 745f 7365 7475  f split_out_setu
-00039cf0: 703a 0a20 2020 2020 2020 2068 203d 2073  p:.        h = s
-00039d00: 706c 6974 5f6f 7574 5f73 6574 7570 2864  plit_out_setup(d
-00039d10: 662c 202a 2a28 7370 6c69 745f 6f75 745f  f, **(split_out_
-00039d20: 7365 7475 705f 6b77 6172 6773 206f 7220  setup_kwargs or 
-00039d30: 7b7d 2929 0a20 2020 2065 6c73 653a 0a20  {})).    else:. 
-00039d40: 2020 2020 2020 2068 203d 2064 660a 0a20         h = df.. 
-00039d50: 2020 2068 203d 2068 6173 685f 6f62 6a65     h = hash_obje
-00039d60: 6374 5f64 6973 7061 7463 6828 682c 2069  ct_dispatch(h, i
-00039d70: 6e64 6578 3d46 616c 7365 290a 2020 2020  ndex=False).    
-00039d80: 7265 7475 726e 2067 726f 7570 5f73 706c  return group_spl
-00039d90: 6974 5f64 6973 7061 7463 6828 6466 2c20  it_dispatch(df, 
-00039da0: 6820 2520 6e70 6172 7473 2c20 6e70 6172  h % nparts, npar
-00039db0: 7473 2c20 6967 6e6f 7265 5f69 6e64 6578  ts, ignore_index
-00039dc0: 3d69 676e 6f72 655f 696e 6465 7829 0a0a  =ignore_index)..
-00039dd0: 0a64 6566 2073 706c 6974 5f65 7665 6e6c  .def split_evenl
-00039de0: 7928 6466 2c20 6b29 3a0a 2020 2020 2222  y(df, k):.    ""
-00039df0: 2253 706c 6974 2064 6174 6166 7261 6d65  "Split dataframe
-00039e00: 2069 6e74 6f20 6b20 726f 7567 686c 7920   into k roughly 
-00039e10: 6571 7561 6c20 7061 7274 7322 2222 0a20  equal parts""". 
-00039e20: 2020 2064 6976 6973 696f 6e73 203d 206e     divisions = n
-00039e30: 702e 6c69 6e73 7061 6365 2830 2c20 6c65  p.linspace(0, le
-00039e40: 6e28 6466 292c 206b 202b 2031 292e 6173  n(df), k + 1).as
-00039e50: 7479 7065 2869 6e74 290a 2020 2020 7265  type(int).    re
-00039e60: 7475 726e 207b 693a 2064 662e 696c 6f63  turn {i: df.iloc
-00039e70: 5b64 6976 6973 696f 6e73 5b69 5d20 3a20  [divisions[i] : 
-00039e80: 6469 7669 7369 6f6e 735b 6920 2b20 315d  divisions[i + 1]
-00039e90: 5d20 666f 7220 6920 696e 2072 616e 6765  ] for i in range
-00039ea0: 286b 297d 0a0a 0a64 6566 2073 706c 6974  (k)}...def split
-00039eb0: 5f6f 7574 5f6f 6e5f 696e 6465 7828 6466  _out_on_index(df
-00039ec0: 293a 0a20 2020 2068 203d 2064 662e 696e  ):.    h = df.in
-00039ed0: 6465 780a 2020 2020 6966 2069 7369 6e73  dex.    if isins
-00039ee0: 7461 6e63 6528 682c 2070 642e 4d75 6c74  tance(h, pd.Mult
-00039ef0: 6949 6e64 6578 293a 0a20 2020 2020 2020  iIndex):.       
-00039f00: 2068 203d 206d 6574 615f 6672 616d 655f   h = meta_frame_
-00039f10: 636f 6e73 7472 7563 746f 7228 6466 2928  constructor(df)(
-00039f20: 5b5d 2c20 696e 6465 783d 6829 2e72 6573  [], index=h).res
-00039f30: 6574 5f69 6e64 6578 2829 0a20 2020 2072  et_index().    r
-00039f40: 6574 7572 6e20 680a 0a0a 6465 6620 7370  eturn h...def sp
-00039f50: 6c69 745f 6f75 745f 6f6e 5f63 6f6c 7328  lit_out_on_cols(
-00039f60: 6466 2c20 636f 6c73 3d4e 6f6e 6529 3a0a  df, cols=None):.
-00039f70: 2020 2020 7265 7475 726e 2064 665b 636f      return df[co
-00039f80: 6c73 5d0a 0a0a 4069 6e73 6572 745f 6d65  ls]...@insert_me
-00039f90: 7461 5f70 6172 616d 5f64 6573 6372 6970  ta_param_descrip
-00039fa0: 7469 6f6e 0a64 6566 2061 7070 6c79 5f63  tion.def apply_c
-00039fb0: 6f6e 6361 745f 6170 706c 7928 0a20 2020  oncat_apply(.   
-00039fc0: 2061 7267 732c 0a20 2020 2063 6875 6e6b   args,.    chunk
-00039fd0: 3d4e 6f6e 652c 0a20 2020 2061 6767 7265  =None,.    aggre
-00039fe0: 6761 7465 3d4e 6f6e 652c 0a20 2020 2063  gate=None,.    c
-00039ff0: 6f6d 6269 6e65 3d4e 6f6e 652c 0a20 2020  ombine=None,.   
-0003a000: 206d 6574 613d 6e6f 5f64 6566 6175 6c74   meta=no_default
-0003a010: 2c0a 2020 2020 746f 6b65 6e3d 4e6f 6e65  ,.    token=None
-0003a020: 2c0a 2020 2020 6368 756e 6b5f 6b77 6172  ,.    chunk_kwar
-0003a030: 6773 3d4e 6f6e 652c 0a20 2020 2061 6767  gs=None,.    agg
-0003a040: 7265 6761 7465 5f6b 7761 7267 733d 4e6f  regate_kwargs=No
-0003a050: 6e65 2c0a 2020 2020 636f 6d62 696e 655f  ne,.    combine_
-0003a060: 6b77 6172 6773 3d4e 6f6e 652c 0a20 2020  kwargs=None,.   
-0003a070: 2073 706c 6974 5f65 7665 7279 3d4e 6f6e   split_every=Non
-0003a080: 652c 0a20 2020 2073 706c 6974 5f6f 7574  e,.    split_out
-0003a090: 3d4e 6f6e 652c 0a20 2020 2073 706c 6974  =None,.    split
-0003a0a0: 5f6f 7574 5f73 6574 7570 3d4e 6f6e 652c  _out_setup=None,
-0003a0b0: 0a20 2020 2073 706c 6974 5f6f 7574 5f73  .    split_out_s
-0003a0c0: 6574 7570 5f6b 7761 7267 733d 4e6f 6e65  etup_kwargs=None
-0003a0d0: 2c0a 2020 2020 736f 7274 3d4e 6f6e 652c  ,.    sort=None,
-0003a0e0: 0a20 2020 2069 676e 6f72 655f 696e 6465  .    ignore_inde
-0003a0f0: 783d 4661 6c73 652c 0a20 2020 202a 2a6b  x=False,.    **k
-0003a100: 7761 7267 732c 0a29 3a0a 2020 2020 2222  wargs,.):.    ""
-0003a110: 2241 7070 6c79 2061 2066 756e 6374 696f  "Apply a functio
-0003a120: 6e20 746f 2062 6c6f 636b 732c 2074 6865  n to blocks, the
-0003a130: 6e20 636f 6e63 6174 2c20 7468 656e 2061  n concat, then a
-0003a140: 7070 6c79 2061 6761 696e 0a0a 2020 2020  pply again..    
-0003a150: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-0003a160: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6172  ---------.    ar
-0003a170: 6773 203a 0a20 2020 2020 2020 2050 6f73  gs :.        Pos
-0003a180: 6974 696f 6e61 6c20 6172 6775 6d65 6e74  itional argument
-0003a190: 7320 666f 7220 7468 6520 6063 6875 6e6b  s for the `chunk
-0003a1a0: 6020 6675 6e63 7469 6f6e 2e20 416c 6c20  ` function. All 
-0003a1b0: 6064 6173 6b2e 6461 7461 6672 616d 6560  `dask.dataframe`
-0003a1c0: 0a20 2020 2020 2020 206f 626a 6563 7473  .        objects
-0003a1d0: 2073 686f 756c 6420 6265 2070 6172 7469   should be parti
-0003a1e0: 7469 6f6e 6564 2061 6e64 2069 6e64 6578  tioned and index
-0003a1f0: 6564 2065 7175 6976 616c 656e 746c 792e  ed equivalently.
-0003a200: 0a20 2020 2063 6875 6e6b 203a 2066 756e  .    chunk : fun
-0003a210: 6374 696f 6e20 5b62 6c6f 636b 2d70 6572  ction [block-per
-0003a220: 2d61 7267 5d20 2d3e 2062 6c6f 636b 0a20  -arg] -> block. 
-0003a230: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
-0003a240: 746f 206f 7065 7261 7465 206f 6e20 6561  to operate on ea
-0003a250: 6368 2062 6c6f 636b 206f 6620 6461 7461  ch block of data
-0003a260: 0a20 2020 2061 6767 7265 6761 7465 203a  .    aggregate :
-0003a270: 2066 756e 6374 696f 6e20 636f 6e63 6174   function concat
-0003a280: 656e 6174 6564 2d62 6c6f 636b 202d 3e20  enated-block -> 
-0003a290: 626c 6f63 6b0a 2020 2020 2020 2020 4675  block.        Fu
-0003a2a0: 6e63 7469 6f6e 2074 6f20 6f70 6572 6174  nction to operat
-0003a2b0: 6520 6f6e 2074 6865 2063 6f6e 6361 7465  e on the concate
-0003a2c0: 6e61 7465 6420 7265 7375 6c74 206f 6620  nated result of 
-0003a2d0: 6368 756e 6b0a 2020 2020 636f 6d62 696e  chunk.    combin
-0003a2e0: 6520 3a20 6675 6e63 7469 6f6e 2063 6f6e  e : function con
-0003a2f0: 6361 7465 6e61 7465 642d 626c 6f63 6b20  catenated-block 
-0003a300: 2d3e 2062 6c6f 636b 2c20 6f70 7469 6f6e  -> block, option
-0003a310: 616c 0a20 2020 2020 2020 2046 756e 6374  al.        Funct
-0003a320: 696f 6e20 746f 206f 7065 7261 7465 206f  ion to operate o
-0003a330: 6e20 696e 7465 726d 6564 6961 7465 2063  n intermediate c
-0003a340: 6f6e 6361 7465 6e61 7465 6420 7265 7375  oncatenated resu
-0003a350: 6c74 7320 6f66 2063 6875 6e6b 0a20 2020  lts of chunk.   
-0003a360: 2020 2020 2069 6e20 6120 7472 6565 2d72       in a tree-r
-0003a370: 6564 7563 7469 6f6e 2e20 4966 206e 6f74  eduction. If not
-0003a380: 2070 726f 7669 6465 642c 2064 6566 6175   provided, defau
-0003a390: 6c74 7320 746f 2061 6767 7265 6761 7465  lts to aggregate
-0003a3a0: 2e0a 2020 2020 244d 4554 410a 2020 2020  ..    $META.    
-0003a3b0: 746f 6b65 6e20 3a20 7374 722c 206f 7074  token : str, opt
-0003a3c0: 696f 6e61 6c0a 2020 2020 2020 2020 5468  ional.        Th
-0003a3d0: 6520 6e61 6d65 2074 6f20 7573 6520 666f  e name to use fo
-0003a3e0: 7220 7468 6520 6f75 7470 7574 206b 6579  r the output key
-0003a3f0: 732e 0a20 2020 2063 6875 6e6b 5f6b 7761  s..    chunk_kwa
-0003a400: 7267 7320 3a20 6469 6374 2c20 6f70 7469  rgs : dict, opti
-0003a410: 6f6e 616c 0a20 2020 2020 2020 204b 6579  onal.        Key
-0003a420: 776f 7264 7320 666f 7220 7468 6520 6368  words for the ch
-0003a430: 756e 6b20 6675 6e63 7469 6f6e 206f 6e6c  unk function onl
-0003a440: 792e 0a20 2020 2061 6767 7265 6761 7465  y..    aggregate
-0003a450: 5f6b 7761 7267 7320 3a20 6469 6374 2c20  _kwargs : dict, 
-0003a460: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-0003a470: 204b 6579 776f 7264 7320 666f 7220 7468   Keywords for th
-0003a480: 6520 6167 6772 6567 6174 6520 6675 6e63  e aggregate func
-0003a490: 7469 6f6e 206f 6e6c 792e 0a20 2020 2063  tion only..    c
-0003a4a0: 6f6d 6269 6e65 5f6b 7761 7267 7320 3a20  ombine_kwargs : 
-0003a4b0: 6469 6374 2c20 6f70 7469 6f6e 616c 0a20  dict, optional. 
-0003a4c0: 2020 2020 2020 204b 6579 776f 7264 7320         Keywords 
-0003a4d0: 666f 7220 7468 6520 636f 6d62 696e 6520  for the combine 
+00036530: 2020 2063 6f75 6e74 3d70 7072 696e 745f     count=pprint_
+00036540: 7468 696e 6728 636f 756e 7429 2c0a 2020  thing(count),.  
+00036550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036560: 2020 6474 7970 653d 7070 7269 6e74 5f74    dtype=pprint_t
+00036570: 6869 6e67 2864 7479 7065 292c 0a20 2020  hing(dtype),.   
+00036580: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00036590: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000365a0: 6f72 2069 2c20 286e 616d 652c 2063 6f75  or i, (name, cou
+000365b0: 6e74 2c20 6474 7970 6529 2069 6e20 656e  nt, dtype) in en
+000365c0: 756d 6572 6174 6528 0a20 2020 2020 2020  umerate(.       
+000365d0: 2020 2020 2020 2020 2020 2020 207a 6970               zip
+000365e0: 2873 656c 662e 636f 6c75 6d6e 732c 2063  (self.columns, c
+000365f0: 6f75 6e74 732c 2073 656c 662e 6474 7970  ounts, self.dtyp
+00036600: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
+00036610: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00036620: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
+00036630: 6c69 6e65 732e 6578 7465 6e64 2868 6561  lines.extend(hea
+00036640: 6465 722e 7370 6c69 7428 225c 6e22 2929  der.split("\n"))
+00036650: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00036660: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+00036670: 6e5f 696e 666f 203d 205b 696e 6465 785f  n_info = [index_
+00036680: 7375 6d6d 6172 7928 7365 6c66 2e63 6f6c  summary(self.col
+00036690: 756d 6e73 2c20 6e61 6d65 3d22 436f 6c75  umns, name="Colu
+000366a0: 6d6e 7322 295d 0a0a 2020 2020 2020 2020  mns")]..        
+000366b0: 6c69 6e65 732e 6578 7465 6e64 2863 6f6c  lines.extend(col
+000366c0: 756d 6e5f 696e 666f 290a 2020 2020 2020  umn_info).      
+000366d0: 2020 6474 7970 655f 636f 756e 7473 203d    dtype_counts =
+000366e0: 205b 0a20 2020 2020 2020 2020 2020 2022   [.            "
+000366f0: 2573 2825 6429 2220 2520 6b20 666f 7220  %s(%d)" % k for 
+00036700: 6b20 696e 2073 6f72 7465 6428 7365 6c66  k in sorted(self
+00036710: 2e64 7479 7065 732e 7661 6c75 655f 636f  .dtypes.value_co
+00036720: 756e 7473 2829 2e69 7465 6d73 2829 2c20  unts().items(), 
+00036730: 6b65 793d 7374 7229 0a20 2020 2020 2020  key=str).       
+00036740: 205d 0a20 2020 2020 2020 206c 696e 6573   ].        lines
+00036750: 2e61 7070 656e 6428 2264 7479 7065 733a  .append("dtypes:
+00036760: 207b 7d22 2e66 6f72 6d61 7428 222c 2022   {}".format(", "
+00036770: 2e6a 6f69 6e28 6474 7970 655f 636f 756e  .join(dtype_coun
+00036780: 7473 2929 290a 0a20 2020 2020 2020 2069  ts)))..        i
+00036790: 6620 6d65 6d6f 7279 5f75 7361 6765 3a0a  f memory_usage:.
+000367a0: 2020 2020 2020 2020 2020 2020 6d65 6d6f              memo
+000367b0: 7279 5f69 6e74 203d 2063 6f6d 7075 7461  ry_int = computa
+000367c0: 7469 6f6e 735b 226d 656d 6f72 795f 7573  tions["memory_us
+000367d0: 6167 6522 5d2e 7375 6d28 290a 2020 2020  age"].sum().    
+000367e0: 2020 2020 2020 2020 6c69 6e65 732e 6170          lines.ap
+000367f0: 7065 6e64 2866 226d 656d 6f72 7920 7573  pend(f"memory us
+00036800: 6167 653a 207b 6d65 6d6f 7279 5f72 6570  age: {memory_rep
+00036810: 7228 6d65 6d6f 7279 5f69 6e74 297d 5c6e  r(memory_int)}\n
+00036820: 2229 0a0a 2020 2020 2020 2020 7075 745f  ")..        put_
+00036830: 6c69 6e65 7328 6275 662c 206c 696e 6573  lines(buf, lines
+00036840: 290a 0a20 2020 2040 6465 7269 7665 645f  )..    @derived_
+00036850: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+00036860: 6529 0a20 2020 2064 6566 206d 656d 6f72  e).    def memor
+00036870: 795f 7573 6167 6528 7365 6c66 2c20 696e  y_usage(self, in
+00036880: 6465 783d 5472 7565 2c20 6465 6570 3d46  dex=True, deep=F
+00036890: 616c 7365 293a 0a20 2020 2020 2020 2072  alse):.        r
+000368a0: 6573 756c 7420 3d20 7365 6c66 2e6d 6170  esult = self.map
+000368b0: 5f70 6172 7469 7469 6f6e 7328 4d2e 6d65  _partitions(M.me
+000368c0: 6d6f 7279 5f75 7361 6765 2c20 696e 6465  mory_usage, inde
+000368d0: 783d 696e 6465 782c 2064 6565 703d 6465  x=index, deep=de
+000368e0: 6570 290a 2020 2020 2020 2020 7265 7375  ep).        resu
+000368f0: 6c74 203d 2072 6573 756c 742e 6772 6f75  lt = result.grou
+00036900: 7062 7928 7265 7375 6c74 2e69 6e64 6578  pby(result.index
+00036910: 292e 7375 6d28 290a 2020 2020 2020 2020  ).sum().        
+00036920: 7265 7475 726e 2072 6573 756c 740a 0a20  return result.. 
+00036930: 2020 2064 6566 2070 6976 6f74 5f74 6162     def pivot_tab
+00036940: 6c65 2873 656c 662c 2069 6e64 6578 3d4e  le(self, index=N
+00036950: 6f6e 652c 2063 6f6c 756d 6e73 3d4e 6f6e  one, columns=Non
+00036960: 652c 2076 616c 7565 733d 4e6f 6e65 2c20  e, values=None, 
+00036970: 6167 6766 756e 633d 226d 6561 6e22 293a  aggfunc="mean"):
+00036980: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00036990: 2020 2020 2043 7265 6174 6520 6120 7370       Create a sp
+000369a0: 7265 6164 7368 6565 742d 7374 796c 6520  readsheet-style 
+000369b0: 7069 766f 7420 7461 626c 6520 6173 2061  pivot table as a
+000369c0: 2044 6174 6146 7261 6d65 2e20 5461 7267   DataFrame. Targ
+000369d0: 6574 2060 6063 6f6c 756d 6e73 6060 0a20  et ``columns``. 
+000369e0: 2020 2020 2020 206d 7573 7420 6861 7665         must have
+000369f0: 2063 6174 6567 6f72 7920 6474 7970 6520   category dtype 
+00036a00: 746f 2069 6e66 6572 2072 6573 756c 7427  to infer result'
+00036a10: 7320 6060 636f 6c75 6d6e 7360 602e 0a20  s ``columns``.. 
+00036a20: 2020 2020 2020 2060 6069 6e64 6578 6060         ``index``
+00036a30: 2c20 6060 636f 6c75 6d6e 7360 602c 2060  , ``columns``, `
+00036a40: 6076 616c 7565 7360 6020 616e 6420 6060  `values`` and ``
+00036a50: 6167 6766 756e 6360 6020 6d75 7374 2062  aggfunc`` must b
+00036a60: 6520 616c 6c20 7363 616c 6172 2e0a 0a20  e all scalar... 
+00036a70: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00036a80: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00036a90: 2d2d 2d2d 0a20 2020 2020 2020 2076 616c  ----.        val
+00036aa0: 7565 7320 3a20 7363 616c 6172 0a20 2020  ues : scalar.   
+00036ab0: 2020 2020 2020 2020 2063 6f6c 756d 6e20           column 
+00036ac0: 746f 2061 6767 7265 6761 7465 0a20 2020  to aggregate.   
+00036ad0: 2020 2020 2069 6e64 6578 203a 2073 6361       index : sca
+00036ae0: 6c61 720a 2020 2020 2020 2020 2020 2020  lar.            
+00036af0: 636f 6c75 6d6e 2074 6f20 6265 2069 6e64  column to be ind
+00036b00: 6578 0a20 2020 2020 2020 2063 6f6c 756d  ex.        colum
+00036b10: 6e73 203a 2073 6361 6c61 720a 2020 2020  ns : scalar.    
+00036b20: 2020 2020 2020 2020 636f 6c75 6d6e 2074          column t
+00036b30: 6f20 6265 2063 6f6c 756d 6e73 0a20 2020  o be columns.   
+00036b40: 2020 2020 2061 6767 6675 6e63 203a 207b       aggfunc : {
+00036b50: 276d 6561 6e27 2c20 2773 756d 272c 2027  'mean', 'sum', '
+00036b60: 636f 756e 7427 7d2c 2064 6566 6175 6c74  count'}, default
+00036b70: 2027 6d65 616e 270a 0a20 2020 2020 2020   'mean'..       
+00036b80: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+00036b90: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00036ba0: 2074 6162 6c65 203a 2044 6174 6146 7261   table : DataFra
+00036bb0: 6d65 0a20 2020 2020 2020 2022 2222 0a20  me.        """. 
+00036bc0: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
+00036bd0: 2e64 6174 6166 7261 6d65 2e72 6573 6861  .dataframe.resha
+00036be0: 7065 2069 6d70 6f72 7420 7069 766f 745f  pe import pivot_
+00036bf0: 7461 626c 650a 0a20 2020 2020 2020 2072  table..        r
+00036c00: 6574 7572 6e20 7069 766f 745f 7461 626c  eturn pivot_tabl
+00036c10: 6528 0a20 2020 2020 2020 2020 2020 2073  e(.            s
+00036c20: 656c 662c 2069 6e64 6578 3d69 6e64 6578  elf, index=index
+00036c30: 2c20 636f 6c75 6d6e 733d 636f 6c75 6d6e  , columns=column
+00036c40: 732c 2076 616c 7565 733d 7661 6c75 6573  s, values=values
+00036c50: 2c20 6167 6766 756e 633d 6167 6766 756e  , aggfunc=aggfun
+00036c60: 630a 2020 2020 2020 2020 290a 0a20 2020  c.        )..   
+00036c70: 2064 6566 206d 656c 7428 0a20 2020 2020   def melt(.     
+00036c80: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00036c90: 2069 645f 7661 7273 3d4e 6f6e 652c 0a20   id_vars=None,. 
+00036ca0: 2020 2020 2020 2076 616c 7565 5f76 6172         value_var
+00036cb0: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
+00036cc0: 7661 725f 6e61 6d65 3d4e 6f6e 652c 0a20  var_name=None,. 
+00036cd0: 2020 2020 2020 2076 616c 7565 5f6e 616d         value_nam
+00036ce0: 653d 2276 616c 7565 222c 0a20 2020 2020  e="value",.     
+00036cf0: 2020 2063 6f6c 5f6c 6576 656c 3d4e 6f6e     col_level=Non
+00036d00: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+00036d10: 2020 2222 220a 2020 2020 2020 2020 556e    """.        Un
+00036d20: 7069 766f 7473 2061 2044 6174 6146 7261  pivots a DataFra
+00036d30: 6d65 2066 726f 6d20 7769 6465 2066 6f72  me from wide for
+00036d40: 6d61 7420 746f 206c 6f6e 6720 666f 726d  mat to long form
+00036d50: 6174 2c0a 2020 2020 2020 2020 6f70 7469  at,.        opti
+00036d60: 6f6e 616c 6c79 206c 6561 7669 6e67 2069  onally leaving i
+00036d70: 6465 6e74 6966 6965 7220 7661 7269 6162  dentifier variab
+00036d80: 6c65 7320 7365 742e 0a0a 2020 2020 2020  les set...      
+00036d90: 2020 5468 6973 2066 756e 6374 696f 6e20    This function 
+00036da0: 6973 2075 7365 6675 6c20 746f 206d 6173  is useful to mas
+00036db0: 7361 6765 2061 2044 6174 6146 7261 6d65  sage a DataFrame
+00036dc0: 2069 6e74 6f20 6120 666f 726d 6174 2077   into a format w
+00036dd0: 6865 7265 0a20 2020 2020 2020 206f 6e65  here.        one
+00036de0: 206f 7220 6d6f 7265 2063 6f6c 756d 6e73   or more columns
+00036df0: 2061 7265 2069 6465 6e74 6966 6965 7220   are identifier 
+00036e00: 7661 7269 6162 6c65 7320 2860 6069 645f  variables (``id_
+00036e10: 7661 7273 6060 292c 2077 6869 6c65 0a20  vars``), while. 
+00036e20: 2020 2020 2020 2061 6c6c 206f 7468 6572         all other
+00036e30: 2063 6f6c 756d 6e73 2c20 636f 6e73 6964   columns, consid
+00036e40: 6572 6564 206d 6561 7375 7265 6420 7661  ered measured va
+00036e50: 7269 6162 6c65 7320 2860 6076 616c 7565  riables (``value
+00036e60: 5f76 6172 7360 6029 2c0a 2020 2020 2020  _vars``),.      
+00036e70: 2020 6172 6520 2275 6e70 6976 6f74 6564    are "unpivoted
+00036e80: 2220 746f 2074 6865 2072 6f77 2061 7869  " to the row axi
+00036e90: 732c 206c 6561 7669 6e67 206a 7573 7420  s, leaving just 
+00036ea0: 7477 6f20 6e6f 6e2d 6964 656e 7469 6669  two non-identifi
+00036eb0: 6572 0a20 2020 2020 2020 2063 6f6c 756d  er.        colum
+00036ec0: 6e73 2c20 2776 6172 6961 626c 6527 2061  ns, 'variable' a
+00036ed0: 6e64 2027 7661 6c75 6527 2e0a 0a20 2020  nd 'value'...   
+00036ee0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+00036ef0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00036f00: 2d2d 0a20 2020 2020 2020 2066 7261 6d65  --.        frame
+00036f10: 203a 2044 6174 6146 7261 6d65 0a20 2020   : DataFrame.   
+00036f20: 2020 2020 2069 645f 7661 7273 203a 2074       id_vars : t
+00036f30: 7570 6c65 2c20 6c69 7374 2c20 6f72 206e  uple, list, or n
+00036f40: 6461 7272 6179 2c20 6f70 7469 6f6e 616c  darray, optional
+00036f50: 0a20 2020 2020 2020 2020 2020 2043 6f6c  .            Col
+00036f60: 756d 6e28 7329 2074 6f20 7573 6520 6173  umn(s) to use as
+00036f70: 2069 6465 6e74 6966 6965 7220 7661 7269   identifier vari
+00036f80: 6162 6c65 732e 0a20 2020 2020 2020 2076  ables..        v
+00036f90: 616c 7565 5f76 6172 7320 3a20 7475 706c  alue_vars : tupl
+00036fa0: 652c 206c 6973 742c 206f 7220 6e64 6172  e, list, or ndar
+00036fb0: 7261 792c 206f 7074 696f 6e61 6c0a 2020  ray, optional.  
+00036fc0: 2020 2020 2020 2020 2020 436f 6c75 6d6e            Column
+00036fd0: 2873 2920 746f 2075 6e70 6976 6f74 2e20  (s) to unpivot. 
+00036fe0: 4966 206e 6f74 2073 7065 6369 6669 6564  If not specified
+00036ff0: 2c20 7573 6573 2061 6c6c 2063 6f6c 756d  , uses all colum
+00037000: 6e73 2074 6861 740a 2020 2020 2020 2020  ns that.        
+00037010: 2020 2020 6172 6520 6e6f 7420 7365 7420      are not set 
+00037020: 6173 2060 6964 5f76 6172 7360 2e0a 2020  as `id_vars`..  
+00037030: 2020 2020 2020 7661 725f 6e61 6d65 203a        var_name :
+00037040: 2073 6361 6c61 720a 2020 2020 2020 2020   scalar.        
+00037050: 2020 2020 4e61 6d65 2074 6f20 7573 6520      Name to use 
+00037060: 666f 7220 7468 6520 2776 6172 6961 626c  for the 'variabl
+00037070: 6527 2063 6f6c 756d 6e2e 2049 6620 4e6f  e' column. If No
+00037080: 6e65 2069 7420 7573 6573 0a20 2020 2020  ne it uses.     
+00037090: 2020 2020 2020 2060 6066 7261 6d65 2e63         ``frame.c
+000370a0: 6f6c 756d 6e73 2e6e 616d 6560 6020 6f72  olumns.name`` or
+000370b0: 2027 7661 7269 6162 6c65 272e 0a20 2020   'variable'..   
+000370c0: 2020 2020 2076 616c 7565 5f6e 616d 6520       value_name 
+000370d0: 3a20 7363 616c 6172 2c20 6465 6661 756c  : scalar, defaul
+000370e0: 7420 2776 616c 7565 270a 2020 2020 2020  t 'value'.      
+000370f0: 2020 2020 2020 4e61 6d65 2074 6f20 7573        Name to us
+00037100: 6520 666f 7220 7468 6520 2776 616c 7565  e for the 'value
+00037110: 2720 636f 6c75 6d6e 2e0a 2020 2020 2020  ' column..      
+00037120: 2020 636f 6c5f 6c65 7665 6c20 3a20 696e    col_level : in
+00037130: 7420 6f72 2073 7472 696e 672c 206f 7074  t or string, opt
+00037140: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00037150: 2020 4966 2063 6f6c 756d 6e73 2061 7265    If columns are
+00037160: 2061 204d 756c 7469 496e 6465 7820 7468   a MultiIndex th
+00037170: 656e 2075 7365 2074 6869 7320 6c65 7665  en use this leve
+00037180: 6c20 746f 206d 656c 742e 0a0a 2020 2020  l to melt...    
+00037190: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+000371a0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+000371b0: 2020 2020 4461 7461 4672 616d 650a 2020      DataFrame.  
+000371c0: 2020 2020 2020 2020 2020 556e 7069 766f            Unpivo
+000371d0: 7465 6420 4461 7461 4672 616d 652e 0a0a  ted DataFrame...
+000371e0: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
+000371f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00037200: 2d0a 2020 2020 2020 2020 7061 6e64 6173  -.        pandas
+00037210: 2e44 6174 6146 7261 6d65 2e6d 656c 740a  .DataFrame.melt.
+00037220: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00037230: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
+00037240: 7461 6672 616d 652e 7265 7368 6170 6520  taframe.reshape 
+00037250: 696d 706f 7274 206d 656c 740a 0a20 2020  import melt..   
+00037260: 2020 2020 2072 6574 7572 6e20 6d65 6c74       return melt
+00037270: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+00037280: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
+00037290: 6964 5f76 6172 733d 6964 5f76 6172 732c  id_vars=id_vars,
+000372a0: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
+000372b0: 7565 5f76 6172 733d 7661 6c75 655f 7661  ue_vars=value_va
+000372c0: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
+000372d0: 7661 725f 6e61 6d65 3d76 6172 5f6e 616d  var_name=var_nam
+000372e0: 652c 0a20 2020 2020 2020 2020 2020 2076  e,.            v
+000372f0: 616c 7565 5f6e 616d 653d 7661 6c75 655f  alue_name=value_
+00037300: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+00037310: 2020 636f 6c5f 6c65 7665 6c3d 636f 6c5f    col_level=col_
+00037320: 6c65 7665 6c2c 0a20 2020 2020 2020 2029  level,.        )
+00037330: 0a0a 2020 2020 6465 6620 746f 5f72 6563  ..    def to_rec
+00037340: 6f72 6473 2873 656c 662c 2069 6e64 6578  ords(self, index
+00037350: 3d46 616c 7365 2c20 6c65 6e67 7468 733d  =False, lengths=
+00037360: 4e6f 6e65 293a 0a20 2020 2020 2020 2066  None):.        f
+00037370: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
+00037380: 6d65 2e69 6f20 696d 706f 7274 2074 6f5f  me.io import to_
+00037390: 7265 636f 7264 730a 0a20 2020 2020 2020  records..       
+000373a0: 2069 6620 6c65 6e67 7468 7320 6973 2054   if lengths is T
+000373b0: 7275 653a 0a20 2020 2020 2020 2020 2020  rue:.           
+000373c0: 206c 656e 6774 6873 203d 2074 7570 6c65   lengths = tuple
+000373d0: 2873 656c 662e 6d61 705f 7061 7274 6974  (self.map_partit
+000373e0: 696f 6e73 286c 656e 292e 636f 6d70 7574  ions(len).comput
+000373f0: 6528 2929 0a0a 2020 2020 2020 2020 7265  e())..        re
+00037400: 636f 7264 7320 3d20 746f 5f72 6563 6f72  cords = to_recor
+00037410: 6473 2873 656c 6629 0a0a 2020 2020 2020  ds(self)..      
+00037420: 2020 6368 756e 6b73 203d 2073 656c 662e    chunks = self.
+00037430: 5f76 616c 6964 6174 655f 6368 756e 6b73  _validate_chunks
+00037440: 2872 6563 6f72 6473 2c20 6c65 6e67 7468  (records, length
+00037450: 7329 0a20 2020 2020 2020 2072 6563 6f72  s).        recor
+00037460: 6473 2e5f 6368 756e 6b73 203d 2028 6368  ds._chunks = (ch
+00037470: 756e 6b73 5b30 5d2c 290a 0a20 2020 2020  unks[0],)..     
+00037480: 2020 2072 6574 7572 6e20 7265 636f 7264     return record
+00037490: 730a 0a20 2020 2040 6465 7269 7665 645f  s..    @derived_
+000374a0: 6672 6f6d 2870 642e 4461 7461 4672 616d  from(pd.DataFram
+000374b0: 6529 0a20 2020 2064 6566 2074 6f5f 6874  e).    def to_ht
+000374c0: 6d6c 2873 656c 662c 206d 6178 5f72 6f77  ml(self, max_row
+000374d0: 733d 3529 3a0a 2020 2020 2020 2020 2320  s=5):.        # 
+000374e0: 7064 2e53 6572 6965 7320 646f 6573 6e27  pd.Series doesn'
+000374f0: 7420 6861 7665 2068 746d 6c20 7265 7072  t have html repr
+00037500: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
+00037510: 7365 6c66 2e5f 7265 7072 5f64 6174 6128  self._repr_data(
+00037520: 292e 746f 5f68 746d 6c28 6d61 785f 726f  ).to_html(max_ro
+00037530: 7773 3d6d 6178 5f72 6f77 732c 2073 686f  ws=max_rows, sho
+00037540: 775f 6469 6d65 6e73 696f 6e73 3d46 616c  w_dimensions=Fal
+00037550: 7365 290a 2020 2020 2020 2020 7265 7475  se).        retu
+00037560: 726e 2067 6574 5f74 656d 706c 6174 6528  rn get_template(
+00037570: 2264 6174 6166 7261 6d65 2e68 746d 6c2e  "dataframe.html.
+00037580: 6a32 2229 2e72 656e 6465 7228 0a20 2020  j2").render(.   
+00037590: 2020 2020 2020 2020 2064 6174 613d 6461           data=da
+000375a0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+000375b0: 6e61 6d65 3d73 656c 662e 5f6e 616d 652c  name=self._name,
+000375c0: 0a20 2020 2020 2020 2020 2020 206c 6179  .            lay
+000375d0: 6572 733d 6d61 7962 655f 706c 7572 616c  ers=maybe_plural
+000375e0: 697a 6528 6c65 6e28 7365 6c66 2e64 6173  ize(len(self.das
+000375f0: 6b2e 6c61 7965 7273 292c 2022 6772 6170  k.layers), "grap
+00037600: 6820 6c61 7965 7222 292c 0a20 2020 2020  h layer"),.     
+00037610: 2020 2029 0a0a 2020 2020 6465 6620 5f72     )..    def _r
+00037620: 6570 725f 6461 7461 2873 656c 6629 3a0a  epr_data(self):.
+00037630: 2020 2020 2020 2020 6d65 7461 203d 2073          meta = s
+00037640: 656c 662e 5f6d 6574 610a 2020 2020 2020  elf._meta.      
+00037650: 2020 696e 6465 7820 3d20 7365 6c66 2e5f    index = self._
+00037660: 7265 7072 5f64 6976 6973 696f 6e73 0a20  repr_divisions. 
+00037670: 2020 2020 2020 2063 6f6c 7320 3d20 6d65         cols = me
+00037680: 7461 2e63 6f6c 756d 6e73 0a20 2020 2020  ta.columns.     
+00037690: 2020 2069 6620 6c65 6e28 636f 6c73 2920     if len(cols) 
+000376a0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
+000376b0: 2020 7365 7269 6573 5f64 6620 3d20 7064    series_df = pd
+000376c0: 2e44 6174 6146 7261 6d65 285b 5b5d 5d20  .DataFrame([[]] 
+000376d0: 2a20 6c65 6e28 696e 6465 7829 2c20 636f  * len(index), co
+000376e0: 6c75 6d6e 733d 636f 6c73 2c20 696e 6465  lumns=cols, inde
+000376f0: 783d 696e 6465 7829 0a20 2020 2020 2020  x=index).       
+00037700: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00037710: 2020 2073 6572 6965 735f 6466 203d 2070     series_df = p
+00037720: 642e 636f 6e63 6174 280a 2020 2020 2020  d.concat(.      
+00037730: 2020 2020 2020 2020 2020 5b5f 7265 7072            [_repr
+00037740: 5f64 6174 615f 7365 7269 6573 2873 2c20  _data_series(s, 
+00037750: 696e 6465 783d 696e 6465 7829 2066 6f72  index=index) for
+00037760: 205f 2c20 7320 696e 206d 6574 612e 6974   _, s in meta.it
+00037770: 656d 7328 295d 2c20 6178 6973 3d31 0a20  ems()], axis=1. 
+00037780: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00037790: 2020 2020 2072 6574 7572 6e20 7365 7269       return seri
+000377a0: 6573 5f64 660a 0a20 2020 2064 6566 205f  es_df..    def _
+000377b0: 7265 7072 5f68 746d 6c5f 2873 656c 6629  repr_html_(self)
+000377c0: 3a0a 2020 2020 2020 2020 6461 7461 203d  :.        data =
+000377d0: 2073 656c 662e 5f72 6570 725f 6461 7461   self._repr_data
+000377e0: 2829 2e74 6f5f 6874 6d6c 280a 2020 2020  ().to_html(.    
+000377f0: 2020 2020 2020 2020 6d61 785f 726f 7773          max_rows
+00037800: 3d35 2c20 7368 6f77 5f64 696d 656e 7369  =5, show_dimensi
+00037810: 6f6e 733d 4661 6c73 652c 206e 6f74 6562  ons=False, noteb
+00037820: 6f6f 6b3d 5472 7565 0a20 2020 2020 2020  ook=True.       
+00037830: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
+00037840: 6e20 6765 745f 7465 6d70 6c61 7465 2822  n get_template("
+00037850: 6461 7461 6672 616d 652e 6874 6d6c 2e6a  dataframe.html.j
+00037860: 3222 292e 7265 6e64 6572 280a 2020 2020  2").render(.    
+00037870: 2020 2020 2020 2020 6461 7461 3d64 6174          data=dat
+00037880: 612c 0a20 2020 2020 2020 2020 2020 206e  a,.            n
+00037890: 616d 653d 7365 6c66 2e5f 6e61 6d65 2c0a  ame=self._name,.
+000378a0: 2020 2020 2020 2020 2020 2020 6c61 7965              laye
+000378b0: 7273 3d6d 6179 6265 5f70 6c75 7261 6c69  rs=maybe_plurali
+000378c0: 7a65 286c 656e 2873 656c 662e 6461 736b  ze(len(self.dask
+000378d0: 2e6c 6179 6572 7329 2c20 2267 7261 7068  .layers), "graph
+000378e0: 206c 6179 6572 2229 2c0a 2020 2020 2020   layer"),.      
+000378f0: 2020 290a 0a20 2020 2064 6566 205f 7365    )..    def _se
+00037900: 6c65 6374 5f63 6f6c 756d 6e73 5f6f 725f  lect_columns_or_
+00037910: 696e 6465 7828 7365 6c66 2c20 636f 6c75  index(self, colu
+00037920: 6d6e 735f 6f72 5f69 6e64 6578 293a 0a20  mns_or_index):. 
+00037930: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00037940: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00037950: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00037960: 0a20 2020 2020 2020 2063 6f6c 756d 6e73  .        columns
+00037970: 5f6f 725f 696e 6465 780a 2020 2020 2020  _or_index.      
+00037980: 2020 2020 2020 436f 6c75 6d6e 206f 7220        Column or 
+00037990: 696e 6465 7820 6e61 6d65 2c20 6f72 2061  index name, or a
+000379a0: 206c 6973 7420 6f66 2074 6865 7365 0a0a   list of these..
+000379b0: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
+000379c0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+000379d0: 2020 2020 2020 2020 6464 2e44 6174 6146          dd.DataF
+000379e0: 7261 6d65 0a20 2020 2020 2020 2020 2020  rame.           
+000379f0: 2044 6173 6b20 4461 7461 4672 616d 6520   Dask DataFrame 
+00037a00: 7769 7468 2063 6f6c 756d 6e73 2063 6f72  with columns cor
+00037a10: 7265 7370 6f6e 6469 6e67 2074 6f20 6561  responding to ea
+00037a20: 6368 2063 6f6c 756d 6e20 6f72 0a20 2020  ch column or.   
+00037a30: 2020 2020 2020 2020 2069 6e64 6578 206c           index l
+00037a40: 6576 656c 2069 6e20 636f 6c75 6d6e 735f  evel in columns_
+00037a50: 6f72 5f69 6e64 6578 2e20 2049 6620 696e  or_index.  If in
+00037a60: 636c 7564 6564 2c20 7468 6520 636f 6c75  cluded, the colu
+00037a70: 6d6e 0a20 2020 2020 2020 2020 2020 2063  mn.            c
+00037a80: 6f72 7265 7370 6f6e 6469 6e67 2074 6f20  orresponding to 
+00037a90: 7468 6520 696e 6465 7820 6c65 7665 6c20  the index level 
+00037aa0: 6973 206e 616d 6564 205f 696e 6465 780a  is named _index.
+00037ab0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+00037ac0: 2020 2020 2023 2045 6e73 7572 6520 636f       # Ensure co
+00037ad0: 6c75 6d6e 735f 6f72 5f69 6e64 6578 2069  lumns_or_index i
+00037ae0: 7320 6120 6c69 7374 0a20 2020 2020 2020  s a list.       
+00037af0: 2063 6f6c 756d 6e73 5f6f 725f 696e 6465   columns_or_inde
+00037b00: 7820 3d20 280a 2020 2020 2020 2020 2020  x = (.          
+00037b10: 2020 636f 6c75 6d6e 735f 6f72 5f69 6e64    columns_or_ind
+00037b20: 6578 0a20 2020 2020 2020 2020 2020 2069  ex.            i
+00037b30: 6620 6973 696e 7374 616e 6365 2863 6f6c  f isinstance(col
+00037b40: 756d 6e73 5f6f 725f 696e 6465 782c 206c  umns_or_index, l
+00037b50: 6973 7429 0a20 2020 2020 2020 2020 2020  ist).           
+00037b60: 2065 6c73 6520 5b63 6f6c 756d 6e73 5f6f   else [columns_o
+00037b70: 725f 696e 6465 785d 0a20 2020 2020 2020  r_index].       
+00037b80: 2029 0a0a 2020 2020 2020 2020 636f 6c75   )..        colu
+00037b90: 6d6e 5f6e 616d 6573 203d 205b 0a20 2020  mn_names = [.   
+00037ba0: 2020 2020 2020 2020 206e 2066 6f72 206e           n for n
+00037bb0: 2069 6e20 636f 6c75 6d6e 735f 6f72 5f69   in columns_or_i
+00037bc0: 6e64 6578 2069 6620 7365 6c66 2e5f 6973  ndex if self._is
+00037bd0: 5f63 6f6c 756d 6e5f 6c61 6265 6c5f 7265  _column_label_re
+00037be0: 6665 7265 6e63 6528 6e29 0a20 2020 2020  ference(n).     
+00037bf0: 2020 205d 0a0a 2020 2020 2020 2020 7365     ]..        se
+00037c00: 6c65 6374 6564 5f64 6620 3d20 7365 6c66  lected_df = self
+00037c10: 5b63 6f6c 756d 6e5f 6e61 6d65 735d 0a20  [column_names]. 
+00037c20: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+00037c30: 636f 6e74 6169 6e73 5f69 6e64 6578 5f6e  contains_index_n
+00037c40: 616d 6528 636f 6c75 6d6e 735f 6f72 5f69  ame(columns_or_i
+00037c50: 6e64 6578 293a 0a20 2020 2020 2020 2020  ndex):.         
+00037c60: 2020 2023 2049 6e64 6578 206e 616d 6520     # Index name 
+00037c70: 7761 7320 696e 636c 7564 6564 0a20 2020  was included.   
+00037c80: 2020 2020 2020 2020 2073 656c 6563 7465           selecte
+00037c90: 645f 6466 203d 2073 656c 6563 7465 645f  d_df = selected_
+00037ca0: 6466 2e61 7373 6967 6e28 5f69 6e64 6578  df.assign(_index
+00037cb0: 3d73 656c 662e 696e 6465 7829 0a0a 2020  =self.index)..  
+00037cc0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00037cd0: 6563 7465 645f 6466 0a0a 2020 2020 6465  ected_df..    de
+00037ce0: 6620 5f69 735f 636f 6c75 6d6e 5f6c 6162  f _is_column_lab
+00037cf0: 656c 5f72 6566 6572 656e 6365 2873 656c  el_reference(sel
+00037d00: 662c 206b 6579 293a 0a20 2020 2020 2020  f, key):.       
+00037d10: 2022 2222 0a20 2020 2020 2020 2054 6573   """.        Tes
+00037d20: 7420 7768 6574 6865 7220 6120 6b65 7920  t whether a key 
+00037d30: 6973 2061 2063 6f6c 756d 6e20 6c61 6265  is a column labe
+00037d40: 6c20 7265 6665 7265 6e63 650a 0a20 2020  l reference..   
+00037d50: 2020 2020 2054 6f20 6265 2063 6f6e 7369       To be consi
+00037d60: 6465 7265 6420 6120 636f 6c75 6d6e 206c  dered a column l
+00037d70: 6162 656c 2072 6566 6572 656e 6365 2c20  abel reference, 
+00037d80: 606b 6579 6020 6d75 7374 206d 6174 6368  `key` must match
+00037d90: 2074 6865 206e 616d 6520 6f66 2061 740a   the name of at.
+00037da0: 2020 2020 2020 2020 6c65 6173 7420 6f6e          least on
+00037db0: 6520 636f 6c75 6d6e 2e0a 2020 2020 2020  e column..      
+00037dc0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+00037dd0: 7475 726e 2028 0a20 2020 2020 2020 2020  turn (.         
+00037de0: 2020 206e 6f74 2069 735f 6461 736b 5f63     not is_dask_c
+00037df0: 6f6c 6c65 6374 696f 6e28 6b65 7929 0a20  ollection(key). 
+00037e00: 2020 2020 2020 2020 2020 2061 6e64 2028             and (
+00037e10: 6e70 2e69 7373 6361 6c61 7228 6b65 7929  np.isscalar(key)
+00037e20: 206f 7220 6973 696e 7374 616e 6365 286b   or isinstance(k
+00037e30: 6579 2c20 7475 706c 6529 290a 2020 2020  ey, tuple)).    
+00037e40: 2020 2020 2020 2020 616e 6420 6b65 7920          and key 
+00037e50: 696e 2073 656c 662e 636f 6c75 6d6e 730a  in self.columns.
+00037e60: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
+00037e70: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
+00037e80: 6465 6620 6672 6f6d 5f64 6963 7428 0a20  def from_dict(. 
+00037e90: 2020 2020 2020 2063 6c73 2c20 6461 7461         cls, data
+00037ea0: 2c20 2a2c 206e 7061 7274 6974 696f 6e73  , *, npartitions
+00037eb0: 2c20 6f72 6965 6e74 3d22 636f 6c75 6d6e  , orient="column
+00037ec0: 7322 2c20 6474 7970 653d 4e6f 6e65 2c20  s", dtype=None, 
+00037ed0: 636f 6c75 6d6e 733d 4e6f 6e65 0a20 2020  columns=None.   
+00037ee0: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
+00037ef0: 2020 2020 2020 2020 436f 6e73 7472 7563          Construc
+00037f00: 7420 6120 4461 736b 2044 6174 6146 7261  t a Dask DataFra
+00037f10: 6d65 2066 726f 6d20 6120 5079 7468 6f6e  me from a Python
+00037f20: 2044 6963 7469 6f6e 6172 790a 0a20 2020   Dictionary..   
+00037f30: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
+00037f40: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+00037f50: 2020 2020 2020 2064 6173 6b2e 6461 7461         dask.data
+00037f60: 6672 616d 652e 6672 6f6d 5f64 6963 740a  frame.from_dict.
+00037f70: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00037f80: 2020 2020 6672 6f6d 2064 6173 6b2e 6461      from dask.da
+00037f90: 7461 6672 616d 652e 696f 2069 6d70 6f72  taframe.io impor
+00037fa0: 7420 6672 6f6d 5f64 6963 740a 0a20 2020  t from_dict..   
+00037fb0: 2020 2020 2072 6574 7572 6e20 6672 6f6d       return from
+00037fc0: 5f64 6963 7428 0a20 2020 2020 2020 2020  _dict(.         
+00037fd0: 2020 2064 6174 612c 0a20 2020 2020 2020     data,.       
+00037fe0: 2020 2020 206e 7061 7274 6974 696f 6e73       npartitions
+00037ff0: 2c0a 2020 2020 2020 2020 2020 2020 6f72  ,.            or
+00038000: 6965 6e74 3d6f 7269 656e 742c 0a20 2020  ient=orient,.   
+00038010: 2020 2020 2020 2020 2064 7479 7065 3d64           dtype=d
+00038020: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+00038030: 2020 636f 6c75 6d6e 733d 636f 6c75 6d6e    columns=column
+00038040: 732c 0a20 2020 2020 2020 2020 2020 2063  s,.            c
+00038050: 6f6e 7374 7275 6374 6f72 3d63 6c73 2e5f  onstructor=cls._
+00038060: 7061 7274 6974 696f 6e5f 7479 7065 2c0a  partition_type,.
+00038070: 2020 2020 2020 2020 290a 0a0a 2320 6269          )...# bi
+00038080: 6e64 206f 7065 7261 746f 7273 0a23 2054  nd operators.# T
+00038090: 4f44 4f3a 2064 796e 616d 6963 616c 6c79  ODO: dynamically
+000380a0: 2062 6f75 6e64 206f 7065 7261 746f 7273   bound operators
+000380b0: 2061 7265 2064 6566 6561 7469 6e67 2074   are defeating t
+000380c0: 7970 6520 616e 6e6f 7461 7469 6f6e 730a  ype annotations.
+000380d0: 666f 7220 6f70 2069 6e20 5b0a 2020 2020  for op in [.    
+000380e0: 6f70 6572 6174 6f72 2e61 6273 2c0a 2020  operator.abs,.  
+000380f0: 2020 6f70 6572 6174 6f72 2e61 6464 2c0a    operator.add,.
+00038100: 2020 2020 6f70 6572 6174 6f72 2e61 6e64      operator.and
+00038110: 5f2c 0a20 2020 206f 7065 7261 746f 722e  _,.    operator.
+00038120: 6571 2c0a 2020 2020 6f70 6572 6174 6f72  eq,.    operator
+00038130: 2e67 742c 0a20 2020 206f 7065 7261 746f  .gt,.    operato
+00038140: 722e 6765 2c0a 2020 2020 6f70 6572 6174  r.ge,.    operat
+00038150: 6f72 2e69 6e76 2c0a 2020 2020 6f70 6572  or.inv,.    oper
+00038160: 6174 6f72 2e6c 742c 0a20 2020 206f 7065  ator.lt,.    ope
+00038170: 7261 746f 722e 6c65 2c0a 2020 2020 6f70  rator.le,.    op
+00038180: 6572 6174 6f72 2e6d 6f64 2c0a 2020 2020  erator.mod,.    
+00038190: 6f70 6572 6174 6f72 2e6d 756c 2c0a 2020  operator.mul,.  
+000381a0: 2020 6f70 6572 6174 6f72 2e6e 652c 0a20    operator.ne,. 
+000381b0: 2020 206f 7065 7261 746f 722e 6e65 672c     operator.neg,
+000381c0: 0a20 2020 206f 7065 7261 746f 722e 6f72  .    operator.or
+000381d0: 5f2c 0a20 2020 206f 7065 7261 746f 722e  _,.    operator.
+000381e0: 706f 772c 0a20 2020 206f 7065 7261 746f  pow,.    operato
+000381f0: 722e 7375 622c 0a20 2020 206f 7065 7261  r.sub,.    opera
+00038200: 746f 722e 7472 7565 6469 762c 0a20 2020  tor.truediv,.   
+00038210: 206f 7065 7261 746f 722e 666c 6f6f 7264   operator.floord
+00038220: 6976 2c0a 2020 2020 6f70 6572 6174 6f72  iv,.    operator
+00038230: 2e78 6f72 2c0a 5d3a 0a20 2020 205f 4672  .xor,.]:.    _Fr
+00038240: 616d 652e 5f62 696e 645f 6f70 6572 6174  ame._bind_operat
+00038250: 6f72 286f 7029 0a20 2020 2053 6361 6c61  or(op).    Scala
+00038260: 722e 5f62 696e 645f 6f70 6572 6174 6f72  r._bind_operator
+00038270: 286f 7029 0a0a 666f 7220 6e61 6d65 2069  (op)..for name i
+00038280: 6e20 5b0a 2020 2020 2261 6464 222c 0a20  n [.    "add",. 
+00038290: 2020 2022 7375 6222 2c0a 2020 2020 226d     "sub",.    "m
+000382a0: 756c 222c 0a20 2020 2022 6469 7622 2c0a  ul",.    "div",.
+000382b0: 2020 2020 2264 6976 6964 6522 2c0a 2020      "divide",.  
+000382c0: 2020 2274 7275 6564 6976 222c 0a20 2020    "truediv",.   
+000382d0: 2022 666c 6f6f 7264 6976 222c 0a20 2020   "floordiv",.   
+000382e0: 2022 6d6f 6422 2c0a 2020 2020 2270 6f77   "mod",.    "pow
+000382f0: 222c 0a20 2020 2022 7261 6464 222c 0a20  ",.    "radd",. 
+00038300: 2020 2022 7273 7562 222c 0a20 2020 2022     "rsub",.    "
+00038310: 726d 756c 222c 0a20 2020 2022 7264 6976  rmul",.    "rdiv
+00038320: 222c 0a20 2020 2022 7274 7275 6564 6976  ",.    "rtruediv
+00038330: 222c 0a20 2020 2022 7266 6c6f 6f72 6469  ",.    "rfloordi
+00038340: 7622 2c0a 2020 2020 2272 6d6f 6422 2c0a  v",.    "rmod",.
+00038350: 2020 2020 2272 706f 7722 2c0a 5d3a 0a20      "rpow",.]:. 
+00038360: 2020 206d 6574 6820 3d20 6765 7461 7474     meth = getatt
+00038370: 7228 7064 2e44 6174 6146 7261 6d65 2c20  r(pd.DataFrame, 
+00038380: 6e61 6d65 290a 2020 2020 4461 7461 4672  name).    DataFr
+00038390: 616d 652e 5f62 696e 645f 6f70 6572 6174  ame._bind_operat
+000383a0: 6f72 5f6d 6574 686f 6428 6e61 6d65 2c20  or_method(name, 
+000383b0: 6d65 7468 290a 0a20 2020 206d 6574 6820  meth)..    meth 
+000383c0: 3d20 6765 7461 7474 7228 7064 2e53 6572  = getattr(pd.Ser
+000383d0: 6965 732c 206e 616d 6529 0a20 2020 2053  ies, name).    S
+000383e0: 6572 6965 732e 5f62 696e 645f 6f70 6572  eries._bind_oper
+000383f0: 6174 6f72 5f6d 6574 686f 6428 6e61 6d65  ator_method(name
+00038400: 2c20 6d65 7468 290a 0a66 6f72 206e 616d  , meth)..for nam
+00038410: 6520 696e 205b 226c 7422 2c20 2267 7422  e in ["lt", "gt"
+00038420: 2c20 226c 6522 2c20 2267 6522 2c20 226e  , "le", "ge", "n
+00038430: 6522 2c20 2265 7122 5d3a 0a20 2020 206d  e", "eq"]:.    m
+00038440: 6574 6820 3d20 6765 7461 7474 7228 7064  eth = getattr(pd
+00038450: 2e44 6174 6146 7261 6d65 2c20 6e61 6d65  .DataFrame, name
+00038460: 290a 2020 2020 4461 7461 4672 616d 652e  ).    DataFrame.
+00038470: 5f62 696e 645f 636f 6d70 6172 6973 6f6e  _bind_comparison
+00038480: 5f6d 6574 686f 6428 6e61 6d65 2c20 6d65  _method(name, me
+00038490: 7468 290a 0a20 2020 206d 6574 6820 3d20  th)..    meth = 
+000384a0: 6765 7461 7474 7228 7064 2e53 6572 6965  getattr(pd.Serie
+000384b0: 732c 206e 616d 6529 0a20 2020 2053 6572  s, name).    Ser
+000384c0: 6965 732e 5f62 696e 645f 636f 6d70 6172  ies._bind_compar
+000384d0: 6973 6f6e 5f6d 6574 686f 6428 6e61 6d65  ison_method(name
+000384e0: 2c20 6d65 7468 290a 0a0a 6465 6620 6973  , meth)...def is
+000384f0: 5f62 726f 6164 6361 7374 6162 6c65 2864  _broadcastable(d
+00038500: 6673 2c20 7329 3a0a 2020 2020 2222 220a  fs, s):.    """.
+00038510: 2020 2020 5468 6973 2053 6572 6965 7320      This Series 
+00038520: 6973 2062 726f 6164 6361 7374 6162 6c65  is broadcastable
+00038530: 2061 6761 696e 7374 2061 6e6f 7468 6572   against another
+00038540: 2064 6174 6166 7261 6d65 2069 6e20 7468   dataframe in th
+00038550: 6520 7365 7175 656e 6365 0a20 2020 2022  e sequence.    "
+00038560: 2222 0a0a 2020 2020 6465 6620 636f 6d70  ""..    def comp
+00038570: 6172 6528 732c 2064 6629 3a0a 2020 2020  are(s, df):.    
+00038580: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00038590: 2020 2020 2072 6574 7572 6e20 732e 6469       return s.di
+000385a0: 7669 7369 6f6e 7320 3d3d 2028 6466 2e63  visions == (df.c
+000385b0: 6f6c 756d 6e73 2e6d 696e 2829 2c20 6466  olumns.min(), df
+000385c0: 2e63 6f6c 756d 6e73 2e6d 6178 2829 290a  .columns.max()).
+000385d0: 2020 2020 2020 2020 6578 6365 7074 2054          except T
+000385e0: 7970 6545 7272 6f72 3a0a 2020 2020 2020  ypeError:.      
+000385f0: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
+00038600: 7365 0a0a 2020 2020 7265 7475 726e 2028  se..    return (
+00038610: 0a20 2020 2020 2020 2069 7369 6e73 7461  .        isinsta
+00038620: 6e63 6528 732c 2053 6572 6965 7329 0a20  nce(s, Series). 
+00038630: 2020 2020 2020 2061 6e64 2073 2e6e 7061         and s.npa
+00038640: 7274 6974 696f 6e73 203d 3d20 310a 2020  rtitions == 1.  
+00038650: 2020 2020 2020 616e 6420 732e 6b6e 6f77        and s.know
+00038660: 6e5f 6469 7669 7369 6f6e 730a 2020 2020  n_divisions.    
+00038670: 2020 2020 616e 6420 616e 7928 636f 6d70      and any(comp
+00038680: 6172 6528 732c 2064 6629 2066 6f72 2064  are(s, df) for d
+00038690: 6620 696e 2064 6673 2069 6620 6973 696e  f in dfs if isin
+000386a0: 7374 616e 6365 2864 662c 2044 6174 6146  stance(df, DataF
+000386b0: 7261 6d65 2929 0a20 2020 2029 0a0a 0a64  rame)).    )...d
+000386c0: 6566 2065 6c65 6d77 6973 6528 6f70 2c20  ef elemwise(op, 
+000386d0: 2a61 7267 732c 206d 6574 613d 6e6f 5f64  *args, meta=no_d
+000386e0: 6566 6175 6c74 2c20 6f75 743d 4e6f 6e65  efault, out=None
+000386f0: 2c20 7472 616e 7366 6f72 6d5f 6469 7669  , transform_divi
+00038700: 7369 6f6e 733d 5472 7565 2c20 2a2a 6b77  sions=True, **kw
+00038710: 6172 6773 293a 0a20 2020 2022 2222 456c  args):.    """El
+00038720: 656d 656e 7477 6973 6520 6f70 6572 6174  ementwise operat
+00038730: 696f 6e20 666f 7220 4461 736b 2064 6174  ion for Dask dat
+00038740: 6166 7261 6d65 730a 0a20 2020 2050 6172  aframes..    Par
+00038750: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00038760: 2d2d 2d2d 2d2d 0a20 2020 206f 703a 2063  ------.    op: c
+00038770: 616c 6c61 626c 650a 2020 2020 2020 2020  allable.        
+00038780: 4675 6e63 7469 6f6e 2074 6f20 6170 706c  Function to appl
+00038790: 7920 6163 726f 7373 2069 6e70 7574 2064  y across input d
+000387a0: 6174 6166 7261 6d65 730a 2020 2020 2a61  ataframes.    *a
+000387b0: 7267 733a 2044 6174 6146 7261 6d65 732c  rgs: DataFrames,
+000387c0: 2053 6572 6965 732c 2053 6361 6c61 7273   Series, Scalars
+000387d0: 2c20 4172 7261 7973 2c0a 2020 2020 2020  , Arrays,.      
+000387e0: 2020 5468 6520 6172 6775 6d65 6e74 7320    The arguments 
+000387f0: 6f66 2074 6865 206f 7065 7261 7469 6f6e  of the operation
+00038800: 0a20 2020 206d 6574 613a 2070 642e 4461  .    meta: pd.Da
+00038810: 7461 4672 616d 652c 2070 642e 5365 7269  taFrame, pd.Seri
+00038820: 6573 2028 6f70 7469 6f6e 616c 290a 2020  es (optional).  
+00038830: 2020 2020 2020 5661 6c69 6420 6d65 7461        Valid meta
+00038840: 6461 7461 2066 6f72 2074 6865 206f 7065  data for the ope
+00038850: 7261 7469 6f6e 2e20 2057 696c 6c20 6576  ration.  Will ev
+00038860: 616c 7561 7465 206f 6e20 6120 736d 616c  aluate on a smal
+00038870: 6c20 7069 6563 6520 6f66 0a20 2020 2020  l piece of.     
+00038880: 2020 2064 6174 6120 6966 206e 6f74 2070     data if not p
+00038890: 726f 7669 6465 642e 0a20 2020 2074 7261  rovided..    tra
+000388a0: 6e73 666f 726d 5f64 6976 6973 696f 6e73  nsform_divisions
+000388b0: 3a20 626f 6f6c 6561 6e0a 2020 2020 2020  : boolean.      
+000388c0: 2020 4966 2074 6865 2069 6e70 7574 2069    If the input i
+000388d0: 7320 6120 6060 6461 736b 2e64 6174 6166  s a ``dask.dataf
+000388e0: 7261 6d65 2e49 6e64 6578 6060 2077 6520  rame.Index`` we 
+000388f0: 6e6f 726d 616c 6c79 2077 696c 6c20 616c  normally will al
+00038900: 736f 2061 7070 6c79 0a20 2020 2020 2020  so apply.       
+00038910: 2074 6865 2066 756e 6374 696f 6e20 6f6e   the function on
+00038920: 746f 2074 6865 2064 6976 6973 696f 6e73  to the divisions
+00038930: 2061 6e64 2061 7070 6c79 2074 686f 7365   and apply those
+00038940: 2074 7261 6e73 666f 726d 6564 2064 6976   transformed div
+00038950: 6973 696f 6e73 0a20 2020 2020 2020 2074  isions.        t
+00038960: 6f20 7468 6520 6f75 7470 7574 2e20 2059  o the output.  Y
+00038970: 6f75 2063 616e 2070 6173 7320 6060 7472  ou can pass ``tr
+00038980: 616e 7366 6f72 6d5f 6469 7669 7369 6f6e  ansform_division
+00038990: 733d 4661 6c73 6560 6020 746f 206f 7665  s=False`` to ove
+000389a0: 7272 6964 650a 2020 2020 2020 2020 7468  rride.        th
+000389b0: 6973 2062 6568 6176 696f 720a 2020 2020  is behavior.    
+000389c0: 6f75 7420 3a20 6060 6461 736b 2e61 7272  out : ``dask.arr
+000389d0: 6179 6060 206f 7220 6060 4e6f 6e65 6060  ay`` or ``None``
+000389e0: 0a20 2020 2020 2020 2049 6620 6f75 7420  .        If out 
+000389f0: 6973 2061 2064 6173 6b2e 4461 7461 4672  is a dask.DataFr
+00038a00: 616d 652c 2064 6173 6b2e 5365 7269 6573  ame, dask.Series
+00038a10: 206f 7220 6461 736b 2e53 6361 6c61 7220   or dask.Scalar 
+00038a20: 7468 656e 0a20 2020 2020 2020 2074 6869  then.        thi
+00038a30: 7320 6f76 6572 7772 6974 6573 2074 6865  s overwrites the
+00038a40: 2063 6f6e 7465 6e74 7320 6f66 2069 7420   contents of it 
+00038a50: 7769 7468 2074 6865 2072 6573 756c 740a  with the result.
+00038a60: 2020 2020 2a2a 6b77 6172 6773 3a20 7363      **kwargs: sc
+00038a70: 616c 6172 730a 0a20 2020 2045 7861 6d70  alars..    Examp
+00038a80: 6c65 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  les.    --------
+00038a90: 0a20 2020 203e 3e3e 2065 6c65 6d77 6973  .    >>> elemwis
+00038aa0: 6528 6f70 6572 6174 6f72 2e61 6464 2c20  e(operator.add, 
+00038ab0: 6466 2e78 2c20 6466 2e79 2920 2023 2064  df.x, df.y)  # d
+00038ac0: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
+00038ad0: 2020 2222 220a 2020 2020 5f6e 616d 6520    """.    _name 
+00038ae0: 3d20 6675 6e63 6e61 6d65 286f 7029 202b  = funcname(op) +
+00038af0: 2022 2d22 202b 2074 6f6b 656e 697a 6528   "-" + tokenize(
+00038b00: 6f70 2c20 2a61 7267 732c 202a 2a6b 7761  op, *args, **kwa
+00038b10: 7267 7329 0a0a 2020 2020 6172 6773 203d  rgs)..    args =
+00038b20: 205f 6d61 7962 655f 6672 6f6d 5f70 616e   _maybe_from_pan
+00038b30: 6461 7328 6172 6773 290a 0a20 2020 2066  das(args)..    f
+00038b40: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
+00038b50: 6d65 2e6d 756c 7469 2069 6d70 6f72 7420  me.multi import 
+00038b60: 5f6d 6179 6265 5f61 6c69 676e 5f70 6172  _maybe_align_par
+00038b70: 7469 7469 6f6e 730a 0a20 2020 2061 7267  titions..    arg
+00038b80: 7320 3d20 5f6d 6179 6265 5f61 6c69 676e  s = _maybe_align
+00038b90: 5f70 6172 7469 7469 6f6e 7328 6172 6773  _partitions(args
+00038ba0: 290a 2020 2020 6461 736b 7320 3d20 5b61  ).    dasks = [a
+00038bb0: 7267 2066 6f72 2061 7267 2069 6e20 6172  rg for arg in ar
+00038bc0: 6773 2069 6620 6973 696e 7374 616e 6365  gs if isinstance
+00038bd0: 2861 7267 2c20 285f 4672 616d 652c 2053  (arg, (_Frame, S
+00038be0: 6361 6c61 722c 2041 7272 6179 2929 5d0a  calar, Array))].
+00038bf0: 2020 2020 6466 7320 3d20 5b64 6620 666f      dfs = [df fo
+00038c00: 7220 6466 2069 6e20 6461 736b 7320 6966  r df in dasks if
+00038c10: 2069 7369 6e73 7461 6e63 6528 6466 2c20   isinstance(df, 
+00038c20: 5f46 7261 6d65 295d 0a0a 2020 2020 2320  _Frame)]..    # 
+00038c30: 436c 6561 6e20 7570 2064 6173 6b20 6172  Clean up dask ar
+00038c40: 7261 7973 2069 6620 7072 6573 656e 740a  rays if present.
+00038c50: 2020 2020 6465 7073 203d 2064 6173 6b73      deps = dasks
+00038c60: 2e63 6f70 7928 290a 2020 2020 666f 7220  .copy().    for 
+00038c70: 692c 2061 2069 6e20 656e 756d 6572 6174  i, a in enumerat
+00038c80: 6528 6461 736b 7329 3a0a 2020 2020 2020  e(dasks):.      
+00038c90: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+00038ca0: 6e63 6528 612c 2041 7272 6179 293a 0a20  nce(a, Array):. 
+00038cb0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+00038cc0: 6e75 650a 2020 2020 2020 2020 2320 456e  nue.        # En
+00038cd0: 7375 7265 2074 6861 7420 7468 6579 2068  sure that they h
+00038ce0: 6176 6520 7369 6d69 6c61 722d 6973 6820  ave similar-ish 
+00038cf0: 6368 756e 6b20 7374 7275 6374 7572 650a  chunk structure.
+00038d00: 2020 2020 2020 2020 6966 206e 6f74 2061          if not a
+00038d10: 6c6c 286e 6f74 2061 2e63 6875 6e6b 7320  ll(not a.chunks 
+00038d20: 6f72 206c 656e 2861 2e63 6875 6e6b 735b  or len(a.chunks[
+00038d30: 305d 2920 3d3d 2064 662e 6e70 6172 7469  0]) == df.nparti
+00038d40: 7469 6f6e 7320 666f 7220 6466 2069 6e20  tions for df in 
+00038d50: 6466 7329 3a0a 2020 2020 2020 2020 2020  dfs):.          
+00038d60: 2020 6d73 6720 3d20 280a 2020 2020 2020    msg = (.      
+00038d70: 2020 2020 2020 2020 2020 2257 6865 6e20            "When 
+00038d80: 636f 6d62 696e 696e 6720 6461 736b 2061  combining dask a
+00038d90: 7272 6179 7320 7769 7468 2064 6174 6166  rrays with dataf
+00038da0: 7261 6d65 7320 7468 6579 206d 7573 7420  rames they must 
+00038db0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00038dc0: 2020 226d 6174 6368 2063 6875 6e6b 696e    "match chunkin
+00038dd0: 6720 6578 6163 746c 792e 2020 4f70 6572  g exactly.  Oper
+00038de0: 6174 696f 6e3a 2025 7322 2025 2066 756e  ation: %s" % fun
+00038df0: 636e 616d 6528 6f70 290a 2020 2020 2020  cname(op).      
+00038e00: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00038e10: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00038e20: 7272 6f72 286d 7367 290a 2020 2020 2020  rror(msg).      
+00038e30: 2020 2320 5265 6368 756e 6b20 746f 2068    # Rechunk to h
+00038e40: 6176 6520 6120 7369 6e67 6c65 2063 6875  ave a single chu
+00038e50: 6e6b 2061 6c6f 6e67 2061 6c6c 206f 7468  nk along all oth
+00038e60: 6572 2061 7865 730a 2020 2020 2020 2020  er axes.        
+00038e70: 6966 2061 2e6e 6469 6d20 3e20 313a 0a20  if a.ndim > 1:. 
+00038e80: 2020 2020 2020 2020 2020 2061 203d 2061             a = a
+00038e90: 2e72 6563 6875 6e6b 287b 6920 2b20 313a  .rechunk({i + 1:
+00038ea0: 2064 2066 6f72 2069 2c20 6420 696e 2065   d for i, d in e
+00038eb0: 6e75 6d65 7261 7465 2861 2e73 6861 7065  numerate(a.shape
+00038ec0: 5b31 3a5d 297d 290a 2020 2020 2020 2020  [1:])}).        
+00038ed0: 2020 2020 6461 736b 735b 695d 203d 2061      dasks[i] = a
+00038ee0: 0a0a 2020 2020 6469 7669 7369 6f6e 7320  ..    divisions 
+00038ef0: 3d20 6466 735b 305d 2e64 6976 6973 696f  = dfs[0].divisio
+00038f00: 6e73 0a20 2020 2069 6620 7472 616e 7366  ns.    if transf
+00038f10: 6f72 6d5f 6469 7669 7369 6f6e 7320 616e  orm_divisions an
+00038f20: 6420 6973 696e 7374 616e 6365 2864 6673  d isinstance(dfs
+00038f30: 5b30 5d2c 2049 6e64 6578 2920 616e 6420  [0], Index) and 
+00038f40: 6c65 6e28 6466 7329 203d 3d20 313a 0a20  len(dfs) == 1:. 
+00038f50: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00038f60: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
+00038f70: 7320 3d20 6f70 280a 2020 2020 2020 2020  s = op(.        
+00038f80: 2020 2020 2020 2020 2a5b 7064 2e49 6e64          *[pd.Ind
+00038f90: 6578 2861 7267 2e64 6976 6973 696f 6e73  ex(arg.divisions
+00038fa0: 2920 6966 2061 7267 2069 7320 6466 735b  ) if arg is dfs[
+00038fb0: 305d 2065 6c73 6520 6172 6720 666f 7220  0] else arg for 
+00038fc0: 6172 6720 696e 2061 7267 735d 2c0a 2020  arg in args],.  
+00038fd0: 2020 2020 2020 2020 2020 2020 2020 2a2a                **
+00038fe0: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+00038ff0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00039000: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00039010: 6469 7669 7369 6f6e 732c 2070 642e 496e  divisions, pd.In
+00039020: 6465 7829 3a0a 2020 2020 2020 2020 2020  dex):.          
+00039030: 2020 2020 2020 6469 7669 7369 6f6e 7320        divisions 
+00039040: 3d20 6d65 7468 6f64 732e 746f 6c69 7374  = methods.tolist
+00039050: 2864 6976 6973 696f 6e73 290a 2020 2020  (divisions).    
+00039060: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
+00039070: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
+00039080: 2020 7061 7373 0a20 2020 2020 2020 2065    pass.        e
+00039090: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000390a0: 2069 6620 6e6f 7420 7661 6c69 645f 6469   if not valid_di
+000390b0: 7669 7369 6f6e 7328 6469 7669 7369 6f6e  visions(division
+000390c0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+000390d0: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
+000390e0: 5b4e 6f6e 655d 202a 2028 6466 735b 305d  [None] * (dfs[0]
+000390f0: 2e6e 7061 7274 6974 696f 6e73 202b 2031  .npartitions + 1
+00039100: 290a 0a20 2020 205f 6973 5f62 726f 6164  )..    _is_broad
+00039110: 6361 7374 6162 6c65 203d 2070 6172 7469  castable = parti
+00039120: 616c 2869 735f 6272 6f61 6463 6173 7461  al(is_broadcasta
+00039130: 626c 652c 2064 6673 290a 2020 2020 6466  ble, dfs).    df
+00039140: 7320 3d20 6c69 7374 2872 656d 6f76 6528  s = list(remove(
+00039150: 5f69 735f 6272 6f61 6463 6173 7461 626c  _is_broadcastabl
+00039160: 652c 2064 6673 2929 0a0a 2020 2020 6f74  e, dfs))..    ot
+00039170: 6865 7220 3d20 5b0a 2020 2020 2020 2020  her = [.        
+00039180: 2869 2c20 6172 6729 0a20 2020 2020 2020  (i, arg).       
+00039190: 2066 6f72 2069 2c20 6172 6720 696e 2065   for i, arg in e
+000391a0: 6e75 6d65 7261 7465 2861 7267 7329 0a20  numerate(args). 
+000391b0: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+000391c0: 696e 7374 616e 6365 2861 7267 2c20 285f  instance(arg, (_
+000391d0: 4672 616d 652c 2053 6361 6c61 722c 2041  Frame, Scalar, A
+000391e0: 7272 6179 2929 0a20 2020 205d 0a0a 2020  rray)).    ]..  
+000391f0: 2020 2320 6164 6a75 7374 2074 6865 206b    # adjust the k
+00039200: 6579 206c 656e 6774 6820 6f66 2053 6361  ey length of Sca
+00039210: 6c61 720a 2020 2020 6473 6b20 3d20 7061  lar.    dsk = pa
+00039220: 7274 6974 696f 6e77 6973 655f 6772 6170  rtitionwise_grap
+00039230: 6828 6f70 2c20 5f6e 616d 652c 202a 6172  h(op, _name, *ar
+00039240: 6773 2c20 2a2a 6b77 6172 6773 290a 0a20  gs, **kwargs).. 
+00039250: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
+00039260: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
+00039270: 6f6c 6c65 6374 696f 6e73 285f 6e61 6d65  ollections(_name
+00039280: 2c20 6473 6b2c 2064 6570 656e 6465 6e63  , dsk, dependenc
+00039290: 6965 733d 6465 7073 290a 0a20 2020 2069  ies=deps)..    i
+000392a0: 6620 6d65 7461 2069 7320 6e6f 5f64 6566  f meta is no_def
+000392b0: 6175 6c74 3a0a 2020 2020 2020 2020 6966  ault:.        if
+000392c0: 206c 656e 2864 6673 2920 3e3d 2032 2061   len(dfs) >= 2 a
+000392d0: 6e64 206e 6f74 2061 6c6c 2868 6173 6174  nd not all(hasat
+000392e0: 7472 2864 2c20 226e 7061 7274 6974 696f  tr(d, "npartitio
+000392f0: 6e73 2229 2066 6f72 2064 2069 6e20 6461  ns") for d in da
+00039300: 736b 7329 3a0a 2020 2020 2020 2020 2020  sks):.          
+00039310: 2020 2320 7368 6f75 6c64 206e 6f74 206f    # should not o
+00039320: 6363 7572 2069 6e20 6375 7272 656e 7420  ccur in current 
+00039330: 6675 6e63 730a 2020 2020 2020 2020 2020  funcs.          
+00039340: 2020 6d73 6720 3d20 2265 6c65 6d77 6973    msg = "elemwis
+00039350: 6520 7769 7468 2032 206f 7220 6d6f 7265  e with 2 or more
+00039360: 2044 6174 6146 7261 6d65 7320 616e 6420   DataFrames and 
+00039370: 5363 616c 6172 2069 7320 6e6f 7420 7375  Scalar is not su
+00039380: 7070 6f72 7465 6422 0a20 2020 2020 2020  pported".       
+00039390: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+000393a0: 706c 656d 656e 7465 6445 7272 6f72 286d  plementedError(m
+000393b0: 7367 290a 2020 2020 2020 2020 2320 466f  sg).        # Fo
+000393c0: 7220 6272 6f61 6463 6173 7461 626c 6520  r broadcastable 
+000393d0: 7365 7269 6573 2c20 7573 6520 6e6f 2072  series, use no r
+000393e0: 6f77 732e 0a20 2020 2020 2020 2070 6172  ows..        par
+000393f0: 7473 203d 205b 0a20 2020 2020 2020 2020  ts = [.         
+00039400: 2020 2064 2e5f 6d65 7461 0a20 2020 2020     d._meta.     
+00039410: 2020 2020 2020 2069 6620 5f69 735f 6272         if _is_br
+00039420: 6f61 6463 6173 7461 626c 6528 6429 0a20  oadcastable(d). 
+00039430: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
+00039440: 6e70 2e65 6d70 7479 2828 292c 2064 7479  np.empty((), dty
+00039450: 7065 3d64 2e64 7479 7065 290a 2020 2020  pe=d.dtype).    
+00039460: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00039470: 7461 6e63 6528 642c 2041 7272 6179 290a  tance(d, Array).
+00039480: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00039490: 2064 2e5f 6d65 7461 5f6e 6f6e 656d 7074   d._meta_nonempt
+000394a0: 790a 2020 2020 2020 2020 2020 2020 666f  y.            fo
+000394b0: 7220 6420 696e 2064 6173 6b73 0a20 2020  r d in dasks.   
+000394c0: 2020 2020 205d 0a20 2020 2020 2020 2077       ].        w
+000394d0: 6974 6820 7261 6973 655f 6f6e 5f6d 6574  ith raise_on_met
+000394e0: 615f 6572 726f 7228 6675 6e63 6e61 6d65  a_error(funcname
+000394f0: 286f 7029 293a 0a20 2020 2020 2020 2020  (op)):.         
+00039500: 2020 206d 6574 6120 3d20 7061 7274 6961     meta = partia
+00039510: 6c5f 6279 5f6f 7264 6572 282a 7061 7274  l_by_order(*part
+00039520: 732c 2066 756e 6374 696f 6e3d 6f70 2c20  s, function=op, 
+00039530: 6f74 6865 723d 6f74 6865 7229 0a0a 2020  other=other)..  
+00039540: 2020 7265 7375 6c74 203d 206e 6577 5f64    result = new_d
+00039550: 645f 6f62 6a65 6374 2867 7261 7068 2c20  d_object(graph, 
+00039560: 5f6e 616d 652c 206d 6574 612c 2064 6976  _name, meta, div
+00039570: 6973 696f 6e73 290a 2020 2020 7265 7475  isions).    retu
+00039580: 726e 2068 616e 646c 655f 6f75 7428 6f75  rn handle_out(ou
+00039590: 742c 2072 6573 756c 7429 0a0a 0a64 6566  t, result)...def
+000395a0: 2068 616e 646c 655f 6f75 7428 6f75 742c   handle_out(out,
+000395b0: 2072 6573 756c 7429 3a0a 2020 2020 2222   result):.    ""
+000395c0: 2248 616e 646c 6520 6f75 7420 7061 7261  "Handle out para
+000395d0: 6d65 7465 7273 0a0a 2020 2020 4966 206f  meters..    If o
+000395e0: 7574 2069 7320 6120 6461 736b 2e44 6174  ut is a dask.Dat
+000395f0: 6146 7261 6d65 2c20 6461 736b 2e53 6572  aFrame, dask.Ser
+00039600: 6965 7320 6f72 2064 6173 6b2e 5363 616c  ies or dask.Scal
+00039610: 6172 2074 6865 6e0a 2020 2020 7468 6973  ar then.    this
+00039620: 206f 7665 7277 7269 7465 7320 7468 6520   overwrites the 
+00039630: 636f 6e74 656e 7473 206f 6620 6974 2077  contents of it w
+00039640: 6974 6820 7468 6520 7265 7375 6c74 0a20  ith the result. 
+00039650: 2020 2022 2222 0a20 2020 2069 6620 6973     """.    if is
+00039660: 696e 7374 616e 6365 286f 7574 2c20 7475  instance(out, tu
+00039670: 706c 6529 3a0a 2020 2020 2020 2020 6966  ple):.        if
+00039680: 206c 656e 286f 7574 2920 3d3d 2031 3a0a   len(out) == 1:.
+00039690: 2020 2020 2020 2020 2020 2020 6f75 7420              out 
+000396a0: 3d20 6f75 745b 305d 0a20 2020 2020 2020  = out[0].       
+000396b0: 2065 6c69 6620 6c65 6e28 6f75 7429 203e   elif len(out) >
+000396c0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+000396d0: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
+000396e0: 6e74 6564 4572 726f 7228 2254 6865 206f  ntedError("The o
+000396f0: 7574 2070 6172 616d 6574 6572 2069 7320  ut parameter is 
+00039700: 6e6f 7420 6675 6c6c 7920 7375 7070 6f72  not fully suppor
+00039710: 7465 6422 290a 2020 2020 2020 2020 656c  ted").        el
+00039720: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00039730: 6f75 7420 3d20 4e6f 6e65 0a0a 2020 2020  out = None..    
+00039740: 2320 4e6f 7469 6365 2c20 7765 2075 7365  # Notice, we use
+00039750: 202e 5f5f 636c 6173 735f 5f20 6173 206f   .__class__ as o
+00039760: 7070 6f73 6564 2074 6f20 7479 7065 2829  pposed to type()
+00039770: 2069 6e20 6f72 6465 7220 746f 2073 7570   in order to sup
+00039780: 706f 7274 0a20 2020 2023 206f 626a 6563  port.    # objec
+00039790: 7420 7072 6f78 6965 7320 7365 6520 3c68  t proxies see <h
+000397a0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+000397b0: 6d2f 6461 736b 2f64 6173 6b2f 7075 6c6c  m/dask/dask/pull
+000397c0: 2f36 3938 313e 0a20 2020 2069 6620 6f75  /6981>.    if ou
+000397d0: 7420 6973 206e 6f74 204e 6f6e 6520 616e  t is not None an
+000397e0: 6420 6f75 742e 5f5f 636c 6173 735f 5f20  d out.__class__ 
+000397f0: 213d 2072 6573 756c 742e 5f5f 636c 6173  != result.__clas
+00039800: 735f 5f3a 0a20 2020 2020 2020 2072 6169  s__:.        rai
+00039810: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
+00039820: 2020 2020 2020 2020 2020 224d 6973 6d61            "Misma
+00039830: 7463 6865 6420 7479 7065 7320 6265 7477  tched types betw
+00039840: 6565 6e20 7265 7375 6c74 2061 6e64 206f  een result and o
+00039850: 7574 2070 6172 616d 6574 6572 2e20 220a  ut parameter. ".
+00039860: 2020 2020 2020 2020 2020 2020 226f 7574              "out
+00039870: 3d25 732c 2072 6573 756c 743d 2573 2220  =%s, result=%s" 
+00039880: 2520 2873 7472 2874 7970 6528 6f75 7429  % (str(type(out)
+00039890: 292c 2073 7472 2874 7970 6528 7265 7375  ), str(type(resu
+000398a0: 6c74 2929 290a 2020 2020 2020 2020 290a  lt))).        ).
+000398b0: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
+000398c0: 6365 286f 7574 2c20 4461 7461 4672 616d  ce(out, DataFram
+000398d0: 6529 3a0a 2020 2020 2020 2020 6966 206c  e):.        if l
+000398e0: 656e 286f 7574 2e63 6f6c 756d 6e73 2920  en(out.columns) 
+000398f0: 213d 206c 656e 2872 6573 756c 742e 636f  != len(result.co
+00039900: 6c75 6d6e 7329 3a0a 2020 2020 2020 2020  lumns):.        
+00039910: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00039920: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00039930: 2020 2020 2020 224d 6973 6d61 7463 6865        "Mismatche
+00039940: 6420 636f 6c75 6d6e 7320 636f 756e 7420  d columns count 
+00039950: 6265 7477 6565 6e20 7265 7375 6c74 2061  between result a
+00039960: 6e64 206f 7574 2070 6172 616d 6574 6572  nd out parameter
+00039970: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
+00039980: 2020 2020 226f 7574 3d25 732c 2072 6573      "out=%s, res
+00039990: 756c 743d 2573 2220 2520 2873 7472 286c  ult=%s" % (str(l
+000399a0: 656e 286f 7574 2e63 6f6c 756d 6e73 2929  en(out.columns))
+000399b0: 2c20 7374 7228 6c65 6e28 7265 7375 6c74  , str(len(result
+000399c0: 2e63 6f6c 756d 6e73 2929 290a 2020 2020  .columns))).    
+000399d0: 2020 2020 2020 2020 290a 0a20 2020 2069          )..    i
+000399e0: 6620 6973 696e 7374 616e 6365 286f 7574  f isinstance(out
+000399f0: 2c20 2853 6572 6965 732c 2044 6174 6146  , (Series, DataF
+00039a00: 7261 6d65 2c20 5363 616c 6172 2929 3a0a  rame, Scalar)):.
+00039a10: 2020 2020 2020 2020 6f75 742e 5f6d 6574          out._met
+00039a20: 6120 3d20 7265 7375 6c74 2e5f 6d65 7461  a = result._meta
+00039a30: 0a20 2020 2020 2020 206f 7574 2e5f 6e61  .        out._na
+00039a40: 6d65 203d 2072 6573 756c 742e 5f6e 616d  me = result._nam
+00039a50: 650a 2020 2020 2020 2020 6f75 742e 6461  e.        out.da
+00039a60: 736b 203d 2072 6573 756c 742e 6461 736b  sk = result.dask
+00039a70: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+00039a80: 2069 7369 6e73 7461 6e63 6528 6f75 742c   isinstance(out,
+00039a90: 2053 6361 6c61 7229 3a0a 2020 2020 2020   Scalar):.      
+00039aa0: 2020 2020 2020 6f75 742e 5f64 6976 6973        out._divis
+00039ab0: 696f 6e73 203d 2072 6573 756c 742e 6469  ions = result.di
+00039ac0: 7669 7369 6f6e 730a 2020 2020 656c 6966  visions.    elif
+00039ad0: 206f 7574 2069 7320 6e6f 7420 4e6f 6e65   out is not None
+00039ae0: 3a0a 2020 2020 2020 2020 6d73 6720 3d20  :.        msg = 
+00039af0: 280a 2020 2020 2020 2020 2020 2020 2254  (.            "T
+00039b00: 6865 206f 7574 2070 6172 616d 6574 6572  he out parameter
+00039b10: 2069 7320 6e6f 7420 6675 6c6c 7920 7375   is not fully su
+00039b20: 7070 6f72 7465 642e 220a 2020 2020 2020  pported.".      
+00039b30: 2020 2020 2020 2220 5265 6365 6976 6564        " Received
+00039b40: 2074 7970 6520 2573 2c20 6578 7065 6374   type %s, expect
+00039b50: 6564 2025 7320 220a 2020 2020 2020 2020  ed %s ".        
+00039b60: 2020 2020 2520 280a 2020 2020 2020 2020      % (.        
+00039b70: 2020 2020 2020 2020 7479 7065 6e61 6d65          typename
+00039b80: 2874 7970 6528 6f75 7429 292c 0a20 2020  (type(out)),.   
+00039b90: 2020 2020 2020 2020 2020 2020 2074 7970               typ
+00039ba0: 656e 616d 6528 7479 7065 2872 6573 756c  ename(type(resul
+00039bb0: 7429 292c 0a20 2020 2020 2020 2020 2020  t)),.           
+00039bc0: 2029 0a20 2020 2020 2020 2029 0a20 2020   ).        ).   
+00039bd0: 2020 2020 2072 6169 7365 204e 6f74 496d       raise NotIm
+00039be0: 706c 656d 656e 7465 6445 7272 6f72 286d  plementedError(m
+00039bf0: 7367 290a 2020 2020 656c 7365 3a0a 2020  sg).    else:.  
+00039c00: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+00039c10: 756c 740a 0a0a 6465 6620 5f6d 6179 6265  ult...def _maybe
+00039c20: 5f66 726f 6d5f 7061 6e64 6173 2864 6673  _from_pandas(dfs
+00039c30: 293a 0a20 2020 2066 726f 6d20 6461 736b  ):.    from dask
+00039c40: 2e64 6174 6166 7261 6d65 2e69 6f20 696d  .dataframe.io im
+00039c50: 706f 7274 2066 726f 6d5f 7061 6e64 6173  port from_pandas
+00039c60: 0a0a 2020 2020 6466 7320 3d20 5b0a 2020  ..    dfs = [.  
+00039c70: 2020 2020 2020 6672 6f6d 5f70 616e 6461        from_panda
+00039c80: 7328 6466 2c20 3129 0a20 2020 2020 2020  s(df, 1).       
+00039c90: 2069 6620 2869 735f 7365 7269 6573 5f6c   if (is_series_l
+00039ca0: 696b 6528 6466 2920 6f72 2069 735f 6461  ike(df) or is_da
+00039cb0: 7461 6672 616d 655f 6c69 6b65 2864 6629  taframe_like(df)
+00039cc0: 2920 616e 6420 6e6f 7420 6973 5f64 6173  ) and not is_das
+00039cd0: 6b5f 636f 6c6c 6563 7469 6f6e 2864 6629  k_collection(df)
+00039ce0: 0a20 2020 2020 2020 2065 6c73 6520 6466  .        else df
+00039cf0: 0a20 2020 2020 2020 2066 6f72 2064 6620  .        for df 
+00039d00: 696e 2064 6673 0a20 2020 205d 0a20 2020  in dfs.    ].   
+00039d10: 2072 6574 7572 6e20 6466 730a 0a0a 6465   return dfs...de
+00039d20: 6620 6861 7368 5f73 6861 7264 280a 2020  f hash_shard(.  
+00039d30: 2020 6466 2c20 6e70 6172 7473 2c20 7370    df, nparts, sp
+00039d40: 6c69 745f 6f75 745f 7365 7475 703d 4e6f  lit_out_setup=No
+00039d50: 6e65 2c20 7370 6c69 745f 6f75 745f 7365  ne, split_out_se
+00039d60: 7475 705f 6b77 6172 6773 3d4e 6f6e 652c  tup_kwargs=None,
+00039d70: 2069 676e 6f72 655f 696e 6465 783d 4661   ignore_index=Fa
+00039d80: 6c73 650a 293a 0a20 2020 2069 6620 7370  lse.):.    if sp
+00039d90: 6c69 745f 6f75 745f 7365 7475 703a 0a20  lit_out_setup:. 
+00039da0: 2020 2020 2020 2068 203d 2073 706c 6974         h = split
+00039db0: 5f6f 7574 5f73 6574 7570 2864 662c 202a  _out_setup(df, *
+00039dc0: 2a28 7370 6c69 745f 6f75 745f 7365 7475  *(split_out_setu
+00039dd0: 705f 6b77 6172 6773 206f 7220 7b7d 2929  p_kwargs or {}))
+00039de0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+00039df0: 2020 2068 203d 2064 660a 0a20 2020 2068     h = df..    h
+00039e00: 203d 2068 6173 685f 6f62 6a65 6374 5f64   = hash_object_d
+00039e10: 6973 7061 7463 6828 682c 2069 6e64 6578  ispatch(h, index
+00039e20: 3d46 616c 7365 290a 2020 2020 7265 7475  =False).    retu
+00039e30: 726e 2067 726f 7570 5f73 706c 6974 5f64  rn group_split_d
+00039e40: 6973 7061 7463 6828 6466 2c20 6820 2520  ispatch(df, h % 
+00039e50: 6e70 6172 7473 2c20 6e70 6172 7473 2c20  nparts, nparts, 
+00039e60: 6967 6e6f 7265 5f69 6e64 6578 3d69 676e  ignore_index=ign
+00039e70: 6f72 655f 696e 6465 7829 0a0a 0a64 6566  ore_index)...def
+00039e80: 2073 706c 6974 5f65 7665 6e6c 7928 6466   split_evenly(df
+00039e90: 2c20 6b29 3a0a 2020 2020 2222 2253 706c  , k):.    """Spl
+00039ea0: 6974 2064 6174 6166 7261 6d65 2069 6e74  it dataframe int
+00039eb0: 6f20 6b20 726f 7567 686c 7920 6571 7561  o k roughly equa
+00039ec0: 6c20 7061 7274 7322 2222 0a20 2020 2064  l parts""".    d
+00039ed0: 6976 6973 696f 6e73 203d 206e 702e 6c69  ivisions = np.li
+00039ee0: 6e73 7061 6365 2830 2c20 6c65 6e28 6466  nspace(0, len(df
+00039ef0: 292c 206b 202b 2031 292e 6173 7479 7065  ), k + 1).astype
+00039f00: 2869 6e74 290a 2020 2020 7265 7475 726e  (int).    return
+00039f10: 207b 693a 2064 662e 696c 6f63 5b64 6976   {i: df.iloc[div
+00039f20: 6973 696f 6e73 5b69 5d20 3a20 6469 7669  isions[i] : divi
+00039f30: 7369 6f6e 735b 6920 2b20 315d 5d20 666f  sions[i + 1]] fo
+00039f40: 7220 6920 696e 2072 616e 6765 286b 297d  r i in range(k)}
+00039f50: 0a0a 0a64 6566 2073 706c 6974 5f6f 7574  ...def split_out
+00039f60: 5f6f 6e5f 696e 6465 7828 6466 293a 0a20  _on_index(df):. 
+00039f70: 2020 2068 203d 2064 662e 696e 6465 780a     h = df.index.
+00039f80: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00039f90: 6528 682c 2070 642e 4d75 6c74 6949 6e64  e(h, pd.MultiInd
+00039fa0: 6578 293a 0a20 2020 2020 2020 2068 203d  ex):.        h =
+00039fb0: 206d 6574 615f 6672 616d 655f 636f 6e73   meta_frame_cons
+00039fc0: 7472 7563 746f 7228 6466 2928 5b5d 2c20  tructor(df)([], 
+00039fd0: 696e 6465 783d 6829 2e72 6573 6574 5f69  index=h).reset_i
+00039fe0: 6e64 6578 2829 0a20 2020 2072 6574 7572  ndex().    retur
+00039ff0: 6e20 680a 0a0a 6465 6620 7370 6c69 745f  n h...def split_
+0003a000: 6f75 745f 6f6e 5f63 6f6c 7328 6466 2c20  out_on_cols(df, 
+0003a010: 636f 6c73 3d4e 6f6e 6529 3a0a 2020 2020  cols=None):.    
+0003a020: 7265 7475 726e 2064 665b 636f 6c73 5d0a  return df[cols].
+0003a030: 0a0a 4069 6e73 6572 745f 6d65 7461 5f70  ..@insert_meta_p
+0003a040: 6172 616d 5f64 6573 6372 6970 7469 6f6e  aram_description
+0003a050: 0a64 6566 2061 7070 6c79 5f63 6f6e 6361  .def apply_conca
+0003a060: 745f 6170 706c 7928 0a20 2020 2061 7267  t_apply(.    arg
+0003a070: 732c 0a20 2020 2063 6875 6e6b 3d4e 6f6e  s,.    chunk=Non
+0003a080: 652c 0a20 2020 2061 6767 7265 6761 7465  e,.    aggregate
+0003a090: 3d4e 6f6e 652c 0a20 2020 2063 6f6d 6269  =None,.    combi
+0003a0a0: 6e65 3d4e 6f6e 652c 0a20 2020 206d 6574  ne=None,.    met
+0003a0b0: 613d 6e6f 5f64 6566 6175 6c74 2c0a 2020  a=no_default,.  
+0003a0c0: 2020 746f 6b65 6e3d 4e6f 6e65 2c0a 2020    token=None,.  
+0003a0d0: 2020 6368 756e 6b5f 6b77 6172 6773 3d4e    chunk_kwargs=N
+0003a0e0: 6f6e 652c 0a20 2020 2061 6767 7265 6761  one,.    aggrega
+0003a0f0: 7465 5f6b 7761 7267 733d 4e6f 6e65 2c0a  te_kwargs=None,.
+0003a100: 2020 2020 636f 6d62 696e 655f 6b77 6172      combine_kwar
+0003a110: 6773 3d4e 6f6e 652c 0a20 2020 2073 706c  gs=None,.    spl
+0003a120: 6974 5f65 7665 7279 3d4e 6f6e 652c 0a20  it_every=None,. 
+0003a130: 2020 2073 706c 6974 5f6f 7574 3d4e 6f6e     split_out=Non
+0003a140: 652c 0a20 2020 2073 706c 6974 5f6f 7574  e,.    split_out
+0003a150: 5f73 6574 7570 3d4e 6f6e 652c 0a20 2020  _setup=None,.   
+0003a160: 2073 706c 6974 5f6f 7574 5f73 6574 7570   split_out_setup
+0003a170: 5f6b 7761 7267 733d 4e6f 6e65 2c0a 2020  _kwargs=None,.  
+0003a180: 2020 736f 7274 3d4e 6f6e 652c 0a20 2020    sort=None,.   
+0003a190: 2069 676e 6f72 655f 696e 6465 783d 4661   ignore_index=Fa
+0003a1a0: 6c73 652c 0a20 2020 202a 2a6b 7761 7267  lse,.    **kwarg
+0003a1b0: 732c 0a29 3a0a 2020 2020 2222 2241 7070  s,.):.    """App
+0003a1c0: 6c79 2061 2066 756e 6374 696f 6e20 746f  ly a function to
+0003a1d0: 2062 6c6f 636b 732c 2074 6865 6e20 636f   blocks, then co
+0003a1e0: 6e63 6174 2c20 7468 656e 2061 7070 6c79  ncat, then apply
+0003a1f0: 2061 6761 696e 0a0a 2020 2020 5061 7261   again..    Para
+0003a200: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
+0003a210: 2d2d 2d2d 2d0a 2020 2020 6172 6773 203a  -----.    args :
+0003a220: 0a20 2020 2020 2020 2050 6f73 6974 696f  .        Positio
+0003a230: 6e61 6c20 6172 6775 6d65 6e74 7320 666f  nal arguments fo
+0003a240: 7220 7468 6520 6063 6875 6e6b 6020 6675  r the `chunk` fu
+0003a250: 6e63 7469 6f6e 2e20 416c 6c20 6064 6173  nction. All `das
+0003a260: 6b2e 6461 7461 6672 616d 6560 0a20 2020  k.dataframe`.   
+0003a270: 2020 2020 206f 626a 6563 7473 2073 686f       objects sho
+0003a280: 756c 6420 6265 2070 6172 7469 7469 6f6e  uld be partition
+0003a290: 6564 2061 6e64 2069 6e64 6578 6564 2065  ed and indexed e
+0003a2a0: 7175 6976 616c 656e 746c 792e 0a20 2020  quivalently..   
+0003a2b0: 2063 6875 6e6b 203a 2066 756e 6374 696f   chunk : functio
+0003a2c0: 6e20 5b62 6c6f 636b 2d70 6572 2d61 7267  n [block-per-arg
+0003a2d0: 5d20 2d3e 2062 6c6f 636b 0a20 2020 2020  ] -> block.     
+0003a2e0: 2020 2046 756e 6374 696f 6e20 746f 206f     Function to o
+0003a2f0: 7065 7261 7465 206f 6e20 6561 6368 2062  perate on each b
+0003a300: 6c6f 636b 206f 6620 6461 7461 0a20 2020  lock of data.   
+0003a310: 2061 6767 7265 6761 7465 203a 2066 756e   aggregate : fun
+0003a320: 6374 696f 6e20 636f 6e63 6174 656e 6174  ction concatenat
+0003a330: 6564 2d62 6c6f 636b 202d 3e20 626c 6f63  ed-block -> bloc
+0003a340: 6b0a 2020 2020 2020 2020 4675 6e63 7469  k.        Functi
+0003a350: 6f6e 2074 6f20 6f70 6572 6174 6520 6f6e  on to operate on
+0003a360: 2074 6865 2063 6f6e 6361 7465 6e61 7465   the concatenate
+0003a370: 6420 7265 7375 6c74 206f 6620 6368 756e  d result of chun
+0003a380: 6b0a 2020 2020 636f 6d62 696e 6520 3a20  k.    combine : 
+0003a390: 6675 6e63 7469 6f6e 2063 6f6e 6361 7465  function concate
+0003a3a0: 6e61 7465 642d 626c 6f63 6b20 2d3e 2062  nated-block -> b
+0003a3b0: 6c6f 636b 2c20 6f70 7469 6f6e 616c 0a20  lock, optional. 
+0003a3c0: 2020 2020 2020 2046 756e 6374 696f 6e20         Function 
+0003a3d0: 746f 206f 7065 7261 7465 206f 6e20 696e  to operate on in
+0003a3e0: 7465 726d 6564 6961 7465 2063 6f6e 6361  termediate conca
+0003a3f0: 7465 6e61 7465 6420 7265 7375 6c74 7320  tenated results 
+0003a400: 6f66 2063 6875 6e6b 0a20 2020 2020 2020  of chunk.       
+0003a410: 2069 6e20 6120 7472 6565 2d72 6564 7563   in a tree-reduc
+0003a420: 7469 6f6e 2e20 4966 206e 6f74 2070 726f  tion. If not pro
+0003a430: 7669 6465 642c 2064 6566 6175 6c74 7320  vided, defaults 
+0003a440: 746f 2061 6767 7265 6761 7465 2e0a 2020  to aggregate..  
+0003a450: 2020 244d 4554 410a 2020 2020 746f 6b65    $META.    toke
+0003a460: 6e20 3a20 7374 722c 206f 7074 696f 6e61  n : str, optiona
+0003a470: 6c0a 2020 2020 2020 2020 5468 6520 6e61  l.        The na
+0003a480: 6d65 2074 6f20 7573 6520 666f 7220 7468  me to use for th
+0003a490: 6520 6f75 7470 7574 206b 6579 732e 0a20  e output keys.. 
+0003a4a0: 2020 2063 6875 6e6b 5f6b 7761 7267 7320     chunk_kwargs 
+0003a4b0: 3a20 6469 6374 2c20 6f70 7469 6f6e 616c  : dict, optional
+0003a4c0: 0a20 2020 2020 2020 204b 6579 776f 7264  .        Keyword
+0003a4d0: 7320 666f 7220 7468 6520 6368 756e 6b20  s for the chunk 
 0003a4e0: 6675 6e63 7469 6f6e 206f 6e6c 792e 0a20  function only.. 
-0003a4f0: 2020 2073 706c 6974 5f65 7665 7279 203a     split_every :
-0003a500: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
-0003a510: 2020 2020 2020 2047 726f 7570 2070 6172         Group par
-0003a520: 7469 7469 6f6e 7320 696e 746f 2067 726f  titions into gro
-0003a530: 7570 7320 6f66 2074 6869 7320 7369 7a65  ups of this size
-0003a540: 2077 6869 6c65 2070 6572 666f 726d 696e   while performin
-0003a550: 6720 610a 2020 2020 2020 2020 7472 6565  g a.        tree
-0003a560: 2d72 6564 7563 7469 6f6e 2e20 4966 2073  -reduction. If s
-0003a570: 6574 2074 6f20 4661 6c73 652c 206e 6f20  et to False, no 
-0003a580: 7472 6565 2d72 6564 7563 7469 6f6e 2077  tree-reduction w
-0003a590: 696c 6c20 6265 2075 7365 642c 0a20 2020  ill be used,.   
-0003a5a0: 2020 2020 2061 6e64 2061 6c6c 2069 6e74       and all int
-0003a5b0: 6572 6d65 6469 6174 6573 2077 696c 6c20  ermediates will 
-0003a5c0: 6265 2063 6f6e 6361 7465 6e61 7465 6420  be concatenated 
-0003a5d0: 616e 6420 7061 7373 6564 2074 6f20 6060  and passed to ``
-0003a5e0: 6167 6772 6567 6174 6560 602e 0a20 2020  aggregate``..   
-0003a5f0: 2020 2020 2044 6566 6175 6c74 2069 7320       Default is 
-0003a600: 382e 0a20 2020 2073 706c 6974 5f6f 7574  8..    split_out
-0003a610: 203a 2069 6e74 2c20 6f70 7469 6f6e 616c   : int, optional
-0003a620: 0a20 2020 2020 2020 204e 756d 6265 7220  .        Number 
-0003a630: 6f66 206f 7574 7075 7420 7061 7274 6974  of output partit
-0003a640: 696f 6e73 2e20 5370 6c69 7420 6f63 6375  ions. Split occu
-0003a650: 7273 2061 6674 6572 2066 6972 7374 2063  rs after first c
-0003a660: 6875 6e6b 2072 6564 7563 7469 6f6e 2e0a  hunk reduction..
-0003a670: 2020 2020 7370 6c69 745f 6f75 745f 7365      split_out_se
-0003a680: 7475 7020 3a20 6361 6c6c 6162 6c65 2c20  tup : callable, 
-0003a690: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-0003a6a0: 2049 6620 7072 6f76 6964 6564 2c20 7468   If provided, th
-0003a6b0: 6973 2066 756e 6374 696f 6e20 6973 2063  is function is c
-0003a6c0: 616c 6c65 6420 6f6e 2065 6163 6820 6368  alled on each ch
-0003a6d0: 756e 6b20 6265 666f 7265 2070 6572 666f  unk before perfo
-0003a6e0: 726d 696e 670a 2020 2020 2020 2020 7468  rming.        th
-0003a6f0: 6520 6861 7368 2d73 706c 6974 2e20 4974  e hash-split. It
-0003a700: 2073 686f 756c 6420 7265 7475 726e 2061   should return a
-0003a710: 2070 616e 6461 7320 6f62 6a65 6374 2c20   pandas object, 
-0003a720: 7768 6572 6520 6561 6368 2072 6f77 0a20  where each row. 
-0003a730: 2020 2020 2020 2028 6578 636c 7564 696e         (excludin
-0003a740: 6720 7468 6520 696e 6465 7829 2069 7320  g the index) is 
-0003a750: 6861 7368 6564 2e20 4966 206e 6f74 2070  hashed. If not p
-0003a760: 726f 7669 6465 642c 2074 6865 2063 6875  rovided, the chu
-0003a770: 6e6b 2069 7320 6861 7368 6564 0a20 2020  nk is hashed.   
-0003a780: 2020 2020 2061 7320 6973 2e0a 2020 2020       as is..    
-0003a790: 7370 6c69 745f 6f75 745f 7365 7475 705f  split_out_setup_
-0003a7a0: 6b77 6172 6773 203a 2064 6963 742c 206f  kwargs : dict, o
-0003a7b0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-0003a7c0: 4b65 7977 6f72 6473 2066 6f72 2074 6865  Keywords for the
-0003a7d0: 2060 7370 6c69 745f 6f75 745f 7365 7475   `split_out_setu
-0003a7e0: 7060 2066 756e 6374 696f 6e20 6f6e 6c79  p` function only
-0003a7f0: 2e0a 2020 2020 736f 7274 203a 2062 6f6f  ..    sort : boo
-0003a800: 6c2c 2064 6566 6175 6c74 204e 6f6e 650a  l, default None.
-0003a810: 2020 2020 2020 2020 4966 2061 6c6c 6f77          If allow
-0003a820: 6564 2c20 736f 7274 2074 6865 206b 6579  ed, sort the key
-0003a830: 7320 6f66 2074 6865 206f 7574 7075 7420  s of the output 
-0003a840: 6167 6772 6567 6174 696f 6e2e 0a20 2020  aggregation..   
-0003a850: 2069 676e 6f72 655f 696e 6465 7820 3a20   ignore_index : 
-0003a860: 626f 6f6c 2c20 6465 6661 756c 7420 4661  bool, default Fa
-0003a870: 6c73 650a 2020 2020 2020 2020 4966 2054  lse.        If T
-0003a880: 7275 652c 2064 6f20 6e6f 7420 7072 6573  rue, do not pres
-0003a890: 6572 7665 2069 6e64 6578 2076 616c 7565  erve index value
-0003a8a0: 7320 7468 726f 7567 686f 7574 2041 4341  s throughout ACA
-0003a8b0: 206f 7065 7261 7469 6f6e 732e 0a20 2020   operations..   
-0003a8c0: 206b 7761 7267 7320 3a0a 2020 2020 2020   kwargs :.      
-0003a8d0: 2020 416c 6c20 7265 6d61 696e 696e 6720    All remaining 
-0003a8e0: 6b65 7977 6f72 6473 2077 696c 6c20 6265  keywords will be
-0003a8f0: 2070 6173 7365 6420 746f 2060 6063 6875   passed to ``chu
-0003a900: 6e6b 6060 2c20 6060 6167 6772 6567 6174  nk``, ``aggregat
-0003a910: 6560 602c 2061 6e64 0a20 2020 2020 2020  e``, and.       
-0003a920: 2060 6063 6f6d 6269 6e65 6060 2e0a 0a20   ``combine``... 
-0003a930: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-0003a940: 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e 3e3e  --------.    >>>
-0003a950: 2064 6566 2063 6875 6e6b 2861 5f62 6c6f   def chunk(a_blo
-0003a960: 636b 2c20 625f 626c 6f63 6b29 3a0a 2020  ck, b_block):.  
-0003a970: 2020 2e2e 2e20 2020 2020 7061 7373 0a0a    ...     pass..
-0003a980: 2020 2020 3e3e 3e20 6465 6620 6167 6728      >>> def agg(
-0003a990: 6466 293a 0a20 2020 202e 2e2e 2020 2020  df):.    ...    
-0003a9a0: 2070 6173 730a 0a20 2020 203e 3e3e 2061   pass..    >>> a
-0003a9b0: 7070 6c79 5f63 6f6e 6361 745f 6170 706c  pply_concat_appl
-0003a9c0: 7928 5b61 2c20 625d 2c20 6368 756e 6b3d  y([a, b], chunk=
-0003a9d0: 6368 756e 6b2c 2061 6767 7265 6761 7465  chunk, aggregate
-0003a9e0: 3d61 6767 2920 2023 2064 6f63 7465 7374  =agg)  # doctest
-0003a9f0: 3a20 2b53 4b49 500a 2020 2020 2222 220a  : +SKIP.    """.
-0003aa00: 2020 2020 6966 2073 706c 6974 5f6f 7574      if split_out
-0003aa10: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0003aa20: 2020 7370 6c69 745f 6f75 7420 3d20 310a    split_out = 1.
-0003aa30: 2020 2020 6966 2063 6875 6e6b 5f6b 7761      if chunk_kwa
-0003aa40: 7267 7320 6973 204e 6f6e 653a 0a20 2020  rgs is None:.   
-0003aa50: 2020 2020 2063 6875 6e6b 5f6b 7761 7267       chunk_kwarg
-0003aa60: 7320 3d20 6469 6374 2829 0a20 2020 2069  s = dict().    i
-0003aa70: 6620 6167 6772 6567 6174 655f 6b77 6172  f aggregate_kwar
-0003aa80: 6773 2069 7320 4e6f 6e65 3a0a 2020 2020  gs is None:.    
-0003aa90: 2020 2020 6167 6772 6567 6174 655f 6b77      aggregate_kw
-0003aaa0: 6172 6773 203d 2064 6963 7428 290a 2020  args = dict().  
-0003aab0: 2020 6368 756e 6b5f 6b77 6172 6773 2e75    chunk_kwargs.u
-0003aac0: 7064 6174 6528 6b77 6172 6773 290a 2020  pdate(kwargs).  
-0003aad0: 2020 6167 6772 6567 6174 655f 6b77 6172    aggregate_kwar
-0003aae0: 6773 2e75 7064 6174 6528 6b77 6172 6773  gs.update(kwargs
-0003aaf0: 290a 0a20 2020 2069 6620 636f 6d62 696e  )..    if combin
-0003ab00: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-0003ab10: 2020 2069 6620 636f 6d62 696e 655f 6b77     if combine_kw
-0003ab20: 6172 6773 3a0a 2020 2020 2020 2020 2020  args:.          
-0003ab30: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0003ab40: 6f72 2822 6063 6f6d 6269 6e65 5f6b 7761  or("`combine_kwa
-0003ab50: 7267 7360 2070 726f 7669 6465 6420 7769  rgs` provided wi
-0003ab60: 7468 206e 6f20 6063 6f6d 6269 6e65 6022  th no `combine`"
-0003ab70: 290a 2020 2020 2020 2020 636f 6d62 696e  ).        combin
-0003ab80: 6520 3d20 6167 6772 6567 6174 650a 2020  e = aggregate.  
-0003ab90: 2020 2020 2020 636f 6d62 696e 655f 6b77        combine_kw
-0003aba0: 6172 6773 203d 2061 6767 7265 6761 7465  args = aggregate
-0003abb0: 5f6b 7761 7267 730a 2020 2020 656c 7365  _kwargs.    else
-0003abc0: 3a0a 2020 2020 2020 2020 6966 2063 6f6d  :.        if com
-0003abd0: 6269 6e65 5f6b 7761 7267 7320 6973 204e  bine_kwargs is N
-0003abe0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0003abf0: 2063 6f6d 6269 6e65 5f6b 7761 7267 7320   combine_kwargs 
-0003ac00: 3d20 6469 6374 2829 0a20 2020 2020 2020  = dict().       
-0003ac10: 2063 6f6d 6269 6e65 5f6b 7761 7267 732e   combine_kwargs.
-0003ac20: 7570 6461 7465 286b 7761 7267 7329 0a0a  update(kwargs)..
-0003ac30: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-0003ac40: 7461 6e63 6528 6172 6773 2c20 2874 7570  tance(args, (tup
-0003ac50: 6c65 2c20 6c69 7374 2929 3a0a 2020 2020  le, list)):.    
-0003ac60: 2020 2020 6172 6773 203d 205b 6172 6773      args = [args
-0003ac70: 5d0a 0a20 2020 2064 6673 203d 205b 6172  ]..    dfs = [ar
-0003ac80: 6720 666f 7220 6172 6720 696e 2061 7267  g for arg in arg
-0003ac90: 7320 6966 2069 7369 6e73 7461 6e63 6528  s if isinstance(
-0003aca0: 6172 672c 205f 4672 616d 6529 5d0a 0a20  arg, _Frame)].. 
-0003acb0: 2020 206e 7061 7274 6974 696f 6e73 203d     npartitions =
-0003acc0: 207b 6172 672e 6e70 6172 7469 7469 6f6e   {arg.npartition
-0003acd0: 7320 666f 7220 6172 6720 696e 2064 6673  s for arg in dfs
-0003ace0: 7d0a 2020 2020 6966 206c 656e 286e 7061  }.    if len(npa
-0003acf0: 7274 6974 696f 6e73 2920 3e20 313a 0a20  rtitions) > 1:. 
-0003ad00: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0003ad10: 7565 4572 726f 7228 2241 6c6c 2061 7267  ueError("All arg
-0003ad20: 756d 656e 7473 206d 7573 7420 6861 7665  uments must have
-0003ad30: 2073 616d 6520 6e75 6d62 6572 206f 6620   same number of 
-0003ad40: 7061 7274 6974 696f 6e73 2229 0a20 2020  partitions").   
-0003ad50: 206e 7061 7274 6974 696f 6e73 203d 206e   npartitions = n
-0003ad60: 7061 7274 6974 696f 6e73 2e70 6f70 2829  partitions.pop()
-0003ad70: 0a0a 2020 2020 6966 2073 706c 6974 5f65  ..    if split_e
-0003ad80: 7665 7279 2069 7320 4e6f 6e65 3a0a 2020  very is None:.  
-0003ad90: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
-0003ada0: 7920 3d20 380a 2020 2020 656c 6966 2073  y = 8.    elif s
-0003adb0: 706c 6974 5f65 7665 7279 2069 7320 4661  plit_every is Fa
-0003adc0: 6c73 653a 0a20 2020 2020 2020 2073 706c  lse:.        spl
-0003add0: 6974 5f65 7665 7279 203d 206e 7061 7274  it_every = npart
-0003ade0: 6974 696f 6e73 0a20 2020 2065 6c69 6620  itions.    elif 
-0003adf0: 7370 6c69 745f 6576 6572 7920 3c20 3220  split_every < 2 
-0003ae00: 6f72 206e 6f74 2069 7369 6e73 7461 6e63  or not isinstanc
-0003ae10: 6528 7370 6c69 745f 6576 6572 792c 2049  e(split_every, I
-0003ae20: 6e74 6567 7261 6c29 3a0a 2020 2020 2020  ntegral):.      
-0003ae30: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0003ae40: 6f72 2822 7370 6c69 745f 6576 6572 7920  or("split_every 
-0003ae50: 6d75 7374 2062 6520 616e 2069 6e74 6567  must be an integ
-0003ae60: 6572 203e 3d20 3222 290a 0a20 2020 2074  er >= 2")..    t
-0003ae70: 6f6b 656e 5f6b 6579 203d 2074 6f6b 656e  oken_key = token
-0003ae80: 697a 6528 0a20 2020 2020 2020 2074 6f6b  ize(.        tok
-0003ae90: 656e 206f 7220 2863 6875 6e6b 2c20 6167  en or (chunk, ag
-0003aea0: 6772 6567 6174 6529 2c0a 2020 2020 2020  gregate),.      
-0003aeb0: 2020 6d65 7461 2c0a 2020 2020 2020 2020    meta,.        
-0003aec0: 6172 6773 2c0a 2020 2020 2020 2020 6368  args,.        ch
-0003aed0: 756e 6b5f 6b77 6172 6773 2c0a 2020 2020  unk_kwargs,.    
-0003aee0: 2020 2020 6167 6772 6567 6174 655f 6b77      aggregate_kw
-0003aef0: 6172 6773 2c0a 2020 2020 2020 2020 636f  args,.        co
-0003af00: 6d62 696e 655f 6b77 6172 6773 2c0a 2020  mbine_kwargs,.  
-0003af10: 2020 2020 2020 7370 6c69 745f 6576 6572        split_ever
-0003af20: 792c 0a20 2020 2020 2020 2073 706c 6974  y,.        split
-0003af30: 5f6f 7574 2c0a 2020 2020 2020 2020 7370  _out,.        sp
-0003af40: 6c69 745f 6f75 745f 7365 7475 702c 0a20  lit_out_setup,. 
-0003af50: 2020 2020 2020 2073 706c 6974 5f6f 7574         split_out
-0003af60: 5f73 6574 7570 5f6b 7761 7267 732c 0a20  _setup_kwargs,. 
-0003af70: 2020 2029 0a0a 2020 2020 2320 426c 6f63     )..    # Bloc
-0003af80: 6b77 6973 6520 4368 756e 6b20 4c61 7965  kwise Chunk Laye
-0003af90: 720a 2020 2020 6368 756e 6b5f 6e61 6d65  r.    chunk_name
-0003afa0: 203d 2066 227b 746f 6b65 6e20 6f72 2066   = f"{token or f
-0003afb0: 756e 636e 616d 6528 6368 756e 6b29 7d2d  uncname(chunk)}-
-0003afc0: 6368 756e 6b2d 7b74 6f6b 656e 5f6b 6579  chunk-{token_key
-0003afd0: 7d22 0a20 2020 2063 6875 6e6b 6564 203d  }".    chunked =
-0003afe0: 206d 6170 5f62 6167 5f70 6172 7469 7469   map_bag_partiti
-0003aff0: 6f6e 7328 0a20 2020 2020 2020 2063 6875  ons(.        chu
-0003b000: 6e6b 2c0a 2020 2020 2020 2020 2320 436f  nk,.        # Co
-0003b010: 6e76 6572 7420 5f46 7261 6d65 2063 6f6c  nvert _Frame col
-0003b020: 6c65 6374 696f 6e73 2074 6f20 4261 670a  lections to Bag.
-0003b030: 2020 2020 2020 2020 2a5b 0a20 2020 2020          *[.     
-0003b040: 2020 2020 2020 2061 7267 2e74 6f5f 6261         arg.to_ba
-0003b050: 6728 666f 726d 6174 3d22 6672 616d 6522  g(format="frame"
-0003b060: 2920 6966 2069 7369 6e73 7461 6e63 6528  ) if isinstance(
-0003b070: 6172 672c 205f 4672 616d 6529 2065 6c73  arg, _Frame) els
-0003b080: 6520 6172 670a 2020 2020 2020 2020 2020  e arg.          
-0003b090: 2020 666f 7220 6172 6720 696e 2061 7267    for arg in arg
-0003b0a0: 730a 2020 2020 2020 2020 5d2c 0a20 2020  s.        ],.   
-0003b0b0: 2020 2020 2074 6f6b 656e 3d63 6875 6e6b       token=chunk
-0003b0c0: 5f6e 616d 652c 0a20 2020 2020 2020 202a  _name,.        *
-0003b0d0: 2a63 6875 6e6b 5f6b 7761 7267 732c 0a20  *chunk_kwargs,. 
-0003b0e0: 2020 2029 0a0a 2020 2020 2320 4e4f 5445     )..    # NOTE
-0003b0f0: 3a20 6063 6875 6e6b 6564 6020 6973 206e  : `chunked` is n
-0003b100: 6f77 2061 2042 6167 2063 6f6c 6c65 6374  ow a Bag collect
-0003b110: 696f 6e2e 0a20 2020 2023 2057 6520 646f  ion..    # We do
-0003b120: 6e27 7420 7573 6520 6120 4461 7461 4672  n't use a DataFr
-0003b130: 616d 6520 636f 6c6c 6563 7469 6f6e 2c20  ame collection, 
-0003b140: 6265 6361 7573 650a 2020 2020 2320 7468  because.    # th
-0003b150: 6520 7061 7274 6974 696f 6e73 206d 6179  e partitions may
-0003b160: 206e 6f74 2063 6f6e 7461 696e 2064 6174   not contain dat
-0003b170: 6166 7261 6d65 2d6c 696b 650a 2020 2020  aframe-like.    
-0003b180: 2320 6f62 6a65 6374 7320 616e 796d 6f72  # objects anymor
-0003b190: 652e 0a0a 2020 2020 2320 426c 6f63 6b77  e...    # Blockw
-0003b1a0: 6973 6520 5370 6c69 7420 4c61 7965 720a  ise Split Layer.
-0003b1b0: 2020 2020 6966 2073 706c 6974 5f6f 7574      if split_out
-0003b1c0: 2061 6e64 2073 706c 6974 5f6f 7574 203e   and split_out >
-0003b1d0: 2031 3a0a 2020 2020 2020 2020 6368 756e   1:.        chun
-0003b1e0: 6b65 6420 3d20 6368 756e 6b65 642e 6d61  ked = chunked.ma
-0003b1f0: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
-0003b200: 2020 2020 2020 2020 2020 6861 7368 5f73            hash_s
-0003b210: 6861 7264 2c0a 2020 2020 2020 2020 2020  hard,.          
-0003b220: 2020 7370 6c69 745f 6f75 742c 0a20 2020    split_out,.   
-0003b230: 2020 2020 2020 2020 2073 706c 6974 5f6f           split_o
-0003b240: 7574 5f73 6574 7570 2c0a 2020 2020 2020  ut_setup,.      
-0003b250: 2020 2020 2020 7370 6c69 745f 6f75 745f        split_out_
-0003b260: 7365 7475 705f 6b77 6172 6773 2c0a 2020  setup_kwargs,.  
-0003b270: 2020 2020 2020 2020 2020 6967 6e6f 7265            ignore
-0003b280: 5f69 6e64 6578 2c0a 2020 2020 2020 2020  _index,.        
-0003b290: 2020 2020 746f 6b65 6e3d 2273 706c 6974      token="split
-0003b2a0: 2d25 7322 2025 2074 6f6b 656e 5f6b 6579  -%s" % token_key
-0003b2b0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-0003b2c0: 2023 2048 616e 646c 6520 736f 7274 2062   # Handle sort b
-0003b2d0: 6568 6176 696f 720a 2020 2020 6966 2073  ehavior.    if s
-0003b2e0: 6f72 7420 6973 206e 6f74 204e 6f6e 653a  ort is not None:
-0003b2f0: 0a20 2020 2020 2020 2069 6620 736f 7274  .        if sort
-0003b300: 2061 6e64 2073 706c 6974 5f6f 7574 203e   and split_out >
-0003b310: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-0003b320: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-0003b330: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
-0003b340: 2020 2020 2020 2020 2020 2022 4361 6e6e             "Cann
-0003b350: 6f74 2067 7561 7261 6e74 6565 2073 6f72  ot guarantee sor
-0003b360: 7465 6420 6b65 7973 2066 6f72 2060 7370  ted keys for `sp
-0003b370: 6c69 745f 6f75 743e 3160 2e22 0a20 2020  lit_out>1`.".   
-0003b380: 2020 2020 2020 2020 2020 2020 2022 2054               " T
-0003b390: 7279 2075 7369 6e67 2073 706c 6974 5f6f  ry using split_o
-0003b3a0: 7574 3d31 2c20 6f72 2067 726f 7570 696e  ut=1, or groupin
-0003b3b0: 6720 7769 7468 2073 6f72 743d 4661 6c73  g with sort=Fals
-0003b3c0: 652e 220a 2020 2020 2020 2020 2020 2020  e.".            
-0003b3d0: 290a 2020 2020 2020 2020 6167 6772 6567  ).        aggreg
-0003b3e0: 6174 655f 6b77 6172 6773 203d 2061 6767  ate_kwargs = agg
-0003b3f0: 7265 6761 7465 5f6b 7761 7267 7320 6f72  regate_kwargs or
-0003b400: 207b 7d0a 2020 2020 2020 2020 6167 6772   {}.        aggr
-0003b410: 6567 6174 655f 6b77 6172 6773 5b22 736f  egate_kwargs["so
-0003b420: 7274 225d 203d 2073 6f72 740a 0a20 2020  rt"] = sort..   
-0003b430: 2023 2054 7265 652d 5265 6475 6374 696f   # Tree-Reductio
-0003b440: 6e20 4c61 7965 720a 2020 2020 6669 6e61  n Layer.    fina
-0003b450: 6c5f 6e61 6d65 203d 2066 227b 746f 6b65  l_name = f"{toke
-0003b460: 6e20 6f72 2066 756e 636e 616d 6528 6167  n or funcname(ag
-0003b470: 6772 6567 6174 6529 7d2d 6167 672d 7b74  gregate)}-agg-{t
-0003b480: 6f6b 656e 5f6b 6579 7d22 0a20 2020 206c  oken_key}".    l
-0003b490: 6179 6572 203d 2044 6174 6146 7261 6d65  ayer = DataFrame
-0003b4a0: 5472 6565 5265 6475 6374 696f 6e28 0a20  TreeReduction(. 
-0003b4b0: 2020 2020 2020 2066 696e 616c 5f6e 616d         final_nam
-0003b4c0: 652c 0a20 2020 2020 2020 2063 6875 6e6b  e,.        chunk
-0003b4d0: 6564 2e6e 616d 652c 0a20 2020 2020 2020  ed.name,.       
-0003b4e0: 206e 7061 7274 6974 696f 6e73 2c0a 2020   npartitions,.  
-0003b4f0: 2020 2020 2020 7061 7274 6961 6c28 5f63        partial(_c
-0003b500: 6f6e 6361 742c 2069 676e 6f72 655f 696e  oncat, ignore_in
-0003b510: 6465 783d 6967 6e6f 7265 5f69 6e64 6578  dex=ignore_index
-0003b520: 292c 0a20 2020 2020 2020 2070 6172 7469  ),.        parti
-0003b530: 616c 2863 6f6d 6269 6e65 2c20 2a2a 636f  al(combine, **co
-0003b540: 6d62 696e 655f 6b77 6172 6773 2920 6966  mbine_kwargs) if
-0003b550: 2063 6f6d 6269 6e65 5f6b 7761 7267 7320   combine_kwargs 
-0003b560: 656c 7365 2063 6f6d 6269 6e65 2c0a 2020  else combine,.  
-0003b570: 2020 2020 2020 6669 6e61 6c69 7a65 5f66        finalize_f
-0003b580: 756e 633d 7061 7274 6961 6c28 6167 6772  unc=partial(aggr
-0003b590: 6567 6174 652c 202a 2a61 6767 7265 6761  egate, **aggrega
-0003b5a0: 7465 5f6b 7761 7267 7329 0a20 2020 2020  te_kwargs).     
-0003b5b0: 2020 2069 6620 6167 6772 6567 6174 655f     if aggregate_
-0003b5c0: 6b77 6172 6773 0a20 2020 2020 2020 2065  kwargs.        e
-0003b5d0: 6c73 6520 6167 6772 6567 6174 652c 0a20  lse aggregate,. 
-0003b5e0: 2020 2020 2020 2073 706c 6974 5f65 7665         split_eve
-0003b5f0: 7279 3d73 706c 6974 5f65 7665 7279 2c0a  ry=split_every,.
-0003b600: 2020 2020 2020 2020 7370 6c69 745f 6f75          split_ou
-0003b610: 743d 7370 6c69 745f 6f75 7420 6966 2028  t=split_out if (
-0003b620: 7370 6c69 745f 6f75 7420 616e 6420 7370  split_out and sp
-0003b630: 6c69 745f 6f75 7420 3e20 3129 2065 6c73  lit_out > 1) els
-0003b640: 6520 4e6f 6e65 2c0a 2020 2020 2020 2020  e None,.        
-0003b650: 7472 6565 5f6e 6f64 655f 6e61 6d65 3d66  tree_node_name=f
-0003b660: 227b 746f 6b65 6e20 6f72 2066 756e 636e  "{token or funcn
-0003b670: 616d 6528 636f 6d62 696e 6529 7d2d 636f  ame(combine)}-co
-0003b680: 6d62 696e 652d 7b74 6f6b 656e 5f6b 6579  mbine-{token_key
-0003b690: 7d22 2c0a 2020 2020 290a 0a20 2020 2069  }",.    )..    i
-0003b6a0: 6620 6d65 7461 2069 7320 6e6f 5f64 6566  f meta is no_def
-0003b6b0: 6175 6c74 3a0a 2020 2020 2020 2020 6d65  ault:.        me
-0003b6c0: 7461 5f63 6875 6e6b 203d 205f 656d 756c  ta_chunk = _emul
-0003b6d0: 6174 6528 6368 756e 6b2c 202a 6172 6773  ate(chunk, *args
-0003b6e0: 2c20 7564 663d 5472 7565 2c20 2a2a 6368  , udf=True, **ch
-0003b6f0: 756e 6b5f 6b77 6172 6773 290a 2020 2020  unk_kwargs).    
-0003b700: 2020 2020 6d65 7461 203d 205f 656d 756c      meta = _emul
-0003b710: 6174 6528 0a20 2020 2020 2020 2020 2020  ate(.           
-0003b720: 2061 6767 7265 6761 7465 2c20 5f63 6f6e   aggregate, _con
-0003b730: 6361 7428 5b6d 6574 615f 6368 756e 6b5d  cat([meta_chunk]
-0003b740: 2c20 6967 6e6f 7265 5f69 6e64 6578 292c  , ignore_index),
-0003b750: 2075 6466 3d54 7275 652c 202a 2a61 6767   udf=True, **agg
-0003b760: 7265 6761 7465 5f6b 7761 7267 730a 2020  regate_kwargs.  
-0003b770: 2020 2020 2020 290a 2020 2020 6d65 7461        ).    meta
-0003b780: 203d 206d 616b 655f 6d65 7461 280a 2020   = make_meta(.  
-0003b790: 2020 2020 2020 6d65 7461 2c0a 2020 2020        meta,.    
-0003b7a0: 2020 2020 696e 6465 783d 2867 6574 6174      index=(getat
-0003b7b0: 7472 286d 616b 655f 6d65 7461 2864 6673  tr(make_meta(dfs
-0003b7c0: 5b30 5d29 2c20 2269 6e64 6578 222c 204e  [0]), "index", N
-0003b7d0: 6f6e 6529 2069 6620 6466 7320 656c 7365  one) if dfs else
-0003b7e0: 204e 6f6e 6529 2c0a 2020 2020 2020 2020   None),.        
-0003b7f0: 7061 7265 6e74 5f6d 6574 613d 6466 735b  parent_meta=dfs[
-0003b800: 305d 2e5f 6d65 7461 2c0a 2020 2020 290a  0]._meta,.    ).
-0003b810: 0a20 2020 2067 7261 7068 203d 2048 6967  .    graph = Hig
-0003b820: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-0003b830: 5f63 6f6c 6c65 6374 696f 6e73 2866 696e  _collections(fin
-0003b840: 616c 5f6e 616d 652c 206c 6179 6572 2c20  al_name, layer, 
-0003b850: 6465 7065 6e64 656e 6369 6573 3d28 6368  dependencies=(ch
-0003b860: 756e 6b65 642c 2929 0a20 2020 2064 6976  unked,)).    div
-0003b870: 6973 696f 6e73 203d 205b 4e6f 6e65 5d20  isions = [None] 
-0003b880: 2a20 2828 7370 6c69 745f 6f75 7420 6f72  * ((split_out or
-0003b890: 2031 2920 2b20 3129 0a20 2020 2072 6574   1) + 1).    ret
-0003b8a0: 7572 6e20 6e65 775f 6464 5f6f 626a 6563  urn new_dd_objec
-0003b8b0: 7428 6772 6170 682c 2066 696e 616c 5f6e  t(graph, final_n
-0003b8c0: 616d 652c 206d 6574 612c 2064 6976 6973  ame, meta, divis
-0003b8d0: 696f 6e73 2c20 7061 7265 6e74 5f6d 6574  ions, parent_met
-0003b8e0: 613d 6466 735b 305d 2e5f 6d65 7461 290a  a=dfs[0]._meta).
-0003b8f0: 0a0a 6163 6120 3d20 6170 706c 795f 636f  ..aca = apply_co
-0003b900: 6e63 6174 5f61 7070 6c79 0a0a 0a64 6566  ncat_apply...def
-0003b910: 205f 6578 7472 6163 745f 6d65 7461 2878   _extract_meta(x
-0003b920: 2c20 6e6f 6e65 6d70 7479 3d46 616c 7365  , nonempty=False
-0003b930: 293a 0a20 2020 2022 2222 0a20 2020 2045  ):.    """.    E
-0003b940: 7874 7261 6374 2069 6e74 6572 6e61 6c20  xtract internal 
-0003b950: 6361 6368 6520 6461 7461 2028 6060 5f6d  cache data (``_m
-0003b960: 6574 6160 6029 2066 726f 6d20 6464 2e44  eta``) from dd.D
-0003b970: 6174 6146 7261 6d65 202f 2064 642e 5365  ataFrame / dd.Se
-0003b980: 7269 6573 0a20 2020 2022 2222 0a20 2020  ries.    """.   
-0003b990: 2069 6620 6973 696e 7374 616e 6365 2878   if isinstance(x
-0003b9a0: 2c20 2853 6361 6c61 722c 205f 4672 616d  , (Scalar, _Fram
-0003b9b0: 6529 293a 0a20 2020 2020 2020 2072 6574  e)):.        ret
-0003b9c0: 7572 6e20 782e 5f6d 6574 615f 6e6f 6e65  urn x._meta_none
-0003b9d0: 6d70 7479 2069 6620 6e6f 6e65 6d70 7479  mpty if nonempty
-0003b9e0: 2065 6c73 6520 782e 5f6d 6574 610a 2020   else x._meta.  
-0003b9f0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-0003ba00: 6528 782c 206c 6973 7429 3a0a 2020 2020  e(x, list):.    
-0003ba10: 2020 2020 7265 7475 726e 205b 5f65 7874      return [_ext
-0003ba20: 7261 6374 5f6d 6574 6128 5f78 2c20 6e6f  ract_meta(_x, no
-0003ba30: 6e65 6d70 7479 2920 666f 7220 5f78 2069  nempty) for _x i
-0003ba40: 6e20 785d 0a20 2020 2065 6c69 6620 6973  n x].    elif is
-0003ba50: 696e 7374 616e 6365 2878 2c20 7475 706c  instance(x, tupl
-0003ba60: 6529 3a0a 2020 2020 2020 2020 7265 7475  e):.        retu
-0003ba70: 726e 2074 7570 6c65 285f 6578 7472 6163  rn tuple(_extrac
-0003ba80: 745f 6d65 7461 285f 782c 206e 6f6e 656d  t_meta(_x, nonem
-0003ba90: 7074 7929 2066 6f72 205f 7820 696e 2078  pty) for _x in x
-0003baa0: 290a 2020 2020 656c 6966 2069 7369 6e73  ).    elif isins
-0003bab0: 7461 6e63 6528 782c 2064 6963 7429 3a0a  tance(x, dict):.
-0003bac0: 2020 2020 2020 2020 7265 7320 3d20 7b7d          res = {}
-0003bad0: 0a20 2020 2020 2020 2066 6f72 206b 2069  .        for k i
-0003bae0: 6e20 783a 0a20 2020 2020 2020 2020 2020  n x:.           
-0003baf0: 2072 6573 5b6b 5d20 3d20 5f65 7874 7261   res[k] = _extra
-0003bb00: 6374 5f6d 6574 6128 785b 6b5d 2c20 6e6f  ct_meta(x[k], no
-0003bb10: 6e65 6d70 7479 290a 2020 2020 2020 2020  nempty).        
-0003bb20: 7265 7475 726e 2072 6573 0a20 2020 2065  return res.    e
-0003bb30: 6c69 6620 6973 696e 7374 616e 6365 2878  lif isinstance(x
-0003bb40: 2c20 4465 6c61 7965 6429 3a0a 2020 2020  , Delayed):.    
-0003bb50: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0003bb60: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0003bb70: 2020 2243 616e 6e6f 7420 696e 6665 7220    "Cannot infer 
-0003bb80: 6461 7461 6672 616d 6520 6d65 7461 6461  dataframe metada
-0003bb90: 7461 2077 6974 6820 6120 6064 6173 6b2e  ta with a `dask.
-0003bba0: 6465 6c61 7965 6460 2061 7267 756d 656e  delayed` argumen
-0003bbb0: 7422 0a20 2020 2020 2020 2029 0a20 2020  t".        ).   
-0003bbc0: 2065 6c73 653a 0a20 2020 2020 2020 2072   else:.        r
-0003bbd0: 6574 7572 6e20 780a 0a0a 6465 6620 5f65  eturn x...def _e
-0003bbe0: 6d75 6c61 7465 2866 756e 632c 202a 6172  mulate(func, *ar
-0003bbf0: 6773 2c20 7564 663d 4661 6c73 652c 202a  gs, udf=False, *
-0003bc00: 2a6b 7761 7267 7329 3a0a 2020 2020 2222  *kwargs):.    ""
-0003bc10: 220a 2020 2020 4170 706c 7920 6120 6675  ".    Apply a fu
-0003bc20: 6e63 7469 6f6e 2075 7369 6e67 2061 7267  nction using arg
-0003bc30: 7320 2f20 6b77 6172 6773 2e20 4966 2061  s / kwargs. If a
-0003bc40: 7267 756d 656e 7473 2063 6f6e 7461 696e  rguments contain
-0003bc50: 2064 642e 4461 7461 4672 616d 6520 2f0a   dd.DataFrame /.
-0003bc60: 2020 2020 6464 2e53 6572 6965 732c 2075      dd.Series, u
-0003bc70: 7369 6e67 2069 6e74 6572 6e61 6c20 6361  sing internal ca
-0003bc80: 6368 6520 2860 605f 6d65 7461 6060 2920  che (``_meta``) 
-0003bc90: 666f 7220 6361 6c63 756c 6174 696f 6e0a  for calculation.
-0003bca0: 2020 2020 2222 220a 2020 2020 7769 7468      """.    with
-0003bcb0: 2072 6169 7365 5f6f 6e5f 6d65 7461 5f65   raise_on_meta_e
-0003bcc0: 7272 6f72 2866 756e 636e 616d 6528 6675  rror(funcname(fu
-0003bcd0: 6e63 292c 2075 6466 3d75 6466 292c 2063  nc), udf=udf), c
-0003bce0: 6865 636b 5f6e 756d 6572 6963 5f6f 6e6c  heck_numeric_onl
-0003bcf0: 795f 6465 7072 6563 6174 696f 6e28 293a  y_deprecation():
-0003bd00: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0003bd10: 6675 6e63 282a 5f65 7874 7261 6374 5f6d  func(*_extract_m
-0003bd20: 6574 6128 6172 6773 2c20 5472 7565 292c  eta(args, True),
-0003bd30: 202a 2a5f 6578 7472 6163 745f 6d65 7461   **_extract_meta
-0003bd40: 286b 7761 7267 732c 2054 7275 6529 290a  (kwargs, True)).
-0003bd50: 0a0a 4069 6e73 6572 745f 6d65 7461 5f70  ..@insert_meta_p
-0003bd60: 6172 616d 5f64 6573 6372 6970 7469 6f6e  aram_description
-0003bd70: 0a64 6566 206d 6170 5f70 6172 7469 7469  .def map_partiti
-0003bd80: 6f6e 7328 0a20 2020 2066 756e 632c 0a20  ons(.    func,. 
-0003bd90: 2020 202a 6172 6773 2c0a 2020 2020 6d65     *args,.    me
-0003bda0: 7461 3d6e 6f5f 6465 6661 756c 742c 0a20  ta=no_default,. 
-0003bdb0: 2020 2065 6e66 6f72 6365 5f6d 6574 6164     enforce_metad
-0003bdc0: 6174 613d 5472 7565 2c0a 2020 2020 7472  ata=True,.    tr
-0003bdd0: 616e 7366 6f72 6d5f 6469 7669 7369 6f6e  ansform_division
-0003bde0: 733d 5472 7565 2c0a 2020 2020 616c 6967  s=True,.    alig
-0003bdf0: 6e5f 6461 7461 6672 616d 6573 3d54 7275  n_dataframes=Tru
-0003be00: 652c 0a20 2020 202a 2a6b 7761 7267 732c  e,.    **kwargs,
-0003be10: 0a29 3a0a 2020 2020 2222 2241 7070 6c79  .):.    """Apply
-0003be20: 2050 7974 686f 6e20 6675 6e63 7469 6f6e   Python function
-0003be30: 206f 6e20 6561 6368 2044 6174 6146 7261   on each DataFra
-0003be40: 6d65 2070 6172 7469 7469 6f6e 2e0a 0a20  me partition... 
-0003be50: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0003be60: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-0003be70: 2066 756e 6320 3a20 6675 6e63 7469 6f6e   func : function
-0003be80: 0a20 2020 2020 2020 2046 756e 6374 696f  .        Functio
-0003be90: 6e20 6170 706c 6965 6420 746f 2065 6163  n applied to eac
-0003bea0: 6820 7061 7274 6974 696f 6e2e 0a20 2020  h partition..   
-0003beb0: 2061 7267 732c 206b 7761 7267 7320 3a0a   args, kwargs :.
-0003bec0: 2020 2020 2020 2020 4172 6775 6d65 6e74          Argument
-0003bed0: 7320 616e 6420 6b65 7977 6f72 6473 2074  s and keywords t
-0003bee0: 6f20 7061 7373 2074 6f20 7468 6520 6675  o pass to the fu
-0003bef0: 6e63 7469 6f6e 2e20 2041 7420 6c65 6173  nction.  At leas
-0003bf00: 7420 6f6e 6520 6f66 2074 6865 0a20 2020  t one of the.   
-0003bf10: 2020 2020 2061 7267 7320 7368 6f75 6c64       args should
-0003bf20: 2062 6520 6120 4461 736b 2e64 6174 6166   be a Dask.dataf
-0003bf30: 7261 6d65 2e20 4172 6775 6d65 6e74 7320  rame. Arguments 
-0003bf40: 616e 6420 6b65 7977 6f72 6473 206d 6179  and keywords may
-0003bf50: 2063 6f6e 7461 696e 0a20 2020 2020 2020   contain.       
-0003bf60: 2060 6053 6361 6c61 7260 602c 2060 6044   ``Scalar``, ``D
-0003bf70: 656c 6179 6564 6060 206f 7220 7265 6775  elayed`` or regu
-0003bf80: 6c61 7220 7079 7468 6f6e 206f 626a 6563  lar python objec
-0003bf90: 7473 2e20 4461 7461 4672 616d 652d 6c69  ts. DataFrame-li
-0003bfa0: 6b65 2061 7267 730a 2020 2020 2020 2020  ke args.        
-0003bfb0: 2862 6f74 6820 6461 736b 2061 6e64 2070  (both dask and p
-0003bfc0: 616e 6461 7329 2077 696c 6c20 6265 2072  andas) will be r
-0003bfd0: 6570 6172 7469 7469 6f6e 6564 2074 6f20  epartitioned to 
-0003bfe0: 616c 6967 6e20 2869 6620 6e65 6365 7373  align (if necess
-0003bff0: 6172 7929 0a20 2020 2020 2020 2062 6566  ary).        bef
-0003c000: 6f72 6520 6170 706c 7969 6e67 2074 6865  ore applying the
-0003c010: 2066 756e 6374 696f 6e20 2873 6565 2060   function (see `
-0003c020: 6061 6c69 676e 5f64 6174 6166 7261 6d65  `align_dataframe
-0003c030: 7360 6020 746f 2063 6f6e 7472 6f6c 292e  s`` to control).
-0003c040: 0a20 2020 2065 6e66 6f72 6365 5f6d 6574  .    enforce_met
-0003c050: 6164 6174 6120 3a20 626f 6f6c 2c20 6465  adata : bool, de
-0003c060: 6661 756c 7420 5472 7565 0a20 2020 2020  fault True.     
-0003c070: 2020 2057 6865 7468 6572 2074 6f20 656e     Whether to en
-0003c080: 666f 7263 6520 6174 2072 756e 7469 6d65  force at runtime
-0003c090: 2074 6861 7420 7468 6520 7374 7275 6374   that the struct
-0003c0a0: 7572 6520 6f66 2074 6865 2044 6174 6146  ure of the DataF
-0003c0b0: 7261 6d65 0a20 2020 2020 2020 2070 726f  rame.        pro
-0003c0c0: 6475 6365 6420 6279 2060 6066 756e 6360  duced by ``func`
-0003c0d0: 6020 6163 7475 616c 6c79 206d 6174 6368  ` actually match
-0003c0e0: 6573 2074 6865 2073 7472 7563 7475 7265  es the structure
-0003c0f0: 206f 6620 6060 6d65 7461 6060 2e0a 2020   of ``meta``..  
-0003c100: 2020 2020 2020 5468 6973 2077 696c 6c20        This will 
-0003c110: 7265 6e61 6d65 2061 6e64 2072 656f 7264  rename and reord
-0003c120: 6572 2063 6f6c 756d 6e73 2066 6f72 2065  er columns for e
-0003c130: 6163 6820 7061 7274 6974 696f 6e2c 0a20  ach partition,. 
-0003c140: 2020 2020 2020 2061 6e64 2077 696c 6c20         and will 
-0003c150: 7261 6973 6520 616e 2065 7272 6f72 2069  raise an error i
-0003c160: 6620 7468 6973 2064 6f65 736e 2774 2077  f this doesn't w
-0003c170: 6f72 6b2c 0a20 2020 2020 2020 2062 7574  ork,.        but
-0003c180: 2069 7420 776f 6e27 7420 7261 6973 6520   it won't raise 
-0003c190: 6966 2064 7479 7065 7320 646f 6e27 7420  if dtypes don't 
-0003c1a0: 6d61 7463 682e 0a20 2020 2074 7261 6e73  match..    trans
-0003c1b0: 666f 726d 5f64 6976 6973 696f 6e73 203a  form_divisions :
-0003c1c0: 2062 6f6f 6c2c 2064 6566 6175 6c74 2054   bool, default T
-0003c1d0: 7275 650a 2020 2020 2020 2020 5768 6574  rue.        Whet
-0003c1e0: 6865 7220 746f 2061 7070 6c79 2074 6865  her to apply the
-0003c1f0: 2066 756e 6374 696f 6e20 6f6e 746f 2074   function onto t
-0003c200: 6865 2064 6976 6973 696f 6e73 2061 6e64  he divisions and
-0003c210: 2061 7070 6c79 2074 686f 7365 0a20 2020   apply those.   
-0003c220: 2020 2020 2074 7261 6e73 666f 726d 6564       transformed
-0003c230: 2064 6976 6973 696f 6e73 2074 6f20 7468   divisions to th
-0003c240: 6520 6f75 7470 7574 2e0a 2020 2020 616c  e output..    al
-0003c250: 6967 6e5f 6461 7461 6672 616d 6573 203a  ign_dataframes :
-0003c260: 2062 6f6f 6c2c 2064 6566 6175 6c74 2054   bool, default T
-0003c270: 7275 650a 2020 2020 2020 2020 5768 6574  rue.        Whet
-0003c280: 6865 7220 746f 2072 6570 6172 7469 7469  her to repartiti
-0003c290: 6f6e 2044 6174 6146 7261 6d65 2d20 6f72  on DataFrame- or
-0003c2a0: 2053 6572 6965 732d 6c69 6b65 2061 7267   Series-like arg
-0003c2b0: 730a 2020 2020 2020 2020 2862 6f74 6820  s.        (both 
-0003c2c0: 6461 736b 2061 6e64 2070 616e 6461 7329  dask and pandas)
-0003c2d0: 2073 6f20 7468 6569 7220 6469 7669 7369   so their divisi
-0003c2e0: 6f6e 7320 616c 6967 6e20 6265 666f 7265  ons align before
-0003c2f0: 2061 7070 6c79 696e 670a 2020 2020 2020   applying.      
-0003c300: 2020 7468 6520 6675 6e63 7469 6f6e 2e20    the function. 
-0003c310: 5468 6973 2072 6571 7569 7265 7320 616c  This requires al
-0003c320: 6c20 696e 7075 7473 2074 6f20 6861 7665  l inputs to have
-0003c330: 206b 6e6f 776e 2064 6976 6973 696f 6e73   known divisions
-0003c340: 2e0a 2020 2020 2020 2020 5369 6e67 6c65  ..        Single
-0003c350: 2d70 6172 7469 7469 6f6e 2069 6e70 7574  -partition input
-0003c360: 7320 7769 6c6c 2062 6520 7370 6c69 7420  s will be split 
-0003c370: 696e 746f 206d 756c 7469 706c 6520 7061  into multiple pa
-0003c380: 7274 6974 696f 6e73 2e0a 0a20 2020 2020  rtitions...     
-0003c390: 2020 2049 6620 4661 6c73 652c 2061 6c6c     If False, all
-0003c3a0: 2069 6e70 7574 7320 6d75 7374 2068 6176   inputs must hav
-0003c3b0: 6520 6569 7468 6572 2074 6865 2073 616d  e either the sam
-0003c3c0: 6520 6e75 6d62 6572 206f 6620 7061 7274  e number of part
-0003c3d0: 6974 696f 6e73 0a20 2020 2020 2020 206f  itions.        o
-0003c3e0: 7220 6120 7369 6e67 6c65 2070 6172 7469  r a single parti
-0003c3f0: 7469 6f6e 2e20 5369 6e67 6c65 2d70 6172  tion. Single-par
+0003a4f0: 2020 2061 6767 7265 6761 7465 5f6b 7761     aggregate_kwa
+0003a500: 7267 7320 3a20 6469 6374 2c20 6f70 7469  rgs : dict, opti
+0003a510: 6f6e 616c 0a20 2020 2020 2020 204b 6579  onal.        Key
+0003a520: 776f 7264 7320 666f 7220 7468 6520 6167  words for the ag
+0003a530: 6772 6567 6174 6520 6675 6e63 7469 6f6e  gregate function
+0003a540: 206f 6e6c 792e 0a20 2020 2063 6f6d 6269   only..    combi
+0003a550: 6e65 5f6b 7761 7267 7320 3a20 6469 6374  ne_kwargs : dict
+0003a560: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0003a570: 2020 204b 6579 776f 7264 7320 666f 7220     Keywords for 
+0003a580: 7468 6520 636f 6d62 696e 6520 6675 6e63  the combine func
+0003a590: 7469 6f6e 206f 6e6c 792e 0a20 2020 2073  tion only..    s
+0003a5a0: 706c 6974 5f65 7665 7279 203a 2069 6e74  plit_every : int
+0003a5b0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0003a5c0: 2020 2047 726f 7570 2070 6172 7469 7469     Group partiti
+0003a5d0: 6f6e 7320 696e 746f 2067 726f 7570 7320  ons into groups 
+0003a5e0: 6f66 2074 6869 7320 7369 7a65 2077 6869  of this size whi
+0003a5f0: 6c65 2070 6572 666f 726d 696e 6720 610a  le performing a.
+0003a600: 2020 2020 2020 2020 7472 6565 2d72 6564          tree-red
+0003a610: 7563 7469 6f6e 2e20 4966 2073 6574 2074  uction. If set t
+0003a620: 6f20 4661 6c73 652c 206e 6f20 7472 6565  o False, no tree
+0003a630: 2d72 6564 7563 7469 6f6e 2077 696c 6c20  -reduction will 
+0003a640: 6265 2075 7365 642c 0a20 2020 2020 2020  be used,.       
+0003a650: 2061 6e64 2061 6c6c 2069 6e74 6572 6d65   and all interme
+0003a660: 6469 6174 6573 2077 696c 6c20 6265 2063  diates will be c
+0003a670: 6f6e 6361 7465 6e61 7465 6420 616e 6420  oncatenated and 
+0003a680: 7061 7373 6564 2074 6f20 6060 6167 6772  passed to ``aggr
+0003a690: 6567 6174 6560 602e 0a20 2020 2020 2020  egate``..       
+0003a6a0: 2044 6566 6175 6c74 2069 7320 382e 0a20   Default is 8.. 
+0003a6b0: 2020 2073 706c 6974 5f6f 7574 203a 2069     split_out : i
+0003a6c0: 6e74 2c20 6f70 7469 6f6e 616c 0a20 2020  nt, optional.   
+0003a6d0: 2020 2020 204e 756d 6265 7220 6f66 206f       Number of o
+0003a6e0: 7574 7075 7420 7061 7274 6974 696f 6e73  utput partitions
+0003a6f0: 2e20 5370 6c69 7420 6f63 6375 7273 2061  . Split occurs a
+0003a700: 6674 6572 2066 6972 7374 2063 6875 6e6b  fter first chunk
+0003a710: 2072 6564 7563 7469 6f6e 2e0a 2020 2020   reduction..    
+0003a720: 7370 6c69 745f 6f75 745f 7365 7475 7020  split_out_setup 
+0003a730: 3a20 6361 6c6c 6162 6c65 2c20 6f70 7469  : callable, opti
+0003a740: 6f6e 616c 0a20 2020 2020 2020 2049 6620  onal.        If 
+0003a750: 7072 6f76 6964 6564 2c20 7468 6973 2066  provided, this f
+0003a760: 756e 6374 696f 6e20 6973 2063 616c 6c65  unction is calle
+0003a770: 6420 6f6e 2065 6163 6820 6368 756e 6b20  d on each chunk 
+0003a780: 6265 666f 7265 2070 6572 666f 726d 696e  before performin
+0003a790: 670a 2020 2020 2020 2020 7468 6520 6861  g.        the ha
+0003a7a0: 7368 2d73 706c 6974 2e20 4974 2073 686f  sh-split. It sho
+0003a7b0: 756c 6420 7265 7475 726e 2061 2070 616e  uld return a pan
+0003a7c0: 6461 7320 6f62 6a65 6374 2c20 7768 6572  das object, wher
+0003a7d0: 6520 6561 6368 2072 6f77 0a20 2020 2020  e each row.     
+0003a7e0: 2020 2028 6578 636c 7564 696e 6720 7468     (excluding th
+0003a7f0: 6520 696e 6465 7829 2069 7320 6861 7368  e index) is hash
+0003a800: 6564 2e20 4966 206e 6f74 2070 726f 7669  ed. If not provi
+0003a810: 6465 642c 2074 6865 2063 6875 6e6b 2069  ded, the chunk i
+0003a820: 7320 6861 7368 6564 0a20 2020 2020 2020  s hashed.       
+0003a830: 2061 7320 6973 2e0a 2020 2020 7370 6c69   as is..    spli
+0003a840: 745f 6f75 745f 7365 7475 705f 6b77 6172  t_out_setup_kwar
+0003a850: 6773 203a 2064 6963 742c 206f 7074 696f  gs : dict, optio
+0003a860: 6e61 6c0a 2020 2020 2020 2020 4b65 7977  nal.        Keyw
+0003a870: 6f72 6473 2066 6f72 2074 6865 2060 7370  ords for the `sp
+0003a880: 6c69 745f 6f75 745f 7365 7475 7060 2066  lit_out_setup` f
+0003a890: 756e 6374 696f 6e20 6f6e 6c79 2e0a 2020  unction only..  
+0003a8a0: 2020 736f 7274 203a 2062 6f6f 6c2c 2064    sort : bool, d
+0003a8b0: 6566 6175 6c74 204e 6f6e 650a 2020 2020  efault None.    
+0003a8c0: 2020 2020 4966 2061 6c6c 6f77 6564 2c20      If allowed, 
+0003a8d0: 736f 7274 2074 6865 206b 6579 7320 6f66  sort the keys of
+0003a8e0: 2074 6865 206f 7574 7075 7420 6167 6772   the output aggr
+0003a8f0: 6567 6174 696f 6e2e 0a20 2020 2069 676e  egation..    ign
+0003a900: 6f72 655f 696e 6465 7820 3a20 626f 6f6c  ore_index : bool
+0003a910: 2c20 6465 6661 756c 7420 4661 6c73 650a  , default False.
+0003a920: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
+0003a930: 2064 6f20 6e6f 7420 7072 6573 6572 7665   do not preserve
+0003a940: 2069 6e64 6578 2076 616c 7565 7320 7468   index values th
+0003a950: 726f 7567 686f 7574 2041 4341 206f 7065  roughout ACA ope
+0003a960: 7261 7469 6f6e 732e 0a20 2020 206b 7761  rations..    kwa
+0003a970: 7267 7320 3a0a 2020 2020 2020 2020 416c  rgs :.        Al
+0003a980: 6c20 7265 6d61 696e 696e 6720 6b65 7977  l remaining keyw
+0003a990: 6f72 6473 2077 696c 6c20 6265 2070 6173  ords will be pas
+0003a9a0: 7365 6420 746f 2060 6063 6875 6e6b 6060  sed to ``chunk``
+0003a9b0: 2c20 6060 6167 6772 6567 6174 6560 602c  , ``aggregate``,
+0003a9c0: 2061 6e64 0a20 2020 2020 2020 2060 6063   and.        ``c
+0003a9d0: 6f6d 6269 6e65 6060 2e0a 0a20 2020 2045  ombine``...    E
+0003a9e0: 7861 6d70 6c65 730a 2020 2020 2d2d 2d2d  xamples.    ----
+0003a9f0: 2d2d 2d2d 0a20 2020 203e 3e3e 2064 6566  ----.    >>> def
+0003aa00: 2063 6875 6e6b 2861 5f62 6c6f 636b 2c20   chunk(a_block, 
+0003aa10: 625f 626c 6f63 6b29 3a0a 2020 2020 2e2e  b_block):.    ..
+0003aa20: 2e20 2020 2020 7061 7373 0a0a 2020 2020  .     pass..    
+0003aa30: 3e3e 3e20 6465 6620 6167 6728 6466 293a  >>> def agg(df):
+0003aa40: 0a20 2020 202e 2e2e 2020 2020 2070 6173  .    ...     pas
+0003aa50: 730a 0a20 2020 203e 3e3e 2061 7070 6c79  s..    >>> apply
+0003aa60: 5f63 6f6e 6361 745f 6170 706c 7928 5b61  _concat_apply([a
+0003aa70: 2c20 625d 2c20 6368 756e 6b3d 6368 756e  , b], chunk=chun
+0003aa80: 6b2c 2061 6767 7265 6761 7465 3d61 6767  k, aggregate=agg
+0003aa90: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
+0003aaa0: 4b49 500a 2020 2020 2222 220a 2020 2020  KIP.    """.    
+0003aab0: 6966 2073 706c 6974 5f6f 7574 2069 7320  if split_out is 
+0003aac0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7370  None:.        sp
+0003aad0: 6c69 745f 6f75 7420 3d20 310a 2020 2020  lit_out = 1.    
+0003aae0: 6966 2063 6875 6e6b 5f6b 7761 7267 7320  if chunk_kwargs 
+0003aaf0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0003ab00: 2063 6875 6e6b 5f6b 7761 7267 7320 3d20   chunk_kwargs = 
+0003ab10: 6469 6374 2829 0a20 2020 2069 6620 6167  dict().    if ag
+0003ab20: 6772 6567 6174 655f 6b77 6172 6773 2069  gregate_kwargs i
+0003ab30: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0003ab40: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
+0003ab50: 203d 2064 6963 7428 290a 2020 2020 6368   = dict().    ch
+0003ab60: 756e 6b5f 6b77 6172 6773 2e75 7064 6174  unk_kwargs.updat
+0003ab70: 6528 6b77 6172 6773 290a 2020 2020 6167  e(kwargs).    ag
+0003ab80: 6772 6567 6174 655f 6b77 6172 6773 2e75  gregate_kwargs.u
+0003ab90: 7064 6174 6528 6b77 6172 6773 290a 0a20  pdate(kwargs).. 
+0003aba0: 2020 2069 6620 636f 6d62 696e 6520 6973     if combine is
+0003abb0: 204e 6f6e 653a 0a20 2020 2020 2020 2069   None:.        i
+0003abc0: 6620 636f 6d62 696e 655f 6b77 6172 6773  f combine_kwargs
+0003abd0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0003abe0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+0003abf0: 6063 6f6d 6269 6e65 5f6b 7761 7267 7360  `combine_kwargs`
+0003ac00: 2070 726f 7669 6465 6420 7769 7468 206e   provided with n
+0003ac10: 6f20 6063 6f6d 6269 6e65 6022 290a 2020  o `combine`").  
+0003ac20: 2020 2020 2020 636f 6d62 696e 6520 3d20        combine = 
+0003ac30: 6167 6772 6567 6174 650a 2020 2020 2020  aggregate.      
+0003ac40: 2020 636f 6d62 696e 655f 6b77 6172 6773    combine_kwargs
+0003ac50: 203d 2061 6767 7265 6761 7465 5f6b 7761   = aggregate_kwa
+0003ac60: 7267 730a 2020 2020 656c 7365 3a0a 2020  rgs.    else:.  
+0003ac70: 2020 2020 2020 6966 2063 6f6d 6269 6e65        if combine
+0003ac80: 5f6b 7761 7267 7320 6973 204e 6f6e 653a  _kwargs is None:
+0003ac90: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
+0003aca0: 6269 6e65 5f6b 7761 7267 7320 3d20 6469  bine_kwargs = di
+0003acb0: 6374 2829 0a20 2020 2020 2020 2063 6f6d  ct().        com
+0003acc0: 6269 6e65 5f6b 7761 7267 732e 7570 6461  bine_kwargs.upda
+0003acd0: 7465 286b 7761 7267 7329 0a0a 2020 2020  te(kwargs)..    
+0003ace0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+0003acf0: 6528 6172 6773 2c20 2874 7570 6c65 2c20  e(args, (tuple, 
+0003ad00: 6c69 7374 2929 3a0a 2020 2020 2020 2020  list)):.        
+0003ad10: 6172 6773 203d 205b 6172 6773 5d0a 0a20  args = [args].. 
+0003ad20: 2020 2064 6673 203d 205b 6172 6720 666f     dfs = [arg fo
+0003ad30: 7220 6172 6720 696e 2061 7267 7320 6966  r arg in args if
+0003ad40: 2069 7369 6e73 7461 6e63 6528 6172 672c   isinstance(arg,
+0003ad50: 205f 4672 616d 6529 5d0a 0a20 2020 206e   _Frame)]..    n
+0003ad60: 7061 7274 6974 696f 6e73 203d 207b 6172  partitions = {ar
+0003ad70: 672e 6e70 6172 7469 7469 6f6e 7320 666f  g.npartitions fo
+0003ad80: 7220 6172 6720 696e 2064 6673 7d0a 2020  r arg in dfs}.  
+0003ad90: 2020 6966 206c 656e 286e 7061 7274 6974    if len(npartit
+0003ada0: 696f 6e73 2920 3e20 313a 0a20 2020 2020  ions) > 1:.     
+0003adb0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0003adc0: 726f 7228 2241 6c6c 2061 7267 756d 656e  ror("All argumen
+0003add0: 7473 206d 7573 7420 6861 7665 2073 616d  ts must have sam
+0003ade0: 6520 6e75 6d62 6572 206f 6620 7061 7274  e number of part
+0003adf0: 6974 696f 6e73 2229 0a20 2020 206e 7061  itions").    npa
+0003ae00: 7274 6974 696f 6e73 203d 206e 7061 7274  rtitions = npart
+0003ae10: 6974 696f 6e73 2e70 6f70 2829 0a0a 2020  itions.pop()..  
+0003ae20: 2020 6966 2073 706c 6974 5f65 7665 7279    if split_every
+0003ae30: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0003ae40: 2020 7370 6c69 745f 6576 6572 7920 3d20    split_every = 
+0003ae50: 380a 2020 2020 656c 6966 2073 706c 6974  8.    elif split
+0003ae60: 5f65 7665 7279 2069 7320 4661 6c73 653a  _every is False:
+0003ae70: 0a20 2020 2020 2020 2073 706c 6974 5f65  .        split_e
+0003ae80: 7665 7279 203d 206e 7061 7274 6974 696f  very = npartitio
+0003ae90: 6e73 0a20 2020 2065 6c69 6620 7370 6c69  ns.    elif spli
+0003aea0: 745f 6576 6572 7920 3c20 3220 6f72 206e  t_every < 2 or n
+0003aeb0: 6f74 2069 7369 6e73 7461 6e63 6528 7370  ot isinstance(sp
+0003aec0: 6c69 745f 6576 6572 792c 2049 6e74 6567  lit_every, Integ
+0003aed0: 7261 6c29 3a0a 2020 2020 2020 2020 7261  ral):.        ra
+0003aee0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+0003aef0: 7370 6c69 745f 6576 6572 7920 6d75 7374  split_every must
+0003af00: 2062 6520 616e 2069 6e74 6567 6572 203e   be an integer >
+0003af10: 3d20 3222 290a 0a20 2020 2074 6f6b 656e  = 2")..    token
+0003af20: 5f6b 6579 203d 2074 6f6b 656e 697a 6528  _key = tokenize(
+0003af30: 0a20 2020 2020 2020 2074 6f6b 656e 206f  .        token o
+0003af40: 7220 2863 6875 6e6b 2c20 6167 6772 6567  r (chunk, aggreg
+0003af50: 6174 6529 2c0a 2020 2020 2020 2020 6d65  ate),.        me
+0003af60: 7461 2c0a 2020 2020 2020 2020 6172 6773  ta,.        args
+0003af70: 2c0a 2020 2020 2020 2020 6368 756e 6b5f  ,.        chunk_
+0003af80: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+0003af90: 6167 6772 6567 6174 655f 6b77 6172 6773  aggregate_kwargs
+0003afa0: 2c0a 2020 2020 2020 2020 636f 6d62 696e  ,.        combin
+0003afb0: 655f 6b77 6172 6773 2c0a 2020 2020 2020  e_kwargs,.      
+0003afc0: 2020 7370 6c69 745f 6576 6572 792c 0a20    split_every,. 
+0003afd0: 2020 2020 2020 2073 706c 6974 5f6f 7574         split_out
+0003afe0: 2c0a 2020 2020 2020 2020 7370 6c69 745f  ,.        split_
+0003aff0: 6f75 745f 7365 7475 702c 0a20 2020 2020  out_setup,.     
+0003b000: 2020 2073 706c 6974 5f6f 7574 5f73 6574     split_out_set
+0003b010: 7570 5f6b 7761 7267 732c 0a20 2020 2029  up_kwargs,.    )
+0003b020: 0a0a 2020 2020 2320 426c 6f63 6b77 6973  ..    # Blockwis
+0003b030: 6520 4368 756e 6b20 4c61 7965 720a 2020  e Chunk Layer.  
+0003b040: 2020 6368 756e 6b5f 6e61 6d65 203d 2066    chunk_name = f
+0003b050: 227b 746f 6b65 6e20 6f72 2066 756e 636e  "{token or funcn
+0003b060: 616d 6528 6368 756e 6b29 7d2d 6368 756e  ame(chunk)}-chun
+0003b070: 6b2d 7b74 6f6b 656e 5f6b 6579 7d22 0a20  k-{token_key}". 
+0003b080: 2020 2063 6875 6e6b 6564 203d 206d 6170     chunked = map
+0003b090: 5f62 6167 5f70 6172 7469 7469 6f6e 7328  _bag_partitions(
+0003b0a0: 0a20 2020 2020 2020 2063 6875 6e6b 2c0a  .        chunk,.
+0003b0b0: 2020 2020 2020 2020 2320 436f 6e76 6572          # Conver
+0003b0c0: 7420 5f46 7261 6d65 2063 6f6c 6c65 6374  t _Frame collect
+0003b0d0: 696f 6e73 2074 6f20 4261 670a 2020 2020  ions to Bag.    
+0003b0e0: 2020 2020 2a5b 0a20 2020 2020 2020 2020      *[.         
+0003b0f0: 2020 2061 7267 2e74 6f5f 6261 6728 666f     arg.to_bag(fo
+0003b100: 726d 6174 3d22 6672 616d 6522 2920 6966  rmat="frame") if
+0003b110: 2069 7369 6e73 7461 6e63 6528 6172 672c   isinstance(arg,
+0003b120: 205f 4672 616d 6529 2065 6c73 6520 6172   _Frame) else ar
+0003b130: 670a 2020 2020 2020 2020 2020 2020 666f  g.            fo
+0003b140: 7220 6172 6720 696e 2061 7267 730a 2020  r arg in args.  
+0003b150: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+0003b160: 2074 6f6b 656e 3d63 6875 6e6b 5f6e 616d   token=chunk_nam
+0003b170: 652c 0a20 2020 2020 2020 202a 2a63 6875  e,.        **chu
+0003b180: 6e6b 5f6b 7761 7267 732c 0a20 2020 2029  nk_kwargs,.    )
+0003b190: 0a0a 2020 2020 2320 4e4f 5445 3a20 6063  ..    # NOTE: `c
+0003b1a0: 6875 6e6b 6564 6020 6973 206e 6f77 2061  hunked` is now a
+0003b1b0: 2042 6167 2063 6f6c 6c65 6374 696f 6e2e   Bag collection.
+0003b1c0: 0a20 2020 2023 2057 6520 646f 6e27 7420  .    # We don't 
+0003b1d0: 7573 6520 6120 4461 7461 4672 616d 6520  use a DataFrame 
+0003b1e0: 636f 6c6c 6563 7469 6f6e 2c20 6265 6361  collection, beca
+0003b1f0: 7573 650a 2020 2020 2320 7468 6520 7061  use.    # the pa
+0003b200: 7274 6974 696f 6e73 206d 6179 206e 6f74  rtitions may not
+0003b210: 2063 6f6e 7461 696e 2064 6174 6166 7261   contain datafra
+0003b220: 6d65 2d6c 696b 650a 2020 2020 2320 6f62  me-like.    # ob
+0003b230: 6a65 6374 7320 616e 796d 6f72 652e 0a0a  jects anymore...
+0003b240: 2020 2020 2320 426c 6f63 6b77 6973 6520      # Blockwise 
+0003b250: 5370 6c69 7420 4c61 7965 720a 2020 2020  Split Layer.    
+0003b260: 6966 2073 706c 6974 5f6f 7574 2061 6e64  if split_out and
+0003b270: 2073 706c 6974 5f6f 7574 203e 2031 3a0a   split_out > 1:.
+0003b280: 2020 2020 2020 2020 6368 756e 6b65 6420          chunked 
+0003b290: 3d20 6368 756e 6b65 642e 6d61 705f 7061  = chunked.map_pa
+0003b2a0: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+0003b2b0: 2020 2020 2020 6861 7368 5f73 6861 7264        hash_shard
+0003b2c0: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
+0003b2d0: 6c69 745f 6f75 742c 0a20 2020 2020 2020  lit_out,.       
+0003b2e0: 2020 2020 2073 706c 6974 5f6f 7574 5f73       split_out_s
+0003b2f0: 6574 7570 2c0a 2020 2020 2020 2020 2020  etup,.          
+0003b300: 2020 7370 6c69 745f 6f75 745f 7365 7475    split_out_setu
+0003b310: 705f 6b77 6172 6773 2c0a 2020 2020 2020  p_kwargs,.      
+0003b320: 2020 2020 2020 6967 6e6f 7265 5f69 6e64        ignore_ind
+0003b330: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
+0003b340: 746f 6b65 6e3d 2273 706c 6974 2d25 7322  token="split-%s"
+0003b350: 2025 2074 6f6b 656e 5f6b 6579 2c0a 2020   % token_key,.  
+0003b360: 2020 2020 2020 290a 0a20 2020 2023 2048        )..    # H
+0003b370: 616e 646c 6520 736f 7274 2062 6568 6176  andle sort behav
+0003b380: 696f 720a 2020 2020 6966 2073 6f72 7420  ior.    if sort 
+0003b390: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0003b3a0: 2020 2020 2069 6620 736f 7274 2061 6e64       if sort and
+0003b3b0: 2073 706c 6974 5f6f 7574 203e 2031 3a0a   split_out > 1:.
+0003b3c0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0003b3d0: 6520 4e6f 7449 6d70 6c65 6d65 6e74 6564  e NotImplemented
+0003b3e0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+0003b3f0: 2020 2020 2020 2022 4361 6e6e 6f74 2067         "Cannot g
+0003b400: 7561 7261 6e74 6565 2073 6f72 7465 6420  uarantee sorted 
+0003b410: 6b65 7973 2066 6f72 2060 7370 6c69 745f  keys for `split_
+0003b420: 6f75 743e 3160 2e22 0a20 2020 2020 2020  out>1`.".       
+0003b430: 2020 2020 2020 2020 2022 2054 7279 2075           " Try u
+0003b440: 7369 6e67 2073 706c 6974 5f6f 7574 3d31  sing split_out=1
+0003b450: 2c20 6f72 2067 726f 7570 696e 6720 7769  , or grouping wi
+0003b460: 7468 2073 6f72 743d 4661 6c73 652e 220a  th sort=False.".
+0003b470: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0003b480: 2020 2020 2020 6167 6772 6567 6174 655f        aggregate_
+0003b490: 6b77 6172 6773 203d 2061 6767 7265 6761  kwargs = aggrega
+0003b4a0: 7465 5f6b 7761 7267 7320 6f72 207b 7d0a  te_kwargs or {}.
+0003b4b0: 2020 2020 2020 2020 6167 6772 6567 6174          aggregat
+0003b4c0: 655f 6b77 6172 6773 5b22 736f 7274 225d  e_kwargs["sort"]
+0003b4d0: 203d 2073 6f72 740a 0a20 2020 2023 2054   = sort..    # T
+0003b4e0: 7265 652d 5265 6475 6374 696f 6e20 4c61  ree-Reduction La
+0003b4f0: 7965 720a 2020 2020 6669 6e61 6c5f 6e61  yer.    final_na
+0003b500: 6d65 203d 2066 227b 746f 6b65 6e20 6f72  me = f"{token or
+0003b510: 2066 756e 636e 616d 6528 6167 6772 6567   funcname(aggreg
+0003b520: 6174 6529 7d2d 6167 672d 7b74 6f6b 656e  ate)}-agg-{token
+0003b530: 5f6b 6579 7d22 0a20 2020 206c 6179 6572  _key}".    layer
+0003b540: 203d 2044 6174 6146 7261 6d65 5472 6565   = DataFrameTree
+0003b550: 5265 6475 6374 696f 6e28 0a20 2020 2020  Reduction(.     
+0003b560: 2020 2066 696e 616c 5f6e 616d 652c 0a20     final_name,. 
+0003b570: 2020 2020 2020 2063 6875 6e6b 6564 2e6e         chunked.n
+0003b580: 616d 652c 0a20 2020 2020 2020 206e 7061  ame,.        npa
+0003b590: 7274 6974 696f 6e73 2c0a 2020 2020 2020  rtitions,.      
+0003b5a0: 2020 7061 7274 6961 6c28 5f63 6f6e 6361    partial(_conca
+0003b5b0: 742c 2069 676e 6f72 655f 696e 6465 783d  t, ignore_index=
+0003b5c0: 6967 6e6f 7265 5f69 6e64 6578 292c 0a20  ignore_index),. 
+0003b5d0: 2020 2020 2020 2070 6172 7469 616c 2863         partial(c
+0003b5e0: 6f6d 6269 6e65 2c20 2a2a 636f 6d62 696e  ombine, **combin
+0003b5f0: 655f 6b77 6172 6773 2920 6966 2063 6f6d  e_kwargs) if com
+0003b600: 6269 6e65 5f6b 7761 7267 7320 656c 7365  bine_kwargs else
+0003b610: 2063 6f6d 6269 6e65 2c0a 2020 2020 2020   combine,.      
+0003b620: 2020 6669 6e61 6c69 7a65 5f66 756e 633d    finalize_func=
+0003b630: 7061 7274 6961 6c28 6167 6772 6567 6174  partial(aggregat
+0003b640: 652c 202a 2a61 6767 7265 6761 7465 5f6b  e, **aggregate_k
+0003b650: 7761 7267 7329 0a20 2020 2020 2020 2069  wargs).        i
+0003b660: 6620 6167 6772 6567 6174 655f 6b77 6172  f aggregate_kwar
+0003b670: 6773 0a20 2020 2020 2020 2065 6c73 6520  gs.        else 
+0003b680: 6167 6772 6567 6174 652c 0a20 2020 2020  aggregate,.     
+0003b690: 2020 2073 706c 6974 5f65 7665 7279 3d73     split_every=s
+0003b6a0: 706c 6974 5f65 7665 7279 2c0a 2020 2020  plit_every,.    
+0003b6b0: 2020 2020 7370 6c69 745f 6f75 743d 7370      split_out=sp
+0003b6c0: 6c69 745f 6f75 7420 6966 2028 7370 6c69  lit_out if (spli
+0003b6d0: 745f 6f75 7420 616e 6420 7370 6c69 745f  t_out and split_
+0003b6e0: 6f75 7420 3e20 3129 2065 6c73 6520 4e6f  out > 1) else No
+0003b6f0: 6e65 2c0a 2020 2020 2020 2020 7472 6565  ne,.        tree
+0003b700: 5f6e 6f64 655f 6e61 6d65 3d66 227b 746f  _node_name=f"{to
+0003b710: 6b65 6e20 6f72 2066 756e 636e 616d 6528  ken or funcname(
+0003b720: 636f 6d62 696e 6529 7d2d 636f 6d62 696e  combine)}-combin
+0003b730: 652d 7b74 6f6b 656e 5f6b 6579 7d22 2c0a  e-{token_key}",.
+0003b740: 2020 2020 290a 0a20 2020 2069 6620 6d65      )..    if me
+0003b750: 7461 2069 7320 6e6f 5f64 6566 6175 6c74  ta is no_default
+0003b760: 3a0a 2020 2020 2020 2020 6d65 7461 5f63  :.        meta_c
+0003b770: 6875 6e6b 203d 205f 656d 756c 6174 6528  hunk = _emulate(
+0003b780: 6368 756e 6b2c 202a 6172 6773 2c20 7564  chunk, *args, ud
+0003b790: 663d 5472 7565 2c20 2a2a 6368 756e 6b5f  f=True, **chunk_
+0003b7a0: 6b77 6172 6773 290a 2020 2020 2020 2020  kwargs).        
+0003b7b0: 6d65 7461 203d 205f 656d 756c 6174 6528  meta = _emulate(
+0003b7c0: 0a20 2020 2020 2020 2020 2020 2061 6767  .            agg
+0003b7d0: 7265 6761 7465 2c20 5f63 6f6e 6361 7428  regate, _concat(
+0003b7e0: 5b6d 6574 615f 6368 756e 6b5d 2c20 6967  [meta_chunk], ig
+0003b7f0: 6e6f 7265 5f69 6e64 6578 292c 2075 6466  nore_index), udf
+0003b800: 3d54 7275 652c 202a 2a61 6767 7265 6761  =True, **aggrega
+0003b810: 7465 5f6b 7761 7267 730a 2020 2020 2020  te_kwargs.      
+0003b820: 2020 290a 2020 2020 6d65 7461 203d 206d    ).    meta = m
+0003b830: 616b 655f 6d65 7461 280a 2020 2020 2020  ake_meta(.      
+0003b840: 2020 6d65 7461 2c0a 2020 2020 2020 2020    meta,.        
+0003b850: 696e 6465 783d 2867 6574 6174 7472 286d  index=(getattr(m
+0003b860: 616b 655f 6d65 7461 2864 6673 5b30 5d29  ake_meta(dfs[0])
+0003b870: 2c20 2269 6e64 6578 222c 204e 6f6e 6529  , "index", None)
+0003b880: 2069 6620 6466 7320 656c 7365 204e 6f6e   if dfs else Non
+0003b890: 6529 2c0a 2020 2020 2020 2020 7061 7265  e),.        pare
+0003b8a0: 6e74 5f6d 6574 613d 6466 735b 305d 2e5f  nt_meta=dfs[0]._
+0003b8b0: 6d65 7461 2c0a 2020 2020 290a 0a20 2020  meta,.    )..   
+0003b8c0: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
+0003b8d0: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
+0003b8e0: 6c65 6374 696f 6e73 2866 696e 616c 5f6e  lections(final_n
+0003b8f0: 616d 652c 206c 6179 6572 2c20 6465 7065  ame, layer, depe
+0003b900: 6e64 656e 6369 6573 3d28 6368 756e 6b65  ndencies=(chunke
+0003b910: 642c 2929 0a20 2020 2064 6976 6973 696f  d,)).    divisio
+0003b920: 6e73 203d 205b 4e6f 6e65 5d20 2a20 2828  ns = [None] * ((
+0003b930: 7370 6c69 745f 6f75 7420 6f72 2031 2920  split_out or 1) 
+0003b940: 2b20 3129 0a20 2020 2072 6574 7572 6e20  + 1).    return 
+0003b950: 6e65 775f 6464 5f6f 626a 6563 7428 6772  new_dd_object(gr
+0003b960: 6170 682c 2066 696e 616c 5f6e 616d 652c  aph, final_name,
+0003b970: 206d 6574 612c 2064 6976 6973 696f 6e73   meta, divisions
+0003b980: 2c20 7061 7265 6e74 5f6d 6574 613d 6466  , parent_meta=df
+0003b990: 735b 305d 2e5f 6d65 7461 290a 0a0a 6163  s[0]._meta)...ac
+0003b9a0: 6120 3d20 6170 706c 795f 636f 6e63 6174  a = apply_concat
+0003b9b0: 5f61 7070 6c79 0a0a 0a64 6566 205f 6578  _apply...def _ex
+0003b9c0: 7472 6163 745f 6d65 7461 2878 2c20 6e6f  tract_meta(x, no
+0003b9d0: 6e65 6d70 7479 3d46 616c 7365 293a 0a20  nempty=False):. 
+0003b9e0: 2020 2022 2222 0a20 2020 2045 7874 7261     """.    Extra
+0003b9f0: 6374 2069 6e74 6572 6e61 6c20 6361 6368  ct internal cach
+0003ba00: 6520 6461 7461 2028 6060 5f6d 6574 6160  e data (``_meta`
+0003ba10: 6029 2066 726f 6d20 6464 2e44 6174 6146  `) from dd.DataF
+0003ba20: 7261 6d65 202f 2064 642e 5365 7269 6573  rame / dd.Series
+0003ba30: 0a20 2020 2022 2222 0a20 2020 2069 6620  .    """.    if 
+0003ba40: 6973 696e 7374 616e 6365 2878 2c20 2853  isinstance(x, (S
+0003ba50: 6361 6c61 722c 205f 4672 616d 6529 293a  calar, _Frame)):
+0003ba60: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0003ba70: 782e 5f6d 6574 615f 6e6f 6e65 6d70 7479  x._meta_nonempty
+0003ba80: 2069 6620 6e6f 6e65 6d70 7479 2065 6c73   if nonempty els
+0003ba90: 6520 782e 5f6d 6574 610a 2020 2020 656c  e x._meta.    el
+0003baa0: 6966 2069 7369 6e73 7461 6e63 6528 782c  if isinstance(x,
+0003bab0: 206c 6973 7429 3a0a 2020 2020 2020 2020   list):.        
+0003bac0: 7265 7475 726e 205b 5f65 7874 7261 6374  return [_extract
+0003bad0: 5f6d 6574 6128 5f78 2c20 6e6f 6e65 6d70  _meta(_x, nonemp
+0003bae0: 7479 2920 666f 7220 5f78 2069 6e20 785d  ty) for _x in x]
+0003baf0: 0a20 2020 2065 6c69 6620 6973 696e 7374  .    elif isinst
+0003bb00: 616e 6365 2878 2c20 7475 706c 6529 3a0a  ance(x, tuple):.
+0003bb10: 2020 2020 2020 2020 7265 7475 726e 2074          return t
+0003bb20: 7570 6c65 285f 6578 7472 6163 745f 6d65  uple(_extract_me
+0003bb30: 7461 285f 782c 206e 6f6e 656d 7074 7929  ta(_x, nonempty)
+0003bb40: 2066 6f72 205f 7820 696e 2078 290a 2020   for _x in x).  
+0003bb50: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+0003bb60: 6528 782c 2064 6963 7429 3a0a 2020 2020  e(x, dict):.    
+0003bb70: 2020 2020 7265 7320 3d20 7b7d 0a20 2020      res = {}.   
+0003bb80: 2020 2020 2066 6f72 206b 2069 6e20 783a       for k in x:
+0003bb90: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+0003bba0: 5b6b 5d20 3d20 5f65 7874 7261 6374 5f6d  [k] = _extract_m
+0003bbb0: 6574 6128 785b 6b5d 2c20 6e6f 6e65 6d70  eta(x[k], nonemp
+0003bbc0: 7479 290a 2020 2020 2020 2020 7265 7475  ty).        retu
+0003bbd0: 726e 2072 6573 0a20 2020 2065 6c69 6620  rn res.    elif 
+0003bbe0: 6973 696e 7374 616e 6365 2878 2c20 4465  isinstance(x, De
+0003bbf0: 6c61 7965 6429 3a0a 2020 2020 2020 2020  layed):.        
+0003bc00: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0003bc10: 280a 2020 2020 2020 2020 2020 2020 2243  (.            "C
+0003bc20: 616e 6e6f 7420 696e 6665 7220 6461 7461  annot infer data
+0003bc30: 6672 616d 6520 6d65 7461 6461 7461 2077  frame metadata w
+0003bc40: 6974 6820 6120 6064 6173 6b2e 6465 6c61  ith a `dask.dela
+0003bc50: 7965 6460 2061 7267 756d 656e 7422 0a20  yed` argument". 
+0003bc60: 2020 2020 2020 2029 0a20 2020 2065 6c73         ).    els
+0003bc70: 653a 0a20 2020 2020 2020 2072 6574 7572  e:.        retur
+0003bc80: 6e20 780a 0a0a 6465 6620 5f65 6d75 6c61  n x...def _emula
+0003bc90: 7465 2866 756e 632c 202a 6172 6773 2c20  te(func, *args, 
+0003bca0: 7564 663d 4661 6c73 652c 202a 2a6b 7761  udf=False, **kwa
+0003bcb0: 7267 7329 3a0a 2020 2020 2222 220a 2020  rgs):.    """.  
+0003bcc0: 2020 4170 706c 7920 6120 6675 6e63 7469    Apply a functi
+0003bcd0: 6f6e 2075 7369 6e67 2061 7267 7320 2f20  on using args / 
+0003bce0: 6b77 6172 6773 2e20 4966 2061 7267 756d  kwargs. If argum
+0003bcf0: 656e 7473 2063 6f6e 7461 696e 2064 642e  ents contain dd.
+0003bd00: 4461 7461 4672 616d 6520 2f0a 2020 2020  DataFrame /.    
+0003bd10: 6464 2e53 6572 6965 732c 2075 7369 6e67  dd.Series, using
+0003bd20: 2069 6e74 6572 6e61 6c20 6361 6368 6520   internal cache 
+0003bd30: 2860 605f 6d65 7461 6060 2920 666f 7220  (``_meta``) for 
+0003bd40: 6361 6c63 756c 6174 696f 6e0a 2020 2020  calculation.    
+0003bd50: 2222 220a 2020 2020 7769 7468 2072 6169  """.    with rai
+0003bd60: 7365 5f6f 6e5f 6d65 7461 5f65 7272 6f72  se_on_meta_error
+0003bd70: 2866 756e 636e 616d 6528 6675 6e63 292c  (funcname(func),
+0003bd80: 2075 6466 3d75 6466 292c 2063 6865 636b   udf=udf), check
+0003bd90: 5f6e 756d 6572 6963 5f6f 6e6c 795f 6465  _numeric_only_de
+0003bda0: 7072 6563 6174 696f 6e28 293a 0a20 2020  precation():.   
+0003bdb0: 2020 2020 2072 6574 7572 6e20 6675 6e63       return func
+0003bdc0: 282a 5f65 7874 7261 6374 5f6d 6574 6128  (*_extract_meta(
+0003bdd0: 6172 6773 2c20 5472 7565 292c 202a 2a5f  args, True), **_
+0003bde0: 6578 7472 6163 745f 6d65 7461 286b 7761  extract_meta(kwa
+0003bdf0: 7267 732c 2054 7275 6529 290a 0a0a 4069  rgs, True))...@i
+0003be00: 6e73 6572 745f 6d65 7461 5f70 6172 616d  nsert_meta_param
+0003be10: 5f64 6573 6372 6970 7469 6f6e 0a64 6566  _description.def
+0003be20: 206d 6170 5f70 6172 7469 7469 6f6e 7328   map_partitions(
+0003be30: 0a20 2020 2066 756e 632c 0a20 2020 202a  .    func,.    *
+0003be40: 6172 6773 2c0a 2020 2020 6d65 7461 3d6e  args,.    meta=n
+0003be50: 6f5f 6465 6661 756c 742c 0a20 2020 2065  o_default,.    e
+0003be60: 6e66 6f72 6365 5f6d 6574 6164 6174 613d  nforce_metadata=
+0003be70: 5472 7565 2c0a 2020 2020 7472 616e 7366  True,.    transf
+0003be80: 6f72 6d5f 6469 7669 7369 6f6e 733d 5472  orm_divisions=Tr
+0003be90: 7565 2c0a 2020 2020 616c 6967 6e5f 6461  ue,.    align_da
+0003bea0: 7461 6672 616d 6573 3d54 7275 652c 0a20  taframes=True,. 
+0003beb0: 2020 202a 2a6b 7761 7267 732c 0a29 3a0a     **kwargs,.):.
+0003bec0: 2020 2020 2222 2241 7070 6c79 2050 7974      """Apply Pyt
+0003bed0: 686f 6e20 6675 6e63 7469 6f6e 206f 6e20  hon function on 
+0003bee0: 6561 6368 2044 6174 6146 7261 6d65 2070  each DataFrame p
+0003bef0: 6172 7469 7469 6f6e 2e0a 0a20 2020 2050  artition...    P
+0003bf00: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
+0003bf10: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066 756e  --------.    fun
+0003bf20: 6320 3a20 6675 6e63 7469 6f6e 0a20 2020  c : function.   
+0003bf30: 2020 2020 2046 756e 6374 696f 6e20 6170       Function ap
+0003bf40: 706c 6965 6420 746f 2065 6163 6820 7061  plied to each pa
+0003bf50: 7274 6974 696f 6e2e 0a20 2020 2061 7267  rtition..    arg
+0003bf60: 732c 206b 7761 7267 7320 3a0a 2020 2020  s, kwargs :.    
+0003bf70: 2020 2020 4172 6775 6d65 6e74 7320 616e      Arguments an
+0003bf80: 6420 6b65 7977 6f72 6473 2074 6f20 7061  d keywords to pa
+0003bf90: 7373 2074 6f20 7468 6520 6675 6e63 7469  ss to the functi
+0003bfa0: 6f6e 2e20 2041 7420 6c65 6173 7420 6f6e  on.  At least on
+0003bfb0: 6520 6f66 2074 6865 0a20 2020 2020 2020  e of the.       
+0003bfc0: 2061 7267 7320 7368 6f75 6c64 2062 6520   args should be 
+0003bfd0: 6120 4461 736b 2e64 6174 6166 7261 6d65  a Dask.dataframe
+0003bfe0: 2e20 4172 6775 6d65 6e74 7320 616e 6420  . Arguments and 
+0003bff0: 6b65 7977 6f72 6473 206d 6179 2063 6f6e  keywords may con
+0003c000: 7461 696e 0a20 2020 2020 2020 2060 6053  tain.        ``S
+0003c010: 6361 6c61 7260 602c 2060 6044 656c 6179  calar``, ``Delay
+0003c020: 6564 6060 206f 7220 7265 6775 6c61 7220  ed`` or regular 
+0003c030: 7079 7468 6f6e 206f 626a 6563 7473 2e20  python objects. 
+0003c040: 4461 7461 4672 616d 652d 6c69 6b65 2061  DataFrame-like a
+0003c050: 7267 730a 2020 2020 2020 2020 2862 6f74  rgs.        (bot
+0003c060: 6820 6461 736b 2061 6e64 2070 616e 6461  h dask and panda
+0003c070: 7329 2077 696c 6c20 6265 2072 6570 6172  s) will be repar
+0003c080: 7469 7469 6f6e 6564 2074 6f20 616c 6967  titioned to alig
+0003c090: 6e20 2869 6620 6e65 6365 7373 6172 7929  n (if necessary)
+0003c0a0: 0a20 2020 2020 2020 2062 6566 6f72 6520  .        before 
+0003c0b0: 6170 706c 7969 6e67 2074 6865 2066 756e  applying the fun
+0003c0c0: 6374 696f 6e20 2873 6565 2060 6061 6c69  ction (see ``ali
+0003c0d0: 676e 5f64 6174 6166 7261 6d65 7360 6020  gn_dataframes`` 
+0003c0e0: 746f 2063 6f6e 7472 6f6c 292e 0a20 2020  to control)..   
+0003c0f0: 2065 6e66 6f72 6365 5f6d 6574 6164 6174   enforce_metadat
+0003c100: 6120 3a20 626f 6f6c 2c20 6465 6661 756c  a : bool, defaul
+0003c110: 7420 5472 7565 0a20 2020 2020 2020 2057  t True.        W
+0003c120: 6865 7468 6572 2074 6f20 656e 666f 7263  hether to enforc
+0003c130: 6520 6174 2072 756e 7469 6d65 2074 6861  e at runtime tha
+0003c140: 7420 7468 6520 7374 7275 6374 7572 6520  t the structure 
+0003c150: 6f66 2074 6865 2044 6174 6146 7261 6d65  of the DataFrame
+0003c160: 0a20 2020 2020 2020 2070 726f 6475 6365  .        produce
+0003c170: 6420 6279 2060 6066 756e 6360 6020 6163  d by ``func`` ac
+0003c180: 7475 616c 6c79 206d 6174 6368 6573 2074  tually matches t
+0003c190: 6865 2073 7472 7563 7475 7265 206f 6620  he structure of 
+0003c1a0: 6060 6d65 7461 6060 2e0a 2020 2020 2020  ``meta``..      
+0003c1b0: 2020 5468 6973 2077 696c 6c20 7265 6e61    This will rena
+0003c1c0: 6d65 2061 6e64 2072 656f 7264 6572 2063  me and reorder c
+0003c1d0: 6f6c 756d 6e73 2066 6f72 2065 6163 6820  olumns for each 
+0003c1e0: 7061 7274 6974 696f 6e2c 0a20 2020 2020  partition,.     
+0003c1f0: 2020 2061 6e64 2077 696c 6c20 7261 6973     and will rais
+0003c200: 6520 616e 2065 7272 6f72 2069 6620 7468  e an error if th
+0003c210: 6973 2064 6f65 736e 2774 2077 6f72 6b2c  is doesn't work,
+0003c220: 0a20 2020 2020 2020 2062 7574 2069 7420  .        but it 
+0003c230: 776f 6e27 7420 7261 6973 6520 6966 2064  won't raise if d
+0003c240: 7479 7065 7320 646f 6e27 7420 6d61 7463  types don't matc
+0003c250: 682e 0a20 2020 2074 7261 6e73 666f 726d  h..    transform
+0003c260: 5f64 6976 6973 696f 6e73 203a 2062 6f6f  _divisions : boo
+0003c270: 6c2c 2064 6566 6175 6c74 2054 7275 650a  l, default True.
+0003c280: 2020 2020 2020 2020 5768 6574 6865 7220          Whether 
+0003c290: 746f 2061 7070 6c79 2074 6865 2066 756e  to apply the fun
+0003c2a0: 6374 696f 6e20 6f6e 746f 2074 6865 2064  ction onto the d
+0003c2b0: 6976 6973 696f 6e73 2061 6e64 2061 7070  ivisions and app
+0003c2c0: 6c79 2074 686f 7365 0a20 2020 2020 2020  ly those.       
+0003c2d0: 2074 7261 6e73 666f 726d 6564 2064 6976   transformed div
+0003c2e0: 6973 696f 6e73 2074 6f20 7468 6520 6f75  isions to the ou
+0003c2f0: 7470 7574 2e0a 2020 2020 616c 6967 6e5f  tput..    align_
+0003c300: 6461 7461 6672 616d 6573 203a 2062 6f6f  dataframes : boo
+0003c310: 6c2c 2064 6566 6175 6c74 2054 7275 650a  l, default True.
+0003c320: 2020 2020 2020 2020 5768 6574 6865 7220          Whether 
+0003c330: 746f 2072 6570 6172 7469 7469 6f6e 2044  to repartition D
+0003c340: 6174 6146 7261 6d65 2d20 6f72 2053 6572  ataFrame- or Ser
+0003c350: 6965 732d 6c69 6b65 2061 7267 730a 2020  ies-like args.  
+0003c360: 2020 2020 2020 2862 6f74 6820 6461 736b        (both dask
+0003c370: 2061 6e64 2070 616e 6461 7329 2073 6f20   and pandas) so 
+0003c380: 7468 6569 7220 6469 7669 7369 6f6e 7320  their divisions 
+0003c390: 616c 6967 6e20 6265 666f 7265 2061 7070  align before app
+0003c3a0: 6c79 696e 670a 2020 2020 2020 2020 7468  lying.        th
+0003c3b0: 6520 6675 6e63 7469 6f6e 2e20 5468 6973  e function. This
+0003c3c0: 2072 6571 7569 7265 7320 616c 6c20 696e   requires all in
+0003c3d0: 7075 7473 2074 6f20 6861 7665 206b 6e6f  puts to have kno
+0003c3e0: 776e 2064 6976 6973 696f 6e73 2e0a 2020  wn divisions..  
+0003c3f0: 2020 2020 2020 5369 6e67 6c65 2d70 6172        Single-par
 0003c400: 7469 7469 6f6e 2069 6e70 7574 7320 7769  tition inputs wi
-0003c410: 6c6c 2062 6520 6272 6f61 6463 6173 7420  ll be broadcast 
-0003c420: 746f 0a20 2020 2020 2020 2065 7665 7279  to.        every
-0003c430: 2070 6172 7469 7469 6f6e 206f 6620 6d75   partition of mu
-0003c440: 6c74 692d 7061 7274 6974 696f 6e20 696e  lti-partition in
-0003c450: 7075 7473 2e0a 2020 2020 244d 4554 410a  puts..    $META.
-0003c460: 2020 2020 2222 220a 2020 2020 6e61 6d65      """.    name
-0003c470: 203d 206b 7761 7267 732e 706f 7028 2274   = kwargs.pop("t
-0003c480: 6f6b 656e 222c 204e 6f6e 6529 0a20 2020  oken", None).   
-0003c490: 2070 6172 656e 745f 6d65 7461 203d 206b   parent_meta = k
-0003c4a0: 7761 7267 732e 706f 7028 2270 6172 656e  wargs.pop("paren
-0003c4b0: 745f 6d65 7461 222c 204e 6f6e 6529 0a0a  t_meta", None)..
-0003c4c0: 2020 2020 6173 7365 7274 2063 616c 6c61      assert calla
-0003c4d0: 626c 6528 6675 6e63 290a 2020 2020 6966  ble(func).    if
-0003c4e0: 206e 616d 6520 6973 206e 6f74 204e 6f6e   name is not Non
-0003c4f0: 653a 0a20 2020 2020 2020 2074 6f6b 656e  e:.        token
-0003c500: 203d 2074 6f6b 656e 697a 6528 6d65 7461   = tokenize(meta
-0003c510: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-0003c520: 7329 0a20 2020 2065 6c73 653a 0a20 2020  s).    else:.   
-0003c530: 2020 2020 206e 616d 6520 3d20 6675 6e63       name = func
-0003c540: 6e61 6d65 2866 756e 6329 0a20 2020 2020  name(func).     
-0003c550: 2020 2074 6f6b 656e 203d 2074 6f6b 656e     token = token
-0003c560: 697a 6528 6675 6e63 2c20 6d65 7461 2c20  ize(func, meta, 
-0003c570: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
-0003c580: 0a20 2020 206e 616d 6520 3d20 6622 7b6e  .    name = f"{n
-0003c590: 616d 657d 2d7b 746f 6b65 6e7d 220a 0a20  ame}-{token}".. 
-0003c5a0: 2020 2066 726f 6d20 6461 736b 2e64 6174     from dask.dat
-0003c5b0: 6166 7261 6d65 2e6d 756c 7469 2069 6d70  aframe.multi imp
-0003c5c0: 6f72 7420 5f6d 6179 6265 5f61 6c69 676e  ort _maybe_align
-0003c5d0: 5f70 6172 7469 7469 6f6e 730a 0a20 2020  _partitions..   
-0003c5e0: 2069 6620 616c 6967 6e5f 6461 7461 6672   if align_datafr
-0003c5f0: 616d 6573 3a0a 2020 2020 2020 2020 6172  ames:.        ar
-0003c600: 6773 203d 205f 6d61 7962 655f 6672 6f6d  gs = _maybe_from
-0003c610: 5f70 616e 6461 7328 6172 6773 290a 2020  _pandas(args).  
-0003c620: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-0003c630: 2020 2020 2020 2061 7267 7320 3d20 5f6d         args = _m
-0003c640: 6179 6265 5f61 6c69 676e 5f70 6172 7469  aybe_align_parti
-0003c650: 7469 6f6e 7328 6172 6773 290a 2020 2020  tions(args).    
-0003c660: 2020 2020 6578 6365 7074 2056 616c 7565      except Value
-0003c670: 4572 726f 7220 6173 2065 3a0a 2020 2020  Error as e:.    
-0003c680: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0003c690: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-0003c6a0: 2020 2020 2020 2020 2020 6622 7b65 7d2e            f"{e}.
-0003c6b0: 2049 6620 796f 7520 646f 6e27 7420 7761   If you don't wa
-0003c6c0: 6e74 2074 6865 2070 6172 7469 7469 6f6e  nt the partition
-0003c6d0: 7320 746f 2062 6520 616c 6967 6e65 642c  s to be aligned,
-0003c6e0: 2061 6e64 2061 7265 2022 0a20 2020 2020   and are ".     
-0003c6f0: 2020 2020 2020 2020 2020 2022 6361 6c6c             "call
-0003c700: 696e 6720 606d 6170 5f70 6172 7469 7469  ing `map_partiti
-0003c710: 6f6e 7360 2064 6972 6563 746c 792c 2070  ons` directly, p
-0003c720: 6173 7320 6061 6c69 676e 5f64 6174 6166  ass `align_dataf
-0003c730: 7261 6d65 733d 4661 6c73 6560 2e22 0a20  rames=False`.". 
-0003c740: 2020 2020 2020 2020 2020 2029 2066 726f             ) fro
-0003c750: 6d20 650a 0a20 2020 2064 6673 203d 205b  m e..    dfs = [
-0003c760: 6466 2066 6f72 2064 6620 696e 2061 7267  df for df in arg
-0003c770: 7320 6966 2069 7369 6e73 7461 6e63 6528  s if isinstance(
-0003c780: 6466 2c20 5f46 7261 6d65 295d 0a0a 2020  df, _Frame)]..  
-0003c790: 2020 6d65 7461 203d 205f 6765 745f 6d65    meta = _get_me
-0003c7a0: 7461 5f6d 6170 5f70 6172 7469 7469 6f6e  ta_map_partition
-0003c7b0: 7328 6172 6773 2c20 6466 732c 2066 756e  s(args, dfs, fun
-0003c7c0: 632c 206b 7761 7267 732c 206d 6574 612c  c, kwargs, meta,
-0003c7d0: 2070 6172 656e 745f 6d65 7461 290a 2020   parent_meta).  
-0003c7e0: 2020 6966 2061 6c6c 2869 7369 6e73 7461    if all(isinsta
-0003c7f0: 6e63 6528 6172 672c 2053 6361 6c61 7229  nce(arg, Scalar)
-0003c800: 2066 6f72 2061 7267 2069 6e20 6172 6773   for arg in args
-0003c810: 293a 0a20 2020 2020 2020 206c 6179 6572  ):.        layer
-0003c820: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0003c830: 2028 6e61 6d65 2c20 3029 3a20 280a 2020   (name, 0): (.  
-0003c840: 2020 2020 2020 2020 2020 2020 2020 6170                ap
-0003c850: 706c 792c 0a20 2020 2020 2020 2020 2020  ply,.           
-0003c860: 2020 2020 2066 756e 632c 0a20 2020 2020       func,.     
-0003c870: 2020 2020 2020 2020 2020 2028 7475 706c             (tupl
-0003c880: 652c 205b 2861 7267 2e5f 6e61 6d65 2c20  e, [(arg._name, 
-0003c890: 3029 2066 6f72 2061 7267 2069 6e20 6172  0) for arg in ar
-0003c8a0: 6773 5d29 2c0a 2020 2020 2020 2020 2020  gs]),.          
-0003c8b0: 2020 2020 2020 6b77 6172 6773 2c0a 2020        kwargs,.  
-0003c8c0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0003c8d0: 2020 2020 7d0a 2020 2020 2020 2020 6772      }.        gr
-0003c8e0: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
-0003c8f0: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
-0003c900: 7469 6f6e 7328 6e61 6d65 2c20 6c61 7965  tions(name, laye
-0003c910: 722c 2064 6570 656e 6465 6e63 6965 733d  r, dependencies=
-0003c920: 6172 6773 290a 2020 2020 2020 2020 7265  args).        re
-0003c930: 7475 726e 2053 6361 6c61 7228 6772 6170  turn Scalar(grap
-0003c940: 682c 206e 616d 652c 206d 6574 6129 0a0a  h, name, meta)..
-0003c950: 2020 2020 6172 6773 3220 3d20 5b5d 0a20      args2 = []. 
-0003c960: 2020 2064 6570 656e 6465 6e63 6965 7320     dependencies 
-0003c970: 3d20 5b5d 0a20 2020 2066 6f72 2061 7267  = [].    for arg
-0003c980: 2069 6e20 6172 6773 3a0a 2020 2020 2020   in args:.      
-0003c990: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0003c9a0: 6172 672c 205f 4672 616d 6529 3a0a 2020  arg, _Frame):.  
-0003c9b0: 2020 2020 2020 2020 2020 6172 6773 322e            args2.
-0003c9c0: 6170 7065 6e64 2861 7267 290a 2020 2020  append(arg).    
-0003c9d0: 2020 2020 2020 2020 6465 7065 6e64 656e          dependen
-0003c9e0: 6369 6573 2e61 7070 656e 6428 6172 6729  cies.append(arg)
-0003c9f0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-0003ca00: 7469 6e75 650a 2020 2020 2020 2020 6172  tinue.        ar
-0003ca10: 6720 3d20 6e6f 726d 616c 697a 655f 6172  g = normalize_ar
-0003ca20: 6728 6172 6729 0a20 2020 2020 2020 2061  g(arg).        a
-0003ca30: 7267 322c 2063 6f6c 6c65 6374 696f 6e73  rg2, collections
-0003ca40: 203d 2075 6e70 6163 6b5f 636f 6c6c 6563   = unpack_collec
-0003ca50: 7469 6f6e 7328 6172 6729 0a20 2020 2020  tions(arg).     
-0003ca60: 2020 2069 6620 636f 6c6c 6563 7469 6f6e     if collection
-0003ca70: 733a 0a20 2020 2020 2020 2020 2020 2061  s:.            a
-0003ca80: 7267 7332 2e61 7070 656e 6428 6172 6732  rgs2.append(arg2
-0003ca90: 290a 2020 2020 2020 2020 2020 2020 6465  ).            de
-0003caa0: 7065 6e64 656e 6369 6573 2e65 7874 656e  pendencies.exten
-0003cab0: 6428 636f 6c6c 6563 7469 6f6e 7329 0a20  d(collections). 
-0003cac0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0003cad0: 2020 2020 2020 2020 2061 7267 7332 2e61           args2.a
-0003cae0: 7070 656e 6428 6172 6729 0a0a 2020 2020  ppend(arg)..    
-0003caf0: 6b77 6172 6773 3320 3d20 7b7d 0a20 2020  kwargs3 = {}.   
-0003cb00: 2073 696d 706c 6520 3d20 5472 7565 0a20   simple = True. 
-0003cb10: 2020 2066 6f72 206b 2c20 7620 696e 206b     for k, v in k
-0003cb20: 7761 7267 732e 6974 656d 7328 293a 0a20  wargs.items():. 
-0003cb30: 2020 2020 2020 2076 203d 206e 6f72 6d61         v = norma
-0003cb40: 6c69 7a65 5f61 7267 2876 290a 2020 2020  lize_arg(v).    
-0003cb50: 2020 2020 762c 2063 6f6c 6c65 6374 696f      v, collectio
-0003cb60: 6e73 203d 2075 6e70 6163 6b5f 636f 6c6c  ns = unpack_coll
-0003cb70: 6563 7469 6f6e 7328 7629 0a20 2020 2020  ections(v).     
-0003cb80: 2020 2064 6570 656e 6465 6e63 6965 732e     dependencies.
-0003cb90: 6578 7465 6e64 2863 6f6c 6c65 6374 696f  extend(collectio
-0003cba0: 6e73 290a 2020 2020 2020 2020 6b77 6172  ns).        kwar
-0003cbb0: 6773 335b 6b5d 203d 2076 0a20 2020 2020  gs3[k] = v.     
-0003cbc0: 2020 2069 6620 636f 6c6c 6563 7469 6f6e     if collection
-0003cbd0: 733a 0a20 2020 2020 2020 2020 2020 2073  s:.            s
-0003cbe0: 696d 706c 6520 3d20 4661 6c73 650a 0a20  imple = False.. 
-0003cbf0: 2020 2064 6976 6973 696f 6e73 203d 205f     divisions = _
-0003cc00: 6765 745f 6469 7669 7369 6f6e 735f 6d61  get_divisions_ma
-0003cc10: 705f 7061 7274 6974 696f 6e73 280a 2020  p_partitions(.  
-0003cc20: 2020 2020 2020 616c 6967 6e5f 6461 7461        align_data
-0003cc30: 6672 616d 6573 2c20 7472 616e 7366 6f72  frames, transfor
-0003cc40: 6d5f 6469 7669 7369 6f6e 732c 2064 6673  m_divisions, dfs
-0003cc50: 2c20 6675 6e63 2c20 6172 6773 2c20 6b77  , func, args, kw
-0003cc60: 6172 6773 0a20 2020 2029 0a0a 2020 2020  args.    )..    
-0003cc70: 6966 2068 6173 5f6b 6579 776f 7264 2866  if has_keyword(f
-0003cc80: 756e 632c 2022 7061 7274 6974 696f 6e5f  unc, "partition_
-0003cc90: 696e 666f 2229 3a0a 2020 2020 2020 2020  info"):.        
-0003cca0: 7061 7274 6974 696f 6e5f 696e 666f 203d  partition_info =
-0003ccb0: 207b 0a20 2020 2020 2020 2020 2020 2028   {.            (
-0003ccc0: 692c 293a 207b 226e 756d 6265 7222 3a20  i,): {"number": 
-0003ccd0: 692c 2022 6469 7669 7369 6f6e 223a 2064  i, "division": d
-0003cce0: 6976 6973 696f 6e7d 0a20 2020 2020 2020  ivision}.       
-0003ccf0: 2020 2020 2066 6f72 2069 2c20 6469 7669       for i, divi
-0003cd00: 7369 6f6e 2069 6e20 656e 756d 6572 6174  sion in enumerat
-0003cd10: 6528 6469 7669 7369 6f6e 735b 3a2d 315d  e(divisions[:-1]
-0003cd20: 290a 2020 2020 2020 2020 7d0a 0a20 2020  ).        }..   
-0003cd30: 2020 2020 2061 7267 7332 2e69 6e73 6572       args2.inser
-0003cd40: 7428 302c 2042 6c6f 636b 7769 7365 4465  t(0, BlockwiseDe
-0003cd50: 7044 6963 7428 7061 7274 6974 696f 6e5f  pDict(partition_
-0003cd60: 696e 666f 2929 0a20 2020 2020 2020 206f  info)).        o
-0003cd70: 7269 675f 6675 6e63 203d 2066 756e 630a  rig_func = func.
-0003cd80: 0a20 2020 2020 2020 2064 6566 2066 756e  .        def fun
-0003cd90: 6328 7061 7274 6974 696f 6e5f 696e 666f  c(partition_info
-0003cda0: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-0003cdb0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-0003cdc0: 7265 7475 726e 206f 7269 675f 6675 6e63  return orig_func
-0003cdd0: 282a 6172 6773 2c20 2a2a 6b77 6172 6773  (*args, **kwargs
-0003cde0: 2c20 7061 7274 6974 696f 6e5f 696e 666f  , partition_info
-0003cdf0: 3d70 6172 7469 7469 6f6e 5f69 6e66 6f29  =partition_info)
-0003ce00: 0a0a 2020 2020 6966 2065 6e66 6f72 6365  ..    if enforce
-0003ce10: 5f6d 6574 6164 6174 613a 0a20 2020 2020  _metadata:.     
-0003ce20: 2020 2064 736b 203d 2070 6172 7469 7469     dsk = partiti
-0003ce30: 6f6e 7769 7365 5f67 7261 7068 280a 2020  onwise_graph(.  
-0003ce40: 2020 2020 2020 2020 2020 6170 706c 795f            apply_
-0003ce50: 616e 645f 656e 666f 7263 652c 0a20 2020  and_enforce,.   
-0003ce60: 2020 2020 2020 2020 206e 616d 652c 0a20           name,. 
-0003ce70: 2020 2020 2020 2020 2020 202a 6172 6773             *args
-0003ce80: 322c 0a20 2020 2020 2020 2020 2020 2064  2,.            d
-0003ce90: 6570 656e 6465 6e63 6965 733d 6465 7065  ependencies=depe
-0003cea0: 6e64 656e 6369 6573 2c0a 2020 2020 2020  ndencies,.      
-0003ceb0: 2020 2020 2020 5f66 756e 633d 6675 6e63        _func=func
-0003cec0: 2c0a 2020 2020 2020 2020 2020 2020 5f6d  ,.            _m
-0003ced0: 6574 613d 6d65 7461 2c0a 2020 2020 2020  eta=meta,.      
-0003cee0: 2020 2020 2020 2a2a 6b77 6172 6773 332c        **kwargs3,
-0003cef0: 0a20 2020 2020 2020 2029 0a20 2020 2065  .        ).    e
-0003cf00: 6c73 653a 0a20 2020 2020 2020 206b 7761  lse:.        kwa
-0003cf10: 7267 7334 203d 206b 7761 7267 7320 6966  rgs4 = kwargs if
-0003cf20: 2073 696d 706c 6520 656c 7365 206b 7761   simple else kwa
-0003cf30: 7267 7333 0a20 2020 2020 2020 2064 736b  rgs3.        dsk
-0003cf40: 203d 2070 6172 7469 7469 6f6e 7769 7365   = partitionwise
-0003cf50: 5f67 7261 7068 280a 2020 2020 2020 2020  _graph(.        
-0003cf60: 2020 2020 6675 6e63 2c20 6e61 6d65 2c20      func, name, 
-0003cf70: 2a61 7267 7332 2c20 2a2a 6b77 6172 6773  *args2, **kwargs
-0003cf80: 342c 2064 6570 656e 6465 6e63 6965 733d  4, dependencies=
-0003cf90: 6465 7065 6e64 656e 6369 6573 0a20 2020  dependencies.   
-0003cfa0: 2020 2020 2029 0a0a 2020 2020 6772 6170       )..    grap
-0003cfb0: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
-0003cfc0: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
-0003cfd0: 6f6e 7328 6e61 6d65 2c20 6473 6b2c 2064  ons(name, dsk, d
-0003cfe0: 6570 656e 6465 6e63 6965 733d 6465 7065  ependencies=depe
-0003cff0: 6e64 656e 6369 6573 290a 2020 2020 7265  ndencies).    re
-0003d000: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
-0003d010: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
-0003d020: 6d65 7461 2c20 6469 7669 7369 6f6e 7329  meta, divisions)
-0003d030: 0a0a 0a64 6566 205f 6765 745f 6469 7669  ...def _get_divi
-0003d040: 7369 6f6e 735f 6d61 705f 7061 7274 6974  sions_map_partit
-0003d050: 696f 6e73 280a 2020 2020 616c 6967 6e5f  ions(.    align_
-0003d060: 6461 7461 6672 616d 6573 2c20 7472 616e  dataframes, tran
-0003d070: 7366 6f72 6d5f 6469 7669 7369 6f6e 732c  sform_divisions,
-0003d080: 2064 6673 2c20 6675 6e63 2c20 6172 6773   dfs, func, args
-0003d090: 2c20 6b77 6172 6773 0a29 3a0a 2020 2020  , kwargs.):.    
-0003d0a0: 2222 220a 2020 2020 4865 6c70 6572 2074  """.    Helper t
-0003d0b0: 6f20 6765 7420 6469 7669 7369 6f6e 7320  o get divisions 
-0003d0c0: 666f 7220 6d61 705f 7061 7274 6974 696f  for map_partitio
-0003d0d0: 6e73 2061 6e64 206d 6170 5f6f 7665 726c  ns and map_overl
-0003d0e0: 6170 206f 7574 7075 742e 0a20 2020 2022  ap output..    "
-0003d0f0: 2222 0a20 2020 2069 6620 616c 6967 6e5f  "".    if align_
-0003d100: 6461 7461 6672 616d 6573 3a0a 2020 2020  dataframes:.    
-0003d110: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
-0003d120: 6466 735b 305d 2e64 6976 6973 696f 6e73  dfs[0].divisions
-0003d130: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-0003d140: 2020 2023 2055 6e61 6c69 676e 6564 2c20     # Unaligned, 
-0003d150: 6466 7320 6973 2061 206d 6978 206f 6620  dfs is a mix of 
-0003d160: 3120 7061 7274 6974 696f 6e20 616e 6420  1 partition and 
-0003d170: 312b 2070 6172 7469 7469 6f6e 2064 6174  1+ partition dat
-0003d180: 6166 7261 6d65 732c 0a20 2020 2020 2020  aframes,.       
-0003d190: 2023 2075 7365 206c 6f6e 6765 7374 2064   # use longest d
-0003d1a0: 6976 6973 696f 6e73 2066 6f75 6e64 0a20  ivisions found. 
-0003d1b0: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
-0003d1c0: 203d 206d 6178 2828 642e 6469 7669 7369   = max((d.divisi
-0003d1d0: 6f6e 7320 666f 7220 6420 696e 2064 6673  ons for d in dfs
-0003d1e0: 292c 206b 6579 3d6c 656e 290a 2020 2020  ), key=len).    
-0003d1f0: 6966 2074 7261 6e73 666f 726d 5f64 6976  if transform_div
-0003d200: 6973 696f 6e73 2061 6e64 2069 7369 6e73  isions and isins
-0003d210: 7461 6e63 6528 6466 735b 305d 2c20 496e  tance(dfs[0], In
-0003d220: 6465 7829 2061 6e64 206c 656e 2864 6673  dex) and len(dfs
-0003d230: 2920 3d3d 2031 3a0a 2020 2020 2020 2020  ) == 1:.        
-0003d240: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-0003d250: 2064 6976 6973 696f 6e73 203d 2066 756e   divisions = fun
-0003d260: 6328 0a20 2020 2020 2020 2020 2020 2020  c(.             
-0003d270: 2020 202a 5b70 642e 496e 6465 7828 612e     *[pd.Index(a.
-0003d280: 6469 7669 7369 6f6e 7329 2069 6620 6120  divisions) if a 
-0003d290: 6973 2064 6673 5b30 5d20 656c 7365 2061  is dfs[0] else a
-0003d2a0: 2066 6f72 2061 2069 6e20 6172 6773 5d2c   for a in args],
-0003d2b0: 202a 2a6b 7761 7267 730a 2020 2020 2020   **kwargs.      
-0003d2c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0003d2d0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0003d2e0: 6528 6469 7669 7369 6f6e 732c 2070 642e  e(divisions, pd.
-0003d2f0: 496e 6465 7829 3a0a 2020 2020 2020 2020  Index):.        
-0003d300: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
-0003d310: 7320 3d20 6d65 7468 6f64 732e 746f 6c69  s = methods.toli
-0003d320: 7374 2864 6976 6973 696f 6e73 290a 2020  st(divisions).  
-0003d330: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
-0003d340: 6570 7469 6f6e 3a0a 2020 2020 2020 2020  eption:.        
-0003d350: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
-0003d360: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0003d370: 2020 2069 6620 6e6f 7420 7661 6c69 645f     if not valid_
-0003d380: 6469 7669 7369 6f6e 7328 6469 7669 7369  divisions(divisi
-0003d390: 6f6e 7329 3a0a 2020 2020 2020 2020 2020  ons):.          
-0003d3a0: 2020 2020 2020 6469 7669 7369 6f6e 7320        divisions 
-0003d3b0: 3d20 5b4e 6f6e 655d 202a 2028 6466 735b  = [None] * (dfs[
-0003d3c0: 305d 2e6e 7061 7274 6974 696f 6e73 202b  0].npartitions +
-0003d3d0: 2031 290a 2020 2020 7265 7475 726e 2064   1).    return d
-0003d3e0: 6976 6973 696f 6e73 0a0a 0a64 6566 205f  ivisions...def _
-0003d3f0: 6765 745f 6d65 7461 5f6d 6170 5f70 6172  get_meta_map_par
-0003d400: 7469 7469 6f6e 7328 6172 6773 2c20 6466  titions(args, df
-0003d410: 732c 2066 756e 632c 206b 7761 7267 732c  s, func, kwargs,
-0003d420: 206d 6574 612c 2070 6172 656e 745f 6d65   meta, parent_me
-0003d430: 7461 293a 0a20 2020 2022 2222 0a20 2020  ta):.    """.   
-0003d440: 2048 656c 7065 7220 746f 2067 656e 6572   Helper to gener
-0003d450: 6174 6520 6d65 7461 6461 7461 2066 6f72  ate metadata for
-0003d460: 206d 6170 5f70 6172 7469 7469 6f6e 7320   map_partitions 
-0003d470: 616e 6420 6d61 705f 6f76 6572 6c61 7020  and map_overlap 
-0003d480: 6f75 7470 7574 2e0a 2020 2020 2222 220a  output..    """.
-0003d490: 2020 2020 6d65 7461 5f69 6e64 6578 203d      meta_index =
-0003d4a0: 2067 6574 6174 7472 286d 616b 655f 6d65   getattr(make_me
-0003d4b0: 7461 2864 6673 5b30 5d29 2c20 2269 6e64  ta(dfs[0]), "ind
-0003d4c0: 6578 222c 204e 6f6e 6529 2069 6620 6466  ex", None) if df
-0003d4d0: 7320 656c 7365 204e 6f6e 650a 2020 2020  s else None.    
-0003d4e0: 6966 2070 6172 656e 745f 6d65 7461 2069  if parent_meta i
-0003d4f0: 7320 4e6f 6e65 2061 6e64 2064 6673 3a0a  s None and dfs:.
-0003d500: 2020 2020 2020 2020 7061 7265 6e74 5f6d          parent_m
-0003d510: 6574 6120 3d20 6466 735b 305d 2e5f 6d65  eta = dfs[0]._me
-0003d520: 7461 0a20 2020 2069 6620 6d65 7461 2069  ta.    if meta i
-0003d530: 7320 6e6f 5f64 6566 6175 6c74 3a0a 2020  s no_default:.  
-0003d540: 2020 2020 2020 2320 5573 6520 6e6f 6e2d        # Use non-
-0003d550: 6e6f 726d 616c 697a 6564 206b 7761 7267  normalized kwarg
-0003d560: 7320 6865 7265 2c20 6173 2077 6520 7761  s here, as we wa
-0003d570: 6e74 2074 6865 2072 6561 6c20 7661 6c75  nt the real valu
-0003d580: 6573 2028 6e6f 740a 2020 2020 2020 2020  es (not.        
-0003d590: 2320 6465 6c61 7965 6420 7661 6c75 6573  # delayed values
-0003d5a0: 290a 2020 2020 2020 2020 6d65 7461 203d  ).        meta =
-0003d5b0: 205f 656d 756c 6174 6528 6675 6e63 2c20   _emulate(func, 
-0003d5c0: 2a61 7267 732c 2075 6466 3d54 7275 652c  *args, udf=True,
-0003d5d0: 202a 2a6b 7761 7267 7329 0a20 2020 2020   **kwargs).     
-0003d5e0: 2020 206d 6574 615f 6973 5f65 6d75 6c61     meta_is_emula
-0003d5f0: 7465 6420 3d20 5472 7565 0a20 2020 2065  ted = True.    e
-0003d600: 6c73 653a 0a20 2020 2020 2020 206d 6574  lse:.        met
-0003d610: 6120 3d20 6d61 6b65 5f6d 6574 6128 6d65  a = make_meta(me
-0003d620: 7461 2c20 696e 6465 783d 6d65 7461 5f69  ta, index=meta_i
-0003d630: 6e64 6578 2c20 7061 7265 6e74 5f6d 6574  ndex, parent_met
-0003d640: 613d 7061 7265 6e74 5f6d 6574 6129 0a20  a=parent_meta). 
-0003d650: 2020 2020 2020 206d 6574 615f 6973 5f65         meta_is_e
-0003d660: 6d75 6c61 7465 6420 3d20 4661 6c73 650a  mulated = False.
-0003d670: 0a20 2020 2069 6620 6e6f 7420 2868 6173  .    if not (has
-0003d680: 5f70 6172 616c 6c65 6c5f 7479 7065 286d  _parallel_type(m
-0003d690: 6574 6129 206f 7220 6973 5f61 7272 6179  eta) or is_array
-0003d6a0: 6c69 6b65 286d 6574 6129 2061 6e64 206d  like(meta) and m
-0003d6b0: 6574 612e 7368 6170 6529 2061 6e64 206e  eta.shape) and n
-0003d6c0: 6f74 2061 6c6c 280a 2020 2020 2020 2020  ot all(.        
-0003d6d0: 6973 696e 7374 616e 6365 2861 7267 2c20  isinstance(arg, 
-0003d6e0: 5363 616c 6172 2920 666f 7220 6172 6720  Scalar) for arg 
-0003d6f0: 696e 2061 7267 730a 2020 2020 293a 0a20  in args.    ):. 
-0003d700: 2020 2020 2020 2069 6620 6e6f 7420 6d65         if not me
-0003d710: 7461 5f69 735f 656d 756c 6174 6564 3a0a  ta_is_emulated:.
-0003d720: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-0003d730: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
-0003d740: 2020 2020 2020 2020 2020 2022 4d65 7461             "Meta
-0003d750: 2069 7320 6e6f 7420 7661 6c69 642c 2060   is not valid, `
-0003d760: 6d61 705f 7061 7274 6974 696f 6e73 6020  map_partitions` 
-0003d770: 616e 6420 606d 6170 5f6f 7665 726c 6170  and `map_overlap
-0003d780: 6020 6578 7065 6374 7320 6f75 7470 7574  ` expects output
-0003d790: 2074 6f20 6265 2061 2070 616e 6461 7320   to be a pandas 
-0003d7a0: 6f62 6a65 6374 2e20 220a 2020 2020 2020  object. ".      
-0003d7b0: 2020 2020 2020 2020 2020 2254 7279 2070            "Try p
-0003d7c0: 6173 7369 6e67 2061 2070 616e 6461 7320  assing a pandas 
-0003d7d0: 6f62 6a65 6374 2061 7320 6d65 7461 206f  object as meta o
-0003d7e0: 7220 6120 6469 6374 206f 7220 7475 706c  r a dict or tupl
-0003d7f0: 6520 7265 7072 6573 656e 7469 6e67 2074  e representing t
-0003d800: 6865 2022 0a20 2020 2020 2020 2020 2020  he ".           
-0003d810: 2020 2020 2022 286e 616d 652c 2064 7479       "(name, dty
-0003d820: 7065 2920 6f66 2074 6865 2063 6f6c 756d  pe) of the colum
-0003d830: 6e73 2e20 496e 2074 6865 2066 7574 7572  ns. In the futur
-0003d840: 6520 7468 6520 6d65 7461 2079 6f75 2070  e the meta you p
-0003d850: 6173 7365 6420 7769 6c6c 206e 6f74 2077  assed will not w
-0003d860: 6f72 6b2e 222c 0a20 2020 2020 2020 2020  ork.",.         
-0003d870: 2020 2020 2020 2046 7574 7572 6557 6172         FutureWar
-0003d880: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
-0003d890: 2020 290a 2020 2020 2020 2020 2320 4966    ).        # If
-0003d8a0: 2060 6d65 7461 6020 6973 206e 6f74 2061   `meta` is not a
-0003d8b0: 2070 616e 6461 7320 6f62 6a65 6374 2c20   pandas object, 
-0003d8c0: 7468 6520 636f 6e63 6174 656e 6174 6564  the concatenated
-0003d8d0: 2072 6573 756c 7473 2077 696c 6c20 6265   results will be
-0003d8e0: 2061 0a20 2020 2020 2020 2023 2064 6966   a.        # dif
-0003d8f0: 6665 7265 6e74 2074 7970 650a 2020 2020  ferent type.    
-0003d900: 2020 2020 6d65 7461 203d 206d 616b 655f      meta = make_
-0003d910: 6d65 7461 285f 636f 6e63 6174 285b 6d65  meta(_concat([me
-0003d920: 7461 5d29 2c20 696e 6465 783d 6d65 7461  ta]), index=meta
-0003d930: 5f69 6e64 6578 290a 0a20 2020 2023 2045  _index)..    # E
-0003d940: 6e73 7572 6520 6d65 7461 2069 7320 656d  nsure meta is em
-0003d950: 7074 7920 7365 7269 6573 0a20 2020 206d  pty series.    m
-0003d960: 6574 6120 3d20 6d61 6b65 5f6d 6574 6128  eta = make_meta(
-0003d970: 6d65 7461 2c20 7061 7265 6e74 5f6d 6574  meta, parent_met
-0003d980: 613d 7061 7265 6e74 5f6d 6574 6129 0a0a  a=parent_meta)..
-0003d990: 2020 2020 7265 7475 726e 206d 6574 610a      return meta.
-0003d9a0: 0a0a 6465 6620 6170 706c 795f 616e 645f  ..def apply_and_
-0003d9b0: 656e 666f 7263 6528 2a61 7267 732c 202a  enforce(*args, *
-0003d9c0: 2a6b 7761 7267 7329 3a0a 2020 2020 2222  *kwargs):.    ""
-0003d9d0: 2241 7070 6c79 2061 2066 756e 6374 696f  "Apply a functio
-0003d9e0: 6e2c 2061 6e64 2065 6e66 6f72 6365 2074  n, and enforce t
-0003d9f0: 6865 206f 7574 7075 7420 746f 206d 6174  he output to mat
-0003da00: 6368 206d 6574 610a 0a20 2020 2045 6e73  ch meta..    Ens
-0003da10: 7572 6573 2074 6865 206f 7574 7075 7420  ures the output 
-0003da20: 6861 7320 7468 6520 7361 6d65 2063 6f6c  has the same col
-0003da30: 756d 6e73 2c20 6576 656e 2069 6620 656d  umns, even if em
-0003da40: 7074 792e 2222 220a 2020 2020 6675 6e63  pty.""".    func
-0003da50: 203d 206b 7761 7267 732e 706f 7028 225f   = kwargs.pop("_
-0003da60: 6675 6e63 2229 0a20 2020 206d 6574 6120  func").    meta 
-0003da70: 3d20 6b77 6172 6773 2e70 6f70 2822 5f6d  = kwargs.pop("_m
-0003da80: 6574 6122 290a 2020 2020 6466 203d 2066  eta").    df = f
-0003da90: 756e 6328 2a61 7267 732c 202a 2a6b 7761  unc(*args, **kwa
-0003daa0: 7267 7329 0a20 2020 2069 6620 6973 5f64  rgs).    if is_d
-0003dab0: 6174 6166 7261 6d65 5f6c 696b 6528 6466  ataframe_like(df
-0003dac0: 2920 6f72 2069 735f 7365 7269 6573 5f6c  ) or is_series_l
-0003dad0: 696b 6528 6466 2920 6f72 2069 735f 696e  ike(df) or is_in
-0003dae0: 6465 785f 6c69 6b65 2864 6629 3a0a 2020  dex_like(df):.  
-0003daf0: 2020 2020 2020 6966 206e 6f74 206c 656e        if not len
-0003db00: 2864 6629 3a0a 2020 2020 2020 2020 2020  (df):.          
-0003db10: 2020 7265 7475 726e 206d 6574 610a 2020    return meta.  
-0003db20: 2020 2020 2020 6966 2069 735f 6461 7461        if is_data
-0003db30: 6672 616d 655f 6c69 6b65 2864 6629 3a0a  frame_like(df):.
-0003db40: 2020 2020 2020 2020 2020 2020 6368 6563              chec
-0003db50: 6b5f 6d61 7463 6869 6e67 5f63 6f6c 756d  k_matching_colum
-0003db60: 6e73 286d 6574 612c 2064 6629 0a20 2020  ns(meta, df).   
-0003db70: 2020 2020 2020 2020 2063 203d 206d 6574           c = met
-0003db80: 612e 636f 6c75 6d6e 730a 2020 2020 2020  a.columns.      
-0003db90: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0003dba0: 2020 2020 6320 3d20 6d65 7461 2e6e 616d      c = meta.nam
-0003dbb0: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
-0003dbc0: 205f 7265 6e61 6d65 2863 2c20 6466 290a   _rename(c, df).
-0003dbd0: 2020 2020 7265 7475 726e 2064 660a 0a0a      return df...
-0003dbe0: 6465 6620 5f72 656e 616d 6528 636f 6c75  def _rename(colu
-0003dbf0: 6d6e 732c 2064 6629 3a0a 2020 2020 2222  mns, df):.    ""
-0003dc00: 220a 2020 2020 5265 6e61 6d65 2063 6f6c  ".    Rename col
-0003dc10: 756d 6e73 206f 6620 7064 2e44 6174 6146  umns of pd.DataF
-0003dc20: 7261 6d65 206f 7220 6e61 6d65 206f 6620  rame or name of 
-0003dc30: 7064 2e53 6572 6965 732e 0a20 2020 204e  pd.Series..    N
-0003dc40: 6f74 2066 6f72 2064 642e 4461 7461 4672  ot for dd.DataFr
-0003dc50: 616d 6520 6f72 2064 642e 5365 7269 6573  ame or dd.Series
-0003dc60: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-0003dc70: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-0003dc80: 0a20 2020 2063 6f6c 756d 6e73 203a 2074  .    columns : t
-0003dc90: 7570 6c65 2c20 7374 7269 6e67 2c20 7064  uple, string, pd
-0003dca0: 2e44 6174 6146 7261 6d65 206f 7220 7064  .DataFrame or pd
-0003dcb0: 2e53 6572 6965 730a 2020 2020 2020 2020  .Series.        
-0003dcc0: 436f 6c75 6d6e 206e 616d 6573 2c20 5365  Column names, Se
-0003dcd0: 7269 6573 206e 616d 6520 6f72 2070 616e  ries name or pan
-0003dce0: 6461 7320 696e 7374 616e 6365 2077 6869  das instance whi
-0003dcf0: 6368 2068 6173 2074 6865 0a20 2020 2020  ch has the.     
-0003dd00: 2020 2074 6172 6765 7420 636f 6c75 6d6e     target column
-0003dd10: 206e 616d 6573 202f 206e 616d 652e 0a20   names / name.. 
-0003dd20: 2020 2064 6620 3a20 7064 2e44 6174 6146     df : pd.DataF
-0003dd30: 7261 6d65 206f 7220 7064 2e53 6572 6965  rame or pd.Serie
-0003dd40: 730a 2020 2020 2020 2020 7461 7267 6574  s.        target
-0003dd50: 2044 6174 6146 7261 6d65 202f 2053 6572   DataFrame / Ser
-0003dd60: 6965 7320 746f 2062 6520 7265 6e61 6d65  ies to be rename
-0003dd70: 640a 2020 2020 2222 220a 2020 2020 6173  d.    """.    as
-0003dd80: 7365 7274 206e 6f74 2069 7369 6e73 7461  sert not isinsta
-0003dd90: 6e63 6528 6466 2c20 5f46 7261 6d65 290a  nce(df, _Frame).
-0003dda0: 0a20 2020 2069 6620 636f 6c75 6d6e 7320  .    if columns 
-0003ddb0: 6973 206e 6f5f 6465 6661 756c 743a 0a20  is no_default:. 
-0003ddc0: 2020 2020 2020 2072 6574 7572 6e20 6466         return df
-0003ddd0: 0a0a 2020 2020 6966 2069 7369 6e73 7461  ..    if isinsta
-0003dde0: 6e63 6528 636f 6c75 6d6e 732c 2049 7465  nce(columns, Ite
-0003ddf0: 7261 746f 7229 3a0a 2020 2020 2020 2020  rator):.        
-0003de00: 636f 6c75 6d6e 7320 3d20 6c69 7374 2863  columns = list(c
-0003de10: 6f6c 756d 6e73 290a 0a20 2020 2069 6620  olumns)..    if 
-0003de20: 6973 5f64 6174 6166 7261 6d65 5f6c 696b  is_dataframe_lik
-0003de30: 6528 6466 293a 0a20 2020 2020 2020 2069  e(df):.        i
-0003de40: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
-0003de50: 696b 6528 636f 6c75 6d6e 7329 3a0a 2020  ike(columns):.  
-0003de60: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-0003de70: 7320 3d20 636f 6c75 6d6e 732e 636f 6c75  s = columns.colu
-0003de80: 6d6e 730a 2020 2020 2020 2020 6966 206e  mns.        if n
-0003de90: 6f74 2069 7369 6e73 7461 6e63 6528 636f  ot isinstance(co
-0003dea0: 6c75 6d6e 732c 2070 642e 496e 6465 7829  lumns, pd.Index)
-0003deb0: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
-0003dec0: 6c75 6d6e 7320 3d20 7064 2e49 6e64 6578  lumns = pd.Index
-0003ded0: 2863 6f6c 756d 6e73 290a 2020 2020 2020  (columns).      
-0003dee0: 2020 6966 2028 0a20 2020 2020 2020 2020    if (.         
-0003def0: 2020 206c 656e 2863 6f6c 756d 6e73 2920     len(columns) 
-0003df00: 3d3d 206c 656e 2864 662e 636f 6c75 6d6e  == len(df.column
-0003df10: 7329 0a20 2020 2020 2020 2020 2020 2061  s).            a
-0003df20: 6e64 2074 7970 6528 636f 6c75 6d6e 7329  nd type(columns)
-0003df30: 2069 7320 7479 7065 2864 662e 636f 6c75   is type(df.colu
-0003df40: 6d6e 7329 0a20 2020 2020 2020 2020 2020  mns).           
-0003df50: 2061 6e64 2063 6f6c 756d 6e73 2e64 7479   and columns.dty
-0003df60: 7065 203d 3d20 6466 2e63 6f6c 756d 6e73  pe == df.columns
-0003df70: 2e64 7479 7065 0a20 2020 2020 2020 2020  .dtype.         
-0003df80: 2020 2061 6e64 2063 6f6c 756d 6e73 2e65     and columns.e
-0003df90: 7175 616c 7328 6466 2e63 6f6c 756d 6e73  quals(df.columns
-0003dfa0: 290a 2020 2020 2020 2020 293a 0a20 2020  ).        ):.   
-0003dfb0: 2020 2020 2020 2020 2023 2069 6620 7461           # if ta
-0003dfc0: 7267 6574 2069 7320 6964 656e 7469 6361  rget is identica
-0003dfd0: 6c2c 2072 656e 616d 6520 6973 206e 6f74  l, rename is not
-0003dfe0: 206e 6563 6573 7361 7279 0a20 2020 2020   necessary.     
-0003dff0: 2020 2020 2020 2072 6574 7572 6e20 6466         return df
-0003e000: 0a20 2020 2020 2020 2023 2064 6565 703d  .        # deep=
-0003e010: 4661 6c73 6520 646f 6573 6e27 7420 646f  False doesn't do
-0003e020: 6573 6e27 7420 636f 7079 2061 6e79 2064  esn't copy any d
-0003e030: 6174 612f 696e 6469 6365 732c 2073 6f20  ata/indices, so 
-0003e040: 7468 6973 2069 7320 6368 6561 700a 2020  this is cheap.  
-0003e050: 2020 2020 2020 6466 203d 2064 662e 636f        df = df.co
-0003e060: 7079 2864 6565 703d 4661 6c73 6529 0a20  py(deep=False). 
-0003e070: 2020 2020 2020 2064 662e 636f 6c75 6d6e         df.column
-0003e080: 7320 3d20 636f 6c75 6d6e 730a 2020 2020  s = columns.    
-0003e090: 2020 2020 7265 7475 726e 2064 660a 2020      return df.  
-0003e0a0: 2020 656c 6966 2069 735f 7365 7269 6573    elif is_series
-0003e0b0: 5f6c 696b 6528 6466 2920 6f72 2069 735f  _like(df) or is_
-0003e0c0: 696e 6465 785f 6c69 6b65 2864 6629 3a0a  index_like(df):.
-0003e0d0: 2020 2020 2020 2020 6966 2069 735f 7365          if is_se
-0003e0e0: 7269 6573 5f6c 696b 6528 636f 6c75 6d6e  ries_like(column
-0003e0f0: 7329 206f 7220 6973 5f69 6e64 6578 5f6c  s) or is_index_l
-0003e100: 696b 6528 636f 6c75 6d6e 7329 3a0a 2020  ike(columns):.  
-0003e110: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-0003e120: 7320 3d20 636f 6c75 6d6e 732e 6e61 6d65  s = columns.name
-0003e130: 0a20 2020 2020 2020 2069 6620 6466 2e6e  .        if df.n
-0003e140: 616d 6520 3d3d 2063 6f6c 756d 6e73 3a0a  ame == columns:.
-0003e150: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0003e160: 726e 2064 660a 2020 2020 2020 2020 7265  rn df.        re
-0003e170: 7475 726e 2064 662e 7265 6e61 6d65 2863  turn df.rename(c
-0003e180: 6f6c 756d 6e73 290a 2020 2020 2320 6d61  olumns).    # ma
-0003e190: 705f 7061 7274 6974 696f 6e20 6d61 7920  p_partition may 
-0003e1a0: 7061 7373 206f 7468 6572 2074 7970 6573  pass other types
-0003e1b0: 0a20 2020 2072 6574 7572 6e20 6466 0a0a  .    return df..
-0003e1c0: 0a64 6566 205f 7265 6e61 6d65 5f64 6173  .def _rename_das
-0003e1d0: 6b28 6466 2c20 6e61 6d65 7329 3a0a 2020  k(df, names):.  
-0003e1e0: 2020 2222 220a 2020 2020 4465 7374 7275    """.    Destru
-0003e1f0: 6374 6976 656c 7920 7265 6e61 6d65 2063  ctively rename c
-0003e200: 6f6c 756d 6e73 206f 6620 6464 2e44 6174  olumns of dd.Dat
-0003e210: 6146 7261 6d65 206f 7220 6e61 6d65 206f  aFrame or name o
-0003e220: 6620 6464 2e53 6572 6965 732e 0a20 2020  f dd.Series..   
-0003e230: 204e 6f74 2066 6f72 2070 642e 4461 7461   Not for pd.Data
-0003e240: 4672 616d 6520 6f72 2070 642e 5365 7269  Frame or pd.Seri
-0003e250: 6573 2e0a 0a20 2020 2049 6e74 6572 6e61  es...    Interna
-0003e260: 6c6c 7920 7573 6564 2074 6f20 6f76 6572  lly used to over
-0003e270: 7772 6974 6520 6464 2e44 6174 6146 7261  write dd.DataFra
-0003e280: 6d65 2e63 6f6c 756d 6e73 2061 6e64 2064  me.columns and d
-0003e290: 642e 5365 7269 6573 2e6e 616d 650a 2020  d.Series.name.  
-0003e2a0: 2020 5765 2063 616e 2774 2075 7365 206d    We can't use m
-0003e2b0: 6170 5f70 6172 7469 7469 6f6e 2062 6563  ap_partition bec
-0003e2c0: 6175 7365 2069 7420 6170 706c 6965 7320  ause it applies 
-0003e2d0: 6675 6e63 7469 6f6e 2074 6865 6e20 7265  function then re
-0003e2e0: 6e61 6d65 0a0a 2020 2020 5061 7261 6d65  name..    Parame
-0003e2f0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
-0003e300: 2d2d 2d0a 2020 2020 6466 203a 2064 642e  ---.    df : dd.
-0003e310: 4461 7461 4672 616d 6520 6f72 2064 642e  DataFrame or dd.
-0003e320: 5365 7269 6573 0a20 2020 2020 2020 2074  Series.        t
-0003e330: 6172 6765 7420 4461 7461 4672 616d 6520  arget DataFrame 
-0003e340: 2f20 5365 7269 6573 2074 6f20 6265 2072  / Series to be r
-0003e350: 656e 616d 6564 0a20 2020 206e 616d 6573  enamed.    names
-0003e360: 203a 2074 7570 6c65 2c20 7374 7269 6e67   : tuple, string
-0003e370: 0a20 2020 2020 2020 2043 6f6c 756d 6e20  .        Column 
-0003e380: 6e61 6d65 732f 5365 7269 6573 206e 616d  names/Series nam
-0003e390: 650a 2020 2020 2222 220a 0a20 2020 2061  e.    """..    a
-0003e3a0: 7373 6572 7420 6973 696e 7374 616e 6365  ssert isinstance
-0003e3b0: 2864 662c 205f 4672 616d 6529 0a20 2020  (df, _Frame).   
-0003e3c0: 206d 6574 6164 6174 6120 3d20 5f72 656e   metadata = _ren
-0003e3d0: 616d 6528 6e61 6d65 732c 2064 662e 5f6d  ame(names, df._m
-0003e3e0: 6574 6129 0a20 2020 206e 616d 6520 3d20  eta).    name = 
-0003e3f0: 6622 7265 6e61 6d65 2d7b 746f 6b65 6e69  f"rename-{tokeni
-0003e400: 7a65 2864 662c 206d 6574 6164 6174 6129  ze(df, metadata)
-0003e410: 7d22 0a0a 2020 2020 6473 6b20 3d20 7061  }"..    dsk = pa
-0003e420: 7274 6974 696f 6e77 6973 655f 6772 6170  rtitionwise_grap
-0003e430: 6828 5f72 656e 616d 652c 206e 616d 652c  h(_rename, name,
-0003e440: 206d 6574 6164 6174 612c 2064 6629 0a20   metadata, df). 
-0003e450: 2020 2067 7261 7068 203d 2048 6967 684c     graph = HighL
-0003e460: 6576 656c 4772 6170 682e 6672 6f6d 5f63  evelGraph.from_c
-0003e470: 6f6c 6c65 6374 696f 6e73 286e 616d 652c  ollections(name,
-0003e480: 2064 736b 2c20 6465 7065 6e64 656e 6369   dsk, dependenci
-0003e490: 6573 3d5b 6466 5d29 0a20 2020 2072 6574  es=[df]).    ret
-0003e4a0: 7572 6e20 6e65 775f 6464 5f6f 626a 6563  urn new_dd_objec
-0003e4b0: 7428 6772 6170 682c 206e 616d 652c 206d  t(graph, name, m
-0003e4c0: 6574 6164 6174 612c 2064 662e 6469 7669  etadata, df.divi
-0003e4d0: 7369 6f6e 7329 0a0a 0a64 6566 2071 7561  sions)...def qua
-0003e4e0: 6e74 696c 6528 6466 2c20 712c 206d 6574  ntile(df, q, met
-0003e4f0: 686f 643d 2264 6566 6175 6c74 2229 3a0a  hod="default"):.
-0003e500: 2020 2020 2222 2241 7070 726f 7869 6d61      """Approxima
-0003e510: 7465 2071 7561 6e74 696c 6573 206f 6620  te quantiles of 
-0003e520: 5365 7269 6573 2e0a 0a20 2020 2050 6172  Series...    Par
-0003e530: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
-0003e540: 2d2d 2d2d 2d2d 0a20 2020 2071 203a 206c  ------.    q : l
-0003e550: 6973 742f 6172 7261 7920 6f66 2066 6c6f  ist/array of flo
-0003e560: 6174 730a 2020 2020 2020 2020 4974 6572  ats.        Iter
-0003e570: 6162 6c65 206f 6620 6e75 6d62 6572 7320  able of numbers 
-0003e580: 7261 6e67 696e 6720 6672 6f6d 2030 2074  ranging from 0 t
-0003e590: 6f20 3130 3020 666f 7220 7468 6520 6465  o 100 for the de
-0003e5a0: 7369 7265 6420 7175 616e 7469 6c65 730a  sired quantiles.
-0003e5b0: 2020 2020 6d65 7468 6f64 203a 207b 2764      method : {'d
-0003e5c0: 6566 6175 6c74 272c 2027 7464 6967 6573  efault', 'tdiges
-0003e5d0: 7427 2c20 2764 6173 6b27 7d2c 206f 7074  t', 'dask'}, opt
-0003e5e0: 696f 6e61 6c0a 2020 2020 2020 2020 5768  ional.        Wh
-0003e5f0: 6174 206d 6574 686f 6420 746f 2075 7365  at method to use
-0003e600: 2e20 4279 2064 6566 6175 6c74 2077 696c  . By default wil
-0003e610: 6c20 7573 6520 6461 736b 2773 2069 6e74  l use dask's int
-0003e620: 6572 6e61 6c20 6375 7374 6f6d 0a20 2020  ernal custom.   
-0003e630: 2020 2020 2061 6c67 6f72 6974 686d 2028       algorithm (
-0003e640: 6060 2764 6173 6b27 6060 292e 2020 4966  ``'dask'``).  If
-0003e650: 2073 6574 2074 6f20 6060 2774 6469 6765   set to ``'tdige
-0003e660: 7374 2760 6020 7769 6c6c 2075 7365 2074  st'`` will use t
-0003e670: 6469 6765 7374 2066 6f72 0a20 2020 2020  digest for.     
-0003e680: 2020 2066 6c6f 6174 7320 616e 6420 696e     floats and in
-0003e690: 7473 2061 6e64 2066 616c 6c62 6163 6b20  ts and fallback 
-0003e6a0: 746f 2074 6865 2060 6027 6461 736b 2760  to the ``'dask'`
-0003e6b0: 6020 6f74 6865 7277 6973 652e 0a20 2020  ` otherwise..   
-0003e6c0: 2022 2222 0a20 2020 2023 2063 7572 7265   """.    # curre
-0003e6d0: 6e74 2069 6d70 6c65 6d65 6e74 6174 696f  nt implementatio
-0003e6e0: 6e20 6e65 6564 7320 7120 746f 2062 6520  n needs q to be 
-0003e6f0: 736f 7274 6564 2073 6f0a 2020 2020 2320  sorted so.    # 
-0003e700: 736f 7274 2069 6620 6172 7261 792d 6c69  sort if array-li
-0003e710: 6b65 2c20 6f74 6865 7277 6973 6520 6c65  ke, otherwise le
-0003e720: 6176 6520 6974 2061 6c6f 6e65 0a20 2020  ave it alone.   
-0003e730: 2071 5f6e 6461 7272 6179 203d 206e 702e   q_ndarray = np.
-0003e740: 6172 7261 7928 7129 0a20 2020 2069 6620  array(q).    if 
-0003e750: 715f 6e64 6172 7261 792e 6e64 696d 203e  q_ndarray.ndim >
-0003e760: 2030 3a0a 2020 2020 2020 2020 715f 6e64   0:.        q_nd
-0003e770: 6172 7261 792e 736f 7274 286b 696e 643d  array.sort(kind=
-0003e780: 226d 6572 6765 736f 7274 2229 0a20 2020  "mergesort").   
-0003e790: 2020 2020 2071 203d 2071 5f6e 6461 7272       q = q_ndarr
-0003e7a0: 6179 0a0a 2020 2020 6173 7365 7274 2069  ay..    assert i
-0003e7b0: 7369 6e73 7461 6e63 6528 6466 2c20 5365  sinstance(df, Se
-0003e7c0: 7269 6573 290a 0a20 2020 2061 6c6c 6f77  ries)..    allow
-0003e7d0: 6564 5f6d 6574 686f 6473 203d 205b 2264  ed_methods = ["d
-0003e7e0: 6566 6175 6c74 222c 2022 6461 736b 222c  efault", "dask",
-0003e7f0: 2022 7464 6967 6573 7422 5d0a 2020 2020   "tdigest"].    
-0003e800: 6966 206d 6574 686f 6420 6e6f 7420 696e  if method not in
-0003e810: 2061 6c6c 6f77 6564 5f6d 6574 686f 6473   allowed_methods
-0003e820: 3a0a 2020 2020 2020 2020 7261 6973 6520  :.        raise 
-0003e830: 5661 6c75 6545 7272 6f72 2822 6d65 7468  ValueError("meth
-0003e840: 6f64 2063 616e 206f 6e6c 7920 6265 2027  od can only be '
-0003e850: 6465 6661 756c 7427 2c20 2764 6173 6b27  default', 'dask'
-0003e860: 206f 7220 2774 6469 6765 7374 2722 290a   or 'tdigest'").
-0003e870: 0a20 2020 2069 6620 6d65 7468 6f64 203d  .    if method =
-0003e880: 3d20 2264 6566 6175 6c74 223a 0a20 2020  = "default":.   
-0003e890: 2020 2020 2069 6e74 6572 6e61 6c5f 6d65       internal_me
-0003e8a0: 7468 6f64 203d 2022 6461 736b 220a 2020  thod = "dask".  
-0003e8b0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0003e8c0: 696e 7465 726e 616c 5f6d 6574 686f 6420  internal_method 
-0003e8d0: 3d20 6d65 7468 6f64 0a0a 2020 2020 2320  = method..    # 
-0003e8e0: 6375 7272 656e 746c 792c 206f 6e6c 7920  currently, only 
-0003e8f0: 5365 7269 6573 2068 6173 2071 7561 6e74  Series has quant
-0003e900: 696c 6520 6d65 7468 6f64 0a20 2020 2069  ile method.    i
-0003e910: 6620 6973 696e 7374 616e 6365 2864 662c  f isinstance(df,
-0003e920: 2049 6e64 6578 293a 0a20 2020 2020 2020   Index):.       
-0003e930: 2073 6572 6965 735f 7479 7020 3d20 6466   series_typ = df
-0003e940: 2e5f 6d65 7461 2e74 6f5f 7365 7269 6573  ._meta.to_series
-0003e950: 2829 2e5f 636f 6e73 7472 7563 746f 720a  ()._constructor.
-0003e960: 2020 2020 2020 2020 6d65 7461 203d 2064          meta = d
-0003e970: 662e 5f6d 6574 615f 6e6f 6e65 6d70 7479  f._meta_nonempty
-0003e980: 2e74 6f5f 7365 7269 6573 2829 2e71 7561  .to_series().qua
-0003e990: 6e74 696c 6528 7129 0a20 2020 2065 6c73  ntile(q).    els
-0003e9a0: 653a 0a20 2020 2020 2020 2069 6620 6973  e:.        if is
-0003e9b0: 5f73 6572 6965 735f 6c69 6b65 2864 662e  _series_like(df.
-0003e9c0: 5f6d 6574 6129 3a0a 2020 2020 2020 2020  _meta):.        
-0003e9d0: 2020 2020 7365 7269 6573 5f74 7970 203d      series_typ =
-0003e9e0: 2064 662e 5f6d 6574 612e 5f63 6f6e 7374   df._meta._const
-0003e9f0: 7275 6374 6f72 0a20 2020 2020 2020 2065  ructor.        e
-0003ea00: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0003ea10: 2073 6572 6965 735f 7479 7020 3d20 6466   series_typ = df
-0003ea20: 2e5f 6d65 7461 2e5f 636f 6e73 7472 7563  ._meta._construc
-0003ea30: 746f 725f 736c 6963 6564 0a20 2020 2020  tor_sliced.     
-0003ea40: 2020 206d 6574 6120 3d20 6466 2e5f 6d65     meta = df._me
-0003ea50: 7461 5f6e 6f6e 656d 7074 792e 7175 616e  ta_nonempty.quan
-0003ea60: 7469 6c65 2871 290a 0a20 2020 2069 6620  tile(q)..    if 
-0003ea70: 6973 5f73 6572 6965 735f 6c69 6b65 286d  is_series_like(m
-0003ea80: 6574 6129 3a0a 2020 2020 2020 2020 2320  eta):.        # 
-0003ea90: 496e 6465 782e 7175 616e 7469 6c65 286c  Index.quantile(l
-0003eaa0: 6973 742d 6c69 6b65 2920 6d75 7374 2062  ist-like) must b
-0003eab0: 6520 7064 2e53 6572 6965 732c 206e 6f74  e pd.Series, not
-0003eac0: 2070 642e 496e 6465 780a 2020 2020 2020   pd.Index.      
-0003ead0: 2020 6466 5f6e 616d 6520 3d20 6466 2e6e    df_name = df.n
-0003eae0: 616d 650a 2020 2020 2020 2020 6669 6e61  ame.        fina
-0003eaf0: 6c69 7a65 5f74 736b 203d 206c 616d 6264  lize_tsk = lambd
-0003eb00: 6120 7473 6b3a 2028 7365 7269 6573 5f74  a tsk: (series_t
-0003eb10: 7970 2c20 7473 6b2c 2071 2c20 4e6f 6e65  yp, tsk, q, None
-0003eb20: 2c20 6466 5f6e 616d 6529 0a20 2020 2020  , df_name).     
-0003eb30: 2020 2072 6574 7572 6e5f 7479 7065 203d     return_type =
-0003eb40: 2053 6572 6965 730a 2020 2020 656c 7365   Series.    else
-0003eb50: 3a0a 2020 2020 2020 2020 2320 7265 7061  :.        # repa
-0003eb60: 636b 2061 7320 5365 7269 6573 206f 626a  ck as Series obj
-0003eb70: 6563 7420 746f 2063 6f6e 7665 7274 2073  ect to convert s
-0003eb80: 6361 6c61 7273 2066 726f 6d20 4e75 6d50  calars from NumP
-0003eb90: 7920 6261 636b 2062 6566 6f72 6520 6578  y back before ex
-0003eba0: 7472 6163 7469 6e67 0a20 2020 2020 2020  tracting.       
-0003ebb0: 2066 696e 616c 697a 655f 7473 6b20 3d20   finalize_tsk = 
-0003ebc0: 6c61 6d62 6461 2074 736b 3a20 280a 2020  lambda tsk: (.  
-0003ebd0: 2020 2020 2020 2020 2020 6c61 6d62 6461            lambda
-0003ebe0: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-0003ebf0: 3a20 7365 7269 6573 5f74 7970 282a 6172  : series_typ(*ar
-0003ec00: 6773 2c20 2a2a 6b77 6172 6773 295b 305d  gs, **kwargs)[0]
-0003ec10: 2c0a 2020 2020 2020 2020 2020 2020 7473  ,.            ts
-0003ec20: 6b2c 0a20 2020 2020 2020 2020 2020 205b  k,.            [
-0003ec30: 305d 2c0a 2020 2020 2020 2020 290a 2020  0],.        ).  
-0003ec40: 2020 2020 2020 7265 7475 726e 5f74 7970        return_typ
-0003ec50: 6520 3d20 5363 616c 6172 0a20 2020 2020  e = Scalar.     
-0003ec60: 2020 2071 203d 205b 715d 0a0a 2020 2020     q = [q]..    
-0003ec70: 2320 7061 6e64 6173 2075 7365 7320 7175  # pandas uses qu
-0003ec80: 616e 7469 6c65 2069 6e20 5b30 2c20 315d  antile in [0, 1]
-0003ec90: 0a20 2020 2023 206e 756d 7079 202f 2065  .    # numpy / e
-0003eca0: 7665 7279 6f6e 6520 656c 7365 2075 7365  veryone else use
-0003ecb0: 7320 5b30 2c20 3130 305d 0a20 2020 2071  s [0, 100].    q
-0003ecc0: 7320 3d20 6e70 2e61 7361 7272 6179 2871  s = np.asarray(q
-0003ecd0: 2920 2a20 3130 300a 2020 2020 746f 6b65  ) * 100.    toke
-0003ece0: 6e20 3d20 746f 6b65 6e69 7a65 2864 662c  n = tokenize(df,
-0003ecf0: 2071 7329 0a0a 2020 2020 6966 206c 656e   qs)..    if len
-0003ed00: 2871 7329 203d 3d20 303a 0a20 2020 2020  (qs) == 0:.     
-0003ed10: 2020 206e 616d 6520 3d20 2271 7561 6e74     name = "quant
-0003ed20: 696c 6573 2d22 202b 2074 6f6b 656e 0a20  iles-" + token. 
-0003ed30: 2020 2020 2020 2065 6d70 7479 5f69 6e64         empty_ind
-0003ed40: 6578 203d 2070 642e 496e 6465 7828 5b5d  ex = pd.Index([]
-0003ed50: 2c20 6474 7970 653d 666c 6f61 7429 0a0a  , dtype=float)..
-0003ed60: 2020 2020 2020 2020 7265 7475 726e 2053          return S
-0003ed70: 6572 6965 7328 0a20 2020 2020 2020 2020  eries(.         
-0003ed80: 2020 207b 286e 616d 652c 2030 293a 2073     {(name, 0): s
-0003ed90: 6572 6965 735f 7479 7028 5b5d 2c20 6e61  eries_typ([], na
-0003eda0: 6d65 3d64 662e 6e61 6d65 2c20 696e 6465  me=df.name, inde
-0003edb0: 783d 656d 7074 795f 696e 6465 782c 2064  x=empty_index, d
-0003edc0: 7479 7065 3d22 666c 6f61 7422 297d 2c0a  type="float")},.
-0003edd0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-0003ede0: 2c0a 2020 2020 2020 2020 2020 2020 6466  ,.            df
-0003edf0: 2e5f 6d65 7461 2c0a 2020 2020 2020 2020  ._meta,.        
-0003ee00: 2020 2020 5b4e 6f6e 652c 204e 6f6e 655d      [None, None]
-0003ee10: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0003ee20: 656c 7365 3a0a 2020 2020 2020 2020 6e65  else:.        ne
-0003ee30: 775f 6469 7669 7369 6f6e 7320 3d20 5b6e  w_divisions = [n
-0003ee40: 702e 6d69 6e28 7129 2c20 6e70 2e6d 6178  p.min(q), np.max
-0003ee50: 2871 295d 0a0a 2020 2020 6466 203d 2064  (q)]..    df = d
-0003ee60: 662e 6472 6f70 6e61 2829 0a0a 2020 2020  f.dropna()..    
-0003ee70: 6966 2069 6e74 6572 6e61 6c5f 6d65 7468  if internal_meth
-0003ee80: 6f64 203d 3d20 2274 6469 6765 7374 2220  od == "tdigest" 
-0003ee90: 616e 6420 280a 2020 2020 2020 2020 6e70  and (.        np
-0003eea0: 2e69 7373 7562 6474 7970 6528 6466 2e64  .issubdtype(df.d
-0003eeb0: 7479 7065 2c20 6e70 2e66 6c6f 6174 696e  type, np.floatin
-0003eec0: 6729 206f 7220 6e70 2e69 7373 7562 6474  g) or np.issubdt
-0003eed0: 7970 6528 6466 2e64 7479 7065 2c20 6e70  ype(df.dtype, np
-0003eee0: 2e69 6e74 6567 6572 290a 2020 2020 293a  .integer).    ):
-0003eef0: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
-0003ef00: 736b 2e75 7469 6c73 2069 6d70 6f72 7420  sk.utils import 
-0003ef10: 696d 706f 7274 5f72 6571 7569 7265 640a  import_required.
-0003ef20: 0a20 2020 2020 2020 2069 6d70 6f72 745f  .        import_
-0003ef30: 7265 7175 6972 6564 280a 2020 2020 2020  required(.      
-0003ef40: 2020 2020 2020 2263 7269 636b 222c 2022        "crick", "
-0003ef50: 6372 6963 6b20 6973 2061 2072 6571 7569  crick is a requi
-0003ef60: 7265 6420 6465 7065 6e64 656e 6379 2066  red dependency f
-0003ef70: 6f72 2075 7369 6e67 2074 6865 2074 2d64  or using the t-d
-0003ef80: 6967 6573 7420 6d65 7468 6f64 2e22 0a20  igest method.". 
-0003ef90: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0003efa0: 2020 6672 6f6d 2064 6173 6b2e 6172 7261    from dask.arra
-0003efb0: 792e 7065 7263 656e 7469 6c65 2069 6d70  y.percentile imp
-0003efc0: 6f72 7420 5f70 6572 6365 6e74 696c 6573  ort _percentiles
-0003efd0: 5f66 726f 6d5f 7464 6967 6573 742c 205f  _from_tdigest, _
-0003efe0: 7464 6967 6573 745f 6368 756e 6b0a 0a20  tdigest_chunk.. 
-0003eff0: 2020 2020 2020 206e 616d 6520 3d20 2271         name = "q
-0003f000: 7561 6e74 696c 6573 5f74 6469 6765 7374  uantiles_tdigest
-0003f010: 2d31 2d22 202b 2074 6f6b 656e 0a20 2020  -1-" + token.   
-0003f020: 2020 2020 2076 616c 5f64 736b 203d 207b       val_dsk = {
-0003f030: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
-0003f040: 6d65 2c20 6929 3a20 285f 7464 6967 6573  me, i): (_tdiges
-0003f050: 745f 6368 756e 6b2c 2028 6765 7461 7474  t_chunk, (getatt
-0003f060: 722c 206b 6579 2c20 2276 616c 7565 7322  r, key, "values"
-0003f070: 2929 0a20 2020 2020 2020 2020 2020 2066  )).            f
-0003f080: 6f72 2069 2c20 6b65 7920 696e 2065 6e75  or i, key in enu
-0003f090: 6d65 7261 7465 2864 662e 5f5f 6461 736b  merate(df.__dask
-0003f0a0: 5f6b 6579 735f 5f28 2929 0a20 2020 2020  _keys__()).     
-0003f0b0: 2020 207d 0a0a 2020 2020 2020 2020 6e61     }..        na
-0003f0c0: 6d65 3220 3d20 2271 7561 6e74 696c 6573  me2 = "quantiles
-0003f0d0: 5f74 6469 6765 7374 2d32 2d22 202b 2074  _tdigest-2-" + t
-0003f0e0: 6f6b 656e 0a20 2020 2020 2020 206d 6572  oken.        mer
-0003f0f0: 6765 5f64 736b 203d 207b 0a20 2020 2020  ge_dsk = {.     
-0003f100: 2020 2020 2020 2028 6e61 6d65 322c 2030         (name2, 0
-0003f110: 293a 2066 696e 616c 697a 655f 7473 6b28  ): finalize_tsk(
-0003f120: 285f 7065 7263 656e 7469 6c65 735f 6672  (_percentiles_fr
-0003f130: 6f6d 5f74 6469 6765 7374 2c20 7173 2c20  om_tdigest, qs, 
-0003f140: 736f 7274 6564 2876 616c 5f64 736b 2929  sorted(val_dsk))
-0003f150: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
-0003f160: 656c 7365 3a0a 2020 2020 2020 2020 6672  else:.        fr
-0003f170: 6f6d 2064 6173 6b2e 6172 7261 792e 6469  om dask.array.di
-0003f180: 7370 6174 6368 2069 6d70 6f72 7420 7065  spatch import pe
-0003f190: 7263 656e 7469 6c65 5f6c 6f6f 6b75 7020  rcentile_lookup 
-0003f1a0: 6173 205f 7065 7263 656e 7469 6c65 0a20  as _percentile. 
-0003f1b0: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-0003f1c0: 2e61 7272 6179 2e70 6572 6365 6e74 696c  .array.percentil
-0003f1d0: 6520 696d 706f 7274 206d 6572 6765 5f70  e import merge_p
-0003f1e0: 6572 6365 6e74 696c 6573 0a0a 2020 2020  ercentiles..    
-0003f1f0: 2020 2020 2320 4164 6420 3020 616e 6420      # Add 0 and 
-0003f200: 3130 3020 6475 7269 6e67 2063 616c 6375  100 during calcu
-0003f210: 6c61 7469 6f6e 2066 6f72 206d 6f72 6520  lation for more 
-0003f220: 726f 6275 7374 2062 6568 6176 696f 7220  robust behavior 
-0003f230: 2868 6f70 6566 756c 6c79 290a 2020 2020  (hopefully).    
-0003f240: 2020 2020 6361 6c63 5f71 7320 3d20 6e70      calc_qs = np
-0003f250: 2e70 6164 2871 732c 2031 2c20 6d6f 6465  .pad(qs, 1, mode
-0003f260: 3d22 636f 6e73 7461 6e74 2229 0a20 2020  ="constant").   
-0003f270: 2020 2020 2063 616c 635f 7173 5b2d 315d       calc_qs[-1]
-0003f280: 203d 2031 3030 0a20 2020 2020 2020 206e   = 100.        n
-0003f290: 616d 6520 3d20 2271 7561 6e74 696c 6573  ame = "quantiles
-0003f2a0: 2d31 2d22 202b 2074 6f6b 656e 0a20 2020  -1-" + token.   
-0003f2b0: 2020 2020 2076 616c 5f64 736b 203d 207b       val_dsk = {
-0003f2c0: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
-0003f2d0: 6d65 2c20 6929 3a20 285f 7065 7263 656e  me, i): (_percen
-0003f2e0: 7469 6c65 2c20 6b65 792c 2063 616c 635f  tile, key, calc_
-0003f2f0: 7173 290a 2020 2020 2020 2020 2020 2020  qs).            
-0003f300: 666f 7220 692c 206b 6579 2069 6e20 656e  for i, key in en
-0003f310: 756d 6572 6174 6528 6466 2e5f 5f64 6173  umerate(df.__das
-0003f320: 6b5f 6b65 7973 5f5f 2829 290a 2020 2020  k_keys__()).    
-0003f330: 2020 2020 7d0a 0a20 2020 2020 2020 206e      }..        n
-0003f340: 616d 6532 203d 2022 7175 616e 7469 6c65  ame2 = "quantile
-0003f350: 732d 322d 2220 2b20 746f 6b65 6e0a 2020  s-2-" + token.  
-0003f360: 2020 2020 2020 6d65 7267 655f 6473 6b20        merge_dsk 
-0003f370: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-0003f380: 286e 616d 6532 2c20 3029 3a20 6669 6e61  (name2, 0): fina
-0003f390: 6c69 7a65 5f74 736b 280a 2020 2020 2020  lize_tsk(.      
-0003f3a0: 2020 2020 2020 2020 2020 280a 2020 2020            (.    
-0003f3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f3c0: 6d65 7267 655f 7065 7263 656e 7469 6c65  merge_percentile
-0003f3d0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0003f3e0: 2020 2020 2020 2071 732c 0a20 2020 2020         qs,.     
-0003f3f0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-0003f400: 6361 6c63 5f71 735d 202a 2064 662e 6e70  calc_qs] * df.np
-0003f410: 6172 7469 7469 6f6e 732c 0a20 2020 2020  artitions,.     
-0003f420: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0003f430: 6f72 7465 6428 7661 6c5f 6473 6b29 2c0a  orted(val_dsk),.
-0003f440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f450: 2020 2020 226c 6f77 6572 222c 0a20 2020      "lower",.   
-0003f460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f470: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-0003f480: 2020 2020 2020 2020 2020 2046 616c 7365             False
-0003f490: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003f4a0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0003f4b0: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
-0003f4c0: 6473 6b20 3d20 6d65 7267 6528 7661 6c5f  dsk = merge(val_
-0003f4d0: 6473 6b2c 206d 6572 6765 5f64 736b 290a  dsk, merge_dsk).
-0003f4e0: 2020 2020 6772 6170 6820 3d20 4869 6768      graph = High
-0003f4f0: 4c65 7665 6c47 7261 7068 2e66 726f 6d5f  LevelGraph.from_
-0003f500: 636f 6c6c 6563 7469 6f6e 7328 6e61 6d65  collections(name
-0003f510: 322c 2064 736b 2c20 6465 7065 6e64 656e  2, dsk, dependen
-0003f520: 6369 6573 3d5b 6466 5d29 0a20 2020 2072  cies=[df]).    r
-0003f530: 6574 7572 6e20 7265 7475 726e 5f74 7970  eturn return_typ
-0003f540: 6528 6772 6170 682c 206e 616d 6532 2c20  e(graph, name2, 
-0003f550: 6d65 7461 2c20 6e65 775f 6469 7669 7369  meta, new_divisi
-0003f560: 6f6e 7329 0a0a 0a64 6566 205f 636f 765f  ons)...def _cov_
-0003f570: 636f 7272 280a 2020 2020 6466 2c0a 2020  corr(.    df,.  
-0003f580: 2020 6d69 6e5f 7065 7269 6f64 733d 4e6f    min_periods=No
-0003f590: 6e65 2c0a 2020 2020 636f 7272 3d46 616c  ne,.    corr=Fal
-0003f5a0: 7365 2c0a 2020 2020 7363 616c 6172 3d46  se,.    scalar=F
-0003f5b0: 616c 7365 2c0a 2020 2020 6e75 6d65 7269  alse,.    numeri
-0003f5c0: 635f 6f6e 6c79 3d6e 6f5f 6465 6661 756c  c_only=no_defaul
-0003f5d0: 742c 0a20 2020 2073 706c 6974 5f65 7665  t,.    split_eve
-0003f5e0: 7279 3d46 616c 7365 2c0a 293a 0a20 2020  ry=False,.):.   
-0003f5f0: 2022 2222 4461 7461 4672 616d 6520 636f   """DataFrame co
-0003f600: 7661 7269 616e 6365 2061 6e64 2070 6561  variance and pea
-0003f610: 7273 6f6e 2063 6f72 7265 6c61 7469 6f6e  rson correlation
-0003f620: 2e0a 0a20 2020 2043 6f6d 7075 7465 7320  ...    Computes 
-0003f630: 7061 6972 7769 7365 2063 6f76 6172 6961  pairwise covaria
-0003f640: 6e63 6520 6f72 2063 6f72 7265 6c61 7469  nce or correlati
-0003f650: 6f6e 206f 6620 636f 6c75 6d6e 732c 2065  on of columns, e
-0003f660: 7863 6c75 6469 6e67 204e 412f 6e75 6c6c  xcluding NA/null
-0003f670: 0a20 2020 2076 616c 7565 732e 0a0a 2020  .    values...  
-0003f680: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0003f690: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-0003f6a0: 6466 203a 2044 6174 6146 7261 6d65 0a20  df : DataFrame. 
-0003f6b0: 2020 206d 696e 5f70 6572 696f 6473 203a     min_periods :
-0003f6c0: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
-0003f6d0: 2020 2020 2020 204d 696e 696d 756d 206e         Minimum n
-0003f6e0: 756d 6265 7220 6f66 206f 6273 6572 7661  umber of observa
-0003f6f0: 7469 6f6e 7320 7265 7175 6972 6564 2070  tions required p
-0003f700: 6572 2070 6169 7220 6f66 2063 6f6c 756d  er pair of colum
-0003f710: 6e73 0a20 2020 2020 2020 2074 6f20 6861  ns.        to ha
-0003f720: 7665 2061 2076 616c 6964 2072 6573 756c  ve a valid resul
-0003f730: 742e 0a20 2020 2063 6f72 7220 3a20 626f  t..    corr : bo
-0003f740: 6f6c 2c20 6f70 7469 6f6e 616c 0a20 2020  ol, optional.   
-0003f750: 2020 2020 2049 6620 5472 7565 2c20 636f       If True, co
-0003f760: 6d70 7574 6520 7468 6520 5065 6172 736f  mpute the Pearso
-0003f770: 6e20 636f 7272 656c 6174 696f 6e2e 2049  n correlation. I
-0003f780: 6620 4661 6c73 6520 5b64 6566 6175 6c74  f False [default
-0003f790: 5d2c 2063 6f6d 7075 7465 0a20 2020 2020  ], compute.     
-0003f7a0: 2020 2074 6865 2063 6f76 6172 6961 6e63     the covarianc
-0003f7b0: 652e 0a20 2020 2073 6361 6c61 7220 3a20  e..    scalar : 
-0003f7c0: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0a20  bool, optional. 
-0003f7d0: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
-0003f7e0: 636f 6d70 7574 6520 636f 7661 7269 616e  compute covarian
-0003f7f0: 6365 2062 6574 7765 656e 2074 776f 2076  ce between two v
-0003f800: 6172 6961 626c 6573 2061 7320 6120 7363  ariables as a sc
-0003f810: 616c 6172 2e20 4f6e 6c79 0a20 2020 2020  alar. Only.     
-0003f820: 2020 2076 616c 6964 2069 6620 6064 6660     valid if `df`
-0003f830: 2068 6173 2032 2063 6f6c 756d 6e73 2e20   has 2 columns. 
-0003f840: 2049 6620 4661 6c73 6520 5b64 6566 6175   If False [defau
-0003f850: 6c74 5d2c 2063 6f6d 7075 7465 2074 6865  lt], compute the
-0003f860: 2065 6e74 6972 650a 2020 2020 2020 2020   entire.        
-0003f870: 636f 7661 7269 616e 6365 2f63 6f72 7265  covariance/corre
-0003f880: 6c61 7469 6f6e 206d 6174 7269 782e 0a20  lation matrix.. 
-0003f890: 2020 2073 706c 6974 5f65 7665 7279 203a     split_every :
-0003f8a0: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
-0003f8b0: 2020 2020 2020 2047 726f 7570 2070 6172         Group par
-0003f8c0: 7469 7469 6f6e 7320 696e 746f 2067 726f  titions into gro
-0003f8d0: 7570 7320 6f66 2074 6869 7320 7369 7a65  ups of this size
-0003f8e0: 2077 6869 6c65 2070 6572 666f 726d 696e   while performin
-0003f8f0: 6720 610a 2020 2020 2020 2020 7472 6565  g a.        tree
-0003f900: 2d72 6564 7563 7469 6f6e 2e20 4966 2073  -reduction. If s
-0003f910: 6574 2074 6f20 4661 6c73 652c 206e 6f20  et to False, no 
-0003f920: 7472 6565 2d72 6564 7563 7469 6f6e 2077  tree-reduction w
-0003f930: 696c 6c20 6265 2075 7365 642e 0a20 2020  ill be used..   
-0003f940: 2020 2020 2044 6566 6175 6c74 2069 7320       Default is 
-0003f950: 4661 6c73 652e 0a20 2020 2022 2222 0a20  False..    """. 
-0003f960: 2020 2069 6620 6d69 6e5f 7065 7269 6f64     if min_period
-0003f970: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
-0003f980: 2020 206d 696e 5f70 6572 696f 6473 203d     min_periods =
-0003f990: 2032 0a20 2020 2065 6c69 6620 6d69 6e5f   2.    elif min_
-0003f9a0: 7065 7269 6f64 7320 3c20 323a 0a20 2020  periods < 2:.   
-0003f9b0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0003f9c0: 4572 726f 7228 226d 696e 5f70 6572 696f  Error("min_perio
-0003f9d0: 6473 206d 7573 7420 6265 203e 3d20 3222  ds must be >= 2"
-0003f9e0: 290a 0a20 2020 2069 6620 7370 6c69 745f  )..    if split_
-0003f9f0: 6576 6572 7920 6973 2046 616c 7365 3a0a  every is False:.
-0003fa00: 2020 2020 2020 2020 7370 6c69 745f 6576          split_ev
-0003fa10: 6572 7920 3d20 6466 2e6e 7061 7274 6974  ery = df.npartit
-0003fa20: 696f 6e73 0a20 2020 2065 6c69 6620 7370  ions.    elif sp
-0003fa30: 6c69 745f 6576 6572 7920 3c20 3220 6f72  lit_every < 2 or
-0003fa40: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-0003fa50: 7370 6c69 745f 6576 6572 792c 2049 6e74  split_every, Int
-0003fa60: 6567 7261 6c29 3a0a 2020 2020 2020 2020  egral):.        
-0003fa70: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0003fa80: 2822 7370 6c69 745f 6576 6572 7920 6d75  ("split_every mu
-0003fa90: 7374 2062 6520 616e 2069 6e74 6567 6572  st be an integer
-0003faa0: 203e 3d20 3222 290a 0a20 2020 2023 2048   >= 2")..    # H
-0003fab0: 616e 646c 6520 7365 6c65 6374 696e 6720  andle selecting 
-0003fac0: 6e75 6d65 7269 6320 6461 7461 2061 6e64  numeric data and
-0003fad0: 2061 7373 6f63 6961 7465 6420 6465 7072   associated depr
-0003fae0: 6563 6174 696f 6e20 7761 726e 696e 670a  ecation warning.
-0003faf0: 2020 2020 6d61 7962 655f 7761 726e 203d      maybe_warn =
-0003fb00: 2046 616c 7365 0a20 2020 2069 6620 6e75   False.    if nu
-0003fb10: 6d65 7269 635f 6f6e 6c79 2069 7320 6e6f  meric_only is no
-0003fb20: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
-0003fb30: 2020 6966 2050 414e 4441 535f 4754 5f32    if PANDAS_GT_2
-0003fb40: 3030 3a0a 2020 2020 2020 2020 2020 2020  00:.            
-0003fb50: 6e75 6d65 7269 635f 6f6e 6c79 203d 2046  numeric_only = F
-0003fb60: 616c 7365 0a20 2020 2020 2020 2065 6c69  alse.        eli
-0003fb70: 6620 5041 4e44 4153 5f47 545f 3135 303a  f PANDAS_GT_150:
-0003fb80: 0a20 2020 2020 2020 2020 2020 206d 6179  .            may
-0003fb90: 6265 5f77 6172 6e20 3d20 5472 7565 0a20  be_warn = True. 
-0003fba0: 2020 2020 2020 2020 2020 206e 756d 6572             numer
-0003fbb0: 6963 5f6f 6e6c 7920 3d20 5472 7565 0a20  ic_only = True. 
-0003fbc0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0003fbd0: 2020 2020 2020 2020 206e 756d 6572 6963           numeric
-0003fbe0: 5f6f 6e6c 7920 3d20 5472 7565 0a0a 2020  _only = True..  
-0003fbf0: 2020 616c 6c5f 6e75 6d65 7269 6320 3d20    all_numeric = 
-0003fc00: 6466 2e5f 6765 745f 6e75 6d65 7269 635f  df._get_numeric_
-0003fc10: 6461 7461 2829 2e5f 6e61 6d65 203d 3d20  data()._name == 
-0003fc20: 6466 2e5f 6e61 6d65 0a20 2020 2069 6620  df._name.    if 
-0003fc30: 6d61 7962 655f 7761 726e 2061 6e64 206e  maybe_warn and n
-0003fc40: 6f74 2061 6c6c 5f6e 756d 6572 6963 3a0a  ot all_numeric:.
-0003fc50: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-0003fc60: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
-0003fc70: 2020 2022 5468 6520 6465 6661 756c 7420     "The default 
-0003fc80: 7661 6c75 6520 6f66 206e 756d 6572 6963  value of numeric
-0003fc90: 5f6f 6e6c 7920 7769 6c6c 2062 6520 6046  _only will be `F
-0003fca0: 616c 7365 6020 220a 2020 2020 2020 2020  alse` ".        
-0003fcb0: 2020 2020 2269 6e20 6120 6675 7475 7265      "in a future
-0003fcc0: 2076 6572 7369 6f6e 206f 6620 4461 736b   version of Dask
-0003fcd0: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
-0003fce0: 4675 7475 7265 5761 726e 696e 672c 0a20  FutureWarning,. 
-0003fcf0: 2020 2020 2020 2029 0a0a 2020 2020 6966         )..    if
-0003fd00: 206e 756d 6572 6963 5f6f 6e6c 7920 616e   numeric_only an
-0003fd10: 6420 6e6f 7420 616c 6c5f 6e75 6d65 7269  d not all_numeri
-0003fd20: 633a 0a20 2020 2020 2020 2064 6620 3d20  c:.        df = 
-0003fd30: 6466 2e5f 6765 745f 6e75 6d65 7269 635f  df._get_numeric_
-0003fd40: 6461 7461 2829 0a0a 2020 2020 6966 2073  data()..    if s
-0003fd50: 6361 6c61 7220 616e 6420 6c65 6e28 6466  calar and len(df
-0003fd60: 2e63 6f6c 756d 6e73 2920 213d 2032 3a0a  .columns) != 2:.
-0003fd70: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0003fd80: 6c75 6545 7272 6f72 2822 7363 616c 6172  lueError("scalar
-0003fd90: 206f 6e6c 7920 7661 6c69 6420 666f 7220   only valid for 
-0003fda0: 3220 636f 6c75 6d6e 2064 6174 6166 7261  2 column datafra
-0003fdb0: 6d65 2229 0a0a 2020 2020 746f 6b65 6e20  me")..    token 
-0003fdc0: 3d20 746f 6b65 6e69 7a65 2864 662c 206d  = tokenize(df, m
-0003fdd0: 696e 5f70 6572 696f 6473 2c20 7363 616c  in_periods, scal
-0003fde0: 6172 2c20 7370 6c69 745f 6576 6572 7929  ar, split_every)
-0003fdf0: 0a0a 2020 2020 6675 6e63 6e61 6d65 203d  ..    funcname =
-0003fe00: 2022 636f 7272 2220 6966 2063 6f72 7220   "corr" if corr 
-0003fe10: 656c 7365 2022 636f 7622 0a20 2020 2061  else "cov".    a
-0003fe20: 203d 2066 227b 6675 6e63 6e61 6d65 7d2d   = f"{funcname}-
-0003fe30: 6368 756e 6b2d 7b64 662e 5f6e 616d 657d  chunk-{df._name}
-0003fe40: 220a 2020 2020 6473 6b20 3d20 7b0a 2020  ".    dsk = {.  
-0003fe50: 2020 2020 2020 2861 2c20 6929 3a20 285f        (a, i): (_
-0003fe60: 636f 765f 636f 7272 5f63 6875 6e6b 2c20  cov_corr_chunk, 
-0003fe70: 662c 2063 6f72 7229 2066 6f72 2028 692c  f, corr) for (i,
-0003fe80: 2066 2920 696e 2065 6e75 6d65 7261 7465   f) in enumerate
-0003fe90: 2864 662e 5f5f 6461 736b 5f6b 6579 735f  (df.__dask_keys_
-0003fea0: 5f28 2929 0a20 2020 207d 0a0a 2020 2020  _()).    }..    
-0003feb0: 7072 6566 6978 203d 2066 227b 6675 6e63  prefix = f"{func
-0003fec0: 6e61 6d65 7d2d 636f 6d62 696e 652d 7b64  name}-combine-{d
-0003fed0: 662e 5f6e 616d 657d 2d22 0a20 2020 206b  f._name}-".    k
-0003fee0: 203d 2064 662e 6e70 6172 7469 7469 6f6e   = df.npartition
-0003fef0: 730a 2020 2020 6220 3d20 610a 2020 2020  s.    b = a.    
-0003ff00: 6465 7074 6820 3d20 300a 2020 2020 7768  depth = 0.    wh
-0003ff10: 696c 6520 6b20 3e20 7370 6c69 745f 6576  ile k > split_ev
-0003ff20: 6572 793a 0a20 2020 2020 2020 2062 203d  ery:.        b =
-0003ff30: 2070 7265 6669 7820 2b20 7374 7228 6465   prefix + str(de
-0003ff40: 7074 6829 0a20 2020 2020 2020 2066 6f72  pth).        for
-0003ff50: 2070 6172 745f 692c 2069 6e64 7320 696e   part_i, inds in
-0003ff60: 2065 6e75 6d65 7261 7465 2870 6172 7469   enumerate(parti
-0003ff70: 7469 6f6e 5f61 6c6c 2873 706c 6974 5f65  tion_all(split_e
-0003ff80: 7665 7279 2c20 7261 6e67 6528 6b29 2929  very, range(k)))
-0003ff90: 3a0a 2020 2020 2020 2020 2020 2020 6473  :.            ds
-0003ffa0: 6b5b 2862 2c20 7061 7274 5f69 295d 203d  k[(b, part_i)] =
-0003ffb0: 2028 5f63 6f76 5f63 6f72 725f 636f 6d62   (_cov_corr_comb
-0003ffc0: 696e 652c 205b 2861 2c20 6929 2066 6f72  ine, [(a, i) for
-0003ffd0: 2069 2069 6e20 696e 6473 5d2c 2063 6f72   i in inds], cor
-0003ffe0: 7229 0a20 2020 2020 2020 206b 203d 2070  r).        k = p
-0003fff0: 6172 745f 6920 2b20 310a 2020 2020 2020  art_i + 1.      
-00040000: 2020 6120 3d20 620a 2020 2020 2020 2020    a = b.        
-00040010: 6465 7074 6820 2b3d 2031 0a0a 2020 2020  depth += 1..    
-00040020: 6e61 6d65 203d 2066 227b 6675 6e63 6e61  name = f"{funcna
-00040030: 6d65 7d2d 7b74 6f6b 656e 7d22 0a20 2020  me}-{token}".   
-00040040: 2064 736b 5b28 6e61 6d65 2c20 3029 5d20   dsk[(name, 0)] 
-00040050: 3d20 280a 2020 2020 2020 2020 5f63 6f76  = (.        _cov
-00040060: 5f63 6f72 725f 6167 672c 0a20 2020 2020  _corr_agg,.     
-00040070: 2020 205b 2861 2c20 6929 2066 6f72 2069     [(a, i) for i
-00040080: 2069 6e20 7261 6e67 6528 6b29 5d2c 0a20   in range(k)],. 
-00040090: 2020 2020 2020 2064 662e 636f 6c75 6d6e         df.column
-000400a0: 732c 0a20 2020 2020 2020 206d 696e 5f70  s,.        min_p
-000400b0: 6572 696f 6473 2c0a 2020 2020 2020 2020  eriods,.        
-000400c0: 636f 7272 2c0a 2020 2020 2020 2020 7363  corr,.        sc
-000400d0: 616c 6172 2c0a 2020 2020 2020 2020 6466  alar,.        df
-000400e0: 2e5f 6d65 7461 2c0a 2020 2020 290a 2020  ._meta,.    ).  
-000400f0: 2020 6772 6170 6820 3d20 4869 6768 4c65    graph = HighLe
-00040100: 7665 6c47 7261 7068 2e66 726f 6d5f 636f  velGraph.from_co
-00040110: 6c6c 6563 7469 6f6e 7328 6e61 6d65 2c20  llections(name, 
-00040120: 6473 6b2c 2064 6570 656e 6465 6e63 6965  dsk, dependencie
-00040130: 733d 5b64 665d 290a 2020 2020 6966 2073  s=[df]).    if s
-00040140: 6361 6c61 723a 0a20 2020 2020 2020 2072  calar:.        r
-00040150: 6574 7572 6e20 5363 616c 6172 2867 7261  eturn Scalar(gra
-00040160: 7068 2c20 6e61 6d65 2c20 2266 3822 290a  ph, name, "f8").
-00040170: 2020 2020 6d65 7461 203d 206d 616b 655f      meta = make_
-00040180: 6d65 7461 280a 2020 2020 2020 2020 5b28  meta(.        [(
-00040190: 632c 2022 6638 2229 2066 6f72 2063 2069  c, "f8") for c i
-000401a0: 6e20 6466 2e63 6f6c 756d 6e73 5d2c 0a20  n df.columns],. 
-000401b0: 2020 2020 2020 2069 6e64 6578 3d6d 6574         index=met
-000401c0: 615f 7365 7269 6573 5f63 6f6e 7374 7275  a_series_constru
-000401d0: 6374 6f72 2864 6629 2864 662e 636f 6c75  ctor(df)(df.colu
-000401e0: 6d6e 7329 2c0a 2020 2020 2020 2020 7061  mns),.        pa
-000401f0: 7265 6e74 5f6d 6574 613d 6466 2e5f 6d65  rent_meta=df._me
-00040200: 7461 2c0a 2020 2020 290a 2020 2020 7265  ta,.    ).    re
-00040210: 7475 726e 206e 6577 5f64 645f 6f62 6a65  turn new_dd_obje
-00040220: 6374 2867 7261 7068 2c20 6e61 6d65 2c20  ct(graph, name, 
-00040230: 6d65 7461 2c20 2864 662e 636f 6c75 6d6e  meta, (df.column
-00040240: 732e 6d69 6e28 292c 2064 662e 636f 6c75  s.min(), df.colu
-00040250: 6d6e 732e 6d61 7828 2929 290a 0a0a 6465  mns.max()))...de
-00040260: 6620 5f63 6f76 5f63 6f72 725f 6368 756e  f _cov_corr_chun
-00040270: 6b28 6466 2c20 636f 7272 3d46 616c 7365  k(df, corr=False
-00040280: 293a 0a20 2020 2022 2222 4368 756e 6b20  ):.    """Chunk 
-00040290: 7061 7274 206f 6620 6120 636f 7661 7269  part of a covari
-000402a0: 616e 6365 206f 7220 636f 7272 656c 6174  ance or correlat
-000402b0: 696f 6e20 636f 6d70 7574 6174 696f 6e22  ion computation"
-000402c0: 2222 0a20 2020 2073 6861 7065 203d 2028  "".    shape = (
-000402d0: 6466 2e73 6861 7065 5b31 5d2c 2064 662e  df.shape[1], df.
-000402e0: 7368 6170 655b 315d 290a 2020 2020 6466  shape[1]).    df
-000402f0: 203d 2064 662e 6173 7479 7065 2822 666c   = df.astype("fl
-00040300: 6f61 7436 3422 2c20 636f 7079 3d46 616c  oat64", copy=Fal
-00040310: 7365 290a 2020 2020 7375 6d73 203d 206e  se).    sums = n
-00040320: 702e 7a65 726f 735f 6c69 6b65 2864 662e  p.zeros_like(df.
-00040330: 7661 6c75 6573 2c20 7368 6170 653d 7368  values, shape=sh
-00040340: 6170 6529 0a20 2020 2063 6f75 6e74 7320  ape).    counts 
-00040350: 3d20 6e70 2e7a 6572 6f73 5f6c 696b 6528  = np.zeros_like(
-00040360: 6466 2e76 616c 7565 732c 2073 6861 7065  df.values, shape
-00040370: 3d73 6861 7065 290a 2020 2020 666f 7220  =shape).    for 
-00040380: 6964 7820 696e 2072 616e 6765 286c 656e  idx in range(len
-00040390: 2864 662e 636f 6c75 6d6e 7329 293a 0a20  (df.columns)):. 
-000403a0: 2020 2020 2020 206d 6173 6b20 3d20 6466         mask = df
-000403b0: 2e69 6c6f 635b 3a2c 2069 6478 5d2e 6e6f  .iloc[:, idx].no
-000403c0: 746e 756c 6c28 290a 2020 2020 2020 2020  tnull().        
-000403d0: 7375 6d73 5b69 6478 5d20 3d20 6466 5b6d  sums[idx] = df[m
-000403e0: 6173 6b5d 2e73 756d 2829 2e76 616c 7565  ask].sum().value
-000403f0: 730a 2020 2020 2020 2020 636f 756e 7473  s.        counts
-00040400: 5b69 6478 5d20 3d20 6466 5b6d 6173 6b5d  [idx] = df[mask]
-00040410: 2e63 6f75 6e74 2829 2e76 616c 7565 730a  .count().values.
-00040420: 2020 2020 2320 5370 6563 6961 6c20 6361      # Special ca
-00040430: 7365 2073 696e 676c 652d 726f 7720 4461  se single-row Da
-00040440: 7461 4672 616d 6520 636f 7620 746f 2061  taFrame cov to a
-00040450: 766f 6964 2077 6172 6e69 6e67 7320 6672  void warnings fr
-00040460: 6f6d 2070 616e 6461 732e 0a20 2020 2069  om pandas..    i
-00040470: 6620 6466 2e73 6861 7065 5b30 5d20 3d3d  f df.shape[0] ==
-00040480: 2031 3a0a 2020 2020 2020 2020 636f 7620   1:.        cov 
-00040490: 3d20 6e70 2e66 756c 6c5f 6c69 6b65 2873  = np.full_like(s
-000404a0: 756d 732c 206e 702e 6e61 6e29 2020 2320  ums, np.nan)  # 
-000404b0: 616c 7761 7973 2061 6e20 616c 6c20 6e61  always an all na
-000404c0: 6e20 7265 7375 6c74 0a20 2020 2065 6c73  n result.    els
-000404d0: 653a 0a20 2020 2020 2020 2063 6f76 203d  e:.        cov =
-000404e0: 2064 662e 636f 7628 292e 7661 6c75 6573   df.cov().values
-000404f0: 0a20 2020 2064 7479 7065 203d 205b 2822  .    dtype = [("
-00040500: 7375 6d22 2c20 7375 6d73 2e64 7479 7065  sum", sums.dtype
-00040510: 292c 2028 2263 6f75 6e74 222c 2063 6f75  ), ("count", cou
-00040520: 6e74 732e 6474 7970 6529 2c20 2822 636f  nts.dtype), ("co
-00040530: 7622 2c20 636f 762e 6474 7970 6529 5d0a  v", cov.dtype)].
-00040540: 2020 2020 6966 2063 6f72 723a 0a20 2020      if corr:.   
-00040550: 2020 2020 2077 6974 6820 7761 726e 696e       with warnin
-00040560: 6773 2e63 6174 6368 5f77 6172 6e69 6e67  gs.catch_warning
-00040570: 7328 7265 636f 7264 3d54 7275 6529 3a0a  s(record=True):.
-00040580: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-00040590: 696e 6773 2e73 696d 706c 6566 696c 7465  ings.simplefilte
-000405a0: 7228 2261 6c77 6179 7322 290a 2020 2020  r("always").    
-000405b0: 2020 2020 2020 2020 6d75 203d 2028 7375          mu = (su
-000405c0: 6d73 202f 2063 6f75 6e74 7329 2e54 0a20  ms / counts).T. 
-000405d0: 2020 2020 2020 206d 203d 206e 702e 7a65         m = np.ze
-000405e0: 726f 735f 6c69 6b65 2864 662e 7661 6c75  ros_like(df.valu
-000405f0: 6573 2c20 7368 6170 653d 7368 6170 6529  es, shape=shape)
-00040600: 0a20 2020 2020 2020 206d 6173 6b20 3d20  .        mask = 
-00040610: 6466 2e69 736e 756c 6c28 292e 7661 6c75  df.isnull().valu
-00040620: 6573 0a20 2020 2020 2020 2066 6f72 2069  es.        for i
-00040630: 6478 2069 6e20 7261 6e67 6528 6c65 6e28  dx in range(len(
-00040640: 6466 2e63 6f6c 756d 6e73 2929 3a0a 2020  df.columns)):.  
-00040650: 2020 2020 2020 2020 2020 2320 4176 6f69            # Avoi
-00040660: 6420 7573 696e 6720 7566 756e 632e 6f75  d using ufunc.ou
-00040670: 7465 7220 286e 6f74 2073 7570 706f 7274  ter (not support
-00040680: 6564 2062 7920 6375 7079 290a 2020 2020  ed by cupy).    
-00040690: 2020 2020 2020 2020 6d75 5f64 6973 6372          mu_discr
-000406a0: 6570 616e 6379 203d 2028 0a20 2020 2020  epancy = (.     
-000406b0: 2020 2020 2020 2020 2020 206e 702e 7375             np.su
-000406c0: 6274 7261 6374 2864 662e 696c 6f63 5b3a  btract(df.iloc[:
-000406d0: 2c20 6964 785d 2e76 616c 7565 735b 3a2c  , idx].values[:,
-000406e0: 204e 6f6e 655d 2c20 6d75 5b69 6478 5d5b   None], mu[idx][
-000406f0: 4e6f 6e65 2c20 3a5d 2920 2a2a 2032 0a20  None, :]) ** 2. 
-00040700: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00040710: 2020 2020 2020 2020 206d 755f 6469 7363           mu_disc
-00040720: 7265 7061 6e63 795b 6d61 736b 5d20 3d20  repancy[mask] = 
-00040730: 6e70 2e6e 616e 0a20 2020 2020 2020 2020  np.nan.         
-00040740: 2020 206d 5b69 6478 5d20 3d20 6e70 2e6e     m[idx] = np.n
-00040750: 616e 7375 6d28 6d75 5f64 6973 6372 6570  ansum(mu_discrep
-00040760: 616e 6379 2c20 6178 6973 3d30 290a 2020  ancy, axis=0).  
-00040770: 2020 2020 2020 6d20 3d20 6d2e 540a 2020        m = m.T.  
-00040780: 2020 2020 2020 6474 7970 652e 6170 7065        dtype.appe
-00040790: 6e64 2828 226d 222c 206d 2e64 7479 7065  nd(("m", m.dtype
-000407a0: 2929 0a0a 2020 2020 6f75 7420 3d20 7b22  ))..    out = {"
-000407b0: 7375 6d22 3a20 7375 6d73 2c20 2263 6f75  sum": sums, "cou
-000407c0: 6e74 223a 2063 6f75 6e74 732c 2022 636f  nt": counts, "co
-000407d0: 7622 3a20 636f 7620 2a20 2863 6f75 6e74  v": cov * (count
-000407e0: 7320 2d20 3129 7d0a 2020 2020 6966 2063  s - 1)}.    if c
-000407f0: 6f72 723a 0a20 2020 2020 2020 206f 7574  orr:.        out
-00040800: 5b22 6d22 5d20 3d20 6d0a 2020 2020 7265  ["m"] = m.    re
-00040810: 7475 726e 206f 7574 0a0a 0a64 6566 205f  turn out...def _
-00040820: 636f 765f 636f 7272 5f63 6f6d 6269 6e65  cov_corr_combine
-00040830: 2864 6174 615f 696e 2c20 636f 7272 3d46  (data_in, corr=F
-00040840: 616c 7365 293a 0a20 2020 2064 6174 6120  alse):.    data 
-00040850: 3d20 7b22 7375 6d22 3a20 4e6f 6e65 2c20  = {"sum": None, 
-00040860: 2263 6f75 6e74 223a 204e 6f6e 652c 2022  "count": None, "
-00040870: 636f 7622 3a20 4e6f 6e65 7d0a 2020 2020  cov": None}.    
-00040880: 6966 2063 6f72 723a 0a20 2020 2020 2020  if corr:.       
-00040890: 2064 6174 615b 226d 225d 203d 204e 6f6e   data["m"] = Non
-000408a0: 650a 0a20 2020 2066 6f72 206b 2069 6e20  e..    for k in 
-000408b0: 6461 7461 2e6b 6579 7328 293a 0a20 2020  data.keys():.   
-000408c0: 2020 2020 2064 6174 615b 6b5d 203d 205b       data[k] = [
-000408d0: 645b 6b5d 2066 6f72 2064 2069 6e20 6461  d[k] for d in da
-000408e0: 7461 5f69 6e5d 0a20 2020 2020 2020 2064  ta_in].        d
-000408f0: 6174 615b 6b5d 203d 206e 702e 636f 6e63  ata[k] = np.conc
-00040900: 6174 656e 6174 6528 6461 7461 5b6b 5d29  atenate(data[k])
-00040910: 2e72 6573 6861 7065 2828 6c65 6e28 6461  .reshape((len(da
-00040920: 7461 5b6b 5d29 2c29 202b 2064 6174 615b  ta[k]),) + data[
-00040930: 6b5d 5b30 5d2e 7368 6170 6529 0a0a 2020  k][0].shape)..  
-00040940: 2020 7375 6d73 203d 206e 702e 6e61 6e5f    sums = np.nan_
-00040950: 746f 5f6e 756d 2864 6174 615b 2273 756d  to_num(data["sum
-00040960: 225d 290a 2020 2020 636f 756e 7473 203d  "]).    counts =
-00040970: 2064 6174 615b 2263 6f75 6e74 225d 0a0a   data["count"]..
-00040980: 2020 2020 6375 6d5f 7375 6d73 203d 206e      cum_sums = n
-00040990: 702e 6375 6d73 756d 2873 756d 732c 2030  p.cumsum(sums, 0
-000409a0: 290a 2020 2020 6375 6d5f 636f 756e 7473  ).    cum_counts
-000409b0: 203d 206e 702e 6375 6d73 756d 2863 6f75   = np.cumsum(cou
-000409c0: 6e74 732c 2030 290a 0a20 2020 2073 3120  nts, 0)..    s1 
-000409d0: 3d20 6375 6d5f 7375 6d73 5b3a 2d31 5d0a  = cum_sums[:-1].
-000409e0: 2020 2020 7332 203d 2073 756d 735b 313a      s2 = sums[1:
-000409f0: 5d0a 2020 2020 6e31 203d 2063 756d 5f63  ].    n1 = cum_c
-00040a00: 6f75 6e74 735b 3a2d 315d 0a20 2020 206e  ounts[:-1].    n
-00040a10: 3220 3d20 636f 756e 7473 5b31 3a5d 0a20  2 = counts[1:]. 
-00040a20: 2020 2077 6974 6820 6e70 2e65 7272 7374     with np.errst
-00040a30: 6174 6528 696e 7661 6c69 643d 2269 676e  ate(invalid="ign
-00040a40: 6f72 6522 293a 0a20 2020 2020 2020 2064  ore"):.        d
-00040a50: 203d 2028 7332 202f 206e 3229 202d 2028   = (s2 / n2) - (
-00040a60: 7331 202f 206e 3129 0a20 2020 2020 2020  s1 / n1).       
-00040a70: 2043 203d 206e 702e 6e61 6e73 756d 280a   C = np.nansum(.
-00040a80: 2020 2020 2020 2020 2020 2020 286e 3120              (n1 
-00040a90: 2a20 6e32 2920 2f20 286e 3120 2b20 6e32  * n2) / (n1 + n2
-00040aa0: 2920 2a20 2864 202a 2064 2e74 7261 6e73  ) * (d * d.trans
-00040ab0: 706f 7365 2828 302c 2032 2c20 3129 2929  pose((0, 2, 1)))
-00040ac0: 2c20 300a 2020 2020 2020 2020 2920 2b20  , 0.        ) + 
-00040ad0: 6e70 2e6e 616e 7375 6d28 6461 7461 5b22  np.nansum(data["
-00040ae0: 636f 7622 5d2c 2030 290a 0a20 2020 206f  cov"], 0)..    o
-00040af0: 7574 203d 207b 2273 756d 223a 2063 756d  ut = {"sum": cum
-00040b00: 5f73 756d 735b 2d31 5d2c 2022 636f 756e  _sums[-1], "coun
-00040b10: 7422 3a20 6375 6d5f 636f 756e 7473 5b2d  t": cum_counts[-
-00040b20: 315d 2c20 2263 6f76 223a 2043 7d0a 0a20  1], "cov": C}.. 
-00040b30: 2020 2069 6620 636f 7272 3a0a 2020 2020     if corr:.    
-00040b40: 2020 2020 6e6f 6273 203d 206e 702e 7768      nobs = np.wh
-00040b50: 6572 6528 6375 6d5f 636f 756e 7473 5b2d  ere(cum_counts[-
-00040b60: 315d 2c20 6375 6d5f 636f 756e 7473 5b2d  1], cum_counts[-
-00040b70: 315d 2c20 6e70 2e6e 616e 290a 2020 2020  1], np.nan).    
-00040b80: 2020 2020 6d75 203d 2063 756d 5f73 756d      mu = cum_sum
-00040b90: 735b 2d31 5d20 2f20 6e6f 6273 0a20 2020  s[-1] / nobs.   
-00040ba0: 2020 2020 2063 6f75 6e74 735f 6e61 203d       counts_na =
-00040bb0: 206e 702e 7768 6572 6528 636f 756e 7473   np.where(counts
-00040bc0: 2c20 636f 756e 7473 2c20 6e70 2e6e 616e  , counts, np.nan
-00040bd0: 290a 2020 2020 2020 2020 6d20 3d20 6e70  ).        m = np
-00040be0: 2e6e 616e 7375 6d28 6461 7461 5b22 6d22  .nansum(data["m"
-00040bf0: 5d20 2b20 636f 756e 7473 202a 2028 7375  ] + counts * (su
-00040c00: 6d73 202f 2063 6f75 6e74 735f 6e61 202d  ms / counts_na -
-00040c10: 206d 7529 202a 2a20 322c 2061 7869 733d   mu) ** 2, axis=
-00040c20: 3029 0a20 2020 2020 2020 206f 7574 5b22  0).        out["
-00040c30: 6d22 5d20 3d20 6d0a 2020 2020 7265 7475  m"] = m.    retu
-00040c40: 726e 206f 7574 0a0a 0a64 6566 205f 636f  rn out...def _co
-00040c50: 765f 636f 7272 5f61 6767 2864 6174 612c  v_corr_agg(data,
-00040c60: 2063 6f6c 732c 206d 696e 5f70 6572 696f   cols, min_perio
-00040c70: 6473 3d32 2c20 636f 7272 3d46 616c 7365  ds=2, corr=False
-00040c80: 2c20 7363 616c 6172 3d46 616c 7365 2c20  , scalar=False, 
-00040c90: 6c69 6b65 5f64 663d 4e6f 6e65 293a 0a20  like_df=None):. 
-00040ca0: 2020 206f 7574 203d 205f 636f 765f 636f     out = _cov_co
-00040cb0: 7272 5f63 6f6d 6269 6e65 2864 6174 612c  rr_combine(data,
-00040cc0: 2063 6f72 7229 0a20 2020 2063 6f75 6e74   corr).    count
-00040cd0: 7320 3d20 6f75 745b 2263 6f75 6e74 225d  s = out["count"]
-00040ce0: 0a20 2020 2043 203d 206f 7574 5b22 636f  .    C = out["co
-00040cf0: 7622 5d0a 2020 2020 435b 636f 756e 7473  v"].    C[counts
-00040d00: 203c 206d 696e 5f70 6572 696f 6473 5d20   < min_periods] 
-00040d10: 3d20 6e70 2e6e 616e 0a20 2020 2069 6620  = np.nan.    if 
-00040d20: 636f 7272 3a0a 2020 2020 2020 2020 6d32  corr:.        m2
-00040d30: 203d 206f 7574 5b22 6d22 5d0a 2020 2020   = out["m"].    
-00040d40: 2020 2020 6465 6e20 3d20 6e70 2e73 7172      den = np.sqr
-00040d50: 7428 6d32 202a 206d 322e 5429 0a20 2020  t(m2 * m2.T).   
-00040d60: 2065 6c73 653a 0a20 2020 2020 2020 2064   else:.        d
-00040d70: 656e 203d 206e 702e 7768 6572 6528 636f  en = np.where(co
-00040d80: 756e 7473 2c20 636f 756e 7473 2c20 6e70  unts, counts, np
-00040d90: 2e6e 616e 2920 2d20 310a 2020 2020 7769  .nan) - 1.    wi
-00040da0: 7468 206e 702e 6572 7273 7461 7465 2869  th np.errstate(i
-00040db0: 6e76 616c 6964 3d22 6967 6e6f 7265 222c  nvalid="ignore",
-00040dc0: 2064 6976 6964 653d 2269 676e 6f72 6522   divide="ignore"
-00040dd0: 293a 0a20 2020 2020 2020 206d 6174 203d  ):.        mat =
-00040de0: 2043 202f 2064 656e 0a20 2020 2069 6620   C / den.    if 
-00040df0: 7363 616c 6172 3a0a 2020 2020 2020 2020  scalar:.        
-00040e00: 7265 7475 726e 2066 6c6f 6174 286d 6174  return float(mat
-00040e10: 5b30 2c20 315d 290a 2020 2020 7265 7475  [0, 1]).    retu
-00040e20: 726e 2028 7064 2e44 6174 6146 7261 6d65  rn (pd.DataFrame
-00040e30: 2069 6620 6c69 6b65 5f64 6620 6973 204e   if like_df is N
-00040e40: 6f6e 6520 656c 7365 206d 6574 615f 6672  one else meta_fr
-00040e50: 616d 655f 636f 6e73 7472 7563 746f 7228  ame_constructor(
-00040e60: 6c69 6b65 5f64 6629 2928 0a20 2020 2020  like_df))(.     
-00040e70: 2020 206d 6174 2c20 636f 6c75 6d6e 733d     mat, columns=
-00040e80: 636f 6c73 2c20 696e 6465 783d 636f 6c73  cols, index=cols
-00040e90: 0a20 2020 2029 0a0a 0a64 6566 2070 645f  .    )...def pd_
-00040ea0: 7370 6c69 7428 6466 2c20 702c 2072 616e  split(df, p, ran
-00040eb0: 646f 6d5f 7374 6174 653d 4e6f 6e65 2c20  dom_state=None, 
-00040ec0: 7368 7566 666c 653d 4661 6c73 6529 3a0a  shuffle=False):.
-00040ed0: 2020 2020 2222 2253 706c 6974 2044 6174      """Split Dat
-00040ee0: 6146 7261 6d65 2069 6e74 6f20 6d75 6c74  aFrame into mult
-00040ef0: 6970 6c65 2070 6965 6365 7320 7073 6575  iple pieces pseu
-00040f00: 646f 7261 6e64 6f6d 6c79 0a0a 2020 2020  dorandomly..    
-00040f10: 3e3e 3e20 6466 203d 2070 642e 4461 7461  >>> df = pd.Data
-00040f20: 4672 616d 6528 7b27 6127 3a20 5b31 2c20  Frame({'a': [1, 
-00040f30: 322c 2033 2c20 342c 2035 2c20 365d 2c0a  2, 3, 4, 5, 6],.
-00040f40: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-00040f50: 2020 2020 2020 2020 2020 2027 6227 3a20             'b': 
-00040f60: 5b32 2c20 332c 2034 2c20 352c 2036 2c20  [2, 3, 4, 5, 6, 
-00040f70: 375d 7d29 0a0a 2020 2020 3e3e 3e20 612c  7]})..    >>> a,
-00040f80: 2062 203d 2070 645f 7370 6c69 7428 0a20   b = pd_split(. 
-00040f90: 2020 202e 2e2e 2020 2020 2064 662c 205b     ...     df, [
-00040fa0: 302e 352c 2030 2e35 5d2c 2072 616e 646f  0.5, 0.5], rando
-00040fb0: 6d5f 7374 6174 653d 3132 332c 2073 6875  m_state=123, shu
-00040fc0: 6666 6c65 3d54 7275 650a 2020 2020 2e2e  ffle=True.    ..
-00040fd0: 2e20 2920 2023 2072 6f75 6768 6c79 2035  . )  # roughly 5
-00040fe0: 302f 3530 2073 706c 6974 0a20 2020 203e  0/50 split.    >
-00040ff0: 3e3e 2061 0a20 2020 2020 2020 6120 2062  >> a.       a  b
-00041000: 0a20 2020 2033 2020 3420 2035 0a20 2020  .    3  4  5.   
-00041010: 2030 2020 3120 2032 0a20 2020 2035 2020   0  1  2.    5  
-00041020: 3620 2037 0a20 2020 203e 3e3e 2062 0a20  6  7.    >>> b. 
-00041030: 2020 2020 2020 6120 2062 0a20 2020 2031        a  b.    1
-00041040: 2020 3220 2033 0a20 2020 2034 2020 3520    2  3.    4  5 
-00041050: 2036 0a20 2020 2032 2020 3320 2034 0a20   6.    2  3  4. 
-00041060: 2020 2022 2222 0a20 2020 2070 203d 206c     """.    p = l
-00041070: 6973 7428 7029 0a20 2020 2069 6620 7368  ist(p).    if sh
-00041080: 7566 666c 653a 0a20 2020 2020 2020 2069  uffle:.        i
-00041090: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-000410a0: 2872 616e 646f 6d5f 7374 6174 652c 206e  (random_state, n
-000410b0: 702e 7261 6e64 6f6d 2e52 616e 646f 6d53  p.random.RandomS
-000410c0: 7461 7465 293a 0a20 2020 2020 2020 2020  tate):.         
-000410d0: 2020 2072 616e 646f 6d5f 7374 6174 6520     random_state 
-000410e0: 3d20 6e70 2e72 616e 646f 6d2e 5261 6e64  = np.random.Rand
-000410f0: 6f6d 5374 6174 6528 7261 6e64 6f6d 5f73  omState(random_s
-00041100: 7461 7465 290a 2020 2020 2020 2020 6466  tate).        df
-00041110: 203d 2064 662e 7361 6d70 6c65 2866 7261   = df.sample(fra
-00041120: 633d 312e 302c 2072 616e 646f 6d5f 7374  c=1.0, random_st
-00041130: 6174 653d 7261 6e64 6f6d 5f73 7461 7465  ate=random_state
-00041140: 290a 2020 2020 696e 6465 7820 3d20 7073  ).    index = ps
-00041150: 6575 646f 7261 6e64 6f6d 286c 656e 2864  eudorandom(len(d
-00041160: 6629 2c20 702c 2072 616e 646f 6d5f 7374  f), p, random_st
-00041170: 6174 6529 0a20 2020 2072 6574 7572 6e20  ate).    return 
-00041180: 5b64 662e 696c 6f63 5b69 6e64 6578 203d  [df.iloc[index =
-00041190: 3d20 695d 2066 6f72 2069 2069 6e20 7261  = i] for i in ra
-000411a0: 6e67 6528 6c65 6e28 7029 295d 0a0a 0a64  nge(len(p))]...d
-000411b0: 6566 205f 7461 6b65 5f6c 6173 7428 612c  ef _take_last(a,
-000411c0: 2073 6b69 706e 613d 5472 7565 293a 0a20   skipna=True):. 
-000411d0: 2020 2022 2222 0a20 2020 2074 616b 6520     """.    take 
-000411e0: 6c61 7374 2072 6f77 2028 5365 7269 6573  last row (Series
-000411f0: 2920 6f66 2044 6174 6146 7261 6d65 202f  ) of DataFrame /
-00041200: 206c 6173 7420 7661 6c75 6520 6f66 2053   last value of S
-00041210: 6572 6965 730a 2020 2020 636f 6e73 6964  eries.    consid
-00041220: 6572 696e 6720 4e61 4e2e 0a0a 2020 2020  ering NaN...    
-00041230: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-00041240: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6120  ---------.    a 
-00041250: 3a20 7064 2e44 6174 6146 7261 6d65 206f  : pd.DataFrame o
-00041260: 7220 7064 2e53 6572 6965 730a 2020 2020  r pd.Series.    
-00041270: 736b 6970 6e61 203a 2062 6f6f 6c2c 2064  skipna : bool, d
-00041280: 6566 6175 6c74 2054 7275 650a 2020 2020  efault True.    
-00041290: 2020 2020 5768 6574 6865 7220 746f 2065      Whether to e
-000412a0: 7863 6c75 6465 204e 614e 0a0a 2020 2020  xclude NaN..    
-000412b0: 2222 220a 0a20 2020 2064 6566 205f 6c61  """..    def _la
-000412c0: 7374 5f76 616c 6964 2873 293a 0a20 2020  st_valid(s):.   
-000412d0: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-000412e0: 6e67 6528 312c 206d 696e 2831 302c 206c  nge(1, min(10, l
-000412f0: 656e 2873 2920 2b20 3129 293a 0a20 2020  en(s) + 1)):.   
-00041300: 2020 2020 2020 2020 2076 616c 203d 2073           val = s
-00041310: 2e69 6c6f 635b 2d69 5d0a 2020 2020 2020  .iloc[-i].      
-00041320: 2020 2020 2020 6966 206e 6f74 2070 642e        if not pd.
-00041330: 6973 6e75 6c6c 2876 616c 293a 0a20 2020  isnull(val):.   
-00041340: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00041350: 7572 6e20 7661 6c0a 2020 2020 2020 2020  urn val.        
-00041360: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00041370: 2020 6e6f 6e6e 756c 6c20 3d20 735b 732e    nonnull = s[s.
-00041380: 6e6f 746e 6128 295d 0a20 2020 2020 2020  notna()].       
-00041390: 2020 2020 2069 6620 6e6f 7420 6e6f 6e6e       if not nonn
-000413a0: 756c 6c2e 656d 7074 793a 0a20 2020 2020  ull.empty:.     
-000413b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000413c0: 6e20 6e6f 6e6e 756c 6c2e 696c 6f63 5b2d  n nonnull.iloc[-
-000413d0: 315d 0a20 2020 2020 2020 2072 6574 7572  1].        retur
-000413e0: 6e20 4e6f 6e65 0a0a 2020 2020 6966 2073  n None..    if s
-000413f0: 6b69 706e 6120 6973 2046 616c 7365 3a0a  kipna is False:.
-00041400: 2020 2020 2020 2020 7265 7475 726e 2061          return a
-00041410: 2e69 6c6f 635b 2d31 5d0a 2020 2020 656c  .iloc[-1].    el
-00041420: 7365 3a0a 2020 2020 2020 2020 2320 7461  se:.        # ta
-00041430: 6b65 206c 6173 7420 7661 6c69 6420 7661  ke last valid va
-00041440: 6c75 6520 6578 636c 7564 696e 6720 4e61  lue excluding Na
-00041450: 4e2c 204e 614e 206c 6f63 6174 696f 6e20  N, NaN location 
-00041460: 6d61 7920 6265 2064 6966 6665 7265 6e74  may be different
-00041470: 0a20 2020 2020 2020 2023 2069 6e20 6561  .        # in ea
-00041480: 6368 2063 6f6c 756d 6e0a 2020 2020 2020  ch column.      
-00041490: 2020 6966 2069 735f 6461 7461 6672 616d    if is_datafram
-000414a0: 655f 6c69 6b65 2861 293a 0a20 2020 2020  e_like(a):.     
-000414b0: 2020 2020 2020 2023 2063 7265 6174 6520         # create 
-000414c0: 5365 7269 6573 2066 726f 6d20 6170 7072  Series from appr
-000414d0: 6f70 7269 6174 6520 6261 636b 656e 6420  opriate backend 
-000414e0: 6461 7461 6672 616d 6520 6c69 6272 6172  dataframe librar
-000414f0: 790a 2020 2020 2020 2020 2020 2020 7365  y.            se
-00041500: 7269 6573 5f74 7970 203d 2074 7970 6528  ries_typ = type(
-00041510: 612e 696c 6f63 5b30 3a31 2c20 305d 290a  a.iloc[0:1, 0]).
-00041520: 2020 2020 2020 2020 2020 2020 6966 2061              if a
-00041530: 2e65 6d70 7479 3a0a 2020 2020 2020 2020  .empty:.        
-00041540: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00041550: 6572 6965 735f 7479 7028 5b5d 2c20 6474  eries_typ([], dt
-00041560: 7970 653d 2266 6c6f 6174 2229 0a20 2020  ype="float").   
-00041570: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00041580: 7365 7269 6573 5f74 7970 280a 2020 2020  series_typ(.    
-00041590: 2020 2020 2020 2020 2020 2020 5b5f 6c61              [_la
-000415a0: 7374 5f76 616c 6964 2861 2e69 6c6f 635b  st_valid(a.iloc[
-000415b0: 3a2c 2069 5d29 2066 6f72 2069 2069 6e20  :, i]) for i in 
-000415c0: 7261 6e67 6528 6c65 6e28 612e 636f 6c75  range(len(a.colu
-000415d0: 6d6e 7329 295d 2c0a 2020 2020 2020 2020  mns))],.        
-000415e0: 2020 2020 2020 2020 696e 6465 783d 612e          index=a.
-000415f0: 636f 6c75 6d6e 732c 0a20 2020 2020 2020  columns,.       
-00041600: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
-00041610: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00041620: 2072 6574 7572 6e20 5f6c 6173 745f 7661   return _last_va
-00041630: 6c69 6428 6129 0a0a 0a64 6566 2063 6865  lid(a)...def che
-00041640: 636b 5f64 6976 6973 696f 6e73 2864 6976  ck_divisions(div
-00041650: 6973 696f 6e73 293a 0a20 2020 2069 6620  isions):.    if 
-00041660: 6e6f 7420 6973 696e 7374 616e 6365 2864  not isinstance(d
-00041670: 6976 6973 696f 6e73 2c20 286c 6973 742c  ivisions, (list,
-00041680: 2074 7570 6c65 2929 3a0a 2020 2020 2020   tuple)):.      
-00041690: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-000416a0: 6f72 2822 4e65 7720 6469 7669 7369 6f6e  or("New division
-000416b0: 206d 7573 7420 6265 206c 6973 7420 6f72   must be list or
-000416c0: 2074 7570 6c65 2229 0a20 2020 2064 6976   tuple").    div
-000416d0: 6973 696f 6e73 203d 206c 6973 7428 6469  isions = list(di
-000416e0: 7669 7369 6f6e 7329 0a20 2020 2069 6620  visions).    if 
-000416f0: 6c65 6e28 6469 7669 7369 6f6e 7329 203d  len(divisions) =
-00041700: 3d20 303a 0a20 2020 2020 2020 2072 6169  = 0:.        rai
-00041710: 7365 2056 616c 7565 4572 726f 7228 224e  se ValueError("N
-00041720: 6577 2064 6976 6973 696f 6e20 6d75 7374  ew division must
-00041730: 206e 6f74 2062 6520 656d 7074 7922 290a   not be empty").
-00041740: 2020 2020 6966 2064 6976 6973 696f 6e73      if divisions
-00041750: 2021 3d20 736f 7274 6564 2864 6976 6973   != sorted(divis
-00041760: 696f 6e73 293a 0a20 2020 2020 2020 2072  ions):.        r
-00041770: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00041780: 224e 6577 2064 6976 6973 696f 6e20 6d75  "New division mu
-00041790: 7374 2062 6520 736f 7274 6564 2229 0a20  st be sorted"). 
-000417a0: 2020 2069 6620 6c65 6e28 6469 7669 7369     if len(divisi
-000417b0: 6f6e 735b 3a2d 315d 2920 213d 206c 656e  ons[:-1]) != len
-000417c0: 286c 6973 7428 756e 6971 7565 2864 6976  (list(unique(div
-000417d0: 6973 696f 6e73 5b3a 2d31 5d29 2929 3a0a  isions[:-1]))):.
-000417e0: 2020 2020 2020 2020 6d73 6720 3d20 224e          msg = "N
-000417f0: 6577 2064 6976 6973 696f 6e20 6d75 7374  ew division must
-00041800: 2062 6520 756e 6971 7565 2c20 6578 6365   be unique, exce
-00041810: 7074 2066 6f72 2074 6865 206c 6173 7420  pt for the last 
-00041820: 656c 656d 656e 7422 0a20 2020 2020 2020  element".       
-00041830: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00041840: 7228 6d73 6729 0a0a 0a64 6566 2072 6570  r(msg)...def rep
-00041850: 6172 7469 7469 6f6e 5f64 6976 6973 696f  artition_divisio
-00041860: 6e73 2861 2c20 622c 206e 616d 652c 206f  ns(a, b, name, o
-00041870: 7574 312c 206f 7574 322c 2066 6f72 6365  ut1, out2, force
-00041880: 3d46 616c 7365 293a 0a20 2020 2022 2222  =False):.    """
-00041890: 6461 736b 2067 7261 7068 2074 6f20 7265  dask graph to re
-000418a0: 7061 7274 6974 696f 6e20 6461 7461 6672  partition datafr
-000418b0: 616d 6520 6279 206e 6577 2064 6976 6973  ame by new divis
-000418c0: 696f 6e73 0a0a 2020 2020 5061 7261 6d65  ions..    Parame
-000418d0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
-000418e0: 2d2d 2d0a 2020 2020 6120 3a20 7475 706c  ---.    a : tupl
-000418f0: 650a 2020 2020 2020 2020 6f6c 6420 6469  e.        old di
-00041900: 7669 7369 6f6e 730a 2020 2020 6220 3a20  visions.    b : 
-00041910: 7475 706c 652c 206c 6973 746d 7970 790a  tuple, listmypy.
-00041920: 2020 2020 6f75 7432 203a 2073 7472 0a20      out2 : str. 
-00041930: 2020 2020 2020 206e 616d 6520 6f66 206e         name of n
-00041940: 6577 2064 6174 6166 7261 6d65 0a20 2020  ew dataframe.   
-00041950: 2066 6f72 6365 203a 2062 6f6f 6c2c 2064   force : bool, d
-00041960: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
-00041970: 2020 2020 2041 6c6c 6f77 7320 7468 6520       Allows the 
-00041980: 6578 7061 6e73 696f 6e20 6f66 2074 6865  expansion of the
-00041990: 2065 7869 7374 696e 6720 6469 7669 7369   existing divisi
-000419a0: 6f6e 732e 0a20 2020 2020 2020 2049 6620  ons..        If 
-000419b0: 4661 6c73 6520 7468 656e 2074 6865 206e  False then the n
-000419c0: 6577 2064 6976 6973 696f 6e73 206c 6f77  ew divisions low
-000419d0: 6572 2061 6e64 2075 7070 6572 2062 6f75  er and upper bou
-000419e0: 6e64 7320 6d75 7374 2062 650a 2020 2020  nds must be.    
-000419f0: 2020 2020 7468 6520 7361 6d65 2061 7320      the same as 
-00041a00: 7468 6520 6f6c 6420 6469 7669 7369 6f6e  the old division
-00041a10: 732e 0a0a 2020 2020 4578 616d 706c 6573  s...    Examples
-00041a20: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
-00041a30: 2020 3e3e 3e20 6672 6f6d 2070 7072 696e    >>> from pprin
-00041a40: 7420 696d 706f 7274 2070 7072 696e 740a  t import pprint.
-00041a50: 2020 2020 3e3e 3e20 7070 7269 6e74 2872      >>> pprint(r
-00041a60: 6570 6172 7469 7469 6f6e 5f64 6976 6973  epartition_divis
-00041a70: 696f 6e73 285b 312c 2033 2c20 375d 2c20  ions([1, 3, 7], 
-00041a80: 5b31 2c20 342c 2036 2c20 375d 2c20 2761  [1, 4, 6, 7], 'a
-00041a90: 272c 2027 6227 2c20 2763 2729 2920 2023  ', 'b', 'c'))  #
-00041aa0: 2064 6f63 7465 7374 3a20 2b45 4c4c 4950   doctest: +ELLIP
-00041ab0: 5349 530a 2020 2020 7b28 2762 272c 2030  SIS.    {('b', 0
-00041ac0: 293a 2028 3c66 756e 6374 696f 6e20 626f  ): (<function bo
-00041ad0: 756e 6461 7279 5f73 6c69 6365 2061 7420  undary_slice at 
-00041ae0: 2e2e 2e3e 2c20 2827 6127 2c20 3029 2c20  ...>, ('a', 0), 
-00041af0: 312c 2033 2c20 4661 6c73 6529 2c0a 2020  1, 3, False),.  
-00041b00: 2020 2028 2762 272c 2031 293a 2028 3c66     ('b', 1): (<f
-00041b10: 756e 6374 696f 6e20 626f 756e 6461 7279  unction boundary
-00041b20: 5f73 6c69 6365 2061 7420 2e2e 2e3e 2c20  _slice at ...>, 
-00041b30: 2827 6127 2c20 3129 2c20 332c 2034 2c20  ('a', 1), 3, 4, 
-00041b40: 4661 6c73 6529 2c0a 2020 2020 2028 2762  False),.     ('b
-00041b50: 272c 2032 293a 2028 3c66 756e 6374 696f  ', 2): (<functio
-00041b60: 6e20 626f 756e 6461 7279 5f73 6c69 6365  n boundary_slice
-00041b70: 2061 7420 2e2e 2e3e 2c20 2827 6127 2c20   at ...>, ('a', 
-00041b80: 3129 2c20 342c 2036 2c20 4661 6c73 6529  1), 4, 6, False)
-00041b90: 2c0a 2020 2020 2028 2762 272c 2033 293a  ,.     ('b', 3):
-00041ba0: 2028 3c66 756e 6374 696f 6e20 626f 756e   (<function boun
-00041bb0: 6461 7279 5f73 6c69 6365 2061 7420 2e2e  dary_slice at ..
-00041bc0: 2e3e 2c20 2827 6127 2c20 3129 2c20 362c  .>, ('a', 1), 6,
-00041bd0: 2037 2c20 5472 7565 292c 0a20 2020 2020   7, True),.     
-00041be0: 2827 6327 2c20 3029 3a20 283c 6675 6e63  ('c', 0): (<func
-00041bf0: 7469 6f6e 2063 6f6e 6361 7420 6174 202e  tion concat at .
-00041c00: 2e2e 3e2c 205b 2827 6227 2c20 3029 2c20  ..>, [('b', 0), 
-00041c10: 2827 6227 2c20 3129 5d29 2c0a 2020 2020  ('b', 1)]),.    
-00041c20: 2028 2763 272c 2031 293a 2028 2762 272c   ('c', 1): ('b',
-00041c30: 2032 292c 0a20 2020 2020 2827 6327 2c20   2),.     ('c', 
-00041c40: 3229 3a20 2827 6227 2c20 3329 7d0a 2020  2): ('b', 3)}.  
-00041c50: 2020 2222 220a 2020 2020 6368 6563 6b5f    """.    check_
-00041c60: 6469 7669 7369 6f6e 7328 6229 0a0a 2020  divisions(b)..  
-00041c70: 2020 6966 206c 656e 2862 2920 3c20 323a    if len(b) < 2:
-00041c80: 0a20 2020 2020 2020 2023 206d 696e 696d  .        # minim
-00041c90: 756d 2064 6976 6973 696f 6e20 6973 2032  um division is 2
-00041ca0: 2065 6c65 6d65 6e74 732c 206c 696b 6520   elements, like 
-00041cb0: 5b30 2c20 305d 0a20 2020 2020 2020 2072  [0, 0].        r
-00041cc0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00041cd0: 224e 6577 2064 6976 6973 696f 6e20 6d75  "New division mu
-00041ce0: 7374 2062 6520 6c6f 6e67 6572 2074 6861  st be longer tha
-00041cf0: 6e20 3220 656c 656d 656e 7473 2229 0a0a  n 2 elements")..
-00041d00: 2020 2020 6966 2066 6f72 6365 3a0a 2020      if force:.  
-00041d10: 2020 2020 2020 6966 2061 5b30 5d20 3c20        if a[0] < 
-00041d20: 625b 305d 3a0a 2020 2020 2020 2020 2020  b[0]:.          
-00041d30: 2020 6d73 6720 3d20 280a 2020 2020 2020    msg = (.      
-00041d40: 2020 2020 2020 2020 2020 226c 6566 7420            "left 
-00041d50: 7369 6465 206f 6620 7468 6520 6e65 7720  side of the new 
-00041d60: 6469 7669 7369 6f6e 206d 7573 7420 6265  division must be
-00041d70: 2065 7175 616c 206f 7220 736d 616c 6c65   equal or smalle
-00041d80: 7220 220a 2020 2020 2020 2020 2020 2020  r ".            
-00041d90: 2020 2020 2274 6861 6e20 6f6c 6420 6469      "than old di
-00041da0: 7669 7369 6f6e 220a 2020 2020 2020 2020  vision".        
-00041db0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00041dc0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00041dd0: 6f72 286d 7367 290a 2020 2020 2020 2020  or(msg).        
-00041de0: 6966 2061 5b2d 315d 203e 2062 5b2d 315d  if a[-1] > b[-1]
-00041df0: 3a0a 2020 2020 2020 2020 2020 2020 6d73  :.            ms
-00041e00: 6720 3d20 280a 2020 2020 2020 2020 2020  g = (.          
-00041e10: 2020 2020 2020 2272 6967 6874 2073 6964        "right sid
-00041e20: 6520 6f66 2074 6865 206e 6577 2064 6976  e of the new div
-00041e30: 6973 696f 6e20 6d75 7374 2062 6520 6571  ision must be eq
-00041e40: 7561 6c20 6f72 206c 6172 6765 7220 220a  ual or larger ".
-00041e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041e60: 2274 6861 6e20 6f6c 6420 6469 7669 7369  "than old divisi
-00041e70: 6f6e 220a 2020 2020 2020 2020 2020 2020  on".            
-00041e80: 290a 2020 2020 2020 2020 2020 2020 7261  ).            ra
-00041e90: 6973 6520 5661 6c75 6545 7272 6f72 286d  ise ValueError(m
-00041ea0: 7367 290a 2020 2020 656c 7365 3a0a 2020  sg).    else:.  
-00041eb0: 2020 2020 2020 6966 2061 5b30 5d20 213d        if a[0] !=
-00041ec0: 2062 5b30 5d3a 0a20 2020 2020 2020 2020   b[0]:.         
-00041ed0: 2020 206d 7367 203d 2022 6c65 6674 2073     msg = "left s
-00041ee0: 6964 6520 6f66 206f 6c64 2061 6e64 206e  ide of old and n
-00041ef0: 6577 2064 6976 6973 696f 6e73 2061 7265  ew divisions are
-00041f00: 2064 6966 6665 7265 6e74 220a 2020 2020   different".    
-00041f10: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00041f20: 6c75 6545 7272 6f72 286d 7367 290a 2020  lueError(msg).  
-00041f30: 2020 2020 2020 6966 2061 5b2d 315d 2021        if a[-1] !
-00041f40: 3d20 625b 2d31 5d3a 0a20 2020 2020 2020  = b[-1]:.       
-00041f50: 2020 2020 206d 7367 203d 2022 7269 6768       msg = "righ
-00041f60: 7420 7369 6465 206f 6620 6f6c 6420 616e  t side of old an
-00041f70: 6420 6e65 7720 6469 7669 7369 6f6e 7320  d new divisions 
-00041f80: 6172 6520 6469 6666 6572 656e 7422 0a20  are different". 
-00041f90: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00041fa0: 2056 616c 7565 4572 726f 7228 6d73 6729   ValueError(msg)
-00041fb0: 0a0a 2020 2020 6465 6620 5f69 735f 7369  ..    def _is_si
-00041fc0: 6e67 6c65 5f6c 6173 745f 6469 7628 7829  ngle_last_div(x)
-00041fd0: 3a0a 2020 2020 2020 2020 2222 2257 6865  :.        """Whe
-00041fe0: 7468 6572 206c 6173 7420 6469 7669 7369  ther last divisi
-00041ff0: 6f6e 206f 6e6c 7920 636f 6e74 6169 6e73  on only contains
-00042000: 2073 696e 676c 6520 6c61 6265 6c22 2222   single label"""
-00042010: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00042020: 6c65 6e28 7829 203e 3d20 3220 616e 6420  len(x) >= 2 and 
-00042030: 785b 2d31 5d20 3d3d 2078 5b2d 325d 0a0a  x[-1] == x[-2]..
-00042040: 2020 2020 6320 3d20 5b61 5b30 5d5d 0a20      c = [a[0]]. 
-00042050: 2020 2064 203d 2064 6963 7428 290a 2020     d = dict().  
-00042060: 2020 6c6f 7720 3d20 615b 305d 0a0a 2020    low = a[0]..  
-00042070: 2020 692c 206a 203d 2031 2c20 3120 2023    i, j = 1, 1  #
-00042080: 2069 6e64 6963 6573 2066 6f72 206f 6c64   indices for old
-00042090: 2f6e 6577 2064 6976 6973 696f 6e73 0a20  /new divisions. 
-000420a0: 2020 206b 203d 2030 2020 2320 696e 6465     k = 0  # inde
-000420b0: 7820 666f 7220 7465 6d70 2064 6976 6973  x for temp divis
-000420c0: 696f 6e73 0a0a 2020 2020 6c61 7374 5f65  ions..    last_e
-000420d0: 6c65 6d20 3d20 5f69 735f 7369 6e67 6c65  lem = _is_single
-000420e0: 5f6c 6173 745f 6469 7628 6129 0a0a 2020  _last_div(a)..  
-000420f0: 2020 2320 7072 6f63 6573 7320 7468 726f    # process thro
-00042100: 7567 6820 6f6c 6420 6469 7669 7369 6f6e  ugh old division
-00042110: 0a20 2020 2023 206c 6566 7420 7061 7274  .    # left part
-00042120: 206f 6620 6e65 7720 6469 7669 7369 6f6e   of new division
-00042130: 2063 616e 2062 6520 7072 6f63 6573 7365   can be processe
-00042140: 6420 696e 2074 6869 7320 6c6f 6f70 0a20  d in this loop. 
-00042150: 2020 2077 6869 6c65 2069 203c 206c 656e     while i < len
-00042160: 2861 2920 616e 6420 6a20 3c20 6c65 6e28  (a) and j < len(
-00042170: 6229 3a0a 2020 2020 2020 2020 6966 2061  b):.        if a
-00042180: 5b69 5d20 3c20 625b 6a5d 3a0a 2020 2020  [i] < b[j]:.    
-00042190: 2020 2020 2020 2020 2320 7475 706c 6520          # tuple 
-000421a0: 6973 2073 6f6d 6574 6869 6e67 206c 696b  is something lik
-000421b0: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
-000421c0: 2028 6d65 7468 6f64 732e 626f 756e 6461   (methods.bounda
-000421d0: 7279 5f73 6c69 6365 2c20 2827 6672 6f6d  ry_slice, ('from
-000421e0: 5f70 616e 6461 732d 2327 2c20 3029 2c20  _pandas-#', 0), 
-000421f0: 332c 2034 2c20 4661 6c73 6529 290a 2020  3, 4, False)).  
-00042200: 2020 2020 2020 2020 2020 645b 286f 7574            d[(out
-00042210: 312c 206b 295d 203d 2028 6d65 7468 6f64  1, k)] = (method
-00042220: 732e 626f 756e 6461 7279 5f73 6c69 6365  s.boundary_slice
-00042230: 2c20 286e 616d 652c 2069 202d 2031 292c  , (name, i - 1),
-00042240: 206c 6f77 2c20 615b 695d 2c20 4661 6c73   low, a[i], Fals
-00042250: 6529 0a20 2020 2020 2020 2020 2020 206c  e).            l
-00042260: 6f77 203d 2061 5b69 5d0a 2020 2020 2020  ow = a[i].      
-00042270: 2020 2020 2020 6920 2b3d 2031 0a20 2020        i += 1.   
-00042280: 2020 2020 2065 6c69 6620 615b 695d 203e       elif a[i] >
-00042290: 2062 5b6a 5d3a 0a20 2020 2020 2020 2020   b[j]:.         
-000422a0: 2020 2064 5b28 6f75 7431 2c20 6b29 5d20     d[(out1, k)] 
-000422b0: 3d20 286d 6574 686f 6473 2e62 6f75 6e64  = (methods.bound
-000422c0: 6172 795f 736c 6963 652c 2028 6e61 6d65  ary_slice, (name
-000422d0: 2c20 6920 2d20 3129 2c20 6c6f 772c 2062  , i - 1), low, b
-000422e0: 5b6a 5d2c 2046 616c 7365 290a 2020 2020  [j], False).    
-000422f0: 2020 2020 2020 2020 6c6f 7720 3d20 625b          low = b[
-00042300: 6a5d 0a20 2020 2020 2020 2020 2020 206a  j].            j
-00042310: 202b 3d20 310a 2020 2020 2020 2020 656c   += 1.        el
-00042320: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00042330: 645b 286f 7574 312c 206b 295d 203d 2028  d[(out1, k)] = (
-00042340: 6d65 7468 6f64 732e 626f 756e 6461 7279  methods.boundary
-00042350: 5f73 6c69 6365 2c20 286e 616d 652c 2069  _slice, (name, i
-00042360: 202d 2031 292c 206c 6f77 2c20 625b 6a5d   - 1), low, b[j]
-00042370: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
-00042380: 2020 2020 206c 6f77 203d 2062 5b6a 5d0a       low = b[j].
-00042390: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-000423a0: 656e 2861 2920 3d3d 2069 202b 2031 206f  en(a) == i + 1 o
-000423b0: 7220 615b 695d 203c 2061 5b69 202b 2031  r a[i] < a[i + 1
-000423c0: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-000423d0: 2020 206a 202b 3d20 310a 2020 2020 2020     j += 1.      
-000423e0: 2020 2020 2020 6920 2b3d 2031 0a20 2020        i += 1.   
-000423f0: 2020 2020 2063 2e61 7070 656e 6428 6c6f       c.append(lo
-00042400: 7729 0a20 2020 2020 2020 206b 202b 3d20  w).        k += 
-00042410: 310a 0a20 2020 2023 2072 6967 6874 2070  1..    # right p
-00042420: 6172 7420 6f66 206e 6577 2064 6976 6973  art of new divis
-00042430: 696f 6e20 6361 6e20 7265 6d61 696e 0a20  ion can remain. 
-00042440: 2020 2069 6620 615b 2d31 5d20 3c20 625b     if a[-1] < b[
-00042450: 2d31 5d20 6f72 2062 5b2d 315d 203d 3d20  -1] or b[-1] == 
-00042460: 625b 2d32 5d3a 0a20 2020 2020 2020 2066  b[-2]:.        f
-00042470: 6f72 205f 6a20 696e 2072 616e 6765 286a  or _j in range(j
-00042480: 2c20 6c65 6e28 6229 293a 0a20 2020 2020  , len(b)):.     
-00042490: 2020 2020 2020 2023 2061 6c77 6179 7320         # always 
-000424a0: 7573 6520 7269 6768 742d 6d6f 7374 206f  use right-most o
-000424b0: 6620 6f6c 6420 6469 7669 7369 6f6e 0a20  f old division. 
-000424c0: 2020 2020 2020 2020 2020 2023 2062 6563             # bec
-000424d0: 6175 7365 2069 7420 6d61 7920 636f 6e74  ause it may cont
-000424e0: 6169 6e20 6c61 7374 2065 6c65 6d65 6e74  ain last element
-000424f0: 0a20 2020 2020 2020 2020 2020 206d 203d  .            m =
-00042500: 206c 656e 2861 2920 2d20 320a 2020 2020   len(a) - 2.    
-00042510: 2020 2020 2020 2020 645b 286f 7574 312c          d[(out1,
-00042520: 206b 295d 203d 2028 6d65 7468 6f64 732e   k)] = (methods.
-00042530: 626f 756e 6461 7279 5f73 6c69 6365 2c20  boundary_slice, 
-00042540: 286e 616d 652c 206d 292c 206c 6f77 2c20  (name, m), low, 
-00042550: 625b 5f6a 5d2c 2046 616c 7365 290a 2020  b[_j], False).  
-00042560: 2020 2020 2020 2020 2020 6c6f 7720 3d20            low = 
-00042570: 625b 5f6a 5d0a 2020 2020 2020 2020 2020  b[_j].          
-00042580: 2020 632e 6170 7065 6e64 286c 6f77 290a    c.append(low).
-00042590: 2020 2020 2020 2020 2020 2020 6b20 2b3d              k +=
-000425a0: 2031 0a20 2020 2065 6c73 653a 0a20 2020   1.    else:.   
-000425b0: 2020 2020 2023 2065 7665 6e20 6966 206e       # even if n
-000425c0: 6577 2064 6976 6973 696f 6e20 6973 2070  ew division is p
-000425d0: 726f 6365 7373 6564 2074 6872 6f75 6768  rocessed through
-000425e0: 2c0a 2020 2020 2020 2020 2320 7269 6768  ,.        # righ
-000425f0: 742d 6d6f 7374 2065 6c65 6d65 6e74 206f  t-most element o
-00042600: 6620 6f6c 6420 6469 7669 7369 6f6e 2063  f old division c
-00042610: 616e 2072 656d 6169 6e0a 2020 2020 2020  an remain.      
-00042620: 2020 6966 206c 6173 745f 656c 656d 2061    if last_elem a
-00042630: 6e64 2069 203c 206c 656e 2861 293a 0a20  nd i < len(a):. 
-00042640: 2020 2020 2020 2020 2020 2064 5b28 6f75             d[(ou
-00042650: 7431 2c20 6b29 5d20 3d20 286d 6574 686f  t1, k)] = (metho
-00042660: 6473 2e62 6f75 6e64 6172 795f 736c 6963  ds.boundary_slic
-00042670: 652c 2028 6e61 6d65 2c20 6920 2d20 3129  e, (name, i - 1)
-00042680: 2c20 615b 695d 2c20 615b 695d 2c20 4661  , a[i], a[i], Fa
-00042690: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
-000426a0: 206b 202b 3d20 310a 2020 2020 2020 2020   k += 1.        
-000426b0: 632e 6170 7065 6e64 2861 5b2d 315d 290a  c.append(a[-1]).
-000426c0: 0a20 2020 2023 2072 6570 6c61 6365 206c  .    # replace l
-000426d0: 6173 7420 656c 656d 656e 7420 6f66 2074  ast element of t
-000426e0: 7570 6c65 2077 6974 6820 5472 7565 0a20  uple with True. 
-000426f0: 2020 2064 5b28 6f75 7431 2c20 6b20 2d20     d[(out1, k - 
-00042700: 3129 5d20 3d20 645b 286f 7574 312c 206b  1)] = d[(out1, k
-00042710: 202d 2031 295d 5b3a 2d31 5d20 2b20 2854   - 1)][:-1] + (T
-00042720: 7275 652c 290a 0a20 2020 2069 2c20 6a20  rue,)..    i, j 
-00042730: 3d20 302c 2031 0a0a 2020 2020 6c61 7374  = 0, 1..    last
-00042740: 5f65 6c65 6d20 3d20 5f69 735f 7369 6e67  _elem = _is_sing
-00042750: 6c65 5f6c 6173 745f 6469 7628 6329 0a0a  le_last_div(c)..
-00042760: 2020 2020 7768 696c 6520 6a20 3c20 6c65      while j < le
-00042770: 6e28 6229 3a0a 2020 2020 2020 2020 746d  n(b):.        tm
-00042780: 7020 3d20 5b5d 0a20 2020 2020 2020 2077  p = [].        w
-00042790: 6869 6c65 2063 5b69 5d20 3c20 625b 6a5d  hile c[i] < b[j]
-000427a0: 3a0a 2020 2020 2020 2020 2020 2020 746d  :.            tm
-000427b0: 702e 6170 7065 6e64 2828 6f75 7431 2c20  p.append((out1, 
-000427c0: 6929 290a 2020 2020 2020 2020 2020 2020  i)).            
-000427d0: 6920 2b3d 2031 0a20 2020 2020 2020 2077  i += 1.        w
-000427e0: 6869 6c65 2028 0a20 2020 2020 2020 2020  hile (.         
-000427f0: 2020 206c 6173 745f 656c 656d 0a20 2020     last_elem.   
-00042800: 2020 2020 2020 2020 2061 6e64 2063 5b69           and c[i
-00042810: 5d20 3d3d 2062 5b2d 315d 0a20 2020 2020  ] == b[-1].     
-00042820: 2020 2020 2020 2061 6e64 2028 625b 2d31         and (b[-1
-00042830: 5d20 213d 2062 5b2d 325d 206f 7220 6a20  ] != b[-2] or j 
-00042840: 3d3d 206c 656e 2862 2920 2d20 3129 0a20  == len(b) - 1). 
-00042850: 2020 2020 2020 2020 2020 2061 6e64 2069             and i
-00042860: 203c 206b 0a20 2020 2020 2020 2029 3a0a   < k.        ):.
-00042870: 2020 2020 2020 2020 2020 2020 2320 6170              # ap
-00042880: 7065 6e64 2069 6620 6c61 7374 2073 706c  pend if last spl
-00042890: 6974 2069 7320 6e6f 7420 696e 636c 7564  it is not includ
-000428a0: 6564 0a20 2020 2020 2020 2020 2020 2074  ed.            t
-000428b0: 6d70 2e61 7070 656e 6428 286f 7574 312c  mp.append((out1,
-000428c0: 2069 2929 0a20 2020 2020 2020 2020 2020   i)).           
-000428d0: 2069 202b 3d20 310a 2020 2020 2020 2020   i += 1.        
-000428e0: 6966 206c 656e 2874 6d70 2920 3d3d 2030  if len(tmp) == 0
-000428f0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-00042900: 6475 6d6d 7920 736c 6963 6520 746f 2072  dummy slice to r
-00042910: 6574 7572 6e20 656d 7074 7920 4461 7461  eturn empty Data
-00042920: 4672 616d 6520 6f72 2053 6572 6965 732c  Frame or Series,
-00042930: 0a20 2020 2020 2020 2020 2020 2023 2077  .            # w
-00042940: 6869 6368 2072 6574 6169 6e20 6f72 6967  hich retain orig
-00042950: 696e 616c 2064 6174 6120 6174 7472 6962  inal data attrib
-00042960: 7574 6573 2028 636f 6c75 6d6e 7320 2f20  utes (columns / 
-00042970: 6e61 6d65 290a 2020 2020 2020 2020 2020  name).          
-00042980: 2020 645b 286f 7574 322c 206a 202d 2031    d[(out2, j - 1
-00042990: 295d 203d 2028 6d65 7468 6f64 732e 626f  )] = (methods.bo
-000429a0: 756e 6461 7279 5f73 6c69 6365 2c20 286e  undary_slice, (n
-000429b0: 616d 652c 2030 292c 2061 5b30 5d2c 2061  ame, 0), a[0], a
-000429c0: 5b30 5d2c 2046 616c 7365 290a 2020 2020  [0], False).    
-000429d0: 2020 2020 656c 6966 206c 656e 2874 6d70      elif len(tmp
-000429e0: 2920 3d3d 2031 3a0a 2020 2020 2020 2020  ) == 1:.        
-000429f0: 2020 2020 645b 286f 7574 322c 206a 202d      d[(out2, j -
-00042a00: 2031 295d 203d 2074 6d70 5b30 5d0a 2020   1)] = tmp[0].  
-00042a10: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00042a20: 2020 2020 2020 2020 6966 206e 6f74 2074          if not t
-00042a30: 6d70 3a0a 2020 2020 2020 2020 2020 2020  mp:.            
-00042a40: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00042a50: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00042a60: 2020 2020 2020 2020 2020 2263 6865 636b            "check
-00042a70: 2066 6f72 2064 7570 6c69 6361 7465 2070   for duplicate p
-00042a80: 6172 7469 7469 6f6e 735c 6e6f 6c64 3a5c  artitions\nold:\
-00042a90: 6e25 735c 6e5c 6e22 0a20 2020 2020 2020  n%s\n\n".       
-00042aa0: 2020 2020 2020 2020 2020 2020 2022 6e65               "ne
-00042ab0: 773a 5c6e 2573 5c6e 5c6e 636f 6d62 696e  w:\n%s\n\ncombin
-00042ac0: 6564 3a5c 6e25 7322 2025 2028 7066 6f72  ed:\n%s" % (pfor
-00042ad0: 6d61 7428 6129 2c20 7066 6f72 6d61 7428  mat(a), pformat(
-00042ae0: 6229 2c20 7066 6f72 6d61 7428 6329 290a  b), pformat(c)).
-00042af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042b00: 290a 2020 2020 2020 2020 2020 2020 645b  ).            d[
-00042b10: 286f 7574 322c 206a 202d 2031 295d 203d  (out2, j - 1)] =
-00042b20: 2028 6d65 7468 6f64 732e 636f 6e63 6174   (methods.concat
-00042b30: 2c20 746d 7029 0a20 2020 2020 2020 206a  , tmp).        j
-00042b40: 202b 3d20 310a 2020 2020 7265 7475 726e   += 1.    return
-00042b50: 2064 0a0a 0a64 6566 2072 6570 6172 7469   d...def reparti
-00042b60: 7469 6f6e 5f66 7265 7128 6466 2c20 6672  tion_freq(df, fr
-00042b70: 6571 3d4e 6f6e 6529 3a0a 2020 2020 2222  eq=None):.    ""
-00042b80: 2252 6570 6172 7469 7469 6f6e 2061 2074  "Repartition a t
-00042b90: 696d 6573 6572 6965 7320 6461 7461 6672  imeseries datafr
-00042ba0: 616d 6520 6279 2061 206e 6577 2066 7265  ame by a new fre
-00042bb0: 7175 656e 6379 2222 220a 2020 2020 6966  quency""".    if
-00042bc0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-00042bd0: 6466 2e64 6976 6973 696f 6e73 5b30 5d2c  df.divisions[0],
-00042be0: 2070 642e 5469 6d65 7374 616d 7029 3a0a   pd.Timestamp):.
-00042bf0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00042c00: 7065 4572 726f 7228 2243 616e 206f 6e6c  peError("Can onl
-00042c10: 7920 7265 7061 7274 6974 696f 6e20 6f6e  y repartition on
-00042c20: 2066 7265 7175 656e 6379 2066 6f72 2074   frequency for t
-00042c30: 696d 6573 6572 6965 7322 290a 0a20 2020  imeseries")..   
-00042c40: 2066 7265 7120 3d20 5f6d 6170 5f66 7265   freq = _map_fre
-00042c50: 715f 746f 5f70 6572 696f 645f 7374 6172  q_to_period_star
-00042c60: 7428 6672 6571 290a 0a20 2020 2074 7279  t(freq)..    try
-00042c70: 3a0a 2020 2020 2020 2020 7374 6172 7420  :.        start 
-00042c80: 3d20 6466 2e64 6976 6973 696f 6e73 5b30  = df.divisions[0
-00042c90: 5d2e 6365 696c 2866 7265 7129 0a20 2020  ].ceil(freq).   
-00042ca0: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
-00042cb0: 6f72 3a0a 2020 2020 2020 2020 7374 6172  or:.        star
-00042cc0: 7420 3d20 6466 2e64 6976 6973 696f 6e73  t = df.divisions
-00042cd0: 5b30 5d0a 2020 2020 6469 7669 7369 6f6e  [0].    division
-00042ce0: 7320 3d20 6d65 7468 6f64 732e 746f 6c69  s = methods.toli
-00042cf0: 7374 280a 2020 2020 2020 2020 7064 2e64  st(.        pd.d
-00042d00: 6174 655f 7261 6e67 6528 7374 6172 743d  ate_range(start=
-00042d10: 7374 6172 742c 2065 6e64 3d64 662e 6469  start, end=df.di
-00042d20: 7669 7369 6f6e 735b 2d31 5d2c 2066 7265  visions[-1], fre
-00042d30: 713d 6672 6571 290a 2020 2020 290a 2020  q=freq).    ).  
-00042d40: 2020 6966 206e 6f74 206c 656e 2864 6976    if not len(div
-00042d50: 6973 696f 6e73 293a 0a20 2020 2020 2020  isions):.       
-00042d60: 2064 6976 6973 696f 6e73 203d 205b 6466   divisions = [df
-00042d70: 2e64 6976 6973 696f 6e73 5b30 5d2c 2064  .divisions[0], d
-00042d80: 662e 6469 7669 7369 6f6e 735b 2d31 5d5d  f.divisions[-1]]
-00042d90: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-00042da0: 2020 2064 6976 6973 696f 6e73 2e61 7070     divisions.app
-00042db0: 656e 6428 6466 2e64 6976 6973 696f 6e73  end(df.divisions
-00042dc0: 5b2d 315d 290a 2020 2020 2020 2020 6966  [-1]).        if
-00042dd0: 2064 6976 6973 696f 6e73 5b30 5d20 213d   divisions[0] !=
-00042de0: 2064 662e 6469 7669 7369 6f6e 735b 305d   df.divisions[0]
-00042df0: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-00042e00: 7669 7369 6f6e 7320 3d20 5b64 662e 6469  visions = [df.di
-00042e10: 7669 7369 6f6e 735b 305d 5d20 2b20 6469  visions[0]] + di
-00042e20: 7669 7369 6f6e 730a 0a20 2020 2072 6574  visions..    ret
-00042e30: 7572 6e20 6466 2e72 6570 6172 7469 7469  urn df.repartiti
-00042e40: 6f6e 2864 6976 6973 696f 6e73 3d64 6976  on(divisions=div
-00042e50: 6973 696f 6e73 290a 0a0a 6465 6620 5f6d  isions)...def _m
-00042e60: 6170 5f66 7265 715f 746f 5f70 6572 696f  ap_freq_to_perio
-00042e70: 645f 7374 6172 7428 6672 6571 293a 0a20  d_start(freq):. 
-00042e80: 2020 2022 2222 456e 7375 7265 2074 6861     """Ensure tha
-00042e90: 7420 7468 6520 6672 6571 7565 6e63 7920  t the frequency 
-00042ea0: 7065 7274 6169 6e73 2074 6f20 7468 6520  pertains to the 
-00042eb0: 2a2a 7374 6172 742a 2a20 6f66 2061 2070  **start** of a p
-00042ec0: 6572 696f 642e 0a0a 2020 2020 4966 2065  eriod...    If e
-00042ed0: 2e67 2e20 6066 7265 713d 274d 2760 2c20  .g. `freq='M'`, 
-00042ee0: 7468 656e 2074 6865 2064 6976 6973 696f  then the divisio
-00042ef0: 6e73 2061 7265 3a0a 2020 2020 2020 2020  ns are:.        
-00042f00: 2d20 3230 3231 2d33 312d 3120 3030 3a30  - 2021-31-1 00:0
-00042f10: 303a 3030 2028 7374 6172 7420 6f66 2046  0:00 (start of F
-00042f20: 6562 7275 6172 7920 7061 7274 6974 696f  ebruary partitio
-00042f30: 6e29 0a20 2020 2020 2020 202d 2032 3032  n).        - 202
-00042f40: 312d 322d 3238 2030 303a 3030 3a30 3020  1-2-28 00:00:00 
-00042f50: 2873 7461 7274 206f 6620 4d61 7263 6820  (start of March 
-00042f60: 7061 7274 6974 696f 6e29 0a20 2020 2020  partition).     
-00042f70: 2020 202d 202e 2e2e 0a0a 2020 2020 6275     - .....    bu
-00042f80: 7420 7468 6973 202a 2a73 686f 756c 642a  t this **should*
-00042f90: 2a20 6265 3a0a 2020 2020 2020 2020 2d20  * be:.        - 
-00042fa0: 3230 3231 2d32 2d31 2030 303a 3030 3a30  2021-2-1 00:00:0
-00042fb0: 3020 2873 7461 7274 206f 6620 4665 6272  0 (start of Febr
-00042fc0: 7561 7279 2070 6172 7469 7469 6f6e 290a  uary partition).
-00042fd0: 2020 2020 2020 2020 2d20 3230 3231 2d33          - 2021-3
-00042fe0: 2d31 2030 303a 3030 3a30 3020 2873 7461  -1 00:00:00 (sta
-00042ff0: 7274 206f 6620 4d61 7263 6820 7061 7274  rt of March part
-00043000: 6974 696f 6e29 0a20 2020 2020 2020 202d  ition).        -
-00043010: 202e 2e2e 0a0a 2020 2020 5468 6572 6566   .....    Theref
-00043020: 6f72 652c 2077 6520 6d61 7020 6066 7265  ore, we map `fre
-00043030: 713d 274d 2760 2074 6f20 6066 7265 713d  q='M'` to `freq=
-00043040: 274d 5327 6020 2873 616d 6520 666f 7220  'MS'` (same for 
-00043050: 7175 6172 7465 7220 616e 6420 7965 6172  quarter and year
-00043060: 292e 0a20 2020 2022 2222 0a0a 2020 2020  )..    """..    
-00043070: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00043080: 6528 6672 6571 2c20 7374 7229 3a0a 2020  e(freq, str):.  
-00043090: 2020 2020 2020 7265 7475 726e 2066 7265        return fre
-000430a0: 710a 0a20 2020 206f 6666 7365 7420 3d20  q..    offset = 
-000430b0: 7064 2e74 7365 7269 6573 2e66 7265 7175  pd.tseries.frequ
-000430c0: 656e 6369 6573 2e74 6f5f 6f66 6673 6574  encies.to_offset
-000430d0: 2866 7265 7129 0a20 2020 206f 6666 7365  (freq).    offse
-000430e0: 745f 7479 7065 5f6e 616d 6520 3d20 7479  t_type_name = ty
-000430f0: 7065 286f 6666 7365 7429 2e5f 5f6e 616d  pe(offset).__nam
-00043100: 655f 5f0a 0a20 2020 2069 6620 6e6f 7420  e__..    if not 
-00043110: 6f66 6673 6574 5f74 7970 655f 6e61 6d65  offset_type_name
-00043120: 2e65 6e64 7377 6974 6828 2245 6e64 2229  .endswith("End")
-00043130: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00043140: 2066 7265 710a 0a20 2020 206e 6577 5f6f   freq..    new_o
-00043150: 6666 7365 7420 3d20 6f66 6673 6574 5f74  ffset = offset_t
-00043160: 7970 655f 6e61 6d65 5b3a 202d 6c65 6e28  ype_name[: -len(
-00043170: 2245 6e64 2229 5d20 2b20 2242 6567 696e  "End")] + "Begin
-00043180: 220a 2020 2020 7472 793a 0a20 2020 2020  ".    try:.     
-00043190: 2020 206e 6577 5f6f 6666 7365 745f 7479     new_offset_ty
-000431a0: 7065 203d 2067 6574 6174 7472 2870 642e  pe = getattr(pd.
-000431b0: 7473 6572 6965 732e 6f66 6673 6574 732c  tseries.offsets,
-000431c0: 206e 6577 5f6f 6666 7365 7429 0a20 2020   new_offset).   
-000431d0: 2020 2020 2069 6620 222d 2220 696e 2066       if "-" in f
-000431e0: 7265 713a 0a20 2020 2020 2020 2020 2020  req:.           
-000431f0: 205f 2c20 616e 6368 6f72 203d 2066 7265   _, anchor = fre
-00043200: 712e 7370 6c69 7428 222d 2229 0a20 2020  q.split("-").   
-00043210: 2020 2020 2020 2020 2061 6e63 686f 7220           anchor 
-00043220: 3d20 222d 2220 2b20 616e 6368 6f72 0a20  = "-" + anchor. 
-00043230: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00043240: 2020 2020 2020 2020 2061 6e63 686f 7220           anchor 
-00043250: 3d20 2222 0a20 2020 2020 2020 206e 203d  = "".        n =
-00043260: 2073 7472 286f 6666 7365 742e 6e29 2069   str(offset.n) i
-00043270: 6620 6f66 6673 6574 2e6e 2021 3d20 3120  f offset.n != 1 
-00043280: 656c 7365 2022 220a 2020 2020 2020 2020  else "".        
-00043290: 7265 7475 726e 2066 227b 6e7d 7b6e 6577  return f"{n}{new
-000432a0: 5f6f 6666 7365 745f 7479 7065 2e5f 7072  _offset_type._pr
-000432b0: 6566 6978 7d7b 616e 6368 6f72 7d22 0a20  efix}{anchor}". 
-000432c0: 2020 2065 7863 6570 7420 4174 7472 6962     except Attrib
-000432d0: 7574 6545 7272 6f72 3a0a 2020 2020 2020  uteError:.      
-000432e0: 2020 7265 7475 726e 2066 7265 710a 0a0a    return freq...
-000432f0: 6465 6620 7265 7061 7274 6974 696f 6e5f  def repartition_
-00043300: 7369 7a65 2864 662c 2073 697a 6529 3a0a  size(df, size):.
-00043310: 2020 2020 2222 220a 2020 2020 5265 7061      """.    Repa
-00043320: 7274 6974 696f 6e20 6461 7461 6672 616d  rtition datafram
-00043330: 6520 736f 2074 6861 7420 6e65 7720 7061  e so that new pa
-00043340: 7274 6974 696f 6e73 2068 6176 6520 6170  rtitions have ap
-00043350: 7072 6f78 696d 6174 656c 7920 6073 697a  proximately `siz
-00043360: 6560 206d 656d 6f72 7920 7573 6167 6520  e` memory usage 
-00043370: 6561 6368 0a20 2020 2022 2222 0a20 2020  each.    """.   
-00043380: 2069 6620 6973 696e 7374 616e 6365 2873   if isinstance(s
-00043390: 697a 652c 2073 7472 293a 0a20 2020 2020  ize, str):.     
-000433a0: 2020 2073 697a 6520 3d20 7061 7273 655f     size = parse_
-000433b0: 6279 7465 7328 7369 7a65 290a 2020 2020  bytes(size).    
-000433c0: 7369 7a65 203d 2069 6e74 2873 697a 6529  size = int(size)
-000433d0: 0a0a 2020 2020 6d65 6d5f 7573 6167 6573  ..    mem_usages
-000433e0: 203d 2064 662e 6d61 705f 7061 7274 6974   = df.map_partit
-000433f0: 696f 6e73 2874 6f74 616c 5f6d 656d 5f75  ions(total_mem_u
-00043400: 7361 6765 2c20 6465 6570 3d54 7275 6529  sage, deep=True)
-00043410: 2e63 6f6d 7075 7465 2829 0a0a 2020 2020  .compute()..    
-00043420: 2320 312e 2073 706c 6974 2065 6163 6820  # 1. split each 
-00043430: 7061 7274 6974 696f 6e20 7468 6174 2069  partition that i
-00043440: 7320 6c61 7267 6572 2074 6861 6e20 7061  s larger than pa
-00043450: 7274 6974 696f 6e5f 7369 7a65 0a20 2020  rtition_size.   
-00043460: 206e 7370 6c69 7473 203d 2031 202b 206d   nsplits = 1 + m
-00043470: 656d 5f75 7361 6765 7320 2f2f 2073 697a  em_usages // siz
-00043480: 650a 2020 2020 6966 206e 702e 616e 7928  e.    if np.any(
-00043490: 6e73 706c 6974 7320 3e20 3129 3a0a 2020  nsplits > 1):.  
-000434a0: 2020 2020 2020 7370 6c69 745f 6e61 6d65        split_name
-000434b0: 203d 2066 2272 6570 6172 7469 7469 6f6e   = f"repartition
-000434c0: 2d73 706c 6974 2d7b 7369 7a65 7d2d 7b74  -split-{size}-{t
-000434d0: 6f6b 656e 697a 6528 6466 297d 220a 2020  okenize(df)}".  
-000434e0: 2020 2020 2020 6466 203d 205f 7370 6c69        df = _spli
-000434f0: 745f 7061 7274 6974 696f 6e73 2864 662c  t_partitions(df,
-00043500: 206e 7370 6c69 7473 2c20 7370 6c69 745f   nsplits, split_
-00043510: 6e61 6d65 290a 2020 2020 2020 2020 2320  name).        # 
-00043520: 7570 6461 7465 206d 656d 5f75 7361 6765  update mem_usage
-00043530: 7320 746f 2061 6363 6f75 6e74 2066 6f72  s to account for
-00043540: 2074 6865 2073 706c 6974 2070 6172 7469   the split parti
-00043550: 7469 6f6e 730a 2020 2020 2020 2020 7370  tions.        sp
-00043560: 6c69 745f 6d65 6d5f 7573 6167 6573 203d  lit_mem_usages =
-00043570: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
-00043580: 6e2c 2075 7361 6765 2069 6e20 7a69 7028  n, usage in zip(
-00043590: 6e73 706c 6974 732c 206d 656d 5f75 7361  nsplits, mem_usa
-000435a0: 6765 7329 3a0a 2020 2020 2020 2020 2020  ges):.          
-000435b0: 2020 7370 6c69 745f 6d65 6d5f 7573 6167    split_mem_usag
-000435c0: 6573 2e65 7874 656e 6428 5b75 7361 6765  es.extend([usage
-000435d0: 202f 206e 5d20 2a20 6e29 0a20 2020 2020   / n] * n).     
-000435e0: 2020 206d 656d 5f75 7361 6765 7320 3d20     mem_usages = 
-000435f0: 7064 2e53 6572 6965 7328 7370 6c69 745f  pd.Series(split_
-00043600: 6d65 6d5f 7573 6167 6573 290a 0a20 2020  mem_usages)..   
-00043610: 2023 2032 2e20 6e6f 7720 7468 6174 2061   # 2. now that a
-00043620: 6c6c 2070 6172 7469 7469 6f6e 7320 6172  ll partitions ar
-00043630: 6520 6c65 7373 2074 6861 6e20 7369 7a65  e less than size
-00043640: 2c20 636f 6e63 6174 2074 6865 6d20 7570  , concat them up
-00043650: 2074 6f20 7369 7a65 0a20 2020 2061 7373   to size.    ass
-00043660: 6572 7420 6e70 2e61 6c6c 286d 656d 5f75  ert np.all(mem_u
-00043670: 7361 6765 7320 3c3d 2073 697a 6529 0a20  sages <= size). 
-00043680: 2020 206e 6577 5f6e 7061 7274 6974 696f     new_npartitio
-00043690: 6e73 203d 206c 6973 7428 6d61 7028 6c65  ns = list(map(le
-000436a0: 6e2c 2069 7465 725f 6368 756e 6b73 286d  n, iter_chunks(m
-000436b0: 656d 5f75 7361 6765 732c 2073 697a 6529  em_usages, size)
-000436c0: 2929 0a20 2020 206e 6577 5f70 6172 7469  )).    new_parti
-000436d0: 7469 6f6e 735f 626f 756e 6461 7269 6573  tions_boundaries
-000436e0: 203d 206e 702e 6375 6d73 756d 286e 6577   = np.cumsum(new
-000436f0: 5f6e 7061 7274 6974 696f 6e73 290a 2020  _npartitions).  
-00043700: 2020 6e65 775f 6e61 6d65 203d 2066 2272    new_name = f"r
-00043710: 6570 6172 7469 7469 6f6e 2d7b 7369 7a65  epartition-{size
-00043720: 7d2d 7b74 6f6b 656e 697a 6528 6466 297d  }-{tokenize(df)}
-00043730: 220a 2020 2020 7265 7475 726e 205f 7265  ".    return _re
-00043740: 7061 7274 6974 696f 6e5f 6672 6f6d 5f62  partition_from_b
-00043750: 6f75 6e64 6172 6965 7328 6466 2c20 6e65  oundaries(df, ne
-00043760: 775f 7061 7274 6974 696f 6e73 5f62 6f75  w_partitions_bou
-00043770: 6e64 6172 6965 732c 206e 6577 5f6e 616d  ndaries, new_nam
-00043780: 6529 0a0a 0a64 6566 2074 6f74 616c 5f6d  e)...def total_m
-00043790: 656d 5f75 7361 6765 2864 662c 2069 6e64  em_usage(df, ind
-000437a0: 6578 3d54 7275 652c 2064 6565 703d 4661  ex=True, deep=Fa
-000437b0: 6c73 6529 3a0a 2020 2020 6d65 6d5f 7573  lse):.    mem_us
-000437c0: 6167 6520 3d20 6466 2e6d 656d 6f72 795f  age = df.memory_
-000437d0: 7573 6167 6528 696e 6465 783d 696e 6465  usage(index=inde
-000437e0: 782c 2064 6565 703d 6465 6570 290a 2020  x, deep=deep).  
-000437f0: 2020 6966 2069 735f 7365 7269 6573 5f6c    if is_series_l
-00043800: 696b 6528 6d65 6d5f 7573 6167 6529 3a0a  ike(mem_usage):.
-00043810: 2020 2020 2020 2020 6d65 6d5f 7573 6167          mem_usag
-00043820: 6520 3d20 6d65 6d5f 7573 6167 652e 7375  e = mem_usage.su
-00043830: 6d28 290a 2020 2020 7265 7475 726e 206d  m().    return m
-00043840: 656d 5f75 7361 6765 0a0a 0a64 6566 2072  em_usage...def r
-00043850: 6570 6172 7469 7469 6f6e 5f6e 7061 7274  epartition_npart
-00043860: 6974 696f 6e73 2864 662c 206e 7061 7274  itions(df, npart
-00043870: 6974 696f 6e73 293a 0a20 2020 2022 2222  itions):.    """
-00043880: 5265 7061 7274 6974 696f 6e20 6461 7461  Repartition data
-00043890: 6672 616d 6520 746f 2061 2073 6d61 6c6c  frame to a small
-000438a0: 6572 206e 756d 6265 7220 6f66 2070 6172  er number of par
-000438b0: 7469 7469 6f6e 7322 2222 0a20 2020 206e  titions""".    n
-000438c0: 6577 5f6e 616d 6520 3d20 2272 6570 6172  ew_name = "repar
-000438d0: 7469 7469 6f6e 2d25 642d 2573 2220 2520  tition-%d-%s" % 
-000438e0: 286e 7061 7274 6974 696f 6e73 2c20 746f  (npartitions, to
-000438f0: 6b65 6e69 7a65 2864 6629 290a 2020 2020  kenize(df)).    
-00043900: 6966 2064 662e 6e70 6172 7469 7469 6f6e  if df.npartition
-00043910: 7320 3d3d 206e 7061 7274 6974 696f 6e73  s == npartitions
-00043920: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00043930: 2064 660a 2020 2020 656c 6966 2064 662e   df.    elif df.
-00043940: 6e70 6172 7469 7469 6f6e 7320 3e20 6e70  npartitions > np
-00043950: 6172 7469 7469 6f6e 733a 0a20 2020 2020  artitions:.     
-00043960: 2020 206e 7061 7274 6974 696f 6e73 5f72     npartitions_r
-00043970: 6174 696f 203d 2064 662e 6e70 6172 7469  atio = df.nparti
-00043980: 7469 6f6e 7320 2f20 6e70 6172 7469 7469  tions / npartiti
-00043990: 6f6e 730a 2020 2020 2020 2020 6e65 775f  ons.        new_
-000439a0: 7061 7274 6974 696f 6e73 5f62 6f75 6e64  partitions_bound
-000439b0: 6172 6965 7320 3d20 5b0a 2020 2020 2020  aries = [.      
-000439c0: 2020 2020 2020 696e 7428 6e65 775f 7061        int(new_pa
-000439d0: 7274 6974 696f 6e5f 696e 6465 7820 2a20  rtition_index * 
-000439e0: 6e70 6172 7469 7469 6f6e 735f 7261 7469  npartitions_rati
-000439f0: 6f29 0a20 2020 2020 2020 2020 2020 2066  o).            f
-00043a00: 6f72 206e 6577 5f70 6172 7469 7469 6f6e  or new_partition
-00043a10: 5f69 6e64 6578 2069 6e20 7261 6e67 6528  _index in range(
-00043a20: 6e70 6172 7469 7469 6f6e 7320 2b20 3129  npartitions + 1)
-00043a30: 0a20 2020 2020 2020 205d 0a20 2020 2020  .        ].     
-00043a40: 2020 2072 6574 7572 6e20 5f72 6570 6172     return _repar
-00043a50: 7469 7469 6f6e 5f66 726f 6d5f 626f 756e  tition_from_boun
-00043a60: 6461 7269 6573 2864 662c 206e 6577 5f70  daries(df, new_p
-00043a70: 6172 7469 7469 6f6e 735f 626f 756e 6461  artitions_bounda
-00043a80: 7269 6573 2c20 6e65 775f 6e61 6d65 290a  ries, new_name).
-00043a90: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00043aa0: 2020 2320 4472 6f70 2064 7570 6c63 6174    # Drop duplcat
-00043ab0: 6573 2069 6e20 6361 7365 206c 6173 7420  es in case last 
-00043ac0: 7061 7274 6974 696f 6e20 6861 7320 7361  partition has sa
-00043ad0: 6d65 0a20 2020 2020 2020 2023 2076 616c  me.        # val
-00043ae0: 7565 2066 6f72 206d 696e 2061 6e64 206d  ue for min and m
-00043af0: 6178 2064 6976 6973 696f 6e0a 2020 2020  ax division.    
-00043b00: 2020 2020 6f72 6967 696e 616c 5f64 6976      original_div
-00043b10: 6973 696f 6e73 203d 2064 6976 6973 696f  isions = divisio
-00043b20: 6e73 203d 2070 642e 5365 7269 6573 2864  ns = pd.Series(d
-00043b30: 662e 6469 7669 7369 6f6e 7329 2e64 726f  f.divisions).dro
-00043b40: 705f 6475 706c 6963 6174 6573 2829 0a20  p_duplicates(). 
-00043b50: 2020 2020 2020 2069 6620 6466 2e6b 6e6f         if df.kno
-00043b60: 776e 5f64 6976 6973 696f 6e73 2061 6e64  wn_divisions and
-00043b70: 2028 0a20 2020 2020 2020 2020 2020 2069   (.            i
-00043b80: 735f 6461 7465 7469 6d65 3634 5f61 6e79  s_datetime64_any
-00043b90: 5f64 7479 7065 2864 6976 6973 696f 6e73  _dtype(divisions
-00043ba0: 2e64 7479 7065 290a 2020 2020 2020 2020  .dtype).        
-00043bb0: 2020 2020 6f72 2069 735f 6e75 6d65 7269      or is_numeri
-00043bc0: 635f 6474 7970 6528 6469 7669 7369 6f6e  c_dtype(division
-00043bd0: 732e 6474 7970 6529 0a20 2020 2020 2020  s.dtype).       
-00043be0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-00043bf0: 6966 2069 735f 6461 7465 7469 6d65 3634  if is_datetime64
-00043c00: 5f61 6e79 5f64 7479 7065 2864 6976 6973  _any_dtype(divis
-00043c10: 696f 6e73 2e64 7479 7065 293a 0a20 2020  ions.dtype):.   
-00043c20: 2020 2020 2020 2020 2020 2020 2064 6976               div
-00043c30: 6973 696f 6e73 203d 2064 6976 6973 696f  isions = divisio
-00043c40: 6e73 2e76 616c 7565 732e 6173 7479 7065  ns.values.astype
-00043c50: 2822 666c 6f61 7436 3422 290a 0a20 2020  ("float64")..   
-00043c60: 2020 2020 2020 2020 2069 6620 6973 5f73           if is_s
-00043c70: 6572 6965 735f 6c69 6b65 2864 6976 6973  eries_like(divis
-00043c80: 696f 6e73 293a 0a20 2020 2020 2020 2020  ions):.         
-00043c90: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
-00043ca0: 203d 2064 6976 6973 696f 6e73 2e76 616c   = divisions.val
-00043cb0: 7565 730a 0a20 2020 2020 2020 2020 2020  ues..           
-00043cc0: 206e 203d 206c 656e 2864 6976 6973 696f   n = len(divisio
-00043cd0: 6e73 290a 2020 2020 2020 2020 2020 2020  ns).            
-00043ce0: 6469 7669 7369 6f6e 7320 3d20 6e70 2e69  divisions = np.i
-00043cf0: 6e74 6572 7028 0a20 2020 2020 2020 2020  nterp(.         
-00043d00: 2020 2020 2020 2078 3d6e 702e 6c69 6e73         x=np.lins
-00043d10: 7061 6365 2830 2c20 6e2c 206e 7061 7274  pace(0, n, npart
-00043d20: 6974 696f 6e73 202b 2031 292c 0a20 2020  itions + 1),.   
-00043d30: 2020 2020 2020 2020 2020 2020 2078 703d               xp=
-00043d40: 6e70 2e6c 696e 7370 6163 6528 302c 206e  np.linspace(0, n
-00043d50: 2c20 6e29 2c0a 2020 2020 2020 2020 2020  , n),.          
-00043d60: 2020 2020 2020 6670 3d64 6976 6973 696f        fp=divisio
-00043d70: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
-00043d80: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00043d90: 2069 735f 6461 7465 7469 6d65 3634 5f61   is_datetime64_a
-00043da0: 6e79 5f64 7479 7065 286f 7269 6769 6e61  ny_dtype(origina
-00043db0: 6c5f 6469 7669 7369 6f6e 732e 6474 7970  l_divisions.dtyp
-00043dc0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-00043dd0: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
-00043de0: 6d65 7468 6f64 732e 746f 6c69 7374 280a  methods.tolist(.
-00043df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043e00: 2020 2020 7064 2e53 6572 6965 7328 6469      pd.Series(di
-00043e10: 7669 7369 6f6e 7329 2e61 7374 7970 6528  visions).astype(
-00043e20: 6f72 6967 696e 616c 5f64 6976 6973 696f  original_divisio
-00043e30: 6e73 2e64 7479 7065 290a 2020 2020 2020  ns.dtype).      
-00043e40: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00043e50: 2020 2020 2020 2020 656c 6966 206e 702e          elif np.
-00043e60: 6973 7375 6264 7479 7065 286f 7269 6769  issubdtype(origi
-00043e70: 6e61 6c5f 6469 7669 7369 6f6e 732e 6474  nal_divisions.dt
-00043e80: 7970 652c 206e 702e 696e 7465 6765 7229  ype, np.integer)
-00043e90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00043ea0: 2020 6469 7669 7369 6f6e 7320 3d20 6469    divisions = di
-00043eb0: 7669 7369 6f6e 732e 6173 7479 7065 286f  visions.astype(o
-00043ec0: 7269 6769 6e61 6c5f 6469 7669 7369 6f6e  riginal_division
-00043ed0: 732e 6474 7970 6529 0a0a 2020 2020 2020  s.dtype)..      
-00043ee0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00043ef0: 6e63 6528 6469 7669 7369 6f6e 732c 206e  nce(divisions, n
-00043f00: 702e 6e64 6172 7261 7929 3a0a 2020 2020  p.ndarray):.    
-00043f10: 2020 2020 2020 2020 2020 2020 6469 7669              divi
-00043f20: 7369 6f6e 7320 3d20 6469 7669 7369 6f6e  sions = division
-00043f30: 732e 746f 6c69 7374 2829 0a0a 2020 2020  s.tolist()..    
-00043f40: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
-00043f50: 7320 3d20 6c69 7374 2864 6976 6973 696f  s = list(divisio
-00043f60: 6e73 290a 2020 2020 2020 2020 2020 2020  ns).            
-00043f70: 6469 7669 7369 6f6e 735b 305d 203d 2064  divisions[0] = d
-00043f80: 662e 6469 7669 7369 6f6e 735b 305d 0a20  f.divisions[0]. 
-00043f90: 2020 2020 2020 2020 2020 2064 6976 6973             divis
-00043fa0: 696f 6e73 5b2d 315d 203d 2064 662e 6469  ions[-1] = df.di
-00043fb0: 7669 7369 6f6e 735b 2d31 5d0a 0a20 2020  visions[-1]..   
-00043fc0: 2020 2020 2020 2020 2023 2045 6e73 7572           # Ensur
-00043fd0: 6520 7468 6520 636f 6d70 7574 6564 2064  e the computed d
-00043fe0: 6976 6973 696f 6e73 2061 7265 2075 6e69  ivisions are uni
-00043ff0: 7175 650a 2020 2020 2020 2020 2020 2020  que.            
-00044000: 6469 7669 7369 6f6e 7320 3d20 6c69 7374  divisions = list
-00044010: 2875 6e69 7175 6528 6469 7669 7369 6f6e  (unique(division
-00044020: 735b 3a2d 315d 2929 202b 205b 6469 7669  s[:-1])) + [divi
-00044030: 7369 6f6e 735b 2d31 5d5d 0a20 2020 2020  sions[-1]].     
-00044040: 2020 2020 2020 2072 6574 7572 6e20 6466         return df
-00044050: 2e72 6570 6172 7469 7469 6f6e 2864 6976  .repartition(div
-00044060: 6973 696f 6e73 3d64 6976 6973 696f 6e73  isions=divisions
-00044070: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00044080: 2020 2020 2020 2020 2020 2020 6469 762c              div,
-00044090: 206d 6f64 203d 2064 6976 6d6f 6428 6e70   mod = divmod(np
-000440a0: 6172 7469 7469 6f6e 732c 2064 662e 6e70  artitions, df.np
-000440b0: 6172 7469 7469 6f6e 7329 0a20 2020 2020  artitions).     
-000440c0: 2020 2020 2020 206e 7370 6c69 7473 203d         nsplits =
-000440d0: 205b 6469 765d 202a 2064 662e 6e70 6172   [div] * df.npar
-000440e0: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
-000440f0: 2020 2020 6e73 706c 6974 735b 2d31 5d20      nsplits[-1] 
-00044100: 2b3d 206d 6f64 0a20 2020 2020 2020 2020  += mod.         
-00044110: 2020 2072 6574 7572 6e20 5f73 706c 6974     return _split
-00044120: 5f70 6172 7469 7469 6f6e 7328 6466 2c20  _partitions(df, 
-00044130: 6e73 706c 6974 732c 206e 6577 5f6e 616d  nsplits, new_nam
-00044140: 6529 0a0a 0a64 6566 205f 7265 7061 7274  e)...def _repart
-00044150: 6974 696f 6e5f 6672 6f6d 5f62 6f75 6e64  ition_from_bound
-00044160: 6172 6965 7328 6466 2c20 6e65 775f 7061  aries(df, new_pa
-00044170: 7274 6974 696f 6e73 5f62 6f75 6e64 6172  rtitions_boundar
-00044180: 6965 732c 206e 6577 5f6e 616d 6529 3a0a  ies, new_name):.
-00044190: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-000441a0: 7461 6e63 6528 6e65 775f 7061 7274 6974  tance(new_partit
-000441b0: 696f 6e73 5f62 6f75 6e64 6172 6965 732c  ions_boundaries,
-000441c0: 206c 6973 7429 3a0a 2020 2020 2020 2020   list):.        
-000441d0: 6e65 775f 7061 7274 6974 696f 6e73 5f62  new_partitions_b
-000441e0: 6f75 6e64 6172 6965 7320 3d20 6c69 7374  oundaries = list
-000441f0: 286e 6577 5f70 6172 7469 7469 6f6e 735f  (new_partitions_
-00044200: 626f 756e 6461 7269 6573 290a 2020 2020  boundaries).    
-00044210: 6966 206e 6577 5f70 6172 7469 7469 6f6e  if new_partition
-00044220: 735f 626f 756e 6461 7269 6573 5b30 5d20  s_boundaries[0] 
-00044230: 3e20 303a 0a20 2020 2020 2020 206e 6577  > 0:.        new
-00044240: 5f70 6172 7469 7469 6f6e 735f 626f 756e  _partitions_boun
-00044250: 6461 7269 6573 2e69 6e73 6572 7428 302c  daries.insert(0,
-00044260: 2030 290a 2020 2020 6966 206e 6577 5f70   0).    if new_p
-00044270: 6172 7469 7469 6f6e 735f 626f 756e 6461  artitions_bounda
-00044280: 7269 6573 5b2d 315d 203c 2064 662e 6e70  ries[-1] < df.np
-00044290: 6172 7469 7469 6f6e 733a 0a20 2020 2020  artitions:.     
-000442a0: 2020 206e 6577 5f70 6172 7469 7469 6f6e     new_partition
-000442b0: 735f 626f 756e 6461 7269 6573 2e61 7070  s_boundaries.app
-000442c0: 656e 6428 6466 2e6e 7061 7274 6974 696f  end(df.npartitio
-000442d0: 6e73 290a 2020 2020 6473 6b20 3d20 7b7d  ns).    dsk = {}
-000442e0: 0a20 2020 2066 6f72 2069 2c20 2873 7461  .    for i, (sta
-000442f0: 7274 2c20 656e 6429 2069 6e20 656e 756d  rt, end) in enum
-00044300: 6572 6174 6528 0a20 2020 2020 2020 207a  erate(.        z
-00044310: 6970 286e 6577 5f70 6172 7469 7469 6f6e  ip(new_partition
-00044320: 735f 626f 756e 6461 7269 6573 2c20 6e65  s_boundaries, ne
-00044330: 775f 7061 7274 6974 696f 6e73 5f62 6f75  w_partitions_bou
-00044340: 6e64 6172 6965 735b 313a 5d29 0a20 2020  ndaries[1:]).   
-00044350: 2029 3a0a 2020 2020 2020 2020 6473 6b5b   ):.        dsk[
-00044360: 6e65 775f 6e61 6d65 2c20 695d 203d 2028  new_name, i] = (
-00044370: 6d65 7468 6f64 732e 636f 6e63 6174 2c20  methods.concat, 
-00044380: 5b28 6466 2e5f 6e61 6d65 2c20 6a29 2066  [(df._name, j) f
-00044390: 6f72 206a 2069 6e20 7261 6e67 6528 7374  or j in range(st
-000443a0: 6172 742c 2065 6e64 295d 290a 2020 2020  art, end)]).    
-000443b0: 6469 7669 7369 6f6e 7320 3d20 5b64 662e  divisions = [df.
-000443c0: 6469 7669 7369 6f6e 735b 695d 2066 6f72  divisions[i] for
-000443d0: 2069 2069 6e20 6e65 775f 7061 7274 6974   i in new_partit
-000443e0: 696f 6e73 5f62 6f75 6e64 6172 6965 735d  ions_boundaries]
-000443f0: 0a20 2020 2067 7261 7068 203d 2048 6967  .    graph = Hig
-00044400: 684c 6576 656c 4772 6170 682e 6672 6f6d  hLevelGraph.from
-00044410: 5f63 6f6c 6c65 6374 696f 6e73 286e 6577  _collections(new
-00044420: 5f6e 616d 652c 2064 736b 2c20 6465 7065  _name, dsk, depe
-00044430: 6e64 656e 6369 6573 3d5b 6466 5d29 0a20  ndencies=[df]). 
-00044440: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
-00044450: 5f6f 626a 6563 7428 6772 6170 682c 206e  _object(graph, n
-00044460: 6577 5f6e 616d 652c 2064 662e 5f6d 6574  ew_name, df._met
-00044470: 612c 2064 6976 6973 696f 6e73 290a 0a0a  a, divisions)...
-00044480: 6465 6620 5f73 706c 6974 5f70 6172 7469  def _split_parti
-00044490: 7469 6f6e 7328 6466 2c20 6e73 706c 6974  tions(df, nsplit
-000444a0: 732c 206e 6577 5f6e 616d 6529 3a0a 2020  s, new_name):.  
-000444b0: 2020 2222 2253 706c 6974 2061 2044 6173    """Split a Das
-000444c0: 6b20 6461 7461 6672 616d 6520 696e 746f  k dataframe into
-000444d0: 206e 6577 2070 6172 7469 7469 6f6e 730a   new partitions.
-000444e0: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
-000444f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00044500: 2020 2064 663a 2044 6174 6146 7261 6d65     df: DataFrame
-00044510: 206f 7220 5365 7269 6573 0a20 2020 206e   or Series.    n
-00044520: 7370 6c69 7473 3a20 4c69 7374 5b69 6e74  splits: List[int
-00044530: 5d0a 2020 2020 2020 2020 4e75 6d62 6572  ].        Number
-00044540: 206f 6620 7461 7267 6574 2064 6174 6166   of target dataf
-00044550: 7261 6d65 7320 666f 7220 6561 6368 2070  rames for each p
-00044560: 6172 7469 7469 6f6e 0a20 2020 2020 2020  artition.       
-00044570: 2054 6865 206c 656e 6774 6820 6f66 206e   The length of n
-00044580: 7370 6c69 7473 2073 686f 756c 6420 6265  splits should be
-00044590: 2074 6865 2073 616d 6520 6173 2064 662e   the same as df.
-000445a0: 6e70 6172 7469 7469 6f6e 730a 2020 2020  npartitions.    
-000445b0: 6e65 775f 6e61 6d65 3a20 7374 720a 0a20  new_name: str.. 
-000445c0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
-000445d0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2072 6570  --------.    rep
-000445e0: 6172 7469 7469 6f6e 5f6e 7061 7274 6974  artition_npartit
-000445f0: 696f 6e73 0a20 2020 2072 6570 6172 7469  ions.    reparti
-00044600: 7469 6f6e 5f73 697a 650a 2020 2020 2222  tion_size.    ""
-00044610: 220a 2020 2020 6966 206c 656e 286e 7370  ".    if len(nsp
-00044620: 6c69 7473 2920 213d 2064 662e 6e70 6172  lits) != df.npar
-00044630: 7469 7469 6f6e 733a 0a20 2020 2020 2020  titions:.       
-00044640: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00044650: 7228 6622 6e73 706c 6974 7320 7368 6f75  r(f"nsplits shou
-00044660: 6c64 2068 6176 6520 6c65 6e3d 7b64 662e  ld have len={df.
-00044670: 6e70 6172 7469 7469 6f6e 737d 2229 0a0a  npartitions}")..
-00044680: 2020 2020 6473 6b20 3d20 7b7d 0a20 2020      dsk = {}.   
-00044690: 2073 706c 6974 5f6e 616d 6520 3d20 6622   split_name = f"
-000446a0: 7370 6c69 742d 7b74 6f6b 656e 697a 6528  split-{tokenize(
-000446b0: 6466 2c20 6e73 706c 6974 7329 7d22 0a20  df, nsplits)}". 
-000446c0: 2020 206a 203d 2030 0a20 2020 2066 6f72     j = 0.    for
-000446d0: 2069 2c20 6b20 696e 2065 6e75 6d65 7261   i, k in enumera
-000446e0: 7465 286e 7370 6c69 7473 293a 0a20 2020  te(nsplits):.   
-000446f0: 2020 2020 2069 6620 6b20 3d3d 2031 3a0a       if k == 1:.
-00044700: 2020 2020 2020 2020 2020 2020 6473 6b5b              dsk[
-00044710: 6e65 775f 6e61 6d65 2c20 6a5d 203d 2028  new_name, j] = (
-00044720: 6466 2e5f 6e61 6d65 2c20 6929 0a20 2020  df._name, i).   
-00044730: 2020 2020 2020 2020 206a 202b 3d20 310a           j += 1.
-00044740: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00044750: 2020 2020 2020 2020 2020 6473 6b5b 7370            dsk[sp
-00044760: 6c69 745f 6e61 6d65 2c20 695d 203d 2028  lit_name, i] = (
-00044770: 7370 6c69 745f 6576 656e 6c79 2c20 2864  split_evenly, (d
-00044780: 662e 5f6e 616d 652c 2069 292c 206b 290a  f._name, i), k).
-00044790: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000447a0: 6a6a 2069 6e20 7261 6e67 6528 6b29 3a0a  jj in range(k):.
-000447b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000447c0: 6473 6b5b 6e65 775f 6e61 6d65 2c20 6a5d  dsk[new_name, j]
-000447d0: 203d 2028 6765 7469 7465 6d2c 2028 7370   = (getitem, (sp
-000447e0: 6c69 745f 6e61 6d65 2c20 6929 2c20 6a6a  lit_name, i), jj
-000447f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00044800: 2020 6a20 2b3d 2031 0a0a 2020 2020 6469    j += 1..    di
-00044810: 7669 7369 6f6e 7320 3d20 5b4e 6f6e 655d  visions = [None]
-00044820: 202a 2028 3120 2b20 7375 6d28 6e73 706c   * (1 + sum(nspl
-00044830: 6974 7329 290a 2020 2020 6772 6170 6820  its)).    graph 
-00044840: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
-00044850: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
-00044860: 7328 6e65 775f 6e61 6d65 2c20 6473 6b2c  s(new_name, dsk,
-00044870: 2064 6570 656e 6465 6e63 6965 733d 5b64   dependencies=[d
-00044880: 665d 290a 2020 2020 7265 7475 726e 206e  f]).    return n
-00044890: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
-000448a0: 7068 2c20 6e65 775f 6e61 6d65 2c20 6466  ph, new_name, df
-000448b0: 2e5f 6d65 7461 2c20 6469 7669 7369 6f6e  ._meta, division
-000448c0: 7329 0a0a 0a64 6566 2072 6570 6172 7469  s)...def reparti
-000448d0: 7469 6f6e 2864 662c 2064 6976 6973 696f  tion(df, divisio
-000448e0: 6e73 3d4e 6f6e 652c 2066 6f72 6365 3d46  ns=None, force=F
-000448f0: 616c 7365 293a 0a20 2020 2022 2222 5265  alse):.    """Re
-00044900: 7061 7274 6974 696f 6e20 6461 7461 6672  partition datafr
-00044910: 616d 6520 616c 6f6e 6720 6e65 7720 6469  ame along new di
-00044920: 7669 7369 6f6e 730a 0a20 2020 2044 6173  visions..    Das
-00044930: 6b2e 4461 7461 4672 616d 6520 6f62 6a65  k.DataFrame obje
-00044940: 6374 7320 6172 6520 7061 7274 6974 696f  cts are partitio
-00044950: 6e65 6420 616c 6f6e 6720 7468 6569 7220  ned along their 
-00044960: 696e 6465 782e 2020 4f66 7465 6e20 7768  index.  Often wh
-00044970: 656e 0a20 2020 206d 756c 7469 706c 6520  en.    multiple 
-00044980: 6461 7461 6672 616d 6573 2069 6e74 6572  dataframes inter
-00044990: 6163 7420 7765 206e 6565 6420 746f 2061  act we need to a
-000449a0: 6c69 676e 2074 6865 7365 2070 6172 7469  lign these parti
-000449b0: 7469 6f6e 696e 6773 2e20 2054 6865 0a20  tionings.  The. 
-000449c0: 2020 2060 6072 6570 6172 7469 7469 6f6e     ``repartition
-000449d0: 6060 2066 756e 6374 696f 6e20 636f 6e73  `` function cons
-000449e0: 7472 7563 7473 2061 206e 6577 2044 6174  tructs a new Dat
-000449f0: 6146 7261 6d65 206f 626a 6563 7420 686f  aFrame object ho
-00044a00: 6c64 696e 6720 7468 6520 7361 6d65 0a20  lding the same. 
-00044a10: 2020 2064 6174 6120 6275 7420 7061 7274     data but part
-00044a20: 6974 696f 6e65 6420 6f6e 2064 6966 6665  itioned on diffe
-00044a30: 7265 6e74 2076 616c 7565 732e 2020 4974  rent values.  It
-00044a40: 2064 6f65 7320 7468 6973 2062 7920 7065   does this by pe
-00044a50: 7266 6f72 6d69 6e67 2061 0a20 2020 2073  rforming a.    s
-00044a60: 6571 7565 6e63 6520 6f66 2060 606c 6f63  equence of ``loc
-00044a70: 6060 2061 6e64 2060 6063 6f6e 6361 7460  `` and ``concat`
-00044a80: 6020 6361 6c6c 7320 746f 2073 706c 6974  ` calls to split
-00044a90: 2061 6e64 206d 6572 6765 2074 6865 2070   and merge the p
-00044aa0: 7265 7669 6f75 730a 2020 2020 6765 6e65  revious.    gene
-00044ab0: 7261 7469 6f6e 206f 6620 7061 7274 6974  ration of partit
-00044ac0: 696f 6e73 2e0a 0a20 2020 2050 6172 616d  ions...    Param
-00044ad0: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
-00044ae0: 2d2d 2d2d 0a0a 2020 2020 6469 7669 7369  ----..    divisi
-00044af0: 6f6e 7320 3a20 6c69 7374 0a20 2020 2020  ons : list.     
-00044b00: 2020 204c 6973 7420 6f66 2070 6172 7469     List of parti
-00044b10: 7469 6f6e 7320 746f 2062 6520 7573 6564  tions to be used
-00044b20: 0a20 2020 2066 6f72 6365 203a 2062 6f6f  .    force : boo
-00044b30: 6c2c 2064 6566 6175 6c74 2046 616c 7365  l, default False
-00044b40: 0a20 2020 2020 2020 2041 6c6c 6f77 7320  .        Allows 
-00044b50: 7468 6520 6578 7061 6e73 696f 6e20 6f66  the expansion of
-00044b60: 2074 6865 2065 7869 7374 696e 6720 6469   the existing di
-00044b70: 7669 7369 6f6e 732e 0a20 2020 2020 2020  visions..       
-00044b80: 2049 6620 4661 6c73 6520 7468 656e 2074   If False then t
-00044b90: 6865 206e 6577 2064 6976 6973 696f 6e73  he new divisions
-00044ba0: 206c 6f77 6572 2061 6e64 2075 7070 6572   lower and upper
-00044bb0: 2062 6f75 6e64 7320 6d75 7374 2062 650a   bounds must be.
-00044bc0: 2020 2020 2020 2020 7468 6520 7361 6d65          the same
-00044bd0: 2061 7320 7468 6520 6f6c 6420 6469 7669   as the old divi
-00044be0: 7369 6f6e 732e 0a0a 2020 2020 4578 616d  sions...    Exam
-00044bf0: 706c 6573 0a20 2020 202d 2d2d 2d2d 2d2d  ples.    -------
-00044c00: 2d0a 0a20 2020 203e 3e3e 2064 6620 3d20  -..    >>> df = 
-00044c10: 6466 2e72 6570 6172 7469 7469 6f6e 285b  df.repartition([
-00044c20: 302c 2035 2c20 3130 2c20 3230 5d29 2020  0, 5, 10, 20])  
-00044c30: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
-00044c40: 0a0a 2020 2020 416c 736f 2077 6f72 6b73  ..    Also works
-00044c50: 206f 6e20 5061 6e64 6173 206f 626a 6563   on Pandas objec
-00044c60: 7473 0a0a 2020 2020 3e3e 3e20 6464 6620  ts..    >>> ddf 
-00044c70: 3d20 6464 2e72 6570 6172 7469 7469 6f6e  = dd.repartition
-00044c80: 2864 662c 205b 302c 2035 2c20 3130 2c20  (df, [0, 5, 10, 
-00044c90: 3230 5d29 2020 2320 646f 6374 6573 743a  20])  # doctest:
-00044ca0: 202b 534b 4950 0a20 2020 2022 2222 0a0a   +SKIP.    """..
-00044cb0: 2020 2020 2320 6e6f 2d6f 7020 6661 7374      # no-op fast
-00044cc0: 7061 7468 2066 6f72 2077 6865 6e20 7765  path for when we
-00044cd0: 2061 6c72 6561 6479 2068 6176 6520 6d61   already have ma
-00044ce0: 7463 6869 6e67 2064 6976 6973 696f 6e73  tching divisions
-00044cf0: 0a20 2020 2069 6620 6973 5f64 6173 6b5f  .    if is_dask_
-00044d00: 636f 6c6c 6563 7469 6f6e 2864 6629 2061  collection(df) a
-00044d10: 6e64 2064 662e 6469 7669 7369 6f6e 7320  nd df.divisions 
-00044d20: 3d3d 2064 6976 6973 696f 6e73 3a0a 2020  == divisions:.  
-00044d30: 2020 2020 2020 7265 7475 726e 2064 660a        return df.
-00044d40: 0a20 2020 2074 6f6b 656e 203d 2074 6f6b  .    token = tok
-00044d50: 656e 697a 6528 6466 2c20 6469 7669 7369  enize(df, divisi
-00044d60: 6f6e 7329 0a20 2020 2069 6620 6973 696e  ons).    if isin
-00044d70: 7374 616e 6365 2864 662c 205f 4672 616d  stance(df, _Fram
-00044d80: 6529 3a0a 2020 2020 2020 2020 746d 7020  e):.        tmp 
-00044d90: 3d20 2272 6570 6172 7469 7469 6f6e 2d73  = "repartition-s
-00044da0: 706c 6974 2d22 202b 2074 6f6b 656e 0a20  plit-" + token. 
-00044db0: 2020 2020 2020 206f 7574 203d 2022 7265         out = "re
-00044dc0: 7061 7274 6974 696f 6e2d 6d65 7267 652d  partition-merge-
-00044dd0: 2220 2b20 746f 6b65 6e0a 2020 2020 2020  " + token.      
-00044de0: 2020 6473 6b20 3d20 7265 7061 7274 6974    dsk = repartit
-00044df0: 696f 6e5f 6469 7669 7369 6f6e 7328 0a20  ion_divisions(. 
-00044e00: 2020 2020 2020 2020 2020 2064 662e 6469             df.di
-00044e10: 7669 7369 6f6e 732c 2064 6976 6973 696f  visions, divisio
-00044e20: 6e73 2c20 6466 2e5f 6e61 6d65 2c20 746d  ns, df._name, tm
-00044e30: 702c 206f 7574 2c20 666f 7263 653d 666f  p, out, force=fo
-00044e40: 7263 650a 2020 2020 2020 2020 290a 2020  rce.        ).  
-00044e50: 2020 2020 2020 6772 6170 6820 3d20 4869        graph = Hi
-00044e60: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
-00044e70: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6f75  m_collections(ou
-00044e80: 742c 2064 736b 2c20 6465 7065 6e64 656e  t, dsk, dependen
-00044e90: 6369 6573 3d5b 6466 5d29 0a20 2020 2020  cies=[df]).     
-00044ea0: 2020 2072 6574 7572 6e20 6e65 775f 6464     return new_dd
-00044eb0: 5f6f 626a 6563 7428 6772 6170 682c 206f  _object(graph, o
-00044ec0: 7574 2c20 6466 2e5f 6d65 7461 2c20 6469  ut, df._meta, di
-00044ed0: 7669 7369 6f6e 7329 0a20 2020 2065 6c69  visions).    eli
-00044ee0: 6620 6973 5f64 6174 6166 7261 6d65 5f6c  f is_dataframe_l
-00044ef0: 696b 6528 6466 2920 6f72 2069 735f 7365  ike(df) or is_se
-00044f00: 7269 6573 5f6c 696b 6528 6466 293a 0a20  ries_like(df):. 
-00044f10: 2020 2020 2020 206e 616d 6520 3d20 2272         name = "r
-00044f20: 6570 6172 7469 7469 6f6e 2d64 6174 6166  epartition-dataf
-00044f30: 7261 6d65 2d22 202b 2074 6f6b 656e 0a20  rame-" + token. 
-00044f40: 2020 2020 2020 2066 726f 6d20 6461 736b         from dask
-00044f50: 2e64 6174 6166 7261 6d65 2e75 7469 6c73  .dataframe.utils
-00044f60: 2069 6d70 6f72 7420 7368 6172 645f 6466   import shard_df
-00044f70: 5f6f 6e5f 696e 6465 780a 0a20 2020 2020  _on_index..     
-00044f80: 2020 2064 6673 203d 2073 6861 7264 5f64     dfs = shard_d
-00044f90: 665f 6f6e 5f69 6e64 6578 2864 662c 2064  f_on_index(df, d
-00044fa0: 6976 6973 696f 6e73 5b31 3a2d 315d 290a  ivisions[1:-1]).
-00044fb0: 2020 2020 2020 2020 6473 6b20 3d20 7b28          dsk = {(
-00044fc0: 6e61 6d65 2c20 6929 3a20 6466 2066 6f72  name, i): df for
-00044fd0: 2069 2c20 6466 2069 6e20 656e 756d 6572   i, df in enumer
-00044fe0: 6174 6528 6466 7329 7d0a 2020 2020 2020  ate(dfs)}.      
-00044ff0: 2020 7265 7475 726e 206e 6577 5f64 645f    return new_dd_
-00045000: 6f62 6a65 6374 2864 736b 2c20 6e61 6d65  object(dsk, name
-00045010: 2c20 6466 2c20 6469 7669 7369 6f6e 7329  , df, divisions)
-00045020: 0a20 2020 2072 6169 7365 2056 616c 7565  .    raise Value
-00045030: 4572 726f 7228 2244 6174 6120 6d75 7374  Error("Data must
-00045040: 2062 6520 4461 7461 4672 616d 6520 6f72   be DataFrame or
-00045050: 2053 6572 6965 7322 290a 0a0a 6465 6620   Series")...def 
-00045060: 5f72 6564 7563 7469 6f6e 5f63 6875 6e6b  _reduction_chunk
-00045070: 2878 2c20 6163 615f 6368 756e 6b3d 4e6f  (x, aca_chunk=No
-00045080: 6e65 2c20 2a2a 6b77 6172 6773 293a 0a20  ne, **kwargs):. 
-00045090: 2020 206f 203d 2061 6361 5f63 6875 6e6b     o = aca_chunk
-000450a0: 2878 2c20 2a2a 6b77 6172 6773 290a 2020  (x, **kwargs).  
-000450b0: 2020 2320 5265 7475 726e 2061 2064 6174    # Return a dat
-000450c0: 6166 7261 6d65 2073 6f20 7468 6174 2074  aframe so that t
-000450d0: 6865 2063 6f6e 6361 7465 6e61 7465 6420  he concatenated 
-000450e0: 7665 7273 696f 6e20 6973 2061 6c73 6f20  version is also 
-000450f0: 6120 6461 7461 6672 616d 650a 2020 2020  a dataframe.    
-00045100: 6966 206e 6f74 2069 735f 7365 7269 6573  if not is_series
-00045110: 5f6c 696b 6528 6f29 3a0a 2020 2020 2020  _like(o):.      
-00045120: 2020 7265 7475 726e 206f 0a20 2020 2072    return o.    r
-00045130: 6573 756c 7420 3d20 6f2e 746f 5f66 7261  esult = o.to_fra
-00045140: 6d65 2829 2e54 0a20 2020 2069 6620 6f2e  me().T.    if o.
-00045150: 6474 7970 652e 6b69 6e64 203d 3d20 224f  dtype.kind == "O
-00045160: 223a 0a20 2020 2020 2020 2023 2057 6173  ":.        # Was
-00045170: 2063 6f65 7263 6564 2074 6f20 6f62 6a65   coerced to obje
-00045180: 6374 2c20 736f 2063 6173 7420 6261 636b  ct, so cast back
-00045190: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000451a0: 7265 7375 6c74 2e69 6e66 6572 5f6f 626a  result.infer_obj
-000451b0: 6563 7473 2829 0a20 2020 2072 6574 7572  ects().    retur
-000451c0: 6e20 7265 7375 6c74 0a0a 0a64 6566 205f  n result...def _
-000451d0: 7265 6475 6374 696f 6e5f 636f 6d62 696e  reduction_combin
-000451e0: 6528 782c 2061 6361 5f63 6f6d 6269 6e65  e(x, aca_combine
-000451f0: 3d4e 6f6e 652c 202a 2a6b 7761 7267 7329  =None, **kwargs)
-00045200: 3a0a 2020 2020 6966 2069 7369 6e73 7461  :.    if isinsta
-00045210: 6e63 6528 782c 206c 6973 7429 3a0a 2020  nce(x, list):.  
-00045220: 2020 2020 2020 7820 3d20 7064 2e53 6572        x = pd.Ser
-00045230: 6965 7328 7829 0a20 2020 206f 203d 2061  ies(x).    o = a
-00045240: 6361 5f63 6f6d 6269 6e65 2878 2c20 2a2a  ca_combine(x, **
-00045250: 6b77 6172 6773 290a 2020 2020 2320 5265  kwargs).    # Re
-00045260: 7475 726e 2061 2064 6174 6166 7261 6d65  turn a dataframe
-00045270: 2073 6f20 7468 6174 2074 6865 2063 6f6e   so that the con
-00045280: 6361 7465 6e61 7465 6420 7665 7273 696f  catenated versio
-00045290: 6e20 6973 2061 6c73 6f20 6120 6461 7461  n is also a data
-000452a0: 6672 616d 650a 2020 2020 7265 7475 726e  frame.    return
-000452b0: 206f 2e74 6f5f 6672 616d 6528 292e 5420   o.to_frame().T 
-000452c0: 6966 2069 735f 7365 7269 6573 5f6c 696b  if is_series_lik
-000452d0: 6528 6f29 2065 6c73 6520 6f0a 0a0a 6465  e(o) else o...de
-000452e0: 6620 5f72 6564 7563 7469 6f6e 5f61 6767  f _reduction_agg
-000452f0: 7265 6761 7465 2878 2c20 6163 615f 6167  regate(x, aca_ag
-00045300: 6772 6567 6174 653d 4e6f 6e65 2c20 2a2a  gregate=None, **
-00045310: 6b77 6172 6773 293a 0a20 2020 2069 6620  kwargs):.    if 
-00045320: 6973 696e 7374 616e 6365 2878 2c20 6c69  isinstance(x, li
-00045330: 7374 293a 0a20 2020 2020 2020 2078 203d  st):.        x =
-00045340: 2070 642e 5365 7269 6573 2878 290a 2020   pd.Series(x).  
-00045350: 2020 7265 7475 726e 2061 6361 5f61 6767    return aca_agg
-00045360: 7265 6761 7465 2878 2c20 2a2a 6b77 6172  regate(x, **kwar
-00045370: 6773 290a 0a0a 6465 6620 6964 786d 6178  gs)...def idxmax
-00045380: 6d69 6e5f 6368 756e 6b28 782c 2066 6e3d  min_chunk(x, fn=
-00045390: 4e6f 6e65 2c20 736b 6970 6e61 3d54 7275  None, skipna=Tru
-000453a0: 652c 206e 756d 6572 6963 5f6f 6e6c 793d  e, numeric_only=
-000453b0: 4661 6c73 6529 3a0a 2020 2020 6e75 6d65  False):.    nume
-000453c0: 7269 635f 6f6e 6c79 5f6b 7761 7267 7320  ric_only_kwargs 
-000453d0: 3d20 280a 2020 2020 2020 2020 7b7d 2069  = (.        {} i
-000453e0: 6620 6e6f 7420 5041 4e44 4153 5f47 545f  f not PANDAS_GT_
-000453f0: 3135 3020 6f72 2069 735f 7365 7269 6573  150 or is_series
-00045400: 5f6c 696b 6528 7829 2065 6c73 6520 7b22  _like(x) else {"
-00045410: 6e75 6d65 7269 635f 6f6e 6c79 223a 206e  numeric_only": n
-00045420: 756d 6572 6963 5f6f 6e6c 797d 0a20 2020  umeric_only}.   
-00045430: 2029 0a20 2020 206d 696e 6d61 7820 3d20   ).    minmax = 
-00045440: 226d 6178 2220 6966 2066 6e20 3d3d 2022  "max" if fn == "
-00045450: 6964 786d 6178 2220 656c 7365 2022 6d69  idxmax" else "mi
-00045460: 6e22 0a20 2020 2069 6620 6c65 6e28 7829  n".    if len(x)
-00045470: 203e 2030 3a0a 2020 2020 2020 2020 6964   > 0:.        id
-00045480: 7820 3d20 6765 7461 7474 7228 782c 2066  x = getattr(x, f
-00045490: 6e29 2873 6b69 706e 613d 736b 6970 6e61  n)(skipna=skipna
-000454a0: 2c20 2a2a 6e75 6d65 7269 635f 6f6e 6c79  , **numeric_only
-000454b0: 5f6b 7761 7267 7329 0a20 2020 2020 2020  _kwargs).       
-000454c0: 2076 616c 7565 203d 2067 6574 6174 7472   value = getattr
-000454d0: 2878 2c20 6d69 6e6d 6178 2928 736b 6970  (x, minmax)(skip
-000454e0: 6e61 3d73 6b69 706e 612c 202a 2a6e 756d  na=skipna, **num
-000454f0: 6572 6963 5f6f 6e6c 795f 6b77 6172 6773  eric_only_kwargs
-00045500: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
-00045510: 2020 2020 6964 7820 3d20 7661 6c75 6520      idx = value 
-00045520: 3d20 6d65 7461 5f73 6572 6965 735f 636f  = meta_series_co
-00045530: 6e73 7472 7563 746f 7228 7829 285b 5d2c  nstructor(x)([],
-00045540: 2064 7479 7065 3d22 6938 2229 0a20 2020   dtype="i8").   
-00045550: 2069 6620 6973 5f73 6572 6965 735f 6c69   if is_series_li
-00045560: 6b65 2869 6478 293a 0a20 2020 2020 2020  ke(idx):.       
-00045570: 2072 6574 7572 6e20 6d65 7461 5f66 7261   return meta_fra
-00045580: 6d65 5f63 6f6e 7374 7275 6374 6f72 2878  me_constructor(x
-00045590: 2928 7b22 6964 7822 3a20 6964 782c 2022  )({"idx": idx, "
-000455a0: 7661 6c75 6522 3a20 7661 6c75 657d 290a  value": value}).
-000455b0: 2020 2020 7265 7475 726e 206d 6574 615f      return meta_
-000455c0: 6672 616d 655f 636f 6e73 7472 7563 746f  frame_constructo
-000455d0: 7228 7829 287b 2269 6478 223a 205b 6964  r(x)({"idx": [id
-000455e0: 785d 2c20 2276 616c 7565 223a 205b 7661  x], "value": [va
-000455f0: 6c75 655d 7d29 0a0a 0a64 6566 2069 6478  lue]})...def idx
-00045600: 6d61 786d 696e 5f72 6f77 2878 2c20 666e  maxmin_row(x, fn
-00045610: 3d4e 6f6e 652c 2073 6b69 706e 613d 5472  =None, skipna=Tr
-00045620: 7565 293a 0a20 2020 206d 696e 6d61 7820  ue):.    minmax 
-00045630: 3d20 226d 6178 2220 6966 2066 6e20 3d3d  = "max" if fn ==
-00045640: 2022 6964 786d 6178 2220 656c 7365 2022   "idxmax" else "
-00045650: 6d69 6e22 0a20 2020 2069 6620 6c65 6e28  min".    if len(
-00045660: 7829 203e 2030 3a0a 2020 2020 2020 2020  x) > 0:.        
-00045670: 7820 3d20 782e 7365 745f 696e 6465 7828  x = x.set_index(
-00045680: 2269 6478 2229 0a20 2020 2020 2020 2023  "idx").        #
-00045690: 2070 6f74 656e 7469 616c 6c79 2063 6f65   potentially coe
-000456a0: 7263 6564 2074 6f20 6f62 6a65 6374 2c20  rced to object, 
-000456b0: 736f 2063 6173 7420 6261 636b 0a20 2020  so cast back.   
-000456c0: 2020 2020 2076 616c 7565 203d 2078 2e76       value = x.v
-000456d0: 616c 7565 2e69 6e66 6572 5f6f 626a 6563  alue.infer_objec
-000456e0: 7473 2829 0a20 2020 2020 2020 2069 6478  ts().        idx
-000456f0: 203d 205b 6765 7461 7474 7228 7661 6c75   = [getattr(valu
-00045700: 652c 2066 6e29 2873 6b69 706e 613d 736b  e, fn)(skipna=sk
-00045710: 6970 6e61 295d 0a20 2020 2020 2020 2076  ipna)].        v
-00045720: 616c 7565 203d 205b 6765 7461 7474 7228  alue = [getattr(
-00045730: 7661 6c75 652c 206d 696e 6d61 7829 2873  value, minmax)(s
-00045740: 6b69 706e 613d 736b 6970 6e61 295d 0a20  kipna=skipna)]. 
-00045750: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00045760: 2069 6478 203d 2076 616c 7565 203d 206d   idx = value = m
-00045770: 6574 615f 7365 7269 6573 5f63 6f6e 7374  eta_series_const
-00045780: 7275 6374 6f72 2878 2928 5b5d 2c20 6474  ructor(x)([], dt
-00045790: 7970 653d 2269 3822 290a 2020 2020 7265  ype="i8").    re
-000457a0: 7475 726e 206d 6574 615f 6672 616d 655f  turn meta_frame_
-000457b0: 636f 6e73 7472 7563 746f 7228 7829 280a  constructor(x)(.
-000457c0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-000457d0: 2020 2020 2020 2269 6478 223a 206d 6574        "idx": met
-000457e0: 615f 7365 7269 6573 5f63 6f6e 7374 7275  a_series_constru
-000457f0: 6374 6f72 2878 2928 6964 782c 2064 7479  ctor(x)(idx, dty
-00045800: 7065 3d78 2e69 6e64 6578 2e64 7479 7065  pe=x.index.dtype
-00045810: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-00045820: 7661 6c75 6522 3a20 6d65 7461 5f73 6572  value": meta_ser
-00045830: 6965 735f 636f 6e73 7472 7563 746f 7228  ies_constructor(
-00045840: 7829 2876 616c 7565 2c20 6474 7970 653d  x)(value, dtype=
-00045850: 782e 6474 7970 6573 2e69 6c6f 635b 305d  x.dtypes.iloc[0]
-00045860: 292c 0a20 2020 2020 2020 207d 0a20 2020  ),.        }.   
-00045870: 2029 0a0a 0a64 6566 2069 6478 6d61 786d   )...def idxmaxm
-00045880: 696e 5f63 6f6d 6269 6e65 2878 2c20 666e  in_combine(x, fn
-00045890: 3d4e 6f6e 652c 2073 6b69 706e 613d 5472  =None, skipna=Tr
-000458a0: 7565 293a 0a20 2020 2069 6620 6c65 6e28  ue):.    if len(
-000458b0: 7829 203c 3d20 313a 0a20 2020 2020 2020  x) <= 1:.       
-000458c0: 2072 6574 7572 6e20 780a 2020 2020 7265   return x.    re
-000458d0: 7475 726e 2028 0a20 2020 2020 2020 2078  turn (.        x
-000458e0: 2e67 726f 7570 6279 286c 6576 656c 3d30  .groupby(level=0
-000458f0: 290a 2020 2020 2020 2020 2e61 7070 6c79  ).        .apply
-00045900: 2869 6478 6d61 786d 696e 5f72 6f77 2c20  (idxmaxmin_row, 
-00045910: 666e 3d66 6e2c 2073 6b69 706e 613d 736b  fn=fn, skipna=sk
-00045920: 6970 6e61 290a 2020 2020 2020 2020 2e72  ipna).        .r
-00045930: 6573 6574 5f69 6e64 6578 286c 6576 656c  eset_index(level
-00045940: 3d31 2c20 6472 6f70 3d54 7275 6529 0a20  =1, drop=True). 
-00045950: 2020 2029 0a0a 0a64 6566 2069 6478 6d61     )...def idxma
-00045960: 786d 696e 5f61 6767 2878 2c20 666e 3d4e  xmin_agg(x, fn=N
-00045970: 6f6e 652c 2073 6b69 706e 613d 5472 7565  one, skipna=True
-00045980: 2c20 7363 616c 6172 3d46 616c 7365 2c20  , scalar=False, 
-00045990: 6e75 6d65 7269 635f 6f6e 6c79 3d6e 6f5f  numeric_only=no_
-000459a0: 6465 6661 756c 7429 3a0a 2020 2020 7265  default):.    re
-000459b0: 7320 3d20 6964 786d 6178 6d69 6e5f 636f  s = idxmaxmin_co
-000459c0: 6d62 696e 6528 782c 2066 6e2c 2073 6b69  mbine(x, fn, ski
-000459d0: 706e 613d 736b 6970 6e61 295b 2269 6478  pna=skipna)["idx
-000459e0: 225d 0a20 2020 2069 6620 6c65 6e28 7265  "].    if len(re
-000459f0: 7329 203d 3d20 303a 0a20 2020 2020 2020  s) == 0:.       
-00045a00: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00045a10: 7228 2261 7474 656d 7074 2074 6f20 6765  r("attempt to ge
-00045a20: 7420 6172 676d 6178 206f 6620 616e 2065  t argmax of an e
-00045a30: 6d70 7479 2073 6571 7565 6e63 6522 290a  mpty sequence").
-00045a40: 2020 2020 6966 2073 6361 6c61 723a 0a20      if scalar:. 
-00045a50: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-00045a60: 735b 305d 0a20 2020 2072 6573 2e6e 616d  s[0].    res.nam
-00045a70: 6520 3d20 4e6f 6e65 0a20 2020 2072 6574  e = None.    ret
-00045a80: 7572 6e20 7265 730a 0a0a 6465 6620 5f6d  urn res...def _m
-00045a90: 6f64 655f 6167 6772 6567 6174 6528 6466  ode_aggregate(df
-00045aa0: 2c20 6472 6f70 6e61 293a 0a20 2020 2076  , dropna):.    v
-00045ab0: 616c 7565 5f63 6f75 6e74 5f73 6572 6965  alue_count_serie
-00045ac0: 7320 3d20 6466 2e73 756d 2829 0a20 2020  s = df.sum().   
-00045ad0: 206d 6178 5f76 616c 203d 2076 616c 7565   max_val = value
-00045ae0: 5f63 6f75 6e74 5f73 6572 6965 732e 6d61  _count_series.ma
-00045af0: 7828 736b 6970 6e61 3d64 726f 706e 6129  x(skipna=dropna)
-00045b00: 0a20 2020 206d 6f64 655f 7365 7269 6573  .    mode_series
-00045b10: 203d 2028 0a20 2020 2020 2020 2076 616c   = (.        val
-00045b20: 7565 5f63 6f75 6e74 5f73 6572 6965 735b  ue_count_series[
-00045b30: 7661 6c75 655f 636f 756e 745f 7365 7269  value_count_seri
-00045b40: 6573 203d 3d20 6d61 785f 7661 6c5d 0a20  es == max_val]. 
-00045b50: 2020 2020 2020 202e 696e 6465 782e 746f         .index.to
-00045b60: 5f73 6572 6965 7328 290a 2020 2020 2020  _series().      
-00045b70: 2020 2e73 6f72 745f 7661 6c75 6573 2829    .sort_values()
-00045b80: 0a20 2020 2020 2020 202e 7265 7365 745f  .        .reset_
-00045b90: 696e 6465 7828 6472 6f70 3d54 7275 6529  index(drop=True)
-00045ba0: 0a20 2020 2029 0a20 2020 2072 6574 7572  .    ).    retur
-00045bb0: 6e20 6d6f 6465 5f73 6572 6965 730a 0a0a  n mode_series...
-00045bc0: 6465 6620 5f63 6f75 6e74 5f61 6767 7265  def _count_aggre
-00045bd0: 6761 7465 2878 293a 0a20 2020 2072 6574  gate(x):.    ret
-00045be0: 7572 6e20 782e 7375 6d28 292e 6173 7479  urn x.sum().asty
-00045bf0: 7065 2822 696e 7436 3422 290a 0a0a 6465  pe("int64")...de
-00045c00: 6620 7361 6665 5f68 6561 6428 6466 2c20  f safe_head(df, 
-00045c10: 6e29 3a0a 2020 2020 7220 3d20 4d2e 6865  n):.    r = M.he
-00045c20: 6164 2864 662c 206e 290a 2020 2020 6966  ad(df, n).    if
-00045c30: 206c 656e 2872 2920 213d 206e 3a0a 2020   len(r) != n:.  
-00045c40: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-00045c50: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
-00045c60: 2066 2249 6e73 7566 6669 6369 656e 7420   f"Insufficient 
-00045c70: 656c 656d 656e 7473 2066 6f72 2060 6865  elements for `he
-00045c80: 6164 602e 207b 6e7d 2065 6c65 6d65 6e74  ad`. {n} element
-00045c90: 7320 7265 7175 6573 7465 642c 206f 6e6c  s requested, onl
-00045ca0: 7920 7b6c 656e 2872 297d 2022 0a20 2020  y {len(r)} ".   
-00045cb0: 2020 2020 2020 2020 2022 656c 656d 656e           "elemen
-00045cc0: 7473 2061 7661 696c 6162 6c65 2e20 5472  ts available. Tr
-00045cd0: 7920 7061 7373 696e 6720 6c61 7267 6572  y passing larger
-00045ce0: 2060 6e70 6172 7469 7469 6f6e 7360 2074   `npartitions` t
-00045cf0: 6f20 6068 6561 6460 2e22 0a20 2020 2020  o `head`.".     
-00045d00: 2020 2029 0a20 2020 2072 6574 7572 6e20     ).    return 
-00045d10: 720a 0a0a 6465 6620 6d61 7962 655f 7368  r...def maybe_sh
-00045d20: 6966 745f 6469 7669 7369 6f6e 7328 6466  ift_divisions(df
-00045d30: 2c20 7065 7269 6f64 732c 2066 7265 7129  , periods, freq)
-00045d40: 3a0a 2020 2020 2222 224d 6179 6265 2073  :.    """Maybe s
-00045d50: 6869 6674 2064 6976 6973 696f 6e73 2062  hift divisions b
-00045d60: 7920 7065 7269 6f64 7320 6f66 2073 697a  y periods of siz
-00045d70: 6520 6672 6571 0a0a 2020 2020 5573 6564  e freq..    Used
-00045d80: 2074 6f20 7368 6966 7420 7468 6520 6469   to shift the di
-00045d90: 7669 7369 6f6e 7320 666f 7220 7468 6520  visions for the 
-00045da0: 6073 6869 6674 6020 6d65 7468 6f64 2e20  `shift` method. 
-00045db0: 4966 2066 7265 7120 6973 6e27 7420 6120  If freq isn't a 
-00045dc0: 6669 7865 640a 2020 2020 7369 7a65 2028  fixed.    size (
-00045dd0: 6e6f 7420 616e 6368 6f72 6564 206f 7220  not anchored or 
-00045de0: 7265 6c61 7469 7665 292c 2074 6865 6e20  relative), then 
-00045df0: 7468 6520 6469 7669 7369 6f6e 7320 6172  the divisions ar
-00045e00: 6520 7368 6966 7465 640a 2020 2020 6170  e shifted.    ap
-00045e10: 7072 6f70 7269 6174 656c 792e 204f 7468  propriately. Oth
-00045e20: 6572 7769 7365 2074 6865 2064 6976 6973  erwise the divis
-00045e30: 696f 6e73 2061 7265 2063 6c65 6172 6564  ions are cleared
-00045e40: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-00045e50: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-00045e60: 0a20 2020 2064 6620 3a20 6464 2e44 6174  .    df : dd.Dat
-00045e70: 6146 7261 6d65 2c20 6464 2e53 6572 6965  aFrame, dd.Serie
-00045e80: 732c 206f 7220 6464 2e49 6e64 6578 0a20  s, or dd.Index. 
-00045e90: 2020 2070 6572 696f 6473 203a 2069 6e74     periods : int
-00045ea0: 0a20 2020 2020 2020 2054 6865 206e 756d  .        The num
-00045eb0: 6265 7220 6f66 2070 6572 696f 6473 2074  ber of periods t
-00045ec0: 6f20 7368 6966 742e 0a20 2020 2066 7265  o shift..    fre
-00045ed0: 7120 3a20 4461 7465 4f66 6673 6574 2c20  q : DateOffset, 
-00045ee0: 7469 6d65 6465 6c74 612c 206f 7220 7469  timedelta, or ti
-00045ef0: 6d65 2072 756c 6520 7374 7269 6e67 0a20  me rule string. 
-00045f00: 2020 2020 2020 2054 6865 2066 7265 7175         The frequ
-00045f10: 656e 6379 2074 6f20 7368 6966 7420 6279  ency to shift by
-00045f20: 2e0a 2020 2020 2222 220a 2020 2020 6966  ..    """.    if
-00045f30: 2069 7369 6e73 7461 6e63 6528 6672 6571   isinstance(freq
-00045f40: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
-00045f50: 6672 6571 203d 2070 642e 7473 6572 6965  freq = pd.tserie
-00045f60: 732e 6672 6571 7565 6e63 6965 732e 746f  s.frequencies.to
-00045f70: 5f6f 6666 7365 7428 6672 6571 290a 0a20  _offset(freq).. 
-00045f80: 2020 2069 735f 6f66 6673 6574 203d 2069     is_offset = i
-00045f90: 7369 6e73 7461 6e63 6528 6672 6571 2c20  sinstance(freq, 
-00045fa0: 7064 2e44 6174 654f 6666 7365 7429 0a20  pd.DateOffset). 
-00045fb0: 2020 2069 6620 6973 5f6f 6666 7365 743a     if is_offset:
-00045fc0: 0a20 2020 2020 2020 2069 6620 6672 6571  .        if freq
-00045fd0: 2e69 735f 616e 6368 6f72 6564 2829 206f  .is_anchored() o
-00045fe0: 7220 6e6f 7420 6861 7361 7474 7228 6672  r not hasattr(fr
-00045ff0: 6571 2c20 2264 656c 7461 2229 3a0a 2020  eq, "delta"):.  
-00046000: 2020 2020 2020 2020 2020 2320 4361 6e27            # Can'
-00046010: 7420 696e 6665 7220 6469 7669 7369 6f6e  t infer division
-00046020: 7320 6f6e 2072 656c 6174 6976 6520 6f72  s on relative or
-00046030: 2061 6e63 686f 7265 6420 6f66 6673 6574   anchored offset
-00046040: 732c 2061 730a 2020 2020 2020 2020 2020  s, as.          
-00046050: 2020 2320 6469 7669 7369 6f6e 7320 6d61    # divisions ma
-00046060: 7920 6e6f 7720 7370 6c69 7420 6964 656e  y now split iden
-00046070: 7469 6361 6c20 696e 6465 7820 7661 6c75  tical index valu
-00046080: 652e 0a20 2020 2020 2020 2020 2020 2023  e..            #
-00046090: 2028 652e 672e 2069 6e64 6578 5f70 6172   (e.g. index_par
-000460a0: 7469 7469 6f6e 7320 3d20 5b5b 312c 2032  titions = [[1, 2
-000460b0: 2c20 335d 2c20 5b33 2c20 342c 2035 5d5d  , 3], [3, 4, 5]]
-000460c0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-000460d0: 7475 726e 2064 662e 636c 6561 725f 6469  turn df.clear_di
-000460e0: 7669 7369 6f6e 7328 290a 2020 2020 6966  visions().    if
-000460f0: 2064 662e 6b6e 6f77 6e5f 6469 7669 7369   df.known_divisi
-00046100: 6f6e 733a 0a20 2020 2020 2020 2064 6976  ons:.        div
-00046110: 7320 3d20 7064 2e53 6572 6965 7328 7261  s = pd.Series(ra
-00046120: 6e67 6528 6c65 6e28 6466 2e64 6976 6973  nge(len(df.divis
-00046130: 696f 6e73 2929 2c20 696e 6465 783d 6466  ions)), index=df
-00046140: 2e64 6976 6973 696f 6e73 290a 2020 2020  .divisions).    
-00046150: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
-00046160: 6469 7673 2e73 6869 6674 2870 6572 696f  divs.shift(perio
-00046170: 6473 2c20 6672 6571 3d66 7265 7129 2e69  ds, freq=freq).i
-00046180: 6e64 6578 0a20 2020 2020 2020 2072 6574  ndex.        ret
-00046190: 7572 6e20 6466 2e5f 5f63 6c61 7373 5f5f  urn df.__class__
-000461a0: 2864 662e 6461 736b 2c20 6466 2e5f 6e61  (df.dask, df._na
-000461b0: 6d65 2c20 6466 2e5f 6d65 7461 2c20 6469  me, df._meta, di
-000461c0: 7669 7369 6f6e 7329 0a20 2020 2072 6574  visions).    ret
-000461d0: 7572 6e20 6466 0a0a 0a40 7772 6170 7328  urn df...@wraps(
-000461e0: 7064 2e74 6f5f 6461 7465 7469 6d65 290a  pd.to_datetime).
-000461f0: 6465 6620 746f 5f64 6174 6574 696d 6528  def to_datetime(
-00046200: 6172 672c 206d 6574 613d 4e6f 6e65 2c20  arg, meta=None, 
-00046210: 2a2a 6b77 6172 6773 293a 0a20 2020 2074  **kwargs):.    t
-00046220: 7a5f 6b77 6172 6720 3d20 7b22 747a 223a  z_kwarg = {"tz":
-00046230: 2022 7574 6322 7d20 6966 206b 7761 7267   "utc"} if kwarg
-00046240: 732e 6765 7428 2275 7463 2229 2065 6c73  s.get("utc") els
-00046250: 6520 7b7d 0a20 2020 2069 6620 6d65 7461  e {}.    if meta
-00046260: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00046270: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00046280: 6172 672c 2049 6e64 6578 293a 0a20 2020  arg, Index):.   
-00046290: 2020 2020 2020 2020 206d 6574 6120 3d20           meta = 
-000462a0: 6765 745f 6d65 7461 5f6c 6962 7261 7279  get_meta_library
-000462b0: 2861 7267 292e 4461 7465 7469 6d65 496e  (arg).DatetimeIn
-000462c0: 6465 7828 5b5d 2c20 2a2a 747a 5f6b 7761  dex([], **tz_kwa
-000462d0: 7267 290a 2020 2020 2020 2020 2020 2020  rg).            
-000462e0: 6d65 7461 2e6e 616d 6520 3d20 6172 672e  meta.name = arg.
-000462f0: 6e61 6d65 0a20 2020 2020 2020 2065 6c69  name.        eli
-00046300: 6620 6e6f 7420 2869 735f 6461 7461 6672  f not (is_datafr
-00046310: 616d 655f 6c69 6b65 2861 7267 2920 6f72  ame_like(arg) or
-00046320: 2069 735f 7365 7269 6573 5f6c 696b 6528   is_series_like(
-00046330: 6172 6729 293a 0a20 2020 2020 2020 2020  arg)):.         
-00046340: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
-00046350: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
-00046360: 2020 2020 2020 2020 2020 2020 2020 2264                "d
-00046370: 6173 6b2e 6461 7461 6672 616d 652e 746f  ask.dataframe.to
-00046380: 5f64 6174 6574 696d 6520 646f 6573 206e  _datetime does n
-00046390: 6f74 2073 7570 706f 7274 2022 0a20 2020  ot support ".   
-000463a0: 2020 2020 2020 2020 2020 2020 2022 6e6f               "no
-000463b0: 6e2d 696e 6465 782d 6162 6c65 2061 7267  n-index-able arg
-000463c0: 756d 656e 7473 2028 6c69 6b65 2073 6361  uments (like sca
-000463d0: 6c61 7273 2922 0a20 2020 2020 2020 2020  lars)".         
-000463e0: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
-000463f0: 653a 0a20 2020 2020 2020 2020 2020 206d  e:.            m
-00046400: 6574 6120 3d20 6d65 7461 5f73 6572 6965  eta = meta_serie
-00046410: 735f 636f 6e73 7472 7563 746f 7228 6172  s_constructor(ar
-00046420: 6729 285b 7064 2e54 696d 6573 7461 6d70  g)([pd.Timestamp
-00046430: 2822 3230 3030 222c 202a 2a74 7a5f 6b77  ("2000", **tz_kw
-00046440: 6172 6729 5d29 0a20 2020 2020 2020 2020  arg)]).         
-00046450: 2020 206d 6574 612e 696e 6465 7820 3d20     meta.index = 
-00046460: 6d65 7461 2e69 6e64 6578 2e61 7374 7970  meta.index.astyp
-00046470: 6528 6172 672e 696e 6465 782e 6474 7970  e(arg.index.dtyp
-00046480: 6529 0a20 2020 2020 2020 2020 2020 206d  e).            m
-00046490: 6574 612e 696e 6465 782e 6e61 6d65 203d  eta.index.name =
-000464a0: 2061 7267 2e69 6e64 6578 2e6e 616d 650a   arg.index.name.
-000464b0: 2020 2020 6966 2050 414e 4441 535f 4754      if PANDAS_GT
-000464c0: 5f32 3030 2061 6e64 2022 696e 6665 725f  _200 and "infer_
-000464d0: 6461 7465 7469 6d65 5f66 6f72 6d61 7422  datetime_format"
-000464e0: 2069 6e20 6b77 6172 6773 3a0a 2020 2020   in kwargs:.    
-000464f0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00046500: 6e28 0a20 2020 2020 2020 2020 2020 2022  n(.            "
-00046510: 5468 6520 6172 6775 6d65 6e74 2027 696e  The argument 'in
-00046520: 6665 725f 6461 7465 7469 6d65 5f66 6f72  fer_datetime_for
-00046530: 6d61 7427 2069 7320 6465 7072 6563 6174  mat' is deprecat
-00046540: 6564 2061 6e64 2077 696c 6c20 6265 2072  ed and will be r
-00046550: 656d 6f76 6564 2069 6e20 6120 6675 7475  emoved in a futu
-00046560: 7265 2076 6572 7369 6f6e 2e20 220a 2020  re version. ".  
-00046570: 2020 2020 2020 2020 2020 2241 2073 7472            "A str
-00046580: 6963 7420 7665 7273 696f 6e20 6f66 2069  ict version of i
-00046590: 7420 6973 206e 6f77 2074 6865 2064 6566  t is now the def
-000465a0: 6175 6c74 2c20 7365 6520 220a 2020 2020  ault, see ".    
-000465b0: 2020 2020 2020 2020 2268 7474 7073 3a2f          "https:/
-000465c0: 2f70 616e 6461 732e 7079 6461 7461 2e6f  /pandas.pydata.o
-000465d0: 7267 2f70 6465 7073 2f30 3030 342d 636f  rg/pdeps/0004-co
-000465e0: 6e73 6973 7465 6e74 2d74 6f2d 6461 7465  nsistent-to-date
-000465f0: 7469 6d65 2d70 6172 7369 6e67 2e68 746d  time-parsing.htm
-00046600: 6c2e 2022 0a20 2020 2020 2020 2020 2020  l. ".           
-00046610: 2022 596f 7520 6361 6e20 7361 6665 6c79   "You can safely
-00046620: 2072 656d 6f76 6520 7468 6973 2061 7267   remove this arg
-00046630: 756d 656e 742e 222c 0a20 2020 2020 2020  ument.",.       
-00046640: 2020 2020 2055 7365 7257 6172 6e69 6e67       UserWarning
-00046650: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00046660: 2020 2020 6b77 6172 6773 2e70 6f70 2822      kwargs.pop("
-00046670: 696e 6665 725f 6461 7465 7469 6d65 5f66  infer_datetime_f
-00046680: 6f72 6d61 7422 290a 0a20 2020 2072 6574  ormat")..    ret
-00046690: 7572 6e20 6d61 705f 7061 7274 6974 696f  urn map_partitio
-000466a0: 6e73 2867 6574 5f6d 6574 615f 6c69 6272  ns(get_meta_libr
-000466b0: 6172 7928 6172 6729 2e74 6f5f 6461 7465  ary(arg).to_date
-000466c0: 7469 6d65 2c20 6172 672c 206d 6574 613d  time, arg, meta=
-000466d0: 6d65 7461 2c20 2a2a 6b77 6172 6773 290a  meta, **kwargs).
-000466e0: 0a0a 4077 7261 7073 2870 642e 746f 5f74  ..@wraps(pd.to_t
-000466f0: 696d 6564 656c 7461 290a 6465 6620 746f  imedelta).def to
-00046700: 5f74 696d 6564 656c 7461 2861 7267 2c20  _timedelta(arg, 
-00046710: 756e 6974 3d4e 6f6e 652c 2065 7272 6f72  unit=None, error
-00046720: 733d 2272 6169 7365 2229 3a0a 2020 2020  s="raise"):.    
-00046730: 6d65 7461 203d 206d 6574 615f 7365 7269  meta = meta_seri
-00046740: 6573 5f63 6f6e 7374 7275 6374 6f72 2861  es_constructor(a
-00046750: 7267 2928 5b70 642e 5469 6d65 6465 6c74  rg)([pd.Timedelt
-00046760: 6128 312c 2075 6e69 743d 756e 6974 295d  a(1, unit=unit)]
-00046770: 290a 2020 2020 7265 7475 726e 206d 6170  ).    return map
-00046780: 5f70 6172 7469 7469 6f6e 7328 7064 2e74  _partitions(pd.t
-00046790: 6f5f 7469 6d65 6465 6c74 612c 2061 7267  o_timedelta, arg
-000467a0: 2c20 756e 6974 3d75 6e69 742c 2065 7272  , unit=unit, err
-000467b0: 6f72 733d 6572 726f 7273 2c20 6d65 7461  ors=errors, meta
-000467c0: 3d6d 6574 6129 0a0a 0a69 6620 6861 7361  =meta)...if hasa
-000467d0: 7474 7228 7064 2c20 2269 736e 6122 293a  ttr(pd, "isna"):
-000467e0: 0a0a 2020 2020 4077 7261 7073 2870 642e  ..    @wraps(pd.
-000467f0: 6973 6e61 290a 2020 2020 6465 6620 6973  isna).    def is
-00046800: 6e61 2861 7267 293a 0a20 2020 2020 2020  na(arg):.       
-00046810: 2072 6574 7572 6e20 6d61 705f 7061 7274   return map_part
-00046820: 6974 696f 6e73 2870 642e 6973 6e61 2c20  itions(pd.isna, 
-00046830: 6172 6729 0a0a 0a64 6566 205f 7265 7072  arg)...def _repr
-00046840: 5f64 6174 615f 7365 7269 6573 2873 2c20  _data_series(s, 
-00046850: 696e 6465 7829 3a0a 2020 2020 2222 2241  index):.    """A
-00046860: 2068 656c 7065 7220 666f 7220 6372 6561   helper for crea
-00046870: 7469 6e67 2074 6865 2060 605f 7265 7072  ting the ``_repr
-00046880: 5f64 6174 6160 6020 7072 6f70 6572 7479  _data`` property
-00046890: 2222 220a 2020 2020 6e70 6172 7469 7469  """.    npartiti
-000468a0: 6f6e 7320 3d20 6c65 6e28 696e 6465 7829  ons = len(index)
-000468b0: 202d 2031 0a20 2020 2069 6620 6973 696e   - 1.    if isin
-000468c0: 7374 616e 6365 2873 2e64 7479 7065 2c20  stance(s.dtype, 
-000468d0: 7064 2e43 6174 6567 6f72 6963 616c 4474  pd.CategoricalDt
-000468e0: 7970 6529 3a0a 2020 2020 2020 2020 6966  ype):.        if
-000468f0: 2068 6173 5f6b 6e6f 776e 5f63 6174 6567   has_known_categ
-00046900: 6f72 6965 7328 7329 3a0a 2020 2020 2020  ories(s):.      
-00046910: 2020 2020 2020 6474 7970 6520 3d20 2263        dtype = "c
-00046920: 6174 6567 6f72 795b 6b6e 6f77 6e5d 220a  ategory[known]".
-00046930: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00046940: 2020 2020 2020 2020 2020 6474 7970 6520            dtype 
-00046950: 3d20 2263 6174 6567 6f72 795b 756e 6b6e  = "category[unkn
-00046960: 6f77 6e5d 220a 2020 2020 656c 7365 3a0a  own]".    else:.
-00046970: 2020 2020 2020 2020 6474 7970 6520 3d20          dtype = 
-00046980: 7374 7228 732e 6474 7970 6529 0a20 2020  str(s.dtype).   
-00046990: 2072 6574 7572 6e20 7064 2e53 6572 6965   return pd.Serie
-000469a0: 7328 5b64 7479 7065 5d20 2b20 5b22 2e2e  s([dtype] + ["..
-000469b0: 2e22 5d20 2a20 6e70 6172 7469 7469 6f6e  ."] * npartition
-000469c0: 732c 2069 6e64 6578 3d69 6e64 6578 2c20  s, index=index, 
-000469d0: 6e61 6d65 3d73 2e6e 616d 6529 0a0a 0a64  name=s.name)...d
-000469e0: 6566 2068 6173 5f70 6172 616c 6c65 6c5f  ef has_parallel_
-000469f0: 7479 7065 2878 293a 0a20 2020 2022 2222  type(x):.    """
-00046a00: 446f 6573 2074 6869 7320 6f62 6a65 6374  Does this object
-00046a10: 2068 6176 6520 6120 6461 736b 2064 6174   have a dask dat
-00046a20: 6166 7261 6d65 2065 7175 6976 616c 656e  aframe equivalen
-00046a30: 743f 2222 220a 2020 2020 7265 7475 726e  t?""".    return
-00046a40: 2067 6574 5f70 6172 616c 6c65 6c5f 7479   get_parallel_ty
-00046a50: 7065 2878 2920 6973 206e 6f74 2053 6361  pe(x) is not Sca
-00046a60: 6c61 720a 0a0a 6465 6620 6e65 775f 6464  lar...def new_dd
-00046a70: 5f6f 626a 6563 7428 6473 6b2c 206e 616d  _object(dsk, nam
-00046a80: 652c 206d 6574 612c 2064 6976 6973 696f  e, meta, divisio
-00046a90: 6e73 2c20 7061 7265 6e74 5f6d 6574 613d  ns, parent_meta=
-00046aa0: 4e6f 6e65 293a 0a20 2020 2022 2222 4765  None):.    """Ge
-00046ab0: 6e65 7269 6320 636f 6e73 7472 7563 746f  neric constructo
-00046ac0: 7220 666f 7220 6461 736b 2e64 6174 6166  r for dask.dataf
-00046ad0: 7261 6d65 206f 626a 6563 7473 2e0a 0a20  rame objects... 
-00046ae0: 2020 2044 6563 6964 6573 2074 6865 2061     Decides the a
-00046af0: 7070 726f 7072 6961 7465 206f 7574 7075  ppropriate outpu
-00046b00: 7420 636c 6173 7320 6261 7365 6420 6f6e  t class based on
-00046b10: 2074 6865 2074 7970 6520 6f66 2060 6d65   the type of `me
-00046b20: 7461 6020 7072 6f76 6964 6564 2e0a 2020  ta` provided..  
-00046b30: 2020 2222 220a 2020 2020 6966 2068 6173    """.    if has
-00046b40: 5f70 6172 616c 6c65 6c5f 7479 7065 286d  _parallel_type(m
-00046b50: 6574 6129 3a0a 2020 2020 2020 2020 7265  eta):.        re
-00046b60: 7475 726e 2067 6574 5f70 6172 616c 6c65  turn get_paralle
-00046b70: 6c5f 7479 7065 286d 6574 6129 2864 736b  l_type(meta)(dsk
-00046b80: 2c20 6e61 6d65 2c20 6d65 7461 2c20 6469  , name, meta, di
-00046b90: 7669 7369 6f6e 7329 0a20 2020 2065 6c69  visions).    eli
-00046ba0: 6620 6973 5f61 7272 6179 6c69 6b65 286d  f is_arraylike(m
-00046bb0: 6574 6129 2061 6e64 206d 6574 612e 7368  eta) and meta.sh
-00046bc0: 6170 653a 0a20 2020 2020 2020 2069 6d70  ape:.        imp
-00046bd0: 6f72 7420 6461 736b 2e61 7272 6179 2061  ort dask.array a
-00046be0: 7320 6461 0a0a 2020 2020 2020 2020 6368  s da..        ch
-00046bf0: 756e 6b73 203d 2028 286e 702e 6e61 6e2c  unks = ((np.nan,
-00046c00: 2920 2a20 286c 656e 2864 6976 6973 696f  ) * (len(divisio
-00046c10: 6e73 2920 2d20 3129 2c29 202b 2074 7570  ns) - 1),) + tup
-00046c20: 6c65 280a 2020 2020 2020 2020 2020 2020  le(.            
-00046c30: 2864 2c29 2066 6f72 2064 2069 6e20 6d65  (d,) for d in me
-00046c40: 7461 2e73 6861 7065 5b31 3a5d 0a20 2020  ta.shape[1:].   
-00046c50: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
-00046c60: 6620 6c65 6e28 6368 756e 6b73 2920 3e20  f len(chunks) > 
-00046c70: 313a 0a20 2020 2020 2020 2020 2020 206c  1:.            l
-00046c80: 6179 6572 203d 2064 736b 2e6c 6179 6572  ayer = dsk.layer
-00046c90: 735b 6e61 6d65 5d0a 2020 2020 2020 2020  s[name].        
-00046ca0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00046cb0: 6528 6c61 7965 722c 2042 6c6f 636b 7769  e(layer, Blockwi
-00046cc0: 7365 293a 0a20 2020 2020 2020 2020 2020  se):.           
-00046cd0: 2020 2020 206c 6179 6572 2e6e 6577 5f61       layer.new_a
-00046ce0: 7865 735b 226a 225d 203d 2063 6875 6e6b  xes["j"] = chunk
-00046cf0: 735b 315d 5b30 5d0a 2020 2020 2020 2020  s[1][0].        
-00046d00: 2020 2020 2020 2020 6c61 7965 722e 6f75          layer.ou
-00046d10: 7470 7574 5f69 6e64 6963 6573 203d 206c  tput_indices = l
-00046d20: 6179 6572 2e6f 7574 7075 745f 696e 6469  ayer.output_indi
-00046d30: 6365 7320 2b20 2822 6a22 2c29 0a20 2020  ces + ("j",).   
-00046d40: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00046d50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00046d60: 7566 6669 7820 3d20 2830 2c29 202a 2028  uffix = (0,) * (
-00046d70: 6c65 6e28 6368 756e 6b73 2920 2d20 3129  len(chunks) - 1)
-00046d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00046d90: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-00046da0: 6c65 6e28 6368 756e 6b73 5b30 5d29 293a  len(chunks[0])):
-00046db0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00046dc0: 2020 2020 206c 6179 6572 5b28 6e61 6d65       layer[(name
-00046dd0: 2c20 6929 202b 2073 7566 6669 785d 203d  , i) + suffix] =
-00046de0: 206c 6179 6572 2e70 6f70 2828 6e61 6d65   layer.pop((name
-00046df0: 2c20 6929 290a 2020 2020 2020 2020 7265  , i)).        re
-00046e00: 7475 726e 2064 612e 4172 7261 7928 6473  turn da.Array(ds
-00046e10: 6b2c 206e 616d 653d 6e61 6d65 2c20 6368  k, name=name, ch
-00046e20: 756e 6b73 3d63 6875 6e6b 732c 2064 7479  unks=chunks, dty
-00046e30: 7065 3d6d 6574 612e 6474 7970 6529 0a20  pe=meta.dtype). 
-00046e40: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00046e50: 2072 6574 7572 6e20 6765 745f 7061 7261   return get_para
-00046e60: 6c6c 656c 5f74 7970 6528 6d65 7461 2928  llel_type(meta)(
-00046e70: 6473 6b2c 206e 616d 652c 206d 6574 612c  dsk, name, meta,
-00046e80: 2064 6976 6973 696f 6e73 290a 0a0a 6465   divisions)...de
-00046e90: 6620 7061 7274 6974 696f 6e77 6973 655f  f partitionwise_
-00046ea0: 6772 6170 6828 6675 6e63 2c20 6c61 7965  graph(func, laye
-00046eb0: 725f 6e61 6d65 2c20 2a61 7267 732c 202a  r_name, *args, *
-00046ec0: 2a6b 7761 7267 7329 3a0a 2020 2020 2222  *kwargs):.    ""
-00046ed0: 220a 2020 2020 4170 706c 7920 6120 6675  ".    Apply a fu
-00046ee0: 6e63 7469 6f6e 2070 6172 7469 7469 6f6e  nction partition
-00046ef0: 2d77 6973 6520 6163 726f 7373 2061 7267  -wise across arg
-00046f00: 756d 656e 7473 2074 6f20 6372 6561 7465  uments to create
-00046f10: 206c 6179 6572 206f 6620 6120 6772 6170   layer of a grap
-00046f20: 680a 0a20 2020 2054 6869 7320 6170 706c  h..    This appl
-00046f30: 6965 7320 6120 6675 6e63 7469 6f6e 2c20  ies a function, 
-00046f40: 6060 6675 6e63 6060 2c20 696e 2061 6e20  ``func``, in an 
-00046f50: 656d 6261 7272 6173 7369 6e67 6c79 2070  embarrassingly p
-00046f60: 6172 616c 6c65 6c20 6661 7368 696f 6e0a  arallel fashion.
-00046f70: 2020 2020 6163 726f 7373 2070 6172 7469      across parti
-00046f80: 7469 6f6e 732f 6368 756e 6b73 2069 6e20  tions/chunks in 
-00046f90: 7468 6520 7072 6f76 6964 6564 2061 7267  the provided arg
-00046fa0: 756d 656e 7473 2e20 2049 7420 6861 6e64  uments.  It hand
-00046fb0: 6c65 7320 4461 7461 6672 616d 6573 2c0a  les Dataframes,.
-00046fc0: 2020 2020 4172 7261 7973 2c20 616e 6420      Arrays, and 
-00046fd0: 7363 616c 6172 7320 736d 6f6f 7468 6c79  scalars smoothly
-00046fe0: 2c20 616e 6420 7265 6c69 6573 206f 6e20  , and relies on 
-00046ff0: 7468 6520 6060 626c 6f63 6b77 6973 6560  the ``blockwise`
-00047000: 6020 6d61 6368 696e 6572 790a 2020 2020  ` machinery.    
-00047010: 746f 2070 726f 7669 6465 2061 206e 6963  to provide a nic
-00047020: 656c 7920 7379 6d62 6f6c 6963 2067 7261  ely symbolic gra
-00047030: 7068 2e0a 0a20 2020 2049 7420 6973 206d  ph...    It is m
-00047040: 6f73 7420 636f 6d6d 6f6e 6c79 2075 7365  ost commonly use
-00047050: 6420 696e 206f 7468 6572 2067 7261 7068  d in other graph
-00047060: 2d62 7569 6c64 696e 6720 6675 6e63 7469  -building functi
-00047070: 6f6e 7320 746f 2063 7265 6174 6520 7468  ons to create th
-00047080: 650a 2020 2020 6170 7072 6f70 7269 6174  e.    appropriat
-00047090: 6520 6c61 7965 7220 6f66 2074 6865 2072  e layer of the r
-000470a0: 6573 756c 7469 6e67 2064 6174 6166 7261  esulting datafra
-000470b0: 6d65 2e0a 0a20 2020 2050 6172 616d 6574  me...    Paramet
-000470c0: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-000470d0: 2d2d 0a20 2020 2066 756e 633a 2063 616c  --.    func: cal
-000470e0: 6c61 626c 650a 2020 2020 6c61 7965 725f  lable.    layer_
-000470f0: 6e61 6d65 3a20 7374 720a 2020 2020 2020  name: str.      
-00047100: 2020 4465 7363 7269 7074 6976 6520 6e61    Descriptive na
-00047110: 6d65 2066 6f72 2074 6865 206f 7065 7261  me for the opera
-00047120: 7469 6f6e 2e20 5573 6564 2061 7320 7468  tion. Used as th
-00047130: 6520 6f75 7470 7574 206e 616d 650a 2020  e output name.  
-00047140: 2020 2020 2020 696e 2074 6865 2072 6573        in the res
-00047150: 756c 7469 6e67 2060 6042 6c6f 636b 7769  ulting ``Blockwi
-00047160: 7365 6060 2067 7261 7068 206c 6179 6572  se`` graph layer
-00047170: 2e0a 2020 2020 2a61 7267 733a 0a20 2020  ..    *args:.   
-00047180: 202a 2a6b 7761 7267 733a 0a0a 2020 2020   **kwargs:..    
-00047190: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
-000471a0: 2d2d 2d0a 2020 2020 6f75 743a 2042 6c6f  ---.    out: Blo
-000471b0: 636b 7769 7365 2067 7261 7068 0a0a 2020  ckwise graph..  
-000471c0: 2020 4578 616d 706c 6573 0a20 2020 202d    Examples.    -
-000471d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 3e3e 3e20  -------.    >>> 
-000471e0: 7375 6267 7261 7068 203d 2070 6172 7469  subgraph = parti
-000471f0: 7469 6f6e 7769 7365 5f67 7261 7068 2866  tionwise_graph(f
-00047200: 756e 6374 696f 6e2c 2078 2c20 792c 207a  unction, x, y, z
-00047210: 3d31 3233 2920 2023 2064 6f63 7465 7374  =123)  # doctest
-00047220: 3a20 2b53 4b49 500a 2020 2020 3e3e 3e20  : +SKIP.    >>> 
-00047230: 6c61 7965 7220 3d20 7061 7274 6974 696f  layer = partitio
-00047240: 6e77 6973 655f 6772 6170 6828 6675 6e63  nwise_graph(func
-00047250: 7469 6f6e 2c20 6466 2c20 782c 207a 3d31  tion, df, x, z=1
-00047260: 3233 2920 2023 2064 6f63 7465 7374 3a20  23)  # doctest: 
-00047270: 2b53 4b49 500a 2020 2020 3e3e 3e20 6772  +SKIP.    >>> gr
-00047280: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
-00047290: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
-000472a0: 7469 6f6e 7328 6e61 6d65 2c20 6c61 7965  tions(name, laye
-000472b0: 722c 2064 6570 656e 6465 6e63 6965 733d  r, dependencies=
-000472c0: 5b64 662c 2078 5d29 2020 2320 646f 6374  [df, x])  # doct
+0003c410: 6c6c 2062 6520 7370 6c69 7420 696e 746f  ll be split into
+0003c420: 206d 756c 7469 706c 6520 7061 7274 6974   multiple partit
+0003c430: 696f 6e73 2e0a 0a20 2020 2020 2020 2049  ions...        I
+0003c440: 6620 4661 6c73 652c 2061 6c6c 2069 6e70  f False, all inp
+0003c450: 7574 7320 6d75 7374 2068 6176 6520 6569  uts must have ei
+0003c460: 7468 6572 2074 6865 2073 616d 6520 6e75  ther the same nu
+0003c470: 6d62 6572 206f 6620 7061 7274 6974 696f  mber of partitio
+0003c480: 6e73 0a20 2020 2020 2020 206f 7220 6120  ns.        or a 
+0003c490: 7369 6e67 6c65 2070 6172 7469 7469 6f6e  single partition
+0003c4a0: 2e20 5369 6e67 6c65 2d70 6172 7469 7469  . Single-partiti
+0003c4b0: 6f6e 2069 6e70 7574 7320 7769 6c6c 2062  on inputs will b
+0003c4c0: 6520 6272 6f61 6463 6173 7420 746f 0a20  e broadcast to. 
+0003c4d0: 2020 2020 2020 2065 7665 7279 2070 6172         every par
+0003c4e0: 7469 7469 6f6e 206f 6620 6d75 6c74 692d  tition of multi-
+0003c4f0: 7061 7274 6974 696f 6e20 696e 7075 7473  partition inputs
+0003c500: 2e0a 2020 2020 244d 4554 410a 2020 2020  ..    $META.    
+0003c510: 2222 220a 2020 2020 6e61 6d65 203d 206b  """.    name = k
+0003c520: 7761 7267 732e 706f 7028 2274 6f6b 656e  wargs.pop("token
+0003c530: 222c 204e 6f6e 6529 0a20 2020 2070 6172  ", None).    par
+0003c540: 656e 745f 6d65 7461 203d 206b 7761 7267  ent_meta = kwarg
+0003c550: 732e 706f 7028 2270 6172 656e 745f 6d65  s.pop("parent_me
+0003c560: 7461 222c 204e 6f6e 6529 0a0a 2020 2020  ta", None)..    
+0003c570: 6173 7365 7274 2063 616c 6c61 626c 6528  assert callable(
+0003c580: 6675 6e63 290a 2020 2020 6966 206e 616d  func).    if nam
+0003c590: 6520 6973 206e 6f74 204e 6f6e 653a 0a20  e is not None:. 
+0003c5a0: 2020 2020 2020 2074 6f6b 656e 203d 2074         token = t
+0003c5b0: 6f6b 656e 697a 6528 6d65 7461 2c20 2a61  okenize(meta, *a
+0003c5c0: 7267 732c 202a 2a6b 7761 7267 7329 0a20  rgs, **kwargs). 
+0003c5d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0003c5e0: 206e 616d 6520 3d20 6675 6e63 6e61 6d65   name = funcname
+0003c5f0: 2866 756e 6329 0a20 2020 2020 2020 2074  (func).        t
+0003c600: 6f6b 656e 203d 2074 6f6b 656e 697a 6528  oken = tokenize(
+0003c610: 6675 6e63 2c20 6d65 7461 2c20 2a61 7267  func, meta, *arg
+0003c620: 732c 202a 2a6b 7761 7267 7329 0a20 2020  s, **kwargs).   
+0003c630: 206e 616d 6520 3d20 6622 7b6e 616d 657d   name = f"{name}
+0003c640: 2d7b 746f 6b65 6e7d 220a 0a20 2020 2066  -{token}"..    f
+0003c650: 726f 6d20 6461 736b 2e64 6174 6166 7261  rom dask.datafra
+0003c660: 6d65 2e6d 756c 7469 2069 6d70 6f72 7420  me.multi import 
+0003c670: 5f6d 6179 6265 5f61 6c69 676e 5f70 6172  _maybe_align_par
+0003c680: 7469 7469 6f6e 730a 0a20 2020 2069 6620  titions..    if 
+0003c690: 616c 6967 6e5f 6461 7461 6672 616d 6573  align_dataframes
+0003c6a0: 3a0a 2020 2020 2020 2020 6172 6773 203d  :.        args =
+0003c6b0: 205f 6d61 7962 655f 6672 6f6d 5f70 616e   _maybe_from_pan
+0003c6c0: 6461 7328 6172 6773 290a 2020 2020 2020  das(args).      
+0003c6d0: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+0003c6e0: 2020 2061 7267 7320 3d20 5f6d 6179 6265     args = _maybe
+0003c6f0: 5f61 6c69 676e 5f70 6172 7469 7469 6f6e  _align_partition
+0003c700: 7328 6172 6773 290a 2020 2020 2020 2020  s(args).        
+0003c710: 6578 6365 7074 2056 616c 7565 4572 726f  except ValueErro
+0003c720: 7220 6173 2065 3a0a 2020 2020 2020 2020  r as e:.        
+0003c730: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0003c740: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0003c750: 2020 2020 2020 6622 7b65 7d2e 2049 6620        f"{e}. If 
+0003c760: 796f 7520 646f 6e27 7420 7761 6e74 2074  you don't want t
+0003c770: 6865 2070 6172 7469 7469 6f6e 7320 746f  he partitions to
+0003c780: 2062 6520 616c 6967 6e65 642c 2061 6e64   be aligned, and
+0003c790: 2061 7265 2022 0a20 2020 2020 2020 2020   are ".         
+0003c7a0: 2020 2020 2020 2022 6361 6c6c 696e 6720         "calling 
+0003c7b0: 606d 6170 5f70 6172 7469 7469 6f6e 7360  `map_partitions`
+0003c7c0: 2064 6972 6563 746c 792c 2070 6173 7320   directly, pass 
+0003c7d0: 6061 6c69 676e 5f64 6174 6166 7261 6d65  `align_dataframe
+0003c7e0: 733d 4661 6c73 6560 2e22 0a20 2020 2020  s=False`.".     
+0003c7f0: 2020 2020 2020 2029 2066 726f 6d20 650a         ) from e.
+0003c800: 0a20 2020 2064 6673 203d 205b 6466 2066  .    dfs = [df f
+0003c810: 6f72 2064 6620 696e 2061 7267 7320 6966  or df in args if
+0003c820: 2069 7369 6e73 7461 6e63 6528 6466 2c20   isinstance(df, 
+0003c830: 5f46 7261 6d65 295d 0a0a 2020 2020 6d65  _Frame)]..    me
+0003c840: 7461 203d 205f 6765 745f 6d65 7461 5f6d  ta = _get_meta_m
+0003c850: 6170 5f70 6172 7469 7469 6f6e 7328 6172  ap_partitions(ar
+0003c860: 6773 2c20 6466 732c 2066 756e 632c 206b  gs, dfs, func, k
+0003c870: 7761 7267 732c 206d 6574 612c 2070 6172  wargs, meta, par
+0003c880: 656e 745f 6d65 7461 290a 2020 2020 6966  ent_meta).    if
+0003c890: 2061 6c6c 2869 7369 6e73 7461 6e63 6528   all(isinstance(
+0003c8a0: 6172 672c 2053 6361 6c61 7229 2066 6f72  arg, Scalar) for
+0003c8b0: 2061 7267 2069 6e20 6172 6773 293a 0a20   arg in args):. 
+0003c8c0: 2020 2020 2020 206c 6179 6572 203d 207b         layer = {
+0003c8d0: 0a20 2020 2020 2020 2020 2020 2028 6e61  .            (na
+0003c8e0: 6d65 2c20 3029 3a20 280a 2020 2020 2020  me, 0): (.      
+0003c8f0: 2020 2020 2020 2020 2020 6170 706c 792c            apply,
+0003c900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c910: 2066 756e 632c 0a20 2020 2020 2020 2020   func,.         
+0003c920: 2020 2020 2020 2028 7475 706c 652c 205b         (tuple, [
+0003c930: 2861 7267 2e5f 6e61 6d65 2c20 3029 2066  (arg._name, 0) f
+0003c940: 6f72 2061 7267 2069 6e20 6172 6773 5d29  or arg in args])
+0003c950: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003c960: 2020 6b77 6172 6773 2c0a 2020 2020 2020    kwargs,.      
+0003c970: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0003c980: 7d0a 2020 2020 2020 2020 6772 6170 6820  }.        graph 
+0003c990: 3d20 4869 6768 4c65 7665 6c47 7261 7068  = HighLevelGraph
+0003c9a0: 2e66 726f 6d5f 636f 6c6c 6563 7469 6f6e  .from_collection
+0003c9b0: 7328 6e61 6d65 2c20 6c61 7965 722c 2064  s(name, layer, d
+0003c9c0: 6570 656e 6465 6e63 6965 733d 6172 6773  ependencies=args
+0003c9d0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0003c9e0: 2053 6361 6c61 7228 6772 6170 682c 206e   Scalar(graph, n
+0003c9f0: 616d 652c 206d 6574 6129 0a0a 2020 2020  ame, meta)..    
+0003ca00: 6172 6773 3220 3d20 5b5d 0a20 2020 2064  args2 = [].    d
+0003ca10: 6570 656e 6465 6e63 6965 7320 3d20 5b5d  ependencies = []
+0003ca20: 0a20 2020 2066 6f72 2061 7267 2069 6e20  .    for arg in 
+0003ca30: 6172 6773 3a0a 2020 2020 2020 2020 6966  args:.        if
+0003ca40: 2069 7369 6e73 7461 6e63 6528 6172 672c   isinstance(arg,
+0003ca50: 205f 4672 616d 6529 3a0a 2020 2020 2020   _Frame):.      
+0003ca60: 2020 2020 2020 6172 6773 322e 6170 7065        args2.appe
+0003ca70: 6e64 2861 7267 290a 2020 2020 2020 2020  nd(arg).        
+0003ca80: 2020 2020 6465 7065 6e64 656e 6369 6573      dependencies
+0003ca90: 2e61 7070 656e 6428 6172 6729 0a20 2020  .append(arg).   
+0003caa0: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
+0003cab0: 650a 2020 2020 2020 2020 6172 6720 3d20  e.        arg = 
+0003cac0: 6e6f 726d 616c 697a 655f 6172 6728 6172  normalize_arg(ar
+0003cad0: 6729 0a20 2020 2020 2020 2061 7267 322c  g).        arg2,
+0003cae0: 2063 6f6c 6c65 6374 696f 6e73 203d 2075   collections = u
+0003caf0: 6e70 6163 6b5f 636f 6c6c 6563 7469 6f6e  npack_collection
+0003cb00: 7328 6172 6729 0a20 2020 2020 2020 2069  s(arg).        i
+0003cb10: 6620 636f 6c6c 6563 7469 6f6e 733a 0a20  f collections:. 
+0003cb20: 2020 2020 2020 2020 2020 2061 7267 7332             args2
+0003cb30: 2e61 7070 656e 6428 6172 6732 290a 2020  .append(arg2).  
+0003cb40: 2020 2020 2020 2020 2020 6465 7065 6e64            depend
+0003cb50: 656e 6369 6573 2e65 7874 656e 6428 636f  encies.extend(co
+0003cb60: 6c6c 6563 7469 6f6e 7329 0a20 2020 2020  llections).     
+0003cb70: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0003cb80: 2020 2020 2061 7267 7332 2e61 7070 656e       args2.appen
+0003cb90: 6428 6172 6729 0a0a 2020 2020 6b77 6172  d(arg)..    kwar
+0003cba0: 6773 3320 3d20 7b7d 0a20 2020 2073 696d  gs3 = {}.    sim
+0003cbb0: 706c 6520 3d20 5472 7565 0a20 2020 2066  ple = True.    f
+0003cbc0: 6f72 206b 2c20 7620 696e 206b 7761 7267  or k, v in kwarg
+0003cbd0: 732e 6974 656d 7328 293a 0a20 2020 2020  s.items():.     
+0003cbe0: 2020 2076 203d 206e 6f72 6d61 6c69 7a65     v = normalize
+0003cbf0: 5f61 7267 2876 290a 2020 2020 2020 2020  _arg(v).        
+0003cc00: 762c 2063 6f6c 6c65 6374 696f 6e73 203d  v, collections =
+0003cc10: 2075 6e70 6163 6b5f 636f 6c6c 6563 7469   unpack_collecti
+0003cc20: 6f6e 7328 7629 0a20 2020 2020 2020 2064  ons(v).        d
+0003cc30: 6570 656e 6465 6e63 6965 732e 6578 7465  ependencies.exte
+0003cc40: 6e64 2863 6f6c 6c65 6374 696f 6e73 290a  nd(collections).
+0003cc50: 2020 2020 2020 2020 6b77 6172 6773 335b          kwargs3[
+0003cc60: 6b5d 203d 2076 0a20 2020 2020 2020 2069  k] = v.        i
+0003cc70: 6620 636f 6c6c 6563 7469 6f6e 733a 0a20  f collections:. 
+0003cc80: 2020 2020 2020 2020 2020 2073 696d 706c             simpl
+0003cc90: 6520 3d20 4661 6c73 650a 0a20 2020 2064  e = False..    d
+0003cca0: 6976 6973 696f 6e73 203d 205f 6765 745f  ivisions = _get_
+0003ccb0: 6469 7669 7369 6f6e 735f 6d61 705f 7061  divisions_map_pa
+0003ccc0: 7274 6974 696f 6e73 280a 2020 2020 2020  rtitions(.      
+0003ccd0: 2020 616c 6967 6e5f 6461 7461 6672 616d    align_datafram
+0003cce0: 6573 2c20 7472 616e 7366 6f72 6d5f 6469  es, transform_di
+0003ccf0: 7669 7369 6f6e 732c 2064 6673 2c20 6675  visions, dfs, fu
+0003cd00: 6e63 2c20 6172 6773 2c20 6b77 6172 6773  nc, args, kwargs
+0003cd10: 0a20 2020 2029 0a0a 2020 2020 6966 2068  .    )..    if h
+0003cd20: 6173 5f6b 6579 776f 7264 2866 756e 632c  as_keyword(func,
+0003cd30: 2022 7061 7274 6974 696f 6e5f 696e 666f   "partition_info
+0003cd40: 2229 3a0a 2020 2020 2020 2020 7061 7274  "):.        part
+0003cd50: 6974 696f 6e5f 696e 666f 203d 207b 0a20  ition_info = {. 
+0003cd60: 2020 2020 2020 2020 2020 2028 692c 293a             (i,):
+0003cd70: 207b 226e 756d 6265 7222 3a20 692c 2022   {"number": i, "
+0003cd80: 6469 7669 7369 6f6e 223a 2064 6976 6973  division": divis
+0003cd90: 696f 6e7d 0a20 2020 2020 2020 2020 2020  ion}.           
+0003cda0: 2066 6f72 2069 2c20 6469 7669 7369 6f6e   for i, division
+0003cdb0: 2069 6e20 656e 756d 6572 6174 6528 6469   in enumerate(di
+0003cdc0: 7669 7369 6f6e 735b 3a2d 315d 290a 2020  visions[:-1]).  
+0003cdd0: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
+0003cde0: 2061 7267 7332 2e69 6e73 6572 7428 302c   args2.insert(0,
+0003cdf0: 2042 6c6f 636b 7769 7365 4465 7044 6963   BlockwiseDepDic
+0003ce00: 7428 7061 7274 6974 696f 6e5f 696e 666f  t(partition_info
+0003ce10: 2929 0a20 2020 2020 2020 206f 7269 675f  )).        orig_
+0003ce20: 6675 6e63 203d 2066 756e 630a 0a20 2020  func = func..   
+0003ce30: 2020 2020 2064 6566 2066 756e 6328 7061       def func(pa
+0003ce40: 7274 6974 696f 6e5f 696e 666f 2c20 2a61  rtition_info, *a
+0003ce50: 7267 732c 202a 2a6b 7761 7267 7329 3a0a  rgs, **kwargs):.
+0003ce60: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0003ce70: 726e 206f 7269 675f 6675 6e63 282a 6172  rn orig_func(*ar
+0003ce80: 6773 2c20 2a2a 6b77 6172 6773 2c20 7061  gs, **kwargs, pa
+0003ce90: 7274 6974 696f 6e5f 696e 666f 3d70 6172  rtition_info=par
+0003cea0: 7469 7469 6f6e 5f69 6e66 6f29 0a0a 2020  tition_info)..  
+0003ceb0: 2020 6966 2065 6e66 6f72 6365 5f6d 6574    if enforce_met
+0003cec0: 6164 6174 613a 0a20 2020 2020 2020 2064  adata:.        d
+0003ced0: 736b 203d 2070 6172 7469 7469 6f6e 7769  sk = partitionwi
+0003cee0: 7365 5f67 7261 7068 280a 2020 2020 2020  se_graph(.      
+0003cef0: 2020 2020 2020 6170 706c 795f 616e 645f        apply_and_
+0003cf00: 656e 666f 7263 652c 0a20 2020 2020 2020  enforce,.       
+0003cf10: 2020 2020 206e 616d 652c 0a20 2020 2020       name,.     
+0003cf20: 2020 2020 2020 202a 6172 6773 322c 0a20         *args2,. 
+0003cf30: 2020 2020 2020 2020 2020 2064 6570 656e             depen
+0003cf40: 6465 6e63 6965 733d 6465 7065 6e64 656e  dencies=dependen
+0003cf50: 6369 6573 2c0a 2020 2020 2020 2020 2020  cies,.          
+0003cf60: 2020 5f66 756e 633d 6675 6e63 2c0a 2020    _func=func,.  
+0003cf70: 2020 2020 2020 2020 2020 5f6d 6574 613d            _meta=
+0003cf80: 6d65 7461 2c0a 2020 2020 2020 2020 2020  meta,.          
+0003cf90: 2020 2a2a 6b77 6172 6773 332c 0a20 2020    **kwargs3,.   
+0003cfa0: 2020 2020 2029 0a20 2020 2065 6c73 653a       ).    else:
+0003cfb0: 0a20 2020 2020 2020 206b 7761 7267 7334  .        kwargs4
+0003cfc0: 203d 206b 7761 7267 7320 6966 2073 696d   = kwargs if sim
+0003cfd0: 706c 6520 656c 7365 206b 7761 7267 7333  ple else kwargs3
+0003cfe0: 0a20 2020 2020 2020 2064 736b 203d 2070  .        dsk = p
+0003cff0: 6172 7469 7469 6f6e 7769 7365 5f67 7261  artitionwise_gra
+0003d000: 7068 280a 2020 2020 2020 2020 2020 2020  ph(.            
+0003d010: 6675 6e63 2c20 6e61 6d65 2c20 2a61 7267  func, name, *arg
+0003d020: 7332 2c20 2a2a 6b77 6172 6773 342c 2064  s2, **kwargs4, d
+0003d030: 6570 656e 6465 6e63 6965 733d 6465 7065  ependencies=depe
+0003d040: 6e64 656e 6369 6573 0a20 2020 2020 2020  ndencies.       
+0003d050: 2029 0a0a 2020 2020 6772 6170 6820 3d20   )..    graph = 
+0003d060: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
+0003d070: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
+0003d080: 6e61 6d65 2c20 6473 6b2c 2064 6570 656e  name, dsk, depen
+0003d090: 6465 6e63 6965 733d 6465 7065 6e64 656e  dencies=dependen
+0003d0a0: 6369 6573 290a 2020 2020 7265 7475 726e  cies).    return
+0003d0b0: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
+0003d0c0: 7261 7068 2c20 6e61 6d65 2c20 6d65 7461  raph, name, meta
+0003d0d0: 2c20 6469 7669 7369 6f6e 7329 0a0a 0a64  , divisions)...d
+0003d0e0: 6566 205f 6765 745f 6469 7669 7369 6f6e  ef _get_division
+0003d0f0: 735f 6d61 705f 7061 7274 6974 696f 6e73  s_map_partitions
+0003d100: 280a 2020 2020 616c 6967 6e5f 6461 7461  (.    align_data
+0003d110: 6672 616d 6573 2c20 7472 616e 7366 6f72  frames, transfor
+0003d120: 6d5f 6469 7669 7369 6f6e 732c 2064 6673  m_divisions, dfs
+0003d130: 2c20 6675 6e63 2c20 6172 6773 2c20 6b77  , func, args, kw
+0003d140: 6172 6773 0a29 3a0a 2020 2020 2222 220a  args.):.    """.
+0003d150: 2020 2020 4865 6c70 6572 2074 6f20 6765      Helper to ge
+0003d160: 7420 6469 7669 7369 6f6e 7320 666f 7220  t divisions for 
+0003d170: 6d61 705f 7061 7274 6974 696f 6e73 2061  map_partitions a
+0003d180: 6e64 206d 6170 5f6f 7665 726c 6170 206f  nd map_overlap o
+0003d190: 7574 7075 742e 0a20 2020 2022 2222 0a20  utput..    """. 
+0003d1a0: 2020 2069 6620 616c 6967 6e5f 6461 7461     if align_data
+0003d1b0: 6672 616d 6573 3a0a 2020 2020 2020 2020  frames:.        
+0003d1c0: 6469 7669 7369 6f6e 7320 3d20 6466 735b  divisions = dfs[
+0003d1d0: 305d 2e64 6976 6973 696f 6e73 0a20 2020  0].divisions.   
+0003d1e0: 2065 6c73 653a 0a20 2020 2020 2020 2023   else:.        #
+0003d1f0: 2055 6e61 6c69 676e 6564 2c20 6466 7320   Unaligned, dfs 
+0003d200: 6973 2061 206d 6978 206f 6620 3120 7061  is a mix of 1 pa
+0003d210: 7274 6974 696f 6e20 616e 6420 312b 2070  rtition and 1+ p
+0003d220: 6172 7469 7469 6f6e 2064 6174 6166 7261  artition datafra
+0003d230: 6d65 732c 0a20 2020 2020 2020 2023 2075  mes,.        # u
+0003d240: 7365 206c 6f6e 6765 7374 2064 6976 6973  se longest divis
+0003d250: 696f 6e73 2066 6f75 6e64 0a20 2020 2020  ions found.     
+0003d260: 2020 2064 6976 6973 696f 6e73 203d 206d     divisions = m
+0003d270: 6178 2828 642e 6469 7669 7369 6f6e 7320  ax((d.divisions 
+0003d280: 666f 7220 6420 696e 2064 6673 292c 206b  for d in dfs), k
+0003d290: 6579 3d6c 656e 290a 2020 2020 6966 2074  ey=len).    if t
+0003d2a0: 7261 6e73 666f 726d 5f64 6976 6973 696f  ransform_divisio
+0003d2b0: 6e73 2061 6e64 2069 7369 6e73 7461 6e63  ns and isinstanc
+0003d2c0: 6528 6466 735b 305d 2c20 496e 6465 7829  e(dfs[0], Index)
+0003d2d0: 2061 6e64 206c 656e 2864 6673 2920 3d3d   and len(dfs) ==
+0003d2e0: 2031 3a0a 2020 2020 2020 2020 7472 793a   1:.        try:
+0003d2f0: 0a20 2020 2020 2020 2020 2020 2064 6976  .            div
+0003d300: 6973 696f 6e73 203d 2066 756e 6328 0a20  isions = func(. 
+0003d310: 2020 2020 2020 2020 2020 2020 2020 202a                 *
+0003d320: 5b70 642e 496e 6465 7828 612e 6469 7669  [pd.Index(a.divi
+0003d330: 7369 6f6e 7329 2069 6620 6120 6973 2064  sions) if a is d
+0003d340: 6673 5b30 5d20 656c 7365 2061 2066 6f72  fs[0] else a for
+0003d350: 2061 2069 6e20 6172 6773 5d2c 202a 2a6b   a in args], **k
+0003d360: 7761 7267 730a 2020 2020 2020 2020 2020  wargs.          
+0003d370: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0003d380: 6966 2069 7369 6e73 7461 6e63 6528 6469  if isinstance(di
+0003d390: 7669 7369 6f6e 732c 2070 642e 496e 6465  visions, pd.Inde
+0003d3a0: 7829 3a0a 2020 2020 2020 2020 2020 2020  x):.            
+0003d3b0: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
+0003d3c0: 6d65 7468 6f64 732e 746f 6c69 7374 2864  methods.tolist(d
+0003d3d0: 6976 6973 696f 6e73 290a 2020 2020 2020  ivisions).      
+0003d3e0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
+0003d3f0: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+0003d400: 7061 7373 0a20 2020 2020 2020 2065 6c73  pass.        els
+0003d410: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
+0003d420: 6620 6e6f 7420 7661 6c69 645f 6469 7669  f not valid_divi
+0003d430: 7369 6f6e 7328 6469 7669 7369 6f6e 7329  sions(divisions)
+0003d440: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0003d450: 2020 6469 7669 7369 6f6e 7320 3d20 5b4e    divisions = [N
+0003d460: 6f6e 655d 202a 2028 6466 735b 305d 2e6e  one] * (dfs[0].n
+0003d470: 7061 7274 6974 696f 6e73 202b 2031 290a  partitions + 1).
+0003d480: 2020 2020 7265 7475 726e 2064 6976 6973      return divis
+0003d490: 696f 6e73 0a0a 0a64 6566 205f 6765 745f  ions...def _get_
+0003d4a0: 6d65 7461 5f6d 6170 5f70 6172 7469 7469  meta_map_partiti
+0003d4b0: 6f6e 7328 6172 6773 2c20 6466 732c 2066  ons(args, dfs, f
+0003d4c0: 756e 632c 206b 7761 7267 732c 206d 6574  unc, kwargs, met
+0003d4d0: 612c 2070 6172 656e 745f 6d65 7461 293a  a, parent_meta):
+0003d4e0: 0a20 2020 2022 2222 0a20 2020 2048 656c  .    """.    Hel
+0003d4f0: 7065 7220 746f 2067 656e 6572 6174 6520  per to generate 
+0003d500: 6d65 7461 6461 7461 2066 6f72 206d 6170  metadata for map
+0003d510: 5f70 6172 7469 7469 6f6e 7320 616e 6420  _partitions and 
+0003d520: 6d61 705f 6f76 6572 6c61 7020 6f75 7470  map_overlap outp
+0003d530: 7574 2e0a 2020 2020 2222 220a 2020 2020  ut..    """.    
+0003d540: 6d65 7461 5f69 6e64 6578 203d 2067 6574  meta_index = get
+0003d550: 6174 7472 286d 616b 655f 6d65 7461 2864  attr(make_meta(d
+0003d560: 6673 5b30 5d29 2c20 2269 6e64 6578 222c  fs[0]), "index",
+0003d570: 204e 6f6e 6529 2069 6620 6466 7320 656c   None) if dfs el
+0003d580: 7365 204e 6f6e 650a 2020 2020 6966 2070  se None.    if p
+0003d590: 6172 656e 745f 6d65 7461 2069 7320 4e6f  arent_meta is No
+0003d5a0: 6e65 2061 6e64 2064 6673 3a0a 2020 2020  ne and dfs:.    
+0003d5b0: 2020 2020 7061 7265 6e74 5f6d 6574 6120      parent_meta 
+0003d5c0: 3d20 6466 735b 305d 2e5f 6d65 7461 0a20  = dfs[0]._meta. 
+0003d5d0: 2020 2069 6620 6d65 7461 2069 7320 6e6f     if meta is no
+0003d5e0: 5f64 6566 6175 6c74 3a0a 2020 2020 2020  _default:.      
+0003d5f0: 2020 2320 5573 6520 6e6f 6e2d 6e6f 726d    # Use non-norm
+0003d600: 616c 697a 6564 206b 7761 7267 7320 6865  alized kwargs he
+0003d610: 7265 2c20 6173 2077 6520 7761 6e74 2074  re, as we want t
+0003d620: 6865 2072 6561 6c20 7661 6c75 6573 2028  he real values (
+0003d630: 6e6f 740a 2020 2020 2020 2020 2320 6465  not.        # de
+0003d640: 6c61 7965 6420 7661 6c75 6573 290a 2020  layed values).  
+0003d650: 2020 2020 2020 6d65 7461 203d 205f 656d        meta = _em
+0003d660: 756c 6174 6528 6675 6e63 2c20 2a61 7267  ulate(func, *arg
+0003d670: 732c 2075 6466 3d54 7275 652c 202a 2a6b  s, udf=True, **k
+0003d680: 7761 7267 7329 0a20 2020 2020 2020 206d  wargs).        m
+0003d690: 6574 615f 6973 5f65 6d75 6c61 7465 6420  eta_is_emulated 
+0003d6a0: 3d20 5472 7565 0a20 2020 2065 6c73 653a  = True.    else:
+0003d6b0: 0a20 2020 2020 2020 206d 6574 6120 3d20  .        meta = 
+0003d6c0: 6d61 6b65 5f6d 6574 6128 6d65 7461 2c20  make_meta(meta, 
+0003d6d0: 696e 6465 783d 6d65 7461 5f69 6e64 6578  index=meta_index
+0003d6e0: 2c20 7061 7265 6e74 5f6d 6574 613d 7061  , parent_meta=pa
+0003d6f0: 7265 6e74 5f6d 6574 6129 0a20 2020 2020  rent_meta).     
+0003d700: 2020 206d 6574 615f 6973 5f65 6d75 6c61     meta_is_emula
+0003d710: 7465 6420 3d20 4661 6c73 650a 0a20 2020  ted = False..   
+0003d720: 2069 6620 6e6f 7420 2868 6173 5f70 6172   if not (has_par
+0003d730: 616c 6c65 6c5f 7479 7065 286d 6574 6129  allel_type(meta)
+0003d740: 206f 7220 6973 5f61 7272 6179 6c69 6b65   or is_arraylike
+0003d750: 286d 6574 6129 2061 6e64 206d 6574 612e  (meta) and meta.
+0003d760: 7368 6170 6529 2061 6e64 206e 6f74 2061  shape) and not a
+0003d770: 6c6c 280a 2020 2020 2020 2020 6973 696e  ll(.        isin
+0003d780: 7374 616e 6365 2861 7267 2c20 5363 616c  stance(arg, Scal
+0003d790: 6172 2920 666f 7220 6172 6720 696e 2061  ar) for arg in a
+0003d7a0: 7267 730a 2020 2020 293a 0a20 2020 2020  rgs.    ):.     
+0003d7b0: 2020 2069 6620 6e6f 7420 6d65 7461 5f69     if not meta_i
+0003d7c0: 735f 656d 756c 6174 6564 3a0a 2020 2020  s_emulated:.    
+0003d7d0: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+0003d7e0: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
+0003d7f0: 2020 2020 2020 2022 4d65 7461 2069 7320         "Meta is 
+0003d800: 6e6f 7420 7661 6c69 642c 2060 6d61 705f  not valid, `map_
+0003d810: 7061 7274 6974 696f 6e73 6020 616e 6420  partitions` and 
+0003d820: 606d 6170 5f6f 7665 726c 6170 6020 6578  `map_overlap` ex
+0003d830: 7065 6374 7320 6f75 7470 7574 2074 6f20  pects output to 
+0003d840: 6265 2061 2070 616e 6461 7320 6f62 6a65  be a pandas obje
+0003d850: 6374 2e20 220a 2020 2020 2020 2020 2020  ct. ".          
+0003d860: 2020 2020 2020 2254 7279 2070 6173 7369        "Try passi
+0003d870: 6e67 2061 2070 616e 6461 7320 6f62 6a65  ng a pandas obje
+0003d880: 6374 2061 7320 6d65 7461 206f 7220 6120  ct as meta or a 
+0003d890: 6469 6374 206f 7220 7475 706c 6520 7265  dict or tuple re
+0003d8a0: 7072 6573 656e 7469 6e67 2074 6865 2022  presenting the "
+0003d8b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003d8c0: 2022 286e 616d 652c 2064 7479 7065 2920   "(name, dtype) 
+0003d8d0: 6f66 2074 6865 2063 6f6c 756d 6e73 2e20  of the columns. 
+0003d8e0: 496e 2074 6865 2066 7574 7572 6520 7468  In the future th
+0003d8f0: 6520 6d65 7461 2079 6f75 2070 6173 7365  e meta you passe
+0003d900: 6420 7769 6c6c 206e 6f74 2077 6f72 6b2e  d will not work.
+0003d910: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0003d920: 2020 2046 7574 7572 6557 6172 6e69 6e67     FutureWarning
+0003d930: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0003d940: 2020 2020 2020 2020 2320 4966 2060 6d65          # If `me
+0003d950: 7461 6020 6973 206e 6f74 2061 2070 616e  ta` is not a pan
+0003d960: 6461 7320 6f62 6a65 6374 2c20 7468 6520  das object, the 
+0003d970: 636f 6e63 6174 656e 6174 6564 2072 6573  concatenated res
+0003d980: 756c 7473 2077 696c 6c20 6265 2061 0a20  ults will be a. 
+0003d990: 2020 2020 2020 2023 2064 6966 6665 7265         # differe
+0003d9a0: 6e74 2074 7970 650a 2020 2020 2020 2020  nt type.        
+0003d9b0: 6d65 7461 203d 206d 616b 655f 6d65 7461  meta = make_meta
+0003d9c0: 285f 636f 6e63 6174 285b 6d65 7461 5d29  (_concat([meta])
+0003d9d0: 2c20 696e 6465 783d 6d65 7461 5f69 6e64  , index=meta_ind
+0003d9e0: 6578 290a 0a20 2020 2023 2045 6e73 7572  ex)..    # Ensur
+0003d9f0: 6520 6d65 7461 2069 7320 656d 7074 7920  e meta is empty 
+0003da00: 7365 7269 6573 0a20 2020 206d 6574 6120  series.    meta 
+0003da10: 3d20 6d61 6b65 5f6d 6574 6128 6d65 7461  = make_meta(meta
+0003da20: 2c20 7061 7265 6e74 5f6d 6574 613d 7061  , parent_meta=pa
+0003da30: 7265 6e74 5f6d 6574 6129 0a0a 2020 2020  rent_meta)..    
+0003da40: 7265 7475 726e 206d 6574 610a 0a0a 6465  return meta...de
+0003da50: 6620 6170 706c 795f 616e 645f 656e 666f  f apply_and_enfo
+0003da60: 7263 6528 2a61 7267 732c 202a 2a6b 7761  rce(*args, **kwa
+0003da70: 7267 7329 3a0a 2020 2020 2222 2241 7070  rgs):.    """App
+0003da80: 6c79 2061 2066 756e 6374 696f 6e2c 2061  ly a function, a
+0003da90: 6e64 2065 6e66 6f72 6365 2074 6865 206f  nd enforce the o
+0003daa0: 7574 7075 7420 746f 206d 6174 6368 206d  utput to match m
+0003dab0: 6574 610a 0a20 2020 2045 6e73 7572 6573  eta..    Ensures
+0003dac0: 2074 6865 206f 7574 7075 7420 6861 7320   the output has 
+0003dad0: 7468 6520 7361 6d65 2063 6f6c 756d 6e73  the same columns
+0003dae0: 2c20 6576 656e 2069 6620 656d 7074 792e  , even if empty.
+0003daf0: 2222 220a 2020 2020 6675 6e63 203d 206b  """.    func = k
+0003db00: 7761 7267 732e 706f 7028 225f 6675 6e63  wargs.pop("_func
+0003db10: 2229 0a20 2020 206d 6574 6120 3d20 6b77  ").    meta = kw
+0003db20: 6172 6773 2e70 6f70 2822 5f6d 6574 6122  args.pop("_meta"
+0003db30: 290a 2020 2020 6466 203d 2066 756e 6328  ).    df = func(
+0003db40: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+0003db50: 0a20 2020 2069 6620 6973 5f64 6174 6166  .    if is_dataf
+0003db60: 7261 6d65 5f6c 696b 6528 6466 2920 6f72  rame_like(df) or
+0003db70: 2069 735f 7365 7269 6573 5f6c 696b 6528   is_series_like(
+0003db80: 6466 2920 6f72 2069 735f 696e 6465 785f  df) or is_index_
+0003db90: 6c69 6b65 2864 6629 3a0a 2020 2020 2020  like(df):.      
+0003dba0: 2020 6966 206e 6f74 206c 656e 2864 6629    if not len(df)
+0003dbb0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0003dbc0: 7475 726e 206d 6574 610a 2020 2020 2020  turn meta.      
+0003dbd0: 2020 6966 2069 735f 6461 7461 6672 616d    if is_datafram
+0003dbe0: 655f 6c69 6b65 2864 6629 3a0a 2020 2020  e_like(df):.    
+0003dbf0: 2020 2020 2020 2020 6368 6563 6b5f 6d61          check_ma
+0003dc00: 7463 6869 6e67 5f63 6f6c 756d 6e73 286d  tching_columns(m
+0003dc10: 6574 612c 2064 6629 0a20 2020 2020 2020  eta, df).       
+0003dc20: 2020 2020 2063 203d 206d 6574 612e 636f       c = meta.co
+0003dc30: 6c75 6d6e 730a 2020 2020 2020 2020 656c  lumns.        el
+0003dc40: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0003dc50: 6320 3d20 6d65 7461 2e6e 616d 650a 2020  c = meta.name.  
+0003dc60: 2020 2020 2020 7265 7475 726e 205f 7265        return _re
+0003dc70: 6e61 6d65 2863 2c20 6466 290a 2020 2020  name(c, df).    
+0003dc80: 7265 7475 726e 2064 660a 0a0a 6465 6620  return df...def 
+0003dc90: 5f72 656e 616d 6528 636f 6c75 6d6e 732c  _rename(columns,
+0003dca0: 2064 6629 3a0a 2020 2020 2222 220a 2020   df):.    """.  
+0003dcb0: 2020 5265 6e61 6d65 2063 6f6c 756d 6e73    Rename columns
+0003dcc0: 206f 6620 7064 2e44 6174 6146 7261 6d65   of pd.DataFrame
+0003dcd0: 206f 7220 6e61 6d65 206f 6620 7064 2e53   or name of pd.S
+0003dce0: 6572 6965 732e 0a20 2020 204e 6f74 2066  eries..    Not f
+0003dcf0: 6f72 2064 642e 4461 7461 4672 616d 6520  or dd.DataFrame 
+0003dd00: 6f72 2064 642e 5365 7269 6573 2e0a 0a20  or dd.Series... 
+0003dd10: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+0003dd20: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+0003dd30: 2063 6f6c 756d 6e73 203a 2074 7570 6c65   columns : tuple
+0003dd40: 2c20 7374 7269 6e67 2c20 7064 2e44 6174  , string, pd.Dat
+0003dd50: 6146 7261 6d65 206f 7220 7064 2e53 6572  aFrame or pd.Ser
+0003dd60: 6965 730a 2020 2020 2020 2020 436f 6c75  ies.        Colu
+0003dd70: 6d6e 206e 616d 6573 2c20 5365 7269 6573  mn names, Series
+0003dd80: 206e 616d 6520 6f72 2070 616e 6461 7320   name or pandas 
+0003dd90: 696e 7374 616e 6365 2077 6869 6368 2068  instance which h
+0003dda0: 6173 2074 6865 0a20 2020 2020 2020 2074  as the.        t
+0003ddb0: 6172 6765 7420 636f 6c75 6d6e 206e 616d  arget column nam
+0003ddc0: 6573 202f 206e 616d 652e 0a20 2020 2064  es / name..    d
+0003ddd0: 6620 3a20 7064 2e44 6174 6146 7261 6d65  f : pd.DataFrame
+0003dde0: 206f 7220 7064 2e53 6572 6965 730a 2020   or pd.Series.  
+0003ddf0: 2020 2020 2020 7461 7267 6574 2044 6174        target Dat
+0003de00: 6146 7261 6d65 202f 2053 6572 6965 7320  aFrame / Series 
+0003de10: 746f 2062 6520 7265 6e61 6d65 640a 2020  to be renamed.  
+0003de20: 2020 2222 220a 2020 2020 6173 7365 7274    """.    assert
+0003de30: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+0003de40: 6466 2c20 5f46 7261 6d65 290a 0a20 2020  df, _Frame)..   
+0003de50: 2069 6620 636f 6c75 6d6e 7320 6973 206e   if columns is n
+0003de60: 6f5f 6465 6661 756c 743a 0a20 2020 2020  o_default:.     
+0003de70: 2020 2072 6574 7572 6e20 6466 0a0a 2020     return df..  
+0003de80: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0003de90: 636f 6c75 6d6e 732c 2049 7465 7261 746f  columns, Iterato
+0003dea0: 7229 3a0a 2020 2020 2020 2020 636f 6c75  r):.        colu
+0003deb0: 6d6e 7320 3d20 6c69 7374 2863 6f6c 756d  mns = list(colum
+0003dec0: 6e73 290a 0a20 2020 2069 6620 6973 5f64  ns)..    if is_d
+0003ded0: 6174 6166 7261 6d65 5f6c 696b 6528 6466  ataframe_like(df
+0003dee0: 293a 0a20 2020 2020 2020 2069 6620 6973  ):.        if is
+0003def0: 5f64 6174 6166 7261 6d65 5f6c 696b 6528  _dataframe_like(
+0003df00: 636f 6c75 6d6e 7329 3a0a 2020 2020 2020  columns):.      
+0003df10: 2020 2020 2020 636f 6c75 6d6e 7320 3d20        columns = 
+0003df20: 636f 6c75 6d6e 732e 636f 6c75 6d6e 730a  columns.columns.
+0003df30: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
+0003df40: 7369 6e73 7461 6e63 6528 636f 6c75 6d6e  sinstance(column
+0003df50: 732c 2070 642e 496e 6465 7829 3a0a 2020  s, pd.Index):.  
+0003df60: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+0003df70: 7320 3d20 7064 2e49 6e64 6578 2863 6f6c  s = pd.Index(col
+0003df80: 756d 6e73 290a 2020 2020 2020 2020 6966  umns).        if
+0003df90: 2028 0a20 2020 2020 2020 2020 2020 206c   (.            l
+0003dfa0: 656e 2863 6f6c 756d 6e73 2920 3d3d 206c  en(columns) == l
+0003dfb0: 656e 2864 662e 636f 6c75 6d6e 7329 0a20  en(df.columns). 
+0003dfc0: 2020 2020 2020 2020 2020 2061 6e64 2074             and t
+0003dfd0: 7970 6528 636f 6c75 6d6e 7329 2069 7320  ype(columns) is 
+0003dfe0: 7479 7065 2864 662e 636f 6c75 6d6e 7329  type(df.columns)
+0003dff0: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+0003e000: 2063 6f6c 756d 6e73 2e64 7479 7065 203d   columns.dtype =
+0003e010: 3d20 6466 2e63 6f6c 756d 6e73 2e64 7479  = df.columns.dty
+0003e020: 7065 0a20 2020 2020 2020 2020 2020 2061  pe.            a
+0003e030: 6e64 2063 6f6c 756d 6e73 2e65 7175 616c  nd columns.equal
+0003e040: 7328 6466 2e63 6f6c 756d 6e73 290a 2020  s(df.columns).  
+0003e050: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+0003e060: 2020 2020 2023 2069 6620 7461 7267 6574       # if target
+0003e070: 2069 7320 6964 656e 7469 6361 6c2c 2072   is identical, r
+0003e080: 656e 616d 6520 6973 206e 6f74 206e 6563  ename is not nec
+0003e090: 6573 7361 7279 0a20 2020 2020 2020 2020  essary.         
+0003e0a0: 2020 2072 6574 7572 6e20 6466 0a20 2020     return df.   
+0003e0b0: 2020 2020 2023 2064 6565 703d 4661 6c73       # deep=Fals
+0003e0c0: 6520 646f 6573 6e27 7420 646f 6573 6e27  e doesn't doesn'
+0003e0d0: 7420 636f 7079 2061 6e79 2064 6174 612f  t copy any data/
+0003e0e0: 696e 6469 6365 732c 2073 6f20 7468 6973  indices, so this
+0003e0f0: 2069 7320 6368 6561 700a 2020 2020 2020   is cheap.      
+0003e100: 2020 6466 203d 2064 662e 636f 7079 2864    df = df.copy(d
+0003e110: 6565 703d 4661 6c73 6529 0a20 2020 2020  eep=False).     
+0003e120: 2020 2064 662e 636f 6c75 6d6e 7320 3d20     df.columns = 
+0003e130: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
+0003e140: 7265 7475 726e 2064 660a 2020 2020 656c  return df.    el
+0003e150: 6966 2069 735f 7365 7269 6573 5f6c 696b  if is_series_lik
+0003e160: 6528 6466 2920 6f72 2069 735f 696e 6465  e(df) or is_inde
+0003e170: 785f 6c69 6b65 2864 6629 3a0a 2020 2020  x_like(df):.    
+0003e180: 2020 2020 6966 2069 735f 7365 7269 6573      if is_series
+0003e190: 5f6c 696b 6528 636f 6c75 6d6e 7329 206f  _like(columns) o
+0003e1a0: 7220 6973 5f69 6e64 6578 5f6c 696b 6528  r is_index_like(
+0003e1b0: 636f 6c75 6d6e 7329 3a0a 2020 2020 2020  columns):.      
+0003e1c0: 2020 2020 2020 636f 6c75 6d6e 7320 3d20        columns = 
+0003e1d0: 636f 6c75 6d6e 732e 6e61 6d65 0a20 2020  columns.name.   
+0003e1e0: 2020 2020 2069 6620 6466 2e6e 616d 6520       if df.name 
+0003e1f0: 3d3d 2063 6f6c 756d 6e73 3a0a 2020 2020  == columns:.    
+0003e200: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+0003e210: 660a 2020 2020 2020 2020 7265 7475 726e  f.        return
+0003e220: 2064 662e 7265 6e61 6d65 2863 6f6c 756d   df.rename(colum
+0003e230: 6e73 290a 2020 2020 2320 6d61 705f 7061  ns).    # map_pa
+0003e240: 7274 6974 696f 6e20 6d61 7920 7061 7373  rtition may pass
+0003e250: 206f 7468 6572 2074 7970 6573 0a20 2020   other types.   
+0003e260: 2072 6574 7572 6e20 6466 0a0a 0a64 6566   return df...def
+0003e270: 205f 7265 6e61 6d65 5f64 6173 6b28 6466   _rename_dask(df
+0003e280: 2c20 6e61 6d65 7329 3a0a 2020 2020 2222  , names):.    ""
+0003e290: 220a 2020 2020 4465 7374 7275 6374 6976  ".    Destructiv
+0003e2a0: 656c 7920 7265 6e61 6d65 2063 6f6c 756d  ely rename colum
+0003e2b0: 6e73 206f 6620 6464 2e44 6174 6146 7261  ns of dd.DataFra
+0003e2c0: 6d65 206f 7220 6e61 6d65 206f 6620 6464  me or name of dd
+0003e2d0: 2e53 6572 6965 732e 0a20 2020 204e 6f74  .Series..    Not
+0003e2e0: 2066 6f72 2070 642e 4461 7461 4672 616d   for pd.DataFram
+0003e2f0: 6520 6f72 2070 642e 5365 7269 6573 2e0a  e or pd.Series..
+0003e300: 0a20 2020 2049 6e74 6572 6e61 6c6c 7920  .    Internally 
+0003e310: 7573 6564 2074 6f20 6f76 6572 7772 6974  used to overwrit
+0003e320: 6520 6464 2e44 6174 6146 7261 6d65 2e63  e dd.DataFrame.c
+0003e330: 6f6c 756d 6e73 2061 6e64 2064 642e 5365  olumns and dd.Se
+0003e340: 7269 6573 2e6e 616d 650a 2020 2020 5765  ries.name.    We
+0003e350: 2063 616e 2774 2075 7365 206d 6170 5f70   can't use map_p
+0003e360: 6172 7469 7469 6f6e 2062 6563 6175 7365  artition because
+0003e370: 2069 7420 6170 706c 6965 7320 6675 6e63   it applies func
+0003e380: 7469 6f6e 2074 6865 6e20 7265 6e61 6d65  tion then rename
+0003e390: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+0003e3a0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+0003e3b0: 2020 2020 6466 203a 2064 642e 4461 7461      df : dd.Data
+0003e3c0: 4672 616d 6520 6f72 2064 642e 5365 7269  Frame or dd.Seri
+0003e3d0: 6573 0a20 2020 2020 2020 2074 6172 6765  es.        targe
+0003e3e0: 7420 4461 7461 4672 616d 6520 2f20 5365  t DataFrame / Se
+0003e3f0: 7269 6573 2074 6f20 6265 2072 656e 616d  ries to be renam
+0003e400: 6564 0a20 2020 206e 616d 6573 203a 2074  ed.    names : t
+0003e410: 7570 6c65 2c20 7374 7269 6e67 0a20 2020  uple, string.   
+0003e420: 2020 2020 2043 6f6c 756d 6e20 6e61 6d65       Column name
+0003e430: 732f 5365 7269 6573 206e 616d 650a 2020  s/Series name.  
+0003e440: 2020 2222 220a 0a20 2020 2061 7373 6572    """..    asser
+0003e450: 7420 6973 696e 7374 616e 6365 2864 662c  t isinstance(df,
+0003e460: 205f 4672 616d 6529 0a20 2020 206d 6574   _Frame).    met
+0003e470: 6164 6174 6120 3d20 5f72 656e 616d 6528  adata = _rename(
+0003e480: 6e61 6d65 732c 2064 662e 5f6d 6574 6129  names, df._meta)
+0003e490: 0a20 2020 206e 616d 6520 3d20 6622 7265  .    name = f"re
+0003e4a0: 6e61 6d65 2d7b 746f 6b65 6e69 7a65 2864  name-{tokenize(d
+0003e4b0: 662c 206d 6574 6164 6174 6129 7d22 0a0a  f, metadata)}"..
+0003e4c0: 2020 2020 6473 6b20 3d20 7061 7274 6974      dsk = partit
+0003e4d0: 696f 6e77 6973 655f 6772 6170 6828 5f72  ionwise_graph(_r
+0003e4e0: 656e 616d 652c 206e 616d 652c 206d 6574  ename, name, met
+0003e4f0: 6164 6174 612c 2064 6629 0a20 2020 2067  adata, df).    g
+0003e500: 7261 7068 203d 2048 6967 684c 6576 656c  raph = HighLevel
+0003e510: 4772 6170 682e 6672 6f6d 5f63 6f6c 6c65  Graph.from_colle
+0003e520: 6374 696f 6e73 286e 616d 652c 2064 736b  ctions(name, dsk
+0003e530: 2c20 6465 7065 6e64 656e 6369 6573 3d5b  , dependencies=[
+0003e540: 6466 5d29 0a20 2020 2072 6574 7572 6e20  df]).    return 
+0003e550: 6e65 775f 6464 5f6f 626a 6563 7428 6772  new_dd_object(gr
+0003e560: 6170 682c 206e 616d 652c 206d 6574 6164  aph, name, metad
+0003e570: 6174 612c 2064 662e 6469 7669 7369 6f6e  ata, df.division
+0003e580: 7329 0a0a 0a64 6566 2071 7561 6e74 696c  s)...def quantil
+0003e590: 6528 6466 2c20 712c 206d 6574 686f 643d  e(df, q, method=
+0003e5a0: 2264 6566 6175 6c74 2229 3a0a 2020 2020  "default"):.    
+0003e5b0: 2222 2241 7070 726f 7869 6d61 7465 2071  """Approximate q
+0003e5c0: 7561 6e74 696c 6573 206f 6620 5365 7269  uantiles of Seri
+0003e5d0: 6573 2e0a 0a20 2020 2050 6172 616d 6574  es...    Paramet
+0003e5e0: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
+0003e5f0: 2d2d 0a20 2020 2071 203a 206c 6973 742f  --.    q : list/
+0003e600: 6172 7261 7920 6f66 2066 6c6f 6174 730a  array of floats.
+0003e610: 2020 2020 2020 2020 4974 6572 6162 6c65          Iterable
+0003e620: 206f 6620 6e75 6d62 6572 7320 7261 6e67   of numbers rang
+0003e630: 696e 6720 6672 6f6d 2030 2074 6f20 3130  ing from 0 to 10
+0003e640: 3020 666f 7220 7468 6520 6465 7369 7265  0 for the desire
+0003e650: 6420 7175 616e 7469 6c65 730a 2020 2020  d quantiles.    
+0003e660: 6d65 7468 6f64 203a 207b 2764 6566 6175  method : {'defau
+0003e670: 6c74 272c 2027 7464 6967 6573 7427 2c20  lt', 'tdigest', 
+0003e680: 2764 6173 6b27 7d2c 206f 7074 696f 6e61  'dask'}, optiona
+0003e690: 6c0a 2020 2020 2020 2020 5768 6174 206d  l.        What m
+0003e6a0: 6574 686f 6420 746f 2075 7365 2e20 4279  ethod to use. By
+0003e6b0: 2064 6566 6175 6c74 2077 696c 6c20 7573   default will us
+0003e6c0: 6520 6461 736b 2773 2069 6e74 6572 6e61  e dask's interna
+0003e6d0: 6c20 6375 7374 6f6d 0a20 2020 2020 2020  l custom.       
+0003e6e0: 2061 6c67 6f72 6974 686d 2028 6060 2764   algorithm (``'d
+0003e6f0: 6173 6b27 6060 292e 2020 4966 2073 6574  ask'``).  If set
+0003e700: 2074 6f20 6060 2774 6469 6765 7374 2760   to ``'tdigest'`
+0003e710: 6020 7769 6c6c 2075 7365 2074 6469 6765  ` will use tdige
+0003e720: 7374 2066 6f72 0a20 2020 2020 2020 2066  st for.        f
+0003e730: 6c6f 6174 7320 616e 6420 696e 7473 2061  loats and ints a
+0003e740: 6e64 2066 616c 6c62 6163 6b20 746f 2074  nd fallback to t
+0003e750: 6865 2060 6027 6461 736b 2760 6020 6f74  he ``'dask'`` ot
+0003e760: 6865 7277 6973 652e 0a20 2020 2022 2222  herwise..    """
+0003e770: 0a20 2020 2023 2063 7572 7265 6e74 2069  .    # current i
+0003e780: 6d70 6c65 6d65 6e74 6174 696f 6e20 6e65  mplementation ne
+0003e790: 6564 7320 7120 746f 2062 6520 736f 7274  eds q to be sort
+0003e7a0: 6564 2073 6f0a 2020 2020 2320 736f 7274  ed so.    # sort
+0003e7b0: 2069 6620 6172 7261 792d 6c69 6b65 2c20   if array-like, 
+0003e7c0: 6f74 6865 7277 6973 6520 6c65 6176 6520  otherwise leave 
+0003e7d0: 6974 2061 6c6f 6e65 0a20 2020 2071 5f6e  it alone.    q_n
+0003e7e0: 6461 7272 6179 203d 206e 702e 6172 7261  darray = np.arra
+0003e7f0: 7928 7129 0a20 2020 2069 6620 715f 6e64  y(q).    if q_nd
+0003e800: 6172 7261 792e 6e64 696d 203e 2030 3a0a  array.ndim > 0:.
+0003e810: 2020 2020 2020 2020 715f 6e64 6172 7261          q_ndarra
+0003e820: 792e 736f 7274 286b 696e 643d 226d 6572  y.sort(kind="mer
+0003e830: 6765 736f 7274 2229 0a20 2020 2020 2020  gesort").       
+0003e840: 2071 203d 2071 5f6e 6461 7272 6179 0a0a   q = q_ndarray..
+0003e850: 2020 2020 6173 7365 7274 2069 7369 6e73      assert isins
+0003e860: 7461 6e63 6528 6466 2c20 5365 7269 6573  tance(df, Series
+0003e870: 290a 0a20 2020 2061 6c6c 6f77 6564 5f6d  )..    allowed_m
+0003e880: 6574 686f 6473 203d 205b 2264 6566 6175  ethods = ["defau
+0003e890: 6c74 222c 2022 6461 736b 222c 2022 7464  lt", "dask", "td
+0003e8a0: 6967 6573 7422 5d0a 2020 2020 6966 206d  igest"].    if m
+0003e8b0: 6574 686f 6420 6e6f 7420 696e 2061 6c6c  ethod not in all
+0003e8c0: 6f77 6564 5f6d 6574 686f 6473 3a0a 2020  owed_methods:.  
+0003e8d0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0003e8e0: 6545 7272 6f72 2822 6d65 7468 6f64 2063  eError("method c
+0003e8f0: 616e 206f 6e6c 7920 6265 2027 6465 6661  an only be 'defa
+0003e900: 756c 7427 2c20 2764 6173 6b27 206f 7220  ult', 'dask' or 
+0003e910: 2774 6469 6765 7374 2722 290a 0a20 2020  'tdigest'")..   
+0003e920: 2069 6620 6d65 7468 6f64 203d 3d20 2264   if method == "d
+0003e930: 6566 6175 6c74 223a 0a20 2020 2020 2020  efault":.       
+0003e940: 2069 6e74 6572 6e61 6c5f 6d65 7468 6f64   internal_method
+0003e950: 203d 2022 6461 736b 220a 2020 2020 656c   = "dask".    el
+0003e960: 7365 3a0a 2020 2020 2020 2020 696e 7465  se:.        inte
+0003e970: 726e 616c 5f6d 6574 686f 6420 3d20 6d65  rnal_method = me
+0003e980: 7468 6f64 0a0a 2020 2020 2320 6375 7272  thod..    # curr
+0003e990: 656e 746c 792c 206f 6e6c 7920 5365 7269  ently, only Seri
+0003e9a0: 6573 2068 6173 2071 7561 6e74 696c 6520  es has quantile 
+0003e9b0: 6d65 7468 6f64 0a20 2020 2069 6620 6973  method.    if is
+0003e9c0: 696e 7374 616e 6365 2864 662c 2049 6e64  instance(df, Ind
+0003e9d0: 6578 293a 0a20 2020 2020 2020 2073 6572  ex):.        ser
+0003e9e0: 6965 735f 7479 7020 3d20 6466 2e5f 6d65  ies_typ = df._me
+0003e9f0: 7461 2e74 6f5f 7365 7269 6573 2829 2e5f  ta.to_series()._
+0003ea00: 636f 6e73 7472 7563 746f 720a 2020 2020  constructor.    
+0003ea10: 2020 2020 6d65 7461 203d 2064 662e 5f6d      meta = df._m
+0003ea20: 6574 615f 6e6f 6e65 6d70 7479 2e74 6f5f  eta_nonempty.to_
+0003ea30: 7365 7269 6573 2829 2e71 7561 6e74 696c  series().quantil
+0003ea40: 6528 7129 0a20 2020 2065 6c73 653a 0a20  e(q).    else:. 
+0003ea50: 2020 2020 2020 2069 6620 6973 5f73 6572         if is_ser
+0003ea60: 6965 735f 6c69 6b65 2864 662e 5f6d 6574  ies_like(df._met
+0003ea70: 6129 3a0a 2020 2020 2020 2020 2020 2020  a):.            
+0003ea80: 7365 7269 6573 5f74 7970 203d 2064 662e  series_typ = df.
+0003ea90: 5f6d 6574 612e 5f63 6f6e 7374 7275 6374  _meta._construct
+0003eaa0: 6f72 0a20 2020 2020 2020 2065 6c73 653a  or.        else:
+0003eab0: 0a20 2020 2020 2020 2020 2020 2073 6572  .            ser
+0003eac0: 6965 735f 7479 7020 3d20 6466 2e5f 6d65  ies_typ = df._me
+0003ead0: 7461 2e5f 636f 6e73 7472 7563 746f 725f  ta._constructor_
+0003eae0: 736c 6963 6564 0a20 2020 2020 2020 206d  sliced.        m
+0003eaf0: 6574 6120 3d20 6466 2e5f 6d65 7461 5f6e  eta = df._meta_n
+0003eb00: 6f6e 656d 7074 792e 7175 616e 7469 6c65  onempty.quantile
+0003eb10: 2871 290a 0a20 2020 2069 6620 6973 5f73  (q)..    if is_s
+0003eb20: 6572 6965 735f 6c69 6b65 286d 6574 6129  eries_like(meta)
+0003eb30: 3a0a 2020 2020 2020 2020 2320 496e 6465  :.        # Inde
+0003eb40: 782e 7175 616e 7469 6c65 286c 6973 742d  x.quantile(list-
+0003eb50: 6c69 6b65 2920 6d75 7374 2062 6520 7064  like) must be pd
+0003eb60: 2e53 6572 6965 732c 206e 6f74 2070 642e  .Series, not pd.
+0003eb70: 496e 6465 780a 2020 2020 2020 2020 6466  Index.        df
+0003eb80: 5f6e 616d 6520 3d20 6466 2e6e 616d 650a  _name = df.name.
+0003eb90: 2020 2020 2020 2020 6669 6e61 6c69 7a65          finalize
+0003eba0: 5f74 736b 203d 206c 616d 6264 6120 7473  _tsk = lambda ts
+0003ebb0: 6b3a 2028 7365 7269 6573 5f74 7970 2c20  k: (series_typ, 
+0003ebc0: 7473 6b2c 2071 2c20 4e6f 6e65 2c20 6466  tsk, q, None, df
+0003ebd0: 5f6e 616d 6529 0a20 2020 2020 2020 2072  _name).        r
+0003ebe0: 6574 7572 6e5f 7479 7065 203d 2053 6572  eturn_type = Ser
+0003ebf0: 6965 730a 2020 2020 656c 7365 3a0a 2020  ies.    else:.  
+0003ec00: 2020 2020 2020 2320 7265 7061 636b 2061        # repack a
+0003ec10: 7320 5365 7269 6573 206f 626a 6563 7420  s Series object 
+0003ec20: 746f 2063 6f6e 7665 7274 2073 6361 6c61  to convert scala
+0003ec30: 7273 2066 726f 6d20 4e75 6d50 7920 6261  rs from NumPy ba
+0003ec40: 636b 2062 6566 6f72 6520 6578 7472 6163  ck before extrac
+0003ec50: 7469 6e67 0a20 2020 2020 2020 2066 696e  ting.        fin
+0003ec60: 616c 697a 655f 7473 6b20 3d20 6c61 6d62  alize_tsk = lamb
+0003ec70: 6461 2074 736b 3a20 280a 2020 2020 2020  da tsk: (.      
+0003ec80: 2020 2020 2020 6c61 6d62 6461 202a 6172        lambda *ar
+0003ec90: 6773 2c20 2a2a 6b77 6172 6773 3a20 7365  gs, **kwargs: se
+0003eca0: 7269 6573 5f74 7970 282a 6172 6773 2c20  ries_typ(*args, 
+0003ecb0: 2a2a 6b77 6172 6773 295b 305d 2c0a 2020  **kwargs)[0],.  
+0003ecc0: 2020 2020 2020 2020 2020 7473 6b2c 0a20            tsk,. 
+0003ecd0: 2020 2020 2020 2020 2020 205b 305d 2c0a             [0],.
+0003ece0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0003ecf0: 2020 7265 7475 726e 5f74 7970 6520 3d20    return_type = 
+0003ed00: 5363 616c 6172 0a20 2020 2020 2020 2071  Scalar.        q
+0003ed10: 203d 205b 715d 0a0a 2020 2020 2320 7061   = [q]..    # pa
+0003ed20: 6e64 6173 2075 7365 7320 7175 616e 7469  ndas uses quanti
+0003ed30: 6c65 2069 6e20 5b30 2c20 315d 0a20 2020  le in [0, 1].   
+0003ed40: 2023 206e 756d 7079 202f 2065 7665 7279   # numpy / every
+0003ed50: 6f6e 6520 656c 7365 2075 7365 7320 5b30  one else uses [0
+0003ed60: 2c20 3130 305d 0a20 2020 2071 7320 3d20  , 100].    qs = 
+0003ed70: 6e70 2e61 7361 7272 6179 2871 2920 2a20  np.asarray(q) * 
+0003ed80: 3130 300a 2020 2020 746f 6b65 6e20 3d20  100.    token = 
+0003ed90: 746f 6b65 6e69 7a65 2864 662c 2071 7329  tokenize(df, qs)
+0003eda0: 0a0a 2020 2020 6966 206c 656e 2871 7329  ..    if len(qs)
+0003edb0: 203d 3d20 303a 0a20 2020 2020 2020 206e   == 0:.        n
+0003edc0: 616d 6520 3d20 2271 7561 6e74 696c 6573  ame = "quantiles
+0003edd0: 2d22 202b 2074 6f6b 656e 0a20 2020 2020  -" + token.     
+0003ede0: 2020 2065 6d70 7479 5f69 6e64 6578 203d     empty_index =
+0003edf0: 2070 642e 496e 6465 7828 5b5d 2c20 6474   pd.Index([], dt
+0003ee00: 7970 653d 666c 6f61 7429 0a0a 2020 2020  ype=float)..    
+0003ee10: 2020 2020 7265 7475 726e 2053 6572 6965      return Serie
+0003ee20: 7328 0a20 2020 2020 2020 2020 2020 207b  s(.            {
+0003ee30: 286e 616d 652c 2030 293a 2073 6572 6965  (name, 0): serie
+0003ee40: 735f 7479 7028 5b5d 2c20 6e61 6d65 3d64  s_typ([], name=d
+0003ee50: 662e 6e61 6d65 2c20 696e 6465 783d 656d  f.name, index=em
+0003ee60: 7074 795f 696e 6465 782c 2064 7479 7065  pty_index, dtype
+0003ee70: 3d22 666c 6f61 7422 297d 2c0a 2020 2020  ="float")},.    
+0003ee80: 2020 2020 2020 2020 6e61 6d65 2c0a 2020          name,.  
+0003ee90: 2020 2020 2020 2020 2020 6466 2e5f 6d65            df._me
+0003eea0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+0003eeb0: 5b4e 6f6e 652c 204e 6f6e 655d 2c0a 2020  [None, None],.  
+0003eec0: 2020 2020 2020 290a 2020 2020 656c 7365        ).    else
+0003eed0: 3a0a 2020 2020 2020 2020 6e65 775f 6469  :.        new_di
+0003eee0: 7669 7369 6f6e 7320 3d20 5b6e 702e 6d69  visions = [np.mi
+0003eef0: 6e28 7129 2c20 6e70 2e6d 6178 2871 295d  n(q), np.max(q)]
+0003ef00: 0a0a 2020 2020 6466 203d 2064 662e 6472  ..    df = df.dr
+0003ef10: 6f70 6e61 2829 0a0a 2020 2020 6966 2069  opna()..    if i
+0003ef20: 6e74 6572 6e61 6c5f 6d65 7468 6f64 203d  nternal_method =
+0003ef30: 3d20 2274 6469 6765 7374 2220 616e 6420  = "tdigest" and 
+0003ef40: 280a 2020 2020 2020 2020 6e70 2e69 7373  (.        np.iss
+0003ef50: 7562 6474 7970 6528 6466 2e64 7479 7065  ubdtype(df.dtype
+0003ef60: 2c20 6e70 2e66 6c6f 6174 696e 6729 206f  , np.floating) o
+0003ef70: 7220 6e70 2e69 7373 7562 6474 7970 6528  r np.issubdtype(
+0003ef80: 6466 2e64 7479 7065 2c20 6e70 2e69 6e74  df.dtype, np.int
+0003ef90: 6567 6572 290a 2020 2020 293a 0a20 2020  eger).    ):.   
+0003efa0: 2020 2020 2066 726f 6d20 6461 736b 2e75       from dask.u
+0003efb0: 7469 6c73 2069 6d70 6f72 7420 696d 706f  tils import impo
+0003efc0: 7274 5f72 6571 7569 7265 640a 0a20 2020  rt_required..   
+0003efd0: 2020 2020 2069 6d70 6f72 745f 7265 7175       import_requ
+0003efe0: 6972 6564 280a 2020 2020 2020 2020 2020  ired(.          
+0003eff0: 2020 2263 7269 636b 222c 2022 6372 6963    "crick", "cric
+0003f000: 6b20 6973 2061 2072 6571 7569 7265 6420  k is a required 
+0003f010: 6465 7065 6e64 656e 6379 2066 6f72 2075  dependency for u
+0003f020: 7369 6e67 2074 6865 2074 2d64 6967 6573  sing the t-diges
+0003f030: 7420 6d65 7468 6f64 2e22 0a20 2020 2020  t method.".     
+0003f040: 2020 2029 0a0a 2020 2020 2020 2020 6672     )..        fr
+0003f050: 6f6d 2064 6173 6b2e 6172 7261 792e 7065  om dask.array.pe
+0003f060: 7263 656e 7469 6c65 2069 6d70 6f72 7420  rcentile import 
+0003f070: 5f70 6572 6365 6e74 696c 6573 5f66 726f  _percentiles_fro
+0003f080: 6d5f 7464 6967 6573 742c 205f 7464 6967  m_tdigest, _tdig
+0003f090: 6573 745f 6368 756e 6b0a 0a20 2020 2020  est_chunk..     
+0003f0a0: 2020 206e 616d 6520 3d20 2271 7561 6e74     name = "quant
+0003f0b0: 696c 6573 5f74 6469 6765 7374 2d31 2d22  iles_tdigest-1-"
+0003f0c0: 202b 2074 6f6b 656e 0a20 2020 2020 2020   + token.       
+0003f0d0: 2076 616c 5f64 736b 203d 207b 0a20 2020   val_dsk = {.   
+0003f0e0: 2020 2020 2020 2020 2028 6e61 6d65 2c20           (name, 
+0003f0f0: 6929 3a20 285f 7464 6967 6573 745f 6368  i): (_tdigest_ch
+0003f100: 756e 6b2c 2028 6765 7461 7474 722c 206b  unk, (getattr, k
+0003f110: 6579 2c20 2276 616c 7565 7322 2929 0a20  ey, "values")). 
+0003f120: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+0003f130: 2c20 6b65 7920 696e 2065 6e75 6d65 7261  , key in enumera
+0003f140: 7465 2864 662e 5f5f 6461 736b 5f6b 6579  te(df.__dask_key
+0003f150: 735f 5f28 2929 0a20 2020 2020 2020 207d  s__()).        }
+0003f160: 0a0a 2020 2020 2020 2020 6e61 6d65 3220  ..        name2 
+0003f170: 3d20 2271 7561 6e74 696c 6573 5f74 6469  = "quantiles_tdi
+0003f180: 6765 7374 2d32 2d22 202b 2074 6f6b 656e  gest-2-" + token
+0003f190: 0a20 2020 2020 2020 206d 6572 6765 5f64  .        merge_d
+0003f1a0: 736b 203d 207b 0a20 2020 2020 2020 2020  sk = {.         
+0003f1b0: 2020 2028 6e61 6d65 322c 2030 293a 2066     (name2, 0): f
+0003f1c0: 696e 616c 697a 655f 7473 6b28 285f 7065  inalize_tsk((_pe
+0003f1d0: 7263 656e 7469 6c65 735f 6672 6f6d 5f74  rcentiles_from_t
+0003f1e0: 6469 6765 7374 2c20 7173 2c20 736f 7274  digest, qs, sort
+0003f1f0: 6564 2876 616c 5f64 736b 2929 290a 2020  ed(val_dsk))).  
+0003f200: 2020 2020 2020 7d0a 2020 2020 656c 7365        }.    else
+0003f210: 3a0a 2020 2020 2020 2020 6672 6f6d 2064  :.        from d
+0003f220: 6173 6b2e 6172 7261 792e 6469 7370 6174  ask.array.dispat
+0003f230: 6368 2069 6d70 6f72 7420 7065 7263 656e  ch import percen
+0003f240: 7469 6c65 5f6c 6f6f 6b75 7020 6173 205f  tile_lookup as _
+0003f250: 7065 7263 656e 7469 6c65 0a20 2020 2020  percentile.     
+0003f260: 2020 2066 726f 6d20 6461 736b 2e61 7272     from dask.arr
+0003f270: 6179 2e70 6572 6365 6e74 696c 6520 696d  ay.percentile im
+0003f280: 706f 7274 206d 6572 6765 5f70 6572 6365  port merge_perce
+0003f290: 6e74 696c 6573 0a0a 2020 2020 2020 2020  ntiles..        
+0003f2a0: 2320 4164 6420 3020 616e 6420 3130 3020  # Add 0 and 100 
+0003f2b0: 6475 7269 6e67 2063 616c 6375 6c61 7469  during calculati
+0003f2c0: 6f6e 2066 6f72 206d 6f72 6520 726f 6275  on for more robu
+0003f2d0: 7374 2062 6568 6176 696f 7220 2868 6f70  st behavior (hop
+0003f2e0: 6566 756c 6c79 290a 2020 2020 2020 2020  efully).        
+0003f2f0: 6361 6c63 5f71 7320 3d20 6e70 2e70 6164  calc_qs = np.pad
+0003f300: 2871 732c 2031 2c20 6d6f 6465 3d22 636f  (qs, 1, mode="co
+0003f310: 6e73 7461 6e74 2229 0a20 2020 2020 2020  nstant").       
+0003f320: 2063 616c 635f 7173 5b2d 315d 203d 2031   calc_qs[-1] = 1
+0003f330: 3030 0a20 2020 2020 2020 206e 616d 6520  00.        name 
+0003f340: 3d20 2271 7561 6e74 696c 6573 2d31 2d22  = "quantiles-1-"
+0003f350: 202b 2074 6f6b 656e 0a20 2020 2020 2020   + token.       
+0003f360: 2076 616c 5f64 736b 203d 207b 0a20 2020   val_dsk = {.   
+0003f370: 2020 2020 2020 2020 2028 6e61 6d65 2c20           (name, 
+0003f380: 6929 3a20 285f 7065 7263 656e 7469 6c65  i): (_percentile
+0003f390: 2c20 6b65 792c 2063 616c 635f 7173 290a  , key, calc_qs).
+0003f3a0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0003f3b0: 692c 206b 6579 2069 6e20 656e 756d 6572  i, key in enumer
+0003f3c0: 6174 6528 6466 2e5f 5f64 6173 6b5f 6b65  ate(df.__dask_ke
+0003f3d0: 7973 5f5f 2829 290a 2020 2020 2020 2020  ys__()).        
+0003f3e0: 7d0a 0a20 2020 2020 2020 206e 616d 6532  }..        name2
+0003f3f0: 203d 2022 7175 616e 7469 6c65 732d 322d   = "quantiles-2-
+0003f400: 2220 2b20 746f 6b65 6e0a 2020 2020 2020  " + token.      
+0003f410: 2020 6d65 7267 655f 6473 6b20 3d20 7b0a    merge_dsk = {.
+0003f420: 2020 2020 2020 2020 2020 2020 286e 616d              (nam
+0003f430: 6532 2c20 3029 3a20 6669 6e61 6c69 7a65  e2, 0): finalize
+0003f440: 5f74 736b 280a 2020 2020 2020 2020 2020  _tsk(.          
+0003f450: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
+0003f460: 2020 2020 2020 2020 2020 2020 6d65 7267              merg
+0003f470: 655f 7065 7263 656e 7469 6c65 732c 0a20  e_percentiles,. 
+0003f480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f490: 2020 2071 732c 0a20 2020 2020 2020 2020     qs,.         
+0003f4a0: 2020 2020 2020 2020 2020 205b 6361 6c63             [calc
+0003f4b0: 5f71 735d 202a 2064 662e 6e70 6172 7469  _qs] * df.nparti
+0003f4c0: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
+0003f4d0: 2020 2020 2020 2020 2020 2073 6f72 7465             sorte
+0003f4e0: 6428 7661 6c5f 6473 6b29 2c0a 2020 2020  d(val_dsk),.    
+0003f4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f500: 226c 6f77 6572 222c 0a20 2020 2020 2020  "lower",.       
+0003f510: 2020 2020 2020 2020 2020 2020 204e 6f6e               Non
+0003f520: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0003f530: 2020 2020 2020 2046 616c 7365 2c0a 2020         False,.  
+0003f540: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0003f550: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0003f560: 2020 2020 2020 7d0a 2020 2020 6473 6b20        }.    dsk 
+0003f570: 3d20 6d65 7267 6528 7661 6c5f 6473 6b2c  = merge(val_dsk,
+0003f580: 206d 6572 6765 5f64 736b 290a 2020 2020   merge_dsk).    
+0003f590: 6772 6170 6820 3d20 4869 6768 4c65 7665  graph = HighLeve
+0003f5a0: 6c47 7261 7068 2e66 726f 6d5f 636f 6c6c  lGraph.from_coll
+0003f5b0: 6563 7469 6f6e 7328 6e61 6d65 322c 2064  ections(name2, d
+0003f5c0: 736b 2c20 6465 7065 6e64 656e 6369 6573  sk, dependencies
+0003f5d0: 3d5b 6466 5d29 0a20 2020 2072 6574 7572  =[df]).    retur
+0003f5e0: 6e20 7265 7475 726e 5f74 7970 6528 6772  n return_type(gr
+0003f5f0: 6170 682c 206e 616d 6532 2c20 6d65 7461  aph, name2, meta
+0003f600: 2c20 6e65 775f 6469 7669 7369 6f6e 7329  , new_divisions)
+0003f610: 0a0a 0a64 6566 205f 636f 765f 636f 7272  ...def _cov_corr
+0003f620: 280a 2020 2020 6466 2c0a 2020 2020 6d69  (.    df,.    mi
+0003f630: 6e5f 7065 7269 6f64 733d 4e6f 6e65 2c0a  n_periods=None,.
+0003f640: 2020 2020 636f 7272 3d46 616c 7365 2c0a      corr=False,.
+0003f650: 2020 2020 7363 616c 6172 3d46 616c 7365      scalar=False
+0003f660: 2c0a 2020 2020 6e75 6d65 7269 635f 6f6e  ,.    numeric_on
+0003f670: 6c79 3d6e 6f5f 6465 6661 756c 742c 0a20  ly=no_default,. 
+0003f680: 2020 2073 706c 6974 5f65 7665 7279 3d46     split_every=F
+0003f690: 616c 7365 2c0a 293a 0a20 2020 2022 2222  alse,.):.    """
+0003f6a0: 4461 7461 4672 616d 6520 636f 7661 7269  DataFrame covari
+0003f6b0: 616e 6365 2061 6e64 2070 6561 7273 6f6e  ance and pearson
+0003f6c0: 2063 6f72 7265 6c61 7469 6f6e 2e0a 0a20   correlation... 
+0003f6d0: 2020 2043 6f6d 7075 7465 7320 7061 6972     Computes pair
+0003f6e0: 7769 7365 2063 6f76 6172 6961 6e63 6520  wise covariance 
+0003f6f0: 6f72 2063 6f72 7265 6c61 7469 6f6e 206f  or correlation o
+0003f700: 6620 636f 6c75 6d6e 732c 2065 7863 6c75  f columns, exclu
+0003f710: 6469 6e67 204e 412f 6e75 6c6c 0a20 2020  ding NA/null.   
+0003f720: 2076 616c 7565 732e 0a0a 2020 2020 5061   values...    Pa
+0003f730: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+0003f740: 2d2d 2d2d 2d2d 2d0a 2020 2020 6466 203a  -------.    df :
+0003f750: 2044 6174 6146 7261 6d65 0a20 2020 206d   DataFrame.    m
+0003f760: 696e 5f70 6572 696f 6473 203a 2069 6e74  in_periods : int
+0003f770: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0003f780: 2020 204d 696e 696d 756d 206e 756d 6265     Minimum numbe
+0003f790: 7220 6f66 206f 6273 6572 7661 7469 6f6e  r of observation
+0003f7a0: 7320 7265 7175 6972 6564 2070 6572 2070  s required per p
+0003f7b0: 6169 7220 6f66 2063 6f6c 756d 6e73 0a20  air of columns. 
+0003f7c0: 2020 2020 2020 2074 6f20 6861 7665 2061         to have a
+0003f7d0: 2076 616c 6964 2072 6573 756c 742e 0a20   valid result.. 
+0003f7e0: 2020 2063 6f72 7220 3a20 626f 6f6c 2c20     corr : bool, 
+0003f7f0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+0003f800: 2049 6620 5472 7565 2c20 636f 6d70 7574   If True, comput
+0003f810: 6520 7468 6520 5065 6172 736f 6e20 636f  e the Pearson co
+0003f820: 7272 656c 6174 696f 6e2e 2049 6620 4661  rrelation. If Fa
+0003f830: 6c73 6520 5b64 6566 6175 6c74 5d2c 2063  lse [default], c
+0003f840: 6f6d 7075 7465 0a20 2020 2020 2020 2074  ompute.        t
+0003f850: 6865 2063 6f76 6172 6961 6e63 652e 0a20  he covariance.. 
+0003f860: 2020 2073 6361 6c61 7220 3a20 626f 6f6c     scalar : bool
+0003f870: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0003f880: 2020 2049 6620 5472 7565 2c20 636f 6d70     If True, comp
+0003f890: 7574 6520 636f 7661 7269 616e 6365 2062  ute covariance b
+0003f8a0: 6574 7765 656e 2074 776f 2076 6172 6961  etween two varia
+0003f8b0: 626c 6573 2061 7320 6120 7363 616c 6172  bles as a scalar
+0003f8c0: 2e20 4f6e 6c79 0a20 2020 2020 2020 2076  . Only.        v
+0003f8d0: 616c 6964 2069 6620 6064 6660 2068 6173  alid if `df` has
+0003f8e0: 2032 2063 6f6c 756d 6e73 2e20 2049 6620   2 columns.  If 
+0003f8f0: 4661 6c73 6520 5b64 6566 6175 6c74 5d2c  False [default],
+0003f900: 2063 6f6d 7075 7465 2074 6865 2065 6e74   compute the ent
+0003f910: 6972 650a 2020 2020 2020 2020 636f 7661  ire.        cova
+0003f920: 7269 616e 6365 2f63 6f72 7265 6c61 7469  riance/correlati
+0003f930: 6f6e 206d 6174 7269 782e 0a20 2020 2073  on matrix..    s
+0003f940: 706c 6974 5f65 7665 7279 203a 2069 6e74  plit_every : int
+0003f950: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0003f960: 2020 2047 726f 7570 2070 6172 7469 7469     Group partiti
+0003f970: 6f6e 7320 696e 746f 2067 726f 7570 7320  ons into groups 
+0003f980: 6f66 2074 6869 7320 7369 7a65 2077 6869  of this size whi
+0003f990: 6c65 2070 6572 666f 726d 696e 6720 610a  le performing a.
+0003f9a0: 2020 2020 2020 2020 7472 6565 2d72 6564          tree-red
+0003f9b0: 7563 7469 6f6e 2e20 4966 2073 6574 2074  uction. If set t
+0003f9c0: 6f20 4661 6c73 652c 206e 6f20 7472 6565  o False, no tree
+0003f9d0: 2d72 6564 7563 7469 6f6e 2077 696c 6c20  -reduction will 
+0003f9e0: 6265 2075 7365 642e 0a20 2020 2020 2020  be used..       
+0003f9f0: 2044 6566 6175 6c74 2069 7320 4661 6c73   Default is Fals
+0003fa00: 652e 0a20 2020 2022 2222 0a20 2020 2069  e..    """.    i
+0003fa10: 6620 6d69 6e5f 7065 7269 6f64 7320 6973  f min_periods is
+0003fa20: 204e 6f6e 653a 0a20 2020 2020 2020 206d   None:.        m
+0003fa30: 696e 5f70 6572 696f 6473 203d 2032 0a20  in_periods = 2. 
+0003fa40: 2020 2065 6c69 6620 6d69 6e5f 7065 7269     elif min_peri
+0003fa50: 6f64 7320 3c20 323a 0a20 2020 2020 2020  ods < 2:.       
+0003fa60: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0003fa70: 7228 226d 696e 5f70 6572 696f 6473 206d  r("min_periods m
+0003fa80: 7573 7420 6265 203e 3d20 3222 290a 0a20  ust be >= 2").. 
+0003fa90: 2020 2069 6620 7370 6c69 745f 6576 6572     if split_ever
+0003faa0: 7920 6973 2046 616c 7365 3a0a 2020 2020  y is False:.    
+0003fab0: 2020 2020 7370 6c69 745f 6576 6572 7920      split_every 
+0003fac0: 3d20 6466 2e6e 7061 7274 6974 696f 6e73  = df.npartitions
+0003fad0: 0a20 2020 2065 6c69 6620 7370 6c69 745f  .    elif split_
+0003fae0: 6576 6572 7920 3c20 3220 6f72 206e 6f74  every < 2 or not
+0003faf0: 2069 7369 6e73 7461 6e63 6528 7370 6c69   isinstance(spli
+0003fb00: 745f 6576 6572 792c 2049 6e74 6567 7261  t_every, Integra
+0003fb10: 6c29 3a0a 2020 2020 2020 2020 7261 6973  l):.        rais
+0003fb20: 6520 5661 6c75 6545 7272 6f72 2822 7370  e ValueError("sp
+0003fb30: 6c69 745f 6576 6572 7920 6d75 7374 2062  lit_every must b
+0003fb40: 6520 616e 2069 6e74 6567 6572 203e 3d20  e an integer >= 
+0003fb50: 3222 290a 0a20 2020 2023 2048 616e 646c  2")..    # Handl
+0003fb60: 6520 7365 6c65 6374 696e 6720 6e75 6d65  e selecting nume
+0003fb70: 7269 6320 6461 7461 2061 6e64 2061 7373  ric data and ass
+0003fb80: 6f63 6961 7465 6420 6465 7072 6563 6174  ociated deprecat
+0003fb90: 696f 6e20 7761 726e 696e 670a 2020 2020  ion warning.    
+0003fba0: 6d61 7962 655f 7761 726e 203d 2046 616c  maybe_warn = Fal
+0003fbb0: 7365 0a20 2020 2069 6620 6e75 6d65 7269  se.    if numeri
+0003fbc0: 635f 6f6e 6c79 2069 7320 6e6f 5f64 6566  c_only is no_def
+0003fbd0: 6175 6c74 3a0a 2020 2020 2020 2020 6966  ault:.        if
+0003fbe0: 2050 414e 4441 535f 4754 5f32 3030 3a0a   PANDAS_GT_200:.
+0003fbf0: 2020 2020 2020 2020 2020 2020 6e75 6d65              nume
+0003fc00: 7269 635f 6f6e 6c79 203d 2046 616c 7365  ric_only = False
+0003fc10: 0a20 2020 2020 2020 2065 6c69 6620 5041  .        elif PA
+0003fc20: 4e44 4153 5f47 545f 3135 303a 0a20 2020  NDAS_GT_150:.   
+0003fc30: 2020 2020 2020 2020 206d 6179 6265 5f77           maybe_w
+0003fc40: 6172 6e20 3d20 5472 7565 0a20 2020 2020  arn = True.     
+0003fc50: 2020 2020 2020 206e 756d 6572 6963 5f6f         numeric_o
+0003fc60: 6e6c 7920 3d20 5472 7565 0a20 2020 2020  nly = True.     
+0003fc70: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0003fc80: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
+0003fc90: 7920 3d20 5472 7565 0a0a 2020 2020 616c  y = True..    al
+0003fca0: 6c5f 6e75 6d65 7269 6320 3d20 6466 2e5f  l_numeric = df._
+0003fcb0: 6765 745f 6e75 6d65 7269 635f 6461 7461  get_numeric_data
+0003fcc0: 2829 2e5f 6e61 6d65 203d 3d20 6466 2e5f  ()._name == df._
+0003fcd0: 6e61 6d65 0a20 2020 2069 6620 6d61 7962  name.    if mayb
+0003fce0: 655f 7761 726e 2061 6e64 206e 6f74 2061  e_warn and not a
+0003fcf0: 6c6c 5f6e 756d 6572 6963 3a0a 2020 2020  ll_numeric:.    
+0003fd00: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+0003fd10: 6e28 0a20 2020 2020 2020 2020 2020 2022  n(.            "
+0003fd20: 5468 6520 6465 6661 756c 7420 7661 6c75  The default valu
+0003fd30: 6520 6f66 206e 756d 6572 6963 5f6f 6e6c  e of numeric_onl
+0003fd40: 7920 7769 6c6c 2062 6520 6046 616c 7365  y will be `False
+0003fd50: 6020 220a 2020 2020 2020 2020 2020 2020  ` ".            
+0003fd60: 2269 6e20 6120 6675 7475 7265 2076 6572  "in a future ver
+0003fd70: 7369 6f6e 206f 6620 4461 736b 2e22 2c0a  sion of Dask.",.
+0003fd80: 2020 2020 2020 2020 2020 2020 4675 7475              Futu
+0003fd90: 7265 5761 726e 696e 672c 0a20 2020 2020  reWarning,.     
+0003fda0: 2020 2029 0a0a 2020 2020 6966 206e 756d     )..    if num
+0003fdb0: 6572 6963 5f6f 6e6c 7920 616e 6420 6e6f  eric_only and no
+0003fdc0: 7420 616c 6c5f 6e75 6d65 7269 633a 0a20  t all_numeric:. 
+0003fdd0: 2020 2020 2020 2064 6620 3d20 6466 2e5f         df = df._
+0003fde0: 6765 745f 6e75 6d65 7269 635f 6461 7461  get_numeric_data
+0003fdf0: 2829 0a0a 2020 2020 6966 2073 6361 6c61  ()..    if scala
+0003fe00: 7220 616e 6420 6c65 6e28 6466 2e63 6f6c  r and len(df.col
+0003fe10: 756d 6e73 2920 213d 2032 3a0a 2020 2020  umns) != 2:.    
+0003fe20: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0003fe30: 7272 6f72 2822 7363 616c 6172 206f 6e6c  rror("scalar onl
+0003fe40: 7920 7661 6c69 6420 666f 7220 3220 636f  y valid for 2 co
+0003fe50: 6c75 6d6e 2064 6174 6166 7261 6d65 2229  lumn dataframe")
+0003fe60: 0a0a 2020 2020 746f 6b65 6e20 3d20 746f  ..    token = to
+0003fe70: 6b65 6e69 7a65 2864 662c 206d 696e 5f70  kenize(df, min_p
+0003fe80: 6572 696f 6473 2c20 7363 616c 6172 2c20  eriods, scalar, 
+0003fe90: 7370 6c69 745f 6576 6572 7929 0a0a 2020  split_every)..  
+0003fea0: 2020 6675 6e63 6e61 6d65 203d 2022 636f    funcname = "co
+0003feb0: 7272 2220 6966 2063 6f72 7220 656c 7365  rr" if corr else
+0003fec0: 2022 636f 7622 0a20 2020 2061 203d 2066   "cov".    a = f
+0003fed0: 227b 6675 6e63 6e61 6d65 7d2d 6368 756e  "{funcname}-chun
+0003fee0: 6b2d 7b64 662e 5f6e 616d 657d 220a 2020  k-{df._name}".  
+0003fef0: 2020 6473 6b20 3d20 7b0a 2020 2020 2020    dsk = {.      
+0003ff00: 2020 2861 2c20 6929 3a20 285f 636f 765f    (a, i): (_cov_
+0003ff10: 636f 7272 5f63 6875 6e6b 2c20 662c 2063  corr_chunk, f, c
+0003ff20: 6f72 7229 2066 6f72 2028 692c 2066 2920  orr) for (i, f) 
+0003ff30: 696e 2065 6e75 6d65 7261 7465 2864 662e  in enumerate(df.
+0003ff40: 5f5f 6461 736b 5f6b 6579 735f 5f28 2929  __dask_keys__())
+0003ff50: 0a20 2020 207d 0a0a 2020 2020 7072 6566  .    }..    pref
+0003ff60: 6978 203d 2066 227b 6675 6e63 6e61 6d65  ix = f"{funcname
+0003ff70: 7d2d 636f 6d62 696e 652d 7b64 662e 5f6e  }-combine-{df._n
+0003ff80: 616d 657d 2d22 0a20 2020 206b 203d 2064  ame}-".    k = d
+0003ff90: 662e 6e70 6172 7469 7469 6f6e 730a 2020  f.npartitions.  
+0003ffa0: 2020 6220 3d20 610a 2020 2020 6465 7074    b = a.    dept
+0003ffb0: 6820 3d20 300a 2020 2020 7768 696c 6520  h = 0.    while 
+0003ffc0: 6b20 3e20 7370 6c69 745f 6576 6572 793a  k > split_every:
+0003ffd0: 0a20 2020 2020 2020 2062 203d 2070 7265  .        b = pre
+0003ffe0: 6669 7820 2b20 7374 7228 6465 7074 6829  fix + str(depth)
+0003fff0: 0a20 2020 2020 2020 2066 6f72 2070 6172  .        for par
+00040000: 745f 692c 2069 6e64 7320 696e 2065 6e75  t_i, inds in enu
+00040010: 6d65 7261 7465 2870 6172 7469 7469 6f6e  merate(partition
+00040020: 5f61 6c6c 2873 706c 6974 5f65 7665 7279  _all(split_every
+00040030: 2c20 7261 6e67 6528 6b29 2929 3a0a 2020  , range(k))):.  
+00040040: 2020 2020 2020 2020 2020 6473 6b5b 2862            dsk[(b
+00040050: 2c20 7061 7274 5f69 295d 203d 2028 5f63  , part_i)] = (_c
+00040060: 6f76 5f63 6f72 725f 636f 6d62 696e 652c  ov_corr_combine,
+00040070: 205b 2861 2c20 6929 2066 6f72 2069 2069   [(a, i) for i i
+00040080: 6e20 696e 6473 5d2c 2063 6f72 7229 0a20  n inds], corr). 
+00040090: 2020 2020 2020 206b 203d 2070 6172 745f         k = part_
+000400a0: 6920 2b20 310a 2020 2020 2020 2020 6120  i + 1.        a 
+000400b0: 3d20 620a 2020 2020 2020 2020 6465 7074  = b.        dept
+000400c0: 6820 2b3d 2031 0a0a 2020 2020 6e61 6d65  h += 1..    name
+000400d0: 203d 2066 227b 6675 6e63 6e61 6d65 7d2d   = f"{funcname}-
+000400e0: 7b74 6f6b 656e 7d22 0a20 2020 2064 736b  {token}".    dsk
+000400f0: 5b28 6e61 6d65 2c20 3029 5d20 3d20 280a  [(name, 0)] = (.
+00040100: 2020 2020 2020 2020 5f63 6f76 5f63 6f72          _cov_cor
+00040110: 725f 6167 672c 0a20 2020 2020 2020 205b  r_agg,.        [
+00040120: 2861 2c20 6929 2066 6f72 2069 2069 6e20  (a, i) for i in 
+00040130: 7261 6e67 6528 6b29 5d2c 0a20 2020 2020  range(k)],.     
+00040140: 2020 2064 662e 636f 6c75 6d6e 732c 0a20     df.columns,. 
+00040150: 2020 2020 2020 206d 696e 5f70 6572 696f         min_perio
+00040160: 6473 2c0a 2020 2020 2020 2020 636f 7272  ds,.        corr
+00040170: 2c0a 2020 2020 2020 2020 7363 616c 6172  ,.        scalar
+00040180: 2c0a 2020 2020 2020 2020 6466 2e5f 6d65  ,.        df._me
+00040190: 7461 2c0a 2020 2020 290a 2020 2020 6772  ta,.    ).    gr
+000401a0: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
+000401b0: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
+000401c0: 7469 6f6e 7328 6e61 6d65 2c20 6473 6b2c  tions(name, dsk,
+000401d0: 2064 6570 656e 6465 6e63 6965 733d 5b64   dependencies=[d
+000401e0: 665d 290a 2020 2020 6966 2073 6361 6c61  f]).    if scala
+000401f0: 723a 0a20 2020 2020 2020 2072 6574 7572  r:.        retur
+00040200: 6e20 5363 616c 6172 2867 7261 7068 2c20  n Scalar(graph, 
+00040210: 6e61 6d65 2c20 2266 3822 290a 2020 2020  name, "f8").    
+00040220: 6d65 7461 203d 206d 616b 655f 6d65 7461  meta = make_meta
+00040230: 280a 2020 2020 2020 2020 5b28 632c 2022  (.        [(c, "
+00040240: 6638 2229 2066 6f72 2063 2069 6e20 6466  f8") for c in df
+00040250: 2e63 6f6c 756d 6e73 5d2c 0a20 2020 2020  .columns],.     
+00040260: 2020 2069 6e64 6578 3d6d 6574 615f 7365     index=meta_se
+00040270: 7269 6573 5f63 6f6e 7374 7275 6374 6f72  ries_constructor
+00040280: 2864 6629 2864 662e 636f 6c75 6d6e 7329  (df)(df.columns)
+00040290: 2c0a 2020 2020 2020 2020 7061 7265 6e74  ,.        parent
+000402a0: 5f6d 6574 613d 6466 2e5f 6d65 7461 2c0a  _meta=df._meta,.
+000402b0: 2020 2020 290a 2020 2020 7265 7475 726e      ).    return
+000402c0: 206e 6577 5f64 645f 6f62 6a65 6374 2867   new_dd_object(g
+000402d0: 7261 7068 2c20 6e61 6d65 2c20 6d65 7461  raph, name, meta
+000402e0: 2c20 2864 662e 636f 6c75 6d6e 732e 6d69  , (df.columns.mi
+000402f0: 6e28 292c 2064 662e 636f 6c75 6d6e 732e  n(), df.columns.
+00040300: 6d61 7828 2929 290a 0a0a 6465 6620 5f63  max()))...def _c
+00040310: 6f76 5f63 6f72 725f 6368 756e 6b28 6466  ov_corr_chunk(df
+00040320: 2c20 636f 7272 3d46 616c 7365 293a 0a20  , corr=False):. 
+00040330: 2020 2022 2222 4368 756e 6b20 7061 7274     """Chunk part
+00040340: 206f 6620 6120 636f 7661 7269 616e 6365   of a covariance
+00040350: 206f 7220 636f 7272 656c 6174 696f 6e20   or correlation 
+00040360: 636f 6d70 7574 6174 696f 6e22 2222 0a20  computation""". 
+00040370: 2020 2073 6861 7065 203d 2028 6466 2e73     shape = (df.s
+00040380: 6861 7065 5b31 5d2c 2064 662e 7368 6170  hape[1], df.shap
+00040390: 655b 315d 290a 2020 2020 6466 203d 2064  e[1]).    df = d
+000403a0: 662e 6173 7479 7065 2822 666c 6f61 7436  f.astype("float6
+000403b0: 3422 2c20 636f 7079 3d46 616c 7365 290a  4", copy=False).
+000403c0: 2020 2020 7375 6d73 203d 206e 702e 7a65      sums = np.ze
+000403d0: 726f 735f 6c69 6b65 2864 662e 7661 6c75  ros_like(df.valu
+000403e0: 6573 2c20 7368 6170 653d 7368 6170 6529  es, shape=shape)
+000403f0: 0a20 2020 2063 6f75 6e74 7320 3d20 6e70  .    counts = np
+00040400: 2e7a 6572 6f73 5f6c 696b 6528 6466 2e76  .zeros_like(df.v
+00040410: 616c 7565 732c 2073 6861 7065 3d73 6861  alues, shape=sha
+00040420: 7065 290a 2020 2020 666f 7220 6964 7820  pe).    for idx 
+00040430: 696e 2072 616e 6765 286c 656e 2864 662e  in range(len(df.
+00040440: 636f 6c75 6d6e 7329 293a 0a20 2020 2020  columns)):.     
+00040450: 2020 206d 6173 6b20 3d20 6466 2e69 6c6f     mask = df.ilo
+00040460: 635b 3a2c 2069 6478 5d2e 6e6f 746e 756c  c[:, idx].notnul
+00040470: 6c28 290a 2020 2020 2020 2020 7375 6d73  l().        sums
+00040480: 5b69 6478 5d20 3d20 6466 5b6d 6173 6b5d  [idx] = df[mask]
+00040490: 2e73 756d 2829 2e76 616c 7565 730a 2020  .sum().values.  
+000404a0: 2020 2020 2020 636f 756e 7473 5b69 6478        counts[idx
+000404b0: 5d20 3d20 6466 5b6d 6173 6b5d 2e63 6f75  ] = df[mask].cou
+000404c0: 6e74 2829 2e76 616c 7565 730a 2020 2020  nt().values.    
+000404d0: 2320 5370 6563 6961 6c20 6361 7365 2073  # Special case s
+000404e0: 696e 676c 652d 726f 7720 4461 7461 4672  ingle-row DataFr
+000404f0: 616d 6520 636f 7620 746f 2061 766f 6964  ame cov to avoid
+00040500: 2077 6172 6e69 6e67 7320 6672 6f6d 2070   warnings from p
+00040510: 616e 6461 732e 0a20 2020 2069 6620 6466  andas..    if df
+00040520: 2e73 6861 7065 5b30 5d20 3d3d 2031 3a0a  .shape[0] == 1:.
+00040530: 2020 2020 2020 2020 636f 7620 3d20 6e70          cov = np
+00040540: 2e66 756c 6c5f 6c69 6b65 2873 756d 732c  .full_like(sums,
+00040550: 206e 702e 6e61 6e29 2020 2320 616c 7761   np.nan)  # alwa
+00040560: 7973 2061 6e20 616c 6c20 6e61 6e20 7265  ys an all nan re
+00040570: 7375 6c74 0a20 2020 2065 6c73 653a 0a20  sult.    else:. 
+00040580: 2020 2020 2020 2063 6f76 203d 2064 662e         cov = df.
+00040590: 636f 7628 292e 7661 6c75 6573 0a20 2020  cov().values.   
+000405a0: 2064 7479 7065 203d 205b 2822 7375 6d22   dtype = [("sum"
+000405b0: 2c20 7375 6d73 2e64 7479 7065 292c 2028  , sums.dtype), (
+000405c0: 2263 6f75 6e74 222c 2063 6f75 6e74 732e  "count", counts.
+000405d0: 6474 7970 6529 2c20 2822 636f 7622 2c20  dtype), ("cov", 
+000405e0: 636f 762e 6474 7970 6529 5d0a 2020 2020  cov.dtype)].    
+000405f0: 6966 2063 6f72 723a 0a20 2020 2020 2020  if corr:.       
+00040600: 2077 6974 6820 7761 726e 696e 6773 2e63   with warnings.c
+00040610: 6174 6368 5f77 6172 6e69 6e67 7328 7265  atch_warnings(re
+00040620: 636f 7264 3d54 7275 6529 3a0a 2020 2020  cord=True):.    
+00040630: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+00040640: 2e73 696d 706c 6566 696c 7465 7228 2261  .simplefilter("a
+00040650: 6c77 6179 7322 290a 2020 2020 2020 2020  lways").        
+00040660: 2020 2020 6d75 203d 2028 7375 6d73 202f      mu = (sums /
+00040670: 2063 6f75 6e74 7329 2e54 0a20 2020 2020   counts).T.     
+00040680: 2020 206d 203d 206e 702e 7a65 726f 735f     m = np.zeros_
+00040690: 6c69 6b65 2864 662e 7661 6c75 6573 2c20  like(df.values, 
+000406a0: 7368 6170 653d 7368 6170 6529 0a20 2020  shape=shape).   
+000406b0: 2020 2020 206d 6173 6b20 3d20 6466 2e69       mask = df.i
+000406c0: 736e 756c 6c28 292e 7661 6c75 6573 0a20  snull().values. 
+000406d0: 2020 2020 2020 2066 6f72 2069 6478 2069         for idx i
+000406e0: 6e20 7261 6e67 6528 6c65 6e28 6466 2e63  n range(len(df.c
+000406f0: 6f6c 756d 6e73 2929 3a0a 2020 2020 2020  olumns)):.      
+00040700: 2020 2020 2020 2320 4176 6f69 6420 7573        # Avoid us
+00040710: 696e 6720 7566 756e 632e 6f75 7465 7220  ing ufunc.outer 
+00040720: 286e 6f74 2073 7570 706f 7274 6564 2062  (not supported b
+00040730: 7920 6375 7079 290a 2020 2020 2020 2020  y cupy).        
+00040740: 2020 2020 6d75 5f64 6973 6372 6570 616e      mu_discrepan
+00040750: 6379 203d 2028 0a20 2020 2020 2020 2020  cy = (.         
+00040760: 2020 2020 2020 206e 702e 7375 6274 7261         np.subtra
+00040770: 6374 2864 662e 696c 6f63 5b3a 2c20 6964  ct(df.iloc[:, id
+00040780: 785d 2e76 616c 7565 735b 3a2c 204e 6f6e  x].values[:, Non
+00040790: 655d 2c20 6d75 5b69 6478 5d5b 4e6f 6e65  e], mu[idx][None
+000407a0: 2c20 3a5d 2920 2a2a 2032 0a20 2020 2020  , :]) ** 2.     
+000407b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000407c0: 2020 2020 206d 755f 6469 7363 7265 7061       mu_discrepa
+000407d0: 6e63 795b 6d61 736b 5d20 3d20 6e70 2e6e  ncy[mask] = np.n
+000407e0: 616e 0a20 2020 2020 2020 2020 2020 206d  an.            m
+000407f0: 5b69 6478 5d20 3d20 6e70 2e6e 616e 7375  [idx] = np.nansu
+00040800: 6d28 6d75 5f64 6973 6372 6570 616e 6379  m(mu_discrepancy
+00040810: 2c20 6178 6973 3d30 290a 2020 2020 2020  , axis=0).      
+00040820: 2020 6d20 3d20 6d2e 540a 2020 2020 2020    m = m.T.      
+00040830: 2020 6474 7970 652e 6170 7065 6e64 2828    dtype.append((
+00040840: 226d 222c 206d 2e64 7479 7065 2929 0a0a  "m", m.dtype))..
+00040850: 2020 2020 6f75 7420 3d20 7b22 7375 6d22      out = {"sum"
+00040860: 3a20 7375 6d73 2c20 2263 6f75 6e74 223a  : sums, "count":
+00040870: 2063 6f75 6e74 732c 2022 636f 7622 3a20   counts, "cov": 
+00040880: 636f 7620 2a20 2863 6f75 6e74 7320 2d20  cov * (counts - 
+00040890: 3129 7d0a 2020 2020 6966 2063 6f72 723a  1)}.    if corr:
+000408a0: 0a20 2020 2020 2020 206f 7574 5b22 6d22  .        out["m"
+000408b0: 5d20 3d20 6d0a 2020 2020 7265 7475 726e  ] = m.    return
+000408c0: 206f 7574 0a0a 0a64 6566 205f 636f 765f   out...def _cov_
+000408d0: 636f 7272 5f63 6f6d 6269 6e65 2864 6174  corr_combine(dat
+000408e0: 615f 696e 2c20 636f 7272 3d46 616c 7365  a_in, corr=False
+000408f0: 293a 0a20 2020 2064 6174 6120 3d20 7b22  ):.    data = {"
+00040900: 7375 6d22 3a20 4e6f 6e65 2c20 2263 6f75  sum": None, "cou
+00040910: 6e74 223a 204e 6f6e 652c 2022 636f 7622  nt": None, "cov"
+00040920: 3a20 4e6f 6e65 7d0a 2020 2020 6966 2063  : None}.    if c
+00040930: 6f72 723a 0a20 2020 2020 2020 2064 6174  orr:.        dat
+00040940: 615b 226d 225d 203d 204e 6f6e 650a 0a20  a["m"] = None.. 
+00040950: 2020 2066 6f72 206b 2069 6e20 6461 7461     for k in data
+00040960: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
+00040970: 2064 6174 615b 6b5d 203d 205b 645b 6b5d   data[k] = [d[k]
+00040980: 2066 6f72 2064 2069 6e20 6461 7461 5f69   for d in data_i
+00040990: 6e5d 0a20 2020 2020 2020 2064 6174 615b  n].        data[
+000409a0: 6b5d 203d 206e 702e 636f 6e63 6174 656e  k] = np.concaten
+000409b0: 6174 6528 6461 7461 5b6b 5d29 2e72 6573  ate(data[k]).res
+000409c0: 6861 7065 2828 6c65 6e28 6461 7461 5b6b  hape((len(data[k
+000409d0: 5d29 2c29 202b 2064 6174 615b 6b5d 5b30  ]),) + data[k][0
+000409e0: 5d2e 7368 6170 6529 0a0a 2020 2020 7375  ].shape)..    su
+000409f0: 6d73 203d 206e 702e 6e61 6e5f 746f 5f6e  ms = np.nan_to_n
+00040a00: 756d 2864 6174 615b 2273 756d 225d 290a  um(data["sum"]).
+00040a10: 2020 2020 636f 756e 7473 203d 2064 6174      counts = dat
+00040a20: 615b 2263 6f75 6e74 225d 0a0a 2020 2020  a["count"]..    
+00040a30: 6375 6d5f 7375 6d73 203d 206e 702e 6375  cum_sums = np.cu
+00040a40: 6d73 756d 2873 756d 732c 2030 290a 2020  msum(sums, 0).  
+00040a50: 2020 6375 6d5f 636f 756e 7473 203d 206e    cum_counts = n
+00040a60: 702e 6375 6d73 756d 2863 6f75 6e74 732c  p.cumsum(counts,
+00040a70: 2030 290a 0a20 2020 2073 3120 3d20 6375   0)..    s1 = cu
+00040a80: 6d5f 7375 6d73 5b3a 2d31 5d0a 2020 2020  m_sums[:-1].    
+00040a90: 7332 203d 2073 756d 735b 313a 5d0a 2020  s2 = sums[1:].  
+00040aa0: 2020 6e31 203d 2063 756d 5f63 6f75 6e74    n1 = cum_count
+00040ab0: 735b 3a2d 315d 0a20 2020 206e 3220 3d20  s[:-1].    n2 = 
+00040ac0: 636f 756e 7473 5b31 3a5d 0a20 2020 2077  counts[1:].    w
+00040ad0: 6974 6820 6e70 2e65 7272 7374 6174 6528  ith np.errstate(
+00040ae0: 696e 7661 6c69 643d 2269 676e 6f72 6522  invalid="ignore"
+00040af0: 293a 0a20 2020 2020 2020 2064 203d 2028  ):.        d = (
+00040b00: 7332 202f 206e 3229 202d 2028 7331 202f  s2 / n2) - (s1 /
+00040b10: 206e 3129 0a20 2020 2020 2020 2043 203d   n1).        C =
+00040b20: 206e 702e 6e61 6e73 756d 280a 2020 2020   np.nansum(.    
+00040b30: 2020 2020 2020 2020 286e 3120 2a20 6e32          (n1 * n2
+00040b40: 2920 2f20 286e 3120 2b20 6e32 2920 2a20  ) / (n1 + n2) * 
+00040b50: 2864 202a 2064 2e74 7261 6e73 706f 7365  (d * d.transpose
+00040b60: 2828 302c 2032 2c20 3129 2929 2c20 300a  ((0, 2, 1))), 0.
+00040b70: 2020 2020 2020 2020 2920 2b20 6e70 2e6e          ) + np.n
+00040b80: 616e 7375 6d28 6461 7461 5b22 636f 7622  ansum(data["cov"
+00040b90: 5d2c 2030 290a 0a20 2020 206f 7574 203d  ], 0)..    out =
+00040ba0: 207b 2273 756d 223a 2063 756d 5f73 756d   {"sum": cum_sum
+00040bb0: 735b 2d31 5d2c 2022 636f 756e 7422 3a20  s[-1], "count": 
+00040bc0: 6375 6d5f 636f 756e 7473 5b2d 315d 2c20  cum_counts[-1], 
+00040bd0: 2263 6f76 223a 2043 7d0a 0a20 2020 2069  "cov": C}..    i
+00040be0: 6620 636f 7272 3a0a 2020 2020 2020 2020  f corr:.        
+00040bf0: 6e6f 6273 203d 206e 702e 7768 6572 6528  nobs = np.where(
+00040c00: 6375 6d5f 636f 756e 7473 5b2d 315d 2c20  cum_counts[-1], 
+00040c10: 6375 6d5f 636f 756e 7473 5b2d 315d 2c20  cum_counts[-1], 
+00040c20: 6e70 2e6e 616e 290a 2020 2020 2020 2020  np.nan).        
+00040c30: 6d75 203d 2063 756d 5f73 756d 735b 2d31  mu = cum_sums[-1
+00040c40: 5d20 2f20 6e6f 6273 0a20 2020 2020 2020  ] / nobs.       
+00040c50: 2063 6f75 6e74 735f 6e61 203d 206e 702e   counts_na = np.
+00040c60: 7768 6572 6528 636f 756e 7473 2c20 636f  where(counts, co
+00040c70: 756e 7473 2c20 6e70 2e6e 616e 290a 2020  unts, np.nan).  
+00040c80: 2020 2020 2020 6d20 3d20 6e70 2e6e 616e        m = np.nan
+00040c90: 7375 6d28 6461 7461 5b22 6d22 5d20 2b20  sum(data["m"] + 
+00040ca0: 636f 756e 7473 202a 2028 7375 6d73 202f  counts * (sums /
+00040cb0: 2063 6f75 6e74 735f 6e61 202d 206d 7529   counts_na - mu)
+00040cc0: 202a 2a20 322c 2061 7869 733d 3029 0a20   ** 2, axis=0). 
+00040cd0: 2020 2020 2020 206f 7574 5b22 6d22 5d20         out["m"] 
+00040ce0: 3d20 6d0a 2020 2020 7265 7475 726e 206f  = m.    return o
+00040cf0: 7574 0a0a 0a64 6566 205f 636f 765f 636f  ut...def _cov_co
+00040d00: 7272 5f61 6767 2864 6174 612c 2063 6f6c  rr_agg(data, col
+00040d10: 732c 206d 696e 5f70 6572 696f 6473 3d32  s, min_periods=2
+00040d20: 2c20 636f 7272 3d46 616c 7365 2c20 7363  , corr=False, sc
+00040d30: 616c 6172 3d46 616c 7365 2c20 6c69 6b65  alar=False, like
+00040d40: 5f64 663d 4e6f 6e65 293a 0a20 2020 206f  _df=None):.    o
+00040d50: 7574 203d 205f 636f 765f 636f 7272 5f63  ut = _cov_corr_c
+00040d60: 6f6d 6269 6e65 2864 6174 612c 2063 6f72  ombine(data, cor
+00040d70: 7229 0a20 2020 2063 6f75 6e74 7320 3d20  r).    counts = 
+00040d80: 6f75 745b 2263 6f75 6e74 225d 0a20 2020  out["count"].   
+00040d90: 2043 203d 206f 7574 5b22 636f 7622 5d0a   C = out["cov"].
+00040da0: 2020 2020 435b 636f 756e 7473 203c 206d      C[counts < m
+00040db0: 696e 5f70 6572 696f 6473 5d20 3d20 6e70  in_periods] = np
+00040dc0: 2e6e 616e 0a20 2020 2069 6620 636f 7272  .nan.    if corr
+00040dd0: 3a0a 2020 2020 2020 2020 6d32 203d 206f  :.        m2 = o
+00040de0: 7574 5b22 6d22 5d0a 2020 2020 2020 2020  ut["m"].        
+00040df0: 6465 6e20 3d20 6e70 2e73 7172 7428 6d32  den = np.sqrt(m2
+00040e00: 202a 206d 322e 5429 0a20 2020 2065 6c73   * m2.T).    els
+00040e10: 653a 0a20 2020 2020 2020 2064 656e 203d  e:.        den =
+00040e20: 206e 702e 7768 6572 6528 636f 756e 7473   np.where(counts
+00040e30: 2c20 636f 756e 7473 2c20 6e70 2e6e 616e  , counts, np.nan
+00040e40: 2920 2d20 310a 2020 2020 7769 7468 206e  ) - 1.    with n
+00040e50: 702e 6572 7273 7461 7465 2869 6e76 616c  p.errstate(inval
+00040e60: 6964 3d22 6967 6e6f 7265 222c 2064 6976  id="ignore", div
+00040e70: 6964 653d 2269 676e 6f72 6522 293a 0a20  ide="ignore"):. 
+00040e80: 2020 2020 2020 206d 6174 203d 2043 202f         mat = C /
+00040e90: 2064 656e 0a20 2020 2069 6620 7363 616c   den.    if scal
+00040ea0: 6172 3a0a 2020 2020 2020 2020 7265 7475  ar:.        retu
+00040eb0: 726e 2066 6c6f 6174 286d 6174 5b30 2c20  rn float(mat[0, 
+00040ec0: 315d 290a 2020 2020 7265 7475 726e 2028  1]).    return (
+00040ed0: 7064 2e44 6174 6146 7261 6d65 2069 6620  pd.DataFrame if 
+00040ee0: 6c69 6b65 5f64 6620 6973 204e 6f6e 6520  like_df is None 
+00040ef0: 656c 7365 206d 6574 615f 6672 616d 655f  else meta_frame_
+00040f00: 636f 6e73 7472 7563 746f 7228 6c69 6b65  constructor(like
+00040f10: 5f64 6629 2928 0a20 2020 2020 2020 206d  _df))(.        m
+00040f20: 6174 2c20 636f 6c75 6d6e 733d 636f 6c73  at, columns=cols
+00040f30: 2c20 696e 6465 783d 636f 6c73 0a20 2020  , index=cols.   
+00040f40: 2029 0a0a 0a64 6566 2070 645f 7370 6c69   )...def pd_spli
+00040f50: 7428 6466 2c20 702c 2072 616e 646f 6d5f  t(df, p, random_
+00040f60: 7374 6174 653d 4e6f 6e65 2c20 7368 7566  state=None, shuf
+00040f70: 666c 653d 4661 6c73 6529 3a0a 2020 2020  fle=False):.    
+00040f80: 2222 2253 706c 6974 2044 6174 6146 7261  """Split DataFra
+00040f90: 6d65 2069 6e74 6f20 6d75 6c74 6970 6c65  me into multiple
+00040fa0: 2070 6965 6365 7320 7073 6575 646f 7261   pieces pseudora
+00040fb0: 6e64 6f6d 6c79 0a0a 2020 2020 3e3e 3e20  ndomly..    >>> 
+00040fc0: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
+00040fd0: 6528 7b27 6127 3a20 5b31 2c20 322c 2033  e({'a': [1, 2, 3
+00040fe0: 2c20 342c 2035 2c20 365d 2c0a 2020 2020  , 4, 5, 6],.    
+00040ff0: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
+00041000: 2020 2020 2020 2027 6227 3a20 5b32 2c20         'b': [2, 
+00041010: 332c 2034 2c20 352c 2036 2c20 375d 7d29  3, 4, 5, 6, 7]})
+00041020: 0a0a 2020 2020 3e3e 3e20 612c 2062 203d  ..    >>> a, b =
+00041030: 2070 645f 7370 6c69 7428 0a20 2020 202e   pd_split(.    .
+00041040: 2e2e 2020 2020 2064 662c 205b 302e 352c  ..     df, [0.5,
+00041050: 2030 2e35 5d2c 2072 616e 646f 6d5f 7374   0.5], random_st
+00041060: 6174 653d 3132 332c 2073 6875 6666 6c65  ate=123, shuffle
+00041070: 3d54 7275 650a 2020 2020 2e2e 2e20 2920  =True.    ... ) 
+00041080: 2023 2072 6f75 6768 6c79 2035 302f 3530   # roughly 50/50
+00041090: 2073 706c 6974 0a20 2020 203e 3e3e 2061   split.    >>> a
+000410a0: 0a20 2020 2020 2020 6120 2062 0a20 2020  .       a  b.   
+000410b0: 2033 2020 3420 2035 0a20 2020 2030 2020   3  4  5.    0  
+000410c0: 3120 2032 0a20 2020 2035 2020 3620 2037  1  2.    5  6  7
+000410d0: 0a20 2020 203e 3e3e 2062 0a20 2020 2020  .    >>> b.     
+000410e0: 2020 6120 2062 0a20 2020 2031 2020 3220    a  b.    1  2 
+000410f0: 2033 0a20 2020 2034 2020 3520 2036 0a20   3.    4  5  6. 
+00041100: 2020 2032 2020 3320 2034 0a20 2020 2022     2  3  4.    "
+00041110: 2222 0a20 2020 2070 203d 206c 6973 7428  "".    p = list(
+00041120: 7029 0a20 2020 2069 6620 7368 7566 666c  p).    if shuffl
+00041130: 653a 0a20 2020 2020 2020 2069 6620 6e6f  e:.        if no
+00041140: 7420 6973 696e 7374 616e 6365 2872 616e  t isinstance(ran
+00041150: 646f 6d5f 7374 6174 652c 206e 702e 7261  dom_state, np.ra
+00041160: 6e64 6f6d 2e52 616e 646f 6d53 7461 7465  ndom.RandomState
+00041170: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00041180: 616e 646f 6d5f 7374 6174 6520 3d20 6e70  andom_state = np
+00041190: 2e72 616e 646f 6d2e 5261 6e64 6f6d 5374  .random.RandomSt
+000411a0: 6174 6528 7261 6e64 6f6d 5f73 7461 7465  ate(random_state
+000411b0: 290a 2020 2020 2020 2020 6466 203d 2064  ).        df = d
+000411c0: 662e 7361 6d70 6c65 2866 7261 633d 312e  f.sample(frac=1.
+000411d0: 302c 2072 616e 646f 6d5f 7374 6174 653d  0, random_state=
+000411e0: 7261 6e64 6f6d 5f73 7461 7465 290a 2020  random_state).  
+000411f0: 2020 696e 6465 7820 3d20 7073 6575 646f    index = pseudo
+00041200: 7261 6e64 6f6d 286c 656e 2864 6629 2c20  random(len(df), 
+00041210: 702c 2072 616e 646f 6d5f 7374 6174 6529  p, random_state)
+00041220: 0a20 2020 2072 6574 7572 6e20 5b64 662e  .    return [df.
+00041230: 696c 6f63 5b69 6e64 6578 203d 3d20 695d  iloc[index == i]
+00041240: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00041250: 6c65 6e28 7029 295d 0a0a 0a64 6566 205f  len(p))]...def _
+00041260: 7461 6b65 5f6c 6173 7428 612c 2073 6b69  take_last(a, ski
+00041270: 706e 613d 5472 7565 293a 0a20 2020 2022  pna=True):.    "
+00041280: 2222 0a20 2020 2074 616b 6520 6c61 7374  "".    take last
+00041290: 2072 6f77 2028 5365 7269 6573 2920 6f66   row (Series) of
+000412a0: 2044 6174 6146 7261 6d65 202f 206c 6173   DataFrame / las
+000412b0: 7420 7661 6c75 6520 6f66 2053 6572 6965  t value of Serie
+000412c0: 730a 2020 2020 636f 6e73 6964 6572 696e  s.    considerin
+000412d0: 6720 4e61 4e2e 0a0a 2020 2020 5061 7261  g NaN...    Para
+000412e0: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
+000412f0: 2d2d 2d2d 2d0a 2020 2020 6120 3a20 7064  -----.    a : pd
+00041300: 2e44 6174 6146 7261 6d65 206f 7220 7064  .DataFrame or pd
+00041310: 2e53 6572 6965 730a 2020 2020 736b 6970  .Series.    skip
+00041320: 6e61 203a 2062 6f6f 6c2c 2064 6566 6175  na : bool, defau
+00041330: 6c74 2054 7275 650a 2020 2020 2020 2020  lt True.        
+00041340: 5768 6574 6865 7220 746f 2065 7863 6c75  Whether to exclu
+00041350: 6465 204e 614e 0a0a 2020 2020 2222 220a  de NaN..    """.
+00041360: 0a20 2020 2064 6566 205f 6c61 7374 5f76  .    def _last_v
+00041370: 616c 6964 2873 293a 0a20 2020 2020 2020  alid(s):.       
+00041380: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00041390: 312c 206d 696e 2831 302c 206c 656e 2873  1, min(10, len(s
+000413a0: 2920 2b20 3129 293a 0a20 2020 2020 2020  ) + 1)):.       
+000413b0: 2020 2020 2076 616c 203d 2073 2e69 6c6f       val = s.ilo
+000413c0: 635b 2d69 5d0a 2020 2020 2020 2020 2020  c[-i].          
+000413d0: 2020 6966 206e 6f74 2070 642e 6973 6e75    if not pd.isnu
+000413e0: 6c6c 2876 616c 293a 0a20 2020 2020 2020  ll(val):.       
+000413f0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00041400: 7661 6c0a 2020 2020 2020 2020 656c 7365  val.        else
+00041410: 3a0a 2020 2020 2020 2020 2020 2020 6e6f  :.            no
+00041420: 6e6e 756c 6c20 3d20 735b 732e 6e6f 746e  nnull = s[s.notn
+00041430: 6128 295d 0a20 2020 2020 2020 2020 2020  a()].           
+00041440: 2069 6620 6e6f 7420 6e6f 6e6e 756c 6c2e   if not nonnull.
+00041450: 656d 7074 793a 0a20 2020 2020 2020 2020  empty:.         
+00041460: 2020 2020 2020 2072 6574 7572 6e20 6e6f         return no
+00041470: 6e6e 756c 6c2e 696c 6f63 5b2d 315d 0a20  nnull.iloc[-1]. 
+00041480: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+00041490: 6e65 0a0a 2020 2020 6966 2073 6b69 706e  ne..    if skipn
+000414a0: 6120 6973 2046 616c 7365 3a0a 2020 2020  a is False:.    
+000414b0: 2020 2020 7265 7475 726e 2061 2e69 6c6f      return a.ilo
+000414c0: 635b 2d31 5d0a 2020 2020 656c 7365 3a0a  c[-1].    else:.
+000414d0: 2020 2020 2020 2020 2320 7461 6b65 206c          # take l
+000414e0: 6173 7420 7661 6c69 6420 7661 6c75 6520  ast valid value 
+000414f0: 6578 636c 7564 696e 6720 4e61 4e2c 204e  excluding NaN, N
+00041500: 614e 206c 6f63 6174 696f 6e20 6d61 7920  aN location may 
+00041510: 6265 2064 6966 6665 7265 6e74 0a20 2020  be different.   
+00041520: 2020 2020 2023 2069 6e20 6561 6368 2063       # in each c
+00041530: 6f6c 756d 6e0a 2020 2020 2020 2020 6966  olumn.        if
+00041540: 2069 735f 6461 7461 6672 616d 655f 6c69   is_dataframe_li
+00041550: 6b65 2861 293a 0a20 2020 2020 2020 2020  ke(a):.         
+00041560: 2020 2023 2063 7265 6174 6520 5365 7269     # create Seri
+00041570: 6573 2066 726f 6d20 6170 7072 6f70 7269  es from appropri
+00041580: 6174 6520 6261 636b 656e 6420 6461 7461  ate backend data
+00041590: 6672 616d 6520 6c69 6272 6172 790a 2020  frame library.  
+000415a0: 2020 2020 2020 2020 2020 7365 7269 6573            series
+000415b0: 5f74 7970 203d 2074 7970 6528 612e 696c  _typ = type(a.il
+000415c0: 6f63 5b30 3a31 2c20 305d 290a 2020 2020  oc[0:1, 0]).    
+000415d0: 2020 2020 2020 2020 6966 2061 2e65 6d70          if a.emp
+000415e0: 7479 3a0a 2020 2020 2020 2020 2020 2020  ty:.            
+000415f0: 2020 2020 7265 7475 726e 2073 6572 6965      return serie
+00041600: 735f 7479 7028 5b5d 2c20 6474 7970 653d  s_typ([], dtype=
+00041610: 2266 6c6f 6174 2229 0a20 2020 2020 2020  "float").       
+00041620: 2020 2020 2072 6574 7572 6e20 7365 7269       return seri
+00041630: 6573 5f74 7970 280a 2020 2020 2020 2020  es_typ(.        
+00041640: 2020 2020 2020 2020 5b5f 6c61 7374 5f76          [_last_v
+00041650: 616c 6964 2861 2e69 6c6f 635b 3a2c 2069  alid(a.iloc[:, i
+00041660: 5d29 2066 6f72 2069 2069 6e20 7261 6e67  ]) for i in rang
+00041670: 6528 6c65 6e28 612e 636f 6c75 6d6e 7329  e(len(a.columns)
+00041680: 295d 2c0a 2020 2020 2020 2020 2020 2020  )],.            
+00041690: 2020 2020 696e 6465 783d 612e 636f 6c75      index=a.colu
+000416a0: 6d6e 732c 0a20 2020 2020 2020 2020 2020  mns,.           
+000416b0: 2029 0a20 2020 2020 2020 2065 6c73 653a   ).        else:
+000416c0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000416d0: 7572 6e20 5f6c 6173 745f 7661 6c69 6428  urn _last_valid(
+000416e0: 6129 0a0a 0a64 6566 2063 6865 636b 5f64  a)...def check_d
+000416f0: 6976 6973 696f 6e73 2864 6976 6973 696f  ivisions(divisio
+00041700: 6e73 293a 0a20 2020 2069 6620 6e6f 7420  ns):.    if not 
+00041710: 6973 696e 7374 616e 6365 2864 6976 6973  isinstance(divis
+00041720: 696f 6e73 2c20 286c 6973 742c 2074 7570  ions, (list, tup
+00041730: 6c65 2929 3a0a 2020 2020 2020 2020 7261  le)):.        ra
+00041740: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+00041750: 4e65 7720 6469 7669 7369 6f6e 206d 7573  New division mus
+00041760: 7420 6265 206c 6973 7420 6f72 2074 7570  t be list or tup
+00041770: 6c65 2229 0a20 2020 2064 6976 6973 696f  le").    divisio
+00041780: 6e73 203d 206c 6973 7428 6469 7669 7369  ns = list(divisi
+00041790: 6f6e 7329 0a20 2020 2069 6620 6c65 6e28  ons).    if len(
+000417a0: 6469 7669 7369 6f6e 7329 203d 3d20 303a  divisions) == 0:
+000417b0: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
+000417c0: 616c 7565 4572 726f 7228 224e 6577 2064  alueError("New d
+000417d0: 6976 6973 696f 6e20 6d75 7374 206e 6f74  ivision must not
+000417e0: 2062 6520 656d 7074 7922 290a 2020 2020   be empty").    
+000417f0: 6966 2064 6976 6973 696f 6e73 2021 3d20  if divisions != 
+00041800: 736f 7274 6564 2864 6976 6973 696f 6e73  sorted(divisions
+00041810: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
+00041820: 2056 616c 7565 4572 726f 7228 224e 6577   ValueError("New
+00041830: 2064 6976 6973 696f 6e20 6d75 7374 2062   division must b
+00041840: 6520 736f 7274 6564 2229 0a20 2020 2069  e sorted").    i
+00041850: 6620 6c65 6e28 6469 7669 7369 6f6e 735b  f len(divisions[
+00041860: 3a2d 315d 2920 213d 206c 656e 286c 6973  :-1]) != len(lis
+00041870: 7428 756e 6971 7565 2864 6976 6973 696f  t(unique(divisio
+00041880: 6e73 5b3a 2d31 5d29 2929 3a0a 2020 2020  ns[:-1]))):.    
+00041890: 2020 2020 6d73 6720 3d20 224e 6577 2064      msg = "New d
+000418a0: 6976 6973 696f 6e20 6d75 7374 2062 6520  ivision must be 
+000418b0: 756e 6971 7565 2c20 6578 6365 7074 2066  unique, except f
+000418c0: 6f72 2074 6865 206c 6173 7420 656c 656d  or the last elem
+000418d0: 656e 7422 0a20 2020 2020 2020 2072 6169  ent".        rai
+000418e0: 7365 2056 616c 7565 4572 726f 7228 6d73  se ValueError(ms
+000418f0: 6729 0a0a 0a64 6566 2072 6570 6172 7469  g)...def reparti
+00041900: 7469 6f6e 5f64 6976 6973 696f 6e73 2861  tion_divisions(a
+00041910: 2c20 622c 206e 616d 652c 206f 7574 312c  , b, name, out1,
+00041920: 206f 7574 322c 2066 6f72 6365 3d46 616c   out2, force=Fal
+00041930: 7365 293a 0a20 2020 2022 2222 6461 736b  se):.    """dask
+00041940: 2067 7261 7068 2074 6f20 7265 7061 7274   graph to repart
+00041950: 6974 696f 6e20 6461 7461 6672 616d 6520  ition dataframe 
+00041960: 6279 206e 6577 2064 6976 6973 696f 6e73  by new divisions
+00041970: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+00041980: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+00041990: 2020 2020 6120 3a20 7475 706c 650a 2020      a : tuple.  
+000419a0: 2020 2020 2020 6f6c 6420 6469 7669 7369        old divisi
+000419b0: 6f6e 730a 2020 2020 6220 3a20 7475 706c  ons.    b : tupl
+000419c0: 652c 206c 6973 746d 7970 790a 2020 2020  e, listmypy.    
+000419d0: 6f75 7432 203a 2073 7472 0a20 2020 2020  out2 : str.     
+000419e0: 2020 206e 616d 6520 6f66 206e 6577 2064     name of new d
+000419f0: 6174 6166 7261 6d65 0a20 2020 2066 6f72  ataframe.    for
+00041a00: 6365 203a 2062 6f6f 6c2c 2064 6566 6175  ce : bool, defau
+00041a10: 6c74 2046 616c 7365 0a20 2020 2020 2020  lt False.       
+00041a20: 2041 6c6c 6f77 7320 7468 6520 6578 7061   Allows the expa
+00041a30: 6e73 696f 6e20 6f66 2074 6865 2065 7869  nsion of the exi
+00041a40: 7374 696e 6720 6469 7669 7369 6f6e 732e  sting divisions.
+00041a50: 0a20 2020 2020 2020 2049 6620 4661 6c73  .        If Fals
+00041a60: 6520 7468 656e 2074 6865 206e 6577 2064  e then the new d
+00041a70: 6976 6973 696f 6e73 206c 6f77 6572 2061  ivisions lower a
+00041a80: 6e64 2075 7070 6572 2062 6f75 6e64 7320  nd upper bounds 
+00041a90: 6d75 7374 2062 650a 2020 2020 2020 2020  must be.        
+00041aa0: 7468 6520 7361 6d65 2061 7320 7468 6520  the same as the 
+00041ab0: 6f6c 6420 6469 7669 7369 6f6e 732e 0a0a  old divisions...
+00041ac0: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+00041ad0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 3e3e   --------.    >>
+00041ae0: 3e20 6672 6f6d 2070 7072 696e 7420 696d  > from pprint im
+00041af0: 706f 7274 2070 7072 696e 740a 2020 2020  port pprint.    
+00041b00: 3e3e 3e20 7070 7269 6e74 2872 6570 6172  >>> pprint(repar
+00041b10: 7469 7469 6f6e 5f64 6976 6973 696f 6e73  tition_divisions
+00041b20: 285b 312c 2033 2c20 375d 2c20 5b31 2c20  ([1, 3, 7], [1, 
+00041b30: 342c 2036 2c20 375d 2c20 2761 272c 2027  4, 6, 7], 'a', '
+00041b40: 6227 2c20 2763 2729 2920 2023 2064 6f63  b', 'c'))  # doc
+00041b50: 7465 7374 3a20 2b45 4c4c 4950 5349 530a  test: +ELLIPSIS.
+00041b60: 2020 2020 7b28 2762 272c 2030 293a 2028      {('b', 0): (
+00041b70: 3c66 756e 6374 696f 6e20 626f 756e 6461  <function bounda
+00041b80: 7279 5f73 6c69 6365 2061 7420 2e2e 2e3e  ry_slice at ...>
+00041b90: 2c20 2827 6127 2c20 3029 2c20 312c 2033  , ('a', 0), 1, 3
+00041ba0: 2c20 4661 6c73 6529 2c0a 2020 2020 2028  , False),.     (
+00041bb0: 2762 272c 2031 293a 2028 3c66 756e 6374  'b', 1): (<funct
+00041bc0: 696f 6e20 626f 756e 6461 7279 5f73 6c69  ion boundary_sli
+00041bd0: 6365 2061 7420 2e2e 2e3e 2c20 2827 6127  ce at ...>, ('a'
+00041be0: 2c20 3129 2c20 332c 2034 2c20 4661 6c73  , 1), 3, 4, Fals
+00041bf0: 6529 2c0a 2020 2020 2028 2762 272c 2032  e),.     ('b', 2
+00041c00: 293a 2028 3c66 756e 6374 696f 6e20 626f  ): (<function bo
+00041c10: 756e 6461 7279 5f73 6c69 6365 2061 7420  undary_slice at 
+00041c20: 2e2e 2e3e 2c20 2827 6127 2c20 3129 2c20  ...>, ('a', 1), 
+00041c30: 342c 2036 2c20 4661 6c73 6529 2c0a 2020  4, 6, False),.  
+00041c40: 2020 2028 2762 272c 2033 293a 2028 3c66     ('b', 3): (<f
+00041c50: 756e 6374 696f 6e20 626f 756e 6461 7279  unction boundary
+00041c60: 5f73 6c69 6365 2061 7420 2e2e 2e3e 2c20  _slice at ...>, 
+00041c70: 2827 6127 2c20 3129 2c20 362c 2037 2c20  ('a', 1), 6, 7, 
+00041c80: 5472 7565 292c 0a20 2020 2020 2827 6327  True),.     ('c'
+00041c90: 2c20 3029 3a20 283c 6675 6e63 7469 6f6e  , 0): (<function
+00041ca0: 2063 6f6e 6361 7420 6174 202e 2e2e 3e2c   concat at ...>,
+00041cb0: 205b 2827 6227 2c20 3029 2c20 2827 6227   [('b', 0), ('b'
+00041cc0: 2c20 3129 5d29 2c0a 2020 2020 2028 2763  , 1)]),.     ('c
+00041cd0: 272c 2031 293a 2028 2762 272c 2032 292c  ', 1): ('b', 2),
+00041ce0: 0a20 2020 2020 2827 6327 2c20 3229 3a20  .     ('c', 2): 
+00041cf0: 2827 6227 2c20 3329 7d0a 2020 2020 2222  ('b', 3)}.    ""
+00041d00: 220a 2020 2020 6368 6563 6b5f 6469 7669  ".    check_divi
+00041d10: 7369 6f6e 7328 6229 0a0a 2020 2020 6966  sions(b)..    if
+00041d20: 206c 656e 2862 2920 3c20 323a 0a20 2020   len(b) < 2:.   
+00041d30: 2020 2020 2023 206d 696e 696d 756d 2064       # minimum d
+00041d40: 6976 6973 696f 6e20 6973 2032 2065 6c65  ivision is 2 ele
+00041d50: 6d65 6e74 732c 206c 696b 6520 5b30 2c20  ments, like [0, 
+00041d60: 305d 0a20 2020 2020 2020 2072 6169 7365  0].        raise
+00041d70: 2056 616c 7565 4572 726f 7228 224e 6577   ValueError("New
+00041d80: 2064 6976 6973 696f 6e20 6d75 7374 2062   division must b
+00041d90: 6520 6c6f 6e67 6572 2074 6861 6e20 3220  e longer than 2 
+00041da0: 656c 656d 656e 7473 2229 0a0a 2020 2020  elements")..    
+00041db0: 6966 2066 6f72 6365 3a0a 2020 2020 2020  if force:.      
+00041dc0: 2020 6966 2061 5b30 5d20 3c20 625b 305d    if a[0] < b[0]
+00041dd0: 3a0a 2020 2020 2020 2020 2020 2020 6d73  :.            ms
+00041de0: 6720 3d20 280a 2020 2020 2020 2020 2020  g = (.          
+00041df0: 2020 2020 2020 226c 6566 7420 7369 6465        "left side
+00041e00: 206f 6620 7468 6520 6e65 7720 6469 7669   of the new divi
+00041e10: 7369 6f6e 206d 7573 7420 6265 2065 7175  sion must be equ
+00041e20: 616c 206f 7220 736d 616c 6c65 7220 220a  al or smaller ".
+00041e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041e40: 2274 6861 6e20 6f6c 6420 6469 7669 7369  "than old divisi
+00041e50: 6f6e 220a 2020 2020 2020 2020 2020 2020  on".            
+00041e60: 290a 2020 2020 2020 2020 2020 2020 7261  ).            ra
+00041e70: 6973 6520 5661 6c75 6545 7272 6f72 286d  ise ValueError(m
+00041e80: 7367 290a 2020 2020 2020 2020 6966 2061  sg).        if a
+00041e90: 5b2d 315d 203e 2062 5b2d 315d 3a0a 2020  [-1] > b[-1]:.  
+00041ea0: 2020 2020 2020 2020 2020 6d73 6720 3d20            msg = 
+00041eb0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00041ec0: 2020 2272 6967 6874 2073 6964 6520 6f66    "right side of
+00041ed0: 2074 6865 206e 6577 2064 6976 6973 696f   the new divisio
+00041ee0: 6e20 6d75 7374 2062 6520 6571 7561 6c20  n must be equal 
+00041ef0: 6f72 206c 6172 6765 7220 220a 2020 2020  or larger ".    
+00041f00: 2020 2020 2020 2020 2020 2020 2274 6861              "tha
+00041f10: 6e20 6f6c 6420 6469 7669 7369 6f6e 220a  n old division".
+00041f20: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00041f30: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00041f40: 5661 6c75 6545 7272 6f72 286d 7367 290a  ValueError(msg).
+00041f50: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00041f60: 2020 6966 2061 5b30 5d20 213d 2062 5b30    if a[0] != b[0
+00041f70: 5d3a 0a20 2020 2020 2020 2020 2020 206d  ]:.            m
+00041f80: 7367 203d 2022 6c65 6674 2073 6964 6520  sg = "left side 
+00041f90: 6f66 206f 6c64 2061 6e64 206e 6577 2064  of old and new d
+00041fa0: 6976 6973 696f 6e73 2061 7265 2064 6966  ivisions are dif
+00041fb0: 6665 7265 6e74 220a 2020 2020 2020 2020  ferent".        
+00041fc0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00041fd0: 7272 6f72 286d 7367 290a 2020 2020 2020  rror(msg).      
+00041fe0: 2020 6966 2061 5b2d 315d 2021 3d20 625b    if a[-1] != b[
+00041ff0: 2d31 5d3a 0a20 2020 2020 2020 2020 2020  -1]:.           
+00042000: 206d 7367 203d 2022 7269 6768 7420 7369   msg = "right si
+00042010: 6465 206f 6620 6f6c 6420 616e 6420 6e65  de of old and ne
+00042020: 7720 6469 7669 7369 6f6e 7320 6172 6520  w divisions are 
+00042030: 6469 6666 6572 656e 7422 0a20 2020 2020  different".     
+00042040: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00042050: 7565 4572 726f 7228 6d73 6729 0a0a 2020  ueError(msg)..  
+00042060: 2020 6465 6620 5f69 735f 7369 6e67 6c65    def _is_single
+00042070: 5f6c 6173 745f 6469 7628 7829 3a0a 2020  _last_div(x):.  
+00042080: 2020 2020 2020 2222 2257 6865 7468 6572        """Whether
+00042090: 206c 6173 7420 6469 7669 7369 6f6e 206f   last division o
+000420a0: 6e6c 7920 636f 6e74 6169 6e73 2073 696e  nly contains sin
+000420b0: 676c 6520 6c61 6265 6c22 2222 0a20 2020  gle label""".   
+000420c0: 2020 2020 2072 6574 7572 6e20 6c65 6e28       return len(
+000420d0: 7829 203e 3d20 3220 616e 6420 785b 2d31  x) >= 2 and x[-1
+000420e0: 5d20 3d3d 2078 5b2d 325d 0a0a 2020 2020  ] == x[-2]..    
+000420f0: 6320 3d20 5b61 5b30 5d5d 0a20 2020 2064  c = [a[0]].    d
+00042100: 203d 2064 6963 7428 290a 2020 2020 6c6f   = dict().    lo
+00042110: 7720 3d20 615b 305d 0a0a 2020 2020 692c  w = a[0]..    i,
+00042120: 206a 203d 2031 2c20 3120 2023 2069 6e64   j = 1, 1  # ind
+00042130: 6963 6573 2066 6f72 206f 6c64 2f6e 6577  ices for old/new
+00042140: 2064 6976 6973 696f 6e73 0a20 2020 206b   divisions.    k
+00042150: 203d 2030 2020 2320 696e 6465 7820 666f   = 0  # index fo
+00042160: 7220 7465 6d70 2064 6976 6973 696f 6e73  r temp divisions
+00042170: 0a0a 2020 2020 6c61 7374 5f65 6c65 6d20  ..    last_elem 
+00042180: 3d20 5f69 735f 7369 6e67 6c65 5f6c 6173  = _is_single_las
+00042190: 745f 6469 7628 6129 0a0a 2020 2020 2320  t_div(a)..    # 
+000421a0: 7072 6f63 6573 7320 7468 726f 7567 6820  process through 
+000421b0: 6f6c 6420 6469 7669 7369 6f6e 0a20 2020  old division.   
+000421c0: 2023 206c 6566 7420 7061 7274 206f 6620   # left part of 
+000421d0: 6e65 7720 6469 7669 7369 6f6e 2063 616e  new division can
+000421e0: 2062 6520 7072 6f63 6573 7365 6420 696e   be processed in
+000421f0: 2074 6869 7320 6c6f 6f70 0a20 2020 2077   this loop.    w
+00042200: 6869 6c65 2069 203c 206c 656e 2861 2920  hile i < len(a) 
+00042210: 616e 6420 6a20 3c20 6c65 6e28 6229 3a0a  and j < len(b):.
+00042220: 2020 2020 2020 2020 6966 2061 5b69 5d20          if a[i] 
+00042230: 3c20 625b 6a5d 3a0a 2020 2020 2020 2020  < b[j]:.        
+00042240: 2020 2020 2320 7475 706c 6520 6973 2073      # tuple is s
+00042250: 6f6d 6574 6869 6e67 206c 696b 653a 0a20  omething like:. 
+00042260: 2020 2020 2020 2020 2020 2023 2028 6d65             # (me
+00042270: 7468 6f64 732e 626f 756e 6461 7279 5f73  thods.boundary_s
+00042280: 6c69 6365 2c20 2827 6672 6f6d 5f70 616e  lice, ('from_pan
+00042290: 6461 732d 2327 2c20 3029 2c20 332c 2034  das-#', 0), 3, 4
+000422a0: 2c20 4661 6c73 6529 290a 2020 2020 2020  , False)).      
+000422b0: 2020 2020 2020 645b 286f 7574 312c 206b        d[(out1, k
+000422c0: 295d 203d 2028 6d65 7468 6f64 732e 626f  )] = (methods.bo
+000422d0: 756e 6461 7279 5f73 6c69 6365 2c20 286e  undary_slice, (n
+000422e0: 616d 652c 2069 202d 2031 292c 206c 6f77  ame, i - 1), low
+000422f0: 2c20 615b 695d 2c20 4661 6c73 6529 0a20  , a[i], False). 
+00042300: 2020 2020 2020 2020 2020 206c 6f77 203d             low =
+00042310: 2061 5b69 5d0a 2020 2020 2020 2020 2020   a[i].          
+00042320: 2020 6920 2b3d 2031 0a20 2020 2020 2020    i += 1.       
+00042330: 2065 6c69 6620 615b 695d 203e 2062 5b6a   elif a[i] > b[j
+00042340: 5d3a 0a20 2020 2020 2020 2020 2020 2064  ]:.            d
+00042350: 5b28 6f75 7431 2c20 6b29 5d20 3d20 286d  [(out1, k)] = (m
+00042360: 6574 686f 6473 2e62 6f75 6e64 6172 795f  ethods.boundary_
+00042370: 736c 6963 652c 2028 6e61 6d65 2c20 6920  slice, (name, i 
+00042380: 2d20 3129 2c20 6c6f 772c 2062 5b6a 5d2c  - 1), low, b[j],
+00042390: 2046 616c 7365 290a 2020 2020 2020 2020   False).        
+000423a0: 2020 2020 6c6f 7720 3d20 625b 6a5d 0a20      low = b[j]. 
+000423b0: 2020 2020 2020 2020 2020 206a 202b 3d20             j += 
+000423c0: 310a 2020 2020 2020 2020 656c 7365 3a0a  1.        else:.
+000423d0: 2020 2020 2020 2020 2020 2020 645b 286f              d[(o
+000423e0: 7574 312c 206b 295d 203d 2028 6d65 7468  ut1, k)] = (meth
+000423f0: 6f64 732e 626f 756e 6461 7279 5f73 6c69  ods.boundary_sli
+00042400: 6365 2c20 286e 616d 652c 2069 202d 2031  ce, (name, i - 1
+00042410: 292c 206c 6f77 2c20 625b 6a5d 2c20 4661  ), low, b[j], Fa
+00042420: 6c73 6529 0a20 2020 2020 2020 2020 2020  lse).           
+00042430: 206c 6f77 203d 2062 5b6a 5d0a 2020 2020   low = b[j].    
+00042440: 2020 2020 2020 2020 6966 206c 656e 2861          if len(a
+00042450: 2920 3d3d 2069 202b 2031 206f 7220 615b  ) == i + 1 or a[
+00042460: 695d 203c 2061 5b69 202b 2031 5d3a 0a20  i] < a[i + 1]:. 
+00042470: 2020 2020 2020 2020 2020 2020 2020 206a                 j
+00042480: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
+00042490: 2020 6920 2b3d 2031 0a20 2020 2020 2020    i += 1.       
+000424a0: 2063 2e61 7070 656e 6428 6c6f 7729 0a20   c.append(low). 
+000424b0: 2020 2020 2020 206b 202b 3d20 310a 0a20         k += 1.. 
+000424c0: 2020 2023 2072 6967 6874 2070 6172 7420     # right part 
+000424d0: 6f66 206e 6577 2064 6976 6973 696f 6e20  of new division 
+000424e0: 6361 6e20 7265 6d61 696e 0a20 2020 2069  can remain.    i
+000424f0: 6620 615b 2d31 5d20 3c20 625b 2d31 5d20  f a[-1] < b[-1] 
+00042500: 6f72 2062 5b2d 315d 203d 3d20 625b 2d32  or b[-1] == b[-2
+00042510: 5d3a 0a20 2020 2020 2020 2066 6f72 205f  ]:.        for _
+00042520: 6a20 696e 2072 616e 6765 286a 2c20 6c65  j in range(j, le
+00042530: 6e28 6229 293a 0a20 2020 2020 2020 2020  n(b)):.         
+00042540: 2020 2023 2061 6c77 6179 7320 7573 6520     # always use 
+00042550: 7269 6768 742d 6d6f 7374 206f 6620 6f6c  right-most of ol
+00042560: 6420 6469 7669 7369 6f6e 0a20 2020 2020  d division.     
+00042570: 2020 2020 2020 2023 2062 6563 6175 7365         # because
+00042580: 2069 7420 6d61 7920 636f 6e74 6169 6e20   it may contain 
+00042590: 6c61 7374 2065 6c65 6d65 6e74 0a20 2020  last element.   
+000425a0: 2020 2020 2020 2020 206d 203d 206c 656e           m = len
+000425b0: 2861 2920 2d20 320a 2020 2020 2020 2020  (a) - 2.        
+000425c0: 2020 2020 645b 286f 7574 312c 206b 295d      d[(out1, k)]
+000425d0: 203d 2028 6d65 7468 6f64 732e 626f 756e   = (methods.boun
+000425e0: 6461 7279 5f73 6c69 6365 2c20 286e 616d  dary_slice, (nam
+000425f0: 652c 206d 292c 206c 6f77 2c20 625b 5f6a  e, m), low, b[_j
+00042600: 5d2c 2046 616c 7365 290a 2020 2020 2020  ], False).      
+00042610: 2020 2020 2020 6c6f 7720 3d20 625b 5f6a        low = b[_j
+00042620: 5d0a 2020 2020 2020 2020 2020 2020 632e  ].            c.
+00042630: 6170 7065 6e64 286c 6f77 290a 2020 2020  append(low).    
+00042640: 2020 2020 2020 2020 6b20 2b3d 2031 0a20          k += 1. 
+00042650: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00042660: 2023 2065 7665 6e20 6966 206e 6577 2064   # even if new d
+00042670: 6976 6973 696f 6e20 6973 2070 726f 6365  ivision is proce
+00042680: 7373 6564 2074 6872 6f75 6768 2c0a 2020  ssed through,.  
+00042690: 2020 2020 2020 2320 7269 6768 742d 6d6f        # right-mo
+000426a0: 7374 2065 6c65 6d65 6e74 206f 6620 6f6c  st element of ol
+000426b0: 6420 6469 7669 7369 6f6e 2063 616e 2072  d division can r
+000426c0: 656d 6169 6e0a 2020 2020 2020 2020 6966  emain.        if
+000426d0: 206c 6173 745f 656c 656d 2061 6e64 2069   last_elem and i
+000426e0: 203c 206c 656e 2861 293a 0a20 2020 2020   < len(a):.     
+000426f0: 2020 2020 2020 2064 5b28 6f75 7431 2c20         d[(out1, 
+00042700: 6b29 5d20 3d20 286d 6574 686f 6473 2e62  k)] = (methods.b
+00042710: 6f75 6e64 6172 795f 736c 6963 652c 2028  oundary_slice, (
+00042720: 6e61 6d65 2c20 6920 2d20 3129 2c20 615b  name, i - 1), a[
+00042730: 695d 2c20 615b 695d 2c20 4661 6c73 6529  i], a[i], False)
+00042740: 0a20 2020 2020 2020 2020 2020 206b 202b  .            k +
+00042750: 3d20 310a 2020 2020 2020 2020 632e 6170  = 1.        c.ap
+00042760: 7065 6e64 2861 5b2d 315d 290a 0a20 2020  pend(a[-1])..   
+00042770: 2023 2072 6570 6c61 6365 206c 6173 7420   # replace last 
+00042780: 656c 656d 656e 7420 6f66 2074 7570 6c65  element of tuple
+00042790: 2077 6974 6820 5472 7565 0a20 2020 2064   with True.    d
+000427a0: 5b28 6f75 7431 2c20 6b20 2d20 3129 5d20  [(out1, k - 1)] 
+000427b0: 3d20 645b 286f 7574 312c 206b 202d 2031  = d[(out1, k - 1
+000427c0: 295d 5b3a 2d31 5d20 2b20 2854 7275 652c  )][:-1] + (True,
+000427d0: 290a 0a20 2020 2069 2c20 6a20 3d20 302c  )..    i, j = 0,
+000427e0: 2031 0a0a 2020 2020 6c61 7374 5f65 6c65   1..    last_ele
+000427f0: 6d20 3d20 5f69 735f 7369 6e67 6c65 5f6c  m = _is_single_l
+00042800: 6173 745f 6469 7628 6329 0a0a 2020 2020  ast_div(c)..    
+00042810: 7768 696c 6520 6a20 3c20 6c65 6e28 6229  while j < len(b)
+00042820: 3a0a 2020 2020 2020 2020 746d 7020 3d20  :.        tmp = 
+00042830: 5b5d 0a20 2020 2020 2020 2077 6869 6c65  [].        while
+00042840: 2063 5b69 5d20 3c20 625b 6a5d 3a0a 2020   c[i] < b[j]:.  
+00042850: 2020 2020 2020 2020 2020 746d 702e 6170            tmp.ap
+00042860: 7065 6e64 2828 6f75 7431 2c20 6929 290a  pend((out1, i)).
+00042870: 2020 2020 2020 2020 2020 2020 6920 2b3d              i +=
+00042880: 2031 0a20 2020 2020 2020 2077 6869 6c65   1.        while
+00042890: 2028 0a20 2020 2020 2020 2020 2020 206c   (.            l
+000428a0: 6173 745f 656c 656d 0a20 2020 2020 2020  ast_elem.       
+000428b0: 2020 2020 2061 6e64 2063 5b69 5d20 3d3d       and c[i] ==
+000428c0: 2062 5b2d 315d 0a20 2020 2020 2020 2020   b[-1].         
+000428d0: 2020 2061 6e64 2028 625b 2d31 5d20 213d     and (b[-1] !=
+000428e0: 2062 5b2d 325d 206f 7220 6a20 3d3d 206c   b[-2] or j == l
+000428f0: 656e 2862 2920 2d20 3129 0a20 2020 2020  en(b) - 1).     
+00042900: 2020 2020 2020 2061 6e64 2069 203c 206b         and i < k
+00042910: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
+00042920: 2020 2020 2020 2020 2320 6170 7065 6e64          # append
+00042930: 2069 6620 6c61 7374 2073 706c 6974 2069   if last split i
+00042940: 7320 6e6f 7420 696e 636c 7564 6564 0a20  s not included. 
+00042950: 2020 2020 2020 2020 2020 2074 6d70 2e61             tmp.a
+00042960: 7070 656e 6428 286f 7574 312c 2069 2929  ppend((out1, i))
+00042970: 0a20 2020 2020 2020 2020 2020 2069 202b  .            i +
+00042980: 3d20 310a 2020 2020 2020 2020 6966 206c  = 1.        if l
+00042990: 656e 2874 6d70 2920 3d3d 2030 3a0a 2020  en(tmp) == 0:.  
+000429a0: 2020 2020 2020 2020 2020 2320 6475 6d6d            # dumm
+000429b0: 7920 736c 6963 6520 746f 2072 6574 7572  y slice to retur
+000429c0: 6e20 656d 7074 7920 4461 7461 4672 616d  n empty DataFram
+000429d0: 6520 6f72 2053 6572 6965 732c 0a20 2020  e or Series,.   
+000429e0: 2020 2020 2020 2020 2023 2077 6869 6368           # which
+000429f0: 2072 6574 6169 6e20 6f72 6967 696e 616c   retain original
+00042a00: 2064 6174 6120 6174 7472 6962 7574 6573   data attributes
+00042a10: 2028 636f 6c75 6d6e 7320 2f20 6e61 6d65   (columns / name
+00042a20: 290a 2020 2020 2020 2020 2020 2020 645b  ).            d[
+00042a30: 286f 7574 322c 206a 202d 2031 295d 203d  (out2, j - 1)] =
+00042a40: 2028 6d65 7468 6f64 732e 626f 756e 6461   (methods.bounda
+00042a50: 7279 5f73 6c69 6365 2c20 286e 616d 652c  ry_slice, (name,
+00042a60: 2030 292c 2061 5b30 5d2c 2061 5b30 5d2c   0), a[0], a[0],
+00042a70: 2046 616c 7365 290a 2020 2020 2020 2020   False).        
+00042a80: 656c 6966 206c 656e 2874 6d70 2920 3d3d  elif len(tmp) ==
+00042a90: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00042aa0: 645b 286f 7574 322c 206a 202d 2031 295d  d[(out2, j - 1)]
+00042ab0: 203d 2074 6d70 5b30 5d0a 2020 2020 2020   = tmp[0].      
+00042ac0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00042ad0: 2020 2020 6966 206e 6f74 2074 6d70 3a0a      if not tmp:.
+00042ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042af0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00042b00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00042b10: 2020 2020 2020 2263 6865 636b 2066 6f72        "check for
+00042b20: 2064 7570 6c69 6361 7465 2070 6172 7469   duplicate parti
+00042b30: 7469 6f6e 735c 6e6f 6c64 3a5c 6e25 735c  tions\nold:\n%s\
+00042b40: 6e5c 6e22 0a20 2020 2020 2020 2020 2020  n\n".           
+00042b50: 2020 2020 2020 2020 2022 6e65 773a 5c6e           "new:\n
+00042b60: 2573 5c6e 5c6e 636f 6d62 696e 6564 3a5c  %s\n\ncombined:\
+00042b70: 6e25 7322 2025 2028 7066 6f72 6d61 7428  n%s" % (pformat(
+00042b80: 6129 2c20 7066 6f72 6d61 7428 6229 2c20  a), pformat(b), 
+00042b90: 7066 6f72 6d61 7428 6329 290a 2020 2020  pformat(c)).    
+00042ba0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00042bb0: 2020 2020 2020 2020 2020 645b 286f 7574            d[(out
+00042bc0: 322c 206a 202d 2031 295d 203d 2028 6d65  2, j - 1)] = (me
+00042bd0: 7468 6f64 732e 636f 6e63 6174 2c20 746d  thods.concat, tm
+00042be0: 7029 0a20 2020 2020 2020 206a 202b 3d20  p).        j += 
+00042bf0: 310a 2020 2020 7265 7475 726e 2064 0a0a  1.    return d..
+00042c00: 0a64 6566 2072 6570 6172 7469 7469 6f6e  .def repartition
+00042c10: 5f66 7265 7128 6466 2c20 6672 6571 3d4e  _freq(df, freq=N
+00042c20: 6f6e 6529 3a0a 2020 2020 2222 2252 6570  one):.    """Rep
+00042c30: 6172 7469 7469 6f6e 2061 2074 696d 6573  artition a times
+00042c40: 6572 6965 7320 6461 7461 6672 616d 6520  eries dataframe 
+00042c50: 6279 2061 206e 6577 2066 7265 7175 656e  by a new frequen
+00042c60: 6379 2222 220a 2020 2020 6966 206e 6f74  cy""".    if not
+00042c70: 2069 7369 6e73 7461 6e63 6528 6466 2e64   isinstance(df.d
+00042c80: 6976 6973 696f 6e73 5b30 5d2c 2070 642e  ivisions[0], pd.
+00042c90: 5469 6d65 7374 616d 7029 3a0a 2020 2020  Timestamp):.    
+00042ca0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
+00042cb0: 726f 7228 2243 616e 206f 6e6c 7920 7265  ror("Can only re
+00042cc0: 7061 7274 6974 696f 6e20 6f6e 2066 7265  partition on fre
+00042cd0: 7175 656e 6379 2066 6f72 2074 696d 6573  quency for times
+00042ce0: 6572 6965 7322 290a 0a20 2020 2066 7265  eries")..    fre
+00042cf0: 7120 3d20 5f6d 6170 5f66 7265 715f 746f  q = _map_freq_to
+00042d00: 5f70 6572 696f 645f 7374 6172 7428 6672  _period_start(fr
+00042d10: 6571 290a 0a20 2020 2074 7279 3a0a 2020  eq)..    try:.  
+00042d20: 2020 2020 2020 7374 6172 7420 3d20 6466        start = df
+00042d30: 2e64 6976 6973 696f 6e73 5b30 5d2e 6365  .divisions[0].ce
+00042d40: 696c 2866 7265 7129 0a20 2020 2065 7863  il(freq).    exc
+00042d50: 6570 7420 5661 6c75 6545 7272 6f72 3a0a  ept ValueError:.
+00042d60: 2020 2020 2020 2020 7374 6172 7420 3d20          start = 
+00042d70: 6466 2e64 6976 6973 696f 6e73 5b30 5d0a  df.divisions[0].
+00042d80: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
+00042d90: 6d65 7468 6f64 732e 746f 6c69 7374 280a  methods.tolist(.
+00042da0: 2020 2020 2020 2020 7064 2e64 6174 655f          pd.date_
+00042db0: 7261 6e67 6528 7374 6172 743d 7374 6172  range(start=star
+00042dc0: 742c 2065 6e64 3d64 662e 6469 7669 7369  t, end=df.divisi
+00042dd0: 6f6e 735b 2d31 5d2c 2066 7265 713d 6672  ons[-1], freq=fr
+00042de0: 6571 290a 2020 2020 290a 2020 2020 6966  eq).    ).    if
+00042df0: 206e 6f74 206c 656e 2864 6976 6973 696f   not len(divisio
+00042e00: 6e73 293a 0a20 2020 2020 2020 2064 6976  ns):.        div
+00042e10: 6973 696f 6e73 203d 205b 6466 2e64 6976  isions = [df.div
+00042e20: 6973 696f 6e73 5b30 5d2c 2064 662e 6469  isions[0], df.di
+00042e30: 7669 7369 6f6e 735b 2d31 5d5d 0a20 2020  visions[-1]].   
+00042e40: 2065 6c73 653a 0a20 2020 2020 2020 2064   else:.        d
+00042e50: 6976 6973 696f 6e73 2e61 7070 656e 6428  ivisions.append(
+00042e60: 6466 2e64 6976 6973 696f 6e73 5b2d 315d  df.divisions[-1]
+00042e70: 290a 2020 2020 2020 2020 6966 2064 6976  ).        if div
+00042e80: 6973 696f 6e73 5b30 5d20 213d 2064 662e  isions[0] != df.
+00042e90: 6469 7669 7369 6f6e 735b 305d 3a0a 2020  divisions[0]:.  
+00042ea0: 2020 2020 2020 2020 2020 6469 7669 7369            divisi
+00042eb0: 6f6e 7320 3d20 5b64 662e 6469 7669 7369  ons = [df.divisi
+00042ec0: 6f6e 735b 305d 5d20 2b20 6469 7669 7369  ons[0]] + divisi
+00042ed0: 6f6e 730a 0a20 2020 2072 6574 7572 6e20  ons..    return 
+00042ee0: 6466 2e72 6570 6172 7469 7469 6f6e 2864  df.repartition(d
+00042ef0: 6976 6973 696f 6e73 3d64 6976 6973 696f  ivisions=divisio
+00042f00: 6e73 290a 0a0a 6465 6620 5f6d 6170 5f66  ns)...def _map_f
+00042f10: 7265 715f 746f 5f70 6572 696f 645f 7374  req_to_period_st
+00042f20: 6172 7428 6672 6571 293a 0a20 2020 2022  art(freq):.    "
+00042f30: 2222 456e 7375 7265 2074 6861 7420 7468  ""Ensure that th
+00042f40: 6520 6672 6571 7565 6e63 7920 7065 7274  e frequency pert
+00042f50: 6169 6e73 2074 6f20 7468 6520 2a2a 7374  ains to the **st
+00042f60: 6172 742a 2a20 6f66 2061 2070 6572 696f  art** of a perio
+00042f70: 642e 0a0a 2020 2020 4966 2065 2e67 2e20  d...    If e.g. 
+00042f80: 6066 7265 713d 274d 2760 2c20 7468 656e  `freq='M'`, then
+00042f90: 2074 6865 2064 6976 6973 696f 6e73 2061   the divisions a
+00042fa0: 7265 3a0a 2020 2020 2020 2020 2d20 3230  re:.        - 20
+00042fb0: 3231 2d33 312d 3120 3030 3a30 303a 3030  21-31-1 00:00:00
+00042fc0: 2028 7374 6172 7420 6f66 2046 6562 7275   (start of Febru
+00042fd0: 6172 7920 7061 7274 6974 696f 6e29 0a20  ary partition). 
+00042fe0: 2020 2020 2020 202d 2032 3032 312d 322d         - 2021-2-
+00042ff0: 3238 2030 303a 3030 3a30 3020 2873 7461  28 00:00:00 (sta
+00043000: 7274 206f 6620 4d61 7263 6820 7061 7274  rt of March part
+00043010: 6974 696f 6e29 0a20 2020 2020 2020 202d  ition).        -
+00043020: 202e 2e2e 0a0a 2020 2020 6275 7420 7468   .....    but th
+00043030: 6973 202a 2a73 686f 756c 642a 2a20 6265  is **should** be
+00043040: 3a0a 2020 2020 2020 2020 2d20 3230 3231  :.        - 2021
+00043050: 2d32 2d31 2030 303a 3030 3a30 3020 2873  -2-1 00:00:00 (s
+00043060: 7461 7274 206f 6620 4665 6272 7561 7279  tart of February
+00043070: 2070 6172 7469 7469 6f6e 290a 2020 2020   partition).    
+00043080: 2020 2020 2d20 3230 3231 2d33 2d31 2030      - 2021-3-1 0
+00043090: 303a 3030 3a30 3020 2873 7461 7274 206f  0:00:00 (start o
+000430a0: 6620 4d61 7263 6820 7061 7274 6974 696f  f March partitio
+000430b0: 6e29 0a20 2020 2020 2020 202d 202e 2e2e  n).        - ...
+000430c0: 0a0a 2020 2020 5468 6572 6566 6f72 652c  ..    Therefore,
+000430d0: 2077 6520 6d61 7020 6066 7265 713d 274d   we map `freq='M
+000430e0: 2760 2074 6f20 6066 7265 713d 274d 5327  '` to `freq='MS'
+000430f0: 6020 2873 616d 6520 666f 7220 7175 6172  ` (same for quar
+00043100: 7465 7220 616e 6420 7965 6172 292e 0a20  ter and year).. 
+00043110: 2020 2022 2222 0a0a 2020 2020 6966 206e     """..    if n
+00043120: 6f74 2069 7369 6e73 7461 6e63 6528 6672  ot isinstance(fr
+00043130: 6571 2c20 7374 7229 3a0a 2020 2020 2020  eq, str):.      
+00043140: 2020 7265 7475 726e 2066 7265 710a 0a20    return freq.. 
+00043150: 2020 206f 6666 7365 7420 3d20 7064 2e74     offset = pd.t
+00043160: 7365 7269 6573 2e66 7265 7175 656e 6369  series.frequenci
+00043170: 6573 2e74 6f5f 6f66 6673 6574 2866 7265  es.to_offset(fre
+00043180: 7129 0a20 2020 206f 6666 7365 745f 7479  q).    offset_ty
+00043190: 7065 5f6e 616d 6520 3d20 7479 7065 286f  pe_name = type(o
+000431a0: 6666 7365 7429 2e5f 5f6e 616d 655f 5f0a  ffset).__name__.
+000431b0: 0a20 2020 2069 6620 6e6f 7420 6f66 6673  .    if not offs
+000431c0: 6574 5f74 7970 655f 6e61 6d65 2e65 6e64  et_type_name.end
+000431d0: 7377 6974 6828 2245 6e64 2229 3a0a 2020  swith("End"):.  
+000431e0: 2020 2020 2020 7265 7475 726e 2066 7265        return fre
+000431f0: 710a 0a20 2020 206e 6577 5f6f 6666 7365  q..    new_offse
+00043200: 7420 3d20 6f66 6673 6574 5f74 7970 655f  t = offset_type_
+00043210: 6e61 6d65 5b3a 202d 6c65 6e28 2245 6e64  name[: -len("End
+00043220: 2229 5d20 2b20 2242 6567 696e 220a 2020  ")] + "Begin".  
+00043230: 2020 7472 793a 0a20 2020 2020 2020 206e    try:.        n
+00043240: 6577 5f6f 6666 7365 745f 7479 7065 203d  ew_offset_type =
+00043250: 2067 6574 6174 7472 2870 642e 7473 6572   getattr(pd.tser
+00043260: 6965 732e 6f66 6673 6574 732c 206e 6577  ies.offsets, new
+00043270: 5f6f 6666 7365 7429 0a20 2020 2020 2020  _offset).       
+00043280: 2069 6620 222d 2220 696e 2066 7265 713a   if "-" in freq:
+00043290: 0a20 2020 2020 2020 2020 2020 205f 2c20  .            _, 
+000432a0: 616e 6368 6f72 203d 2066 7265 712e 7370  anchor = freq.sp
+000432b0: 6c69 7428 222d 2229 0a20 2020 2020 2020  lit("-").       
+000432c0: 2020 2020 2061 6e63 686f 7220 3d20 222d       anchor = "-
+000432d0: 2220 2b20 616e 6368 6f72 0a20 2020 2020  " + anchor.     
+000432e0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000432f0: 2020 2020 2061 6e63 686f 7220 3d20 2222       anchor = ""
+00043300: 0a20 2020 2020 2020 206e 203d 2073 7472  .        n = str
+00043310: 286f 6666 7365 742e 6e29 2069 6620 6f66  (offset.n) if of
+00043320: 6673 6574 2e6e 2021 3d20 3120 656c 7365  fset.n != 1 else
+00043330: 2022 220a 2020 2020 2020 2020 7265 7475   "".        retu
+00043340: 726e 2066 227b 6e7d 7b6e 6577 5f6f 6666  rn f"{n}{new_off
+00043350: 7365 745f 7479 7065 2e5f 7072 6566 6978  set_type._prefix
+00043360: 7d7b 616e 6368 6f72 7d22 0a20 2020 2065  }{anchor}".    e
+00043370: 7863 6570 7420 4174 7472 6962 7574 6545  xcept AttributeE
+00043380: 7272 6f72 3a0a 2020 2020 2020 2020 7265  rror:.        re
+00043390: 7475 726e 2066 7265 710a 0a0a 6465 6620  turn freq...def 
+000433a0: 7265 7061 7274 6974 696f 6e5f 7369 7a65  repartition_size
+000433b0: 2864 662c 2073 697a 6529 3a0a 2020 2020  (df, size):.    
+000433c0: 2222 220a 2020 2020 5265 7061 7274 6974  """.    Repartit
+000433d0: 696f 6e20 6461 7461 6672 616d 6520 736f  ion dataframe so
+000433e0: 2074 6861 7420 6e65 7720 7061 7274 6974   that new partit
+000433f0: 696f 6e73 2068 6176 6520 6170 7072 6f78  ions have approx
+00043400: 696d 6174 656c 7920 6073 697a 6560 206d  imately `size` m
+00043410: 656d 6f72 7920 7573 6167 6520 6561 6368  emory usage each
+00043420: 0a20 2020 2022 2222 0a20 2020 2069 6620  .    """.    if 
+00043430: 6973 696e 7374 616e 6365 2873 697a 652c  isinstance(size,
+00043440: 2073 7472 293a 0a20 2020 2020 2020 2073   str):.        s
+00043450: 697a 6520 3d20 7061 7273 655f 6279 7465  ize = parse_byte
+00043460: 7328 7369 7a65 290a 2020 2020 7369 7a65  s(size).    size
+00043470: 203d 2069 6e74 2873 697a 6529 0a0a 2020   = int(size)..  
+00043480: 2020 6d65 6d5f 7573 6167 6573 203d 2064    mem_usages = d
+00043490: 662e 6d61 705f 7061 7274 6974 696f 6e73  f.map_partitions
+000434a0: 2874 6f74 616c 5f6d 656d 5f75 7361 6765  (total_mem_usage
+000434b0: 2c20 6465 6570 3d54 7275 6529 2e63 6f6d  , deep=True).com
+000434c0: 7075 7465 2829 0a0a 2020 2020 2320 312e  pute()..    # 1.
+000434d0: 2073 706c 6974 2065 6163 6820 7061 7274   split each part
+000434e0: 6974 696f 6e20 7468 6174 2069 7320 6c61  ition that is la
+000434f0: 7267 6572 2074 6861 6e20 7061 7274 6974  rger than partit
+00043500: 696f 6e5f 7369 7a65 0a20 2020 206e 7370  ion_size.    nsp
+00043510: 6c69 7473 203d 2031 202b 206d 656d 5f75  lits = 1 + mem_u
+00043520: 7361 6765 7320 2f2f 2073 697a 650a 2020  sages // size.  
+00043530: 2020 6966 206e 702e 616e 7928 6e73 706c    if np.any(nspl
+00043540: 6974 7320 3e20 3129 3a0a 2020 2020 2020  its > 1):.      
+00043550: 2020 7370 6c69 745f 6e61 6d65 203d 2066    split_name = f
+00043560: 2272 6570 6172 7469 7469 6f6e 2d73 706c  "repartition-spl
+00043570: 6974 2d7b 7369 7a65 7d2d 7b74 6f6b 656e  it-{size}-{token
+00043580: 697a 6528 6466 297d 220a 2020 2020 2020  ize(df)}".      
+00043590: 2020 6466 203d 205f 7370 6c69 745f 7061    df = _split_pa
+000435a0: 7274 6974 696f 6e73 2864 662c 206e 7370  rtitions(df, nsp
+000435b0: 6c69 7473 2c20 7370 6c69 745f 6e61 6d65  lits, split_name
+000435c0: 290a 2020 2020 2020 2020 2320 7570 6461  ).        # upda
+000435d0: 7465 206d 656d 5f75 7361 6765 7320 746f  te mem_usages to
+000435e0: 2061 6363 6f75 6e74 2066 6f72 2074 6865   account for the
+000435f0: 2073 706c 6974 2070 6172 7469 7469 6f6e   split partition
+00043600: 730a 2020 2020 2020 2020 7370 6c69 745f  s.        split_
+00043610: 6d65 6d5f 7573 6167 6573 203d 205b 5d0a  mem_usages = [].
+00043620: 2020 2020 2020 2020 666f 7220 6e2c 2075          for n, u
+00043630: 7361 6765 2069 6e20 7a69 7028 6e73 706c  sage in zip(nspl
+00043640: 6974 732c 206d 656d 5f75 7361 6765 7329  its, mem_usages)
+00043650: 3a0a 2020 2020 2020 2020 2020 2020 7370  :.            sp
+00043660: 6c69 745f 6d65 6d5f 7573 6167 6573 2e65  lit_mem_usages.e
+00043670: 7874 656e 6428 5b75 7361 6765 202f 206e  xtend([usage / n
+00043680: 5d20 2a20 6e29 0a20 2020 2020 2020 206d  ] * n).        m
+00043690: 656d 5f75 7361 6765 7320 3d20 7064 2e53  em_usages = pd.S
+000436a0: 6572 6965 7328 7370 6c69 745f 6d65 6d5f  eries(split_mem_
+000436b0: 7573 6167 6573 290a 0a20 2020 2023 2032  usages)..    # 2
+000436c0: 2e20 6e6f 7720 7468 6174 2061 6c6c 2070  . now that all p
+000436d0: 6172 7469 7469 6f6e 7320 6172 6520 6c65  artitions are le
+000436e0: 7373 2074 6861 6e20 7369 7a65 2c20 636f  ss than size, co
+000436f0: 6e63 6174 2074 6865 6d20 7570 2074 6f20  ncat them up to 
+00043700: 7369 7a65 0a20 2020 2061 7373 6572 7420  size.    assert 
+00043710: 6e70 2e61 6c6c 286d 656d 5f75 7361 6765  np.all(mem_usage
+00043720: 7320 3c3d 2073 697a 6529 0a20 2020 206e  s <= size).    n
+00043730: 6577 5f6e 7061 7274 6974 696f 6e73 203d  ew_npartitions =
+00043740: 206c 6973 7428 6d61 7028 6c65 6e2c 2069   list(map(len, i
+00043750: 7465 725f 6368 756e 6b73 286d 656d 5f75  ter_chunks(mem_u
+00043760: 7361 6765 732c 2073 697a 6529 2929 0a20  sages, size))). 
+00043770: 2020 206e 6577 5f70 6172 7469 7469 6f6e     new_partition
+00043780: 735f 626f 756e 6461 7269 6573 203d 206e  s_boundaries = n
+00043790: 702e 6375 6d73 756d 286e 6577 5f6e 7061  p.cumsum(new_npa
+000437a0: 7274 6974 696f 6e73 290a 2020 2020 6e65  rtitions).    ne
+000437b0: 775f 6e61 6d65 203d 2066 2272 6570 6172  w_name = f"repar
+000437c0: 7469 7469 6f6e 2d7b 7369 7a65 7d2d 7b74  tition-{size}-{t
+000437d0: 6f6b 656e 697a 6528 6466 297d 220a 2020  okenize(df)}".  
+000437e0: 2020 7265 7475 726e 205f 7265 7061 7274    return _repart
+000437f0: 6974 696f 6e5f 6672 6f6d 5f62 6f75 6e64  ition_from_bound
+00043800: 6172 6965 7328 6466 2c20 6e65 775f 7061  aries(df, new_pa
+00043810: 7274 6974 696f 6e73 5f62 6f75 6e64 6172  rtitions_boundar
+00043820: 6965 732c 206e 6577 5f6e 616d 6529 0a0a  ies, new_name)..
+00043830: 0a64 6566 2074 6f74 616c 5f6d 656d 5f75  .def total_mem_u
+00043840: 7361 6765 2864 662c 2069 6e64 6578 3d54  sage(df, index=T
+00043850: 7275 652c 2064 6565 703d 4661 6c73 6529  rue, deep=False)
+00043860: 3a0a 2020 2020 6d65 6d5f 7573 6167 6520  :.    mem_usage 
+00043870: 3d20 6466 2e6d 656d 6f72 795f 7573 6167  = df.memory_usag
+00043880: 6528 696e 6465 783d 696e 6465 782c 2064  e(index=index, d
+00043890: 6565 703d 6465 6570 290a 2020 2020 6966  eep=deep).    if
+000438a0: 2069 735f 7365 7269 6573 5f6c 696b 6528   is_series_like(
+000438b0: 6d65 6d5f 7573 6167 6529 3a0a 2020 2020  mem_usage):.    
+000438c0: 2020 2020 6d65 6d5f 7573 6167 6520 3d20      mem_usage = 
+000438d0: 6d65 6d5f 7573 6167 652e 7375 6d28 290a  mem_usage.sum().
+000438e0: 2020 2020 7265 7475 726e 206d 656d 5f75      return mem_u
+000438f0: 7361 6765 0a0a 0a64 6566 2072 6570 6172  sage...def repar
+00043900: 7469 7469 6f6e 5f6e 7061 7274 6974 696f  tition_npartitio
+00043910: 6e73 2864 662c 206e 7061 7274 6974 696f  ns(df, npartitio
+00043920: 6e73 293a 0a20 2020 2022 2222 5265 7061  ns):.    """Repa
+00043930: 7274 6974 696f 6e20 6461 7461 6672 616d  rtition datafram
+00043940: 6520 746f 2061 2073 6d61 6c6c 6572 206e  e to a smaller n
+00043950: 756d 6265 7220 6f66 2070 6172 7469 7469  umber of partiti
+00043960: 6f6e 7322 2222 0a20 2020 206e 6577 5f6e  ons""".    new_n
+00043970: 616d 6520 3d20 2272 6570 6172 7469 7469  ame = "repartiti
+00043980: 6f6e 2d25 642d 2573 2220 2520 286e 7061  on-%d-%s" % (npa
+00043990: 7274 6974 696f 6e73 2c20 746f 6b65 6e69  rtitions, tokeni
+000439a0: 7a65 2864 6629 290a 2020 2020 6966 2064  ze(df)).    if d
+000439b0: 662e 6e70 6172 7469 7469 6f6e 7320 3d3d  f.npartitions ==
+000439c0: 206e 7061 7274 6974 696f 6e73 3a0a 2020   npartitions:.  
+000439d0: 2020 2020 2020 7265 7475 726e 2064 660a        return df.
+000439e0: 2020 2020 656c 6966 2064 662e 6e70 6172      elif df.npar
+000439f0: 7469 7469 6f6e 7320 3e20 6e70 6172 7469  titions > nparti
+00043a00: 7469 6f6e 733a 0a20 2020 2020 2020 206e  tions:.        n
+00043a10: 7061 7274 6974 696f 6e73 5f72 6174 696f  partitions_ratio
+00043a20: 203d 2064 662e 6e70 6172 7469 7469 6f6e   = df.npartition
+00043a30: 7320 2f20 6e70 6172 7469 7469 6f6e 730a  s / npartitions.
+00043a40: 2020 2020 2020 2020 6e65 775f 7061 7274          new_part
+00043a50: 6974 696f 6e73 5f62 6f75 6e64 6172 6965  itions_boundarie
+00043a60: 7320 3d20 5b0a 2020 2020 2020 2020 2020  s = [.          
+00043a70: 2020 696e 7428 6e65 775f 7061 7274 6974    int(new_partit
+00043a80: 696f 6e5f 696e 6465 7820 2a20 6e70 6172  ion_index * npar
+00043a90: 7469 7469 6f6e 735f 7261 7469 6f29 0a20  titions_ratio). 
+00043aa0: 2020 2020 2020 2020 2020 2066 6f72 206e             for n
+00043ab0: 6577 5f70 6172 7469 7469 6f6e 5f69 6e64  ew_partition_ind
+00043ac0: 6578 2069 6e20 7261 6e67 6528 6e70 6172  ex in range(npar
+00043ad0: 7469 7469 6f6e 7320 2b20 3129 0a20 2020  titions + 1).   
+00043ae0: 2020 2020 205d 0a20 2020 2020 2020 2072       ].        r
+00043af0: 6574 7572 6e20 5f72 6570 6172 7469 7469  eturn _repartiti
+00043b00: 6f6e 5f66 726f 6d5f 626f 756e 6461 7269  on_from_boundari
+00043b10: 6573 2864 662c 206e 6577 5f70 6172 7469  es(df, new_parti
+00043b20: 7469 6f6e 735f 626f 756e 6461 7269 6573  tions_boundaries
+00043b30: 2c20 6e65 775f 6e61 6d65 290a 2020 2020  , new_name).    
+00043b40: 656c 7365 3a0a 2020 2020 2020 2020 2320  else:.        # 
+00043b50: 4472 6f70 2064 7570 6c63 6174 6573 2069  Drop duplcates i
+00043b60: 6e20 6361 7365 206c 6173 7420 7061 7274  n case last part
+00043b70: 6974 696f 6e20 6861 7320 7361 6d65 0a20  ition has same. 
+00043b80: 2020 2020 2020 2023 2076 616c 7565 2066         # value f
+00043b90: 6f72 206d 696e 2061 6e64 206d 6178 2064  or min and max d
+00043ba0: 6976 6973 696f 6e0a 2020 2020 2020 2020  ivision.        
+00043bb0: 6f72 6967 696e 616c 5f64 6976 6973 696f  original_divisio
+00043bc0: 6e73 203d 2064 6976 6973 696f 6e73 203d  ns = divisions =
+00043bd0: 2070 642e 5365 7269 6573 2864 662e 6469   pd.Series(df.di
+00043be0: 7669 7369 6f6e 7329 2e64 726f 705f 6475  visions).drop_du
+00043bf0: 706c 6963 6174 6573 2829 0a20 2020 2020  plicates().     
+00043c00: 2020 2069 6620 6466 2e6b 6e6f 776e 5f64     if df.known_d
+00043c10: 6976 6973 696f 6e73 2061 6e64 2028 0a20  ivisions and (. 
+00043c20: 2020 2020 2020 2020 2020 2069 735f 6461             is_da
+00043c30: 7465 7469 6d65 3634 5f61 6e79 5f64 7479  tetime64_any_dty
+00043c40: 7065 2864 6976 6973 696f 6e73 2e64 7479  pe(divisions.dty
+00043c50: 7065 290a 2020 2020 2020 2020 2020 2020  pe).            
+00043c60: 6f72 2069 735f 6e75 6d65 7269 635f 6474  or is_numeric_dt
+00043c70: 7970 6528 6469 7669 7369 6f6e 732e 6474  ype(divisions.dt
+00043c80: 7970 6529 0a20 2020 2020 2020 2029 3a0a  ype).        ):.
+00043c90: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00043ca0: 735f 6461 7465 7469 6d65 3634 5f61 6e79  s_datetime64_any
+00043cb0: 5f64 7479 7065 2864 6976 6973 696f 6e73  _dtype(divisions
+00043cc0: 2e64 7479 7065 293a 0a20 2020 2020 2020  .dtype):.       
+00043cd0: 2020 2020 2020 2020 2064 6976 6973 696f           divisio
+00043ce0: 6e73 203d 2064 6976 6973 696f 6e73 2e76  ns = divisions.v
+00043cf0: 616c 7565 732e 6173 7479 7065 2822 666c  alues.astype("fl
+00043d00: 6f61 7436 3422 290a 0a20 2020 2020 2020  oat64")..       
+00043d10: 2020 2020 2069 6620 6973 5f73 6572 6965       if is_serie
+00043d20: 735f 6c69 6b65 2864 6976 6973 696f 6e73  s_like(divisions
+00043d30: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00043d40: 2020 2064 6976 6973 696f 6e73 203d 2064     divisions = d
+00043d50: 6976 6973 696f 6e73 2e76 616c 7565 730a  ivisions.values.
+00043d60: 0a20 2020 2020 2020 2020 2020 206e 203d  .            n =
+00043d70: 206c 656e 2864 6976 6973 696f 6e73 290a   len(divisions).
+00043d80: 2020 2020 2020 2020 2020 2020 6469 7669              divi
+00043d90: 7369 6f6e 7320 3d20 6e70 2e69 6e74 6572  sions = np.inter
+00043da0: 7028 0a20 2020 2020 2020 2020 2020 2020  p(.             
+00043db0: 2020 2078 3d6e 702e 6c69 6e73 7061 6365     x=np.linspace
+00043dc0: 2830 2c20 6e2c 206e 7061 7274 6974 696f  (0, n, npartitio
+00043dd0: 6e73 202b 2031 292c 0a20 2020 2020 2020  ns + 1),.       
+00043de0: 2020 2020 2020 2020 2078 703d 6e70 2e6c           xp=np.l
+00043df0: 696e 7370 6163 6528 302c 206e 2c20 6e29  inspace(0, n, n)
+00043e00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00043e10: 2020 6670 3d64 6976 6973 696f 6e73 2c0a    fp=divisions,.
+00043e20: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00043e30: 2020 2020 2020 2020 2020 6966 2069 735f            if is_
+00043e40: 6461 7465 7469 6d65 3634 5f61 6e79 5f64  datetime64_any_d
+00043e50: 7479 7065 286f 7269 6769 6e61 6c5f 6469  type(original_di
+00043e60: 7669 7369 6f6e 732e 6474 7970 6529 3a0a  visions.dtype):.
+00043e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043e80: 6469 7669 7369 6f6e 7320 3d20 6d65 7468  divisions = meth
+00043e90: 6f64 732e 746f 6c69 7374 280a 2020 2020  ods.tolist(.    
+00043ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043eb0: 7064 2e53 6572 6965 7328 6469 7669 7369  pd.Series(divisi
+00043ec0: 6f6e 7329 2e61 7374 7970 6528 6f72 6967  ons).astype(orig
+00043ed0: 696e 616c 5f64 6976 6973 696f 6e73 2e64  inal_divisions.d
+00043ee0: 7479 7065 290a 2020 2020 2020 2020 2020  type).          
+00043ef0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00043f00: 2020 2020 656c 6966 206e 702e 6973 7375      elif np.issu
+00043f10: 6264 7479 7065 286f 7269 6769 6e61 6c5f  bdtype(original_
+00043f20: 6469 7669 7369 6f6e 732e 6474 7970 652c  divisions.dtype,
+00043f30: 206e 702e 696e 7465 6765 7229 3a0a 2020   np.integer):.  
+00043f40: 2020 2020 2020 2020 2020 2020 2020 6469                di
+00043f50: 7669 7369 6f6e 7320 3d20 6469 7669 7369  visions = divisi
+00043f60: 6f6e 732e 6173 7479 7065 286f 7269 6769  ons.astype(origi
+00043f70: 6e61 6c5f 6469 7669 7369 6f6e 732e 6474  nal_divisions.dt
+00043f80: 7970 6529 0a0a 2020 2020 2020 2020 2020  ype)..          
+00043f90: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00043fa0: 6469 7669 7369 6f6e 732c 206e 702e 6e64  divisions, np.nd
+00043fb0: 6172 7261 7929 3a0a 2020 2020 2020 2020  array):.        
+00043fc0: 2020 2020 2020 2020 6469 7669 7369 6f6e          division
+00043fd0: 7320 3d20 6469 7669 7369 6f6e 732e 746f  s = divisions.to
+00043fe0: 6c69 7374 2829 0a0a 2020 2020 2020 2020  list()..        
+00043ff0: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
+00044000: 6c69 7374 2864 6976 6973 696f 6e73 290a  list(divisions).
+00044010: 2020 2020 2020 2020 2020 2020 6469 7669              divi
+00044020: 7369 6f6e 735b 305d 203d 2064 662e 6469  sions[0] = df.di
+00044030: 7669 7369 6f6e 735b 305d 0a20 2020 2020  visions[0].     
+00044040: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
+00044050: 5b2d 315d 203d 2064 662e 6469 7669 7369  [-1] = df.divisi
+00044060: 6f6e 735b 2d31 5d0a 0a20 2020 2020 2020  ons[-1]..       
+00044070: 2020 2020 2023 2045 6e73 7572 6520 7468       # Ensure th
+00044080: 6520 636f 6d70 7574 6564 2064 6976 6973  e computed divis
+00044090: 696f 6e73 2061 7265 2075 6e69 7175 650a  ions are unique.
+000440a0: 2020 2020 2020 2020 2020 2020 6469 7669              divi
+000440b0: 7369 6f6e 7320 3d20 6c69 7374 2875 6e69  sions = list(uni
+000440c0: 7175 6528 6469 7669 7369 6f6e 735b 3a2d  que(divisions[:-
+000440d0: 315d 2929 202b 205b 6469 7669 7369 6f6e  1])) + [division
+000440e0: 735b 2d31 5d5d 0a20 2020 2020 2020 2020  s[-1]].         
+000440f0: 2020 2072 6574 7572 6e20 6466 2e72 6570     return df.rep
+00044100: 6172 7469 7469 6f6e 2864 6976 6973 696f  artition(divisio
+00044110: 6e73 3d64 6976 6973 696f 6e73 290a 2020  ns=divisions).  
+00044120: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00044130: 2020 2020 2020 2020 6469 762c 206d 6f64          div, mod
+00044140: 203d 2064 6976 6d6f 6428 6e70 6172 7469   = divmod(nparti
+00044150: 7469 6f6e 732c 2064 662e 6e70 6172 7469  tions, df.nparti
+00044160: 7469 6f6e 7329 0a20 2020 2020 2020 2020  tions).         
+00044170: 2020 206e 7370 6c69 7473 203d 205b 6469     nsplits = [di
+00044180: 765d 202a 2064 662e 6e70 6172 7469 7469  v] * df.npartiti
+00044190: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
+000441a0: 6e73 706c 6974 735b 2d31 5d20 2b3d 206d  nsplits[-1] += m
+000441b0: 6f64 0a20 2020 2020 2020 2020 2020 2072  od.            r
+000441c0: 6574 7572 6e20 5f73 706c 6974 5f70 6172  eturn _split_par
+000441d0: 7469 7469 6f6e 7328 6466 2c20 6e73 706c  titions(df, nspl
+000441e0: 6974 732c 206e 6577 5f6e 616d 6529 0a0a  its, new_name)..
+000441f0: 0a64 6566 205f 7265 7061 7274 6974 696f  .def _repartitio
+00044200: 6e5f 6672 6f6d 5f62 6f75 6e64 6172 6965  n_from_boundarie
+00044210: 7328 6466 2c20 6e65 775f 7061 7274 6974  s(df, new_partit
+00044220: 696f 6e73 5f62 6f75 6e64 6172 6965 732c  ions_boundaries,
+00044230: 206e 6577 5f6e 616d 6529 3a0a 2020 2020   new_name):.    
+00044240: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00044250: 6528 6e65 775f 7061 7274 6974 696f 6e73  e(new_partitions
+00044260: 5f62 6f75 6e64 6172 6965 732c 206c 6973  _boundaries, lis
+00044270: 7429 3a0a 2020 2020 2020 2020 6e65 775f  t):.        new_
+00044280: 7061 7274 6974 696f 6e73 5f62 6f75 6e64  partitions_bound
+00044290: 6172 6965 7320 3d20 6c69 7374 286e 6577  aries = list(new
+000442a0: 5f70 6172 7469 7469 6f6e 735f 626f 756e  _partitions_boun
+000442b0: 6461 7269 6573 290a 2020 2020 6966 206e  daries).    if n
+000442c0: 6577 5f70 6172 7469 7469 6f6e 735f 626f  ew_partitions_bo
+000442d0: 756e 6461 7269 6573 5b30 5d20 3e20 303a  undaries[0] > 0:
+000442e0: 0a20 2020 2020 2020 206e 6577 5f70 6172  .        new_par
+000442f0: 7469 7469 6f6e 735f 626f 756e 6461 7269  titions_boundari
+00044300: 6573 2e69 6e73 6572 7428 302c 2030 290a  es.insert(0, 0).
+00044310: 2020 2020 6966 206e 6577 5f70 6172 7469      if new_parti
+00044320: 7469 6f6e 735f 626f 756e 6461 7269 6573  tions_boundaries
+00044330: 5b2d 315d 203c 2064 662e 6e70 6172 7469  [-1] < df.nparti
+00044340: 7469 6f6e 733a 0a20 2020 2020 2020 206e  tions:.        n
+00044350: 6577 5f70 6172 7469 7469 6f6e 735f 626f  ew_partitions_bo
+00044360: 756e 6461 7269 6573 2e61 7070 656e 6428  undaries.append(
+00044370: 6466 2e6e 7061 7274 6974 696f 6e73 290a  df.npartitions).
+00044380: 2020 2020 6473 6b20 3d20 7b7d 0a20 2020      dsk = {}.   
+00044390: 2066 6f72 2069 2c20 2873 7461 7274 2c20   for i, (start, 
+000443a0: 656e 6429 2069 6e20 656e 756d 6572 6174  end) in enumerat
+000443b0: 6528 0a20 2020 2020 2020 207a 6970 286e  e(.        zip(n
+000443c0: 6577 5f70 6172 7469 7469 6f6e 735f 626f  ew_partitions_bo
+000443d0: 756e 6461 7269 6573 2c20 6e65 775f 7061  undaries, new_pa
+000443e0: 7274 6974 696f 6e73 5f62 6f75 6e64 6172  rtitions_boundar
+000443f0: 6965 735b 313a 5d29 0a20 2020 2029 3a0a  ies[1:]).    ):.
+00044400: 2020 2020 2020 2020 6473 6b5b 6e65 775f          dsk[new_
+00044410: 6e61 6d65 2c20 695d 203d 2028 6d65 7468  name, i] = (meth
+00044420: 6f64 732e 636f 6e63 6174 2c20 5b28 6466  ods.concat, [(df
+00044430: 2e5f 6e61 6d65 2c20 6a29 2066 6f72 206a  ._name, j) for j
+00044440: 2069 6e20 7261 6e67 6528 7374 6172 742c   in range(start,
+00044450: 2065 6e64 295d 290a 2020 2020 6469 7669   end)]).    divi
+00044460: 7369 6f6e 7320 3d20 5b64 662e 6469 7669  sions = [df.divi
+00044470: 7369 6f6e 735b 695d 2066 6f72 2069 2069  sions[i] for i i
+00044480: 6e20 6e65 775f 7061 7274 6974 696f 6e73  n new_partitions
+00044490: 5f62 6f75 6e64 6172 6965 735d 0a20 2020  _boundaries].   
+000444a0: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
+000444b0: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
+000444c0: 6c65 6374 696f 6e73 286e 6577 5f6e 616d  lections(new_nam
+000444d0: 652c 2064 736b 2c20 6465 7065 6e64 656e  e, dsk, dependen
+000444e0: 6369 6573 3d5b 6466 5d29 0a20 2020 2072  cies=[df]).    r
+000444f0: 6574 7572 6e20 6e65 775f 6464 5f6f 626a  eturn new_dd_obj
+00044500: 6563 7428 6772 6170 682c 206e 6577 5f6e  ect(graph, new_n
+00044510: 616d 652c 2064 662e 5f6d 6574 612c 2064  ame, df._meta, d
+00044520: 6976 6973 696f 6e73 290a 0a0a 6465 6620  ivisions)...def 
+00044530: 5f73 706c 6974 5f70 6172 7469 7469 6f6e  _split_partition
+00044540: 7328 6466 2c20 6e73 706c 6974 732c 206e  s(df, nsplits, n
+00044550: 6577 5f6e 616d 6529 3a0a 2020 2020 2222  ew_name):.    ""
+00044560: 2253 706c 6974 2061 2044 6173 6b20 6461  "Split a Dask da
+00044570: 7461 6672 616d 6520 696e 746f 206e 6577  taframe into new
+00044580: 2070 6172 7469 7469 6f6e 730a 0a20 2020   partitions..   
+00044590: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+000445a0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064  ----------.    d
+000445b0: 663a 2044 6174 6146 7261 6d65 206f 7220  f: DataFrame or 
+000445c0: 5365 7269 6573 0a20 2020 206e 7370 6c69  Series.    nspli
+000445d0: 7473 3a20 4c69 7374 5b69 6e74 5d0a 2020  ts: List[int].  
+000445e0: 2020 2020 2020 4e75 6d62 6572 206f 6620        Number of 
+000445f0: 7461 7267 6574 2064 6174 6166 7261 6d65  target dataframe
+00044600: 7320 666f 7220 6561 6368 2070 6172 7469  s for each parti
+00044610: 7469 6f6e 0a20 2020 2020 2020 2054 6865  tion.        The
+00044620: 206c 656e 6774 6820 6f66 206e 7370 6c69   length of nspli
+00044630: 7473 2073 686f 756c 6420 6265 2074 6865  ts should be the
+00044640: 2073 616d 6520 6173 2064 662e 6e70 6172   same as df.npar
+00044650: 7469 7469 6f6e 730a 2020 2020 6e65 775f  titions.    new_
+00044660: 6e61 6d65 3a20 7374 720a 0a20 2020 2053  name: str..    S
+00044670: 6565 2041 6c73 6f0a 2020 2020 2d2d 2d2d  ee Also.    ----
+00044680: 2d2d 2d2d 0a20 2020 2072 6570 6172 7469  ----.    reparti
+00044690: 7469 6f6e 5f6e 7061 7274 6974 696f 6e73  tion_npartitions
+000446a0: 0a20 2020 2072 6570 6172 7469 7469 6f6e  .    repartition
+000446b0: 5f73 697a 650a 2020 2020 2222 220a 2020  _size.    """.  
+000446c0: 2020 6966 206c 656e 286e 7370 6c69 7473    if len(nsplits
+000446d0: 2920 213d 2064 662e 6e70 6172 7469 7469  ) != df.npartiti
+000446e0: 6f6e 733a 0a20 2020 2020 2020 2072 6169  ons:.        rai
+000446f0: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
+00044700: 6e73 706c 6974 7320 7368 6f75 6c64 2068  nsplits should h
+00044710: 6176 6520 6c65 6e3d 7b64 662e 6e70 6172  ave len={df.npar
+00044720: 7469 7469 6f6e 737d 2229 0a0a 2020 2020  titions}")..    
+00044730: 6473 6b20 3d20 7b7d 0a20 2020 2073 706c  dsk = {}.    spl
+00044740: 6974 5f6e 616d 6520 3d20 6622 7370 6c69  it_name = f"spli
+00044750: 742d 7b74 6f6b 656e 697a 6528 6466 2c20  t-{tokenize(df, 
+00044760: 6e73 706c 6974 7329 7d22 0a20 2020 206a  nsplits)}".    j
+00044770: 203d 2030 0a20 2020 2066 6f72 2069 2c20   = 0.    for i, 
+00044780: 6b20 696e 2065 6e75 6d65 7261 7465 286e  k in enumerate(n
+00044790: 7370 6c69 7473 293a 0a20 2020 2020 2020  splits):.       
+000447a0: 2069 6620 6b20 3d3d 2031 3a0a 2020 2020   if k == 1:.    
+000447b0: 2020 2020 2020 2020 6473 6b5b 6e65 775f          dsk[new_
+000447c0: 6e61 6d65 2c20 6a5d 203d 2028 6466 2e5f  name, j] = (df._
+000447d0: 6e61 6d65 2c20 6929 0a20 2020 2020 2020  name, i).       
+000447e0: 2020 2020 206a 202b 3d20 310a 2020 2020       j += 1.    
+000447f0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00044800: 2020 2020 2020 6473 6b5b 7370 6c69 745f        dsk[split_
+00044810: 6e61 6d65 2c20 695d 203d 2028 7370 6c69  name, i] = (spli
+00044820: 745f 6576 656e 6c79 2c20 2864 662e 5f6e  t_evenly, (df._n
+00044830: 616d 652c 2069 292c 206b 290a 2020 2020  ame, i), k).    
+00044840: 2020 2020 2020 2020 666f 7220 6a6a 2069          for jj i
+00044850: 6e20 7261 6e67 6528 6b29 3a0a 2020 2020  n range(k):.    
+00044860: 2020 2020 2020 2020 2020 2020 6473 6b5b              dsk[
+00044870: 6e65 775f 6e61 6d65 2c20 6a5d 203d 2028  new_name, j] = (
+00044880: 6765 7469 7465 6d2c 2028 7370 6c69 745f  getitem, (split_
+00044890: 6e61 6d65 2c20 6929 2c20 6a6a 290a 2020  name, i), jj).  
+000448a0: 2020 2020 2020 2020 2020 2020 2020 6a20                j 
+000448b0: 2b3d 2031 0a0a 2020 2020 6469 7669 7369  += 1..    divisi
+000448c0: 6f6e 7320 3d20 5b4e 6f6e 655d 202a 2028  ons = [None] * (
+000448d0: 3120 2b20 7375 6d28 6e73 706c 6974 7329  1 + sum(nsplits)
+000448e0: 290a 2020 2020 6772 6170 6820 3d20 4869  ).    graph = Hi
+000448f0: 6768 4c65 7665 6c47 7261 7068 2e66 726f  ghLevelGraph.fro
+00044900: 6d5f 636f 6c6c 6563 7469 6f6e 7328 6e65  m_collections(ne
+00044910: 775f 6e61 6d65 2c20 6473 6b2c 2064 6570  w_name, dsk, dep
+00044920: 656e 6465 6e63 6965 733d 5b64 665d 290a  endencies=[df]).
+00044930: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
+00044940: 645f 6f62 6a65 6374 2867 7261 7068 2c20  d_object(graph, 
+00044950: 6e65 775f 6e61 6d65 2c20 6466 2e5f 6d65  new_name, df._me
+00044960: 7461 2c20 6469 7669 7369 6f6e 7329 0a0a  ta, divisions)..
+00044970: 0a64 6566 2072 6570 6172 7469 7469 6f6e  .def repartition
+00044980: 2864 662c 2064 6976 6973 696f 6e73 3d4e  (df, divisions=N
+00044990: 6f6e 652c 2066 6f72 6365 3d46 616c 7365  one, force=False
+000449a0: 293a 0a20 2020 2022 2222 5265 7061 7274  ):.    """Repart
+000449b0: 6974 696f 6e20 6461 7461 6672 616d 6520  ition dataframe 
+000449c0: 616c 6f6e 6720 6e65 7720 6469 7669 7369  along new divisi
+000449d0: 6f6e 730a 0a20 2020 2044 6173 6b2e 4461  ons..    Dask.Da
+000449e0: 7461 4672 616d 6520 6f62 6a65 6374 7320  taFrame objects 
+000449f0: 6172 6520 7061 7274 6974 696f 6e65 6420  are partitioned 
+00044a00: 616c 6f6e 6720 7468 6569 7220 696e 6465  along their inde
+00044a10: 782e 2020 4f66 7465 6e20 7768 656e 0a20  x.  Often when. 
+00044a20: 2020 206d 756c 7469 706c 6520 6461 7461     multiple data
+00044a30: 6672 616d 6573 2069 6e74 6572 6163 7420  frames interact 
+00044a40: 7765 206e 6565 6420 746f 2061 6c69 676e  we need to align
+00044a50: 2074 6865 7365 2070 6172 7469 7469 6f6e   these partition
+00044a60: 696e 6773 2e20 2054 6865 0a20 2020 2060  ings.  The.    `
+00044a70: 6072 6570 6172 7469 7469 6f6e 6060 2066  `repartition`` f
+00044a80: 756e 6374 696f 6e20 636f 6e73 7472 7563  unction construc
+00044a90: 7473 2061 206e 6577 2044 6174 6146 7261  ts a new DataFra
+00044aa0: 6d65 206f 626a 6563 7420 686f 6c64 696e  me object holdin
+00044ab0: 6720 7468 6520 7361 6d65 0a20 2020 2064  g the same.    d
+00044ac0: 6174 6120 6275 7420 7061 7274 6974 696f  ata but partitio
+00044ad0: 6e65 6420 6f6e 2064 6966 6665 7265 6e74  ned on different
+00044ae0: 2076 616c 7565 732e 2020 4974 2064 6f65   values.  It doe
+00044af0: 7320 7468 6973 2062 7920 7065 7266 6f72  s this by perfor
+00044b00: 6d69 6e67 2061 0a20 2020 2073 6571 7565  ming a.    seque
+00044b10: 6e63 6520 6f66 2060 606c 6f63 6060 2061  nce of ``loc`` a
+00044b20: 6e64 2060 6063 6f6e 6361 7460 6020 6361  nd ``concat`` ca
+00044b30: 6c6c 7320 746f 2073 706c 6974 2061 6e64  lls to split and
+00044b40: 206d 6572 6765 2074 6865 2070 7265 7669   merge the previ
+00044b50: 6f75 730a 2020 2020 6765 6e65 7261 7469  ous.    generati
+00044b60: 6f6e 206f 6620 7061 7274 6974 696f 6e73  on of partitions
+00044b70: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+00044b80: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+00044b90: 0a0a 2020 2020 6469 7669 7369 6f6e 7320  ..    divisions 
+00044ba0: 3a20 6c69 7374 0a20 2020 2020 2020 204c  : list.        L
+00044bb0: 6973 7420 6f66 2070 6172 7469 7469 6f6e  ist of partition
+00044bc0: 7320 746f 2062 6520 7573 6564 0a20 2020  s to be used.   
+00044bd0: 2066 6f72 6365 203a 2062 6f6f 6c2c 2064   force : bool, d
+00044be0: 6566 6175 6c74 2046 616c 7365 0a20 2020  efault False.   
+00044bf0: 2020 2020 2041 6c6c 6f77 7320 7468 6520       Allows the 
+00044c00: 6578 7061 6e73 696f 6e20 6f66 2074 6865  expansion of the
+00044c10: 2065 7869 7374 696e 6720 6469 7669 7369   existing divisi
+00044c20: 6f6e 732e 0a20 2020 2020 2020 2049 6620  ons..        If 
+00044c30: 4661 6c73 6520 7468 656e 2074 6865 206e  False then the n
+00044c40: 6577 2064 6976 6973 696f 6e73 206c 6f77  ew divisions low
+00044c50: 6572 2061 6e64 2075 7070 6572 2062 6f75  er and upper bou
+00044c60: 6e64 7320 6d75 7374 2062 650a 2020 2020  nds must be.    
+00044c70: 2020 2020 7468 6520 7361 6d65 2061 7320      the same as 
+00044c80: 7468 6520 6f6c 6420 6469 7669 7369 6f6e  the old division
+00044c90: 732e 0a0a 2020 2020 4578 616d 706c 6573  s...    Examples
+00044ca0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 0a20  .    --------.. 
+00044cb0: 2020 203e 3e3e 2064 6620 3d20 6466 2e72     >>> df = df.r
+00044cc0: 6570 6172 7469 7469 6f6e 285b 302c 2035  epartition([0, 5
+00044cd0: 2c20 3130 2c20 3230 5d29 2020 2320 646f  , 10, 20])  # do
+00044ce0: 6374 6573 743a 202b 534b 4950 0a0a 2020  ctest: +SKIP..  
+00044cf0: 2020 416c 736f 2077 6f72 6b73 206f 6e20    Also works on 
+00044d00: 5061 6e64 6173 206f 626a 6563 7473 0a0a  Pandas objects..
+00044d10: 2020 2020 3e3e 3e20 6464 6620 3d20 6464      >>> ddf = dd
+00044d20: 2e72 6570 6172 7469 7469 6f6e 2864 662c  .repartition(df,
+00044d30: 205b 302c 2035 2c20 3130 2c20 3230 5d29   [0, 5, 10, 20])
+00044d40: 2020 2320 646f 6374 6573 743a 202b 534b    # doctest: +SK
+00044d50: 4950 0a20 2020 2022 2222 0a0a 2020 2020  IP.    """..    
+00044d60: 2320 6e6f 2d6f 7020 6661 7374 7061 7468  # no-op fastpath
+00044d70: 2066 6f72 2077 6865 6e20 7765 2061 6c72   for when we alr
+00044d80: 6561 6479 2068 6176 6520 6d61 7463 6869  eady have matchi
+00044d90: 6e67 2064 6976 6973 696f 6e73 0a20 2020  ng divisions.   
+00044da0: 2069 6620 6973 5f64 6173 6b5f 636f 6c6c   if is_dask_coll
+00044db0: 6563 7469 6f6e 2864 6629 2061 6e64 2064  ection(df) and d
+00044dc0: 662e 6469 7669 7369 6f6e 7320 3d3d 2074  f.divisions == t
+00044dd0: 7570 6c65 2864 6976 6973 696f 6e73 293a  uple(divisions):
+00044de0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00044df0: 6466 0a0a 2020 2020 746f 6b65 6e20 3d20  df..    token = 
+00044e00: 746f 6b65 6e69 7a65 2864 662c 2064 6976  tokenize(df, div
+00044e10: 6973 696f 6e73 290a 2020 2020 6966 2069  isions).    if i
+00044e20: 7369 6e73 7461 6e63 6528 6466 2c20 5f46  sinstance(df, _F
+00044e30: 7261 6d65 293a 0a20 2020 2020 2020 2074  rame):.        t
+00044e40: 6d70 203d 2022 7265 7061 7274 6974 696f  mp = "repartitio
+00044e50: 6e2d 7370 6c69 742d 2220 2b20 746f 6b65  n-split-" + toke
+00044e60: 6e0a 2020 2020 2020 2020 6f75 7420 3d20  n.        out = 
+00044e70: 2272 6570 6172 7469 7469 6f6e 2d6d 6572  "repartition-mer
+00044e80: 6765 2d22 202b 2074 6f6b 656e 0a20 2020  ge-" + token.   
+00044e90: 2020 2020 2064 736b 203d 2072 6570 6172       dsk = repar
+00044ea0: 7469 7469 6f6e 5f64 6976 6973 696f 6e73  tition_divisions
+00044eb0: 280a 2020 2020 2020 2020 2020 2020 6466  (.            df
+00044ec0: 2e64 6976 6973 696f 6e73 2c20 6469 7669  .divisions, divi
+00044ed0: 7369 6f6e 732c 2064 662e 5f6e 616d 652c  sions, df._name,
+00044ee0: 2074 6d70 2c20 6f75 742c 2066 6f72 6365   tmp, out, force
+00044ef0: 3d66 6f72 6365 0a20 2020 2020 2020 2029  =force.        )
+00044f00: 0a20 2020 2020 2020 2067 7261 7068 203d  .        graph =
+00044f10: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
+00044f20: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
+00044f30: 286f 7574 2c20 6473 6b2c 2064 6570 656e  (out, dsk, depen
+00044f40: 6465 6e63 6965 733d 5b64 665d 290a 2020  dencies=[df]).  
+00044f50: 2020 2020 2020 7265 7475 726e 206e 6577        return new
+00044f60: 5f64 645f 6f62 6a65 6374 2867 7261 7068  _dd_object(graph
+00044f70: 2c20 6f75 742c 2064 662e 5f6d 6574 612c  , out, df._meta,
+00044f80: 2064 6976 6973 696f 6e73 290a 2020 2020   divisions).    
+00044f90: 656c 6966 2069 735f 6461 7461 6672 616d  elif is_datafram
+00044fa0: 655f 6c69 6b65 2864 6629 206f 7220 6973  e_like(df) or is
+00044fb0: 5f73 6572 6965 735f 6c69 6b65 2864 6629  _series_like(df)
+00044fc0: 3a0a 2020 2020 2020 2020 6e61 6d65 203d  :.        name =
+00044fd0: 2022 7265 7061 7274 6974 696f 6e2d 6461   "repartition-da
+00044fe0: 7461 6672 616d 652d 2220 2b20 746f 6b65  taframe-" + toke
+00044ff0: 6e0a 2020 2020 2020 2020 6672 6f6d 2064  n.        from d
+00045000: 6173 6b2e 6461 7461 6672 616d 652e 7574  ask.dataframe.ut
+00045010: 696c 7320 696d 706f 7274 2073 6861 7264  ils import shard
+00045020: 5f64 665f 6f6e 5f69 6e64 6578 0a0a 2020  _df_on_index..  
+00045030: 2020 2020 2020 6466 7320 3d20 7368 6172        dfs = shar
+00045040: 645f 6466 5f6f 6e5f 696e 6465 7828 6466  d_df_on_index(df
+00045050: 2c20 6469 7669 7369 6f6e 735b 313a 2d31  , divisions[1:-1
+00045060: 5d29 0a20 2020 2020 2020 2064 736b 203d  ]).        dsk =
+00045070: 207b 286e 616d 652c 2069 293a 2064 6620   {(name, i): df 
+00045080: 666f 7220 692c 2064 6620 696e 2065 6e75  for i, df in enu
+00045090: 6d65 7261 7465 2864 6673 297d 0a20 2020  merate(dfs)}.   
+000450a0: 2020 2020 2072 6574 7572 6e20 6e65 775f       return new_
+000450b0: 6464 5f6f 626a 6563 7428 6473 6b2c 206e  dd_object(dsk, n
+000450c0: 616d 652c 2064 662c 2064 6976 6973 696f  ame, df, divisio
+000450d0: 6e73 290a 2020 2020 7261 6973 6520 5661  ns).    raise Va
+000450e0: 6c75 6545 7272 6f72 2822 4461 7461 206d  lueError("Data m
+000450f0: 7573 7420 6265 2044 6174 6146 7261 6d65  ust be DataFrame
+00045100: 206f 7220 5365 7269 6573 2229 0a0a 0a64   or Series")...d
+00045110: 6566 205f 7265 6475 6374 696f 6e5f 6368  ef _reduction_ch
+00045120: 756e 6b28 782c 2061 6361 5f63 6875 6e6b  unk(x, aca_chunk
+00045130: 3d4e 6f6e 652c 202a 2a6b 7761 7267 7329  =None, **kwargs)
+00045140: 3a0a 2020 2020 6f20 3d20 6163 615f 6368  :.    o = aca_ch
+00045150: 756e 6b28 782c 202a 2a6b 7761 7267 7329  unk(x, **kwargs)
+00045160: 0a20 2020 2023 2052 6574 7572 6e20 6120  .    # Return a 
+00045170: 6461 7461 6672 616d 6520 736f 2074 6861  dataframe so tha
+00045180: 7420 7468 6520 636f 6e63 6174 656e 6174  t the concatenat
+00045190: 6564 2076 6572 7369 6f6e 2069 7320 616c  ed version is al
+000451a0: 736f 2061 2064 6174 6166 7261 6d65 0a20  so a dataframe. 
+000451b0: 2020 2069 6620 6e6f 7420 6973 5f73 6572     if not is_ser
+000451c0: 6965 735f 6c69 6b65 286f 293a 0a20 2020  ies_like(o):.   
+000451d0: 2020 2020 2072 6574 7572 6e20 6f0a 2020       return o.  
+000451e0: 2020 7265 7375 6c74 203d 206f 2e74 6f5f    result = o.to_
+000451f0: 6672 616d 6528 292e 540a 2020 2020 6966  frame().T.    if
+00045200: 206f 2e64 7479 7065 2e6b 696e 6420 3d3d   o.dtype.kind ==
+00045210: 2022 4f22 3a0a 2020 2020 2020 2020 2320   "O":.        # 
+00045220: 5761 7320 636f 6572 6365 6420 746f 206f  Was coerced to o
+00045230: 626a 6563 742c 2073 6f20 6361 7374 2062  bject, so cast b
+00045240: 6163 6b0a 2020 2020 2020 2020 7265 7475  ack.        retu
+00045250: 726e 2072 6573 756c 742e 696e 6665 725f  rn result.infer_
+00045260: 6f62 6a65 6374 7328 290a 2020 2020 7265  objects().    re
+00045270: 7475 726e 2072 6573 756c 740a 0a0a 6465  turn result...de
+00045280: 6620 5f72 6564 7563 7469 6f6e 5f63 6f6d  f _reduction_com
+00045290: 6269 6e65 2878 2c20 6163 615f 636f 6d62  bine(x, aca_comb
+000452a0: 696e 653d 4e6f 6e65 2c20 2a2a 6b77 6172  ine=None, **kwar
+000452b0: 6773 293a 0a20 2020 2069 6620 6973 696e  gs):.    if isin
+000452c0: 7374 616e 6365 2878 2c20 6c69 7374 293a  stance(x, list):
+000452d0: 0a20 2020 2020 2020 2078 203d 2070 642e  .        x = pd.
+000452e0: 5365 7269 6573 2878 290a 2020 2020 6f20  Series(x).    o 
+000452f0: 3d20 6163 615f 636f 6d62 696e 6528 782c  = aca_combine(x,
+00045300: 202a 2a6b 7761 7267 7329 0a20 2020 2023   **kwargs).    #
+00045310: 2052 6574 7572 6e20 6120 6461 7461 6672   Return a datafr
+00045320: 616d 6520 736f 2074 6861 7420 7468 6520  ame so that the 
+00045330: 636f 6e63 6174 656e 6174 6564 2076 6572  concatenated ver
+00045340: 7369 6f6e 2069 7320 616c 736f 2061 2064  sion is also a d
+00045350: 6174 6166 7261 6d65 0a20 2020 2072 6574  ataframe.    ret
+00045360: 7572 6e20 6f2e 746f 5f66 7261 6d65 2829  urn o.to_frame()
+00045370: 2e54 2069 6620 6973 5f73 6572 6965 735f  .T if is_series_
+00045380: 6c69 6b65 286f 2920 656c 7365 206f 0a0a  like(o) else o..
+00045390: 0a64 6566 205f 7265 6475 6374 696f 6e5f  .def _reduction_
+000453a0: 6167 6772 6567 6174 6528 782c 2061 6361  aggregate(x, aca
+000453b0: 5f61 6767 7265 6761 7465 3d4e 6f6e 652c  _aggregate=None,
+000453c0: 202a 2a6b 7761 7267 7329 3a0a 2020 2020   **kwargs):.    
+000453d0: 6966 2069 7369 6e73 7461 6e63 6528 782c  if isinstance(x,
+000453e0: 206c 6973 7429 3a0a 2020 2020 2020 2020   list):.        
+000453f0: 7820 3d20 7064 2e53 6572 6965 7328 7829  x = pd.Series(x)
+00045400: 0a20 2020 2072 6574 7572 6e20 6163 615f  .    return aca_
+00045410: 6167 6772 6567 6174 6528 782c 202a 2a6b  aggregate(x, **k
+00045420: 7761 7267 7329 0a0a 0a64 6566 2069 6478  wargs)...def idx
+00045430: 6d61 786d 696e 5f63 6875 6e6b 2878 2c20  maxmin_chunk(x, 
+00045440: 666e 3d4e 6f6e 652c 2073 6b69 706e 613d  fn=None, skipna=
+00045450: 5472 7565 2c20 6e75 6d65 7269 635f 6f6e  True, numeric_on
+00045460: 6c79 3d46 616c 7365 293a 0a20 2020 206e  ly=False):.    n
+00045470: 756d 6572 6963 5f6f 6e6c 795f 6b77 6172  umeric_only_kwar
+00045480: 6773 203d 2028 0a20 2020 2020 2020 207b  gs = (.        {
+00045490: 7d20 6966 206e 6f74 2050 414e 4441 535f  } if not PANDAS_
+000454a0: 4754 5f31 3530 206f 7220 6973 5f73 6572  GT_150 or is_ser
+000454b0: 6965 735f 6c69 6b65 2878 2920 656c 7365  ies_like(x) else
+000454c0: 207b 226e 756d 6572 6963 5f6f 6e6c 7922   {"numeric_only"
+000454d0: 3a20 6e75 6d65 7269 635f 6f6e 6c79 7d0a  : numeric_only}.
+000454e0: 2020 2020 290a 2020 2020 6d69 6e6d 6178      ).    minmax
+000454f0: 203d 2022 6d61 7822 2069 6620 666e 203d   = "max" if fn =
+00045500: 3d20 2269 6478 6d61 7822 2065 6c73 6520  = "idxmax" else 
+00045510: 226d 696e 220a 2020 2020 6966 206c 656e  "min".    if len
+00045520: 2878 2920 3e20 303a 0a20 2020 2020 2020  (x) > 0:.       
+00045530: 2069 6478 203d 2067 6574 6174 7472 2878   idx = getattr(x
+00045540: 2c20 666e 2928 736b 6970 6e61 3d73 6b69  , fn)(skipna=ski
+00045550: 706e 612c 202a 2a6e 756d 6572 6963 5f6f  pna, **numeric_o
+00045560: 6e6c 795f 6b77 6172 6773 290a 2020 2020  nly_kwargs).    
+00045570: 2020 2020 7661 6c75 6520 3d20 6765 7461      value = geta
+00045580: 7474 7228 782c 206d 696e 6d61 7829 2873  ttr(x, minmax)(s
+00045590: 6b69 706e 613d 736b 6970 6e61 2c20 2a2a  kipna=skipna, **
+000455a0: 6e75 6d65 7269 635f 6f6e 6c79 5f6b 7761  numeric_only_kwa
+000455b0: 7267 7329 0a20 2020 2065 6c73 653a 0a20  rgs).    else:. 
+000455c0: 2020 2020 2020 2069 6478 203d 2076 616c         idx = val
+000455d0: 7565 203d 206d 6574 615f 7365 7269 6573  ue = meta_series
+000455e0: 5f63 6f6e 7374 7275 6374 6f72 2878 2928  _constructor(x)(
+000455f0: 5b5d 2c20 6474 7970 653d 2269 3822 290a  [], dtype="i8").
+00045600: 2020 2020 6966 2069 735f 7365 7269 6573      if is_series
+00045610: 5f6c 696b 6528 6964 7829 3a0a 2020 2020  _like(idx):.    
+00045620: 2020 2020 7265 7475 726e 206d 6574 615f      return meta_
+00045630: 6672 616d 655f 636f 6e73 7472 7563 746f  frame_constructo
+00045640: 7228 7829 287b 2269 6478 223a 2069 6478  r(x)({"idx": idx
+00045650: 2c20 2276 616c 7565 223a 2076 616c 7565  , "value": value
+00045660: 7d29 0a20 2020 2072 6574 7572 6e20 6d65  }).    return me
+00045670: 7461 5f66 7261 6d65 5f63 6f6e 7374 7275  ta_frame_constru
+00045680: 6374 6f72 2878 2928 7b22 6964 7822 3a20  ctor(x)({"idx": 
+00045690: 5b69 6478 5d2c 2022 7661 6c75 6522 3a20  [idx], "value": 
+000456a0: 5b76 616c 7565 5d7d 290a 0a0a 6465 6620  [value]})...def 
+000456b0: 6964 786d 6178 6d69 6e5f 726f 7728 782c  idxmaxmin_row(x,
+000456c0: 2066 6e3d 4e6f 6e65 2c20 736b 6970 6e61   fn=None, skipna
+000456d0: 3d54 7275 6529 3a0a 2020 2020 6d69 6e6d  =True):.    minm
+000456e0: 6178 203d 2022 6d61 7822 2069 6620 666e  ax = "max" if fn
+000456f0: 203d 3d20 2269 6478 6d61 7822 2065 6c73   == "idxmax" els
+00045700: 6520 226d 696e 220a 2020 2020 6966 206c  e "min".    if l
+00045710: 656e 2878 2920 3e20 303a 0a20 2020 2020  en(x) > 0:.     
+00045720: 2020 2078 203d 2078 2e73 6574 5f69 6e64     x = x.set_ind
+00045730: 6578 2822 6964 7822 290a 2020 2020 2020  ex("idx").      
+00045740: 2020 2320 706f 7465 6e74 6961 6c6c 7920    # potentially 
+00045750: 636f 6572 6365 6420 746f 206f 626a 6563  coerced to objec
+00045760: 742c 2073 6f20 6361 7374 2062 6163 6b0a  t, so cast back.
+00045770: 2020 2020 2020 2020 7661 6c75 6520 3d20          value = 
+00045780: 782e 7661 6c75 652e 696e 6665 725f 6f62  x.value.infer_ob
+00045790: 6a65 6374 7328 290a 2020 2020 2020 2020  jects().        
+000457a0: 6964 7820 3d20 5b67 6574 6174 7472 2876  idx = [getattr(v
+000457b0: 616c 7565 2c20 666e 2928 736b 6970 6e61  alue, fn)(skipna
+000457c0: 3d73 6b69 706e 6129 5d0a 2020 2020 2020  =skipna)].      
+000457d0: 2020 7661 6c75 6520 3d20 5b67 6574 6174    value = [getat
+000457e0: 7472 2876 616c 7565 2c20 6d69 6e6d 6178  tr(value, minmax
+000457f0: 2928 736b 6970 6e61 3d73 6b69 706e 6129  )(skipna=skipna)
+00045800: 5d0a 2020 2020 656c 7365 3a0a 2020 2020  ].    else:.    
+00045810: 2020 2020 6964 7820 3d20 7661 6c75 6520      idx = value 
+00045820: 3d20 6d65 7461 5f73 6572 6965 735f 636f  = meta_series_co
+00045830: 6e73 7472 7563 746f 7228 7829 285b 5d2c  nstructor(x)([],
+00045840: 2064 7479 7065 3d22 6938 2229 0a20 2020   dtype="i8").   
+00045850: 2072 6574 7572 6e20 6d65 7461 5f66 7261   return meta_fra
+00045860: 6d65 5f63 6f6e 7374 7275 6374 6f72 2878  me_constructor(x
+00045870: 2928 0a20 2020 2020 2020 207b 0a20 2020  )(.        {.   
+00045880: 2020 2020 2020 2020 2022 6964 7822 3a20           "idx": 
+00045890: 6d65 7461 5f73 6572 6965 735f 636f 6e73  meta_series_cons
+000458a0: 7472 7563 746f 7228 7829 2869 6478 2c20  tructor(x)(idx, 
+000458b0: 6474 7970 653d 782e 696e 6465 782e 6474  dtype=x.index.dt
+000458c0: 7970 6529 2c0a 2020 2020 2020 2020 2020  ype),.          
+000458d0: 2020 2276 616c 7565 223a 206d 6574 615f    "value": meta_
+000458e0: 7365 7269 6573 5f63 6f6e 7374 7275 6374  series_construct
+000458f0: 6f72 2878 2928 7661 6c75 652c 2064 7479  or(x)(value, dty
+00045900: 7065 3d78 2e64 7479 7065 732e 696c 6f63  pe=x.dtypes.iloc
+00045910: 5b30 5d29 2c0a 2020 2020 2020 2020 7d0a  [0]),.        }.
+00045920: 2020 2020 290a 0a0a 6465 6620 6964 786d      )...def idxm
+00045930: 6178 6d69 6e5f 636f 6d62 696e 6528 782c  axmin_combine(x,
+00045940: 2066 6e3d 4e6f 6e65 2c20 736b 6970 6e61   fn=None, skipna
+00045950: 3d54 7275 6529 3a0a 2020 2020 6966 206c  =True):.    if l
+00045960: 656e 2878 2920 3c3d 2031 3a0a 2020 2020  en(x) <= 1:.    
+00045970: 2020 2020 7265 7475 726e 2078 0a20 2020      return x.   
+00045980: 2072 6574 7572 6e20 280a 2020 2020 2020   return (.      
+00045990: 2020 782e 6772 6f75 7062 7928 6c65 7665    x.groupby(leve
+000459a0: 6c3d 3029 0a20 2020 2020 2020 202e 6170  l=0).        .ap
+000459b0: 706c 7928 6964 786d 6178 6d69 6e5f 726f  ply(idxmaxmin_ro
+000459c0: 772c 2066 6e3d 666e 2c20 736b 6970 6e61  w, fn=fn, skipna
+000459d0: 3d73 6b69 706e 6129 0a20 2020 2020 2020  =skipna).       
+000459e0: 202e 7265 7365 745f 696e 6465 7828 6c65   .reset_index(le
+000459f0: 7665 6c3d 312c 2064 726f 703d 5472 7565  vel=1, drop=True
+00045a00: 290a 2020 2020 290a 0a0a 6465 6620 6964  ).    )...def id
+00045a10: 786d 6178 6d69 6e5f 6167 6728 782c 2066  xmaxmin_agg(x, f
+00045a20: 6e3d 4e6f 6e65 2c20 736b 6970 6e61 3d54  n=None, skipna=T
+00045a30: 7275 652c 2073 6361 6c61 723d 4661 6c73  rue, scalar=Fals
+00045a40: 652c 206e 756d 6572 6963 5f6f 6e6c 793d  e, numeric_only=
+00045a50: 6e6f 5f64 6566 6175 6c74 293a 0a20 2020  no_default):.   
+00045a60: 2072 6573 203d 2069 6478 6d61 786d 696e   res = idxmaxmin
+00045a70: 5f63 6f6d 6269 6e65 2878 2c20 666e 2c20  _combine(x, fn, 
+00045a80: 736b 6970 6e61 3d73 6b69 706e 6129 5b22  skipna=skipna)["
+00045a90: 6964 7822 5d0a 2020 2020 6966 206c 656e  idx"].    if len
+00045aa0: 2872 6573 2920 3d3d 2030 3a0a 2020 2020  (res) == 0:.    
+00045ab0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00045ac0: 7272 6f72 2822 6174 7465 6d70 7420 746f  rror("attempt to
+00045ad0: 2067 6574 2061 7267 6d61 7820 6f66 2061   get argmax of a
+00045ae0: 6e20 656d 7074 7920 7365 7175 656e 6365  n empty sequence
+00045af0: 2229 0a20 2020 2069 6620 7363 616c 6172  ").    if scalar
+00045b00: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00045b10: 2072 6573 5b30 5d0a 2020 2020 7265 732e   res[0].    res.
+00045b20: 6e61 6d65 203d 204e 6f6e 650a 2020 2020  name = None.    
+00045b30: 7265 7475 726e 2072 6573 0a0a 0a64 6566  return res...def
+00045b40: 205f 6d6f 6465 5f61 6767 7265 6761 7465   _mode_aggregate
+00045b50: 2864 662c 2064 726f 706e 6129 3a0a 2020  (df, dropna):.  
+00045b60: 2020 7661 6c75 655f 636f 756e 745f 7365    value_count_se
+00045b70: 7269 6573 203d 2064 662e 7375 6d28 290a  ries = df.sum().
+00045b80: 2020 2020 6d61 785f 7661 6c20 3d20 7661      max_val = va
+00045b90: 6c75 655f 636f 756e 745f 7365 7269 6573  lue_count_series
+00045ba0: 2e6d 6178 2873 6b69 706e 613d 6472 6f70  .max(skipna=drop
+00045bb0: 6e61 290a 2020 2020 6d6f 6465 5f73 6572  na).    mode_ser
+00045bc0: 6965 7320 3d20 280a 2020 2020 2020 2020  ies = (.        
+00045bd0: 7661 6c75 655f 636f 756e 745f 7365 7269  value_count_seri
+00045be0: 6573 5b76 616c 7565 5f63 6f75 6e74 5f73  es[value_count_s
+00045bf0: 6572 6965 7320 3d3d 206d 6178 5f76 616c  eries == max_val
+00045c00: 5d0a 2020 2020 2020 2020 2e69 6e64 6578  ].        .index
+00045c10: 2e74 6f5f 7365 7269 6573 2829 0a20 2020  .to_series().   
+00045c20: 2020 2020 202e 736f 7274 5f76 616c 7565       .sort_value
+00045c30: 7328 290a 2020 2020 2020 2020 2e72 6573  s().        .res
+00045c40: 6574 5f69 6e64 6578 2864 726f 703d 5472  et_index(drop=Tr
+00045c50: 7565 290a 2020 2020 290a 2020 2020 7265  ue).    ).    re
+00045c60: 7475 726e 206d 6f64 655f 7365 7269 6573  turn mode_series
+00045c70: 0a0a 0a64 6566 205f 636f 756e 745f 6167  ...def _count_ag
+00045c80: 6772 6567 6174 6528 7829 3a0a 2020 2020  gregate(x):.    
+00045c90: 7265 7475 726e 2078 2e73 756d 2829 2e61  return x.sum().a
+00045ca0: 7374 7970 6528 2269 6e74 3634 2229 0a0a  stype("int64")..
+00045cb0: 0a64 6566 2073 6166 655f 6865 6164 2864  .def safe_head(d
+00045cc0: 662c 206e 293a 0a20 2020 2072 203d 204d  f, n):.    r = M
+00045cd0: 2e68 6561 6428 6466 2c20 6e29 0a20 2020  .head(df, n).   
+00045ce0: 2069 6620 6c65 6e28 7229 2021 3d20 6e3a   if len(r) != n:
+00045cf0: 0a20 2020 2020 2020 2077 6172 6e69 6e67  .        warning
+00045d00: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
+00045d10: 2020 2020 6622 496e 7375 6666 6963 6965      f"Insufficie
+00045d20: 6e74 2065 6c65 6d65 6e74 7320 666f 7220  nt elements for 
+00045d30: 6068 6561 6460 2e20 7b6e 7d20 656c 656d  `head`. {n} elem
+00045d40: 656e 7473 2072 6571 7565 7374 6564 2c20  ents requested, 
+00045d50: 6f6e 6c79 207b 6c65 6e28 7229 7d20 220a  only {len(r)} ".
+00045d60: 2020 2020 2020 2020 2020 2020 2265 6c65              "ele
+00045d70: 6d65 6e74 7320 6176 6169 6c61 626c 652e  ments available.
+00045d80: 2054 7279 2070 6173 7369 6e67 206c 6172   Try passing lar
+00045d90: 6765 7220 606e 7061 7274 6974 696f 6e73  ger `npartitions
+00045da0: 6020 746f 2060 6865 6164 602e 220a 2020  ` to `head`.".  
+00045db0: 2020 2020 2020 290a 2020 2020 7265 7475        ).    retu
+00045dc0: 726e 2072 0a0a 0a64 6566 206d 6179 6265  rn r...def maybe
+00045dd0: 5f73 6869 6674 5f64 6976 6973 696f 6e73  _shift_divisions
+00045de0: 2864 662c 2070 6572 696f 6473 2c20 6672  (df, periods, fr
+00045df0: 6571 293a 0a20 2020 2022 2222 4d61 7962  eq):.    """Mayb
+00045e00: 6520 7368 6966 7420 6469 7669 7369 6f6e  e shift division
+00045e10: 7320 6279 2070 6572 696f 6473 206f 6620  s by periods of 
+00045e20: 7369 7a65 2066 7265 710a 0a20 2020 2055  size freq..    U
+00045e30: 7365 6420 746f 2073 6869 6674 2074 6865  sed to shift the
+00045e40: 2064 6976 6973 696f 6e73 2066 6f72 2074   divisions for t
+00045e50: 6865 2060 7368 6966 7460 206d 6574 686f  he `shift` metho
+00045e60: 642e 2049 6620 6672 6571 2069 736e 2774  d. If freq isn't
+00045e70: 2061 2066 6978 6564 0a20 2020 2073 697a   a fixed.    siz
+00045e80: 6520 286e 6f74 2061 6e63 686f 7265 6420  e (not anchored 
+00045e90: 6f72 2072 656c 6174 6976 6529 2c20 7468  or relative), th
+00045ea0: 656e 2074 6865 2064 6976 6973 696f 6e73  en the divisions
+00045eb0: 2061 7265 2073 6869 6674 6564 0a20 2020   are shifted.   
+00045ec0: 2061 7070 726f 7072 6961 7465 6c79 2e20   appropriately. 
+00045ed0: 4f74 6865 7277 6973 6520 7468 6520 6469  Otherwise the di
+00045ee0: 7669 7369 6f6e 7320 6172 6520 636c 6561  visions are clea
+00045ef0: 7265 642e 0a0a 2020 2020 5061 7261 6d65  red...    Parame
+00045f00: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+00045f10: 2d2d 2d0a 2020 2020 6466 203a 2064 642e  ---.    df : dd.
+00045f20: 4461 7461 4672 616d 652c 2064 642e 5365  DataFrame, dd.Se
+00045f30: 7269 6573 2c20 6f72 2064 642e 496e 6465  ries, or dd.Inde
+00045f40: 780a 2020 2020 7065 7269 6f64 7320 3a20  x.    periods : 
+00045f50: 696e 740a 2020 2020 2020 2020 5468 6520  int.        The 
+00045f60: 6e75 6d62 6572 206f 6620 7065 7269 6f64  number of period
+00045f70: 7320 746f 2073 6869 6674 2e0a 2020 2020  s to shift..    
+00045f80: 6672 6571 203a 2044 6174 654f 6666 7365  freq : DateOffse
+00045f90: 742c 2074 696d 6564 656c 7461 2c20 6f72  t, timedelta, or
+00045fa0: 2074 696d 6520 7275 6c65 2073 7472 696e   time rule strin
+00045fb0: 670a 2020 2020 2020 2020 5468 6520 6672  g.        The fr
+00045fc0: 6571 7565 6e63 7920 746f 2073 6869 6674  equency to shift
+00045fd0: 2062 792e 0a20 2020 2022 2222 0a20 2020   by..    """.   
+00045fe0: 2069 6620 6973 696e 7374 616e 6365 2866   if isinstance(f
+00045ff0: 7265 712c 2073 7472 293a 0a20 2020 2020  req, str):.     
+00046000: 2020 2066 7265 7120 3d20 7064 2e74 7365     freq = pd.tse
+00046010: 7269 6573 2e66 7265 7175 656e 6369 6573  ries.frequencies
+00046020: 2e74 6f5f 6f66 6673 6574 2866 7265 7129  .to_offset(freq)
+00046030: 0a0a 2020 2020 6973 5f6f 6666 7365 7420  ..    is_offset 
+00046040: 3d20 6973 696e 7374 616e 6365 2866 7265  = isinstance(fre
+00046050: 712c 2070 642e 4461 7465 4f66 6673 6574  q, pd.DateOffset
+00046060: 290a 2020 2020 6966 2069 735f 6f66 6673  ).    if is_offs
+00046070: 6574 3a0a 2020 2020 2020 2020 6966 2066  et:.        if f
+00046080: 7265 712e 6973 5f61 6e63 686f 7265 6428  req.is_anchored(
+00046090: 2920 6f72 206e 6f74 2068 6173 6174 7472  ) or not hasattr
+000460a0: 2866 7265 712c 2022 6465 6c74 6122 293a  (freq, "delta"):
+000460b0: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
+000460c0: 616e 2774 2069 6e66 6572 2064 6976 6973  an't infer divis
+000460d0: 696f 6e73 206f 6e20 7265 6c61 7469 7665  ions on relative
+000460e0: 206f 7220 616e 6368 6f72 6564 206f 6666   or anchored off
+000460f0: 7365 7473 2c20 6173 0a20 2020 2020 2020  sets, as.       
+00046100: 2020 2020 2023 2064 6976 6973 696f 6e73       # divisions
+00046110: 206d 6179 206e 6f77 2073 706c 6974 2069   may now split i
+00046120: 6465 6e74 6963 616c 2069 6e64 6578 2076  dentical index v
+00046130: 616c 7565 2e0a 2020 2020 2020 2020 2020  alue..          
+00046140: 2020 2320 2865 2e67 2e20 696e 6465 785f    # (e.g. index_
+00046150: 7061 7274 6974 696f 6e73 203d 205b 5b31  partitions = [[1
+00046160: 2c20 322c 2033 5d2c 205b 332c 2034 2c20  , 2, 3], [3, 4, 
+00046170: 355d 5d29 0a20 2020 2020 2020 2020 2020  5]]).           
+00046180: 2072 6574 7572 6e20 6466 2e63 6c65 6172   return df.clear
+00046190: 5f64 6976 6973 696f 6e73 2829 0a20 2020  _divisions().   
+000461a0: 2069 6620 6466 2e6b 6e6f 776e 5f64 6976   if df.known_div
+000461b0: 6973 696f 6e73 3a0a 2020 2020 2020 2020  isions:.        
+000461c0: 6469 7673 203d 2070 642e 5365 7269 6573  divs = pd.Series
+000461d0: 2872 616e 6765 286c 656e 2864 662e 6469  (range(len(df.di
+000461e0: 7669 7369 6f6e 7329 292c 2069 6e64 6578  visions)), index
+000461f0: 3d64 662e 6469 7669 7369 6f6e 7329 0a20  =df.divisions). 
+00046200: 2020 2020 2020 2064 6976 6973 696f 6e73         divisions
+00046210: 203d 2064 6976 732e 7368 6966 7428 7065   = divs.shift(pe
+00046220: 7269 6f64 732c 2066 7265 713d 6672 6571  riods, freq=freq
+00046230: 292e 696e 6465 780a 2020 2020 2020 2020  ).index.        
+00046240: 7265 7475 726e 2064 662e 5f5f 636c 6173  return df.__clas
+00046250: 735f 5f28 6466 2e64 6173 6b2c 2064 662e  s__(df.dask, df.
+00046260: 5f6e 616d 652c 2064 662e 5f6d 6574 612c  _name, df._meta,
+00046270: 2064 6976 6973 696f 6e73 290a 2020 2020   divisions).    
+00046280: 7265 7475 726e 2064 660a 0a0a 4077 7261  return df...@wra
+00046290: 7073 2870 642e 746f 5f64 6174 6574 696d  ps(pd.to_datetim
+000462a0: 6529 0a64 6566 2074 6f5f 6461 7465 7469  e).def to_dateti
+000462b0: 6d65 2861 7267 2c20 6d65 7461 3d4e 6f6e  me(arg, meta=Non
+000462c0: 652c 202a 2a6b 7761 7267 7329 3a0a 2020  e, **kwargs):.  
+000462d0: 2020 747a 5f6b 7761 7267 203d 207b 2274    tz_kwarg = {"t
+000462e0: 7a22 3a20 2275 7463 227d 2069 6620 6b77  z": "utc"} if kw
+000462f0: 6172 6773 2e67 6574 2822 7574 6322 2920  args.get("utc") 
+00046300: 656c 7365 207b 7d0a 2020 2020 6966 206d  else {}.    if m
+00046310: 6574 6120 6973 204e 6f6e 653a 0a20 2020  eta is None:.   
+00046320: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00046330: 6365 2861 7267 2c20 496e 6465 7829 3a0a  ce(arg, Index):.
+00046340: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+00046350: 203d 2067 6574 5f6d 6574 615f 6c69 6272   = get_meta_libr
+00046360: 6172 7928 6172 6729 2e44 6174 6574 696d  ary(arg).Datetim
+00046370: 6549 6e64 6578 285b 5d2c 202a 2a74 7a5f  eIndex([], **tz_
+00046380: 6b77 6172 6729 0a20 2020 2020 2020 2020  kwarg).         
+00046390: 2020 206d 6574 612e 6e61 6d65 203d 2061     meta.name = a
+000463a0: 7267 2e6e 616d 650a 2020 2020 2020 2020  rg.name.        
+000463b0: 656c 6966 206e 6f74 2028 6973 5f64 6174  elif not (is_dat
+000463c0: 6166 7261 6d65 5f6c 696b 6528 6172 6729  aframe_like(arg)
+000463d0: 206f 7220 6973 5f73 6572 6965 735f 6c69   or is_series_li
+000463e0: 6b65 2861 7267 2929 3a0a 2020 2020 2020  ke(arg)):.      
+000463f0: 2020 2020 2020 7261 6973 6520 4e6f 7449        raise NotI
+00046400: 6d70 6c65 6d65 6e74 6564 4572 726f 7228  mplementedError(
+00046410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00046420: 2022 6461 736b 2e64 6174 6166 7261 6d65   "dask.dataframe
+00046430: 2e74 6f5f 6461 7465 7469 6d65 2064 6f65  .to_datetime doe
+00046440: 7320 6e6f 7420 7375 7070 6f72 7420 220a  s not support ".
+00046450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046460: 226e 6f6e 2d69 6e64 6578 2d61 626c 6520  "non-index-able 
+00046470: 6172 6775 6d65 6e74 7320 286c 696b 6520  arguments (like 
+00046480: 7363 616c 6172 7329 220a 2020 2020 2020  scalars)".      
+00046490: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000464a0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000464b0: 2020 6d65 7461 203d 206d 6574 615f 7365    meta = meta_se
+000464c0: 7269 6573 5f63 6f6e 7374 7275 6374 6f72  ries_constructor
+000464d0: 2861 7267 2928 5b70 642e 5469 6d65 7374  (arg)([pd.Timest
+000464e0: 616d 7028 2232 3030 3022 2c20 2a2a 747a  amp("2000", **tz
+000464f0: 5f6b 7761 7267 295d 290a 2020 2020 2020  _kwarg)]).      
+00046500: 2020 2020 2020 6d65 7461 2e69 6e64 6578        meta.index
+00046510: 203d 206d 6574 612e 696e 6465 782e 6173   = meta.index.as
+00046520: 7479 7065 2861 7267 2e69 6e64 6578 2e64  type(arg.index.d
+00046530: 7479 7065 290a 2020 2020 2020 2020 2020  type).          
+00046540: 2020 6d65 7461 2e69 6e64 6578 2e6e 616d    meta.index.nam
+00046550: 6520 3d20 6172 672e 696e 6465 782e 6e61  e = arg.index.na
+00046560: 6d65 0a20 2020 2069 6620 5041 4e44 4153  me.    if PANDAS
+00046570: 5f47 545f 3230 3020 616e 6420 2269 6e66  _GT_200 and "inf
+00046580: 6572 5f64 6174 6574 696d 655f 666f 726d  er_datetime_form
+00046590: 6174 2220 696e 206b 7761 7267 733a 0a20  at" in kwargs:. 
+000465a0: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+000465b0: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
+000465c0: 2020 2254 6865 2061 7267 756d 656e 7420    "The argument 
+000465d0: 2769 6e66 6572 5f64 6174 6574 696d 655f  'infer_datetime_
+000465e0: 666f 726d 6174 2720 6973 2064 6570 7265  format' is depre
+000465f0: 6361 7465 6420 616e 6420 7769 6c6c 2062  cated and will b
+00046600: 6520 7265 6d6f 7665 6420 696e 2061 2066  e removed in a f
+00046610: 7574 7572 6520 7665 7273 696f 6e2e 2022  uture version. "
+00046620: 0a20 2020 2020 2020 2020 2020 2022 4120  .            "A 
+00046630: 7374 7269 6374 2076 6572 7369 6f6e 206f  strict version o
+00046640: 6620 6974 2069 7320 6e6f 7720 7468 6520  f it is now the 
+00046650: 6465 6661 756c 742c 2073 6565 2022 0a20  default, see ". 
+00046660: 2020 2020 2020 2020 2020 2022 6874 7470             "http
+00046670: 733a 2f2f 7061 6e64 6173 2e70 7964 6174  s://pandas.pydat
+00046680: 612e 6f72 672f 7064 6570 732f 3030 3034  a.org/pdeps/0004
+00046690: 2d63 6f6e 7369 7374 656e 742d 746f 2d64  -consistent-to-d
+000466a0: 6174 6574 696d 652d 7061 7273 696e 672e  atetime-parsing.
+000466b0: 6874 6d6c 2e20 220a 2020 2020 2020 2020  html. ".        
+000466c0: 2020 2020 2259 6f75 2063 616e 2073 6166      "You can saf
+000466d0: 656c 7920 7265 6d6f 7665 2074 6869 7320  ely remove this 
+000466e0: 6172 6775 6d65 6e74 2e22 2c0a 2020 2020  argument.",.    
+000466f0: 2020 2020 2020 2020 5573 6572 5761 726e          UserWarn
+00046700: 696e 672c 0a20 2020 2020 2020 2029 0a20  ing,.        ). 
+00046710: 2020 2020 2020 206b 7761 7267 732e 706f         kwargs.po
+00046720: 7028 2269 6e66 6572 5f64 6174 6574 696d  p("infer_datetim
+00046730: 655f 666f 726d 6174 2229 0a0a 2020 2020  e_format")..    
+00046740: 7265 7475 726e 206d 6170 5f70 6172 7469  return map_parti
+00046750: 7469 6f6e 7328 6765 745f 6d65 7461 5f6c  tions(get_meta_l
+00046760: 6962 7261 7279 2861 7267 292e 746f 5f64  ibrary(arg).to_d
+00046770: 6174 6574 696d 652c 2061 7267 2c20 6d65  atetime, arg, me
+00046780: 7461 3d6d 6574 612c 202a 2a6b 7761 7267  ta=meta, **kwarg
+00046790: 7329 0a0a 0a40 7772 6170 7328 7064 2e74  s)...@wraps(pd.t
+000467a0: 6f5f 7469 6d65 6465 6c74 6129 0a64 6566  o_timedelta).def
+000467b0: 2074 6f5f 7469 6d65 6465 6c74 6128 6172   to_timedelta(ar
+000467c0: 672c 2075 6e69 743d 4e6f 6e65 2c20 6572  g, unit=None, er
+000467d0: 726f 7273 3d22 7261 6973 6522 293a 0a20  rors="raise"):. 
+000467e0: 2020 206d 6574 6120 3d20 6d65 7461 5f73     meta = meta_s
+000467f0: 6572 6965 735f 636f 6e73 7472 7563 746f  eries_constructo
+00046800: 7228 6172 6729 285b 7064 2e54 696d 6564  r(arg)([pd.Timed
+00046810: 656c 7461 2831 2c20 756e 6974 3d75 6e69  elta(1, unit=uni
+00046820: 7429 5d29 0a20 2020 2072 6574 7572 6e20  t)]).    return 
+00046830: 6d61 705f 7061 7274 6974 696f 6e73 2870  map_partitions(p
+00046840: 642e 746f 5f74 696d 6564 656c 7461 2c20  d.to_timedelta, 
+00046850: 6172 672c 2075 6e69 743d 756e 6974 2c20  arg, unit=unit, 
+00046860: 6572 726f 7273 3d65 7272 6f72 732c 206d  errors=errors, m
+00046870: 6574 613d 6d65 7461 290a 0a0a 6966 2068  eta=meta)...if h
+00046880: 6173 6174 7472 2870 642c 2022 6973 6e61  asattr(pd, "isna
+00046890: 2229 3a0a 0a20 2020 2040 7772 6170 7328  "):..    @wraps(
+000468a0: 7064 2e69 736e 6129 0a20 2020 2064 6566  pd.isna).    def
+000468b0: 2069 736e 6128 6172 6729 3a0a 2020 2020   isna(arg):.    
+000468c0: 2020 2020 7265 7475 726e 206d 6170 5f70      return map_p
+000468d0: 6172 7469 7469 6f6e 7328 7064 2e69 736e  artitions(pd.isn
+000468e0: 612c 2061 7267 290a 0a0a 6465 6620 5f72  a, arg)...def _r
+000468f0: 6570 725f 6461 7461 5f73 6572 6965 7328  epr_data_series(
+00046900: 732c 2069 6e64 6578 293a 0a20 2020 2022  s, index):.    "
+00046910: 2222 4120 6865 6c70 6572 2066 6f72 2063  ""A helper for c
+00046920: 7265 6174 696e 6720 7468 6520 6060 5f72  reating the ``_r
+00046930: 6570 725f 6461 7461 6060 2070 726f 7065  epr_data`` prope
+00046940: 7274 7922 2222 0a20 2020 206e 7061 7274  rty""".    npart
+00046950: 6974 696f 6e73 203d 206c 656e 2869 6e64  itions = len(ind
+00046960: 6578 2920 2d20 310a 2020 2020 6966 2069  ex) - 1.    if i
+00046970: 7369 6e73 7461 6e63 6528 732e 6474 7970  sinstance(s.dtyp
+00046980: 652c 2070 642e 4361 7465 676f 7269 6361  e, pd.Categorica
+00046990: 6c44 7479 7065 293a 0a20 2020 2020 2020  lDtype):.       
+000469a0: 2069 6620 6861 735f 6b6e 6f77 6e5f 6361   if has_known_ca
+000469b0: 7465 676f 7269 6573 2873 293a 0a20 2020  tegories(s):.   
+000469c0: 2020 2020 2020 2020 2064 7479 7065 203d           dtype =
+000469d0: 2022 6361 7465 676f 7279 5b6b 6e6f 776e   "category[known
+000469e0: 5d22 0a20 2020 2020 2020 2065 6c73 653a  ]".        else:
+000469f0: 0a20 2020 2020 2020 2020 2020 2064 7479  .            dty
+00046a00: 7065 203d 2022 6361 7465 676f 7279 5b75  pe = "category[u
+00046a10: 6e6b 6e6f 776e 5d22 0a20 2020 2065 6c73  nknown]".    els
+00046a20: 653a 0a20 2020 2020 2020 2064 7479 7065  e:.        dtype
+00046a30: 203d 2073 7472 2873 2e64 7479 7065 290a   = str(s.dtype).
+00046a40: 2020 2020 7265 7475 726e 2070 642e 5365      return pd.Se
+00046a50: 7269 6573 285b 6474 7970 655d 202b 205b  ries([dtype] + [
+00046a60: 222e 2e2e 225d 202a 206e 7061 7274 6974  "..."] * npartit
+00046a70: 696f 6e73 2c20 696e 6465 783d 696e 6465  ions, index=inde
+00046a80: 782c 206e 616d 653d 732e 6e61 6d65 290a  x, name=s.name).
+00046a90: 0a0a 6465 6620 6861 735f 7061 7261 6c6c  ..def has_parall
+00046aa0: 656c 5f74 7970 6528 7829 3a0a 2020 2020  el_type(x):.    
+00046ab0: 2222 2244 6f65 7320 7468 6973 206f 626a  """Does this obj
+00046ac0: 6563 7420 6861 7665 2061 2064 6173 6b20  ect have a dask 
+00046ad0: 6461 7461 6672 616d 6520 6571 7569 7661  dataframe equiva
+00046ae0: 6c65 6e74 3f22 2222 0a20 2020 2072 6574  lent?""".    ret
+00046af0: 7572 6e20 6765 745f 7061 7261 6c6c 656c  urn get_parallel
+00046b00: 5f74 7970 6528 7829 2069 7320 6e6f 7420  _type(x) is not 
+00046b10: 5363 616c 6172 0a0a 0a64 6566 206e 6577  Scalar...def new
+00046b20: 5f64 645f 6f62 6a65 6374 2864 736b 2c20  _dd_object(dsk, 
+00046b30: 6e61 6d65 2c20 6d65 7461 2c20 6469 7669  name, meta, divi
+00046b40: 7369 6f6e 732c 2070 6172 656e 745f 6d65  sions, parent_me
+00046b50: 7461 3d4e 6f6e 6529 3a0a 2020 2020 2222  ta=None):.    ""
+00046b60: 2247 656e 6572 6963 2063 6f6e 7374 7275  "Generic constru
+00046b70: 6374 6f72 2066 6f72 2064 6173 6b2e 6461  ctor for dask.da
+00046b80: 7461 6672 616d 6520 6f62 6a65 6374 732e  taframe objects.
+00046b90: 0a0a 2020 2020 4465 6369 6465 7320 7468  ..    Decides th
+00046ba0: 6520 6170 7072 6f70 7269 6174 6520 6f75  e appropriate ou
+00046bb0: 7470 7574 2063 6c61 7373 2062 6173 6564  tput class based
+00046bc0: 206f 6e20 7468 6520 7479 7065 206f 6620   on the type of 
+00046bd0: 606d 6574 6160 2070 726f 7669 6465 642e  `meta` provided.
+00046be0: 0a20 2020 2022 2222 0a20 2020 2069 6620  .    """.    if 
+00046bf0: 6861 735f 7061 7261 6c6c 656c 5f74 7970  has_parallel_typ
+00046c00: 6528 6d65 7461 293a 0a20 2020 2020 2020  e(meta):.       
+00046c10: 2072 6574 7572 6e20 6765 745f 7061 7261   return get_para
+00046c20: 6c6c 656c 5f74 7970 6528 6d65 7461 2928  llel_type(meta)(
+00046c30: 6473 6b2c 206e 616d 652c 206d 6574 612c  dsk, name, meta,
+00046c40: 2064 6976 6973 696f 6e73 290a 2020 2020   divisions).    
+00046c50: 656c 6966 2069 735f 6172 7261 796c 696b  elif is_arraylik
+00046c60: 6528 6d65 7461 2920 616e 6420 6d65 7461  e(meta) and meta
+00046c70: 2e73 6861 7065 3a0a 2020 2020 2020 2020  .shape:.        
+00046c80: 696d 706f 7274 2064 6173 6b2e 6172 7261  import dask.arra
+00046c90: 7920 6173 2064 610a 0a20 2020 2020 2020  y as da..       
+00046ca0: 2063 6875 6e6b 7320 3d20 2828 6e70 2e6e   chunks = ((np.n
+00046cb0: 616e 2c29 202a 2028 6c65 6e28 6469 7669  an,) * (len(divi
+00046cc0: 7369 6f6e 7329 202d 2031 292c 2920 2b20  sions) - 1),) + 
+00046cd0: 7475 706c 6528 0a20 2020 2020 2020 2020  tuple(.         
+00046ce0: 2020 2028 642c 2920 666f 7220 6420 696e     (d,) for d in
+00046cf0: 206d 6574 612e 7368 6170 655b 313a 5d0a   meta.shape[1:].
+00046d00: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00046d10: 2020 6966 206c 656e 2863 6875 6e6b 7329    if len(chunks)
+00046d20: 203e 2031 3a0a 2020 2020 2020 2020 2020   > 1:.          
+00046d30: 2020 6c61 7965 7220 3d20 6473 6b2e 6c61    layer = dsk.la
+00046d40: 7965 7273 5b6e 616d 655d 0a20 2020 2020  yers[name].     
+00046d50: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00046d60: 616e 6365 286c 6179 6572 2c20 426c 6f63  ance(layer, Bloc
+00046d70: 6b77 6973 6529 3a0a 2020 2020 2020 2020  kwise):.        
+00046d80: 2020 2020 2020 2020 6c61 7965 722e 6e65          layer.ne
+00046d90: 775f 6178 6573 5b22 6a22 5d20 3d20 6368  w_axes["j"] = ch
+00046da0: 756e 6b73 5b31 5d5b 305d 0a20 2020 2020  unks[1][0].     
+00046db0: 2020 2020 2020 2020 2020 206c 6179 6572             layer
+00046dc0: 2e6f 7574 7075 745f 696e 6469 6365 7320  .output_indices 
+00046dd0: 3d20 6c61 7965 722e 6f75 7470 7574 5f69  = layer.output_i
+00046de0: 6e64 6963 6573 202b 2028 226a 222c 290a  ndices + ("j",).
+00046df0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00046e00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00046e10: 2020 7375 6666 6978 203d 2028 302c 2920    suffix = (0,) 
+00046e20: 2a20 286c 656e 2863 6875 6e6b 7329 202d  * (len(chunks) -
+00046e30: 2031 290a 2020 2020 2020 2020 2020 2020   1).            
+00046e40: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00046e50: 6765 286c 656e 2863 6875 6e6b 735b 305d  ge(len(chunks[0]
+00046e60: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+00046e70: 2020 2020 2020 2020 6c61 7965 725b 286e          layer[(n
+00046e80: 616d 652c 2069 2920 2b20 7375 6666 6978  ame, i) + suffix
+00046e90: 5d20 3d20 6c61 7965 722e 706f 7028 286e  ] = layer.pop((n
+00046ea0: 616d 652c 2069 2929 0a20 2020 2020 2020  ame, i)).       
+00046eb0: 2072 6574 7572 6e20 6461 2e41 7272 6179   return da.Array
+00046ec0: 2864 736b 2c20 6e61 6d65 3d6e 616d 652c  (dsk, name=name,
+00046ed0: 2063 6875 6e6b 733d 6368 756e 6b73 2c20   chunks=chunks, 
+00046ee0: 6474 7970 653d 6d65 7461 2e64 7479 7065  dtype=meta.dtype
+00046ef0: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+00046f00: 2020 2020 7265 7475 726e 2067 6574 5f70      return get_p
+00046f10: 6172 616c 6c65 6c5f 7479 7065 286d 6574  arallel_type(met
+00046f20: 6129 2864 736b 2c20 6e61 6d65 2c20 6d65  a)(dsk, name, me
+00046f30: 7461 2c20 6469 7669 7369 6f6e 7329 0a0a  ta, divisions)..
+00046f40: 0a64 6566 2070 6172 7469 7469 6f6e 7769  .def partitionwi
+00046f50: 7365 5f67 7261 7068 2866 756e 632c 206c  se_graph(func, l
+00046f60: 6179 6572 5f6e 616d 652c 202a 6172 6773  ayer_name, *args
+00046f70: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
+00046f80: 2022 2222 0a20 2020 2041 7070 6c79 2061   """.    Apply a
+00046f90: 2066 756e 6374 696f 6e20 7061 7274 6974   function partit
+00046fa0: 696f 6e2d 7769 7365 2061 6372 6f73 7320  ion-wise across 
+00046fb0: 6172 6775 6d65 6e74 7320 746f 2063 7265  arguments to cre
+00046fc0: 6174 6520 6c61 7965 7220 6f66 2061 2067  ate layer of a g
+00046fd0: 7261 7068 0a0a 2020 2020 5468 6973 2061  raph..    This a
+00046fe0: 7070 6c69 6573 2061 2066 756e 6374 696f  pplies a functio
+00046ff0: 6e2c 2060 6066 756e 6360 602c 2069 6e20  n, ``func``, in 
+00047000: 616e 2065 6d62 6172 7261 7373 696e 676c  an embarrassingl
+00047010: 7920 7061 7261 6c6c 656c 2066 6173 6869  y parallel fashi
+00047020: 6f6e 0a20 2020 2061 6372 6f73 7320 7061  on.    across pa
+00047030: 7274 6974 696f 6e73 2f63 6875 6e6b 7320  rtitions/chunks 
+00047040: 696e 2074 6865 2070 726f 7669 6465 6420  in the provided 
+00047050: 6172 6775 6d65 6e74 732e 2020 4974 2068  arguments.  It h
+00047060: 616e 646c 6573 2044 6174 6166 7261 6d65  andles Dataframe
+00047070: 732c 0a20 2020 2041 7272 6179 732c 2061  s,.    Arrays, a
+00047080: 6e64 2073 6361 6c61 7273 2073 6d6f 6f74  nd scalars smoot
+00047090: 686c 792c 2061 6e64 2072 656c 6965 7320  hly, and relies 
+000470a0: 6f6e 2074 6865 2060 6062 6c6f 636b 7769  on the ``blockwi
+000470b0: 7365 6060 206d 6163 6869 6e65 7279 0a20  se`` machinery. 
+000470c0: 2020 2074 6f20 7072 6f76 6964 6520 6120     to provide a 
+000470d0: 6e69 6365 6c79 2073 796d 626f 6c69 6320  nicely symbolic 
+000470e0: 6772 6170 682e 0a0a 2020 2020 4974 2069  graph...    It i
+000470f0: 7320 6d6f 7374 2063 6f6d 6d6f 6e6c 7920  s most commonly 
+00047100: 7573 6564 2069 6e20 6f74 6865 7220 6772  used in other gr
+00047110: 6170 682d 6275 696c 6469 6e67 2066 756e  aph-building fun
+00047120: 6374 696f 6e73 2074 6f20 6372 6561 7465  ctions to create
+00047130: 2074 6865 0a20 2020 2061 7070 726f 7072   the.    appropr
+00047140: 6961 7465 206c 6179 6572 206f 6620 7468  iate layer of th
+00047150: 6520 7265 7375 6c74 696e 6720 6461 7461  e resulting data
+00047160: 6672 616d 652e 0a0a 2020 2020 5061 7261  frame...    Para
+00047170: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
+00047180: 2d2d 2d2d 2d0a 2020 2020 6675 6e63 3a20  -----.    func: 
+00047190: 6361 6c6c 6162 6c65 0a20 2020 206c 6179  callable.    lay
+000471a0: 6572 5f6e 616d 653a 2073 7472 0a20 2020  er_name: str.   
+000471b0: 2020 2020 2044 6573 6372 6970 7469 7665       Descriptive
+000471c0: 206e 616d 6520 666f 7220 7468 6520 6f70   name for the op
+000471d0: 6572 6174 696f 6e2e 2055 7365 6420 6173  eration. Used as
+000471e0: 2074 6865 206f 7574 7075 7420 6e61 6d65   the output name
+000471f0: 0a20 2020 2020 2020 2069 6e20 7468 6520  .        in the 
+00047200: 7265 7375 6c74 696e 6720 6060 426c 6f63  resulting ``Bloc
+00047210: 6b77 6973 6560 6020 6772 6170 6820 6c61  kwise`` graph la
+00047220: 7965 722e 0a20 2020 202a 6172 6773 3a0a  yer..    *args:.
+00047230: 2020 2020 2a2a 6b77 6172 6773 3a0a 0a20      **kwargs:.. 
+00047240: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
+00047250: 2d2d 2d2d 2d2d 0a20 2020 206f 7574 3a20  ------.    out: 
+00047260: 426c 6f63 6b77 6973 6520 6772 6170 680a  Blockwise graph.
+00047270: 0a20 2020 2045 7861 6d70 6c65 730a 2020  .    Examples.  
+00047280: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e    --------.    >
+00047290: 3e3e 2073 7562 6772 6170 6820 3d20 7061  >> subgraph = pa
+000472a0: 7274 6974 696f 6e77 6973 655f 6772 6170  rtitionwise_grap
+000472b0: 6828 6675 6e63 7469 6f6e 2c20 782c 2079  h(function, x, y
+000472c0: 2c20 7a3d 3132 3329 2020 2320 646f 6374  , z=123)  # doct
 000472d0: 6573 743a 202b 534b 4950 0a20 2020 203e  est: +SKIP.    >
-000472e0: 3e3e 2072 6573 756c 7420 3d20 6e65 775f  >> result = new_
-000472f0: 6464 5f6f 626a 6563 7428 6772 6170 682c  dd_object(graph,
-00047300: 206e 616d 652c 206d 6574 6164 6174 612c   name, metadata,
-00047310: 2064 662e 6469 7669 7369 6f6e 7329 2020   df.divisions)  
-00047320: 2320 646f 6374 6573 743a 202b 534b 4950  # doctest: +SKIP
-00047330: 0a0a 2020 2020 5365 6520 416c 736f 0a20  ..    See Also. 
-00047340: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00047350: 6d61 705f 7061 7274 6974 696f 6e73 0a20  map_partitions. 
-00047360: 2020 2022 2222 0a20 2020 2070 6169 7273     """.    pairs
-00047370: 203d 205b 5d0a 2020 2020 6e75 6d62 6c6f   = [].    numblo
-00047380: 636b 7320 3d20 7b7d 0a20 2020 2066 6f72  cks = {}.    for
-00047390: 2061 7267 2069 6e20 6172 6773 3a0a 2020   arg in args:.  
-000473a0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-000473b0: 6e63 6528 6172 672c 205f 4672 616d 6529  nce(arg, _Frame)
-000473c0: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
-000473d0: 6972 732e 6578 7465 6e64 285b 6172 672e  irs.extend([arg.
-000473e0: 5f6e 616d 652c 2022 6922 5d29 0a20 2020  _name, "i"]).   
-000473f0: 2020 2020 2020 2020 206e 756d 626c 6f63           numbloc
-00047400: 6b73 5b61 7267 2e5f 6e61 6d65 5d20 3d20  ks[arg._name] = 
-00047410: 2861 7267 2e6e 7061 7274 6974 696f 6e73  (arg.npartitions
-00047420: 2c29 0a20 2020 2020 2020 2065 6c69 6620  ,).        elif 
-00047430: 6973 696e 7374 616e 6365 2861 7267 2c20  isinstance(arg, 
-00047440: 5363 616c 6172 293a 0a20 2020 2020 2020  Scalar):.       
-00047450: 2020 2020 2070 6169 7273 2e65 7874 656e       pairs.exten
-00047460: 6428 5b61 7267 2e5f 6e61 6d65 2c20 2269  d([arg._name, "i
-00047470: 225d 290a 2020 2020 2020 2020 2020 2020  "]).            
-00047480: 6e75 6d62 6c6f 636b 735b 6172 672e 5f6e  numblocks[arg._n
-00047490: 616d 655d 203d 2028 312c 290a 2020 2020  ame] = (1,).    
-000474a0: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-000474b0: 6e63 6528 6172 672c 2041 7272 6179 293a  nce(arg, Array):
-000474c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000474d0: 6172 672e 6e64 696d 203d 3d20 313a 0a20  arg.ndim == 1:. 
-000474e0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000474f0: 6169 7273 2e65 7874 656e 6428 5b61 7267  airs.extend([arg
-00047500: 2e6e 616d 652c 2022 6922 5d29 0a20 2020  .name, "i"]).   
-00047510: 2020 2020 2020 2020 2065 6c69 6620 6172           elif ar
-00047520: 672e 6e64 696d 203d 3d20 303a 0a20 2020  g.ndim == 0:.   
-00047530: 2020 2020 2020 2020 2020 2020 2070 6169               pai
-00047540: 7273 2e65 7874 656e 6428 5b61 7267 2e6e  rs.extend([arg.n
-00047550: 616d 652c 2022 225d 290a 2020 2020 2020  ame, ""]).      
-00047560: 2020 2020 2020 656c 6966 2061 7267 2e6e        elif arg.n
-00047570: 6469 6d20 3d3d 2032 3a0a 2020 2020 2020  dim == 2:.      
-00047580: 2020 2020 2020 2020 2020 7061 6972 732e            pairs.
-00047590: 6578 7465 6e64 285b 6172 672e 6e61 6d65  extend([arg.name
-000475a0: 2c20 2269 6a22 5d29 0a20 2020 2020 2020  , "ij"]).       
-000475b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000475c0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000475d0: 2056 616c 7565 4572 726f 7228 2243 616e   ValueError("Can
-000475e0: 2774 2061 6464 206d 756c 7469 2d64 696d  't add multi-dim
-000475f0: 656e 7369 6f6e 616c 2061 7272 6179 2074  ensional array t
-00047600: 6f20 6461 7461 6672 616d 6573 2229 0a20  o dataframes"). 
-00047610: 2020 2020 2020 2020 2020 206e 756d 626c             numbl
-00047620: 6f63 6b73 5b61 7267 2e5f 6e61 6d65 5d20  ocks[arg._name] 
-00047630: 3d20 6172 672e 6e75 6d62 6c6f 636b 730a  = arg.numblocks.
-00047640: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-00047650: 6e73 7461 6e63 6528 6172 672c 2042 6c6f  nstance(arg, Blo
-00047660: 636b 7769 7365 4465 7029 3a0a 2020 2020  ckwiseDep):.    
-00047670: 2020 2020 2020 2020 6966 206c 656e 2861          if len(a
-00047680: 7267 2e6e 756d 626c 6f63 6b73 2920 3d3d  rg.numblocks) ==
-00047690: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-000476a0: 2020 2020 7061 6972 732e 6578 7465 6e64      pairs.extend
-000476b0: 285b 6172 672c 2022 6922 5d29 0a20 2020  ([arg, "i"]).   
-000476c0: 2020 2020 2020 2020 2065 6c69 6620 6c65           elif le
-000476d0: 6e28 6172 672e 6e75 6d62 6c6f 636b 7329  n(arg.numblocks)
-000476e0: 203d 3d20 323a 0a20 2020 2020 2020 2020   == 2:.         
-000476f0: 2020 2020 2020 2070 6169 7273 2e65 7874         pairs.ext
-00047700: 656e 6428 5b61 7267 2c20 2269 6a22 5d29  end([arg, "ij"])
-00047710: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00047720: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00047730: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00047740: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00047750: 2020 2020 2020 2020 2066 2242 6c6f 636b           f"Block
-00047760: 7769 7365 4465 7020 6172 6720 7b61 7267  wiseDep arg {arg
-00047770: 2172 7d20 6861 7320 7b6c 656e 2861 7267  !r} has {len(arg
-00047780: 2e6e 756d 626c 6f63 6b73 297d 2064 696d  .numblocks)} dim
-00047790: 656e 7369 6f6e 733b 206f 6e6c 7920 3120  ensions; only 1 
-000477a0: 6f72 2032 2061 7265 2073 7570 706f 7274  or 2 are support
-000477b0: 6564 2e22 0a20 2020 2020 2020 2020 2020  ed.".           
-000477c0: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
-000477d0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000477e0: 2070 6169 7273 2e65 7874 656e 6428 5b61   pairs.extend([a
-000477f0: 7267 2c20 4e6f 6e65 5d29 0a20 2020 2072  rg, None]).    r
-00047800: 6574 7572 6e20 626c 6f63 6b77 6973 6528  eturn blockwise(
-00047810: 0a20 2020 2020 2020 2066 756e 632c 206c  .        func, l
-00047820: 6179 6572 5f6e 616d 652c 2022 6922 2c20  ayer_name, "i", 
-00047830: 2a70 6169 7273 2c20 6e75 6d62 6c6f 636b  *pairs, numblock
-00047840: 733d 6e75 6d62 6c6f 636b 732c 2063 6f6e  s=numblocks, con
-00047850: 6361 7465 6e61 7465 3d54 7275 652c 202a  catenate=True, *
-00047860: 2a6b 7761 7267 730a 2020 2020 290a 0a0a  *kwargs.    )...
-00047870: 6465 6620 6d65 7461 5f77 6172 6e69 6e67  def meta_warning
-00047880: 2864 6629 3a0a 2020 2020 2222 220a 2020  (df):.    """.  
-00047890: 2020 5072 6f76 6964 6520 616e 2069 6e66    Provide an inf
-000478a0: 6f72 6d61 7469 7665 206d 6573 7361 6765  ormative message
-000478b0: 2077 6865 6e20 7468 6520 7573 6572 2069   when the user i
-000478c0: 7320 6173 6b65 6420 746f 2070 726f 7669  s asked to provi
-000478d0: 6465 206d 6574 6164 6174 610a 2020 2020  de metadata.    
-000478e0: 2222 220a 2020 2020 6966 2069 735f 6461  """.    if is_da
-000478f0: 7461 6672 616d 655f 6c69 6b65 2864 6629  taframe_like(df)
-00047900: 3a0a 2020 2020 2020 2020 6d65 7461 5f73  :.        meta_s
-00047910: 7472 203d 207b 6b3a 2073 7472 2876 2920  tr = {k: str(v) 
-00047920: 666f 7220 6b2c 2076 2069 6e20 6466 2e64  for k, v in df.d
-00047930: 7479 7065 732e 746f 5f64 6963 7428 292e  types.to_dict().
-00047940: 6974 656d 7328 297d 0a20 2020 2065 6c69  items()}.    eli
-00047950: 6620 6973 5f73 6572 6965 735f 6c69 6b65  f is_series_like
-00047960: 2864 6629 3a0a 2020 2020 2020 2020 6d65  (df):.        me
-00047970: 7461 5f73 7472 203d 2028 6466 2e6e 616d  ta_str = (df.nam
-00047980: 652c 2073 7472 2864 662e 6474 7970 6529  e, str(df.dtype)
-00047990: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
-000479a0: 2020 2020 6d65 7461 5f73 7472 203d 204e      meta_str = N
-000479b0: 6f6e 650a 2020 2020 6d73 6720 3d20 280a  one.    msg = (.
-000479c0: 2020 2020 2020 2020 225c 6e59 6f75 2064          "\nYou d
-000479d0: 6964 206e 6f74 2070 726f 7669 6465 206d  id not provide m
-000479e0: 6574 6164 6174 612c 2073 6f20 4461 736b  etadata, so Dask
-000479f0: 2069 7320 7275 6e6e 696e 6720 796f 7572   is running your
-00047a00: 2022 0a20 2020 2020 2020 2022 6675 6e63   ".        "func
-00047a10: 7469 6f6e 206f 6e20 6120 736d 616c 6c20  tion on a small 
-00047a20: 6461 7461 7365 7420 746f 2067 7565 7373  dataset to guess
-00047a30: 206f 7574 7075 7420 7479 7065 732e 2022   output types. "
-00047a40: 0a20 2020 2020 2020 2022 4974 2069 7320  .        "It is 
-00047a50: 706f 7373 6962 6c65 2074 6861 7420 4461  possible that Da
-00047a60: 736b 2077 696c 6c20 6775 6573 7320 696e  sk will guess in
-00047a70: 636f 7272 6563 746c 792e 5c6e 220a 2020  correctly.\n".  
-00047a80: 2020 2020 2020 2254 6f20 7072 6f76 6964        "To provid
-00047a90: 6520 616e 2065 7870 6c69 6369 7420 6f75  e an explicit ou
-00047aa0: 7470 7574 2074 7970 6573 206f 7220 746f  tput types or to
-00047ab0: 2073 696c 656e 6365 2074 6869 7320 6d65   silence this me
-00047ac0: 7373 6167 652c 2022 0a20 2020 2020 2020  ssage, ".       
-00047ad0: 2022 706c 6561 7365 2070 726f 7669 6465   "please provide
-00047ae0: 2074 6865 2060 6d65 7461 3d60 206b 6579   the `meta=` key
-00047af0: 776f 7264 2c20 6173 2064 6573 6372 6962  word, as describ
-00047b00: 6564 2069 6e20 7468 6520 6d61 7020 6f72  ed in the map or
-00047b10: 2022 0a20 2020 2020 2020 2022 6170 706c   ".        "appl
-00047b20: 7920 6675 6e63 7469 6f6e 2074 6861 7420  y function that 
-00047b30: 796f 7520 6172 6520 7573 696e 672e 220a  you are using.".
-00047b40: 2020 2020 290a 2020 2020 6966 206d 6574      ).    if met
-00047b50: 615f 7374 723a 0a20 2020 2020 2020 206d  a_str:.        m
-00047b60: 7367 202b 3d20 280a 2020 2020 2020 2020  sg += (.        
-00047b70: 2020 2020 225c 6e22 0a20 2020 2020 2020      "\n".       
-00047b80: 2020 2020 2022 2020 4265 666f 7265 3a20       "  Before: 
-00047b90: 2e61 7070 6c79 2866 756e 6329 5c6e 220a  .apply(func)\n".
-00047ba0: 2020 2020 2020 2020 2020 2020 2220 2041              "  A
-00047bb0: 6674 6572 3a20 202e 6170 706c 7928 6675  fter:  .apply(fu
-00047bc0: 6e63 2c20 6d65 7461 3d25 7329 5c6e 2220  nc, meta=%s)\n" 
-00047bd0: 2520 7374 7228 6d65 7461 5f73 7472 290a  % str(meta_str).
-00047be0: 2020 2020 2020 2020 290a 2020 2020 7265          ).    re
-00047bf0: 7475 726e 206d 7367 0a0a 0a64 6566 2070  turn msg...def p
-00047c00: 7265 6669 785f 7265 6475 6374 696f 6e28  refix_reduction(
-00047c10: 662c 2064 6466 2c20 6964 656e 7469 7479  f, ddf, identity
-00047c20: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00047c30: 2022 2222 436f 6d70 7574 6573 2074 6865   """Computes the
-00047c40: 2070 7265 6669 7820 7375 6d73 206f 6620   prefix sums of 
-00047c50: 6620 6f6e 2064 660a 0a20 2020 2049 6620  f on df..    If 
-00047c60: 6466 2068 6173 2070 6172 7469 7469 6f6e  df has partition
-00047c70: 7320 5b50 312c 2050 322c 202e 2e2e 2c20  s [P1, P2, ..., 
-00047c80: 506e 5d2c 2074 6865 6e20 7265 7475 726e  Pn], then return
-00047c90: 7320 7468 6520 4461 7461 4672 616d 6520  s the DataFrame 
-00047ca0: 7769 7468 0a20 2020 2070 6172 7469 7469  with.    partiti
-00047cb0: 6f6e 7320 5b66 2869 6465 6e74 6974 792c  ons [f(identity,
-00047cc0: 2050 3129 2c0a 2020 2020 2020 2020 2020   P1),.          
-00047cd0: 2020 2020 2020 6628 6628 6964 656e 7469        f(f(identi
-00047ce0: 7479 2c20 5031 292c 2050 3229 2c0a 2020  ty, P1), P2),.  
-00047cf0: 2020 2020 2020 2020 2020 2020 2020 6628                f(
-00047d00: 6628 6628 6964 656e 7469 7479 2c20 5031  f(f(identity, P1
-00047d10: 292c 2050 3229 2c20 5033 292c 0a20 2020  ), P2), P3),.   
-00047d20: 2020 2020 2020 2020 2020 2020 202e 2e2e               ...
-00047d30: 5d0a 0a20 2020 2050 6172 616d 6574 6572  ]..    Parameter
-00047d40: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-00047d50: 0a20 2020 2066 203a 2063 616c 6c61 626c  .    f : callabl
-00047d60: 650a 2020 2020 2020 2020 616e 2061 7373  e.        an ass
-00047d70: 6f63 6961 7469 7665 2066 756e 6374 696f  ociative functio
-00047d80: 6e20 660a 2020 2020 6464 6620 3a20 6464  n f.    ddf : dd
-00047d90: 2e44 6174 6146 7261 6d65 0a20 2020 2069  .DataFrame.    i
-00047da0: 6465 6e74 6974 7920 3a20 7064 2e44 6174  dentity : pd.Dat
-00047db0: 6146 7261 6d65 0a20 2020 2020 2020 2061  aFrame.        a
-00047dc0: 6e20 6964 656e 7469 7479 2065 6c65 6d65  n identity eleme
-00047dd0: 6e74 206f 6620 662c 2074 6861 7420 6973  nt of f, that is
-00047de0: 2066 2869 6465 6e74 6974 792c 2064 6629   f(identity, df)
-00047df0: 203d 2066 2864 662c 2069 6465 6e74 6974   = f(df, identit
-00047e00: 7929 203d 2064 660a 2020 2020 2222 220a  y) = df.    """.
-00047e10: 2020 2020 6473 6b20 3d20 6469 6374 2829      dsk = dict()
-00047e20: 0a20 2020 206e 616d 6520 3d20 2270 7265  .    name = "pre
-00047e30: 6669 785f 7265 6475 6374 696f 6e2d 2220  fix_reduction-" 
-00047e40: 2b20 746f 6b65 6e69 7a65 2866 2c20 6464  + tokenize(f, dd
-00047e50: 662c 2069 6465 6e74 6974 792c 202a 2a6b  f, identity, **k
-00047e60: 7761 7267 7329 0a20 2020 206d 6574 6120  wargs).    meta 
-00047e70: 3d20 6464 662e 5f6d 6574 610a 2020 2020  = ddf._meta.    
-00047e80: 6e20 3d20 6c65 6e28 6464 662e 6469 7669  n = len(ddf.divi
-00047e90: 7369 6f6e 7329 202d 2031 0a20 2020 2064  sions) - 1.    d
-00047ea0: 6976 6973 696f 6e73 203d 205b 4e6f 6e65  ivisions = [None
-00047eb0: 5d20 2a20 286e 202b 2031 290a 0a20 2020  ] * (n + 1)..   
-00047ec0: 204e 203d 2031 0a20 2020 2077 6869 6c65   N = 1.    while
-00047ed0: 204e 203c 206e 3a0a 2020 2020 2020 2020   N < n:.        
-00047ee0: 4e20 2a3d 2032 0a20 2020 2066 6f72 2069  N *= 2.    for i
-00047ef0: 2069 6e20 7261 6e67 6528 6e29 3a0a 2020   in range(n):.  
-00047f00: 2020 2020 2020 6473 6b5b 286e 616d 652c        dsk[(name,
-00047f10: 2069 2c20 312c 2030 295d 203d 2028 6170   i, 1, 0)] = (ap
-00047f20: 706c 792c 2066 2c20 5b28 6464 662e 5f6e  ply, f, [(ddf._n
-00047f30: 616d 652c 2069 292c 2069 6465 6e74 6974  ame, i), identit
-00047f40: 795d 2c20 6b77 6172 6773 290a 2020 2020  y], kwargs).    
-00047f50: 666f 7220 6920 696e 2072 616e 6765 286e  for i in range(n
-00047f60: 2c20 4e29 3a0a 2020 2020 2020 2020 6473  , N):.        ds
-00047f70: 6b5b 286e 616d 652c 2069 2c20 312c 2030  k[(name, i, 1, 0
-00047f80: 295d 203d 2069 6465 6e74 6974 790a 0a20  )] = identity.. 
-00047f90: 2020 2064 203d 2031 0a20 2020 2077 6869     d = 1.    whi
-00047fa0: 6c65 2064 203c 204e 3a0a 2020 2020 2020  le d < N:.      
-00047fb0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-00047fc0: 2830 2c20 4e2c 2032 202a 2064 293a 0a20  (0, N, 2 * d):. 
-00047fd0: 2020 2020 2020 2020 2020 2064 736b 5b28             dsk[(
-00047fe0: 6e61 6d65 2c20 6920 2b20 3220 2a20 6420  name, i + 2 * d 
-00047ff0: 2d20 312c 2032 202a 2064 2c20 3029 5d20  - 1, 2 * d, 0)] 
-00048000: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-00048010: 2020 2020 6170 706c 792c 0a20 2020 2020      apply,.     
-00048020: 2020 2020 2020 2020 2020 2066 2c0a 2020             f,.  
-00048030: 2020 2020 2020 2020 2020 2020 2020 5b28                [(
-00048040: 6e61 6d65 2c20 6920 2b20 6420 2d20 312c  name, i + d - 1,
-00048050: 2064 2c20 3029 2c20 286e 616d 652c 2069   d, 0), (name, i
-00048060: 202b 2032 202a 2064 202d 2031 2c20 642c   + 2 * d - 1, d,
-00048070: 2030 295d 2c0a 2020 2020 2020 2020 2020   0)],.          
-00048080: 2020 2020 2020 6b77 6172 6773 2c0a 2020        kwargs,.  
-00048090: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000480a0: 2020 2020 6420 2a3d 2032 0a0a 2020 2020      d *= 2..    
-000480b0: 6473 6b5b 286e 616d 652c 204e 202d 2031  dsk[(name, N - 1
-000480c0: 2c20 4e2c 2031 295d 203d 2069 6465 6e74  , N, 1)] = ident
-000480d0: 6974 790a 0a20 2020 2077 6869 6c65 2064  ity..    while d
-000480e0: 203e 2031 3a0a 2020 2020 2020 2020 6420   > 1:.        d 
-000480f0: 2f2f 3d20 320a 2020 2020 2020 2020 666f  //= 2.        fo
-00048100: 7220 6920 696e 2072 616e 6765 2830 2c20  r i in range(0, 
-00048110: 4e2c 2032 202a 2064 293a 0a20 2020 2020  N, 2 * d):.     
-00048120: 2020 2020 2020 2064 736b 5b28 6e61 6d65         dsk[(name
-00048130: 2c20 6920 2b20 6420 2d20 312c 2064 2c20  , i + d - 1, d, 
-00048140: 3129 5d20 3d20 286e 616d 652c 2069 202b  1)] = (name, i +
-00048150: 2032 202a 2064 202d 2031 2c20 3220 2a20   2 * d - 1, 2 * 
-00048160: 642c 2031 290a 2020 2020 2020 2020 2020  d, 1).          
-00048170: 2020 6473 6b5b 286e 616d 652c 2069 202b    dsk[(name, i +
-00048180: 2032 202a 2064 202d 2031 2c20 642c 2031   2 * d - 1, d, 1
-00048190: 295d 203d 2028 0a20 2020 2020 2020 2020  )] = (.         
-000481a0: 2020 2020 2020 2061 7070 6c79 2c0a 2020         apply,.  
-000481b0: 2020 2020 2020 2020 2020 2020 2020 662c                f,
-000481c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000481d0: 205b 286e 616d 652c 2069 202b 2032 202a   [(name, i + 2 *
-000481e0: 2064 202d 2031 2c20 3220 2a20 642c 2031   d - 1, 2 * d, 1
-000481f0: 292c 2028 6e61 6d65 2c20 6920 2b20 6420  ), (name, i + d 
-00048200: 2d20 312c 2064 2c20 3029 5d2c 0a20 2020  - 1, d, 0)],.   
-00048210: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
-00048220: 7267 732c 0a20 2020 2020 2020 2020 2020  rgs,.           
-00048230: 2029 0a0a 2020 2020 666f 7220 6920 696e   )..    for i in
-00048240: 2072 616e 6765 286e 293a 0a20 2020 2020   range(n):.     
-00048250: 2020 2064 736b 5b28 6e61 6d65 2c20 6929     dsk[(name, i)
-00048260: 5d20 3d20 2861 7070 6c79 2c20 662c 205b  ] = (apply, f, [
-00048270: 286e 616d 652c 2069 2c20 312c 2031 292c  (name, i, 1, 1),
-00048280: 2069 6465 6e74 6974 795d 2c20 6b77 6172   identity], kwar
-00048290: 6773 290a 0a20 2020 2067 7261 7068 203d  gs)..    graph =
-000482a0: 2048 6967 684c 6576 656c 4772 6170 682e   HighLevelGraph.
-000482b0: 6672 6f6d 5f63 6f6c 6c65 6374 696f 6e73  from_collections
-000482c0: 286e 616d 652c 2064 736b 2c20 6465 7065  (name, dsk, depe
-000482d0: 6e64 656e 6369 6573 3d5b 6464 665d 290a  ndencies=[ddf]).
-000482e0: 2020 2020 7265 7475 726e 206e 6577 5f64      return new_d
-000482f0: 645f 6f62 6a65 6374 2867 7261 7068 2c20  d_object(graph, 
-00048300: 6e61 6d65 2c20 6d65 7461 2c20 6469 7669  name, meta, divi
-00048310: 7369 6f6e 7329 0a0a 0a64 6566 2073 7566  sions)...def suf
-00048320: 6669 785f 7265 6475 6374 696f 6e28 662c  fix_reduction(f,
-00048330: 2064 6466 2c20 6964 656e 7469 7479 2c20   ddf, identity, 
-00048340: 2a2a 6b77 6172 6773 293a 0a20 2020 2022  **kwargs):.    "
-00048350: 2222 436f 6d70 7574 6573 2074 6865 2073  ""Computes the s
-00048360: 7566 6669 7820 7375 6d73 206f 6620 6620  uffix sums of f 
-00048370: 6f6e 2064 660a 0a20 2020 2049 6620 6466  on df..    If df
-00048380: 2068 6173 2070 6172 7469 7469 6f6e 7320   has partitions 
-00048390: 5b50 312c 2050 322c 202e 2e2e 2c20 506e  [P1, P2, ..., Pn
-000483a0: 5d2c 2074 6865 6e20 7265 7475 726e 7320  ], then returns 
-000483b0: 7468 6520 4461 7461 4672 616d 6520 7769  the DataFrame wi
-000483c0: 7468 0a20 2020 2070 6172 7469 7469 6f6e  th.    partition
-000483d0: 7320 5b66 2850 312c 2066 2850 322c 202e  s [f(P1, f(P2, .
-000483e0: 2e2e 6628 506e 2c20 6964 656e 7469 7479  ..f(Pn, identity
-000483f0: 292e 2e2e 2929 2c0a 2020 2020 2020 2020  )...)),.        
-00048400: 2020 2020 2020 2020 6628 5032 2c20 2e2e          f(P2, ..
-00048410: 2e66 2850 6e2c 2069 6465 6e74 6974 7929  .f(Pn, identity)
-00048420: 2e2e 2e29 2c0a 2020 2020 2020 2020 2020  ...),.          
-00048430: 2020 2020 2020 2e2e 2e66 2850 6e2c 2069        ...f(Pn, i
-00048440: 6465 6e74 6974 7929 2e2e 2e2c 0a20 2020  dentity)...,.   
-00048450: 2020 2020 2020 2020 2020 2020 202e 2e2e               ...
-00048460: 5d0a 0a20 2020 2050 6172 616d 6574 6572  ]..    Parameter
-00048470: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-00048480: 0a20 2020 2066 203a 2063 616c 6c61 626c  .    f : callabl
-00048490: 650a 2020 2020 2020 2020 616e 2061 7373  e.        an ass
-000484a0: 6f63 6961 7469 7665 2066 756e 6374 696f  ociative functio
-000484b0: 6e20 660a 2020 2020 6464 6620 3a20 6464  n f.    ddf : dd
-000484c0: 2e44 6174 6146 7261 6d65 0a20 2020 2069  .DataFrame.    i
-000484d0: 6465 6e74 6974 7920 3a20 7064 2e44 6174  dentity : pd.Dat
-000484e0: 6146 7261 6d65 0a20 2020 2020 2020 2061  aFrame.        a
-000484f0: 6e20 6964 656e 7469 7479 2065 6c65 6d65  n identity eleme
-00048500: 6e74 206f 6620 662c 2074 6861 7420 6973  nt of f, that is
-00048510: 2066 2869 6465 6e74 6974 792c 2064 6629   f(identity, df)
-00048520: 203d 2066 2864 662c 2069 6465 6e74 6974   = f(df, identit
-00048530: 7929 203d 2064 660a 2020 2020 6b77 6172  y) = df.    kwar
-00048540: 6773 203a 203f 3f0a 2020 2020 2020 2020  gs : ??.        
-00048550: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
-00048560: 7320 6f66 2066 203f 3f0a 2020 2020 2222  s of f ??.    ""
-00048570: 220a 2020 2020 6473 6b20 3d20 6469 6374  ".    dsk = dict
-00048580: 2829 0a20 2020 206e 616d 6520 3d20 2273  ().    name = "s
-00048590: 7566 6669 785f 7265 6475 6374 696f 6e2d  uffix_reduction-
-000485a0: 2220 2b20 746f 6b65 6e69 7a65 2866 2c20  " + tokenize(f, 
-000485b0: 6464 662c 2069 6465 6e74 6974 792c 202a  ddf, identity, *
-000485c0: 2a6b 7761 7267 7329 0a20 2020 206d 6574  *kwargs).    met
-000485d0: 6120 3d20 6464 662e 5f6d 6574 610a 2020  a = ddf._meta.  
-000485e0: 2020 6e20 3d20 6c65 6e28 6464 662e 6469    n = len(ddf.di
-000485f0: 7669 7369 6f6e 7329 202d 2031 0a20 2020  visions) - 1.   
-00048600: 2064 6976 6973 696f 6e73 203d 205b 4e6f   divisions = [No
-00048610: 6e65 5d20 2a20 286e 202b 2031 290a 0a20  ne] * (n + 1).. 
-00048620: 2020 204e 203d 2031 0a20 2020 2077 6869     N = 1.    whi
-00048630: 6c65 204e 203c 206e 3a0a 2020 2020 2020  le N < n:.      
-00048640: 2020 4e20 2a3d 2032 0a20 2020 2066 6f72    N *= 2.    for
-00048650: 2069 2069 6e20 7261 6e67 6528 6e29 3a0a   i in range(n):.
-00048660: 2020 2020 2020 2020 6473 6b5b 286e 616d          dsk[(nam
-00048670: 652c 2069 2c20 312c 2030 295d 203d 2028  e, i, 1, 0)] = (
-00048680: 6170 706c 792c 2066 2c20 5b28 6464 662e  apply, f, [(ddf.
-00048690: 5f6e 616d 652c 206e 202d 2031 202d 2069  _name, n - 1 - i
-000486a0: 292c 2069 6465 6e74 6974 795d 2c20 6b77  ), identity], kw
-000486b0: 6172 6773 290a 2020 2020 666f 7220 6920  args).    for i 
-000486c0: 696e 2072 616e 6765 286e 2c20 4e29 3a0a  in range(n, N):.
-000486d0: 2020 2020 2020 2020 6473 6b5b 286e 616d          dsk[(nam
-000486e0: 652c 2069 2c20 312c 2030 295d 203d 2069  e, i, 1, 0)] = i
-000486f0: 6465 6e74 6974 790a 0a20 2020 2064 203d  dentity..    d =
-00048700: 2031 0a20 2020 2077 6869 6c65 2064 203c   1.    while d <
-00048710: 204e 3a0a 2020 2020 2020 2020 666f 7220   N:.        for 
-00048720: 6920 696e 2072 616e 6765 2830 2c20 4e2c  i in range(0, N,
-00048730: 2032 202a 2064 293a 0a20 2020 2020 2020   2 * d):.       
-00048740: 2020 2020 2064 736b 5b28 6e61 6d65 2c20       dsk[(name, 
-00048750: 6920 2b20 3220 2a20 6420 2d20 312c 2032  i + 2 * d - 1, 2
-00048760: 202a 2064 2c20 3029 5d20 3d20 280a 2020   * d, 0)] = (.  
-00048770: 2020 2020 2020 2020 2020 2020 2020 6170                ap
-00048780: 706c 792c 0a20 2020 2020 2020 2020 2020  ply,.           
-00048790: 2020 2020 2066 2c0a 2020 2020 2020 2020       f,.        
-000487a0: 2020 2020 2020 2020 5b28 6e61 6d65 2c20          [(name, 
-000487b0: 6920 2b20 3220 2a20 6420 2d20 312c 2064  i + 2 * d - 1, d
-000487c0: 2c20 3029 2c20 286e 616d 652c 2069 202b  , 0), (name, i +
-000487d0: 2064 202d 2031 2c20 642c 2030 295d 2c0a   d - 1, d, 0)],.
-000487e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000487f0: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
-00048800: 2020 2020 290a 2020 2020 2020 2020 6420      ).        d 
-00048810: 2a3d 2032 0a0a 2020 2020 6473 6b5b 286e  *= 2..    dsk[(n
-00048820: 616d 652c 204e 202d 2031 2c20 4e2c 2031  ame, N - 1, N, 1
-00048830: 295d 203d 2069 6465 6e74 6974 790a 0a20  )] = identity.. 
-00048840: 2020 2077 6869 6c65 2064 203e 2031 3a0a     while d > 1:.
-00048850: 2020 2020 2020 2020 6420 2f2f 3d20 320a          d //= 2.
-00048860: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-00048870: 2072 616e 6765 2830 2c20 4e2c 2032 202a   range(0, N, 2 *
-00048880: 2064 293a 0a20 2020 2020 2020 2020 2020   d):.           
-00048890: 2064 736b 5b28 6e61 6d65 2c20 6920 2b20   dsk[(name, i + 
-000488a0: 6420 2d20 312c 2064 2c20 3129 5d20 3d20  d - 1, d, 1)] = 
-000488b0: 286e 616d 652c 2069 202b 2032 202a 2064  (name, i + 2 * d
-000488c0: 202d 2031 2c20 3220 2a20 642c 2031 290a   - 1, 2 * d, 1).
-000488d0: 2020 2020 2020 2020 2020 2020 6473 6b5b              dsk[
-000488e0: 286e 616d 652c 2069 202b 2032 202a 2064  (name, i + 2 * d
-000488f0: 202d 2031 2c20 642c 2031 295d 203d 2028   - 1, d, 1)] = (
-00048900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00048910: 2061 7070 6c79 2c0a 2020 2020 2020 2020   apply,.        
-00048920: 2020 2020 2020 2020 662c 0a20 2020 2020          f,.     
-00048930: 2020 2020 2020 2020 2020 205b 286e 616d             [(nam
-00048940: 652c 2069 202b 2064 202d 2031 2c20 642c  e, i + d - 1, d,
-00048950: 2030 292c 2028 6e61 6d65 2c20 6920 2b20   0), (name, i + 
-00048960: 3220 2a20 6420 2d20 312c 2032 202a 2064  2 * d - 1, 2 * d
-00048970: 2c20 3129 5d2c 0a20 2020 2020 2020 2020  , 1)],.         
-00048980: 2020 2020 2020 206b 7761 7267 732c 0a20         kwargs,. 
-00048990: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-000489a0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-000489b0: 286e 293a 0a20 2020 2020 2020 2064 736b  (n):.        dsk
-000489c0: 5b28 6e61 6d65 2c20 6929 5d20 3d20 2861  [(name, i)] = (a
-000489d0: 7070 6c79 2c20 662c 205b 286e 616d 652c  pply, f, [(name,
-000489e0: 206e 202d 2031 202d 2069 2c20 312c 2031   n - 1 - i, 1, 1
-000489f0: 292c 2069 6465 6e74 6974 795d 2c20 6b77  ), identity], kw
-00048a00: 6172 6773 290a 0a20 2020 2067 7261 7068  args)..    graph
-00048a10: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
-00048a20: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
-00048a30: 6e73 286e 616d 652c 2064 736b 2c20 6465  ns(name, dsk, de
-00048a40: 7065 6e64 656e 6369 6573 3d5b 6464 665d  pendencies=[ddf]
-00048a50: 290a 2020 2020 7265 7475 726e 206e 6577  ).    return new
-00048a60: 5f64 645f 6f62 6a65 6374 2867 7261 7068  _dd_object(graph
-00048a70: 2c20 6e61 6d65 2c20 6d65 7461 2c20 6469  , name, meta, di
-00048a80: 7669 7369 6f6e 7329 0a0a 0a64 6566 206d  visions)...def m
-00048a90: 6170 7365 7269 6573 2862 6173 655f 6368  apseries(base_ch
-00048aa0: 756e 6b2c 2063 6f6e 6361 745f 6d61 7029  unk, concat_map)
-00048ab0: 3a0a 2020 2020 7265 7475 726e 2062 6173  :.    return bas
-00048ac0: 655f 6368 756e 6b2e 6d61 7028 636f 6e63  e_chunk.map(conc
-00048ad0: 6174 5f6d 6170 290a 0a0a 6465 6620 6d61  at_map)...def ma
-00048ae0: 7073 6572 6965 735f 636f 6d62 696e 6528  pseries_combine(
-00048af0: 696e 6465 782c 2063 6f6e 6361 745f 7265  index, concat_re
-00048b00: 7375 6c74 293a 0a20 2020 2066 696e 616c  sult):.    final
-00048b10: 5f73 6572 6965 7320 3d20 636f 6e63 6174  _series = concat
-00048b20: 5f72 6573 756c 742e 736f 7274 5f69 6e64  _result.sort_ind
-00048b30: 6578 2829 0a20 2020 2066 696e 616c 5f73  ex().    final_s
-00048b40: 6572 6965 7320 3d20 696e 6465 782e 746f  eries = index.to
-00048b50: 5f73 6572 6965 7328 292e 6d61 7028 6669  _series().map(fi
-00048b60: 6e61 6c5f 7365 7269 6573 290a 2020 2020  nal_series).    
-00048b70: 7265 7475 726e 2066 696e 616c 5f73 6572  return final_ser
-00048b80: 6965 730a 0a0a 6465 6620 7365 7269 6573  ies...def series
-00048b90: 5f6d 6170 2862 6173 655f 7365 7269 6573  _map(base_series
-00048ba0: 2c20 6d61 705f 7365 7269 6573 293a 0a20  , map_series):. 
-00048bb0: 2020 206e 7061 7274 6974 696f 6e73 203d     npartitions =
-00048bc0: 2062 6173 655f 7365 7269 6573 2e6e 7061   base_series.npa
-00048bd0: 7274 6974 696f 6e73 0a20 2020 2073 706c  rtitions.    spl
-00048be0: 6974 5f6f 7574 203d 206d 6170 5f73 6572  it_out = map_ser
-00048bf0: 6965 732e 6e70 6172 7469 7469 6f6e 730a  ies.npartitions.
-00048c00: 0a20 2020 2064 736b 203d 207b 7d0a 0a20  .    dsk = {}.. 
-00048c10: 2020 2062 6173 655f 746f 6b65 6e5f 6b65     base_token_ke
-00048c20: 7920 3d20 746f 6b65 6e69 7a65 2862 6173  y = tokenize(bas
-00048c30: 655f 7365 7269 6573 2c20 7370 6c69 745f  e_series, split_
-00048c40: 6f75 7429 0a20 2020 2062 6173 655f 7370  out).    base_sp
-00048c50: 6c69 745f 7072 6566 6978 203d 2066 2262  lit_prefix = f"b
-00048c60: 6173 652d 7370 6c69 742d 7b62 6173 655f  ase-split-{base_
-00048c70: 746f 6b65 6e5f 6b65 797d 220a 2020 2020  token_key}".    
-00048c80: 6261 7365 5f73 6861 7264 5f70 7265 6669  base_shard_prefi
-00048c90: 7820 3d20 6622 6261 7365 2d73 6861 7264  x = f"base-shard
-00048ca0: 2d7b 6261 7365 5f74 6f6b 656e 5f6b 6579  -{base_token_key
-00048cb0: 7d22 0a20 2020 2066 6f72 2069 2c20 6b65  }".    for i, ke
-00048cc0: 7920 696e 2065 6e75 6d65 7261 7465 2862  y in enumerate(b
-00048cd0: 6173 655f 7365 7269 6573 2e5f 5f64 6173  ase_series.__das
-00048ce0: 6b5f 6b65 7973 5f5f 2829 293a 0a20 2020  k_keys__()):.   
-00048cf0: 2020 2020 2064 736b 5b28 6261 7365 5f73       dsk[(base_s
-00048d00: 706c 6974 5f70 7265 6669 782c 2069 295d  plit_prefix, i)]
-00048d10: 203d 2028 6861 7368 5f73 6861 7264 2c20   = (hash_shard, 
-00048d20: 6b65 792c 2073 706c 6974 5f6f 7574 290a  key, split_out).
-00048d30: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
-00048d40: 2072 616e 6765 2873 706c 6974 5f6f 7574   range(split_out
-00048d50: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
-00048d60: 736b 5b28 6261 7365 5f73 6861 7264 5f70  sk[(base_shard_p
-00048d70: 7265 6669 782c 2030 2c20 692c 206a 295d  refix, 0, i, j)]
-00048d80: 203d 2028 6765 7469 7465 6d2c 2028 6261   = (getitem, (ba
-00048d90: 7365 5f73 706c 6974 5f70 7265 6669 782c  se_split_prefix,
-00048da0: 2069 292c 206a 290a 0a20 2020 206d 6170   i), j)..    map
-00048db0: 5f74 6f6b 656e 5f6b 6579 203d 2074 6f6b  _token_key = tok
-00048dc0: 656e 697a 6528 6d61 705f 7365 7269 6573  enize(map_series
-00048dd0: 290a 2020 2020 6d61 705f 7370 6c69 745f  ).    map_split_
-00048de0: 7072 6566 6978 203d 2066 226d 6170 2d73  prefix = f"map-s
-00048df0: 706c 6974 2d7b 6d61 705f 746f 6b65 6e5f  plit-{map_token_
-00048e00: 6b65 797d 220a 2020 2020 6d61 705f 7368  key}".    map_sh
-00048e10: 6172 645f 7072 6566 6978 203d 2066 226d  ard_prefix = f"m
-00048e20: 6170 2d73 6861 7264 2d7b 6d61 705f 746f  ap-shard-{map_to
-00048e30: 6b65 6e5f 6b65 797d 220a 2020 2020 666f  ken_key}".    fo
-00048e40: 7220 692c 206b 6579 2069 6e20 656e 756d  r i, key in enum
-00048e50: 6572 6174 6528 6d61 705f 7365 7269 6573  erate(map_series
-00048e60: 2e5f 5f64 6173 6b5f 6b65 7973 5f5f 2829  .__dask_keys__()
-00048e70: 293a 0a20 2020 2020 2020 2064 736b 5b28  ):.        dsk[(
-00048e80: 6d61 705f 7370 6c69 745f 7072 6566 6978  map_split_prefix
-00048e90: 2c20 6929 5d20 3d20 280a 2020 2020 2020  , i)] = (.      
-00048ea0: 2020 2020 2020 6861 7368 5f73 6861 7264        hash_shard
-00048eb0: 2c0a 2020 2020 2020 2020 2020 2020 6b65  ,.            ke
-00048ec0: 792c 0a20 2020 2020 2020 2020 2020 2073  y,.            s
-00048ed0: 706c 6974 5f6f 7574 2c0a 2020 2020 2020  plit_out,.      
-00048ee0: 2020 2020 2020 7370 6c69 745f 6f75 745f        split_out_
-00048ef0: 6f6e 5f69 6e64 6578 2c0a 2020 2020 2020  on_index,.      
-00048f00: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-00048f10: 2020 2020 290a 2020 2020 2020 2020 666f      ).        fo
-00048f20: 7220 6a20 696e 2072 616e 6765 2873 706c  r j in range(spl
-00048f30: 6974 5f6f 7574 293a 0a20 2020 2020 2020  it_out):.       
-00048f40: 2020 2020 2064 736b 5b28 6d61 705f 7368       dsk[(map_sh
-00048f50: 6172 645f 7072 6566 6978 2c20 302c 2069  ard_prefix, 0, i
-00048f60: 2c20 6a29 5d20 3d20 2867 6574 6974 656d  , j)] = (getitem
-00048f70: 2c20 286d 6170 5f73 706c 6974 5f70 7265  , (map_split_pre
-00048f80: 6669 782c 2069 292c 206a 290a 0a20 2020  fix, i), j)..   
-00048f90: 2074 6f6b 656e 5f6b 6579 203d 2074 6f6b   token_key = tok
-00048fa0: 656e 697a 6528 6261 7365 5f73 6572 6965  enize(base_serie
-00048fb0: 732c 206d 6170 5f73 6572 6965 7329 0a20  s, map_series). 
-00048fc0: 2020 206d 6170 5f70 7265 6669 7820 3d20     map_prefix = 
-00048fd0: 6622 6d61 702d 7365 7269 6573 2d7b 746f  f"map-series-{to
-00048fe0: 6b65 6e5f 6b65 797d 220a 2020 2020 666f  ken_key}".    fo
-00048ff0: 7220 6920 696e 2072 616e 6765 286e 7061  r i in range(npa
-00049000: 7274 6974 696f 6e73 293a 0a20 2020 2020  rtitions):.     
-00049010: 2020 2066 6f72 206a 2069 6e20 7261 6e67     for j in rang
-00049020: 6528 7370 6c69 745f 6f75 7429 3a0a 2020  e(split_out):.  
-00049030: 2020 2020 2020 2020 2020 6473 6b5b 286d            dsk[(m
-00049040: 6170 5f70 7265 6669 782c 2069 2c20 6a29  ap_prefix, i, j)
-00049050: 5d20 3d20 280a 2020 2020 2020 2020 2020  ] = (.          
-00049060: 2020 2020 2020 6d61 7073 6572 6965 732c        mapseries,
-00049070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00049080: 2028 6261 7365 5f73 6861 7264 5f70 7265   (base_shard_pre
-00049090: 6669 782c 2030 2c20 692c 206a 292c 0a20  fix, 0, i, j),. 
-000490a0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-000490b0: 5f63 6f6e 6361 742c 205b 286d 6170 5f73  _concat, [(map_s
-000490c0: 6861 7264 5f70 7265 6669 782c 2030 2c20  hard_prefix, 0, 
-000490d0: 6b2c 206a 2920 666f 7220 6b20 696e 2072  k, j) for k in r
-000490e0: 616e 6765 2873 706c 6974 5f6f 7574 295d  ange(split_out)]
-000490f0: 292c 0a20 2020 2020 2020 2020 2020 2029  ),.            )
-00049100: 0a0a 2020 2020 6669 6e61 6c5f 7072 6566  ..    final_pref
-00049110: 6978 203d 2066 226d 6170 2d73 6572 6965  ix = f"map-serie
-00049120: 732d 636f 6d62 696e 652d 7b74 6f6b 656e  s-combine-{token
-00049130: 5f6b 6579 7d22 0a20 2020 2066 6f72 2069  _key}".    for i
-00049140: 2c20 6b65 7920 696e 2065 6e75 6d65 7261  , key in enumera
-00049150: 7465 2862 6173 655f 7365 7269 6573 2e69  te(base_series.i
-00049160: 6e64 6578 2e5f 5f64 6173 6b5f 6b65 7973  ndex.__dask_keys
-00049170: 5f5f 2829 293a 0a20 2020 2020 2020 2064  __()):.        d
-00049180: 736b 5b28 6669 6e61 6c5f 7072 6566 6978  sk[(final_prefix
-00049190: 2c20 6929 5d20 3d20 280a 2020 2020 2020  , i)] = (.      
-000491a0: 2020 2020 2020 6d61 7073 6572 6965 735f        mapseries_
-000491b0: 636f 6d62 696e 652c 0a20 2020 2020 2020  combine,.       
-000491c0: 2020 2020 206b 6579 2c0a 2020 2020 2020       key,.      
-000491d0: 2020 2020 2020 285f 636f 6e63 6174 2c20        (_concat, 
-000491e0: 5b28 6d61 705f 7072 6566 6978 2c20 692c  [(map_prefix, i,
-000491f0: 206a 2920 666f 7220 6a20 696e 2072 616e   j) for j in ran
-00049200: 6765 2873 706c 6974 5f6f 7574 295d 292c  ge(split_out)]),
-00049210: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00049220: 6d65 7461 203d 206d 6170 5f73 6572 6965  meta = map_serie
-00049230: 732e 5f6d 6574 612e 636f 7079 2829 0a20  s._meta.copy(). 
-00049240: 2020 206d 6574 612e 696e 6465 7820 3d20     meta.index = 
-00049250: 6261 7365 5f73 6572 6965 732e 5f6d 6574  base_series._met
-00049260: 612e 696e 6465 780a 2020 2020 6d65 7461  a.index.    meta
-00049270: 203d 206d 616b 655f 6d65 7461 286d 6574   = make_meta(met
-00049280: 6129 0a0a 2020 2020 6465 7065 6e64 656e  a)..    dependen
-00049290: 6369 6573 203d 205b 6261 7365 5f73 6572  cies = [base_ser
-000492a0: 6965 732c 206d 6170 5f73 6572 6965 732c  ies, map_series,
-000492b0: 2062 6173 655f 7365 7269 6573 2e69 6e64   base_series.ind
-000492c0: 6578 5d0a 2020 2020 6772 6170 6820 3d20  ex].    graph = 
-000492d0: 4869 6768 4c65 7665 6c47 7261 7068 2e66  HighLevelGraph.f
-000492e0: 726f 6d5f 636f 6c6c 6563 7469 6f6e 7328  rom_collections(
-000492f0: 0a20 2020 2020 2020 2066 696e 616c 5f70  .        final_p
-00049300: 7265 6669 782c 2064 736b 2c20 6465 7065  refix, dsk, depe
-00049310: 6e64 656e 6369 6573 3d64 6570 656e 6465  ndencies=depende
-00049320: 6e63 6965 730a 2020 2020 290a 2020 2020  ncies.    ).    
-00049330: 6469 7669 7369 6f6e 7320 3d20 6c69 7374  divisions = list
-00049340: 2862 6173 655f 7365 7269 6573 2e64 6976  (base_series.div
-00049350: 6973 696f 6e73 290a 0a20 2020 2072 6574  isions)..    ret
-00049360: 7572 6e20 6e65 775f 6464 5f6f 626a 6563  urn new_dd_objec
-00049370: 7428 6772 6170 682c 2066 696e 616c 5f70  t(graph, final_p
-00049380: 7265 6669 782c 206d 6574 612c 2064 6976  refix, meta, div
-00049390: 6973 696f 6e73 290a 0a0a 6465 6620 5f63  isions)...def _c
-000493a0: 6f6e 7665 7274 5f74 6f5f 6e75 6d65 7269  onvert_to_numeri
-000493b0: 6328 7365 7269 6573 2c20 736b 6970 6e61  c(series, skipna
-000493c0: 293a 0a20 2020 2069 6620 736b 6970 6e61  ):.    if skipna
-000493d0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-000493e0: 2073 6572 6965 732e 6472 6f70 6e61 2829   series.dropna()
-000493f0: 2e76 6965 7728 2269 3822 290a 0a20 2020  .view("i8")..   
-00049400: 2023 2073 6572 6965 732e 7669 6577 2822   # series.view("
-00049410: 6938 2229 2077 6974 6820 7064 2e4e 6154  i8") with pd.NaT
-00049420: 2070 726f 6475 6365 7320 2d39 3232 3333   produces -92233
-00049430: 3732 3033 3638 3534 3737 3538 3038 2069  72036854775808 i
-00049440: 7320 7768 7920 7765 206e 6565 6420 746f  s why we need to
-00049450: 2064 6f20 7468 6973 0a20 2020 2072 6574   do this.    ret
-00049460: 7572 6e20 7365 7269 6573 2e76 6965 7728  urn series.view(
-00049470: 2269 3822 292e 6d61 736b 2873 6572 6965  "i8").mask(serie
-00049480: 732e 6973 6e75 6c6c 2829 2c20 6e70 2e6e  s.isnull(), np.n
-00049490: 616e 290a 0a0a 6465 6620 5f73 7172 745f  an)...def _sqrt_
-000494a0: 616e 645f 636f 6e76 6572 745f 746f 5f74  and_convert_to_t
-000494b0: 696d 6564 656c 7461 2870 6172 7469 7469  imedelta(partiti
-000494c0: 6f6e 2c20 6178 6973 2c20 6474 7970 653d  on, axis, dtype=
-000494d0: 4e6f 6e65 2c20 2a61 7267 732c 202a 2a6b  None, *args, **k
-000494e0: 7761 7267 7329 3a0a 2020 2020 6966 2061  wargs):.    if a
-000494f0: 7869 7320 3d3d 2031 3a0a 2020 2020 2020  xis == 1:.      
-00049500: 2020 7769 7468 2077 6172 6e69 6e67 732e    with warnings.
-00049510: 6361 7463 685f 7761 726e 696e 6773 2829  catch_warnings()
-00049520: 3a0a 2020 2020 2020 2020 2020 2020 7761  :.            wa
-00049530: 726e 696e 6773 2e66 696c 7465 7277 6172  rnings.filterwar
-00049540: 6e69 6e67 7328 0a20 2020 2020 2020 2020  nings(.         
-00049550: 2020 2020 2020 2022 6967 6e6f 7265 222c         "ignore",
-00049560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00049570: 2063 6174 6567 6f72 793d 5275 6e74 696d   category=Runtim
-00049580: 6557 6172 6e69 6e67 2c0a 2020 2020 2020  eWarning,.      
-00049590: 2020 2020 2020 2020 2020 6d65 7373 6167            messag
-000495a0: 653d 2269 6e76 616c 6964 2076 616c 7565  e="invalid value
-000495b0: 2065 6e63 6f75 6e74 6572 6564 2069 6e20   encountered in 
-000495c0: 6361 7374 222c 0a20 2020 2020 2020 2020  cast",.         
-000495d0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-000495e0: 2072 6574 7572 6e20 7064 2e74 6f5f 7469   return pd.to_ti
-000495f0: 6d65 6465 6c74 6128 4d2e 7374 6428 7061  medelta(M.std(pa
-00049600: 7274 6974 696f 6e2c 2061 7869 733d 6178  rtition, axis=ax
-00049610: 6973 2c20 2a61 7267 732c 202a 2a6b 7761  is, *args, **kwa
-00049620: 7267 7329 290a 0a20 2020 2069 735f 6466  rgs))..    is_df
-00049630: 5f6c 696b 652c 2074 696d 655f 636f 6c73  _like, time_cols
-00049640: 203d 206b 7761 7267 735b 2269 735f 6466   = kwargs["is_df
-00049650: 5f6c 696b 6522 5d2c 206b 7761 7267 735b  _like"], kwargs[
-00049660: 2274 696d 655f 636f 6c73 225d 0a0a 2020  "time_cols"]..  
-00049670: 2020 7371 7274 203d 206e 702e 7371 7274    sqrt = np.sqrt
-00049680: 2870 6172 7469 7469 6f6e 290a 0a20 2020  (partition)..   
-00049690: 2069 6620 6e6f 7420 6973 5f64 665f 6c69   if not is_df_li
-000496a0: 6b65 3a0a 2020 2020 2020 2020 7265 7475  ke:.        retu
-000496b0: 726e 2070 642e 746f 5f74 696d 6564 656c  rn pd.to_timedel
-000496c0: 7461 2873 7172 7429 0a0a 2020 2020 7469  ta(sqrt)..    ti
-000496d0: 6d65 5f63 6f6c 5f6d 6173 6b20 3d20 7371  me_col_mask = sq
-000496e0: 7274 2e69 6e64 6578 2e69 7369 6e28 7469  rt.index.isin(ti
-000496f0: 6d65 5f63 6f6c 7329 0a20 2020 206d 6174  me_cols).    mat
-00049700: 6368 696e 675f 7661 6c73 203d 2073 7172  ching_vals = sqr
-00049710: 745b 7469 6d65 5f63 6f6c 5f6d 6173 6b5d  t[time_col_mask]
-00049720: 0a20 2020 2066 6f72 2074 696d 655f 636f  .    for time_co
-00049730: 6c2c 206d 6174 6368 696e 675f 7661 6c20  l, matching_val 
-00049740: 696e 207a 6970 2874 696d 655f 636f 6c73  in zip(time_cols
-00049750: 2c20 6d61 7463 6869 6e67 5f76 616c 7329  , matching_vals)
-00049760: 3a0a 2020 2020 2020 2020 7371 7274 5b74  :.        sqrt[t
-00049770: 696d 655f 636f 6c5d 203d 2070 642e 746f  ime_col] = pd.to
-00049780: 5f74 696d 6564 656c 7461 286d 6174 6368  _timedelta(match
-00049790: 696e 675f 7661 6c29 0a0a 2020 2020 6966  ing_val)..    if
-000497a0: 2064 7479 7065 2069 7320 6e6f 7420 4e6f   dtype is not No
-000497b0: 6e65 3a0a 2020 2020 2020 2020 7371 7274  ne:.        sqrt
-000497c0: 203d 2073 7172 742e 6173 7479 7065 2864   = sqrt.astype(d
-000497d0: 7479 7065 290a 2020 2020 7265 7475 726e  type).    return
-000497e0: 2073 7172 740a 0a0a 6465 6620 5f72 6169   sqrt...def _rai
-000497f0: 7365 5f69 665f 6e6f 745f 7365 7269 6573  se_if_not_series
-00049800: 5f6f 725f 6461 7461 6672 616d 6528 782c  _or_dataframe(x,
-00049810: 2066 756e 636e 616d 6529 3a0a 2020 2020   funcname):.    
-00049820: 2222 220a 2020 2020 5574 696c 6974 7920  """.    Utility 
-00049830: 6675 6e63 7469 6f6e 2074 6f20 7261 6973  function to rais
-00049840: 6520 616e 2065 7272 6f72 2069 6620 616e  e an error if an
-00049850: 206f 626a 6563 7420 6973 206e 6f74 2061   object is not a
-00049860: 2053 6572 6965 7320 6f72 2044 6174 6146   Series or DataF
-00049870: 7261 6d65 0a20 2020 2022 2222 0a20 2020  rame.    """.   
-00049880: 2069 6620 6e6f 7420 6973 5f73 6572 6965   if not is_serie
-00049890: 735f 6c69 6b65 2878 2920 616e 6420 6e6f  s_like(x) and no
-000498a0: 7420 6973 5f64 6174 6166 7261 6d65 5f6c  t is_dataframe_l
-000498b0: 696b 6528 7829 3a0a 2020 2020 2020 2020  ike(x):.        
-000498c0: 7261 6973 6520 4e6f 7449 6d70 6c65 6d65  raise NotImpleme
-000498d0: 6e74 6564 4572 726f 7228 0a20 2020 2020  ntedError(.     
-000498e0: 2020 2020 2020 2022 6025 7360 2069 7320         "`%s` is 
-000498f0: 6f6e 6c79 2073 7570 706f 7274 6564 2077  only supported w
-00049900: 6974 6820 6f62 6a65 6374 7320 7468 6174  ith objects that
-00049910: 2061 7265 2044 6174 6166 7261 6d65 7320   are Dataframes 
-00049920: 6f72 2053 6572 6965 7322 0a20 2020 2020  or Series".     
-00049930: 2020 2020 2020 2025 2066 756e 636e 616d         % funcnam
-00049940: 650a 2020 2020 2020 2020 290a 0a0a 6465  e.        )...de
-00049950: 6620 5f67 6574 6174 7472 5f6e 756d 6572  f _getattr_numer
-00049960: 6963 5f6f 6e6c 7928 2a61 7267 732c 205f  ic_only(*args, _
-00049970: 6461 736b 5f6d 6574 686f 645f 6e61 6d65  dask_method_name
-00049980: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00049990: 2077 6974 6820 6368 6563 6b5f 6e75 6d65   with check_nume
-000499a0: 7269 635f 6f6e 6c79 5f64 6570 7265 6361  ric_only_depreca
-000499b0: 7469 6f6e 2829 3a0a 2020 2020 2020 2020  tion():.        
-000499c0: 7265 7475 726e 2067 6574 6174 7472 284d  return getattr(M
-000499d0: 2c20 5f64 6173 6b5f 6d65 7468 6f64 5f6e  , _dask_method_n
-000499e0: 616d 6529 282a 6172 6773 2c20 2a2a 6b77  ame)(*args, **kw
-000499f0: 6172 6773 290a                           args).
+000472e0: 3e3e 206c 6179 6572 203d 2070 6172 7469  >> layer = parti
+000472f0: 7469 6f6e 7769 7365 5f67 7261 7068 2866  tionwise_graph(f
+00047300: 756e 6374 696f 6e2c 2064 662c 2078 2c20  unction, df, x, 
+00047310: 7a3d 3132 3329 2020 2320 646f 6374 6573  z=123)  # doctes
+00047320: 743a 202b 534b 4950 0a20 2020 203e 3e3e  t: +SKIP.    >>>
+00047330: 2067 7261 7068 203d 2048 6967 684c 6576   graph = HighLev
+00047340: 656c 4772 6170 682e 6672 6f6d 5f63 6f6c  elGraph.from_col
+00047350: 6c65 6374 696f 6e73 286e 616d 652c 206c  lections(name, l
+00047360: 6179 6572 2c20 6465 7065 6e64 656e 6369  ayer, dependenci
+00047370: 6573 3d5b 6466 2c20 785d 2920 2023 2064  es=[df, x])  # d
+00047380: 6f63 7465 7374 3a20 2b53 4b49 500a 2020  octest: +SKIP.  
+00047390: 2020 3e3e 3e20 7265 7375 6c74 203d 206e    >>> result = n
+000473a0: 6577 5f64 645f 6f62 6a65 6374 2867 7261  ew_dd_object(gra
+000473b0: 7068 2c20 6e61 6d65 2c20 6d65 7461 6461  ph, name, metada
+000473c0: 7461 2c20 6466 2e64 6976 6973 696f 6e73  ta, df.divisions
+000473d0: 2920 2023 2064 6f63 7465 7374 3a20 2b53  )  # doctest: +S
+000473e0: 4b49 500a 0a20 2020 2053 6565 2041 6c73  KIP..    See Als
+000473f0: 6f0a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  o.    --------. 
+00047400: 2020 206d 6170 5f70 6172 7469 7469 6f6e     map_partition
+00047410: 730a 2020 2020 2222 220a 2020 2020 7061  s.    """.    pa
+00047420: 6972 7320 3d20 5b5d 0a20 2020 206e 756d  irs = [].    num
+00047430: 626c 6f63 6b73 203d 207b 7d0a 2020 2020  blocks = {}.    
+00047440: 666f 7220 6172 6720 696e 2061 7267 733a  for arg in args:
+00047450: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+00047460: 7374 616e 6365 2861 7267 2c20 5f46 7261  stance(arg, _Fra
+00047470: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
+00047480: 2070 6169 7273 2e65 7874 656e 6428 5b61   pairs.extend([a
+00047490: 7267 2e5f 6e61 6d65 2c20 2269 225d 290a  rg._name, "i"]).
+000474a0: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
+000474b0: 6c6f 636b 735b 6172 672e 5f6e 616d 655d  locks[arg._name]
+000474c0: 203d 2028 6172 672e 6e70 6172 7469 7469   = (arg.npartiti
+000474d0: 6f6e 732c 290a 2020 2020 2020 2020 656c  ons,).        el
+000474e0: 6966 2069 7369 6e73 7461 6e63 6528 6172  if isinstance(ar
+000474f0: 672c 2053 6361 6c61 7229 3a0a 2020 2020  g, Scalar):.    
+00047500: 2020 2020 2020 2020 7061 6972 732e 6578          pairs.ex
+00047510: 7465 6e64 285b 6172 672e 5f6e 616d 652c  tend([arg._name,
+00047520: 2022 6922 5d29 0a20 2020 2020 2020 2020   "i"]).         
+00047530: 2020 206e 756d 626c 6f63 6b73 5b61 7267     numblocks[arg
+00047540: 2e5f 6e61 6d65 5d20 3d20 2831 2c29 0a20  ._name] = (1,). 
+00047550: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+00047560: 7374 616e 6365 2861 7267 2c20 4172 7261  stance(arg, Arra
+00047570: 7929 3a0a 2020 2020 2020 2020 2020 2020  y):.            
+00047580: 6966 2061 7267 2e6e 6469 6d20 3d3d 2031  if arg.ndim == 1
+00047590: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000475a0: 2020 7061 6972 732e 6578 7465 6e64 285b    pairs.extend([
+000475b0: 6172 672e 6e61 6d65 2c20 2269 225d 290a  arg.name, "i"]).
+000475c0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+000475d0: 2061 7267 2e6e 6469 6d20 3d3d 2030 3a0a   arg.ndim == 0:.
+000475e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000475f0: 7061 6972 732e 6578 7465 6e64 285b 6172  pairs.extend([ar
+00047600: 672e 6e61 6d65 2c20 2222 5d29 0a20 2020  g.name, ""]).   
+00047610: 2020 2020 2020 2020 2065 6c69 6620 6172           elif ar
+00047620: 672e 6e64 696d 203d 3d20 323a 0a20 2020  g.ndim == 2:.   
+00047630: 2020 2020 2020 2020 2020 2020 2070 6169               pai
+00047640: 7273 2e65 7874 656e 6428 5b61 7267 2e6e  rs.extend([arg.n
+00047650: 616d 652c 2022 696a 225d 290a 2020 2020  ame, "ij"]).    
+00047660: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00047670: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00047680: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+00047690: 4361 6e27 7420 6164 6420 6d75 6c74 692d  Can't add multi-
+000476a0: 6469 6d65 6e73 696f 6e61 6c20 6172 7261  dimensional arra
+000476b0: 7920 746f 2064 6174 6166 7261 6d65 7322  y to dataframes"
+000476c0: 290a 2020 2020 2020 2020 2020 2020 6e75  ).            nu
+000476d0: 6d62 6c6f 636b 735b 6172 672e 5f6e 616d  mblocks[arg._nam
+000476e0: 655d 203d 2061 7267 2e6e 756d 626c 6f63  e] = arg.numbloc
+000476f0: 6b73 0a20 2020 2020 2020 2065 6c69 6620  ks.        elif 
+00047700: 6973 696e 7374 616e 6365 2861 7267 2c20  isinstance(arg, 
+00047710: 426c 6f63 6b77 6973 6544 6570 293a 0a20  BlockwiseDep):. 
+00047720: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00047730: 6e28 6172 672e 6e75 6d62 6c6f 636b 7329  n(arg.numblocks)
+00047740: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+00047750: 2020 2020 2020 2070 6169 7273 2e65 7874         pairs.ext
+00047760: 656e 6428 5b61 7267 2c20 2269 225d 290a  end([arg, "i"]).
+00047770: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00047780: 206c 656e 2861 7267 2e6e 756d 626c 6f63   len(arg.numbloc
+00047790: 6b73 2920 3d3d 2032 3a0a 2020 2020 2020  ks) == 2:.      
+000477a0: 2020 2020 2020 2020 2020 7061 6972 732e            pairs.
+000477b0: 6578 7465 6e64 285b 6172 672c 2022 696a  extend([arg, "ij
+000477c0: 225d 290a 2020 2020 2020 2020 2020 2020  "]).            
+000477d0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000477e0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+000477f0: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00047800: 2020 2020 2020 2020 2020 2020 6622 426c              f"Bl
+00047810: 6f63 6b77 6973 6544 6570 2061 7267 207b  ockwiseDep arg {
+00047820: 6172 6721 727d 2068 6173 207b 6c65 6e28  arg!r} has {len(
+00047830: 6172 672e 6e75 6d62 6c6f 636b 7329 7d20  arg.numblocks)} 
+00047840: 6469 6d65 6e73 696f 6e73 3b20 6f6e 6c79  dimensions; only
+00047850: 2031 206f 7220 3220 6172 6520 7375 7070   1 or 2 are supp
+00047860: 6f72 7465 642e 220a 2020 2020 2020 2020  orted.".        
+00047870: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00047880: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00047890: 2020 2020 7061 6972 732e 6578 7465 6e64      pairs.extend
+000478a0: 285b 6172 672c 204e 6f6e 655d 290a 2020  ([arg, None]).  
+000478b0: 2020 7265 7475 726e 2062 6c6f 636b 7769    return blockwi
+000478c0: 7365 280a 2020 2020 2020 2020 6675 6e63  se(.        func
+000478d0: 2c20 6c61 7965 725f 6e61 6d65 2c20 2269  , layer_name, "i
+000478e0: 222c 202a 7061 6972 732c 206e 756d 626c  ", *pairs, numbl
+000478f0: 6f63 6b73 3d6e 756d 626c 6f63 6b73 2c20  ocks=numblocks, 
+00047900: 636f 6e63 6174 656e 6174 653d 5472 7565  concatenate=True
+00047910: 2c20 2a2a 6b77 6172 6773 0a20 2020 2029  , **kwargs.    )
+00047920: 0a0a 0a64 6566 206d 6574 615f 7761 726e  ...def meta_warn
+00047930: 696e 6728 6466 293a 0a20 2020 2022 2222  ing(df):.    """
+00047940: 0a20 2020 2050 726f 7669 6465 2061 6e20  .    Provide an 
+00047950: 696e 666f 726d 6174 6976 6520 6d65 7373  informative mess
+00047960: 6167 6520 7768 656e 2074 6865 2075 7365  age when the use
+00047970: 7220 6973 2061 736b 6564 2074 6f20 7072  r is asked to pr
+00047980: 6f76 6964 6520 6d65 7461 6461 7461 0a20  ovide metadata. 
+00047990: 2020 2022 2222 0a20 2020 2069 6620 6973     """.    if is
+000479a0: 5f64 6174 6166 7261 6d65 5f6c 696b 6528  _dataframe_like(
+000479b0: 6466 293a 0a20 2020 2020 2020 206d 6574  df):.        met
+000479c0: 615f 7374 7220 3d20 7b6b 3a20 7374 7228  a_str = {k: str(
+000479d0: 7629 2066 6f72 206b 2c20 7620 696e 2064  v) for k, v in d
+000479e0: 662e 6474 7970 6573 2e74 6f5f 6469 6374  f.dtypes.to_dict
+000479f0: 2829 2e69 7465 6d73 2829 7d0a 2020 2020  ().items()}.    
+00047a00: 656c 6966 2069 735f 7365 7269 6573 5f6c  elif is_series_l
+00047a10: 696b 6528 6466 293a 0a20 2020 2020 2020  ike(df):.       
+00047a20: 206d 6574 615f 7374 7220 3d20 2864 662e   meta_str = (df.
+00047a30: 6e61 6d65 2c20 7374 7228 6466 2e64 7479  name, str(df.dty
+00047a40: 7065 2929 0a20 2020 2065 6c73 653a 0a20  pe)).    else:. 
+00047a50: 2020 2020 2020 206d 6574 615f 7374 7220         meta_str 
+00047a60: 3d20 4e6f 6e65 0a20 2020 206d 7367 203d  = None.    msg =
+00047a70: 2028 0a20 2020 2020 2020 2022 5c6e 596f   (.        "\nYo
+00047a80: 7520 6469 6420 6e6f 7420 7072 6f76 6964  u did not provid
+00047a90: 6520 6d65 7461 6461 7461 2c20 736f 2044  e metadata, so D
+00047aa0: 6173 6b20 6973 2072 756e 6e69 6e67 2079  ask is running y
+00047ab0: 6f75 7220 220a 2020 2020 2020 2020 2266  our ".        "f
+00047ac0: 756e 6374 696f 6e20 6f6e 2061 2073 6d61  unction on a sma
+00047ad0: 6c6c 2064 6174 6173 6574 2074 6f20 6775  ll dataset to gu
+00047ae0: 6573 7320 6f75 7470 7574 2074 7970 6573  ess output types
+00047af0: 2e20 220a 2020 2020 2020 2020 2249 7420  . ".        "It 
+00047b00: 6973 2070 6f73 7369 626c 6520 7468 6174  is possible that
+00047b10: 2044 6173 6b20 7769 6c6c 2067 7565 7373   Dask will guess
+00047b20: 2069 6e63 6f72 7265 6374 6c79 2e5c 6e22   incorrectly.\n"
+00047b30: 0a20 2020 2020 2020 2022 546f 2070 726f  .        "To pro
+00047b40: 7669 6465 2061 6e20 6578 706c 6963 6974  vide an explicit
+00047b50: 206f 7574 7075 7420 7479 7065 7320 6f72   output types or
+00047b60: 2074 6f20 7369 6c65 6e63 6520 7468 6973   to silence this
+00047b70: 206d 6573 7361 6765 2c20 220a 2020 2020   message, ".    
+00047b80: 2020 2020 2270 6c65 6173 6520 7072 6f76      "please prov
+00047b90: 6964 6520 7468 6520 606d 6574 613d 6020  ide the `meta=` 
+00047ba0: 6b65 7977 6f72 642c 2061 7320 6465 7363  keyword, as desc
+00047bb0: 7269 6265 6420 696e 2074 6865 206d 6170  ribed in the map
+00047bc0: 206f 7220 220a 2020 2020 2020 2020 2261   or ".        "a
+00047bd0: 7070 6c79 2066 756e 6374 696f 6e20 7468  pply function th
+00047be0: 6174 2079 6f75 2061 7265 2075 7369 6e67  at you are using
+00047bf0: 2e22 0a20 2020 2029 0a20 2020 2069 6620  .".    ).    if 
+00047c00: 6d65 7461 5f73 7472 3a0a 2020 2020 2020  meta_str:.      
+00047c10: 2020 6d73 6720 2b3d 2028 0a20 2020 2020    msg += (.     
+00047c20: 2020 2020 2020 2022 5c6e 220a 2020 2020         "\n".    
+00047c30: 2020 2020 2020 2020 2220 2042 6566 6f72          "  Befor
+00047c40: 653a 202e 6170 706c 7928 6675 6e63 295c  e: .apply(func)\
+00047c50: 6e22 0a20 2020 2020 2020 2020 2020 2022  n".            "
+00047c60: 2020 4166 7465 723a 2020 2e61 7070 6c79    After:  .apply
+00047c70: 2866 756e 632c 206d 6574 613d 2573 295c  (func, meta=%s)\
+00047c80: 6e22 2025 2073 7472 286d 6574 615f 7374  n" % str(meta_st
+00047c90: 7229 0a20 2020 2020 2020 2029 0a20 2020  r).        ).   
+00047ca0: 2072 6574 7572 6e20 6d73 670a 0a0a 6465   return msg...de
+00047cb0: 6620 7072 6566 6978 5f72 6564 7563 7469  f prefix_reducti
+00047cc0: 6f6e 2866 2c20 6464 662c 2069 6465 6e74  on(f, ddf, ident
+00047cd0: 6974 792c 202a 2a6b 7761 7267 7329 3a0a  ity, **kwargs):.
+00047ce0: 2020 2020 2222 2243 6f6d 7075 7465 7320      """Computes 
+00047cf0: 7468 6520 7072 6566 6978 2073 756d 7320  the prefix sums 
+00047d00: 6f66 2066 206f 6e20 6466 0a0a 2020 2020  of f on df..    
+00047d10: 4966 2064 6620 6861 7320 7061 7274 6974  If df has partit
+00047d20: 696f 6e73 205b 5031 2c20 5032 2c20 2e2e  ions [P1, P2, ..
+00047d30: 2e2c 2050 6e5d 2c20 7468 656e 2072 6574  ., Pn], then ret
+00047d40: 7572 6e73 2074 6865 2044 6174 6146 7261  urns the DataFra
+00047d50: 6d65 2077 6974 680a 2020 2020 7061 7274  me with.    part
+00047d60: 6974 696f 6e73 205b 6628 6964 656e 7469  itions [f(identi
+00047d70: 7479 2c20 5031 292c 0a20 2020 2020 2020  ty, P1),.       
+00047d80: 2020 2020 2020 2020 2066 2866 2869 6465           f(f(ide
+00047d90: 6e74 6974 792c 2050 3129 2c20 5032 292c  ntity, P1), P2),
+00047da0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00047db0: 2066 2866 2866 2869 6465 6e74 6974 792c   f(f(f(identity,
+00047dc0: 2050 3129 2c20 5032 292c 2050 3329 2c0a   P1), P2), P3),.
+00047dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047de0: 2e2e 2e5d 0a0a 2020 2020 5061 7261 6d65  ...]..    Parame
+00047df0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+00047e00: 2d2d 2d0a 2020 2020 6620 3a20 6361 6c6c  ---.    f : call
+00047e10: 6162 6c65 0a20 2020 2020 2020 2061 6e20  able.        an 
+00047e20: 6173 736f 6369 6174 6976 6520 6675 6e63  associative func
+00047e30: 7469 6f6e 2066 0a20 2020 2064 6466 203a  tion f.    ddf :
+00047e40: 2064 642e 4461 7461 4672 616d 650a 2020   dd.DataFrame.  
+00047e50: 2020 6964 656e 7469 7479 203a 2070 642e    identity : pd.
+00047e60: 4461 7461 4672 616d 650a 2020 2020 2020  DataFrame.      
+00047e70: 2020 616e 2069 6465 6e74 6974 7920 656c    an identity el
+00047e80: 656d 656e 7420 6f66 2066 2c20 7468 6174  ement of f, that
+00047e90: 2069 7320 6628 6964 656e 7469 7479 2c20   is f(identity, 
+00047ea0: 6466 2920 3d20 6628 6466 2c20 6964 656e  df) = f(df, iden
+00047eb0: 7469 7479 2920 3d20 6466 0a20 2020 2022  tity) = df.    "
+00047ec0: 2222 0a20 2020 2064 736b 203d 2064 6963  "".    dsk = dic
+00047ed0: 7428 290a 2020 2020 6e61 6d65 203d 2022  t().    name = "
+00047ee0: 7072 6566 6978 5f72 6564 7563 7469 6f6e  prefix_reduction
+00047ef0: 2d22 202b 2074 6f6b 656e 697a 6528 662c  -" + tokenize(f,
+00047f00: 2064 6466 2c20 6964 656e 7469 7479 2c20   ddf, identity, 
+00047f10: 2a2a 6b77 6172 6773 290a 2020 2020 6d65  **kwargs).    me
+00047f20: 7461 203d 2064 6466 2e5f 6d65 7461 0a20  ta = ddf._meta. 
+00047f30: 2020 206e 203d 206c 656e 2864 6466 2e64     n = len(ddf.d
+00047f40: 6976 6973 696f 6e73 2920 2d20 310a 2020  ivisions) - 1.  
+00047f50: 2020 6469 7669 7369 6f6e 7320 3d20 5b4e    divisions = [N
+00047f60: 6f6e 655d 202a 2028 6e20 2b20 3129 0a0a  one] * (n + 1)..
+00047f70: 2020 2020 4e20 3d20 310a 2020 2020 7768      N = 1.    wh
+00047f80: 696c 6520 4e20 3c20 6e3a 0a20 2020 2020  ile N < n:.     
+00047f90: 2020 204e 202a 3d20 320a 2020 2020 666f     N *= 2.    fo
+00047fa0: 7220 6920 696e 2072 616e 6765 286e 293a  r i in range(n):
+00047fb0: 0a20 2020 2020 2020 2064 736b 5b28 6e61  .        dsk[(na
+00047fc0: 6d65 2c20 692c 2031 2c20 3029 5d20 3d20  me, i, 1, 0)] = 
+00047fd0: 2861 7070 6c79 2c20 662c 205b 2864 6466  (apply, f, [(ddf
+00047fe0: 2e5f 6e61 6d65 2c20 6929 2c20 6964 656e  ._name, i), iden
+00047ff0: 7469 7479 5d2c 206b 7761 7267 7329 0a20  tity], kwargs). 
+00048000: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+00048010: 6528 6e2c 204e 293a 0a20 2020 2020 2020  e(n, N):.       
+00048020: 2064 736b 5b28 6e61 6d65 2c20 692c 2031   dsk[(name, i, 1
+00048030: 2c20 3029 5d20 3d20 6964 656e 7469 7479  , 0)] = identity
+00048040: 0a0a 2020 2020 6420 3d20 310a 2020 2020  ..    d = 1.    
+00048050: 7768 696c 6520 6420 3c20 4e3a 0a20 2020  while d < N:.   
+00048060: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+00048070: 6e67 6528 302c 204e 2c20 3220 2a20 6429  nge(0, N, 2 * d)
+00048080: 3a0a 2020 2020 2020 2020 2020 2020 6473  :.            ds
+00048090: 6b5b 286e 616d 652c 2069 202b 2032 202a  k[(name, i + 2 *
+000480a0: 2064 202d 2031 2c20 3220 2a20 642c 2030   d - 1, 2 * d, 0
+000480b0: 295d 203d 2028 0a20 2020 2020 2020 2020  )] = (.         
+000480c0: 2020 2020 2020 2061 7070 6c79 2c0a 2020         apply,.  
+000480d0: 2020 2020 2020 2020 2020 2020 2020 662c                f,
+000480e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000480f0: 205b 286e 616d 652c 2069 202b 2064 202d   [(name, i + d -
+00048100: 2031 2c20 642c 2030 292c 2028 6e61 6d65   1, d, 0), (name
+00048110: 2c20 6920 2b20 3220 2a20 6420 2d20 312c  , i + 2 * d - 1,
+00048120: 2064 2c20 3029 5d2c 0a20 2020 2020 2020   d, 0)],.       
+00048130: 2020 2020 2020 2020 206b 7761 7267 732c           kwargs,
+00048140: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00048150: 2020 2020 2020 2064 202a 3d20 320a 0a20         d *= 2.. 
+00048160: 2020 2064 736b 5b28 6e61 6d65 2c20 4e20     dsk[(name, N 
+00048170: 2d20 312c 204e 2c20 3129 5d20 3d20 6964  - 1, N, 1)] = id
+00048180: 656e 7469 7479 0a0a 2020 2020 7768 696c  entity..    whil
+00048190: 6520 6420 3e20 313a 0a20 2020 2020 2020  e d > 1:.       
+000481a0: 2064 202f 2f3d 2032 0a20 2020 2020 2020   d //= 2.       
+000481b0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+000481c0: 302c 204e 2c20 3220 2a20 6429 3a0a 2020  0, N, 2 * d):.  
+000481d0: 2020 2020 2020 2020 2020 6473 6b5b 286e            dsk[(n
+000481e0: 616d 652c 2069 202b 2064 202d 2031 2c20  ame, i + d - 1, 
+000481f0: 642c 2031 295d 203d 2028 6e61 6d65 2c20  d, 1)] = (name, 
+00048200: 6920 2b20 3220 2a20 6420 2d20 312c 2032  i + 2 * d - 1, 2
+00048210: 202a 2064 2c20 3129 0a20 2020 2020 2020   * d, 1).       
+00048220: 2020 2020 2064 736b 5b28 6e61 6d65 2c20       dsk[(name, 
+00048230: 6920 2b20 3220 2a20 6420 2d20 312c 2064  i + 2 * d - 1, d
+00048240: 2c20 3129 5d20 3d20 280a 2020 2020 2020  , 1)] = (.      
+00048250: 2020 2020 2020 2020 2020 6170 706c 792c            apply,
+00048260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00048270: 2066 2c0a 2020 2020 2020 2020 2020 2020   f,.            
+00048280: 2020 2020 5b28 6e61 6d65 2c20 6920 2b20      [(name, i + 
+00048290: 3220 2a20 6420 2d20 312c 2032 202a 2064  2 * d - 1, 2 * d
+000482a0: 2c20 3129 2c20 286e 616d 652c 2069 202b  , 1), (name, i +
+000482b0: 2064 202d 2031 2c20 642c 2030 295d 2c0a   d - 1, d, 0)],.
+000482c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000482d0: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+000482e0: 2020 2020 290a 0a20 2020 2066 6f72 2069      )..    for i
+000482f0: 2069 6e20 7261 6e67 6528 6e29 3a0a 2020   in range(n):.  
+00048300: 2020 2020 2020 6473 6b5b 286e 616d 652c        dsk[(name,
+00048310: 2069 295d 203d 2028 6170 706c 792c 2066   i)] = (apply, f
+00048320: 2c20 5b28 6e61 6d65 2c20 692c 2031 2c20  , [(name, i, 1, 
+00048330: 3129 2c20 6964 656e 7469 7479 5d2c 206b  1), identity], k
+00048340: 7761 7267 7329 0a0a 2020 2020 6772 6170  wargs)..    grap
+00048350: 6820 3d20 4869 6768 4c65 7665 6c47 7261  h = HighLevelGra
+00048360: 7068 2e66 726f 6d5f 636f 6c6c 6563 7469  ph.from_collecti
+00048370: 6f6e 7328 6e61 6d65 2c20 6473 6b2c 2064  ons(name, dsk, d
+00048380: 6570 656e 6465 6e63 6965 733d 5b64 6466  ependencies=[ddf
+00048390: 5d29 0a20 2020 2072 6574 7572 6e20 6e65  ]).    return ne
+000483a0: 775f 6464 5f6f 626a 6563 7428 6772 6170  w_dd_object(grap
+000483b0: 682c 206e 616d 652c 206d 6574 612c 2064  h, name, meta, d
+000483c0: 6976 6973 696f 6e73 290a 0a0a 6465 6620  ivisions)...def 
+000483d0: 7375 6666 6978 5f72 6564 7563 7469 6f6e  suffix_reduction
+000483e0: 2866 2c20 6464 662c 2069 6465 6e74 6974  (f, ddf, identit
+000483f0: 792c 202a 2a6b 7761 7267 7329 3a0a 2020  y, **kwargs):.  
+00048400: 2020 2222 2243 6f6d 7075 7465 7320 7468    """Computes th
+00048410: 6520 7375 6666 6978 2073 756d 7320 6f66  e suffix sums of
+00048420: 2066 206f 6e20 6466 0a0a 2020 2020 4966   f on df..    If
+00048430: 2064 6620 6861 7320 7061 7274 6974 696f   df has partitio
+00048440: 6e73 205b 5031 2c20 5032 2c20 2e2e 2e2c  ns [P1, P2, ...,
+00048450: 2050 6e5d 2c20 7468 656e 2072 6574 7572   Pn], then retur
+00048460: 6e73 2074 6865 2044 6174 6146 7261 6d65  ns the DataFrame
+00048470: 2077 6974 680a 2020 2020 7061 7274 6974   with.    partit
+00048480: 696f 6e73 205b 6628 5031 2c20 6628 5032  ions [f(P1, f(P2
+00048490: 2c20 2e2e 2e66 2850 6e2c 2069 6465 6e74  , ...f(Pn, ident
+000484a0: 6974 7929 2e2e 2e29 292c 0a20 2020 2020  ity)...)),.     
+000484b0: 2020 2020 2020 2020 2020 2066 2850 322c             f(P2,
+000484c0: 202e 2e2e 6628 506e 2c20 6964 656e 7469   ...f(Pn, identi
+000484d0: 7479 292e 2e2e 292c 0a20 2020 2020 2020  ty)...),.       
+000484e0: 2020 2020 2020 2020 202e 2e2e 6628 506e           ...f(Pn
+000484f0: 2c20 6964 656e 7469 7479 292e 2e2e 2c0a  , identity)...,.
+00048500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00048510: 2e2e 2e5d 0a0a 2020 2020 5061 7261 6d65  ...]..    Parame
+00048520: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+00048530: 2d2d 2d0a 2020 2020 6620 3a20 6361 6c6c  ---.    f : call
+00048540: 6162 6c65 0a20 2020 2020 2020 2061 6e20  able.        an 
+00048550: 6173 736f 6369 6174 6976 6520 6675 6e63  associative func
+00048560: 7469 6f6e 2066 0a20 2020 2064 6466 203a  tion f.    ddf :
+00048570: 2064 642e 4461 7461 4672 616d 650a 2020   dd.DataFrame.  
+00048580: 2020 6964 656e 7469 7479 203a 2070 642e    identity : pd.
+00048590: 4461 7461 4672 616d 650a 2020 2020 2020  DataFrame.      
+000485a0: 2020 616e 2069 6465 6e74 6974 7920 656c    an identity el
+000485b0: 656d 656e 7420 6f66 2066 2c20 7468 6174  ement of f, that
+000485c0: 2069 7320 6628 6964 656e 7469 7479 2c20   is f(identity, 
+000485d0: 6466 2920 3d20 6628 6466 2c20 6964 656e  df) = f(df, iden
+000485e0: 7469 7479 2920 3d20 6466 0a20 2020 206b  tity) = df.    k
+000485f0: 7761 7267 7320 3a20 3f3f 0a20 2020 2020  wargs : ??.     
+00048600: 2020 206b 6579 776f 7264 2061 7267 756d     keyword argum
+00048610: 656e 7473 206f 6620 6620 3f3f 0a20 2020  ents of f ??.   
+00048620: 2022 2222 0a20 2020 2064 736b 203d 2064   """.    dsk = d
+00048630: 6963 7428 290a 2020 2020 6e61 6d65 203d  ict().    name =
+00048640: 2022 7375 6666 6978 5f72 6564 7563 7469   "suffix_reducti
+00048650: 6f6e 2d22 202b 2074 6f6b 656e 697a 6528  on-" + tokenize(
+00048660: 662c 2064 6466 2c20 6964 656e 7469 7479  f, ddf, identity
+00048670: 2c20 2a2a 6b77 6172 6773 290a 2020 2020  , **kwargs).    
+00048680: 6d65 7461 203d 2064 6466 2e5f 6d65 7461  meta = ddf._meta
+00048690: 0a20 2020 206e 203d 206c 656e 2864 6466  .    n = len(ddf
+000486a0: 2e64 6976 6973 696f 6e73 2920 2d20 310a  .divisions) - 1.
+000486b0: 2020 2020 6469 7669 7369 6f6e 7320 3d20      divisions = 
+000486c0: 5b4e 6f6e 655d 202a 2028 6e20 2b20 3129  [None] * (n + 1)
+000486d0: 0a0a 2020 2020 4e20 3d20 310a 2020 2020  ..    N = 1.    
+000486e0: 7768 696c 6520 4e20 3c20 6e3a 0a20 2020  while N < n:.   
+000486f0: 2020 2020 204e 202a 3d20 320a 2020 2020       N *= 2.    
+00048700: 666f 7220 6920 696e 2072 616e 6765 286e  for i in range(n
+00048710: 293a 0a20 2020 2020 2020 2064 736b 5b28  ):.        dsk[(
+00048720: 6e61 6d65 2c20 692c 2031 2c20 3029 5d20  name, i, 1, 0)] 
+00048730: 3d20 2861 7070 6c79 2c20 662c 205b 2864  = (apply, f, [(d
+00048740: 6466 2e5f 6e61 6d65 2c20 6e20 2d20 3120  df._name, n - 1 
+00048750: 2d20 6929 2c20 6964 656e 7469 7479 5d2c  - i), identity],
+00048760: 206b 7761 7267 7329 0a20 2020 2066 6f72   kwargs).    for
+00048770: 2069 2069 6e20 7261 6e67 6528 6e2c 204e   i in range(n, N
+00048780: 293a 0a20 2020 2020 2020 2064 736b 5b28  ):.        dsk[(
+00048790: 6e61 6d65 2c20 692c 2031 2c20 3029 5d20  name, i, 1, 0)] 
+000487a0: 3d20 6964 656e 7469 7479 0a0a 2020 2020  = identity..    
+000487b0: 6420 3d20 310a 2020 2020 7768 696c 6520  d = 1.    while 
+000487c0: 6420 3c20 4e3a 0a20 2020 2020 2020 2066  d < N:.        f
+000487d0: 6f72 2069 2069 6e20 7261 6e67 6528 302c  or i in range(0,
+000487e0: 204e 2c20 3220 2a20 6429 3a0a 2020 2020   N, 2 * d):.    
+000487f0: 2020 2020 2020 2020 6473 6b5b 286e 616d          dsk[(nam
+00048800: 652c 2069 202b 2032 202a 2064 202d 2031  e, i + 2 * d - 1
+00048810: 2c20 3220 2a20 642c 2030 295d 203d 2028  , 2 * d, 0)] = (
+00048820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00048830: 2061 7070 6c79 2c0a 2020 2020 2020 2020   apply,.        
+00048840: 2020 2020 2020 2020 662c 0a20 2020 2020          f,.     
+00048850: 2020 2020 2020 2020 2020 205b 286e 616d             [(nam
+00048860: 652c 2069 202b 2032 202a 2064 202d 2031  e, i + 2 * d - 1
+00048870: 2c20 642c 2030 292c 2028 6e61 6d65 2c20  , d, 0), (name, 
+00048880: 6920 2b20 6420 2d20 312c 2064 2c20 3029  i + d - 1, d, 0)
+00048890: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+000488a0: 2020 206b 7761 7267 732c 0a20 2020 2020     kwargs,.     
+000488b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000488c0: 2064 202a 3d20 320a 0a20 2020 2064 736b   d *= 2..    dsk
+000488d0: 5b28 6e61 6d65 2c20 4e20 2d20 312c 204e  [(name, N - 1, N
+000488e0: 2c20 3129 5d20 3d20 6964 656e 7469 7479  , 1)] = identity
+000488f0: 0a0a 2020 2020 7768 696c 6520 6420 3e20  ..    while d > 
+00048900: 313a 0a20 2020 2020 2020 2064 202f 2f3d  1:.        d //=
+00048910: 2032 0a20 2020 2020 2020 2066 6f72 2069   2.        for i
+00048920: 2069 6e20 7261 6e67 6528 302c 204e 2c20   in range(0, N, 
+00048930: 3220 2a20 6429 3a0a 2020 2020 2020 2020  2 * d):.        
+00048940: 2020 2020 6473 6b5b 286e 616d 652c 2069      dsk[(name, i
+00048950: 202b 2064 202d 2031 2c20 642c 2031 295d   + d - 1, d, 1)]
+00048960: 203d 2028 6e61 6d65 2c20 6920 2b20 3220   = (name, i + 2 
+00048970: 2a20 6420 2d20 312c 2032 202a 2064 2c20  * d - 1, 2 * d, 
+00048980: 3129 0a20 2020 2020 2020 2020 2020 2064  1).            d
+00048990: 736b 5b28 6e61 6d65 2c20 6920 2b20 3220  sk[(name, i + 2 
+000489a0: 2a20 6420 2d20 312c 2064 2c20 3129 5d20  * d - 1, d, 1)] 
+000489b0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+000489c0: 2020 2020 6170 706c 792c 0a20 2020 2020      apply,.     
+000489d0: 2020 2020 2020 2020 2020 2066 2c0a 2020             f,.  
+000489e0: 2020 2020 2020 2020 2020 2020 2020 5b28                [(
+000489f0: 6e61 6d65 2c20 6920 2b20 6420 2d20 312c  name, i + d - 1,
+00048a00: 2064 2c20 3029 2c20 286e 616d 652c 2069   d, 0), (name, i
+00048a10: 202b 2032 202a 2064 202d 2031 2c20 3220   + 2 * d - 1, 2 
+00048a20: 2a20 642c 2031 295d 2c0a 2020 2020 2020  * d, 1)],.      
+00048a30: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
+00048a40: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00048a50: 0a20 2020 2066 6f72 2069 2069 6e20 7261  .    for i in ra
+00048a60: 6e67 6528 6e29 3a0a 2020 2020 2020 2020  nge(n):.        
+00048a70: 6473 6b5b 286e 616d 652c 2069 295d 203d  dsk[(name, i)] =
+00048a80: 2028 6170 706c 792c 2066 2c20 5b28 6e61   (apply, f, [(na
+00048a90: 6d65 2c20 6e20 2d20 3120 2d20 692c 2031  me, n - 1 - i, 1
+00048aa0: 2c20 3129 2c20 6964 656e 7469 7479 5d2c  , 1), identity],
+00048ab0: 206b 7761 7267 7329 0a0a 2020 2020 6772   kwargs)..    gr
+00048ac0: 6170 6820 3d20 4869 6768 4c65 7665 6c47  aph = HighLevelG
+00048ad0: 7261 7068 2e66 726f 6d5f 636f 6c6c 6563  raph.from_collec
+00048ae0: 7469 6f6e 7328 6e61 6d65 2c20 6473 6b2c  tions(name, dsk,
+00048af0: 2064 6570 656e 6465 6e63 6965 733d 5b64   dependencies=[d
+00048b00: 6466 5d29 0a20 2020 2072 6574 7572 6e20  df]).    return 
+00048b10: 6e65 775f 6464 5f6f 626a 6563 7428 6772  new_dd_object(gr
+00048b20: 6170 682c 206e 616d 652c 206d 6574 612c  aph, name, meta,
+00048b30: 2064 6976 6973 696f 6e73 290a 0a0a 6465   divisions)...de
+00048b40: 6620 6d61 7073 6572 6965 7328 6261 7365  f mapseries(base
+00048b50: 5f63 6875 6e6b 2c20 636f 6e63 6174 5f6d  _chunk, concat_m
+00048b60: 6170 293a 0a20 2020 2072 6574 7572 6e20  ap):.    return 
+00048b70: 6261 7365 5f63 6875 6e6b 2e6d 6170 2863  base_chunk.map(c
+00048b80: 6f6e 6361 745f 6d61 7029 0a0a 0a64 6566  oncat_map)...def
+00048b90: 206d 6170 7365 7269 6573 5f63 6f6d 6269   mapseries_combi
+00048ba0: 6e65 2869 6e64 6578 2c20 636f 6e63 6174  ne(index, concat
+00048bb0: 5f72 6573 756c 7429 3a0a 2020 2020 6669  _result):.    fi
+00048bc0: 6e61 6c5f 7365 7269 6573 203d 2063 6f6e  nal_series = con
+00048bd0: 6361 745f 7265 7375 6c74 2e73 6f72 745f  cat_result.sort_
+00048be0: 696e 6465 7828 290a 2020 2020 6669 6e61  index().    fina
+00048bf0: 6c5f 7365 7269 6573 203d 2069 6e64 6578  l_series = index
+00048c00: 2e74 6f5f 7365 7269 6573 2829 2e6d 6170  .to_series().map
+00048c10: 2866 696e 616c 5f73 6572 6965 7329 0a20  (final_series). 
+00048c20: 2020 2072 6574 7572 6e20 6669 6e61 6c5f     return final_
+00048c30: 7365 7269 6573 0a0a 0a64 6566 2073 6572  series...def ser
+00048c40: 6965 735f 6d61 7028 6261 7365 5f73 6572  ies_map(base_ser
+00048c50: 6965 732c 206d 6170 5f73 6572 6965 7329  ies, map_series)
+00048c60: 3a0a 2020 2020 6e70 6172 7469 7469 6f6e  :.    npartition
+00048c70: 7320 3d20 6261 7365 5f73 6572 6965 732e  s = base_series.
+00048c80: 6e70 6172 7469 7469 6f6e 730a 2020 2020  npartitions.    
+00048c90: 7370 6c69 745f 6f75 7420 3d20 6d61 705f  split_out = map_
+00048ca0: 7365 7269 6573 2e6e 7061 7274 6974 696f  series.npartitio
+00048cb0: 6e73 0a0a 2020 2020 6473 6b20 3d20 7b7d  ns..    dsk = {}
+00048cc0: 0a0a 2020 2020 6261 7365 5f74 6f6b 656e  ..    base_token
+00048cd0: 5f6b 6579 203d 2074 6f6b 656e 697a 6528  _key = tokenize(
+00048ce0: 6261 7365 5f73 6572 6965 732c 2073 706c  base_series, spl
+00048cf0: 6974 5f6f 7574 290a 2020 2020 6261 7365  it_out).    base
+00048d00: 5f73 706c 6974 5f70 7265 6669 7820 3d20  _split_prefix = 
+00048d10: 6622 6261 7365 2d73 706c 6974 2d7b 6261  f"base-split-{ba
+00048d20: 7365 5f74 6f6b 656e 5f6b 6579 7d22 0a20  se_token_key}". 
+00048d30: 2020 2062 6173 655f 7368 6172 645f 7072     base_shard_pr
+00048d40: 6566 6978 203d 2066 2262 6173 652d 7368  efix = f"base-sh
+00048d50: 6172 642d 7b62 6173 655f 746f 6b65 6e5f  ard-{base_token_
+00048d60: 6b65 797d 220a 2020 2020 666f 7220 692c  key}".    for i,
+00048d70: 206b 6579 2069 6e20 656e 756d 6572 6174   key in enumerat
+00048d80: 6528 6261 7365 5f73 6572 6965 732e 5f5f  e(base_series.__
+00048d90: 6461 736b 5f6b 6579 735f 5f28 2929 3a0a  dask_keys__()):.
+00048da0: 2020 2020 2020 2020 6473 6b5b 2862 6173          dsk[(bas
+00048db0: 655f 7370 6c69 745f 7072 6566 6978 2c20  e_split_prefix, 
+00048dc0: 6929 5d20 3d20 2868 6173 685f 7368 6172  i)] = (hash_shar
+00048dd0: 642c 206b 6579 2c20 7370 6c69 745f 6f75  d, key, split_ou
+00048de0: 7429 0a20 2020 2020 2020 2066 6f72 206a  t).        for j
+00048df0: 2069 6e20 7261 6e67 6528 7370 6c69 745f   in range(split_
+00048e00: 6f75 7429 3a0a 2020 2020 2020 2020 2020  out):.          
+00048e10: 2020 6473 6b5b 2862 6173 655f 7368 6172    dsk[(base_shar
+00048e20: 645f 7072 6566 6978 2c20 302c 2069 2c20  d_prefix, 0, i, 
+00048e30: 6a29 5d20 3d20 2867 6574 6974 656d 2c20  j)] = (getitem, 
+00048e40: 2862 6173 655f 7370 6c69 745f 7072 6566  (base_split_pref
+00048e50: 6978 2c20 6929 2c20 6a29 0a0a 2020 2020  ix, i), j)..    
+00048e60: 6d61 705f 746f 6b65 6e5f 6b65 7920 3d20  map_token_key = 
+00048e70: 746f 6b65 6e69 7a65 286d 6170 5f73 6572  tokenize(map_ser
+00048e80: 6965 7329 0a20 2020 206d 6170 5f73 706c  ies).    map_spl
+00048e90: 6974 5f70 7265 6669 7820 3d20 6622 6d61  it_prefix = f"ma
+00048ea0: 702d 7370 6c69 742d 7b6d 6170 5f74 6f6b  p-split-{map_tok
+00048eb0: 656e 5f6b 6579 7d22 0a20 2020 206d 6170  en_key}".    map
+00048ec0: 5f73 6861 7264 5f70 7265 6669 7820 3d20  _shard_prefix = 
+00048ed0: 6622 6d61 702d 7368 6172 642d 7b6d 6170  f"map-shard-{map
+00048ee0: 5f74 6f6b 656e 5f6b 6579 7d22 0a20 2020  _token_key}".   
+00048ef0: 2066 6f72 2069 2c20 6b65 7920 696e 2065   for i, key in e
+00048f00: 6e75 6d65 7261 7465 286d 6170 5f73 6572  numerate(map_ser
+00048f10: 6965 732e 5f5f 6461 736b 5f6b 6579 735f  ies.__dask_keys_
+00048f20: 5f28 2929 3a0a 2020 2020 2020 2020 6473  _()):.        ds
+00048f30: 6b5b 286d 6170 5f73 706c 6974 5f70 7265  k[(map_split_pre
+00048f40: 6669 782c 2069 295d 203d 2028 0a20 2020  fix, i)] = (.   
+00048f50: 2020 2020 2020 2020 2068 6173 685f 7368           hash_sh
+00048f60: 6172 642c 0a20 2020 2020 2020 2020 2020  ard,.           
+00048f70: 206b 6579 2c0a 2020 2020 2020 2020 2020   key,.          
+00048f80: 2020 7370 6c69 745f 6f75 742c 0a20 2020    split_out,.   
+00048f90: 2020 2020 2020 2020 2073 706c 6974 5f6f           split_o
+00048fa0: 7574 5f6f 6e5f 696e 6465 782c 0a20 2020  ut_on_index,.   
+00048fb0: 2020 2020 2020 2020 204e 6f6e 652c 0a20           None,. 
+00048fc0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00048fd0: 2066 6f72 206a 2069 6e20 7261 6e67 6528   for j in range(
+00048fe0: 7370 6c69 745f 6f75 7429 3a0a 2020 2020  split_out):.    
+00048ff0: 2020 2020 2020 2020 6473 6b5b 286d 6170          dsk[(map
+00049000: 5f73 6861 7264 5f70 7265 6669 782c 2030  _shard_prefix, 0
+00049010: 2c20 692c 206a 295d 203d 2028 6765 7469  , i, j)] = (geti
+00049020: 7465 6d2c 2028 6d61 705f 7370 6c69 745f  tem, (map_split_
+00049030: 7072 6566 6978 2c20 6929 2c20 6a29 0a0a  prefix, i), j)..
+00049040: 2020 2020 746f 6b65 6e5f 6b65 7920 3d20      token_key = 
+00049050: 746f 6b65 6e69 7a65 2862 6173 655f 7365  tokenize(base_se
+00049060: 7269 6573 2c20 6d61 705f 7365 7269 6573  ries, map_series
+00049070: 290a 2020 2020 6d61 705f 7072 6566 6978  ).    map_prefix
+00049080: 203d 2066 226d 6170 2d73 6572 6965 732d   = f"map-series-
+00049090: 7b74 6f6b 656e 5f6b 6579 7d22 0a20 2020  {token_key}".   
+000490a0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+000490b0: 6e70 6172 7469 7469 6f6e 7329 3a0a 2020  npartitions):.  
+000490c0: 2020 2020 2020 666f 7220 6a20 696e 2072        for j in r
+000490d0: 616e 6765 2873 706c 6974 5f6f 7574 293a  ange(split_out):
+000490e0: 0a20 2020 2020 2020 2020 2020 2064 736b  .            dsk
+000490f0: 5b28 6d61 705f 7072 6566 6978 2c20 692c  [(map_prefix, i,
+00049100: 206a 295d 203d 2028 0a20 2020 2020 2020   j)] = (.       
+00049110: 2020 2020 2020 2020 206d 6170 7365 7269           mapseri
+00049120: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+00049130: 2020 2020 2862 6173 655f 7368 6172 645f      (base_shard_
+00049140: 7072 6566 6978 2c20 302c 2069 2c20 6a29  prefix, 0, i, j)
+00049150: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00049160: 2020 285f 636f 6e63 6174 2c20 5b28 6d61    (_concat, [(ma
+00049170: 705f 7368 6172 645f 7072 6566 6978 2c20  p_shard_prefix, 
+00049180: 302c 206b 2c20 6a29 2066 6f72 206b 2069  0, k, j) for k i
+00049190: 6e20 7261 6e67 6528 7370 6c69 745f 6f75  n range(split_ou
+000491a0: 7429 5d29 2c0a 2020 2020 2020 2020 2020  t)]),.          
+000491b0: 2020 290a 0a20 2020 2066 696e 616c 5f70    )..    final_p
+000491c0: 7265 6669 7820 3d20 6622 6d61 702d 7365  refix = f"map-se
+000491d0: 7269 6573 2d63 6f6d 6269 6e65 2d7b 746f  ries-combine-{to
+000491e0: 6b65 6e5f 6b65 797d 220a 2020 2020 666f  ken_key}".    fo
+000491f0: 7220 692c 206b 6579 2069 6e20 656e 756d  r i, key in enum
+00049200: 6572 6174 6528 6261 7365 5f73 6572 6965  erate(base_serie
+00049210: 732e 696e 6465 782e 5f5f 6461 736b 5f6b  s.index.__dask_k
+00049220: 6579 735f 5f28 2929 3a0a 2020 2020 2020  eys__()):.      
+00049230: 2020 6473 6b5b 2866 696e 616c 5f70 7265    dsk[(final_pre
+00049240: 6669 782c 2069 295d 203d 2028 0a20 2020  fix, i)] = (.   
+00049250: 2020 2020 2020 2020 206d 6170 7365 7269           mapseri
+00049260: 6573 5f63 6f6d 6269 6e65 2c0a 2020 2020  es_combine,.    
+00049270: 2020 2020 2020 2020 6b65 792c 0a20 2020          key,.   
+00049280: 2020 2020 2020 2020 2028 5f63 6f6e 6361           (_conca
+00049290: 742c 205b 286d 6170 5f70 7265 6669 782c  t, [(map_prefix,
+000492a0: 2069 2c20 6a29 2066 6f72 206a 2069 6e20   i, j) for j in 
+000492b0: 7261 6e67 6528 7370 6c69 745f 6f75 7429  range(split_out)
+000492c0: 5d29 2c0a 2020 2020 2020 2020 290a 0a20  ]),.        ).. 
+000492d0: 2020 206d 6574 6120 3d20 6d61 705f 7365     meta = map_se
+000492e0: 7269 6573 2e5f 6d65 7461 2e63 6f70 7928  ries._meta.copy(
+000492f0: 290a 2020 2020 6d65 7461 2e69 6e64 6578  ).    meta.index
+00049300: 203d 2062 6173 655f 7365 7269 6573 2e5f   = base_series._
+00049310: 6d65 7461 2e69 6e64 6578 0a20 2020 206d  meta.index.    m
+00049320: 6574 6120 3d20 6d61 6b65 5f6d 6574 6128  eta = make_meta(
+00049330: 6d65 7461 290a 0a20 2020 2064 6570 656e  meta)..    depen
+00049340: 6465 6e63 6965 7320 3d20 5b62 6173 655f  dencies = [base_
+00049350: 7365 7269 6573 2c20 6d61 705f 7365 7269  series, map_seri
+00049360: 6573 2c20 6261 7365 5f73 6572 6965 732e  es, base_series.
+00049370: 696e 6465 785d 0a20 2020 2067 7261 7068  index].    graph
+00049380: 203d 2048 6967 684c 6576 656c 4772 6170   = HighLevelGrap
+00049390: 682e 6672 6f6d 5f63 6f6c 6c65 6374 696f  h.from_collectio
+000493a0: 6e73 280a 2020 2020 2020 2020 6669 6e61  ns(.        fina
+000493b0: 6c5f 7072 6566 6978 2c20 6473 6b2c 2064  l_prefix, dsk, d
+000493c0: 6570 656e 6465 6e63 6965 733d 6465 7065  ependencies=depe
+000493d0: 6e64 656e 6369 6573 0a20 2020 2029 0a20  ndencies.    ). 
+000493e0: 2020 2064 6976 6973 696f 6e73 203d 206c     divisions = l
+000493f0: 6973 7428 6261 7365 5f73 6572 6965 732e  ist(base_series.
+00049400: 6469 7669 7369 6f6e 7329 0a0a 2020 2020  divisions)..    
+00049410: 7265 7475 726e 206e 6577 5f64 645f 6f62  return new_dd_ob
+00049420: 6a65 6374 2867 7261 7068 2c20 6669 6e61  ject(graph, fina
+00049430: 6c5f 7072 6566 6978 2c20 6d65 7461 2c20  l_prefix, meta, 
+00049440: 6469 7669 7369 6f6e 7329 0a0a 0a64 6566  divisions)...def
+00049450: 205f 636f 6e76 6572 745f 746f 5f6e 756d   _convert_to_num
+00049460: 6572 6963 2873 6572 6965 732c 2073 6b69  eric(series, ski
+00049470: 706e 6129 3a0a 2020 2020 6966 2073 6b69  pna):.    if ski
+00049480: 706e 613a 0a20 2020 2020 2020 2072 6574  pna:.        ret
+00049490: 7572 6e20 7365 7269 6573 2e64 726f 706e  urn series.dropn
+000494a0: 6128 292e 7669 6577 2822 6938 2229 0a0a  a().view("i8")..
+000494b0: 2020 2020 2320 7365 7269 6573 2e76 6965      # series.vie
+000494c0: 7728 2269 3822 2920 7769 7468 2070 642e  w("i8") with pd.
+000494d0: 4e61 5420 7072 6f64 7563 6573 202d 3932  NaT produces -92
+000494e0: 3233 3337 3230 3336 3835 3437 3735 3830  2337203685477580
+000494f0: 3820 6973 2077 6879 2077 6520 6e65 6564  8 is why we need
+00049500: 2074 6f20 646f 2074 6869 730a 2020 2020   to do this.    
+00049510: 7265 7475 726e 2073 6572 6965 732e 7669  return series.vi
+00049520: 6577 2822 6938 2229 2e6d 6173 6b28 7365  ew("i8").mask(se
+00049530: 7269 6573 2e69 736e 756c 6c28 292c 206e  ries.isnull(), n
+00049540: 702e 6e61 6e29 0a0a 0a64 6566 205f 7371  p.nan)...def _sq
+00049550: 7274 5f61 6e64 5f63 6f6e 7665 7274 5f74  rt_and_convert_t
+00049560: 6f5f 7469 6d65 6465 6c74 6128 7061 7274  o_timedelta(part
+00049570: 6974 696f 6e2c 2061 7869 732c 2064 7479  ition, axis, dty
+00049580: 7065 3d4e 6f6e 652c 202a 6172 6773 2c20  pe=None, *args, 
+00049590: 2a2a 6b77 6172 6773 293a 0a20 2020 2069  **kwargs):.    i
+000495a0: 6620 6178 6973 203d 3d20 313a 0a20 2020  f axis == 1:.   
+000495b0: 2020 2020 2077 6974 6820 7761 726e 696e       with warnin
+000495c0: 6773 2e63 6174 6368 5f77 6172 6e69 6e67  gs.catch_warning
+000495d0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+000495e0: 2077 6172 6e69 6e67 732e 6669 6c74 6572   warnings.filter
+000495f0: 7761 726e 696e 6773 280a 2020 2020 2020  warnings(.      
+00049600: 2020 2020 2020 2020 2020 2269 676e 6f72            "ignor
+00049610: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00049620: 2020 2020 6361 7465 676f 7279 3d52 756e      category=Run
+00049630: 7469 6d65 5761 726e 696e 672c 0a20 2020  timeWarning,.   
+00049640: 2020 2020 2020 2020 2020 2020 206d 6573               mes
+00049650: 7361 6765 3d22 696e 7661 6c69 6420 7661  sage="invalid va
+00049660: 6c75 6520 656e 636f 756e 7465 7265 6420  lue encountered 
+00049670: 696e 2063 6173 7422 2c0a 2020 2020 2020  in cast",.      
+00049680: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00049690: 2020 2020 7265 7475 726e 2070 642e 746f      return pd.to
+000496a0: 5f74 696d 6564 656c 7461 284d 2e73 7464  _timedelta(M.std
+000496b0: 2870 6172 7469 7469 6f6e 2c20 6178 6973  (partition, axis
+000496c0: 3d61 7869 732c 202a 6172 6773 2c20 2a2a  =axis, *args, **
+000496d0: 6b77 6172 6773 2929 0a0a 2020 2020 6973  kwargs))..    is
+000496e0: 5f64 665f 6c69 6b65 2c20 7469 6d65 5f63  _df_like, time_c
+000496f0: 6f6c 7320 3d20 6b77 6172 6773 5b22 6973  ols = kwargs["is
+00049700: 5f64 665f 6c69 6b65 225d 2c20 6b77 6172  _df_like"], kwar
+00049710: 6773 5b22 7469 6d65 5f63 6f6c 7322 5d0a  gs["time_cols"].
+00049720: 0a20 2020 2073 7172 7420 3d20 6e70 2e73  .    sqrt = np.s
+00049730: 7172 7428 7061 7274 6974 696f 6e29 0a0a  qrt(partition)..
+00049740: 2020 2020 6966 206e 6f74 2069 735f 6466      if not is_df
+00049750: 5f6c 696b 653a 0a20 2020 2020 2020 2072  _like:.        r
+00049760: 6574 7572 6e20 7064 2e74 6f5f 7469 6d65  eturn pd.to_time
+00049770: 6465 6c74 6128 7371 7274 290a 0a20 2020  delta(sqrt)..   
+00049780: 2074 696d 655f 636f 6c5f 6d61 736b 203d   time_col_mask =
+00049790: 2073 7172 742e 696e 6465 782e 6973 696e   sqrt.index.isin
+000497a0: 2874 696d 655f 636f 6c73 290a 2020 2020  (time_cols).    
+000497b0: 6d61 7463 6869 6e67 5f76 616c 7320 3d20  matching_vals = 
+000497c0: 7371 7274 5b74 696d 655f 636f 6c5f 6d61  sqrt[time_col_ma
+000497d0: 736b 5d0a 2020 2020 666f 7220 7469 6d65  sk].    for time
+000497e0: 5f63 6f6c 2c20 6d61 7463 6869 6e67 5f76  _col, matching_v
+000497f0: 616c 2069 6e20 7a69 7028 7469 6d65 5f63  al in zip(time_c
+00049800: 6f6c 732c 206d 6174 6368 696e 675f 7661  ols, matching_va
+00049810: 6c73 293a 0a20 2020 2020 2020 2073 7172  ls):.        sqr
+00049820: 745b 7469 6d65 5f63 6f6c 5d20 3d20 7064  t[time_col] = pd
+00049830: 2e74 6f5f 7469 6d65 6465 6c74 6128 6d61  .to_timedelta(ma
+00049840: 7463 6869 6e67 5f76 616c 290a 0a20 2020  tching_val)..   
+00049850: 2069 6620 6474 7970 6520 6973 206e 6f74   if dtype is not
+00049860: 204e 6f6e 653a 0a20 2020 2020 2020 2073   None:.        s
+00049870: 7172 7420 3d20 7371 7274 2e61 7374 7970  qrt = sqrt.astyp
+00049880: 6528 6474 7970 6529 0a20 2020 2072 6574  e(dtype).    ret
+00049890: 7572 6e20 7371 7274 0a0a 0a64 6566 205f  urn sqrt...def _
+000498a0: 7261 6973 655f 6966 5f6e 6f74 5f73 6572  raise_if_not_ser
+000498b0: 6965 735f 6f72 5f64 6174 6166 7261 6d65  ies_or_dataframe
+000498c0: 2878 2c20 6675 6e63 6e61 6d65 293a 0a20  (x, funcname):. 
+000498d0: 2020 2022 2222 0a20 2020 2055 7469 6c69     """.    Utili
+000498e0: 7479 2066 756e 6374 696f 6e20 746f 2072  ty function to r
+000498f0: 6169 7365 2061 6e20 6572 726f 7220 6966  aise an error if
+00049900: 2061 6e20 6f62 6a65 6374 2069 7320 6e6f   an object is no
+00049910: 7420 6120 5365 7269 6573 206f 7220 4461  t a Series or Da
+00049920: 7461 4672 616d 650a 2020 2020 2222 220a  taFrame.    """.
+00049930: 2020 2020 6966 206e 6f74 2069 735f 7365      if not is_se
+00049940: 7269 6573 5f6c 696b 6528 7829 2061 6e64  ries_like(x) and
+00049950: 206e 6f74 2069 735f 6461 7461 6672 616d   not is_datafram
+00049960: 655f 6c69 6b65 2878 293a 0a20 2020 2020  e_like(x):.     
+00049970: 2020 2072 6169 7365 204e 6f74 496d 706c     raise NotImpl
+00049980: 656d 656e 7465 6445 7272 6f72 280a 2020  ementedError(.  
+00049990: 2020 2020 2020 2020 2020 2260 2573 6020            "`%s` 
+000499a0: 6973 206f 6e6c 7920 7375 7070 6f72 7465  is only supporte
+000499b0: 6420 7769 7468 206f 626a 6563 7473 2074  d with objects t
+000499c0: 6861 7420 6172 6520 4461 7461 6672 616d  hat are Datafram
+000499d0: 6573 206f 7220 5365 7269 6573 220a 2020  es or Series".  
+000499e0: 2020 2020 2020 2020 2020 2520 6675 6e63            % func
+000499f0: 6e61 6d65 0a20 2020 2020 2020 2029 0a0a  name.        )..
+00049a00: 0a64 6566 205f 6765 7461 7474 725f 6e75  .def _getattr_nu
+00049a10: 6d65 7269 635f 6f6e 6c79 282a 6172 6773  meric_only(*args
+00049a20: 2c20 5f64 6173 6b5f 6d65 7468 6f64 5f6e  , _dask_method_n
+00049a30: 616d 652c 202a 2a6b 7761 7267 7329 3a0a  ame, **kwargs):.
+00049a40: 2020 2020 7769 7468 2063 6865 636b 5f6e      with check_n
+00049a50: 756d 6572 6963 5f6f 6e6c 795f 6465 7072  umeric_only_depr
+00049a60: 6563 6174 696f 6e28 293a 0a20 2020 2020  ecation():.     
+00049a70: 2020 2072 6574 7572 6e20 6765 7461 7474     return getatt
+00049a80: 7228 4d2c 205f 6461 736b 5f6d 6574 686f  r(M, _dask_metho
+00049a90: 645f 6e61 6d65 2928 2a61 7267 732c 202a  d_name)(*args, *
+00049aa0: 2a6b 7761 7267 7329 0a                   *kwargs).
```

### Comparing `dask-2023.7.0/dask/dataframe/dispatch.py` & `dask-2023.7.1/dask/dataframe/dispatch.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/extensions.py` & `dask-2023.7.1/dask/dataframe/extensions.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/groupby.py` & `dask-2023.7.1/dask/dataframe/groupby.py`

 * *Files 0% similar despite different names*

```diff
@@ -497,21 +497,15 @@
             has_categoricals = True
             full_index = result.index.categories.copy().rename(result.index.name)
         elif isinstance(result.index, pd.MultiIndex) and any(
             isinstance(level, pd.CategoricalIndex) for level in result.index.levels
         ):
             has_categoricals = True
             full_index = pd.MultiIndex.from_product(
-                (
-                    level.categories
-                    if isinstance(level, pd.CategoricalIndex)
-                    else level
-                    for level in result.index.levels
-                ),
-                names=result.index.names,
+                result.index.levels, names=result.index.names
             )
         if has_categoricals:
             # If we found any categoricals, append unobserved values to the end of the
             # frame.
             new_cats = full_index[~full_index.isin(result.index)]
             empty_data = {
                 c: pd.Series(index=new_cats, dtype=result[c].dtype)
```

### Comparing `dask-2023.7.0/dask/dataframe/hyperloglog.py` & `dask-2023.7.1/dask/dataframe/hyperloglog.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/indexing.py` & `dask-2023.7.1/dask/dataframe/indexing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/io/__init__.py` & `dask-2023.7.1/dask/dataframe/io/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/io/csv.py` & `dask-2023.7.1/dask/dataframe/io/csv.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/io/hdf.py` & `dask-2023.7.1/dask/dataframe/io/hdf.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/io/io.py` & `dask-2023.7.1/dask/dataframe/io/io.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/io/json.py` & `dask-2023.7.1/dask/dataframe/io/json.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/io/orc/arrow.py` & `dask-2023.7.1/dask/dataframe/io/orc/arrow.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/io/orc/core.py` & `dask-2023.7.1/dask/dataframe/io/orc/core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/io/parquet/arrow.py` & `dask-2023.7.1/dask/dataframe/io/parquet/arrow.py`

 * *Files 1% similar despite different names*

```diff
@@ -32,15 +32,15 @@
     _process_open_file_options,
     _row_groups_to_parts,
     _set_gather_statistics,
     _set_metadata_task_size,
     _sort_and_analyze_paths,
 )
 from dask.dataframe.io.utils import _get_pyarrow_dtypes, _is_local_fs, _open_input_files
-from dask.dataframe.utils import clear_known_categories
+from dask.dataframe.utils import clear_known_categories, pyarrow_strings_enabled
 from dask.delayed import Delayed
 from dask.utils import getargspec, natural_sort_key
 
 PYARROW_NULLABLE_DTYPE_MAPPING = {
     pa.int8(): pd.Int8Dtype(),
     pa.int16(): pd.Int16Dtype(),
     pa.int32(): pd.Int32Dtype(),
@@ -648,15 +648,15 @@
             arrow_table, categories, dtype_backend=dtype_backend, **kwargs
         )
 
         # For pyarrow.dataset api, need to convert partition columns
         # to categorigal manually for integer types.
         if partitions and isinstance(partitions, list):
             for partition in partitions:
-                if df[partition.name].dtype.name != "category":
+                if len(partition.keys) and df[partition.name].dtype.name != "category":
                     # We read directly from fragments, so the partition
                     # columns are already in our dataframe.  We just
                     # need to convert non-categorical types.
                     df[partition.name] = pd.Series(
                         pd.Categorical(
                             categories=partition.keys,
                             values=df[partition.name].values,
@@ -1119,23 +1119,31 @@
         #    - "partition_obj" : (list of PartitionObj) This is a list of
         #          simple objects providing `name` and `keys` attributes
         #          for each partition column.
         #    - "partition_names" : (list)  This is a list containing the
         #          names of partitioned columns.
         #
         partition_obj, partition_names = [], []
-        if (
-            ds.partitioning
-            and ds.partitioning.dictionaries
-            and all(arr is not None for arr in ds.partitioning.dictionaries)
-        ):
+        if ds.partitioning and ds.partitioning.schema:
             partition_names = list(ds.partitioning.schema.names)
             for i, name in enumerate(partition_names):
+                dictionary = (
+                    ds.partitioning.dictionaries[i]
+                    if ds.partitioning.dictionaries
+                    else None
+                )
                 partition_obj.append(
-                    PartitionObj(name, ds.partitioning.dictionaries[i].to_pandas())
+                    PartitionObj(
+                        name,
+                        (
+                            pd.Series([], dtype="object")
+                            if dictionary is None
+                            else dictionary.to_pandas()
+                        ),
+                    )
                 )
 
         # Check the `aggregate_files` setting
         aggregation_depth = _get_aggregation_depth(aggregate_files, partition_names)
 
         return {
             "ds": ds,
@@ -1153,15 +1161,15 @@
             "aggregate_files": aggregate_files,
             "aggregation_depth": aggregation_depth,
             "partitions": partition_obj,
             "partition_names": partition_names,
             "metadata_task_size": metadata_task_size,
             "kwargs": {
                 "dataset": _dataset_kwargs,
-                "convert_string": dask.config.get("dataframe.convert-string"),
+                "convert_string": pyarrow_strings_enabled(),
                 **kwargs,
             },
         }
 
     @classmethod
     def _create_dd_meta(cls, dataset_info):
         """Use parquet schema and hive-partition information
@@ -1225,15 +1233,15 @@
 
         # Ensure that there is no overlap between partition columns
         # and explicit column storage
         if partitions:
             _partitions = [p for p in partitions if p not in physical_column_names]
             if not _partitions:
                 partitions = []
-                dataset_info["partitions"] = None
+                dataset_info["partitions"] = []
                 dataset_info["partition_keys"] = {}
                 dataset_info["partition_names"] = partitions
             elif len(_partitions) != len(partitions):
                 raise ValueError(
                     "No partition-columns should be written in the \n"
                     "file unless they are ALL written in the file.\n"
                     "physical columns: {} | partitions: {}".format(
@@ -1262,14 +1270,16 @@
                 cols=[c for c in categories if c not in meta.index.names],
                 dtype_backend=dtype_backend,
             )
 
         if partition_obj:
             # Update meta dtypes for partitioned columns
             for partition in partition_obj:
+                if not len(partition.keys):
+                    continue
                 if isinstance(index, list) and partition.name == index[0]:
                     # Index from directory structure
                     meta.index = pd.CategoricalIndex(
                         [], categories=partition.keys, name=index[0]
                     )
                 elif partition.name == meta.index.name:
                     # Index created from a categorical column
@@ -1762,22 +1772,25 @@
         # For pyarrow.dataset api, if we did not read directly from
         # fragments, we need to add the partitioned columns here.
         if partitions and isinstance(partitions, list):
             keys_dict = {k: v for (k, v) in partition_keys}
             for partition in partitions:
                 if partition.name not in arrow_table.schema.names:
                     # We read from file paths, so the partition
-                    # columns are NOT in our table yet.
+                    # columns may NOT be in our table yet.
                     cat = keys_dict.get(partition.name, None)
-                    cat_ind = np.full(
-                        len(arrow_table), partition.keys.get_loc(cat), dtype="i4"
-                    )
-                    arr = pa.DictionaryArray.from_arrays(
-                        cat_ind, pa.array(partition.keys)
-                    )
+                    if not len(partition.keys):
+                        arr = pa.array(np.full(len(arrow_table), cat))
+                    else:
+                        cat_ind = np.full(
+                            len(arrow_table), partition.keys.get_loc(cat), dtype="i4"
+                        )
+                        arr = pa.DictionaryArray.from_arrays(
+                            cat_ind, pa.array(partition.keys)
+                        )
                     arrow_table = arrow_table.append_column(partition.name, arr)
 
         return arrow_table
 
     @classmethod
     def _determine_type_mapper(
         cls, *, dtype_backend=None, convert_string=False, **kwargs
```

### Comparing `dask-2023.7.0/dask/dataframe/io/parquet/core.py` & `dask-2023.7.1/dask/dataframe/io/parquet/core.py`

 * *Files 0% similar despite different names*

```diff
@@ -626,15 +626,17 @@
         # Construct the output collection with from_map
         return from_map(
             io_func,
             parts,
             meta=meta,
             divisions=divisions,
             label="read-parquet",
-            token=tokenize(path, **input_kwargs),
+            token=tokenize(
+                path, dask.config.get("dataframe.convert-string"), **input_kwargs
+            ),
             enforce_metadata=False,
             creation_info={
                 "func": read_parquet,
                 "args": (path,),
                 "kwargs": input_kwargs,
             },
         )
```

### Comparing `dask-2023.7.0/dask/dataframe/io/parquet/fastparquet.py` & `dask-2023.7.1/dask/dataframe/io/parquet/fastparquet.py`

 * *Files 2% similar despite different names*

```diff
@@ -19,15 +19,14 @@
     import fastparquet
     from fastparquet import ParquetFile
     from fastparquet.util import ex_from_sep, get_file_scheme, groupby_types, val_to_num
     from fastparquet.writer import make_part_file, partition_on_columns
 except ImportError:
     pass
 
-from dask import config
 from dask.base import tokenize
 
 #########################
 # Fastparquet interface #
 #########################
 from dask.dataframe.io.parquet.utils import (
     Engine,
@@ -902,19 +901,14 @@
             raise ValueError(
                 "`use_nullable_dtypes` is not supported by the fastparquet engine"
             )
         if dtype_backend is not None:
             raise ValueError(
                 "`dtype_backend` is not supported by the fastparquet engine"
             )
-        if config.get("dataframe.convert-string", False):
-            warnings.warn(
-                "`dataframe.convert-string` is not supported by the fastparquet engine",
-                category=UserWarning,
-            )
 
         # Stage 1: Collect general dataset information
         dataset_info = cls._collect_dataset_info(
             paths,
             fs,
             categories,
             index,
@@ -1224,26 +1218,31 @@
                 # _common_metadata or any data file here
                 pf = fastparquet.api.ParquetFile(path, open_with=fs.open)
                 metadata_file_exists = fs.exists(fs.sep.join([path, "_metadata"]))
             except (OSError, ValueError):
                 # append for create
                 append = False
         if append:
+            from dask.dataframe._pyarrow import to_object_string
+
             if pf.file_scheme not in ["hive", "empty", "flat"]:
                 raise ValueError(
                     "Requested file scheme is hive, but existing file scheme is not."
                 )
             elif (set(pf.columns) != set(df.columns) - set(partition_on)) or (
                 set(partition_on) != set(pf.cats)
             ):
                 raise ValueError(
                     "Appended columns not the same.\n"
                     "Previous: {} | New: {}".format(pf.columns, list(df.columns))
                 )
-            elif (pd.Series(pf.dtypes).loc[pf.columns] != df[pf.columns].dtypes).any():
+            elif (
+                pd.Series(pf.dtypes).loc[pf.columns]
+                != to_object_string(df[pf.columns]._meta).dtypes
+            ).any():
                 raise ValueError(
                     "Appended dtypes differ.\n{}".format(
                         set(pf.dtypes.items()) ^ set(df.dtypes.items())
                     )
                 )
             else:
                 df = df[pf.columns + partition_on]
```

### Comparing `dask-2023.7.0/dask/dataframe/io/parquet/utils.py` & `dask-2023.7.1/dask/dataframe/io/parquet/utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/io/sql.py` & `dask-2023.7.1/dask/dataframe/io/sql.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/io/tests/test_csv.py` & `dask-2023.7.1/dask/dataframe/io/tests/test_csv.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/io/tests/test_hdf.py` & `dask-2023.7.1/dask/dataframe/io/tests/test_hdf.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/io/tests/test_io.py` & `dask-2023.7.1/dask/dataframe/io/tests/test_io.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/io/tests/test_json.py` & `dask-2023.7.1/dask/dataframe/io/tests/test_json.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/io/tests/test_orc.py` & `dask-2023.7.1/dask/dataframe/io/tests/test_orc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/io/tests/test_parquet.py` & `dask-2023.7.1/dask/dataframe/io/tests/test_parquet.py`

 * *Files 0% similar despite different names*

```diff
@@ -46,15 +46,15 @@
 
 try:
     import pyarrow.parquet as pq
 except ImportError:
     pq = False
 
 
-SKIP_FASTPARQUET = not fastparquet or pyarrow_strings_enabled()
+SKIP_FASTPARQUET = not fastparquet
 FASTPARQUET_MARK = pytest.mark.skipif(
     SKIP_FASTPARQUET, reason="fastparquet not found or pyarrow strings are enabled"
 )
 
 SKIP_PYARROW = not pq
 SKIP_PYARROW_REASON = "pyarrow not found"
 PYARROW_MARK = pytest.mark.skipif(SKIP_PYARROW, reason=SKIP_PYARROW_REASON)
@@ -688,14 +688,16 @@
         # https://github.com/apache/arrow/issues/34283
         expected.index = expected.index.astype(pd.Float32Dtype())
     assert_eq(result, expected)
 
 
 @write_read_engines()
 def test_categorical(tmpdir, write_engine, read_engine):
+    if write_engine == "fastparquet" and read_engine == "pyarrow":
+        pytest.xfail("Known limitation")
     tmp = str(tmpdir)
     df = pd.DataFrame({"x": ["a", "b", "c"] * 100}, dtype="category")
     ddf = dd.from_pandas(df, npartitions=3)
     dd.to_parquet(ddf, tmp, engine=write_engine)
 
     ddf2 = dd.read_parquet(tmp, categories="x", engine=read_engine)
     assert ddf2.compute().x.cat.categories.tolist() == ["a", "b", "c"]
@@ -1189,16 +1191,22 @@
 @pytest.mark.xfail(
     pyarrow_strings_enabled() and pyarrow_version < parse_version("12.0.0"),
     reason="Known failure with pyarrow strings: https://github.com/apache/arrow/issues/33727",
 )
 def test_categories(tmpdir, engine):
     fn = str(tmpdir)
     df = pd.DataFrame({"x": [1, 2, 3, 4, 5], "y": list("caaab")})
-    ddf = dd.from_pandas(df, npartitions=2)
-    ddf["y"] = ddf.y.astype("category")
+
+    ctx = contextlib.nullcontext
+    if engine == "fastparquet":
+        ctx = dask.config.set
+    with ctx({"dataframe.convert-string": False}):
+        ddf = dd.from_pandas(df, npartitions=2)
+        ddf["y"] = ddf.y.astype("category")
+
     ddf.to_parquet(fn, engine=engine)
     ddf2 = dd.read_parquet(
         fn, categories=["y"], engine=engine, calculate_divisions=True
     )
 
     # Shouldn't need to specify categories explicitly
     ddf3 = dd.read_parquet(fn, engine=engine, calculate_divisions=True)
@@ -3285,15 +3293,18 @@
 
     # Make sure we are still allowing the getitem optimization
     ddf = ddf["A"]
     dsk = optimize_dataframe_getitem(ddf.dask, keys=[(ddf._name, 0)])
     read = [key for key in dsk.layers if key.startswith("read-parquet")][0]
     subgraph = dsk.layers[read]
     assert isinstance(subgraph, DataFrameIOLayer)
-    assert subgraph.columns == ["A"]
+    expected = (
+        ["A", "B"] if engine == "fastparquet" and pyarrow_strings_enabled() else ["A"]
+    )
+    assert subgraph.columns == expected
 
 
 @pytest.mark.parametrize("calculate_divisions", [None, True])
 @write_read_engines()
 def test_filter_nonpartition_columns(
     tmpdir, write_engine, read_engine, calculate_divisions
 ):
@@ -4774,37 +4785,46 @@
     ddf = dd.read_parquet(path, engine=engine, filters=[("b", "==", "cat")])
     assert_eq(df, ddf)
 
     ddf = dd.read_parquet(path, engine=engine, filters=[("b", "is not", None)])
     assert_eq(df, ddf)
 
 
-@PYARROW_MARK
 @pytest.mark.parametrize("convert_string", [True, False])
 @pytest.mark.skipif(
     not PANDAS_GT_200, reason="dataframe.convert-string requires pandas>=2.0"
 )
 def test_read_parquet_convert_string(tmp_path, convert_string, engine):
     df = pd.DataFrame(
         {"A": ["def", "abc", "ghi"], "B": [5, 2, 3], "C": ["x", "y", "z"]}
     ).set_index("C")
 
     outfile = tmp_path / "out.parquet"
     df.to_parquet(outfile, engine=engine)
 
     with dask.config.set({"dataframe.convert-string": convert_string}):
-        ddf = dd.read_parquet(outfile, engine="pyarrow")
+        ddf = dd.read_parquet(outfile, engine=engine)
 
     if convert_string:
         expected = df.astype({"A": "string[pyarrow]"})
         expected.index = expected.index.astype("string[pyarrow]")
     else:
         expected = df
     assert_eq(ddf, expected)
-    assert len(ddf.dask.layers) == 1
+    # pyarrow engine has a specialized implementation
+    n_layers = 2 if convert_string and engine == "fastparquet" else 1
+    assert len(ddf.dask.layers) == n_layers
+
+    # Test collection name takes into account `dataframe.convert-string`
+    with dask.config.set({"dataframe.convert-string": convert_string}):
+        ddf1 = dd.read_parquet(outfile, engine="pyarrow")
+    with dask.config.set({"dataframe.convert-string": not convert_string}):
+        ddf2 = dd.read_parquet(outfile, engine="pyarrow")
+
+    assert ddf1._name != ddf2._name
 
 
 @PYARROW_MARK
 @pytest.mark.skipif(
     not PANDAS_GT_200, reason="dataframe.convert-string requires pandas>=2.0"
 )
 def test_read_parquet_convert_string_nullable_mapper(tmp_path, engine):
@@ -4842,31 +4862,14 @@
         }
     )
     expected.index = expected.index.astype("string[pyarrow]")
 
     assert_eq(ddf, expected)
 
 
-@PYARROW_MARK  # We get an error instead of a warning without pyarrow
-@FASTPARQUET_MARK
-@pytest.mark.skipif(
-    not PANDAS_GT_200, reason="dataframe.convert-string requires pandas>=2.0"
-)
-def test_read_parquet_convert_string_fastparquet_warns(tmp_path):
-    df = pd.DataFrame({"A": ["def", "abc", "ghi"], "B": [5, 2, 3]})
-    outfile = tmp_path / "out.parquet"
-    df.to_parquet(outfile)
-
-    with dask.config.set({"dataframe.convert-string": True}):
-        with pytest.warns(
-            UserWarning, match="`dataframe.convert-string` is not supported"
-        ):
-            dd.read_parquet(outfile, engine="fastparquet")
-
-
 @PYARROW_MARK
 @pytest.mark.parametrize("dtype_backend", ["numpy_nullable", "pyarrow"])
 @pytest.mark.skipif(not PANDAS_GT_150, reason="Requires pyarrow-backed nullable dtypes")
 def test_dtype_backend(tmp_path, dtype_backend, engine):
     """
     Test reading a parquet file without pandas metadata,
     but forcing use of nullable dtypes where appropriate
@@ -4930,7 +4933,36 @@
     df = pd.DataFrame({"a": pd.Series(["x", "y"], dtype="category"), "b": [1, 2]})
     outdir = tmp_path / "out.parquet"
     df.to_parquet(outdir, engine="pyarrow")
     ddf = dd.read_parquet(outdir, engine="pyarrow", dtype_backend="pyarrow")
     pdf = pd.read_parquet(outdir, engine="pyarrow", dtype_backend="pyarrow")
     # Set sort_results=False because of pandas bug up to 2.0.1
     assert_eq(ddf, pdf, sort_results=PANDAS_GT_202)
+
+
+@PYARROW_MARK
+@pytest.mark.parametrize("filters", [None, [[("b", "==", "dog")]]])
+def test_non_categorical_partitioning_pyarrow(tmpdir, filters):
+    from pyarrow.dataset import partitioning as pd_partitioning
+
+    df1 = pd.DataFrame({"a": range(100), "b": ["cat", "dog"] * 50})
+    ddf1 = dd.from_pandas(df1, npartitions=2)
+    ddf1.to_parquet(
+        path=tmpdir, partition_on=["b"], write_index=False, engine="pyarrow"
+    )
+
+    schema = pa.schema([("b", pa.string())])
+    partitioning = dict(flavor="hive", schema=schema)
+    ddf = dd.read_parquet(
+        tmpdir,
+        dataset={"partitioning": partitioning},
+        filters=filters,
+        engine="pyarrow",
+    )
+    pdf = pd.read_parquet(
+        tmpdir,
+        partitioning=pd_partitioning(**partitioning),
+        filters=filters,
+        engine="pyarrow",
+    )
+    assert_eq(ddf, pdf, check_index=False)
+    assert ddf["b"].dtype != "category"
```

### Comparing `dask-2023.7.0/dask/dataframe/io/tests/test_sql.py` & `dask-2023.7.1/dask/dataframe/io/tests/test_sql.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/io/utils.py` & `dask-2023.7.1/dask/dataframe/io/utils.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/methods.py` & `dask-2023.7.1/dask/dataframe/methods.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/multi.py` & `dask-2023.7.1/dask/dataframe/multi.py`

 * *Files 0% similar despite different names*

```diff
@@ -1079,15 +1079,19 @@
     # Use _meta_nonempty as pandas.concat will incorrectly cast float to datetime
     # for empty data frames. See https://github.com/pandas-dev/pandas/issues/32934.
 
     kwargs.update({"ignore_order": ignore_order})
 
     meta = make_meta(
         methods.concat(
-            [df._meta_nonempty for df in dfs],
+            [
+                df._meta_nonempty
+                for df in dfs
+                if not is_dataframe_like(df) or len(df._meta_nonempty.columns) > 0
+            ],
             join=join,
             filter_warning=False,
             **kwargs,
         )
     )
     empty = strip_unknown_categories(meta)
 
@@ -1264,20 +1268,22 @@
         else:
             return dfs[0]
 
     if join not in ("inner", "outer"):
         raise ValueError("'join' must be 'inner' or 'outer'")
 
     axis = DataFrame._validate_axis(axis)
-    try:
-        # remove any empty DataFrames
-        dfs = [df for df in dfs if bool(len(df.columns))]
-    except AttributeError:
-        # 'Series' object has no attribute 'columns'
-        pass
+
+    if axis == 1:
+        try:
+            # remove any empty DataFrames
+            dfs = [df for df in dfs if bool(len(df.columns))]
+        except AttributeError:
+            # 'Series' object has no attribute 'columns'
+            pass
     dasks = [df for df in dfs if isinstance(df, _Frame)]
     dfs = _maybe_from_pandas(dfs)
 
     if axis == 1:
         if all(df.known_divisions for df in dasks):
             return concat_indexed_dataframes(
                 dfs, axis=axis, join=join, ignore_order=ignore_order, **kwargs
```

### Comparing `dask-2023.7.0/dask/dataframe/numeric.py` & `dask-2023.7.1/dask/dataframe/numeric.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/optimize.py` & `dask-2023.7.1/dask/dataframe/optimize.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/partitionquantiles.py` & `dask-2023.7.1/dask/dataframe/partitionquantiles.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/reshape.py` & `dask-2023.7.1/dask/dataframe/reshape.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/rolling.py` & `dask-2023.7.1/dask/dataframe/rolling.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/shuffle.py` & `dask-2023.7.1/dask/dataframe/shuffle.py`

 * *Files 0% similar despite different names*

```diff
@@ -481,15 +481,15 @@
 ):
     shuffle = shuffle or get_default_shuffle_method()
 
     # if the requested output partitions < input partitions
     # we repartition first as shuffling overhead is
     # proportionate to the number of input partitions
 
-    if npartitions is not None and npartitions < df.npartitions:
+    if shuffle != "p2p" and npartitions is not None and npartitions < df.npartitions:
         df = df.repartition(npartitions=npartitions)
 
     if shuffle == "disk":
         return rearrange_by_column_disk(df, col, npartitions, compute=compute)
     elif shuffle == "tasks":
         df2 = rearrange_by_column_tasks(
             df, col, max_branch, npartitions, ignore_index=ignore_index
```

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_accessors.py` & `dask-2023.7.1/dask/dataframe/tests/test_accessors.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_arithmetics_reduction.py` & `dask-2023.7.1/dask/dataframe/tests/test_arithmetics_reduction.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_boolean.py` & `dask-2023.7.1/dask/dataframe/tests/test_boolean.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_categorical.py` & `dask-2023.7.1/dask/dataframe/tests/test_categorical.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_dataframe.py` & `dask-2023.7.1/dask/dataframe/tests/test_dataframe.py`

 * *Files 0% similar despite different names*

```diff
@@ -2069,14 +2069,16 @@
     assert_eq(s.round(), ps.round())
 
 
 @pytest.mark.slow
 def test_repartition():
     def _check_split_data(orig, d):
         """Check data is split properly"""
+        if d is orig:
+            return
         keys = [k for k in d.dask if k[0].startswith("repartition-split")]
         keys = sorted(keys)
         sp = pd.concat(
             [compute_as_if_collection(dd.DataFrame, d.dask, k) for k in keys]
         )
         assert_eq(orig, sp)
         assert_eq(orig, d)
@@ -2099,17 +2101,20 @@
         [10, 70],  # do not allow to expand divisions by default
         [10, 50, 20, 60],  # not sorted
         [10, 10, 20, 60],
     ]:  # not unique (last element can be duplicated)
         pytest.raises(ValueError, lambda div=div: a.repartition(divisions=div))
 
     pdf = pd.DataFrame(np.random.randn(7, 5), columns=list("abxyz"))
+    ps = pdf.x
     for p in range(1, 7):
         ddf = dd.from_pandas(pdf, p)
+        ds = ddf.x
         assert_eq(ddf, pdf)
+        assert_eq(ps, ds)
         for div in [
             [0, 6],
             [0, 6, 6],
             [0, 5, 6],
             [0, 4, 6, 6],
             [0, 2, 6],
             [0, 2, 6, 6],
@@ -2117,38 +2122,41 @@
             [0, 1, 2, 3, 4, 5, 6, 6],
         ]:
             rddf = ddf.repartition(divisions=div)
             _check_split_data(ddf, rddf)
             assert rddf.divisions == tuple(div)
             assert_eq(pdf, rddf)
 
-            rds = ddf.x.repartition(divisions=div)
-            _check_split_data(ddf.x, rds)
+            rds = ds.repartition(divisions=div)
+            _check_split_data(ds, rds)
             assert rds.divisions == tuple(div)
             assert_eq(pdf.x, rds)
 
         # expand divisions
         for div in [[-5, 10], [-2, 3, 5, 6], [0, 4, 5, 9, 10]]:
             rddf = ddf.repartition(divisions=div, force=True)
             _check_split_data(ddf, rddf)
             assert rddf.divisions == tuple(div)
             assert_eq(pdf, rddf)
 
-            rds = ddf.x.repartition(divisions=div, force=True)
-            _check_split_data(ddf.x, rds)
+            rds = ds.repartition(divisions=div, force=True)
+            _check_split_data(ds, rds)
             assert rds.divisions == tuple(div)
             assert_eq(pdf.x, rds)
 
     pdf = pd.DataFrame(
         {"x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], "y": [9, 8, 7, 6, 5, 4, 3, 2, 1, 0]},
         index=list("abcdefghij"),
     )
+    ps = pdf.x
     for p in range(1, 7):
         ddf = dd.from_pandas(pdf, p)
+        ds = ddf.x
         assert_eq(ddf, pdf)
+        assert_eq(ps, ds)
         for div in [
             list("aj"),
             list("ajj"),
             list("adj"),
             list("abfj"),
             list("ahjj"),
             list("acdj"),
@@ -2157,28 +2165,28 @@
             list("abcdefghij"),
         ]:
             rddf = ddf.repartition(divisions=div)
             _check_split_data(ddf, rddf)
             assert rddf.divisions == tuple(div)
             assert_eq(pdf, rddf)
 
-            rds = ddf.x.repartition(divisions=div)
-            _check_split_data(ddf.x, rds)
+            rds = ds.repartition(divisions=div)
+            _check_split_data(ds, rds)
             assert rds.divisions == tuple(div)
             assert_eq(pdf.x, rds)
 
         # expand divisions
         for div in [list("Yadijm"), list("acmrxz"), list("Yajz")]:
             rddf = ddf.repartition(divisions=div, force=True)
             _check_split_data(ddf, rddf)
             assert rddf.divisions == tuple(div)
             assert_eq(pdf, rddf)
 
-            rds = ddf.x.repartition(divisions=div, force=True)
-            _check_split_data(ddf.x, rds)
+            rds = ds.repartition(divisions=div, force=True)
+            _check_split_data(ds, rds)
             assert rds.divisions == tuple(div)
             assert_eq(pdf.x, rds)
 
 
 def test_repartition_divisions():
     result = repartition_divisions([0, 6], [0, 6, 6], "a", "b", "c")
     assert result == {
@@ -2393,25 +2401,35 @@
     assert ddf.divisions == (
         pd.Timestamp("2020-1-1"),
         pd.Timestamp("2020-1-2"),
         pd.Timestamp("2020-1-2"),
     )
 
 
-def test_repartition_noop():
+@pytest.mark.parametrize("type_ctor", [lambda o: o, tuple, list])
+def test_repartition_noop(type_ctor):
     df = pd.DataFrame({"x": [1, 2, 4, 5], "y": [6, 7, 8, 9]}, index=[-1, 0, 2, 7])
     ddf = dd.from_pandas(df, npartitions=2)
+    ds = ddf.x
     # DataFrame method
-    ddf2 = ddf.repartition(divisions=ddf.divisions)
+    ddf2 = ddf.repartition(divisions=type_ctor(ddf.divisions))
     assert ddf2 is ddf
 
     # Top-level dask.dataframe method
-    ddf3 = dd.repartition(ddf, divisions=ddf.divisions)
+    ddf3 = dd.repartition(ddf, divisions=type_ctor(ddf.divisions))
     assert ddf3 is ddf
 
+    # Series method
+    ds2 = ds.repartition(divisions=type_ctor(ds.divisions))
+    assert ds2 is ds
+
+    # Top-level dask.dataframe method applied to a Series
+    ds3 = dd.repartition(ds, divisions=type_ctor(ds.divisions))
+    assert ds3 is ds
+
 
 @pytest.mark.parametrize(
     "freq, expected_freq",
     [
         ("M", "MS"),
         ("MS", "MS"),
         ("2M", "2MS"),
```

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_extensions.py` & `dask-2023.7.1/dask/dataframe/tests/test_extensions.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_format.py` & `dask-2023.7.1/dask/dataframe/tests/test_format.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_groupby.py` & `dask-2023.7.1/dask/dataframe/tests/test_groupby.py`

 * *Files 0% similar despite different names*

```diff
@@ -1270,15 +1270,15 @@
         ddf.groupby("a").agg(spec, split_out=1, split_every=1)
 
     # If split_out > 1, default to shuffling.
     dsk = ddf.groupby("a", sort=False).agg(spec, split_out=2, split_every=1).dask
     assert any("shuffle" in l for l in dsk.layers)
 
 
-@pytest.mark.parametrize("spec", [{"c": "median"}, {"b": np.median, "c": np.max}])
+@pytest.mark.parametrize("spec", [{"c": "median"}, {"b": "median", "c": "max"}])
 @pytest.mark.parametrize("keys", ["a", ["a", "d"]])
 def test_aggregate_median(spec, keys, shuffle_method):
     pdf = pd.DataFrame(
         {
             "a": [1, 2, 3, 1, 1, 2, 4, 3, 7] * 10,
             "b": [4, 2, 7, 3, 3, 1, 1, 1, 2] * 10,
             "c": [0, 1, 2, 3, 4, 5, 6, 7, 8] * 10,
@@ -3317,15 +3317,15 @@
         y=pd.NamedAgg("c", aggfunc=partial(np.std, ddof=1)),
     )
     assert_eq(expected, actual)
 
 
 @pytest.mark.skipif(not PANDAS_GT_140, reason="requires pandas >= 1.4.0")
 @pytest.mark.parametrize("shuffle", [True, False])
-@pytest.mark.parametrize("agg", ["count", np.mean, partial(np.var, ddof=1)])
+@pytest.mark.parametrize("agg", ["count", "mean", partial(np.var, ddof=1)])
 def test_series_named_agg(shuffle, agg):
     df = pd.DataFrame(
         {
             "a": [5, 4, 3, 5, 4, 2, 3, 2],
             "b": [1, 2, 5, 6, 9, 2, 6, 8],
         }
     )
```

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_hashing.py` & `dask-2023.7.1/dask/dataframe/tests/test_hashing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_hyperloglog.py` & `dask-2023.7.1/dask/dataframe/tests/test_hyperloglog.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_indexing.py` & `dask-2023.7.1/dask/dataframe/tests/test_indexing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_merge_column_and_index.py` & `dask-2023.7.1/dask/dataframe/tests/test_merge_column_and_index.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_multi.py` & `dask-2023.7.1/dask/dataframe/tests/test_multi.py`

 * *Files 0% similar despite different names*

```diff
@@ -855,14 +855,16 @@
     # when we concatenate the resulting ddf_concat_with_col.index.dtype == dtype('O'). However,
     # the pandas version is smart enough to identify the empty rows and assign dtype('int64'),
     # which causes assert_eq to fail when checking dtype. Hence the follwoing line.
     ddf_concat_with_col._meta.index = ddf_concat_with_col._meta.index.astype("int64")
 
     assert_eq(df_concat_with_col, ddf_concat_with_col, check_dtype=False)
 
+    assert_eq(dd.concat([ddf, ddf[[]]]), pd.concat([df, df[[]]]))
+
 
 @pytest.mark.parametrize(
     "value_1, value_2",
     [
         (1.0, 1),
         (1.0, "one"),
         (1.0, pd.to_datetime("1970-01-01")),
```

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_numeric.py` & `dask-2023.7.1/dask/dataframe/tests/test_numeric.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_optimize_dataframe.py` & `dask-2023.7.1/dask/dataframe/tests/test_optimize_dataframe.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_pyarrow.py` & `dask-2023.7.1/dask/dataframe/tests/test_pyarrow.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_pyarrow_compat.py` & `dask-2023.7.1/dask/dataframe/tests/test_pyarrow_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_reshape.py` & `dask-2023.7.1/dask/dataframe/tests/test_reshape.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_rolling.py` & `dask-2023.7.1/dask/dataframe/tests/test_rolling.py`

 * *Files 1% similar despite different names*

```diff
@@ -511,31 +511,31 @@
 
 
 def test_rolling_agg_aggregate():
     df = pd.DataFrame({"A": range(5), "B": range(0, 10, 2)})
     ddf = dd.from_pandas(df, npartitions=3)
 
     assert_eq(
-        df.rolling(window=3).agg([np.mean, np.std]),
-        ddf.rolling(window=3).agg([np.mean, np.std]),
+        df.rolling(window=3).agg(["mean", "std"]),
+        ddf.rolling(window=3).agg(["mean", "std"]),
     )
 
     assert_eq(
-        df.rolling(window=3).agg({"A": np.sum, "B": lambda x: np.std(x, ddof=1)}),
-        ddf.rolling(window=3).agg({"A": np.sum, "B": lambda x: np.std(x, ddof=1)}),
+        df.rolling(window=3).agg({"A": "sum", "B": lambda x: np.std(x, ddof=1)}),
+        ddf.rolling(window=3).agg({"A": "sum", "B": lambda x: np.std(x, ddof=1)}),
     )
 
     assert_eq(
-        df.rolling(window=3).agg([np.sum, np.mean]),
-        ddf.rolling(window=3).agg([np.sum, np.mean]),
+        df.rolling(window=3).agg(["sum", "mean"]),
+        ddf.rolling(window=3).agg(["sum", "mean"]),
     )
 
     assert_eq(
-        df.rolling(window=3).agg({"A": [np.sum, np.mean]}),
-        ddf.rolling(window=3).agg({"A": [np.sum, np.mean]}),
+        df.rolling(window=3).agg({"A": ["sum", "mean"]}),
+        ddf.rolling(window=3).agg({"A": ["sum", "mean"]}),
     )
 
     kwargs = {"raw": True}
     assert_eq(
         df.rolling(window=3).apply(lambda x: np.std(x, ddof=1), **kwargs),
         ddf.rolling(window=3).apply(lambda x: np.std(x, ddof=1), **kwargs),
     )
```

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_shuffle.py` & `dask-2023.7.1/dask/dataframe/tests/test_shuffle.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_ufunc.py` & `dask-2023.7.1/dask/dataframe/tests/test_ufunc.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tests/test_utils_dataframe.py` & `dask-2023.7.1/dask/dataframe/tests/test_utils_dataframe.py`

 * *Files 2% similar despite different names*

```diff
@@ -3,14 +3,15 @@
 import re
 import warnings
 from collections.abc import Iterable
 
 import numpy as np
 import pandas as pd
 import pytest
+from packaging.version import Version
 
 import dask
 import dask.dataframe as dd
 from dask.dataframe._compat import PANDAS_GT_200, tm
 from dask.dataframe.core import apply_and_enforce
 from dask.dataframe.utils import (
     UNKNOWN_CATEGORIES,
@@ -20,14 +21,15 @@
     is_dataframe_like,
     is_index_like,
     is_series_like,
     make_meta,
     meta_frame_constructor,
     meta_nonempty,
     meta_series_constructor,
+    pyarrow_strings_enabled,
     raise_on_meta_error,
     shard_df_on_index,
     valid_divisions,
 )
 from dask.local import get_sync
 
 
@@ -667,7 +669,32 @@
         ((1, 2, 3), True),
         (123, False),
         ([0, float("nan"), 1], False),
     ],
 )
 def test_valid_divisions(divisions, valid):
     assert valid_divisions(divisions) == valid
+
+
+def test_pyarrow_strings_enabled():
+    try:
+        import pyarrow as pa
+    except ImportError:
+        pa = None
+
+    # If `pandas>=2` and `pyarrow>=12` are installed, then default to using pyarrow strings
+    if (
+        PANDAS_GT_200
+        and pa is not None
+        and Version(pa.__version__) >= Version("12.0.0")
+    ):
+        assert pyarrow_strings_enabled() is True
+    else:
+        assert pyarrow_strings_enabled() is False
+
+    # Regardless of dependencies that are installed, always obey
+    # the `dataframe.convert-string` config value if it's specified
+    with dask.config.set({"dataframe.convert-string": False}):
+        assert pyarrow_strings_enabled() is False
+
+    with dask.config.set({"dataframe.convert-string": True}):
+        assert pyarrow_strings_enabled() is True
```

### Comparing `dask-2023.7.0/dask/dataframe/tseries/resample.py` & `dask-2023.7.1/dask/dataframe/tseries/resample.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/tseries/tests/test_resample.py` & `dask-2023.7.1/dask/dataframe/tseries/tests/test_resample.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dataframe/utils.py` & `dask-2023.7.1/dask/dataframe/utils.py`

 * *Files 2% similar despite different names*

```diff
@@ -10,15 +10,15 @@
 from numbers import Number
 from typing import TypeVar, overload
 
 import numpy as np
 import pandas as pd
 from pandas.api.types import is_dtype_equal
 
-from dask import config
+import dask
 from dask.base import get_scheduler, is_dask_collection
 from dask.core import get_deps
 from dask.dataframe import (  # noqa: F401 register pandas extension types
     _dtypes,
     methods,
 )
 from dask.dataframe._compat import PANDAS_GT_150, tm  # noqa: F401
@@ -537,17 +537,15 @@
             a = a.sort_values()
     except (TypeError, IndexError, ValueError):
         pass
     return a.sort_index() if check_index else a
 
 
 def _maybe_convert_string(a, b):
-    import dask
-
-    if bool(dask.config.get("dataframe.convert-string")):
+    if pyarrow_strings_enabled():
         from dask.dataframe._pyarrow import to_pyarrow_string
 
         if isinstance(a, (pd.DataFrame, pd.Series, pd.Index)):
             a = to_pyarrow_string(a)
 
         if isinstance(b, (pd.DataFrame, pd.Series, pd.Index)):
             b = to_pyarrow_string(b)
@@ -823,24 +821,29 @@
         return like.to_frame()._constructor_sliced
     else:
         raise TypeError(f"{type(like)} not supported by meta_series_constructor")
 
 
 def get_string_dtype():
     """Depending on config setting, we might convert objects to pyarrow strings"""
-    return (
-        pd.StringDtype("pyarrow")
-        if bool(config.get("dataframe.convert-string"))
-        else object
-    )
+    return pd.StringDtype("pyarrow") if pyarrow_strings_enabled() else object
 
 
-def pyarrow_strings_enabled():
+def pyarrow_strings_enabled() -> bool:
     """Config setting to convert objects to pyarrow strings"""
-    return bool(config.get("dataframe.convert-string"))
+    convert_string = dask.config.get("dataframe.convert-string")
+    if convert_string is None:
+        from dask.dataframe._pyarrow import check_pyarrow_string_supported
+
+        try:
+            check_pyarrow_string_supported()
+            convert_string = True
+        except RuntimeError:
+            convert_string = False
+    return convert_string
 
 
 def get_numeric_only_kwargs(numeric_only) -> dict:
     from dask.dataframe.core import no_default  # Avoid circular import
 
     return {} if numeric_only is no_default else {"numeric_only": numeric_only}
```

### Comparing `dask-2023.7.0/dask/datasets.py` & `dask-2023.7.1/dask/datasets.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/delayed.py` & `dask-2023.7.1/dask/delayed.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/diagnostics/profile.py` & `dask-2023.7.1/dask/diagnostics/profile.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/diagnostics/profile_visualize.py` & `dask-2023.7.1/dask/diagnostics/profile_visualize.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/diagnostics/progress.py` & `dask-2023.7.1/dask/diagnostics/progress.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/diagnostics/tests/test_profiler.py` & `dask-2023.7.1/dask/diagnostics/tests/test_profiler.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/diagnostics/tests/test_progress.py` & `dask-2023.7.1/dask/diagnostics/tests/test_progress.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/distributed.py` & `dask-2023.7.1/dask/distributed.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/dot.py` & `dask-2023.7.1/dask/dot.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/graph_manipulation.py` & `dask-2023.7.1/dask/graph_manipulation.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/hashing.py` & `dask-2023.7.1/dask/hashing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/highlevelgraph.py` & `dask-2023.7.1/dask/highlevelgraph.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/layers.py` & `dask-2023.7.1/dask/layers.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/local.py` & `dask-2023.7.1/dask/local.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/multiprocessing.py` & `dask-2023.7.1/dask/multiprocessing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/optimization.py` & `dask-2023.7.1/dask/optimization.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/order.py` & `dask-2023.7.1/dask/order.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/rewrite.py` & `dask-2023.7.1/dask/rewrite.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/sizeof.py` & `dask-2023.7.1/dask/sizeof.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/system.py` & `dask-2023.7.1/dask/system.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_backends.py` & `dask-2023.7.1/dask/tests/test_backends.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_base.py` & `dask-2023.7.1/dask/tests/test_base.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_cache.py` & `dask-2023.7.1/dask/tests/test_cache.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_callbacks.py` & `dask-2023.7.1/dask/tests/test_callbacks.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_ci.py` & `dask-2023.7.1/dask/tests/test_ci.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_cli.py` & `dask-2023.7.1/dask/tests/test_cli.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_config.py` & `dask-2023.7.1/dask/tests/test_config.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_context.py` & `dask-2023.7.1/dask/tests/test_context.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_core.py` & `dask-2023.7.1/dask/tests/test_core.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_datasets.py` & `dask-2023.7.1/dask/tests/test_datasets.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_delayed.py` & `dask-2023.7.1/dask/tests/test_delayed.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_distributed.py` & `dask-2023.7.1/dask/tests/test_distributed.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_docs.py` & `dask-2023.7.1/dask/tests/test_docs.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_dot.py` & `dask-2023.7.1/dask/tests/test_dot.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_graph_manipulation.py` & `dask-2023.7.1/dask/tests/test_graph_manipulation.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_hashing.py` & `dask-2023.7.1/dask/tests/test_hashing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_highgraph.py` & `dask-2023.7.1/dask/tests/test_highgraph.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_layers.py` & `dask-2023.7.1/dask/tests/test_layers.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_local.py` & `dask-2023.7.1/dask/tests/test_local.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_multiprocessing.py` & `dask-2023.7.1/dask/tests/test_multiprocessing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_optimization.py` & `dask-2023.7.1/dask/tests/test_optimization.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_order.py` & `dask-2023.7.1/dask/tests/test_order.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_rewrite.py` & `dask-2023.7.1/dask/tests/test_rewrite.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_sizeof.py` & `dask-2023.7.1/dask/tests/test_sizeof.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_spark_compat.py` & `dask-2023.7.1/dask/tests/test_spark_compat.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_system.py` & `dask-2023.7.1/dask/tests/test_system.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_threaded.py` & `dask-2023.7.1/dask/tests/test_threaded.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_typing.py` & `dask-2023.7.1/dask/tests/test_typing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/tests/test_utils.py` & `dask-2023.7.1/dask/tests/test_utils.py`

 * *Files 0% similar despite different names*

```diff
@@ -679,14 +679,16 @@
     assert parse_timedelta("1ms", default=False) == 0.001
     with pytest.raises(ValueError):
         parse_timedelta(1, default=False)
     with pytest.raises(ValueError):
         parse_timedelta("1", default=False)
     with pytest.raises(TypeError):
         parse_timedelta("1", default=None)
+    with pytest.raises(KeyError, match="Invalid time unit: foo. Valid units are"):
+        parse_timedelta("1 foo")
 
 
 def test_is_arraylike():
     np = pytest.importorskip("numpy")
 
     assert is_arraylike(0) is False
     assert is_arraylike(()) is False
```

### Comparing `dask-2023.7.0/dask/tests/test_utils_test.py` & `dask-2023.7.1/dask/tests/test_utils_test.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/threaded.py` & `dask-2023.7.1/dask/threaded.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/typing.py` & `dask-2023.7.1/dask/typing.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/utils.py` & `dask-2023.7.1/dask/utils.py`

 * *Files 0% similar despite different names*

```diff
@@ -1751,15 +1751,21 @@
     if suffix is False:
         raise ValueError(f"Missing time unit: {s}")
     if not isinstance(suffix, str):
         raise TypeError(f"default must be str or False, got {default!r}")
 
     n = float(prefix)
 
-    multiplier = timedelta_sizes[suffix.lower()]
+    try:
+        multiplier = timedelta_sizes[suffix.lower()]
+    except KeyError:
+        valid_units = ", ".join(timedelta_sizes.keys())
+        raise KeyError(
+            f"Invalid time unit: {suffix}. Valid units are: {valid_units}"
+        ) from None
 
     result = n * multiplier
     if int(result) == result:
         result = int(result)
     return result
```

### Comparing `dask-2023.7.0/dask/utils_test.py` & `dask-2023.7.1/dask/utils_test.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/widgets/__init__.py` & `dask-2023.7.1/dask/widgets/__init__.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/widgets/templates/array.html.j2` & `dask-2023.7.1/dask/widgets/templates/array.html.j2`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/widgets/templates/highlevelgraph.html.j2` & `dask-2023.7.1/dask/widgets/templates/highlevelgraph.html.j2`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/widgets/templates/highlevelgraph_layer.html.j2` & `dask-2023.7.1/dask/widgets/templates/highlevelgraph_layer.html.j2`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/widgets/tests/test_widgets.py` & `dask-2023.7.1/dask/widgets/tests/test_widgets.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask/widgets/widgets.py` & `dask-2023.7.1/dask/widgets/widgets.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/dask.egg-info/PKG-INFO` & `dask-2023.7.1/dask.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: dask
-Version: 2023.7.0
+Version: 2023.7.1
 Summary: Parallel PyData with Task Scheduling
 Maintainer-email: Matthew Rocklin <mrocklin@gmail.com>
 License: BSD
 Project-URL: Homepage, https://github.com/dask/dask/
 Keywords: task-scheduling parallel numpy pandas pydata
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
```

### Comparing `dask-2023.7.0/dask.egg-info/SOURCES.txt` & `dask-2023.7.1/dask.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/Makefile` & `dask-2023.7.1/docs/Makefile`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/make.bat` & `dask-2023.7.1/docs/make.bat`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/10-minutes-to-dask.rst` & `dask-2023.7.1/docs/source/10-minutes-to-dask.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/_static/config_converter.js` & `dask-2023.7.1/docs/source/_static/config_converter.js`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/_static/dask-simple.png` & `dask-2023.7.1/docs/source/_static/dask-simple.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/_static/main-page.css` & `dask-2023.7.1/docs/source/_static/main-page.css`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/_static/profile.html` & `dask-2023.7.1/docs/source/_static/profile.html`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/_static/stacked_profile.html` & `dask-2023.7.1/docs/source/_static/stacked_profile.html`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/_static/style.css` & `dask-2023.7.1/docs/source/_static/style.css`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/_static/transpose_cyto.html` & `dask-2023.7.1/docs/source/_static/transpose_cyto.html`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/_static/yaml.min.js` & `dask-2023.7.1/docs/source/_static/yaml.min.js`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/api.rst` & `dask-2023.7.1/docs/source/api.rst`

 * *Files 20% similar despite different names*

```diff
@@ -58,14 +58,51 @@
 Dask has a few helpers for generating demo datasets
 
 .. currentmodule:: dask.datasets
 
 .. autofunction:: make_people
 .. autofunction:: timeseries
 
+Datasets with defined specs
+---------------------------
+
+The following helpers are still experimental:
+
+.. currentmodule:: dask.dataframe.io.demo
+
+.. autofunction:: with_spec
+
+The ``ColumnSpec`` class
+************************
+.. autoclass:: dask.dataframe.io.demo.ColumnSpec
+    :members:
+    :undoc-members:
+    :show-inheritance:
+
+The ``RangeIndexSpec`` class
+****************************
+.. autoclass:: dask.dataframe.io.demo.RangeIndexSpec
+    :members:
+    :undoc-members:
+    :show-inheritance:
+
+The ``DatetimeIndexSpec`` class
+*******************************
+.. autoclass:: dask.dataframe.io.demo.DatetimeIndexSpec
+    :members:
+    :undoc-members:
+    :show-inheritance:
+
+The ``DatasetSpec`` class
+*************************
+.. autoclass:: dask.dataframe.io.demo.DatasetSpec
+    :members:
+    :undoc-members:
+    :show-inheritance:
+
 .. _api.utilities:
 
 Utilities
 ---------
 
 Dask has some public utility methods. These are primarily used for parsing
 configuration values.
```

### Comparing `dask-2023.7.0/docs/source/array-api.rst` & `dask-2023.7.1/docs/source/array-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/array-assignment.rst` & `dask-2023.7.1/docs/source/array-assignment.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/array-best-practices.rst` & `dask-2023.7.1/docs/source/array-best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/array-chunks.rst` & `dask-2023.7.1/docs/source/array-chunks.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/array-creation.rst` & `dask-2023.7.1/docs/source/array-creation.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/array-design.rst` & `dask-2023.7.1/docs/source/array-design.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/array-gufunc.rst` & `dask-2023.7.1/docs/source/array-gufunc.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/array-overlap.rst` & `dask-2023.7.1/docs/source/array-overlap.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/array-random.rst` & `dask-2023.7.1/docs/source/array-random.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/array-slicing.rst` & `dask-2023.7.1/docs/source/array-slicing.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/array-sparse.rst` & `dask-2023.7.1/docs/source/array-sparse.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/array-stack.rst` & `dask-2023.7.1/docs/source/array-stack.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/array-stats.rst` & `dask-2023.7.1/docs/source/array-stats.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/array.rst` & `dask-2023.7.1/docs/source/array.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/bag-api.rst` & `dask-2023.7.1/docs/source/bag-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/bag-creation.rst` & `dask-2023.7.1/docs/source/bag-creation.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/bag.rst` & `dask-2023.7.1/docs/source/bag.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/best-practices.rst` & `dask-2023.7.1/docs/source/best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/caching.rst` & `dask-2023.7.1/docs/source/caching.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/changelog.rst` & `dask-2023.7.1/docs/source/changelog.rst`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,53 @@
 Changelog
 =========
 
+.. _v2023.7.1:
+
+2023.7.1
+--------
+
+Released on July 20, 2023
+
+.. note::
+
+  This release updates Dask DataFrame to automatically convert
+  text data using ``object`` data types to ``string[pyarrow]``
+  if ``pandas>=2`` and ``pyarrow>=12`` are installed.
+
+  This should result in significantly reduced
+  memory consumption and increased computation performance in many
+  workflows that deal with text data.
+
+  You can disable this change by setting the ``dataframe.convert-string``
+  configuration value to ``False`` with
+
+  .. code-block:: python
+
+      dask.config.set({"dataframe.convert-string": False})
+
+
+Enhancements
+^^^^^^^^^^^^
+- Convert to ``pyarrow`` strings if proper dependencies are installed (:pr:`10400`) `James Bourbeau`_
+- Avoid ``repartition`` before ``shuffle`` for ``p2p`` (:pr:`10421`) `Patrick Hoefler`_
+- API to generate random Dask DataFrames (:pr:`10392`) `Irina Truong`_
+- Speed up ``dask.bag.Bag.random_sample`` (:pr:`10356`) `crusaderky`_
+- Raise helpful ``ValueError`` for invalid time units (:pr:`10408`) `Nat Tabris`_
+- Make ``repartition`` a no-op when divisions match (divisions provided as a list) (:pr:`10395`) `Nicolas Grandemange`_
+
+Bug Fixes
+^^^^^^^^^
+- Use ``dataframe.convert-string`` in ``read_parquet`` token (:pr:`10411`) `James Bourbeau`_
+- Category ``dtype`` is lost when concatenating ``MultiIndex`` (:pr:`10407`) `Irina Truong`_
+- Fix ``FutureWarning: The provided callable...`` (:pr:`10405`) `Irina Truong`_
+- Enable non-categorical hive-partition columns in ``read_parquet`` (:pr:`10353`) `Richard (Rick) Zamora`_
+- ``concat`` ignoring ``DataFrame`` withouth columns (:pr:`10359`) `Patrick Hoefler`_
+
+
 .. _v2023.7.0:
 
 2023.7.0
 --------
 
 Released on July 7, 2023
```

### Comparing `dask-2023.7.0/docs/source/cli.rst` & `dask-2023.7.1/docs/source/cli.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/conf.py` & `dask-2023.7.1/docs/source/conf.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/configuration.rst` & `dask-2023.7.1/docs/source/configuration.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/custom-collections.rst` & `dask-2023.7.1/docs/source/custom-collections.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/custom-graphs.rst` & `dask-2023.7.1/docs/source/custom-graphs.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/dashboard-progress-script.py` & `dask-2023.7.1/docs/source/dashboard-progress-script.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/dashboard.rst` & `dask-2023.7.1/docs/source/dashboard.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/daskcheatsheet.pdf` & `dask-2023.7.1/docs/source/daskcheatsheet.pdf`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/dataframe-api.rst` & `dask-2023.7.1/docs/source/dataframe-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/dataframe-best-practices.rst` & `dask-2023.7.1/docs/source/dataframe-best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/dataframe-categoricals.rst` & `dask-2023.7.1/docs/source/dataframe-categoricals.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/dataframe-create.rst` & `dask-2023.7.1/docs/source/dataframe-create.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/dataframe-design.rst` & `dask-2023.7.1/docs/source/dataframe-design.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/dataframe-extend.rst` & `dask-2023.7.1/docs/source/dataframe-extend.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/dataframe-groupby.rst` & `dask-2023.7.1/docs/source/dataframe-groupby.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/dataframe-indexing.rst` & `dask-2023.7.1/docs/source/dataframe-indexing.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/dataframe-joins.rst` & `dask-2023.7.1/docs/source/dataframe-joins.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/dataframe-parquet.rst` & `dask-2023.7.1/docs/source/dataframe-parquet.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/dataframe-sql.rst` & `dask-2023.7.1/docs/source/dataframe-sql.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/dataframe.rst` & `dask-2023.7.1/docs/source/dataframe.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/delayed-api.rst` & `dask-2023.7.1/docs/source/delayed-api.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/delayed-best-practices.rst` & `dask-2023.7.1/docs/source/delayed-best-practices.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/delayed-collections.rst` & `dask-2023.7.1/docs/source/delayed-collections.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/delayed.rst` & `dask-2023.7.1/docs/source/delayed.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/deploying-cli.rst` & `dask-2023.7.1/docs/source/deploying-cli.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/deploying-cloud.rst` & `dask-2023.7.1/docs/source/deploying-cloud.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/deploying-docker.rst` & `dask-2023.7.1/docs/source/deploying-docker.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/deploying-hpc.rst` & `dask-2023.7.1/docs/source/deploying-hpc.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/deploying-kubernetes.rst` & `dask-2023.7.1/docs/source/deploying-kubernetes.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/deploying-python-advanced.rst` & `dask-2023.7.1/docs/source/deploying-python-advanced.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/deploying-python.rst` & `dask-2023.7.1/docs/source/deploying-python.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/deploying-ssh.rst` & `dask-2023.7.1/docs/source/deploying-ssh.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/deploying.rst` & `dask-2023.7.1/docs/source/deploying.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/deployment-considerations.rst` & `dask-2023.7.1/docs/source/deployment-considerations.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/develop.rst` & `dask-2023.7.1/docs/source/develop.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/diagnostics-distributed.rst` & `dask-2023.7.1/docs/source/diagnostics-distributed.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/diagnostics-local.rst` & `dask-2023.7.1/docs/source/diagnostics-local.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/ecosystem.rst` & `dask-2023.7.1/docs/source/ecosystem.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/faq.rst` & `dask-2023.7.1/docs/source/faq.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/futures.rst` & `dask-2023.7.1/docs/source/futures.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/gpu.rst` & `dask-2023.7.1/docs/source/gpu.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/graph_manipulation.rst` & `dask-2023.7.1/docs/source/graph_manipulation.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/graphs.rst` & `dask-2023.7.1/docs/source/graphs.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/graphviz.rst` & `dask-2023.7.1/docs/source/graphviz.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/high-level-graphs.rst` & `dask-2023.7.1/docs/source/high-level-graphs.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/how-to/adaptive.rst` & `dask-2023.7.1/docs/source/how-to/adaptive.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/how-to/connect-to-remote-data.rst` & `dask-2023.7.1/docs/source/how-to/connect-to-remote-data.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/how-to/customize-initialization.rst` & `dask-2023.7.1/docs/source/how-to/customize-initialization.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/how-to/debug.rst` & `dask-2023.7.1/docs/source/how-to/debug.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/how-to/extend-sizeof.rst` & `dask-2023.7.1/docs/source/how-to/extend-sizeof.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/how-to/manage-environments.rst` & `dask-2023.7.1/docs/source/how-to/manage-environments.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/how-to/selecting-the-collection-backend.rst` & `dask-2023.7.1/docs/source/how-to/selecting-the-collection-backend.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/how-to/setup-prometheus.rst` & `dask-2023.7.1/docs/source/how-to/setup-prometheus.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/10_minutes_array_graph.png` & `dask-2023.7.1/docs/source/images/10_minutes_array_graph.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/10_minutes_bag_graph.png` & `dask-2023.7.1/docs/source/images/10_minutes_bag_graph.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/10_minutes_dataframe_graph.png` & `dask-2023.7.1/docs/source/images/10_minutes_dataframe_graph.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/HHMI_Janelia_Color.png` & `dask-2023.7.1/docs/source/images/HHMI_Janelia_Color.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/array.svg` & `dask-2023.7.1/docs/source/images/array.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/async-embarrassing.gif` & `dask-2023.7.1/docs/source/images/async-embarrassing.gif`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/concurrent-futures-threaded.webp` & `dask-2023.7.1/docs/source/images/concurrent-futures-threaded.webp`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/crosstalk.svg` & `dask-2023.7.1/docs/source/images/crosstalk.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dashboard_jupyterlab.png` & `dask-2023.7.1/docs/source/images/dashboard_jupyterlab.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dashboard_link.png` & `dask-2023.7.1/docs/source/images/dashboard_link.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dashboard_memory.png` & `dask-2023.7.1/docs/source/images/dashboard_memory.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dashboard_memory_new.gif` & `dask-2023.7.1/docs/source/images/dashboard_memory_new.gif`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dashboard_progress.png` & `dask-2023.7.1/docs/source/images/dashboard_progress.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dashboard_status.png` & `dask-2023.7.1/docs/source/images/dashboard_status.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dashboard_task_processing.png` & `dask-2023.7.1/docs/source/images/dashboard_task_processing.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dashboard_task_stream_unhealthy.png` & `dask-2023.7.1/docs/source/images/dashboard_task_stream_unhealthy.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dashboard_taskstream_healthy.png` & `dask-2023.7.1/docs/source/images/dashboard_taskstream_healthy.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dask-adaptive.svg` & `dask-2023.7.1/docs/source/images/dask-adaptive.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dask-array.svg` & `dask-2023.7.1/docs/source/images/dask-array.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dask-cluster-manager.svg` & `dask-2023.7.1/docs/source/images/dask-cluster-manager.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dask-dataframe.svg` & `dask-2023.7.1/docs/source/images/dask-dataframe.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dask-overview-distributed-callout.svg` & `dask-2023.7.1/docs/source/images/dask-overview-distributed-callout.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dask-overview-schedulers.svg` & `dask-2023.7.1/docs/source/images/dask-overview-schedulers.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dask-overview.svg` & `dask-2023.7.1/docs/source/images/dask-overview.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dask_horizontal.svg` & `dask-2023.7.1/docs/source/images/dask_horizontal.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dask_horizontal_black.svg` & `dask-2023.7.1/docs/source/images/dask_horizontal_black.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dask_horizontal_on_blue.svg` & `dask-2023.7.1/docs/source/images/dask_horizontal_on_blue.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dask_horizontal_on_pink.svg` & `dask-2023.7.1/docs/source/images/dask_horizontal_on_pink.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dask_horizontal_white.svg` & `dask-2023.7.1/docs/source/images/dask_horizontal_white.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dask_icon.svg` & `dask-2023.7.1/docs/source/images/dask_icon.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dask_icon_black.svg` & `dask-2023.7.1/docs/source/images/dask_icon_black.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dask_icon_on_pink.svg` & `dask-2023.7.1/docs/source/images/dask_icon_on_pink.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/dask_icon_white.svg` & `dask-2023.7.1/docs/source/images/dask_icon_white.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/delayed-inc-double-add.svg` & `dask-2023.7.1/docs/source/images/delayed-inc-double-add.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/distributed-overview.svg` & `dask-2023.7.1/docs/source/images/distributed-overview.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/frame-shuffle.svg` & `dask-2023.7.1/docs/source/images/frame-shuffle.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/frame-sort.svg` & `dask-2023.7.1/docs/source/images/frame-sort.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/frame.svg` & `dask-2023.7.1/docs/source/images/frame.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/gputester-msg.png` & `dask-2023.7.1/docs/source/images/gputester-msg.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/growth_of_languages.png` & `dask-2023.7.1/docs/source/images/growth_of_languages.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/growth_of_libraries.png` & `dask-2023.7.1/docs/source/images/growth_of_libraries.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/inc-add.svg` & `dask-2023.7.1/docs/source/images/inc-add.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/map-reduce-task-scheduling.svg` & `dask-2023.7.1/docs/source/images/map-reduce-task-scheduling.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/map_blocks_drop_axis.png` & `dask-2023.7.1/docs/source/images/map_blocks_drop_axis.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/merge_chunks.png` & `dask-2023.7.1/docs/source/images/merge_chunks.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/merge_chunks_false.png` & `dask-2023.7.1/docs/source/images/merge_chunks_false.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/optimize_dask1.svg` & `dask-2023.7.1/docs/source/images/optimize_dask1.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/optimize_dask2.svg` & `dask-2023.7.1/docs/source/images/optimize_dask2.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/optimize_dask3.svg` & `dask-2023.7.1/docs/source/images/optimize_dask3.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/optimize_dask4.svg` & `dask-2023.7.1/docs/source/images/optimize_dask4.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/optimize_dask5.svg` & `dask-2023.7.1/docs/source/images/optimize_dask5.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/order-failure.png` & `dask-2023.7.1/docs/source/images/order-failure.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/order-success.png` & `dask-2023.7.1/docs/source/images/order-success.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/overlap.svg` & `dask-2023.7.1/docs/source/images/overlap.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/overlapping-blocks.svg` & `dask-2023.7.1/docs/source/images/overlapping-blocks.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/overlapping-neighbors.svg` & `dask-2023.7.1/docs/source/images/overlapping-neighbors.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/pipeline.svg` & `dask-2023.7.1/docs/source/images/pipeline.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/reshape.png` & `dask-2023.7.1/docs/source/images/reshape.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/reshape_problem.png` & `dask-2023.7.1/docs/source/images/reshape_problem.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/reshape_rechunked.png` & `dask-2023.7.1/docs/source/images/reshape_rechunked.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/scaling-edges.png` & `dask-2023.7.1/docs/source/images/scaling-edges.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/scaling-nodes.png` & `dask-2023.7.1/docs/source/images/scaling-nodes.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/simple-dask.png` & `dask-2023.7.1/docs/source/images/simple-dask.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/transpose-hlg-hovertooltip.png` & `dask-2023.7.1/docs/source/images/transpose-hlg-hovertooltip.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/transpose-hlg-html-repr.png` & `dask-2023.7.1/docs/source/images/transpose-hlg-html-repr.png`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/transpose.svg` & `dask-2023.7.1/docs/source/images/transpose.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/transpose_opt.svg` & `dask-2023.7.1/docs/source/images/transpose_opt.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/trivial.svg` & `dask-2023.7.1/docs/source/images/trivial.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/images/unoverlapping-neighbors.svg` & `dask-2023.7.1/docs/source/images/unoverlapping-neighbors.svg`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/index.rst` & `dask-2023.7.1/docs/source/index.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/install.rst` & `dask-2023.7.1/docs/source/install.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/logos.rst` & `dask-2023.7.1/docs/source/logos.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/maintainers.rst` & `dask-2023.7.1/docs/source/maintainers.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/optimize.rst` & `dask-2023.7.1/docs/source/optimize.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/order.rst` & `dask-2023.7.1/docs/source/order.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/phases-of-computation.rst` & `dask-2023.7.1/docs/source/phases-of-computation.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/presentations.rst` & `dask-2023.7.1/docs/source/presentations.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/scheduler-overview.rst` & `dask-2023.7.1/docs/source/scheduler-overview.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/scheduling-policy.rst` & `dask-2023.7.1/docs/source/scheduling-policy.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/scheduling.rst` & `dask-2023.7.1/docs/source/scheduling.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/scripts/scheduling.py` & `dask-2023.7.1/docs/source/scripts/scheduling.py`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/shared.rst` & `dask-2023.7.1/docs/source/shared.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/spark.rst` & `dask-2023.7.1/docs/source/spark.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/spec.rst` & `dask-2023.7.1/docs/source/spec.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/support.rst` & `dask-2023.7.1/docs/source/support.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/understanding-performance.rst` & `dask-2023.7.1/docs/source/understanding-performance.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/user-interfaces.rst` & `dask-2023.7.1/docs/source/user-interfaces.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/docs/source/why.rst` & `dask-2023.7.1/docs/source/why.rst`

 * *Files identical despite different names*

### Comparing `dask-2023.7.0/pyproject.toml` & `dask-2023.7.1/pyproject.toml`

 * *Files 0% similar despite different names*

```diff
@@ -51,15 +51,15 @@
 array = ["numpy >= 1.21"]
 # keeping for backwards compatibility
 bag = []
 dataframe = [
     "numpy >= 1.21",
     "pandas >= 1.3",
 ]
-distributed = ["distributed == 2023.7.0"]
+distributed = ["distributed == 2023.7.1"]
 diagnostics = [
     "bokeh >= 2.4.2",
     "jinja2 >= 2.10.3",
 ]
 # keeping for backwards compatibility
 delayed = []
 complete = [
```

